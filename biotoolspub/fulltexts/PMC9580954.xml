<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Bioinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2673-7647</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9580954</article-id>
    <article-id pub-id-type="publisher-id">828703</article-id>
    <article-id pub-id-type="doi">10.3389/fbinf.2022.828703</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GMEmbeddings: An R Package to Apply Embedding Techniques to Microbiome Data</article-title>
      <alt-title alt-title-type="left-running-head">Tataru et al.</alt-title>
      <alt-title alt-title-type="right-running-head">GMEmbeddings</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tataru</surname>
          <given-names>Christine</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1471905/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eaton</surname>
          <given-names>Austin</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1380831/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>David</surname>
          <given-names>Maude M.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/560992/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Microbiology</institution>, <institution>College of Science</institution>, <institution>Oregon State University</institution>, <addr-line>Corvallis</addr-line>, <addr-line>OR</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Pharmaceutical Sciences</institution>, <institution>College of Pharmacy</institution>, <institution>Oregon State University</institution>, <addr-line>Corvallis</addr-line>, <addr-line>OR</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/38684/overview" ext-link-type="uri">Joao Carlos Setubal</ext-link>, University of São Paulo, Brazil</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/528947/overview" ext-link-type="uri">Gavin Douglas</ext-link>, Dalhousie University, Canada</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/641155/overview" ext-link-type="uri">Leandro de Mattos Pereira</ext-link>, Fiocruz Pernambuco, Brazil</p>
      </fn>
      <corresp id="c001">*Correspondence: Christine Tataru, <email>tataruc@oregonstate.edu</email>
</corresp>
      <fn fn-type="other">
        <p>This article was submitted to Genomic Analysis, a section of the journal Frontiers in Bioinformatics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <elocation-id>828703</elocation-id>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Tataru, Eaton and David.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Tataru, Eaton and David</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Large-scale microbiome studies investigating disease-inducing microbial roles base their findings on differences between microbial count data in contrasting environments (e.g., stool samples between cases and controls). These microbiome survey studies are often impeded by small sample sizes and database bias. Combining data from multiple survey studies often results in obvious batch effects, even when DNA preparation and sequencing methods are identical. Relatedly, predictive models trained on one microbial DNA dataset often do not generalize to outside datasets. In this study, we address these limitations by applying word embedding algorithms (GloVe) and PCA transformation to ASV data from the American Gut Project and generating translation matrices that can be applied to any 16S rRNA V4 region gut microbiome sequencing study. Because these approaches contextualize microbial occurrences in a larger dataset while reducing dimensionality of the feature space, they can improve generalization of predictive models that predict host phenotype from stool associated gut microbiota. The GMEmbeddings R package contains GloVe and PCA embedding transformation matrices at 50, 100 and 250 dimensions, each learned using ∼15,000 samples from the American Gut Project. It currently supports the alignment, matching, and matrix multiplication to allow users to transform their V4 16S rRNA data into these embedding spaces. We show how to correlate the properties in the new embedding space to KEGG functional pathways for biological interpretation of results. Lastly, we provide benchmarking on six gut microbiome datasets describing three phenotypes to demonstrate the ability of embedding-based microbiome classifiers to generalize to independent datasets. Future iterations of GMEmbeddings will include embedding transformation matrices for other biological systems. Available at: <ext-link xlink:href="https://github.com/MaudeDavidLab/GMEmbeddings" ext-link-type="uri">https://github.com/MaudeDavidLab/GMEmbeddings</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>microbiome</kwd>
      <kwd>embedding</kwd>
      <kwd>deep learning</kwd>
      <kwd>machine learning</kwd>
      <kwd>16s sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">
          <institution-wrap>
            <institution>National Science Foundation
</institution>
            <institution-id institution-id-type="doi">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source id="cn002">
          <institution-wrap>
            <institution>National Institutes of Health
</institution>
            <institution-id institution-id-type="doi">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1 Introduction</title>
    <p>Gut microbiomes can impact the physiology of their human hosts by modifying the availability of molecules in the environment or through direct interactions with host cells <xref rid="B26" ref-type="bibr">Ruff et al. (2020)</xref>. The most commonly used and cost-effective method to observe microbiomes is 16S rRNA amplicon sequencing, which allows researchers to observe which bacterial species are present in an environment, their relative quantities, and their relative evolutionary distances to one another <xref rid="B15" ref-type="bibr">Johnson et al. (2019)</xref>.</p>
    <p>While 16S rRNA amplicon sequencing has many strengths and provides insight into general microbiome compositions, analysis of 16S data is often impeded by small sample sizes paired with massive feature spaces. This can lead to underpowered studies and spurious associations being detected <xref rid="B28" ref-type="bibr">Schloss (2018)</xref>, <xref rid="B14" ref-type="bibr">Ioannidis (2005)</xref>, <xref rid="B10" ref-type="bibr">Fan et al. (2012)</xref>. While meta-analyses of microbiome datasets generally support associations between microbiome community structure and disease, these interactions are often relatively weak and confounded by inter-study and individual microbiome variation <xref rid="B29" ref-type="bibr">Sharpton et al. (2021)</xref>, <xref rid="B32" ref-type="bibr">Sze and Schloss (2016)</xref>, <xref rid="B13" ref-type="bibr">Holman and Gzyl (2019)</xref>, <xref rid="B9" ref-type="bibr">Duvallet et al. (2017)</xref>, <xref rid="B35" ref-type="bibr">Wirbel et al. (2021)</xref>. In addition, 16S analysis generally treats amplicon sequence variants (ASVs) or operational taxonomic units (OTUs), also generally called taxa, as independent features, despite the complex network of known relationships between bacterial species that influence their function <xref rid="B1" ref-type="bibr">Albright et al. (2021)</xref>, <xref rid="B30" ref-type="bibr">Shoaie et al. (2013)</xref>. By reducing dimensionality while simultaneously analyzing 16S sequences in the context of co-occurrence and co-abundance patterns across studies, we can increase the generalizability of classifiers and gain insight into microbiome community function.</p>
    <p>Embedding has emerged as a method in natural language processing to both decrease the dimensionality of the feature space as well as consider co-occurrence relationships between entities across corpuses of documents. Embedding algorithms produce a numerical vector representation of every feature, then datasets can be projected into this newly defined numerical space. Vector representations can be learned in multiple ways–here we use both GloVe and Principal Component Analysis (PCA) algorithms on American Gut Project (AGP) data to produce two sets of embedding vectors. GloVe is an algorithm designed for natural language processing which learns numerical representation of features by projecting a co-occurrence matrix between features into a lower dimensional space. In the case of natural language, these numerical vector representations of words can then be used to cluster words by their shared meanings and relationships (e.g., king–male = queen) <xref rid="B25" ref-type="bibr">Pennington et al. (2014)</xref>. PCA is a method used frequently in ecology which learns numerical representation of features such that samples fall along the axes of highest variation across the dataset <xref rid="B24" ref-type="bibr">Karl (1901)</xref>. To some extent, this method takes into account co-abundances between taxa across samples to learn a representation.</p>
    <p>We used both of these algorithms to create embedding transformation matrices. Numerical representations of 48,279 ASVs found in 15,709 samples were learned, and representations were created in 50, 100, and 250 dimensions.</p>
    <p>We present GMEmbeddings, an open-source R package that transforms 16s microbiome data (ASV counts) into an embedding space that captures information about taxa co-occurrence or co-abundance patterns. GMEmbeddings currently contains embedding vectors to enable embedding of 16S V4 reads from the human gut microbiome. While the presented embedding matrices are not meant to be used to transform counts from other 16S regions or other biomes, future iterations will include other sets of embedding vectors. The package also enables the ability to interpret the learned numerical representations in the context of microbial metabolic pathways.</p>
    <p>Previous iterations of this work used only forward reads from the American Gut Project that were ∼ 150 bp long, resulting in less specificity and less coverage during the transformation into embedding space <xref rid="B33" ref-type="bibr">Tataru and David (2020)</xref>. This iteration contains full length V4 reads ( ∼ 250 bp) to improve performance, and is additionally more accessible through use of a complete R package.</p>
  </sec>
  <sec id="s2">
    <title>2 Methods</title>
    <sec id="s2-1">
      <title>2.1 Making Embedding Transformation Matrix</title>
      <sec id="s2-1-1">
        <title>2.1.1 Data Collection</title>
        <p>Fastq files were downloaded from <ext-link xlink:href="ftp://ftp.microbio.me/AmericanGut/20nov2020-demultiplexed-data/" ext-link-type="ftp">ftp://ftp.microbio.me/AmericanGut/20nov2020-demultiplexed-data/</ext-link>. Only sequences from stool samples were kept. Each folder represents a study, and studies with less than 50 samples were removed. Of the 72 folders originally associated with the AGP, 50 folders were kept. All gzipped FASTQ files were then collected from each folder, totalling 43,256 individual files sharing a combined size of 113 Gigabytes of space. The files were then filtered using Cutadapt in order to remove primers from the sequences <xref rid="B21" ref-type="bibr">Martin (2011)</xref>. We removed the 515F-806R primer pairs: GTGYCAGCMGCCGCGGTAA (Fwd V4), GGACTACNVGGGTWTCTAAT (Rev V4), GTGCCAGCMGCCGCGGTAA (Fwd V4), GGACTACHVGGGTWTCTAAT (Rev V4) <xref rid="B22" ref-type="bibr">McDonald et al. (2018)</xref>. In an effort to keep only the most accurate samples available, further filtration was performed to retain only files containing over 5,000 sequence reads.</p>
      </sec>
      <sec id="s2-1-2">
        <title>2.1.2 Process Into ASVs</title>
        <p>Fastq files were then processed using the DADA2 pipeline <xref rid="B5" ref-type="bibr">Callahan et al. (2016)</xref>. In short, forward and reverse reads were trimmed to 140 base pairs, and maxEE and truncQ were set to 2. Reads that matched the phiX contamination database were removed <xref rid="B23" ref-type="bibr">Mukherjee et al. (2015)</xref>. The error rates were then learned from the data, and later the core sample inference algorithm was applied to the filtered and trimmed sequence data. We then merged the forward and reverse reads together to obtain the full denoised sequences and removed any chimeras from the data. Lastly, bloom sequences obtained from the following link were removed: <ext-link xlink:href="https://github.com/knightlab-analyses/bloom-analyses/blob/master/data/newbloom.all.fna" ext-link-type="uri">https://github.com/knightlab-analyses/bloom-analyses/blob/master/data/newbloom.all.fna</ext-link>.</p>
      </sec>
      <sec id="s2-1-3">
        <title>2.1.3 Filter for Prevalence</title>
        <p>After completing the quality filter and trimming steps in the DADA2 pipeline, we created a sequence table. The entries in the sequence table represented counts of the number of times the sequence read was detected in each of the samples. In total, there were unique 898,853 ASVs and 15,706 samples (merged forward and reverse reads). However, many of these ASVs had low rates of occurrence among the samples, so further filtering was done to remove reads that were detected in 10 or fewer samples. Filtering for blooms and prevalence reduced the size of our sequence table from 898,855 ASVs to 48,279 ASVs.</p>
      </sec>
      <sec id="s2-1-4">
        <title>2.1.4 Calculate Co-Occurrence</title>
        <p>Next, we created an ASV co-occurrence text file. Each line in the file contained the full length ASV sequence of all ASVs in one sample. The final file contained 15,706 lines, with one for every sample. In essence, we could think of each sample as having a specific sentence/catchphrase, and each line in this file contained the catchphrase of one sample. However, instead of words, each catchphrase was composed of the genetic sequences observed in each sample. This is the format for input files to the GloVe software (version 0.2). <xref rid="B25" ref-type="bibr">Pennington et al. (2014)</xref>.</p>
      </sec>
      <sec id="s2-1-5">
        <title>2.1.5 GloVe Algorithm</title>
        <p>The GloVe algorithm was then applied to our co-occurrence file in order to create an embedding transformation matrix of a set size <xref rid="B25" ref-type="bibr">Pennington et al. (2014)</xref>. GloVe stands for global vectors for word representation and is an unsupervised learning algorithm to generate word embeddings from aggregated global word-word co-occurrence data. When the algorithm is applied to ASV sequences instead of words, the result is a vector representation for each ASV in the set that represents co-occurrence patterns. Cosine distances between vectors represents probability of co-occurrence of the corresponding ASVs. Short distances between sequences represent higher probabilities of ASVs sharing co-occurrence patterns, while greater distances represent lower probabilities of sequences sharing co-occurrence patterns. Distances are normalized by how frequently ASVs occur overall. The algorithm was run three times with output vector sizes of 50, 100, and 250.</p>
      </sec>
      <sec id="s2-1-6">
        <title>2.1.6 PCA Algorithm</title>
        <p>The PCA transformation matrices were obtained using SVD decomposition on the sample by ASV count table, and taking the (<italic>V</italic>
<sup><italic>T</italic></sup>) matrix. Prior to decomposition, ASV count vectors were mean centered and scaled to have a variance of 1, to avoid issues with heteroskedasticity. <ext-link xlink:href="R/making_embedding_transformation_matrix/make_PCA_transformation_matrix.py" ext-link-type="uri">R/making_embedding_transformation_matrix/make_PCA_transformation_matrix.py</ext-link>.</p>
      </sec>
      <sec id="s2-1-7">
        <title>2.1.7 Creating BLAST Database for ASVs in Embedding Database</title>
        <p>The ASV sequences from the GloVe output were then used to create a FASTA formatted file. We then used the makeblastdb functionality of BLAST (Basic Local Alignment Search Tool) to generate a database based on the nucleotide sequences in our FASTA file. The database is used to check nucleotide sequences from other studies against our “embedding database” sequences. BLAST database files can be found here: <ext-link xlink:href="https://files.cgrb.oregonstate.edu/David_Lab/microbiome_embeddings/blastdb_fullseq/" ext-link-type="uri">https://files.cgrb.oregonstate.edu/David_Lab/microbiome_embeddings/blastdb_fullseq/</ext-link>.</p>
      </sec>
    </sec>
    <sec id="s2-2">
      <title>2.2 Transforming Query Data Into Embedding Space</title>
      <p><xref rid="F1" ref-type="fig">Figure 1</xref> shows the process implemented by the GMEmbeddings package to transform any query ASV count table into embedding space.</p>
      <fig position="float" id="F1">
        <label>FIGURE 1</label>
        <caption>
          <p>Embedding a dataset. <bold>(A)</bold> Start with query dataset (sample by ASV counts) and an embedding transformation matrix (either from GloVe or PCA run on the American Gut Project data). <bold>(B)</bold> BLAST ASV sequences from the query dataset against the sequences in the transformation matrix. Filter the BLAST output to include only top hits (min E-value, max percent identity, and max alignment length) per query sequence. <bold>(C)</bold> Assign ids from BLAST hit column to query sequences. If there are more than one best hit, split counts from original query sequence between all best hits equally. <bold>(D)</bold> Matrix multiply the query count table with the embedding transformation matrix.</p>
        </caption>
        <graphic xlink:href="fbinf-02-828703-g001" position="float"/>
      </fig>
      <sec id="s2-2-1">
        <title>2.2.1 BLAST Alignment</title>
        <p>To embed a query sequence table, we first created a corresponding FASTA file for the ASVs in that study. We then used BLAST to obtain all hits for each query sequence against the sequences in the embedding database:</p>
        <p>
          <inline-graphic xlink:href="fbinf-02-828703-fx5.jpg"/>
        </p>
      </sec>
      <sec id="s2-2-2">
        <title>2.2.2 Filter BLAST Output</title>
        <p>We filtered the BLAST hits to include only the top match per query sequence (lowest E-value, highest percent identity, and highest length of alignment). We kept matches with a maximum E-value threshold of 1*10<sup>−40</sup>. Using a 97% similarity threshold, the maximum E-value and minimum length of alignment observed and accepted are available in <xref rid="T1" ref-type="table">Table 1</xref>. See <ext-link xlink:href="R/makingembeddingtransformationmatrix/scripts/filterblasthits.sh" ext-link-type="uri">R/making embedding transformation matrix/scripts/filter blast hits.sh</ext-link>.</p>
        <table-wrap position="float" id="T1">
          <label>TABLE 1</label>
          <caption>
            <p>Maximum E-value and minimum length of alignment that were accepted in aligning sequences from each dataset to embedding transformation sequences.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">Dataset</th>
                <th align="center" rowspan="1" colspan="1">Max E-value accepted</th>
                <th align="center" rowspan="1" colspan="1">Min. Length of alignment accepted</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">Halfvarson</td>
                <td align="center" rowspan="1" colspan="1">3.72e-47</td>
                <td align="center" rowspan="1" colspan="1">89</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Schirmer</td>
                <td align="center" rowspan="1" colspan="1">2.41e-86</td>
                <td align="center" rowspan="1" colspan="1">133</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">M3</td>
                <td align="center" rowspan="1" colspan="1">4.91e-125</td>
                <td align="center" rowspan="1" colspan="1">129</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pilot</td>
                <td align="center" rowspan="1" colspan="1">9.04e-122</td>
                <td align="center" rowspan="1" colspan="1">110</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Baxter</td>
                <td align="center" rowspan="1" colspan="1">2.11e-133</td>
                <td align="center" rowspan="1" colspan="1">110</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Zeller</td>
                <td align="center" rowspan="1" colspan="1">2.11e-133</td>
                <td align="center" rowspan="1" colspan="1">121</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
      <sec id="s2-2-3">
        <title>2.2.3 Relabel Query Sequence Ids With Respective Hit IDs</title>
        <p>We relabeled query sequences with their respective hits in the embedding database. If the query sequence had only one top hit, we replaced its label with the label from the embedding database. If the sequence had multiple hits, we split its counts evenly among all of the top hits. If the sequence had over 100 hits that are all tied, it was dropped in an effort to increase the specificity of the method. If a query sequence had no hits, it was dropped. We also removed any sequences from the embedding transformation matrix that were never included as a top hit for any query sequence.</p>
      </sec>
      <sec id="s2-2-4">
        <title>2.2.4 Matrix Multiplication</title>
        <p>After the above processing, the column space of the query count table matched the rowspace of the embedding transformation matrix. We then took the dot product between the two matrices to obtain the embedded form of the query count table. In the final embedded table, rows were samples and columns were dimensions in embedding space. Ultimately, the embedded form of a matrix represents the original samples transformed into a mathematical space, taking into account the co-occurrence patterns of ASVs across a population.</p>
      </sec>
    </sec>
    <sec id="s2-3">
      <title>2.3 Machine Learning Process</title>
      <p>We trained seven random forest models per dataset to predict phenotype, one using normalized read counts, three using GloVe embedded data at 50, 100, and 250 dimensions, and three using PCA embedded data at 50, 100, and 250 dimensions.</p>
      <p>Model feature spaces had to match between training and testing sets, so some modification of feature spaces was required:<list list-type="simple"><list-item><p>1) For the model on normalized read counts, we included only the ASVs that were present in both datasets. We performed a BLAST alignment between the query dataset and AGP sequences using a 100% sequence similarity cutoff, and assigned the ASV full length sequences from AGP to the secondary dataset (similar to the process of embedding without matrix multiplication). Only the best hits were considered from the resulting BLAST alignment after imposing the 100% similarity cutoff. Read counts from the secondary dataset were split equally among all the tied best hits in the AGP data.</p></list-item><list-item><p>2) For the models based on embedded data, we followed the procedure outlined above in “Transforming Query Data into Embedding Space”.</p></list-item></list>
</p>
      <p>Prior to being fed to a machine learning model, all data was normalized using an inverse hyperbolic sin function, (<inline-formula id="inf1"><mml:math id="m1" overflow="scroll"><mml:msup><mml:mrow><mml:mi>sin</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which mimics the function log(2<italic>x</italic>) almost exactly, except for behavior near 0. Below 1, the log function returns a negative value, and is undefined at 0. In contrast, inverse hyperbolic sin does not fall below 0 when the argument is low, and is defined as 0 at 0 <xref rid="B4" ref-type="bibr">Burbidge et al. (1988)</xref>, <xref rid="B27" ref-type="bibr">Sankaran and Holmes (2019)</xref>. This function allows log transformation of counts without the addition of pseudocounts.</p>
      <p>All models were trained entirely on one large dataset and tested on an independent dataset, paired as follows (AGP: Halfvarson, AGP: HMP2, M3: Pilot, Baxter: Zeller). Datasets are described below. We used random forest predictive models, and set maximum tree depth to the square root of the number of input features and the number of trees to 100. Classes were weighted inversely to their a priori probabilities in the training dataset <inline-formula id="inf2"><mml:math id="m2" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mtext>_</mml:mtext><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For example, if the positive class is represented by 5% of the training samples, the weight on the positive class for the training classifier is 20, and the weight on the negative class is 1.</p>
    </sec>
    <sec id="s2-4">
      <title>2.4 Metabolic Pathway Correlation</title>
      <p>In order to interpret the dimensions that define embedding spaces, we correlated each dimension in embedding space to all prokaryotic metabolic pathways available in the KEGG database <xref rid="B16" ref-type="bibr">Kanehisa et al. (2015)</xref>. An infographic describing the process is available in <xref rid="s10" ref-type="sec">Supplementary File S1</xref>. First, we created a binary pathway (ko id) by gene (KO id) table describing which genes are present in which metabolic pathways using the KEGGREST API in R (A). Then, we created a matrix of gene (KO id) by ASVs by using PICRUSt <xref rid="B18" ref-type="bibr">Langille et al. (2013)</xref> (B). We multiplied the pathway by gene table (A) with the gene by ASV table (B) to obtain an ASV by pathway table (C), where higher values suggest a higher presence of a pathway in that organism. We then calculated the Spearman correlation between all columns of these two matrices to obtain a pathway by dimension correlation matrix. These values can be used to interpret dimensions in a biological context.</p>
    </sec>
    <sec id="s2-5">
      <title>2.5 Test Dataset Descriptions</title>
      <sec id="s2-5-1">
        <title>2.5.1 American Gut Project</title>
        <p>In the American Gut Project (AGP) dataset, the majority of samples come from participants residing in the United States (<italic>n</italic> = 6,634) and the United Kingdom (<italic>n</italic> = 2,071), with a small number of samples generated from people living in other countries and territories. Participants in the United States inhabit largely urban areas (<italic>n</italic> = 7,317), with rural (<italic>n</italic> = 29) and mixed (<italic>n</italic> = 98) communities (2010 U.S. Census data based on participant ZIP codes) contributing in much smaller numbers. These participants also span a wide range of ages, race, and ethnicity. The read length of each sequence was around 150 base pairs which, when merged, resulted in a read length of 250 base pairs.</p>
        <p>In the present study, we used a subset of 15,709 samples that were part of cohorts with <inline-formula id="inf3"><mml:math id="m3" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula>50 samples in the consortium. These samples contained a collective 898,855 ASVs. We removed ASVs present in less than 10 samples, and 50,425 ASVs remained, each 253 base pairs in length.</p>
      </sec>
      <sec id="s2-5-2">
        <title>2.5.2 Halfvarson</title>
        <p>The Halfvarson dataset <xref rid="B11" ref-type="bibr">Halfvarson et al. (2017)</xref> consists of 683 samples taken from 118 patients at multiple timepoints. Microbiome composition for each sample is ascertained by sequencing the V4 region of the 16S rRNA gene for a total of 248 million 16S rRNA gene amplicons and a total of 38,513 unique amplicon sequence variants (ASVs) at a read length of 253 bp.</p>
        <p>In the present study, we filtered to include only samples with the diagnoses Crohn’s disease (CD), ulcerative colitis (UC), and healthy control (HC). We used 608 of these samples from 118 patients (220 CD, 290 UC, and 54 HC samples). When embedding using a 97% similarity threshold, 15,998 ASVs (61%) from the Halfvarson dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 10.4 and a median of 2 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>). These same statistics applied to the PCA transformed data.</p>
      </sec>
      <sec id="s2-5-3">
        <title>2.5.3 HMP2</title>
        <p>The HMP2 study <xref rid="B19" ref-type="bibr">Lloyd-Price et al. (2019)</xref> follows 132 subjscts for 1 year to generate longitudinal molecular profiles.</p>
        <p>In the present study, we used only the 16S samples from the HMP2 study consisting of 197 samples taken from 83 individuals sampled at multiple timepoints (111 CD, 44 UC, 42 HC). This subsetted dataset contained a total of 5,869 unique ASVs at a length of 253 bp. When embedding using a 97% similarity threshold, 4,977 ASVs (85%) from the HMP2 dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 7.8 and a median of 2 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>). These same statistics applied to the PCA transformed data.</p>
      </sec>
      <sec id="s2-5-4">
        <title>2.5.4 M3</title>
        <p>The M3 dataset <xref rid="B34" ref-type="bibr">Tataru et al. (2021)</xref> consists of 432 total samples from 72 age-matched sibling pairs. The pairs included one sibling diagnosed with ASD and the other who is developing typically (TD). The participants were between the ages of 2 and 8 years old. Researchers recorded 331 diet and lifestyle variables for each individual participating in the study. For each sample collected there were an additional 100 variables detailing lifestyle and dietary variables recorded. Samples were collected across the United States. Before filtration, the average depth of reads per sample measured 157,103 nucleotides (with a minimum of 23,321 and maximum of 996,530). The dataset contains a total of 5,265 ASVs (16S V4) at a length of 233 bp.</p>
        <p>In the present study, all samples from the M3 dataset were used. When embedding using a 97% similarity threshold, 4,555 ASVs (87%) from the M3 dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 2 and a median of 1 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>).</p>
      </sec>
      <sec id="s2-5-5">
        <title>2.5.5 Pilot</title>
        <p>The dataset obtained from the Pilot study <xref rid="B7" ref-type="bibr">David et al. (2021)</xref> contained 117 samples, of which, 60 were considered autism spectrum disorder (ASD) and 57 were controls. The population in the study consisted of age-matched sibling pairs between the ages of 2 and 7 years old, where the siblings needed to be within 2 years of each other. Of the 117 child subjects, there were 55 sibling pairs, two sibling pairs accompanied by a third sibling with autism, and 5 singleton samples. Samples were collected from 24 states: California, Colorado, Florida, Georgia, Hawaii, Illinois, Indiana, Massachusetts, Maryland, Michigan, Minnesota, Missouri, North Carolina, Nebraska, New Jersey, Nevada, New York, Ohio, Pennsylvania, Tennessee, Texas, Utah, Washington, and Wisconsin. The dataset contains a total of 1,664 ASVs (16S V4) at a length of 233 bp.</p>
        <p>In the present study, all samples from the Pilot dataset were used. When embedding using a 97% similarity threshold, 1,500 ASVs (90%) from the pilot dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 1.8 and a median of 1 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>).</p>
      </sec>
      <sec id="s2-5-6">
        <title>2.5.6 Zeller</title>
        <p>The Zeller dataset <xref rid="B38" ref-type="bibr">Zeller et al. (2014)</xref> consists of three populations of participants: 129 colonoscopy patients from a French hospital (53 CRC, 42 adenoma, and 61 controls), 38 colorectal cancer patients from a German hospital, and 5 healthy individuals living in Germany. A subset of these participants were chosen for fecal sample 16s sequencing by the original authors for stool 16S sequencing.</p>
        <p>The present study used 75 control and 41 CRC samples, and this set of samples contained a total of 6,968 unique ASVs at a length of 253 bp. When embedding using a 97% similarity threshold, 5,581 ASVs (80%) from the Zeller dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 1.2 and a median of 1 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>).</p>
      </sec>
      <sec id="s2-5-7">
        <title>2.5.7 Baxter</title>
        <p>The Baxter dataset <xref rid="B3" ref-type="bibr">Baxter et al. (2016)</xref> contains participants of ages 29–89 years with a median of 60 years. All patients were asymptomatic and were excluded if they had undergone surgery, radiation, or chemotherapy for current CRC prior to baseline samples or had inflammatory bowel disease, known hereditary non-polyposis CRC, or familial adenomatous polyposis. Colonoscopies were performed and fecal samples were collected from participants in four locations: Toronto (ON, Canada), Boston (MA, United States), Houston (TX, United States), and Ann Arbor (MI, United States).</p>
        <p>The present study used 314 samples, (187 control and 127 CRC).</p>
        <p>When embedding using a 97% similarity threshold, 7,879 ASVs (88%) from the Baxter dataset aligned to some read in the embedding dataset (<xref rid="s10" ref-type="sec">Supplementary File S2</xref>). Each query sequence was aligned to a mean of 1.33 and a median of 1 embedding sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>).</p>
      </sec>
    </sec>
    <sec id="s2-6">
      <title>2.6 Metrics</title>
      <sec id="s2-6-1">
        <title>2.6.1 Precision</title>
        <p>Precision is an indicator of a model’s performance and refers to the number of true positives divided by the total number of positive predictions. Total number of positive predictions can be found by summing the number of true positives with the number of false positives.</p>
        <p>
          <inline-formula id="inf4">
            <mml:math id="m4" overflow="scroll">
              <mml:mi>p</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mi>c</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>s</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>o</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
      <sec id="s2-6-2">
        <title>2.6.2 Recall</title>
        <p>Recall gives indication of positive samples that the model has missed. It is calculated by dividing the number of true positives found by the model by the total number of positive samples that could have been made. The number of possible positive samples is the sum of true positives and false negatives.</p>
        <p>
          <inline-formula id="inf5">
            <mml:math id="m5" overflow="scroll">
              <mml:mi>r</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mi>c</mml:mi>
              <mml:mi>a</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>n</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>g</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
      <sec id="s2-6-3">
        <title>2.6.3 F1</title>
        <p>The F1 score is the weighted average of precision and recall. It takes both false positives and false negatives into account and tells us a model’s performance on a dataset. A perfect model would have an F1 score of 1.</p>
        <p>
          <inline-formula id="inf6">
            <mml:math id="m6" overflow="scroll">
              <mml:mi>F</mml:mi>
              <mml:mn>1</mml:mn>
              <mml:mi>S</mml:mi>
              <mml:mi>c</mml:mi>
              <mml:mi>o</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mo>*</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>*</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>3 Results</title>
    <p>From the sequence counts from the American Gut Project (AGP), we created GloVe and PCA based embedding transformation matrices at 50, 100, and 250 dimensions. We then projected the sequence tables from six independent datasets, as well as that from the AGP, into both GloVe and PCA spaces. We then trained random forest predictive models to predict host phenotype using microbiome data in one of seven forms (GloVe embedded at 50, 100, and 250 dimensions, PCA embedded at 50, 100, and 250 dimensions, and normalized ASV counts). For each phenotype of inflammatory bowel disease (IBD), autism spectrum disorder (ASD), and colorectal cancer (CRC), models were trained on one dataset and tested on an independent set with no fine-tuning. No other metadata about samples was included in addition to microbiome data.</p>
    <sec id="s3-1">
      <title>3.1 Inflammatory Bowel Disease Prediction</title>
      <p>Random forest models were trained on the American Gut Project data, then tested on both the Halfvarson and HMP2 datasets <xref rid="B11" ref-type="bibr">Halfvarson et al. (2017)</xref>, <xref rid="B19" ref-type="bibr">Lloyd-Price et al. (2019)</xref> to predict host phenotype of “healthy control” <italic>vs</italic>. “inflammatory bowel disease” which included Crohn’s disease and ulcerative colitis. On the Halfvarson test dataset, models that used normalized ASV counts (full) had a higher training performance but much lower testing performance than any of the other methods, implying an overfit model (<xref rid="F2" ref-type="fig">Figure 2</xref>; <xref rid="T2" ref-type="table">Table 2</xref>). Similarly, while larger models using 250 dimensions generalized to a testing set less well (f1 = 0.68–0.71), small models using only 50 dimensions were able to generalize much more effectively (f1 = 0.9–0.95). GloVe and PCA embedding methods exhibited largely similar performance, regardless of the choice of sequence alignment threshold (<xref rid="T2" ref-type="table">Table 2</xref>, <xref rid="s10" ref-type="sec">Supplementary File S4</xref>).</p>
      <fig position="float" id="F2">
        <label>FIGURE 2</label>
        <caption>
          <p>Predicting IBD: Model trained on AGP data and tested on Halfvarson data. <bold>(A)</bold>: Models built using GloVe embedded data, PCA embedded data (50, 100, or 250 dimensions), or normalized ASV counts performance on training and testing sets. <bold>(B)</bold>: Confusion matrices showing the distribution of correct to predicted classes on the testing dataset.</p>
        </caption>
        <graphic xlink:href="fbinf-02-828703-g002" position="float"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>TABLE 2</label>
        <caption>
          <p>Performance metrics of models trained on AGP data and tested on Halfvarson data using a 97, 99 and 100% sequence similarity threshold.</p>
          <p>
            <inline-graphic xlink:href="fbinf-02-828703-fx1.jpg"/>
          </p>
        </caption>
      </table-wrap>
      <p>On the HMP2 test dataset, a similar phenomenon emerged. The full model trained well but failed to generalize well to the testing dataset, and the larger embedding-based models performed less well than smaller embedding-based models (<xref rid="F3" ref-type="fig">Figure 3</xref>). Increasing sequence similarity threshold resulted in removing more original sequences (<xref rid="s10" ref-type="sec">Supplementary File S3</xref>), and in this case, decreased overall performance considerably (<xref rid="s10" ref-type="sec">Supplementary File S5</xref>, <xref rid="T3" ref-type="table">Table 3</xref>). There was similar performance between GloVe and PCA embedding-based models when using a 97% sequence similarity threshold, but PCA based methods maintained a higher performance as similarity threshold increased, as compared to GloVe based models (<xref rid="s10" ref-type="sec">Supplementary File S5</xref>, <xref rid="T3" ref-type="table">Table 3</xref>).</p>
      <fig position="float" id="F3">
        <label>FIGURE 3</label>
        <caption>
          <p>Predicting IBD: Model trained on AGP data and tested on HMP2 data. <bold>(A)</bold>: Models built using GloVe embedded data, PCA embedded data (50, 100, or 250 dimensions), or normalized ASV counts performance on training and testing sets. <bold>(B)</bold>: Confusion matrices showing the distribution of correct to predicted classes on the testing dataset. (full).</p>
        </caption>
        <graphic xlink:href="fbinf-02-828703-g003" position="float"/>
      </fig>
      <table-wrap position="float" id="T3">
        <label>TABLE 3</label>
        <caption>
          <p>Performance metrics of models trained on AGP data and tested on HMP2 data using a 97, 99 and 100% sequence similarity threshold.</p>
          <p>
            <inline-graphic xlink:href="fbinf-02-828703-fx2.jpg"/>
          </p>
        </caption>
      </table-wrap>
    </sec>
    <sec id="s3-2">
      <title>3.2 Austism Spectrum Disorder Prediction</title>
      <p>Random forest models were trained on the M3 dataset and tested on the Pilot dataset (see Test Dataset Descriptions) <xref rid="B34" ref-type="bibr">Tataru et al. (2021)</xref>, <xref rid="B7" ref-type="bibr">David et al. (2021)</xref> to classify the phenotype of participants with autism spectrum disorder and their typically developing siblings. While the full model outperformed other models during training, it obtained an F1 score of 0.56 in testing, while the GloVe_50, GloVe_100 models obtained higher F1 scores of 0.67, 0.66 respectively (<xref rid="F4" ref-type="fig">Figure 4</xref>; <xref rid="T4" ref-type="table">Table 4</xref>). Increasing sequence similarity threshold improved the performance of GloVe_250 and PCA_100 models, and did not significantly effect other models (<xref rid="s10" ref-type="sec">Supplementary File S6</xref>).</p>
      <fig position="float" id="F4">
        <label>FIGURE 4</label>
        <caption>
          <p>Predicting autism spectrum disorder: Model trained on the M3 dataset and tested on the Pilot dataset. <bold>(A)</bold>: Models built using GloVe embedded data, PCA embedded data (50, 100, or 250 dimensions), or normalized ASV counts performance on training and testing sets. <bold>(B)</bold>: Confusion matrices showing the distribution of correct to predicted classes on the testing dataset.</p>
        </caption>
        <graphic xlink:href="fbinf-02-828703-g004" position="float"/>
      </fig>
      <table-wrap position="float" id="T4">
        <label>TABLE 4</label>
        <caption>
          <p>Performance metrics of models trained on M3 data and tested on Pilot data using a 97, 99 and 100% sequence similarity threshold.</p>
          <p>
            <inline-graphic xlink:href="fbinf-02-828703-fx3.jpg"/>
          </p>
        </caption>
      </table-wrap>
    </sec>
    <sec id="s3-3">
      <title>3.3 Colorectal Cancer Prediction</title>
      <p>Random forest models were trained on the Baxter dataset and tested on the Zeller dataset (see Test Dataset Descriptions) <xref rid="B3" ref-type="bibr">Baxter et al. (2016)</xref>, <xref rid="B38" ref-type="bibr">Zeller et al. (2014)</xref> to classify the phenotype of participants with colorectal cancer <italic>vs</italic>. healthy controls. The full model had higher training performance but failed to generalize to the test set, and this trend repeated in the models built on more features in both GloVe and PCA based models. The highest performing models were PCA_50 and GloVe_50 with F1 scores of 0.45 and 0.4 respectively (<xref rid="F5" ref-type="fig">Figure 5</xref>; <xref rid="T5" ref-type="table">Table 5</xref>). Sequence similarity threshold had little effect on final performance (<xref rid="s10" ref-type="sec">Supplementary File S7</xref>, <xref rid="T5" ref-type="table">Table 5</xref>).</p>
      <fig position="float" id="F5">
        <label>FIGURE 5</label>
        <caption>
          <p>Predicting Colorectal Cancer: Models trained on the Baxter dataset and tested on the Zeller dataset. <bold>(A)</bold>: Models built using GloVe embedded data, PCA embedded data (50, 100, or 250 dimensions), or normalized ASV counts performance on training and testing sets. <bold>(B)</bold>: Confusion matrices showing the distribution of correct to predicted classes on the testing dataset.</p>
        </caption>
        <graphic xlink:href="fbinf-02-828703-g005" position="float"/>
      </fig>
      <table-wrap position="float" id="T5">
        <label>TABLE 5</label>
        <caption>
          <p>Performance metrics of models trained on Baxter data and tested on Zeller data using a 97, 99 and 100% sequence similarity threshold.</p>
          <p>
            <inline-graphic xlink:href="fbinf-02-828703-fx4.jpg"/>
          </p>
        </caption>
      </table-wrap>
    </sec>
    <sec id="s3-4">
      <title>3.4 Metabolic Pathway Correlation</title>
      <p>We correlated each embedding dimension with metabolic pathway genetic potential obtained from KEGG and PiCrust (See Methods). From this, we saw that dimensions all correlate to some groupings of metabolic pathways but not others (<xref rid="s10" ref-type="sec">Supplementary Files S8–S13</xref>). This serves as a starting point in interpreting the biological functions of the otherwise mathematically defined dimensions in embedding space.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>4 Discussion</title>
    <p>16S studies often result in spurious associations between specific ASVs and host phenotype due to necessarily small sample sizes in comparison to feature spaces and the treatment of ASVs as independent features <xref rid="B28" ref-type="bibr">Schloss (2018)</xref>, <xref rid="B14" ref-type="bibr">Ioannidis (2005)</xref>, <xref rid="B10" ref-type="bibr">Fan et al. (2012)</xref>. Embedding methods can address these issues by defining a new feature space, which can be thought of as combinations of ASVs, where ASVs are considered similar if they share co-occurrence or co-abundance patterns across a large dataset <xref rid="B25" ref-type="bibr">Pennington et al. (2014)</xref>. Applying embedding methods to smaller datasets can increase the generalization of predictive classifiers that use gut microbiome data, and may lead to new insights about overarching microbial properties that independent ASV counts do not otherwise reflect <xref rid="B33" ref-type="bibr">Tataru and David (2020)</xref>.</p>
    <p>The embedding methods presented here are aimed to address the curse of dimensionality caused by a large number of variables (ASVs) measured across a relatively small number of samples. Machine learning models with too many input variables can easily overfit the training data, as observed with the normalized count data in this study. In addition, having too many input variables can saturate distance metrics, giving datapoints unique feature subsets that cause them to all appear equidistant <xref rid="B2" ref-type="bibr">Bai (2014)</xref>. By reducing the dimensionality of the input data, we show that models are able to learn generalizable microbial patterns of disease and avoid overfitting on biomarkers specific to single datasets.</p>
    <p>In the datasets tested, 50 dimensions offered the best, most consistently high performance on test set predictions. PCA-based transformation obtained higher recall without significant drop in precision as compared to GloVe-based transformation, but, in these datasets, both obtained considerably improved performance over the method of using normalized ASV counts. In most datasets, increasing the sequence similarity threshold did not affect generalizable performance significantly, with the exception of the HMP2 dataset where increasing threshold decreased recall significantly. This may be due to the relatively low number of original sequences utilized in embedding under the more stringent threshold.</p>
    <sec id="s4-1">
      <title>4.1 Comparison to Other Work</title>
      <p>Kubinski et al. tested machine learning predictive models using a leave one study out cross-validation across 15 IBD datasets that performed 16s sequencing on stool samples. Their random forest models obtained average F1 scores of 0.72 across studies when using species level annotations <xref rid="B17" ref-type="bibr">Kubinski et al. (2021)</xref>. A study from Manandhar et al. also obtained a similar F1 score of 0.74 on a hold-on test portion of the American Gut Projet dataset <xref rid="B20" ref-type="bibr">Manandhar et al. (2021)</xref>. These performances are just below the IBD testing results from this study using the Embed 50 and PCA50 models (F1 = 0.82–0.95) on HMP2 and Halfvarson datasets respectively. Interestingly, a study from Hassouneh et al. that combined metagenomic features (as opposed to 16s) and included 3 independent datasets obtained an F1 score 0.87, suggesting that perhaps the integration of multiple datasets into the training data combined with the use of non-amplicon microbiome features may lead to increased accuracy <xref rid="B12" ref-type="bibr">Hassouneh et al. (2021)</xref>.</p>
      <p>Wu et al. tested the predictive power of 16s microbiome features in predictive autism by annotating OTUs from five studies at the genus level, then applying a random forest model. When training on one dataset and testing on another, the models’ performance ranged from an F1 of 0.17–0.73 <xref rid="B36" ref-type="bibr">Wu et al. (2020)</xref>. In comparison, the best performing model in the present study, GloVe_50, obtained an F1 of 0.68 on the testing data. Though they did not report F1 scores, other studies have reported surprisingly high values for area under the receiver operating curve when predicting autism (AUC = 0.93 and 0.98)<xref rid="B8" ref-type="bibr">Ding et al. (2020)</xref>, <xref rid="B6" ref-type="bibr">Dan et al. (2020)</xref>. This exceedingly high performance may be attributable to the sampling strategy, where ASD participants were recruited from the local hospital and typically developing participants from local kindergardens.</p>
      <p>Wu et al. created a classifier that used fecal microbiome 16s sequences as well as age, sex, and BMI to distinguish patients with adenomas from colorectal cancer patients, and obtained an F1 score of 0.72. Models with equivalent hyperparameters and feature inputs trained on additional datasets also obtained F1 scores of 0.77 and 0.72) <xref rid="B37" ref-type="bibr">Wu et al. (2021)</xref>. This is in line with the training F1 score obtained from the full model in this study from the Baxter data (F1 = 0.86) but higher than the training scores obtained from embedding methods (F1 = 0.58–0.68). Zhou et al. trained a random forest classifier to differentiate CRC from healthy controls using the same Baxter dataset presented in this study, and obtained an F1 score of 0.41, which is in the range of the F1 scores obtained here when testing the PCA50 model on an independent dataset (F1 = 0.43) <xref rid="B39" ref-type="bibr">Zhou et al. (2021)</xref>. Neither of these studies tested their pre-trained models on independent datasets, so their true generalization capacity remains untested.</p>
    </sec>
    <sec id="s4-2">
      <title>4.2 Limitations</title>
      <p>This study used only the American Gut Project data to form the embedding transformation matrices. Integration of other, independent datasets would likely make the transformation process even more generalizable, especially to populations outside the United States.</p>
      <p>In addition, Dada2 processing of reads and error model learning was performed on all the sequencing runs from the American Gut Project simultaneously in order to obtain one set of ASVs for all samples. This resulted in over 800,000 ASVs, most of which were not present in more than 10 samples. Learning an error model per sequencing run may have resulted in a lower rate of chimeric ASVs, which may have seen higher presence across samples <xref rid="B5" ref-type="bibr">Callahan et al. (2016)</xref>.</p>
      <p>While data transformed with either PCA or GloVe did provide grounds for more generalizable models, the interpretation of the learned representation remains a challenge. We find that correlations between learned taxa vector representations and metabolic pathway potential exist, however, each dimension correlates to a mixture of pathways, making direct implications difficult to conclude. In previous work, we found that mixtures of phylogenetic signal are also captured by learned dimensions <xref rid="B33" ref-type="bibr">Tataru and David (2020)</xref>. Utilizing other natural language processing methods for dimensionality reduction like deep learning networks may allow us to take advantage of other interpretation methods like attention, saliency maps, or explanation generation to obtain a more complete understanding of the system <xref rid="B31" ref-type="bibr">Sun et al. (2021)</xref>.</p>
      <p>Lastly, the embedding matrices provided are specific to human gut microbiomes as measured from stool–embedding matrices for other biomes will be provided in future iterations.</p>
    </sec>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>Publicly available datasets were analyzed in this study. This data can be found here: Halfvarson dataset: accession number PRJEB18471: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJEB18471" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/bioproject/PRJEB18471</ext-link>, HMP2 dataset: accession number PRJNA389280: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA389280" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA389280</ext-link>, Zeller dataset: accession number PRJEB18471: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJEB18471" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/bioproject/PRJEB18471</ext-link>, Baxter dataset: accession number PRJNA290926: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA290926" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA290926</ext-link>, M3 dataset: <ext-link xlink:href="https://files.cgrb.oregonstate.edu/David_Lab/M3/" ext-link-type="uri">https://files.cgrb.oregonstate.edu/David_Lab/M3/</ext-link>, Pilot dataset: <ext-link xlink:href="https://files.cgrb.oregonstate.edu/David_Lab/M3_longitudinal_16s" ext-link-type="uri">https://files.cgrb.oregonstate.edu/David_Lab/M3_longitudinal_16s</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>CT: Conception, design, analysis, interpretation, manuscript preparation. AE: Data collection, data processing, manuscript preparation. MD: Conception, design.</p>
  </sec>
  <sec id="s7">
    <title>Funding</title>
    <p>This work was supported in part with funds from NSF Award ID 2025457, NIH Award NIDA R44DA04395402, and the Larry W. Martin Joyce B. O’Neill Endowed Fellowship. The funding bodies did not play any role in the design, collection, analysis, interpretation or writing of the study.</p>
  </sec>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec id="s10">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fbinf.2022.828703/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fbinf.2022.828703/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="DataSheet1.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albright</surname><given-names>M. B. N.</given-names></name><name><surname>Louca</surname><given-names>S.</given-names></name><name><surname>Winkler</surname><given-names>D. E.</given-names></name><name><surname>Feeser</surname><given-names>K. L.</given-names></name><name><surname>Haig</surname><given-names>S. J.</given-names></name><name><surname>Whiteson</surname><given-names>K. L.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Solutions in Microbiome Engineering: Prioritizing Barriers to Organism Establishment</article-title>. <source>ISME J.</source>
<pub-id pub-id-type="doi">10.1038/s41396-021-01088-5</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>E.-w.</given-names></name></person-group> (<year>2014</year>). “<article-title>Big Data: The Curse of Dimensionality in Modeling</article-title>,” in <conf-name>Proceedings of the 33rd Chinese Control Conference</conf-name>, <fpage>6</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1109/chicc.2014.6896586</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baxter</surname><given-names>N. T.</given-names></name><name><surname>Ruffin</surname><given-names>M. T.</given-names></name><name><surname>Rogers</surname><given-names>M. A.</given-names></name><name><surname>Schloss</surname><given-names>P. D.</given-names></name></person-group> (<year>2016</year>). <article-title>Microbiota-based Model Improves the Sensitivity of Fecal Immunochemical Test for Detecting Colonic Lesions</article-title>. <source>Genome Med.</source>
<volume>8</volume>, <fpage>37</fpage>. <pub-id pub-id-type="doi">10.1186/s13073-016-0290-3</pub-id>
<pub-id pub-id-type="pmid">27056827</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burbidge</surname><given-names>J. B.</given-names></name><name><surname>Magee</surname><given-names>L.</given-names></name><name><surname>Robb</surname><given-names>A. L.</given-names></name></person-group> (<year>1988</year>). <article-title>Alternative Transformations to Handle Extreme Values of the Dependent Variable</article-title>. <source>J. Am. Stat. Assoc.</source>
<volume>83</volume>, <fpage>123</fpage>–<lpage>127</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1988.10478575</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname><given-names>B. J.</given-names></name><name><surname>McMurdie</surname><given-names>P. J.</given-names></name><name><surname>Rosen</surname><given-names>M. J.</given-names></name><name><surname>Han</surname><given-names>A. W.</given-names></name><name><surname>Johnson</surname><given-names>A. J.</given-names></name><name><surname>Holmes</surname><given-names>S. P.</given-names></name></person-group> (<year>2016</year>). <article-title>DADA2: High-Resolution Sample Inference from Illumina Amplicon Data</article-title>. <source>Nat. Methods</source>
<volume>13</volume>, <fpage>581</fpage>–<lpage>583</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
<pub-id pub-id-type="pmid">27214047</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dan</surname><given-names>Z.</given-names></name><name><surname>Mao</surname><given-names>X.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name><name><surname>Guo</surname><given-names>M.</given-names></name><name><surname>Zhuang</surname><given-names>Y.</given-names></name><name><surname>Liu</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Altered Gut Microbial Profile Is Associated with Abnormal Metabolism Activity of Autism Spectrum Disorder</article-title>. <source>Gut Microbes</source>
<volume>11</volume>, <fpage>1246</fpage>–<lpage>1267</lpage>. <pub-id pub-id-type="doi">10.1080/19490976.2020.1747329</pub-id>
<pub-id pub-id-type="pmid">32312186</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>David</surname><given-names>M. M.</given-names></name><name><surname>Tataru</surname><given-names>C.</given-names></name><name><surname>Daniels</surname><given-names>J.</given-names></name><name><surname>Schwartz</surname><given-names>J.</given-names></name><name><surname>Keating</surname><given-names>J.</given-names></name><name><surname>Hampton-Marcell</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2021</year>). <source>Children with Autism and Their Typically Developing Siblings Differ in Amplicon Sequence Variants and Predicted Functions of Stool-Associated Microbes</source>. <comment>mSystems 6</comment>. </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>X.</given-names></name><name><surname>Xu</surname><given-names>Y.</given-names></name><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>L.</given-names></name><name><surname>Duan</surname><given-names>G.</given-names></name><name><surname>Song</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Gut Microbiota Changes in Patients with Autism Spectrum Disorders</article-title>. <source>J. Psychiatr. Res.</source>
<volume>129</volume>, <fpage>149</fpage>–<lpage>159</lpage>. <pub-id pub-id-type="doi">10.1016/j.jpsychires.2020.06.032</pub-id>
<pub-id pub-id-type="pmid">32912596</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duvallet</surname><given-names>C.</given-names></name><name><surname>Gibbons</surname><given-names>S. M.</given-names></name><name><surname>Gurry</surname><given-names>T.</given-names></name><name><surname>Irizarry</surname><given-names>R. A.</given-names></name><name><surname>Alm</surname><given-names>E. J.</given-names></name></person-group> (<year>2017</year>). <article-title>Meta-analysis of Gut Microbiome Studies Identifies Disease-specific and Shared Responses</article-title>. <source>Nat. Commun.</source>
<volume>8</volume>, <fpage>1784</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-017-01973-8</pub-id>
<pub-id pub-id-type="pmid">29209090</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>J.</given-names></name><name><surname>Guo</surname><given-names>S.</given-names></name><name><surname>Hao</surname><given-names>N.</given-names></name></person-group> (<year>2012</year>). <article-title>Variance Estimation Using Refitted Cross-Validation in Ultrahigh Dimensional Regression</article-title>. <source>J. R. Stat. Soc. Ser. B Stat Methodol</source>
<volume>74</volume>, <fpage>37</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01005.x</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halfvarson</surname><given-names>J.</given-names></name><name><surname>Brislawn</surname><given-names>C. J.</given-names></name><name><surname>Lamendella</surname><given-names>R.</given-names></name><name><surname>Vázquez-Baeza</surname><given-names>Y.</given-names></name><name><surname>Walters</surname><given-names>W. A.</given-names></name><name><surname>Bramer</surname><given-names>L. M.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Dynamics of the Human Gut Microbiome in Inflammatory Bowel Disease</article-title>. <source>Nat. Microbiol.</source>
<volume>2</volume>, <fpage>17004</fpage>. <pub-id pub-id-type="doi">10.1038/nmicrobiol.2017.4</pub-id>
<pub-id pub-id-type="pmid">28191884</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hassouneh</surname><given-names>S. A.</given-names></name><name><surname>Loftus</surname><given-names>M.</given-names></name><name><surname>Yooseph</surname><given-names>S.</given-names></name></person-group> (<year>2021</year>). <article-title>Linking Inflammatory Bowel Disease Symptoms to Changes in the Gut Microbiome Structure and Function</article-title>. <source>Front. Microbiol.</source>
<volume>12</volume>, <fpage>673632</fpage>. <pub-id pub-id-type="doi">10.3389/fmicb.2021.673632</pub-id>
<pub-id pub-id-type="pmid">34349736</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holman</surname><given-names>D. B.</given-names></name><name><surname>Gzyl</surname><given-names>K. E.</given-names></name></person-group> (<year>2019</year>). <article-title>A Meta-Analysis of the Bovine Gastrointestinal Tract Microbiota</article-title>. <source>FEMS Microbiol. Ecol. 95</source>. <pub-id pub-id-type="doi">10.1093/femsec/fiz072</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ioannidis</surname><given-names>J. P.</given-names></name></person-group> (<year>2005</year>). <article-title>Why Most Published Research Findings Are False</article-title>. <source>Plos Med.</source>
<volume>2</volume>, <fpage>e124</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pmed.0020124</pub-id>
<pub-id pub-id-type="pmid">16060722</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>J. S.</given-names></name><name><surname>Spakowicz</surname><given-names>D. J.</given-names></name><name><surname>Hong</surname><given-names>B. Y.</given-names></name><name><surname>Petersen</surname><given-names>L. M.</given-names></name><name><surname>Demkowicz</surname><given-names>P.</given-names></name><name><surname>Chen</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Evaluation of 16S rRNA Gene Sequencing for Species and Strain-Level Microbiome Analysis</article-title>. <source>Nat. Commun.</source>
<volume>10</volume>, <fpage>5029</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-13036-1</pub-id>
<pub-id pub-id-type="pmid">31695033</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M.</given-names></name><name><surname>Sato</surname><given-names>Y.</given-names></name><name><surname>Kawashima</surname><given-names>M.</given-names></name><name><surname>Furumichi</surname><given-names>M.</given-names></name><name><surname>Tanabe</surname><given-names>M.</given-names></name></person-group> (<year>2015</year>). <article-title>KEGG as a Reference Resource for Gene and Protein Annotation</article-title>. <source>Nucleic Acids Res.</source>
<volume>44</volume>, <fpage>D457</fpage>–<lpage>D462</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv1070</pub-id>
<pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kubinski</surname><given-names>R.</given-names></name><name><surname>Djamen-Kepaou</surname><given-names>J.-Y.</given-names></name><name><surname>Zhanabaev</surname><given-names>T.</given-names></name><name><surname>Hernandez-Garcia</surname><given-names>A.</given-names></name><name><surname>Bauer</surname><given-names>S.</given-names></name><name><surname>Hildebrand</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2021</year>). <source>Benchmark of Data Processing Methods and Machine Learning Models for Gut Microbiome-Based Diagnosis of Inflammatory Bowel Disease</source>. <comment>bioRxiv</comment>. <pub-id pub-id-type="doi">10.1101/2021.05.03.442488</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langille</surname><given-names>M. G.</given-names></name><name><surname>Zaneveld</surname><given-names>J.</given-names></name><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><name><surname>McDonald</surname><given-names>D.</given-names></name><name><surname>Knights</surname><given-names>D.</given-names></name><name><surname>Reyes</surname><given-names>J. A.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Predictive Functional Profiling of Microbial Communities Using 16S rRNA Marker Gene Sequences</article-title>. <source>Nat. Biotechnol.</source>
<volume>31</volume>, <fpage>814</fpage>–<lpage>821</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id>
<pub-id pub-id-type="pmid">23975157</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lloyd-Price</surname><given-names>J.</given-names></name><name><surname>Arze</surname><given-names>C.</given-names></name><name><surname>Ananthakrishnan</surname><given-names>A. N.</given-names></name><name><surname>Schirmer</surname><given-names>M.</given-names></name><name><surname>Avila-Pacheco</surname><given-names>J.</given-names></name><name><surname>Poon</surname><given-names>T. W.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Multi-omics of the Gut Microbial Ecosystem in Inflammatory Bowel Diseases</article-title>. <source>Nature</source>
<volume>569</volume>, <fpage>655</fpage>–<lpage>662</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-019-1237-9</pub-id>
<pub-id pub-id-type="pmid">31142855</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manandhar</surname><given-names>I.</given-names></name><name><surname>Alimadadi</surname><given-names>A.</given-names></name><name><surname>Aryal</surname><given-names>S.</given-names></name><name><surname>Munroe</surname><given-names>P. B.</given-names></name><name><surname>Joe</surname><given-names>B.</given-names></name><name><surname>Cheng</surname><given-names>X.</given-names></name></person-group> (<year>2021</year>). <article-title>Gut Microbiome-Based Supervised Machine Learning for Clinical Diagnosis of Inflammatory Bowel Diseases</article-title>. <source>Am. J. Physiol. Gastrointest. Liver Physiol.</source>
<volume>320</volume>, <fpage>G328</fpage>–<lpage>G337</lpage>. <pub-id pub-id-type="doi">10.1152/ajpgi.00360.2020</pub-id>
<pub-id pub-id-type="pmid">33439104</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>M.</given-names></name></person-group> (<year>2011</year>). <article-title>Cutadapt Removes Adapter Sequences from High-Throughput Sequencing Reads</article-title>. <source>EMBnet j.</source>
<volume>17</volume>, <fpage>10</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>D.</given-names></name><name><surname>Hyde</surname><given-names>E.</given-names></name><name><surname>Debelius</surname><given-names>J. W.</given-names></name><name><surname>Morton</surname><given-names>J. T.</given-names></name><name><surname>Gonzalez</surname><given-names>A.</given-names></name><name><surname>Ackermann</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>American Gut: an Open Platform for Citizen Science Microbiome Research</article-title>. <comment>mSystems 3</comment>
</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mukherjee</surname><given-names>S.</given-names></name><name><surname>Huntemann</surname><given-names>M.</given-names></name><name><surname>Ivanova</surname><given-names>N.</given-names></name><name><surname>Kyrpides</surname><given-names>N. C.</given-names></name><name><surname>Pati</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>). <article-title>Large-scale Contamination of Microbial Isolate Genomes by Illumina PhiX Control</article-title>. <source>Stand. Genomic Sci.</source>
<volume>10</volume>, <fpage>18</fpage>. <pub-id pub-id-type="doi">10.1186/1944-3277-10-18</pub-id>
<pub-id pub-id-type="pmid">26203331</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>K.</given-names></name></person-group> (<year>1901</year>). <article-title>Liii. On Lines and Planes of Closest Fit to Systems of Points in Space</article-title>. <source>Lond. Edinb. Dublin Phil. Mag. J. Sci.</source>
<volume>2</volume>, <fpage>559</fpage>–<lpage>572</lpage>. <pub-id pub-id-type="doi">10.1080/14786440109462720</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pennington</surname><given-names>J.</given-names></name><name><surname>Socher</surname><given-names>R.</given-names></name><name><surname>Manning</surname><given-names>C. D.</given-names></name></person-group> (<year>2014</year>). “<article-title>Glove: Global Vectors for Word Representation</article-title>,” in <conf-name>Empirical Methods in Natural Language Processing (EMNLP)</conf-name>, <fpage>1532</fpage>–<lpage>1543</lpage>. <pub-id pub-id-type="doi">10.3115/v1/d14-1162</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruff</surname><given-names>W. E.</given-names></name><name><surname>Greiling</surname><given-names>T. M.</given-names></name><name><surname>Kriegel</surname><given-names>M. A.</given-names></name></person-group> (<year>2020</year>). <article-title>Host-microbiota Interactions in Immune-Mediated Diseases</article-title>. <source>Nat. Rev. Microbiol.</source>
<volume>18</volume>, <fpage>521</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1038/s41579-020-0367-2</pub-id>
<pub-id pub-id-type="pmid">32457482</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sankaran</surname><given-names>K.</given-names></name><name><surname>Holmes</surname><given-names>S. P.</given-names></name></person-group> (<year>2019</year>). <article-title>Latent Variable Modeling for the Microbiome</article-title>. <source>Biostatistics</source>
<volume>20</volume>, <fpage>599</fpage>–<lpage>614</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxy018</pub-id>
<pub-id pub-id-type="pmid">29868846</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schloss</surname><given-names>P. D.</given-names></name></person-group> (<year>2018</year>). <source>Identifying and Overcoming Threats to Reproducibility, Replicability, Robustness, and Generalizability in Microbiome Research</source>. <comment>mBio 9</comment>. </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharpton</surname><given-names>T. J.</given-names></name><name><surname>Stagaman</surname><given-names>K.</given-names></name><name><surname>Sieler</surname><given-names>M. J.</given-names></name><name><surname>Arnold</surname><given-names>H. K.</given-names></name><name><surname>Davis</surname><given-names>E. W.</given-names></name></person-group> (<year>2021</year>). <article-title>Phylogenetic Integration Reveals the Zebrafish Core Microbiome and its Sensitivity to Environmental Exposures</article-title>. <source>Toxics 9</source>. <pub-id pub-id-type="doi">10.3390/toxics9010010</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoaie</surname><given-names>S.</given-names></name><name><surname>Karlsson</surname><given-names>F.</given-names></name><name><surname>Mardinoglu</surname><given-names>A.</given-names></name><name><surname>Nookaew</surname><given-names>I.</given-names></name><name><surname>Bordel</surname><given-names>S.</given-names></name><name><surname>Nielsen</surname><given-names>J.</given-names></name></person-group> (<year>2013</year>). <article-title>Understanding the Interactions between Bacteria in the Human Gut through Metabolic Modeling</article-title>. <source>Sci. Rep.</source>
<volume>3</volume>, <fpage>2532</fpage>. <pub-id pub-id-type="doi">10.1038/srep02532</pub-id>
<pub-id pub-id-type="pmid">23982459</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>X.</given-names></name><name><surname>Yang</surname><given-names>D.</given-names></name><name><surname>Li</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>T.</given-names></name><name><surname>Meng</surname><given-names>Y.</given-names></name><name><surname>Qiu</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2021</year>). <source>Interpreting Deep Learning Models in Natural Language Processing: A Review</source>. <comment>CoRR abs/2110.10470</comment>. </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sze</surname><given-names>M. A.</given-names></name><name><surname>Schloss</surname><given-names>P. D.</given-names></name></person-group> (<year>2016</year>). <source>Looking for a Signal in the Noise: Revisiting Obesity and the Microbiome</source>. <comment>mBio 7</comment>. </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tataru</surname><given-names>C. A.</given-names></name><name><surname>David</surname><given-names>M. M.</given-names></name></person-group> (<year>2020</year>). <article-title>Correction: Decoding the Language of Microbiomes Using Word-Embedding Techniques, and Applications in Inflammatory Bowel Disease</article-title>. <source>Plos Comput. Biol.</source>
<volume>16</volume>, <fpage>e1008423</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008423</pub-id>
<pub-id pub-id-type="pmid">33137111</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tataru</surname><given-names>C.</given-names></name><name><surname>Martin</surname><given-names>A.</given-names></name><name><surname>Dunlap</surname><given-names>K.</given-names></name><name><surname>Peras</surname><given-names>M.</given-names></name><name><surname>Chrisman</surname><given-names>B.</given-names></name><name><surname>Rutherford</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Longitudinal Study of Stool-Associated Microbial Taxa in Sibling Pairs with and without Autism Spectrum Disorder</article-title>. <source>ISME Commun. Accepted</source>. <pub-id pub-id-type="doi">10.1038/s43705-021-00080-6</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wirbel</surname><given-names>J.</given-names></name><name><surname>Zych</surname><given-names>K.</given-names></name><name><surname>Essex</surname><given-names>M.</given-names></name><name><surname>Karcher</surname><given-names>N.</given-names></name><name><surname>Kartal</surname><given-names>E.</given-names></name><name><surname>Salazar</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Microbiome Meta-Analysis and Cross-Disease Comparison Enabled by the SIAMCAT Machine Learning Toolbox</article-title>. <source>Genome Biol.</source>
<volume>22</volume>, <fpage>93</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-021-02306-1</pub-id>
<pub-id pub-id-type="pmid">33785070</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>T.</given-names></name><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Lu</surname><given-names>W.</given-names></name><name><surname>Zhai</surname><given-names>Q.</given-names></name><name><surname>Zhang</surname><given-names>Q.</given-names></name><name><surname>Yuan</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Potential of Gut Microbiome for Detection of Autism Spectrum Disorder</article-title>. <source>Microb. Pathog.</source>
<volume>149</volume>, <fpage>104568</fpage>. <pub-id pub-id-type="doi">10.1016/j.micpath.2020.104568</pub-id>
<pub-id pub-id-type="pmid">33096147</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y.</given-names></name><name><surname>Jiao</surname><given-names>N.</given-names></name><name><surname>Zhu</surname><given-names>R.</given-names></name><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>D.</given-names></name><name><surname>Wang</surname><given-names>A. J.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Identification of Microbial Markers across Populations in Early Detection of Colorectal Cancer</article-title>. <source>Nat. Commun.</source>
<volume>12</volume>, <fpage>3063</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-021-23265-y</pub-id>
<pub-id pub-id-type="pmid">34031391</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeller</surname><given-names>G.</given-names></name><name><surname>Tap</surname><given-names>J.</given-names></name><name><surname>Voigt</surname><given-names>A. Y.</given-names></name><name><surname>Sunagawa</surname><given-names>S.</given-names></name><name><surname>Kultima</surname><given-names>J. R.</given-names></name><name><surname>Costea</surname><given-names>P. I.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Potential of Fecal Microbiota for Early-Stage Detection of Colorectal Cancer</article-title>. <source>Mol. Syst. Biol.</source>
<volume>10</volume>, <fpage>766</fpage>. <pub-id pub-id-type="doi">10.15252/msb.20145645</pub-id>
<pub-id pub-id-type="pmid">25432777</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>J.</given-names></name><name><surname>Ye</surname><given-names>Y.</given-names></name><name><surname>Jiang</surname><given-names>J.</given-names></name></person-group> (<year>2021</year>). <article-title>Kernel Principal Components Based cascade forest towards Disease Identification with Human Microbiota</article-title>. <source>BMC Med. Inform. Decis. Mak</source>
<volume>21</volume>, <fpage>360</fpage>. <pub-id pub-id-type="doi">10.1186/s12911-021-01705-5</pub-id>
<pub-id pub-id-type="pmid">34949186</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
