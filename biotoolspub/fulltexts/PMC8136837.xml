<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName nihms2pmcx2.xsl?>
<?ConverterInfo.Version 1?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8136837</article-id>
    <article-id pub-id-type="pmid">31712779</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0624-3</article-id>
    <article-id pub-id-type="manuscript">nihpa1540809</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FreeHi-C simulates high fidelity Hi-C data for benchmarking and data augmentation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Ye</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keleş</surname>
          <given-names>Sündüz</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="CR1" ref-type="corresp">3</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Statistics, University of Wisconsin - Madison, Madison, WI 53706, USA</aff>
    <aff id="A2"><label>2</label>Department of Biostatistics and Medical Informatics, University of Wisconsin - Madison, Madison, WI 53706, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1"><bold>Author Contributions</bold> S.K. and Y.Z. conceived the project. Y.Z. and S.K. designed the research and developed the method. Y.Z. developed the simulation framework and performed the experiments. Both authors contributed to the preparation of the manuscript.</p>
      </fn>
      <corresp id="CR1"><label>3</label>Corresponding author: <email>keles@stat.wisc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>11</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>1</issue>
    <fpage>37</fpage>
    <lpage>40</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0624-3-->
    <permissions>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://www.nature.com/authors/editorial_policies/license.html#terms</ali:license_ref>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P2">Ability to simulate high-throughput chromatin conformation (Hi-C) data is foundational for benchmarking Hi-C data analysis methods. Here we present a non-parametric strategy named FreeHi-C to simulate Hi-C data from the interacting genome fragments. Data from FreeHi-C exhibit high fidelity to biological Hi-C data. FreeHi-C boosts the precision and power of differential chromatin interaction detection through data augmentation under preserved false discovery rate control.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P3">Recent maturation of chromosome conformation capture (3C)<sup><xref rid="R1" ref-type="bibr">1</xref></sup> and Hi-C sequencing technologies<sup><xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R3" ref-type="bibr">3</xref></sup> revealed transformative insights on long-range gene regulation<sup><xref rid="R4" ref-type="bibr">4</xref></sup>. A growing number of methods<sup><xref rid="R5" ref-type="bibr">5</xref>–<xref rid="R12" ref-type="bibr">12</xref></sup> emerged for the analysis of Hi-C and other 3C-derived data. Benchmarking and evaluation of Hi-C methods have relied on either conducting distance-stratified permutations of the contact matrices<sup><xref rid="R5" ref-type="bibr">5</xref></sup> or directly simulating them with the most general spatial structures<sup><xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R11" ref-type="bibr">11</xref></sup>. Additionally, pooling and random partitioning of replicates to generate pseudo-replicates and downsampling are prevalent approaches for studying similarity metrics and sequencing depth effects<sup><xref rid="R5" ref-type="bibr">5</xref>, <xref rid="R8" ref-type="bibr">8</xref>, <xref rid="R11" ref-type="bibr">11</xref>, <xref rid="R13" ref-type="bibr">13</xref></sup>. A systematic Hi-C simulation method, Sim3C<sup><xref rid="R14" ref-type="bibr">14</xref></sup>, was proposed for the design of Hi-C experiments with respect to the power analysis and the selection of restriction enzyme and sequencing depth. However, the strong focus of Sim3C on microbial genomics and metagenomics negates its utility for common Hi-C experiments<sup><xref rid="R15" ref-type="bibr">15</xref></sup> (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 1</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>).</p>
  <p id="P4">Here we present FreeHi-C (<bold>Fr</bold>agment interactions <bold>e</bold>mpirical <bold>e</bold>stimation for fast simulation of <bold>Hi-C</bold> data), as a robust method that nonparametrically simulates realistic read-level Hi-C data by emulating the standard Hi-C experimental protocol<sup><xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R3" ref-type="bibr">3</xref></sup> (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). FreeHi-C takes as input Hi-C sequencing data and estimates the frequency of genomic fragment interactions. This is fundamentally different from existing methods that simulate Hi-C contact matrices under a series of assumptions<sup><xref rid="R5" ref-type="bibr">5</xref>–<xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R10" ref-type="bibr">10</xref></sup>. Subsequently, FreeHi-C generates pairs of sequencing reads from the interacting fragment pairs with embedded random nucleotide mutations and indels while conserving the proportion of chimeric reads. Thereby, the variability and read-level characteristics of original Hi-C sequencing libraries can be preserved in the simulated sequences.</p>
  <p id="P5">We illustrated the versatile features of FreeHi-C with Hi-C datasets of two human cell lines, GM12878 and A549 (4 independent cell culture replicates each), and malaria parasite <italic>Plasmodium falciparum</italic> 3D7, as representatives of large and small genomes, respectively. Analysis of GM12878 and A549 are carried out at 40kb resolution and 10kb for <italic>Plasmodium falciparum</italic> 3D7 unless otherwise stated. Replicates are simulated at the same sequencing depth as the seed replicates unless explicitly stated (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. SN1</xref>–<xref rid="SD3" ref-type="supplementary-material">5</xref>). Compared to Sim3C realizations, FreeHi-C simulations capture the detailed chromatin interaction structures, such as chromatin loops and TADs, better; hence contact matrices from FreeHi-C exhibit markedly higher fidelity to the seed biological data (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Specifically, comparison of the distribution of contact counts stratified by the genomic distance between the simulated and biological data shows that FreeHi-C yielded contact count distributions are similar to those of the seed biological data (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 2</xref>) in contrast to Sim3C (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Similar high fidelity observations hold for paired comparisons of simulated replicates (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). In addition, we show that the simulated data of different replicates preserved the relations existing between replicates of <italic>P. falciparium</italic> (<xref rid="F1" ref-type="fig">Fig. 1b</xref>) and conveyed that chromatin architecture in the ring stage is more similar to that of the schizont stage while the trophozoite stage has striking differences from the other two<sup><xref rid="R16" ref-type="bibr">16</xref></sup> (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 3a</xref>). In addition to recapitulating the clustering structure of the biological samples, FreeHi-C simulated replicates also preserve genomic domain structures, such as A/B compartment and TADs. A/B compartments correlation is higher between the seed biological replicate and the FreeHi-C simulated replicates than those among biological samples (<xref rid="F1" ref-type="fig">Fig. 1c</xref> and <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Similarly, the concordance of the TAD structures are markedly higher for FreeHi-C simulated replicates compared to other biological samples (<xref rid="F1" ref-type="fig">Fig. 1d</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>).</p>
  <p id="P6">Next, we demonstrate how FreeHi-C enables benchmarking a wide range of Hi-C analysis methods and compare it with the downsampling strategy. We first focus on the assessment of the reproducibility of Hi-C contact matrices by HiCRep<sup><xref rid="R13" ref-type="bibr">13</xref></sup>. HiCRep reproducibility quantification successfully clustered the ring and schizont stages together (<xref rid="F1" ref-type="fig">Fig.1b</xref>), this result can be challenged as being biased due to the significant differences in the sequencing depths of the samples, i.e., the ring and schizont stages have 45–375% more reads (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Therefore, it is desirable to adjust for the sequencing depth either by simulation or downsampling. By down simulating the ring and schizont stages to the sequencing depth of trophozoite sample, or up simulating the trophozoite and ring stages to the schizont sample, HiCRep reproducibility consistently clusters the ring and schizont stages together (<xref rid="F1" ref-type="fig">Fig. 1e</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 3</xref>). Downsampling, however, leads to the schizont stage being misclustered with the trophozoite (<xref rid="F1" ref-type="fig">Fig. 1f</xref>) indicating that downsampling may generate low-quality Hi-C matrices (i.e., reproducibility ranges from 0.32 to 0.91) that potentially lead to biased inference. We further illustrate how FreeHi-C enables sequencing depth debiasing for HiCRep<sup><xref rid="R13" ref-type="bibr">13</xref></sup> in evaluating reproducibility and Fit-Hi-C12 in detecting significant interactions in <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>.</p>
  <p id="P7">Another pivotal benchmarking utility of FreeHi-C is for comparing the performance of different methods that address the same Hi-C inference problem. We illustrate this in the context of detection of differential chromatin interactions (DCIs) by comparing diffHic<sup><xref rid="R6" ref-type="bibr">6</xref></sup>, multiHiCcompare<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, and Selfish<sup><xref rid="R11" ref-type="bibr">11</xref></sup> across a series of sequencing depths for false discovery rate (FDR) control and power through both FreeHi-C simulation and downsampling (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Both diffHic and multiHiCcompare can control the FDR with either the GM12878 or A549 datasets and that diffHic is generally more conservative (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 4</xref> and <xref rid="SD3" ref-type="supplementary-material">5</xref>). Remarkably, downsampling displays an increasing FDR trend as the sequencing depth increases. However, this trend can only be investigated up until the original depth of the samples since the sequencing depths of downsampled samples cannot exceed their original depths (<xref rid="F1" ref-type="fig">Fig. 1g</xref>). FreeHi-C simulation elucidates the trends when the depths of the samples go beyond their original ones and reveals a conservative FDR control at higher depths. Additionally, downsampling and FreeHi-C simulation have distinct implications for detection power of the methods (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>).</p>
  <p id="P8">A key impediment for differential chromatin interaction inference with Hi-C data is the limited number of biological replicates. We identified three commonly encountered scenarios as a function of the number of replicates available per condition (<xref rid="F2" ref-type="fig">Fig. 2</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 6</xref>): one replicate per condition (ORPC), uneven numbers of replicates per condition where one of the conditions have only a single replicate (URPC), and multiple numbers of replicates per condition (MRPC). Under these settings, we applied multiHiCcompare for DCIs detection. In the ORPC setting, the FDR control with the BH procedure<sup><xref rid="R18" ref-type="bibr">18</xref></sup> ensures that the observed FDR is below the target FDR (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 7</xref>); however, this setting exhibits extremely conservative FDR control. This comes at the cost of low power (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 8a</xref>). When we augment each of the conditions with FreeHi-C simulated replicates, FDR is still well controlled (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 7</xref>), and power increases by an average of 300 fold across the five levels of FDR thresholds (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 8b</xref>). It is reasonable to argue that, under ORPC, the key target should be the ranking of the interactions, rather than a thresholded list of DCIs, because the top significant DCIs are typically utilized for downstream analysis. We scrutinized the accuracy of the top significant DCIs identified with and without FreeHi-C augmentation by comparing the ranked lists to the gold standard set of DCIs detected by utilizing all the 4 replicates per condition. FreeHi-C simulated samples yield a significantly higher precision of 100–75% compared to ∼10% in the ORPC setting (<xref rid="F2" ref-type="fig">Fig. 2b</xref>, see also <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref> for evaluations under additional gold standard settings). We next assessed the biological relevance of the “ranked up” and “ranked down” DCIs due to FreeHi-C augmentation by external RNA-seq and CTCF ChIP-seq data. Both comparisons supported the new ranking of the top DCIs (<xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. 8c</xref>–<xref rid="SD3" ref-type="supplementary-material">d</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). The URPC setting conveyed similar results (<xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 6</xref>).</p>
  <p id="P9">Finally, we generalized the FreeHi-C augmentation strategy as a meta-analysis approach for multiple replicates per condition (<xref rid="F2" ref-type="fig">Figs. 2c</xref>–<xref rid="F2" ref-type="fig">d</xref>, <xref rid="S1" ref-type="sec">Methods</xref>). FDR control is well preserved as the number of simulated replicates in augmentation increases (<xref rid="F2" ref-type="fig">Fig. 2c</xref> and <xref rid="SD3" ref-type="supplementary-material">Supplementary Fig. 9a</xref>). Notably, augmentation with simulated replicates not only boosts the number of significant DCIs identified (<xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. 9b</xref>–<xref rid="SD3" ref-type="supplementary-material">c</xref>), but also yields a significantly better ranking with higher precision of the top significant DCIs for further quantitative and experimental validation (<xref rid="F2" ref-type="fig">Fig. 2d</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. 10</xref>–<xref rid="SD3" ref-type="supplementary-material">11</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). We successfully validated the biological relevance of the DCIs identified with meta-analysis via FreeHi-C augmentation by leveraging RNA-seq and CTCF ChIP-seq data as in the ORPC setting (<xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. 12</xref>–<xref rid="SD3" ref-type="supplementary-material">14</xref>).</p>
  <p id="P10">Analytical methods for analyzing data from Hi-C and related experiments are growing at a fast pace without uniform benchmarking and evaluation. Since FreeHi-C enables simulating read-level Hi-C data in a data-driven manner, it relies on seed biological data. However, FreeHi-C framework can conceptually accommodate additional user-induced features such as spike-ins while adhering to seed biological data quality and signal-to-noise ratio.</p>
  <sec id="S1">
    <title>Methods</title>
    <sec id="S2">
      <title>FreeHi-C simulation framework</title>
      <sec id="S3">
        <title>Processing and training module</title>
        <p id="P11">FreeHi-C implements the steps outlined in <xref rid="F1" ref-type="fig">Fig. 1b</xref>. It takes as input raw Hi-C sequencing data in the form of FASTQ files, processes the reads, and learns the parameters for the simulation module. The sequence processing module follows a standard protocol<sup><xref rid="R21" ref-type="bibr">21</xref>, <xref rid="R22" ref-type="bibr">22</xref></sup> by aligning raw paired-end read files individually and then joining the read ends to form read pairs, followed by interaction validation checking and duplicate removal steps. After obtaining the valid read-pairs (i.e., interactions), it fits an interaction-level mixture model to estimate the genomic fragment interaction frequencies, with the genomic fragments defined by the experimental restriction enzyme cutting sites. This sampling model considers two multinomial distributions with parameters <inline-formula><mml:math display="inline" id="M1" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math display="inline" id="M2" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, <italic>i</italic>, <italic>j</italic> = 1, …, <italic>L</italic>, where <italic>L</italic> denotes total number of genomic fragments, for generating interaction events. The distribution indexed by the parameter <inline-formula><mml:math display="inline" id="M3" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula> reflects background interactions, driven by experimental artifacts such as genomic distance whereas the second distribution, <inline-formula><mml:math display="inline" id="M4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula>, characterizes true biological interaction signals. For each genome fragment “interaction” event, one interaction is drawn from each of the multinomial distributions, and one of them is recorded as the actual interaction event with probability α. Consequently, the distribution specified by this interaction-level sampling model is multinomial with vector-valued parameter <inline-formula><mml:math display="inline" id="M5" overflow="scroll"><mml:mi>α</mml:mi><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></inline-formula>. This intuitive sampling model, estimation of which does not require deconvolution of the two distributions, is key for FreeHi-C’s successful capture of the interactions in a given biological sample. Once the genomic fragment interaction is sampled, FreeHi-C generates a read pair from this interaction by taking into account strand configuration of the ends of the read pair, mismatch(es), insertion(s), deletion(s), the proportion of chimeric reads, and base quality scores of the reads. Hence, as part of the training module, FreeHi-C estimates this set of parameters empirically from the collection of valid reads. Specifically, FreeHi-C estimates the frequency distributions of numbers of insertions, deletions, and different types of mismatches across all the valid read pairs. Additionally, FreeHi-C processing and training module records the proportion of chimeric reads, i.e., reads pairs where one or both of the read ends are sequenced over the ligation junction, that are rescuable with the aim of preserving this proportion for the simulated reads. Finally, FreeHi-C empirically estimates the distribution of base quality scores for each locus of the Hi-C reads and uses these estimates to ensure that the simulated reads have similar base quality scores as the seed biological replicate.</p>
      </sec>
      <sec id="S4">
        <title>Simulation module</title>
        <p id="P12">FreeHi-C simulates fragment pairs from the estimated interaction-level mixture model as genomic fragments that form crosslinks in the Hi-C experiment protocol<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. The ligation procedure in the experiment leads to two fragment junction sites. FreeHi-C randomly generates one of these which is then passed onto the next step to emulate DNA shearing. Two DNA shearing loci are randomly selected within ± 500bp, by default, of the selected ligation site. These two shearing loci also work as the starting points of the sequencing procedure. FreeHi-C extracts the sequences of the given length, for example, 36bp for 36bp paired-end sequencing, from these loci and assigns strand direction accordingly. During this sequencing step, reads closer than the requested read length to the ligation sites can be generated, as an emulation of chimeric reads. The final step is to introduce noise to the read sequences so that the mismatches and indels match to those in the reads of the original biological sample. Utilizing the empirical distribution of the sequence base quality scores across individual locus, FreeHi-C simulates such scores for each read at the nucleotide level. A key strength of FreeHi-C is that it can generate as many reads as specified by the user and outputs these in the FASTQ format. Furthermore, it processes the resulting reads according to the standard analysis protocol of Hi-C reads by the processing module. Through the post-simulation processing, FreeHi-C can directly provide genomics contact counts in a sparse matrix format (BED) compatible with the standard input format of downstream Hi-C analysis. Processing of the raw reads and learning of the parameters can be implemented on individual read pairs followed by a final aggregation; hence this module can be efficiently parallelized. Furthermore, simulations based on the same parameter settings are parallelized at the read-pair generation level.</p>
      </sec>
    </sec>
    <sec id="S5">
      <title>Data augmentation with FreeHi-C simulated samples</title>
      <p id="P13">To account for the fact that simulated samples cannot provide additional full degrees of freedom when testing for differential chromatin interactions with two or more replicates per condition, we employed a FreeHi-C simulation augmented meta-analysis strategy. The meta-analysis approach pairs biological and simulated samples in numbers concordant with the original differential testing design and aggregates p-values of candidate differential interactions across comparisons by Fisher’s method<sup><xref rid="R23" ref-type="bibr">23</xref></sup>. More specifically, simulation replicates for each of the original <italic>n</italic> biological replicates are generated per condition and considers 2<sup><italic>n</italic></sup>-1 additional tests to preserve the degrees of freedom of the original test statistic. For example, for a setting with 2 biological replicates per condition, we generated 4 FreeHi-C simulation samples, one per original biological replicate, and evaluated the following comparisons, where <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> refer to the two testing conditions under consideration.</p>
      <p id="P14">Test 1: (Rep1<sub><italic>c</italic>1,bioSample</sub>, Rep2<sub>c1,<italic>bioSample</italic></sub>) vs. (Rep1<sub><italic>c</italic>2,bioSample</sub>, Rep2<sub>c2,<italic>bioSample</italic></sub>)</p>
      <p id="P15">Test 2: (Rep1<sub><italic>c</italic>1,<italic>simulation</italic></sub>, Rep2<sub><italic>c</italic>1,<italic>bioSample</italic></sub>) vs. (Rep1<sub><italic>c</italic>2,<italic>simulation</italic></sub>, Rep2<sub><italic>c</italic>2,<italic>bioSample</italic></sub>)</p>
      <p id="P16">Test 3: (Rep1<sub><italic>c</italic>1,bioSample</sub>, Rep2<sub>c1,<italic>simulation</italic></sub>) vs. (Rep1<sub><italic>c</italic>2,<italic>bioSample</italic></sub>, Rep2<sub><italic>c</italic>2,<italic>simulation</italic></sub>)</p>
      <p id="P17">Test 4: (Rep1<sub><italic>c</italic>1,<italic>simulation</italic></sub>, Rep2<sub><italic>c</italic>1,<italic>simulation</italic></sub>) vs. (Rep1<sub><italic>c</italic>2,<italic>simulation</italic></sub>, Rep2<sub><italic>c</italic>2,<italic>simulation</italic></sub>)</p>
      <p id="P18">The p-values of these tests are then aggregated by Fisher’s method<sup><xref rid="R23" ref-type="bibr">23</xref></sup> as <inline-formula><mml:math display="inline" id="M6" overflow="scroll"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>M</italic> = 4 in the above example and the degree of freedom for the <italic>χ</italic><sup>2</sup> distribution is 8. However, the above 4 tests are not independent, the resulting aggregated p-values are anti-conservative. To dampen this effect, instead of ranking the differential interactions with the Fisher’s p-value in the BH procedure<sup><xref rid="R18" ref-type="bibr">18</xref></sup>, we rank them based on median of their adjusted p-values from individual test. Specifically, instead of ordering the hypothesis sequence <italic>H</italic><sub>(<italic>i</italic>)</sub>, <italic>i</italic> = 1, 2, …, <italic>M</italic>, by the aggregated p-values obtained from Fisher’s method, we order them by the new significance rank determined by the median adjusted p-values of across all four tests for each individual contact and denote such ordering as <italic>H</italic><sub>(<italic>r</italic>(<italic>i</italic>))</sub>, <italic>i</italic> = 1, 2, …, <italic>M</italic>, where <italic>r</italic>(<italic>i</italic>) is the index of the contact that is ranked <italic>i</italic><sup><italic>th</italic></sup> in the new significant ranking list. Let <italic>k</italic> be the largest <italic>i</italic> for which <inline-formula><mml:math display="inline" id="M7" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mi>α</mml:mi></mml:math></inline-formula>, then the BH procedure rejects all <italic>H</italic><sub>(<italic>r</italic>(<italic>i</italic>))</sub>, <italic>i</italic> = 1, 2, …, <italic>k</italic>. This is a more conservative procedure than the ordinary BH procedure on the Fisher’s p-values because the number of rejections, <italic>k</italic>, is always smaller or equal to the number of rejections using the BH procedure with Fisher’s p-values. The computational experiments support that this reverses the potential anti-conservative effect of aggregating dependent p-values with Fisher’s method.</p>
    </sec>
    <sec id="S6">
      <title>Evaluating the ranking of detected DCIs</title>
      <p id="P19">The gold standard differential interaction set is approximated by the most significant DCIs detected by multiHiCcompare based on a quasi-likelihood negative binomial generalized log-linear model to test the coefficients with BH procedure adjustment for multiple comparisons (one-sided test; FDR ≤ 0.001, 0.005, 0.01, 0.05, respectively) using 4 biological replicates of GM12878 versus 4 biological replicates of A549. In the sets presented in this paper, we rank the DCIs by their significance order and quantify the fraction of the top N significant differential interactions that appear in the gold standard set where N varies as 500, 1000, etc. This quantity refers to recovery rate or precision. A more conservative gold standard set of DCIs is defined as the intersection of the significant DCIs detected by multiHiCcompare (FDR ≤ 0.01) and those identified by diffHic (FDR ≤ 0.1).</p>
      <p id="P20">Another type of gold standard DCI list is specially defined for tests of uneven number of replicates per condition (<xref rid="SD3" ref-type="supplementary-material">Supplementary Figs. 24</xref>–<xref rid="SD3" ref-type="supplementary-material">25</xref>). In this setting, the gold standard DCI set is defined as the set of most significant interactions in the comparison of rep2 and rep4 of GM12878 with rep1 and rep4 of A549. Accordingly, we measure the precision of the results from the following four comparisons: (i) one replicate out of rep2 and rep4 of GM12878 versus one out of rep1 and rep4 of A459; (ii) one replicate out of rep2 and rep4 of GM12878 with its FreeHi-C augmentation versus one out of rep1 and rep4 of A459 with its FreeHi-C augmentation; (iii) rep2 and rep4 of GM12878 versus one out of rep1 and rep4 of A459 with its FreeHi-C augmentation; (iv) one out of rep2 and rep4 of GM12878 with its FreeHi-C augmentation versus rep1 and rep4 of A459.</p>
    </sec>
    <sec id="S7">
      <title>Evaluating DCIs detected by FreeHi-C augmentation with RNA-seq and CTCF ChIP-seq</title>
      <p id="P21">We evaluated the significance of the observed proportion of differentially expressed (DE) genes between GM12878 and A549 that overlap with significant DCIs using a randomization test. DE genes are detected by DESeq2<sup><xref rid="R24" ref-type="bibr">24</xref></sup> based on a negative binomial model. An empirical null distribution for the observed overlap statistics is constructed by randomly selecting an equal number of interactions as significant ones from all valid bin-pairs and overlapping these with the DE genes for 10,000 times. The significance level of observed overlap is quantified by the percentage of random selection results that is larger than or equal to the observed statistics. A similar strategy is implemented for evaluating co-localization of DCIs with differential CTCF ChIP-seq peaks. Differential CTCF ChIP-seq peaks are defined by peaks that are uniquely enriched in only one cell line.</p>
    </sec>
    <sec id="S8">
      <title>Reporting Summary</title>
      <p id="P22">Further information on research design is available in the Life Sciences Reporting Summary linked to this article.</p>
    </sec>
    <sec sec-type="data-availability" id="S9">
      <title>Data availability</title>
      <p id="P23">To study the operating features of FreeHi-C, we utilized two publicly available human Hi-C datasets as examples of large genomes with independent experiments using four cell cultures, which are referred to as four biological replicates, from GM12878<sup><xref rid="R3" ref-type="bibr">3</xref></sup> cell line and another four from A549<sup><xref rid="R25" ref-type="bibr">25</xref></sup>. Raw FASTQ files for GM12878 were downloaded from GEO<sup><xref rid="R26" ref-type="bibr">26</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">https://www.ncbi.nlm.nih.gov/geo</ext-link>) under the accession code GSE63525 and raw sequences for A549 were obtained from the ENCODE portal<sup><xref rid="R27" ref-type="bibr">27</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org</ext-link>) with accession code ENCSR662QKG. For evaluation of FreeHi-C performance on small genomes, we leveraged three different stages of malaria parasite <italic>Plasmodium falciparum</italic> red blood cell cycles<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. Raw sequences for <italic>P. falciparum</italic> are downloaded from GEO<sup><xref rid="R26" ref-type="bibr">26</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">https://www.ncbi.nlm.nih.gov/geo</ext-link>) under the accession code GSE50199. GM12878 and A549 are both processed at 40kb resolution, and <italic>P. falciparum</italic> at 10kb.</p>
      <p id="P24">For validating the differential interaction detection with a differential expression analysis, we utilized RNA-seq gene expression data from the ENCODE portal (accession ENCSR000AED for GM12878 and ENCSR000CTM for A549). Similarly, the CTCF ChIP- seq peak signal files were also downloaded from ENCODE under accession ENCSR000DZN for GM12878 and ENCSR000DPF for A549. The data used in this paper are summarized in the <xref rid="SD3" ref-type="supplementary-material">Supplementary Table 1</xref>.</p>
      <p id="P25">All the simulated data used in the analysis and Juicebox<sup><xref rid="R28" ref-type="bibr">28</xref></sup> visualization data are available at Zenodo<sup><xref rid="R29" ref-type="bibr">29</xref></sup> (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.3345896">http://doi.org/10.5281/zenodo.3345896</ext-link>).</p>
    </sec>
    <sec id="S10">
      <title>Code availability</title>
      <p id="P26">FreeHi-C pipeline is implemented in Python with C accelerated core calculations and it naturally fits in the high-performance computing environments for parallelization. The source codes and instructions for running FreeHi-C are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/keleslab/FreeHiC">https://github.com/keleslab/FreeHiC</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1540809-supplement-1.doc" orientation="portrait" xlink:type="simple" id="d40e1017" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS1540809-supplement-2.docx" orientation="portrait" xlink:type="simple" id="d40e1021" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>3</label>
      <media xlink:href="NIHMS1540809-supplement-3.pdf" orientation="portrait" xlink:type="simple" id="d40e1025" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>4</label>
      <media xlink:href="NIHMS1540809-supplement-4.pdf" orientation="portrait" xlink:type="simple" id="d40e1029" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD5">
      <label>5</label>
      <media xlink:href="NIHMS1540809-supplement-5.pdf" orientation="portrait" xlink:type="simple" id="d40e1033" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S11">
    <title>Acknowledgments</title>
    <p id="P27">This work was supported by NIH grants HG009744 and HG007019 to S.K.. We thank the peer reviewers and the reviewing editors of this work for their insightful comments.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P28"><bold>Competing Financial Interests</bold> The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Reference</title>
    <ref id="R1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><name><surname>Dekker</surname><given-names>J</given-names></name>, <name><surname>Rippe</surname><given-names>K</given-names></name>, <name><surname>Dekker</surname><given-names>M</given-names></name>, <name><surname>Kleckner</surname><given-names>N</given-names></name>: <article-title>Capturing chromosome conformation</article-title>. <source>Science</source><volume>295</volume>(<issue>5558</issue>) (<year>2002</year>) <fpage>1306</fpage>–<lpage>11</lpage><pub-id pub-id-type="pmid">11847345</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><name><surname>Lieberman-Aiden</surname><given-names>E</given-names></name>, <name><surname>Van Berkum</surname><given-names>NL</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Imakaev</surname><given-names>M</given-names></name>, <name><surname>Ragoczy</surname><given-names>T</given-names></name>, <name><surname>Telling</surname><given-names>A</given-names></name>, <name><surname>Amit</surname><given-names>I</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Sabo</surname><given-names>PJ</given-names></name>, <name><surname>Dorschner</surname><given-names>MO</given-names></name>, <etal/>: <article-title>Comprehensive map- ping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source><volume>326</volume>(<issue>5950</issue>) (<year>2009</year>) <fpage>289</fpage>–<lpage>293</lpage><pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><name><surname>Rao</surname><given-names>SSP</given-names></name>, <name><surname>Huntley</surname><given-names>MH</given-names></name>, <name><surname>Durand</surname><given-names>NC</given-names></name>, <name><surname>Stamenova</surname><given-names>EK</given-names></name>, <name><surname>Bochkov</surname><given-names>ID</given-names></name>, <name><surname>Robinson</surname><given-names>JT</given-names></name>, <name><surname>Sanborn</surname><given-names>AL</given-names></name>, <name><surname>Machol</surname><given-names>I</given-names></name>, <name><surname>Omer</surname><given-names>AD</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Aiden</surname><given-names>EL</given-names></name>: <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source><volume>159</volume>(<issue>7</issue>) (<year>2014</year>) <fpage>1665</fpage>–<lpage>1680</lpage><pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><name><surname>Roy</surname><given-names>S</given-names></name>, <name><surname>Siahpirani</surname><given-names>AF</given-names></name>, <name><surname>Chasman</surname><given-names>D</given-names></name>, <name><surname>Knaack</surname><given-names>S</given-names></name>, <name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Stewart</surname><given-names>R</given-names></name>, <name><surname>Wilson</surname><given-names>M</given-names></name>, <name><surname>Sridharan</surname><given-names>R</given-names></name>: <article-title>A predictive modeling approach for cell line-specific long-range regulatory interactions</article-title>. <source>Nucleic Acids Research</source><volume>44</volume>(<issue>4</issue>) (<year>2016</year>) <fpage>1977</fpage><pub-id pub-id-type="pmid">26546512</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><name><surname>Yardımcı</surname><given-names>GG</given-names></name>, <name><surname>Ozadam</surname><given-names>H</given-names></name>, <name><surname>Sauria</surname><given-names>ME</given-names></name>, <name><surname>Ursu</surname><given-names>O</given-names></name>, <name><surname>Yan</surname><given-names>KK</given-names></name>, <name><surname>Yang</surname><given-names>T</given-names></name>, <name><surname>Chakraborty</surname><given-names>A</given-names></name>, <name><surname>Kaul</surname><given-names>A</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Song</surname><given-names>F</given-names></name>, <etal/>: <article-title>Measuring the reproducibility and quality of hi-c data</article-title>. <source>Genome Biology</source><volume>20</volume>(<issue>1</issue>) (<year>2019</year>) <fpage>57</fpage><pub-id pub-id-type="pmid">30890172</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><name><surname>Lun</surname><given-names>AT</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>: <article-title>diffHic: a Bioconductor package to detect differential genomic interactions in Hi-C data</article-title>. <source>BMC Bioinformatics</source><volume>16</volume>(<issue>1</issue>) (<year>2015</year>) <fpage>258</fpage><pub-id pub-id-type="pmid">26283514</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><name><surname>Forcato</surname><given-names>M</given-names></name>, <name><surname>Nicoletti</surname><given-names>C</given-names></name>, <name><surname>Pal</surname><given-names>K</given-names></name>, <name><surname>Livi</surname><given-names>CM</given-names></name>, <name><surname>Ferrari</surname><given-names>F</given-names></name>, <name><surname>Bicciato</surname><given-names>S</given-names></name>: <article-title>Comparison of computational methods for Hi-C data analysis</article-title>. <source>Nature Methods</source><volume>14</volume>(<issue>7</issue>) (<year>2017</year>) <fpage>679</fpage><pub-id pub-id-type="pmid">28604721</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><name><surname>Ursu</surname><given-names>O</given-names></name>, <name><surname>Boley</surname><given-names>N</given-names></name>, <name><surname>Taranova</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>YR</given-names></name>, <name><surname>Yardimci</surname><given-names>GG</given-names></name>, <name><surname>Stafford Noble</surname><given-names>W</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>: <article-title>Genomedisco: A concordance score for chromosome conformation capture experiments using random walks on contact map graphs</article-title>. <source>Bioinformatics</source><volume>34</volume>(<issue>16</issue>) (<year>2018</year>) <fpage>2701</fpage>–<lpage>2707</lpage><pub-id pub-id-type="pmid">29554289</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><name><surname>Djekidel</surname><given-names>MN</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>MQ</given-names></name>: <article-title>Find: differential chromatin interactions detection using a spatial poisson process</article-title>. <source>Genome Research</source><volume>28</volume>(<issue>3</issue>) (<year>2018</year>) <fpage>412</fpage>–<lpage>422</lpage></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><name><surname>Stansfield</surname><given-names>JC</given-names></name>, <name><surname>Cresswell</surname><given-names>KG</given-names></name>, <name><surname>Vladimirov</surname><given-names>VI</given-names></name>, <name><surname>Dozmorov</surname><given-names>MG</given-names></name>: <article-title>Hiccompare: an R package for joint normalization and comparison of hi-c datasets</article-title>. <source>BMC Bioinformatics</source><volume>19</volume>(<issue>1</issue>) (<year>2018</year>) <fpage>279</fpage><pub-id pub-id-type="pmid">30064362</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><name><surname>Ardakany</surname><given-names>AR</given-names></name>, <name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Lonardi</surname><given-names>S</given-names></name>: <article-title>Selfish: discovery of differential chromatin interactions via a self-similarity measure</article-title>. <source>Bioinformatics</source> (<year>2019</year>) <fpage>i145</fpage>–<lpage>i153</lpage><pub-id pub-id-type="pmid">31510653</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Bailey</surname><given-names>TL</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>: <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>. <source>Genome Research</source><volume>24</volume>(<issue>6</issue>) (<year>2014</year>) <fpage>999</fpage>–<lpage>1011</lpage><pub-id pub-id-type="pmid">24501021</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>T</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <name><surname>Yardimci</surname><given-names>GG</given-names></name>, <name><surname>Song</surname><given-names>F</given-names></name>, <name><surname>Hardison</surname><given-names>RC</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>, <name><surname>Yue</surname><given-names>F</given-names></name>, <name><surname>Li</surname><given-names>Q</given-names></name>: <article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title>. <source>Genome Research</source> (<year>2017</year>) <fpage>gr</fpage>–<lpage>220640</lpage></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><name><surname>DeMaere</surname><given-names>MZ</given-names></name>, <name><surname>Darling</surname><given-names>AE</given-names></name>: <article-title>Sim3c: simulation of hi-c and meta3c proximity ligation sequencing technologies</article-title>. <source>GigaScience</source><volume>7</volume>(<issue>2</issue>) (<year>2017</year>) <fpage>gix103</fpage></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><name><surname>DeMaere</surname><given-names>MZ</given-names></name>, <name><surname>Darling</surname><given-names>AE</given-names></name>: <article-title>bin3c: exploiting hi-c sequencing data to accurately resolve metagenome-assembled genomes</article-title>. <source>Genome Biology</source><volume>20</volume>(<issue>1</issue>) (<year>2019</year>) <fpage>46</fpage><pub-id pub-id-type="pmid">30808380</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Bunnik</surname><given-names>EM</given-names></name>, <name><surname>Varoquaux</surname><given-names>N</given-names></name>, <name><surname>Bol</surname><given-names>SM</given-names></name>, <name><surname>Prudhomme</surname><given-names>J</given-names></name>, <name><surname>Vert</surname><given-names>JP</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>, <name><surname>Le Roch</surname><given-names>KG</given-names></name>: <article-title>Three-dimensional modeling of the P. falciparum genome during the erythrocytic cycle reveals a strong connection between genome architecture and gene ex- pression</article-title>. <source>Genome Research</source><volume>24</volume>(<issue>6</issue>) (<year>2014</year>) <fpage>974</fpage>–<lpage>988</lpage><pub-id pub-id-type="pmid">24671853</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><name><surname>Stansfield</surname><given-names>JC</given-names></name>, <name><surname>Cresswell</surname><given-names>KG</given-names></name>, <name><surname>Dozmorov</surname><given-names>MG</given-names></name>: <article-title>multiHiCcompare: joint normalization and comparative analysis of complex hi-c experiments</article-title>. <source>Bioinformatics</source> (<year>2019</year>)</mixed-citation>
    </ref>
    <ref id="R18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><name><surname>Benjamini</surname><given-names>Y</given-names></name>, <name><surname>Hochberg</surname><given-names>Y</given-names></name>: <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological)</source><volume>57</volume>(<issue>1</issue>) (<year>1995</year>) <fpage>289</fpage>–<lpage>300</lpage></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>X</given-names></name>, <name><surname>Zheng</surname><given-names>Y</given-names></name>: <article-title>Cscoretool: fast hi-c compartment analysis at high resolution</article-title>. <source>Bioinformatics</source><volume>34</volume>(<issue>9</issue>) (<year>2017</year>) <fpage>1568</fpage>–<lpage>1570</lpage></mixed-citation>
    </ref>
    <ref id="R20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><name><surname>Giorgetti</surname><given-names>L</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Carter</surname><given-names>AC</given-names></name>, <name><surname>Attia</surname><given-names>M</given-names></name>, <name><surname>Zhan</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>CJ</given-names></name>, <name><surname>Kaplan</surname><given-names>N</given-names></name>, <name><surname>Chang</surname><given-names>HY</given-names></name>, <name><surname>Heard</surname><given-names>E</given-names></name>, <etal/>: <article-title>Structural organization of the inactive x chromosome in the mouse</article-title>. <source>Nature</source><volume>535</volume>(<issue>7613</issue>) (<year>2016</year>) <fpage>575</fpage><pub-id pub-id-type="pmid">27437574</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <ref-list>
    <title>Reference</title>
    <ref id="R21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><name><surname>Servant</surname><given-names>N</given-names></name>, <name><surname>Varoquaux</surname><given-names>N</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Viara</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>CJ</given-names></name>, <name><surname>Vert</surname><given-names>JP</given-names></name>, <name><surname>Heard</surname><given-names>E</given-names></name>, <name><surname>Dekker</surname><given-names>J</given-names></name>, <name><surname>Barillot</surname><given-names>E</given-names></name>: <article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title>. <source>Genome Biology</source><volume>16</volume>(<issue>1</issue>) (<year>2015</year>) <fpage>259</fpage><pub-id pub-id-type="pmid">26619908</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Keles</surname><given-names>S</given-names></name>: <article-title>Generative modeling of multi-mapping reads with mHi-C advances analysis of Hi-C studies</article-title>. <source>eLife</source><volume>8</volume> (<year>2019</year>) <fpage>e38070</fpage><pub-id pub-id-type="pmid">30702424</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><name><surname>Fisher</surname><given-names>RA</given-names></name>: <article-title>Statistical methods for research workers</article-title>. <source>Genesis Publishing Pvt Ltd</source> (<year>2006</year>)</mixed-citation>
    </ref>
    <ref id="R24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>: <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with deseq2</article-title>. <source>Genome biology</source><volume>15</volume>(<issue>12</issue>) (<year>2014</year>) <fpage>550</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><name><surname>Dixon</surname><given-names>JR</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Dileep</surname><given-names>V</given-names></name>, <name><surname>Zhan</surname><given-names>Y</given-names></name>, <name><surname>Song</surname><given-names>F</given-names></name>, <name><surname>Le</surname><given-names>VT</given-names></name>, <name><surname>Galip Gurkan Yardımcı</surname><given-names>AC</given-names></name>, <name><surname>Bann</surname><given-names>DV</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Clark</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Iyyanki</surname><given-names>S</given-names></name>, <name><surname>An</surname><given-names>L</given-names></name>, <name><surname>Pool</surname><given-names>C</given-names></name>, <name><surname>Sasaki</surname><given-names>T</given-names></name>, <name><surname>Rivera-Mulia</surname><given-names>JC</given-names></name>, <name><surname>Ö zadam</surname><given-names>H</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Kaul</surname><given-names>R</given-names></name>, <name><surname>Buckley</surname><given-names>M</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name>, <name><surname>Diegel</surname><given-names>M</given-names></name>, <name><surname>Pezic</surname><given-names>D</given-names></name>, <name><surname>Ernst</surname><given-names>C</given-names></name>, <name><surname>Hadjur</surname><given-names>S</given-names></name>, <name><surname>Odom</surname><given-names>DT</given-names></name>, <name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name>, <name><surname>Broach</surname><given-names>JR</given-names></name>, <name><surname>Hardison</surname><given-names>RC</given-names></name>, <name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>, <name><surname>Dekker</surname><given-names>J</given-names></name>, <name><surname>Gilbert</surname><given-names>DM</given-names></name>, <name><surname>Yue</surname><given-names>F</given-names></name>: <article-title>Integrative detection and analysis of structural variation in cancer genomes</article-title>. <source>Nature Genetics</source> (<month>9</month>
<year>2018</year>) <comment><ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41588-018-0195-8">https://www.nature.com/articles/s41588-018-0195-8</ext-link>.</comment></mixed-citation>
    </ref>
    <ref id="R26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><name><surname>Barrett</surname><given-names>T</given-names></name>, <name><surname>Wilhite</surname><given-names>SE</given-names></name>, <name><surname>Ledoux</surname><given-names>P</given-names></name>, <name><surname>Evangelista</surname><given-names>C</given-names></name>, <name><surname>Kim</surname><given-names>IF</given-names></name>, <name><surname>Tomashevsky</surname><given-names>M</given-names></name>, <name><surname>Marshall</surname><given-names>KA</given-names></name>, <name><surname>Phillippy</surname><given-names>KH</given-names></name>, <name><surname>Sherman</surname><given-names>PM</given-names></name>, <name><surname>Holko</surname><given-names>M</given-names></name>, <etal/>: <article-title>NCBI GEO: archive for functional genomics data sets update</article-title>. <source>Nucleic Acids Research</source><volume>41</volume>(<issue>D1</issue>) (<year>2012</year>) <fpage>D991</fpage>–<lpage>D995</lpage><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="R27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>EP</given-names></name>, <etal/>: <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source><volume>489</volume>(<issue>7414</issue>) (<year>2012</year>)</mixed-citation>
    </ref>
    <ref id="R28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><name><surname>Durand</surname><given-names>Neva C.</given-names></name>, <etal/> "<article-title>Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom</article-title>." <source>Cell systems</source>
<volume>3</volume>.<issue>1</issue> (<year>2016</year>): <fpage>99</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">27467250</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>Ye</given-names></name>, &amp; <name><surname>Keles</surname><given-names>Sunduz</given-names></name>. (<year>2019</year>). <article-title>Supplementary Data for "FreeHi-C: high fidelity Hi-C data simulation for benchmarking and data augmentation" [Data set]</article-title>. <source>Zenodo</source>. <pub-id pub-id-type="doi">10.5281/zenodo.3345896</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>FreeHi-C enables simulating high fidelity Hi-C data.</title>
      <p id="P29"><bold>a.</bold> FreeHi-C simulation workflow. Black arrows connect the processing procedures, and grey arrows show the data flow. <bold>b.</bold> Hierarchical clustering of the original Hi-C biological replicates and the FreeHi-C simulated replicates for the ring, trophozoite, schizont stages of <italic>P. falciparum</italic>. Heatmap clustering is obtained with the inherited R function <italic>hcluster</italic> in the <italic>pheatmap</italic> package using the default parameters. Distance is quantified by HiCRep<sup><xref rid="R13" ref-type="bibr">13</xref></sup>. <bold>c.</bold> Pearson correlation analysis of the A/B compartment eigenvector between the seed biological replicate (delineated at the top of each panel) and FreeHi-C simulation of 1 × sequencing depth, 5 × original sequencing depth, and other biological replicates. A/B compartment eigenvector is calculated by CscoreTool<sup><xref rid="R19" ref-type="bibr">19</xref></sup> (n = 3). <bold>d.</bold> Jaccard index of the TADs detected using the seed biological replicate (delineated at the top of each panel) and FreeHi-C simulation of the 1 × sequencing depth, 5 × original sequencing depth, and other biological replicates. TAD boundaries are detected using the Insulation Score<sup><xref rid="R20" ref-type="bibr">20</xref></sup> (n = 3). <bold>e</bold> and f. Hierarchical clustering of the FreeHi-C simulated (<bold>e</bold>) and downsampled (<bold>f</bold>) replicates matching the sequencing depth of the original <italic>P. falciparum</italic> trophozoite stage sample. Distance is calculated by HiCRep<sup><xref rid="R13" ref-type="bibr">13</xref></sup>. <bold>g.</bold> HiCRep<sup><xref rid="R13" ref-type="bibr">13</xref></sup> reproducibility of the contact matrices between pairs of biological replicates of GM12878 simulated by FreeHi-C (orange) or downsampled (purple) to 0.5 × sequencing depth of replicate6, 1 × sequencing depth of replicate6, and sequencing depths of replicate4, replicate2, and then replicate3, respectively (n = 4). In <bold>c</bold>, <bold>d</bold>, and <bold>g</bold>, the center lines indicate medians, box limits indicate the 25th and 75th percentiles. The upper whisker extends from the hinge to the largest value no further than 1.5 × inter-quartile ranges from the hinge. The lower whisker extends from the hinge to the smallest value at most 1.5 × inter-quartile of the hinge. Data beyond the end of the whiskers are outlying points and are plotted individually.</p>
    </caption>
    <graphic xlink:href="nihms-1540809-f0001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Data augmentation with FreeHi-C simulated replicates improves differential chromatin interactions (DCIs) detection.</title>
      <p id="P30"><bold>a</bold> (n = 16) and <bold>b</bold> (n = 16) refer to one replicate per condition (ORPC). <bold>c</bold> (n = 3) and <bold>d</bold> (n = 16) refer to multiple replicates per condition (MRPC) settings. <bold>a</bold> (n = 16) and <bold>c</bold> (n = 3) delineate observed false discovery rates of within-sample comparisons for A549 data (i.e., comparisons of replicate(s) of A549 with other replicate(s) of A549). The dashed lines are y = x. <bold>b</bold> (n = 16) and <bold>d</bold> (n = 16) display precision, computed as the percentage of top significant DCIs of each specific analysis in the gold standard differential chromatin interaction list, as a function of top-ranking DCIs. The gold standard set is defined by comparing the full set of 4 replicates of GM12878 with 4 replicates of A549 filtered by FDR <italic>≤</italic> 0.01. |logFC| refers to the absolute value of natural log transformed fold-change. Differential chromatin interaction detection is performed by HiCcompare<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, by converting the normalized contact counts into Z-scores, and multiHiCcompare<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, using a quasi-likelihood negative binomial generalized log-linear model (one-sided test). The p-values are adjusted by Benjamini-Hochberg procedure<sup><xref rid="R18" ref-type="bibr">18</xref></sup> for multiple comparisons. For all the boxplots in this figure, the center lines correspond to the medians, box limits correspond to the 25th and 75th percentiles and whiskers comprise all data points within 1.5 × the inter-quartile range.</p>
    </caption>
    <graphic xlink:href="nihms-1540809-f0002"/>
  </fig>
</floats-group>
