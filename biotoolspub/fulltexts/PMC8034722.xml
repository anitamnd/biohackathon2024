<?properties open_access?>
<?subarticle pcbi.1008880.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8034722</article-id>
    <article-id pub-id-type="pmid">33784300</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008880</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01312</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Information Technology</subject>
          <subj-group>
            <subject>Databases</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Database Searching</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome-Wide Association Studies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Orchestrating privacy-protected big data analyses of data from different resources with R and DataSHIELD</article-title>
      <alt-title alt-title-type="running-head">Privacy-protected big data analysis with R and DataSHIELD</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0138-2023</contrib-id>
        <name>
          <surname>Marcon</surname>
          <given-names>Yannick</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3407-2526</contrib-id>
        <name>
          <surname>Bishop</surname>
          <given-names>Tom</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8908-2441</contrib-id>
        <name>
          <surname>Avraam</surname>
          <given-names>Demetris</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Escriba-Montagut</surname>
          <given-names>Xavier</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ryser-Welch</surname>
          <given-names>Patricia</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wheater</surname>
          <given-names>Stuart</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5799-9634</contrib-id>
        <name>
          <surname>Burton</surname>
          <given-names>Paul</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3267-2146</contrib-id>
        <name>
          <surname>González</surname>
          <given-names>Juan R.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
        <xref ref-type="aff" rid="aff008">
          <sup>8</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Epigeny, St Ouen, France</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>MRC Epidemiology Unit, University of Cambridge, Cambridge, United Kingdom</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Population Health Sciences Institute, Newcastle University, Newcastle, United Kingdom</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Barcelona Institute for Global Health (ISGlobal), Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Universitat Pompeu Fabra (UPF), Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Arjuna Technologies, Newcastle, United Kingdom</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Centro de Investigación Biomédica en Red en Epidemiología y Salud Pública (CIBERESP), Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Dept. of Mathematics, Universitat Autònoma de Barcelona (UAB), Bellaterra (Barcelona), Spain</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>yannick.marcon@obiba.org</email> (YM); <email>juanr.gonzalez@isglobal.org</email> (JRG)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>3</issue>
    <elocation-id>e1008880</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Marcon et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Marcon et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="pmc" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008880.pdf"/>
    <abstract>
      <p>Combined analysis of multiple, large datasets is a common objective in the health- and biosciences. Existing methods tend to require researchers to physically bring data together in one place or follow an analysis plan and share results. Developed over the last 10 years, the DataSHIELD platform is a collection of R packages that reduce the challenges of these methods. These include ethico-legal constraints which limit researchers’ ability to physically bring data together and the analytical inflexibility associated with conventional approaches to sharing results. The key feature of DataSHIELD is that data from research studies stay on a server at each of the institutions that are responsible for the data. Each institution has control over who can access their data. The platform allows an analyst to pass commands to each server and the analyst receives results that do not disclose the individual-level data of any study participants. DataSHIELD uses Opal which is a data integration system used by epidemiological studies and developed by the OBiBa open source project in the domain of bioinformatics. However, until now the analysis of big data with DataSHIELD has been limited by the storage formats available in Opal and the analysis capabilities available in the DataSHIELD R packages. We present a new architecture (“<italic>resources</italic>”) for DataSHIELD and Opal to allow large, complex datasets to be used at their original location, in their original format and with external computing facilities. We provide some real big data analysis examples in genomics and geospatial projects. For genomic data analyses, we also illustrate how to extend the resources concept to address specific big data infrastructures such as GA4GH or EGA, and make use of shell commands. Our new infrastructure will help researchers to perform data analyses in a privacy-protected way from existing data sharing initiatives or projects. To help researchers use this framework, we describe selected packages and present an online book (<ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown">https://isglobal-brge.github.io/resource_bookdown</ext-link>).</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Data sharing enhances understanding of research results beyond what is possible from any single study. Data pooling across multiple studies increases statistical power and allows exploration of between-study heterogeneity. But, considerations related to ethico-legal and intellectual/commercial value regularly prevent or impede physical data sharing. DataSHIELD is designed to circumvent this problem. However, despite the growing confidence users have been placing in DataSHIELD to perform privacy-protected analyses of data in cohort consortia, there are real challenges to federated analytics. They include considering the wide range of data formats, and big data sources used, for example, in ‘omics-based research. This article describes the development and implementation of the new “resources” architecture in DataSHIELD that overcomes this limitation. We illustrate its value with real world examples related to genomics and geographical data. We also demonstrate how genomic data sharing initiatives such as GA4GH and EGA can benefit directly from our development. Our new infrastructure will help researchers to perform data analyses in a privacy-protected way from existing data sharing initiatives or projects.</p>
    </abstract>
    <funding-group>
      <funding-statement>This research has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 874583 (ATHLETE) an No 824989 (EUCAN-Connect); the Ministerio de Ciencia, Innovación y Universidades (MICIU), Agencia Estatal de Investigación (AEI) and Fondo Europeo de Desarrollo Regional, UE (RTI2018-100789-B-I00) also through the “Centro de Excelencia Severo Ochoa 2019-2023” Program (CEX2018-000806-S); and the Catalan Government through the CERCA Program. This article is part of the project VEIS: 001-P-001647 co-financed by the European Regional Development Fund of the European Union in the framework of the Operational Program FEDER of Catalonia 2014-2020 with the support of the Secretaria d'Universitats i Recerca del Departament d'Empresa i Coneixement de la Generalitat de Catalunya. This work also forms part of Newcastle University’s methods program in Health Data Science addressing the securing of sensitive data; with support from the Department of Health and Social Care under the Connected Health Cities (North East North Cumbria) project and from joint Wellcome Trust/Medical Research Council grant 108439/A/15/Z. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-04-09</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Data are available as a figshare project in this link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/Orchestrating_privacy-protected_big_data_analyses_of_data_from_different_resources_with_R_and_DataSHIELD/96377">https://figshare.com/projects/Orchestrating_privacy-protected_big_data_analyses_of_data_from_different_resources_with_R_and_DataSHIELD/96377</ext-link>. The R code is available at <ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown/">https://isglobal-brge.github.io/resource_bookdown/</ext-link></meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Data are available as a figshare project in this link: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/Orchestrating_privacy-protected_big_data_analyses_of_data_from_different_resources_with_R_and_DataSHIELD/96377">https://figshare.com/projects/Orchestrating_privacy-protected_big_data_analyses_of_data_from_different_resources_with_R_and_DataSHIELD/96377</ext-link>. The R code is available at <ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown/">https://isglobal-brge.github.io/resource_bookdown/</ext-link></p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Big Data brings new opportunities to biomedicine and challenges to data scientists. These challenges require new computational and statistical paradigms to deal with important principles of data management and data sharing. The new paradigm should consider: ensuring appropriate levels of security and privacy [<xref rid="pcbi.1008880.ref001" ref-type="bibr">1</xref>]; the rigorous application of the stringent regulations required by governance frameworks such as GDPR in Europe (<ext-link ext-link-type="uri" xlink:href="https://gdpr-info.eu/">https://gdpr-info.eu/</ext-link>) and similar regulatory mechanisms across North America and elsewhere; and a considered choice between central data warehousing and the distributed (federated) analysis of data that remain with their custodian[<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008880.ref003" ref-type="bibr">3</xref>].</p>
    <p>Historically there has tended to be a focus on warehousing because of the technical challenges of federation [<xref rid="pcbi.1008880.ref004" ref-type="bibr">4</xref>], and funder requirements to physically share public data [<xref rid="pcbi.1008880.ref005" ref-type="bibr">5</xref>]. This requires data custodians to physically transfer data to a central location to make them accessible to analytic users. However, the potential benefits of remote and federated approaches to analysing data are now widely recognised [<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008880.ref003" ref-type="bibr">3</xref>]. Most fundamentally, the physical data then remain under the control of their custodian with limited access. This can offer major benefits in terms of: making it easier to meet ethics and governance requirements; enhanced flexibility to refine and rerun analyses quickly without waiting for an analyst at each institution to follow an updated analysis plan; allowing datasets to be updated quickly without needing to be resent to a central location [<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008880.ref006" ref-type="bibr">6</xref>].</p>
    <p>Anticipating the future growth of federated analysis, the DataSHIELD (<ext-link ext-link-type="uri" xlink:href="http://www.datashield.ac.uk/">www.datashield.ac.uk</ext-link>) and OBiBa (<ext-link ext-link-type="uri" xlink:href="http://www.obiba.org/">www.obiba.org</ext-link>) projects are now 10 years into the joint development of an open-source analytics platform that enables and simplifies flexible but efficient federated analysis [<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008880.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1008880.ref008" ref-type="bibr">8</xref>]. DataSHIELD is linked to an Opal database designed for data management, harmonization and dissemination [<xref rid="pcbi.1008880.ref009" ref-type="bibr">9</xref>]. In addition, it actively constrains the risk of information disclosure: i.e. the risk that a data analyst is able–accidently or deliberately—to infer individual level data [<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008880.ref010" ref-type="bibr">10</xref>]. The DataSHIELD platform has a growing user community and a central role in the analytic strategies of several large research consortia focussed primarily on the federated analysis of large cohort studies, particularly in Europe and Canada. These include BioSHaRE [<xref rid="pcbi.1008880.ref008" ref-type="bibr">8</xref>], EUCAN-connect [<xref rid="pcbi.1008880.ref011" ref-type="bibr">11</xref>], LifeCycle [<xref rid="pcbi.1008880.ref012" ref-type="bibr">12</xref>], ATHLETE [<xref rid="pcbi.1008880.ref013" ref-type="bibr">13</xref>] and InterConnect [<xref rid="pcbi.1008880.ref014" ref-type="bibr">14</xref>]. This article describes a radical extension to the DataSHIELD/Opal platform–the <bold><italic>“Resources”</italic></bold> architecture. This allows DataSHIELD to be used in a range of new settings which include the analysis of high-volume data such as omics, geospatial or neuroimaging among others.</p>
    <p>Despite the growing confidence users have been placing in DataSHIELD to perform privacy-protected analyses, there have, to date, been several serious limitations: (1) Difficulty in applying DataSHIELD federated analytics across the wide range of data formats, and data sources used in ‘omics-based research. (2) Challenges to the efficient porting of high-volume distributed data into the analytic (R) environments on the remote data servers; single large tranches can overwhelm the handling capacity of the system and regular block-by-block refreshments of the analytic data can be impractically slow. (3) To date DataSHIELD has primarily been applied to research settings (typically large cohort studies) where the emphasis has been on the provision of robust disclosure control for analysing sensitive data. But in big data analyses the emphasis is more typically on fast, efficient analysis and data governance often requires a relatively basic level of disclosure control. For example, many consortium-based ‘omics projects would like data to remain with their usual generators/custodians–<italic>i</italic>.<italic>e</italic>. a federated approach avoiding the physical transfer of data to users—and for analysts to be unable to see, copy, capture or otherwise infer, those individual-level data. Crucially, if limitations “1” and “2” could be circumvented it would then be straightforward to ensure that this basic level of disclosure control is embedded into all new functions as they are developed and implemented. This would greatly accelerate the development of new functionality making it realistic to consider rapid implementation of Bioconductor [<xref rid="pcbi.1008880.ref015" ref-type="bibr">15</xref>], Neuroconductor [<xref rid="pcbi.1008880.ref016" ref-type="bibr">16</xref>] or R packages designed for big data analyses into DataSHIELD. In one stroke, these objectives have all been realised with the development and implementation of the new <bold>“Resources”</bold> architecture in DataSHIELD/Opal.</p>
    <p>This article describes this new facility, illustrates its value with real world examples and considers the exciting implications it has for the future development of the DataSHIELD platform and for the wider adoption of federated approaches to big data analysis. To help researchers use this framework, we present an online book (<ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown/">https://isglobal-brge.github.io/resource_bookdown/</ext-link>) covering installation, sources of help, specialized topics pertaining to specific aspects of privacy-protecting analysis and complete workflows analysing various examples from biomedical, omics and geospatial settings. The packages developed are available through CRAN or Github repositories under open source licenses (GPL3 or MIT).</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>The resources architecture</title>
      <p>When analysing data, it is normal to deal with a very wide variety of data formats, data storage systems and programmatic interfaces. The purpose of the work we describe is not to define a new data format or storage system. Instead we have aimed to describe how data can be accessed, in a formal but generic way, to simplify the integration of various data or computation resources in a statistical analysis program. By actively embracing the variety of data formats and computation systems we seek to guarantee that the right tool can always be used for the type and the volume of data that are being considered.</p>
      <p>We define a “resource” to be a description of how to access either: (1) data stored and formatted in a particular way or (2) a computation service. Therefore, the descriptors for the resource will contain the following elements: (1) the location of the data or of the computation services, (2) the data format (if this information cannot be inferred from the location property) or the format of the function call to the computation service, (3) the access credentials (if some apply).</p>
      <p>Once a resource has been formally defined, it becomes possible to build a programmatic connection object that will make use of the data or computation services described. This resource description is not bound to a specific programmatic language (the URL property is a web standard, other properties are simple strings) and does not enforce the use of a specific software application for building, storing and interpreting a resource object. Section 7.8 in our online book describe some examples of resources available in a demonstration Opal repository.</p>
      <p>The data format refers to the intrinsic structure of the data. A very common family of data formats is the tabular format which is made of rows (entities, records, observations etc.) and columns (variables, fields, vectors etc.). Examples of tabular formats are the delimiter-separated values formats (CSV, TSV etc.), the spreadsheet data formats (Microsoft Excel, LibreOffice Calc, Google Sheets etc.), some proprietary statistical software data formats (SPSS, SAS, Stata etc.), the database tables that can be stored in structured database management systems that are row-oriented (MySQL, MariaDB, PostgreSQL, Oracle, SQLite etc.) or column-oriented (Apache Cassandra, Apache Parquet, MariaDB ColumnStore, BigTable etc.), or in semi-structured database management systems such as the documented-oriented databases (MongoDB, Redis, CouchDB, Elasticsearch etc.). When the data model is highly structured or particularly complex (data types and objects relationships), a domain-specific data format is sometimes designed to handle the complexity. This then enables statistical analysis and data retrieval to be executed as efficiently as possible. Examples of domain-specific data formats are regularly encountered in the genomic or geospatial fields of research. A data format can also include additional features such as data compression, encoding or encryption. Each data format requires an appropriate reader software library or application to extract the information or perform data aggregation or filtering operations.</p>
      <p>Data storage can simply be realised via a file that can be accessed directly from the host’s file system or downloaded from a remote location. More advanced data storage systems can involve software applications that expose an interface to query, extract or analyse the data. These applications can make use of a standard programming interface (e.g. SQL) or expose specific web services (e.g. based on the HTTP communication protocol) or provide a software library (in different programming languages) to access the data. These different ways of accessing the data are not mutually exclusive. In some cases when the (individual-level) micro-data cannot be extracted, computation services returning aggregated/summary statistics may be provided. The data storage system can also apply security rules, requiring authentication and proper authorisations to access or analyse the data.</p>
      <p>The resource location description will make use of the web standard <ext-link ext-link-type="uri" xlink:href="https://tools.ietf.org/html/rfc3986">“Uniform Resource Identifier (URI): Generic Syntax</ext-link>”.[<xref rid="pcbi.1008880.ref017" ref-type="bibr">17</xref>] More specifically, the Uniform Resource Locator (URL) specification is what we need for defining the location of the data or computation resource: the term Uniform allows the resource to be described in the same way, independently of its type, location and usage context; the use of the term Resource does not limit the scope of what might be a “resource”, e.g. a document, a service, a collection of resources, or even abstract concepts (operations, relationships, etc.); the term Locator both identifies the resource and provides a means of locating it by describing its access mechanism (e.g. the network location). The URL syntax is composed of several parts: (1) a scheme, that describes how to access the resource, e.g. the communication protocols “https” (secured HTTP communication), “ssh” (secured shell, for issuing commands on a remote server), or “s3” (for accessing Amazon Web Service S3 file store services), (2) an authority (optional), e.g. a server name address, (3) a path that identifies/locates the resource in a hierarchical way and that can be altered by query parameters.</p>
      <p>The resource’s data format might be inferred from the path component of the URL; for example, by using the file name suffix. However, it is not always possible to identify the data format because the path could make sense only for the data storage system, for example when a file store designates a document using an obfuscated string identifier or when a text-based data format is compressed as a zip archive. The format property can provide this information. Although the authority part of the URL can contain user information (such as the username and password), it is discouraged to use this capability for security considerations. The resource’s credentials property will be used instead, and will be composed of an identifier sub-property and a secret sub-property, which can be used for authenticating with a username/password, an access token, a key pair (private and public keys), or any other credentials encoded string. The advantage of separating the credentials property from the resource location property is that a user with limited permissions could have access to the resource’s location information while the credentials are kept secret.</p>
    </sec>
    <sec id="sec004">
      <title>The <italic>resourcer</italic> R package</title>
      <p>The <italic>resourcer</italic> package is an R implementation of the data and computation resources description and connection. It reuses many existing R packages for reading various data formats and connecting to external data storage or computation servers. The resourcer package’s role is to interpret a resource description object to build the appropriate resource connection object. Because the scope of resources is very wide, the <italic>resourcer</italic> package provides a framework for dynamically extending the interpretation capabilities to new types of resources. Next, we describe the key issues to deal with resources within the R environment. Further details and examples are available in Section 7.8 in our online book.</p>
      <sec id="sec005">
        <title>Resources R Implementation</title>
        <p>The resource class is a simple R structure that holds the properties of the resource described in the previous section: URL, format, identity and secret. To simplify the designation of a resource, an additional name attribute is defined. This identifier is optional and is not necessarily unique. The ResourceClient is a key R6 class, which wraps a resource object and defines operations that can be performed on it. The resourcer package has built-in support for the following use cases:</p>
        <list list-type="bullet">
          <list-item>
            <p>Data file resource whose location is defined by the resource’s URL and that can be downloaded in a temporary folder to be read. The file locations that are supported by default are: (1) the local file system (obviously with a no-op download), (2) an HTTP(S) connection, optionally providing basic authentication based on the resource’s credentials, (3) the MongoDB GridFS file store, (4) Opal’s file store and (5) a remote SSH server. For the reading part, the resourcer package uses some tidyverse R packages (such as haven for the SAS, SPSS and Stata data formats, readr for delimited data formats and readxl for Excel data formats) or can load an R object based on its class name specified in the resource’s data format property.</p>
          </list-item>
          <list-item>
            <p>SQL database resource which has a connector based on R’s interface for databases (DBI). The resource’s URL indicates which database connector is to be used. The SQL databases supported by default are MySQL/MariaDB and PostgreSQL, and some “big data” databases exposing a SQL interface such as PrestoDB and Apache Spark. The resourcer package can be extended to new DBI-compatible databases.</p>
          </list-item>
          <list-item>
            <p>NoSQL database resource which can be read using connectors from the nodbi package. Only the MongoDB database is supported for now.</p>
          </list-item>
          <list-item>
            <p>Command-based computation resource. The resourcer package can handle commands to be executed in the local shell and on a remote server through a secure shell (SSH) connection.</p>
          </list-item>
        </list>
      </sec>
      <sec id="sec006">
        <title>Interacting with R Resources</title>
        <p>As the ResourceClient is simply a connector to a resource, its utility is enhanced by a range of data conversion functions that are defined by default:</p>
        <list list-type="bullet">
          <list-item>
            <p>R data.frame, which is the most common representation of tabular data in R. A data frame, as defined in R base, is an object stored in memory that may be not suitable for large to big datasets.</p>
          </list-item>
          <list-item>
            <p>dplyr tbl, which is another representation of tabular data provided by the dplyr package that nicely integrates with the R interface for databases: filtering, mutation and aggregation operations can be delegated to the underlying SQL database, reducing the R memory and computation footprint. Useful functions are also provided to perform joint operations on relational datasets.</p>
          </list-item>
        </list>
        <p>In the case when the resource is a R object, the R data file ResourceClient offers the ability to get the internal raw data object. Then complex data structures, optimized for a specific research domain can be accessed with the most appropriate tools.</p>
        <p>When the resource is a computation service provider, the interaction with the resource client will consist of issuing commands/requests with parameters and getting the result from it either as a response object or as a file to be downloaded.</p>
        <p>The purpose of the resourcer package is definitely not to substitute itself for the underlying library; rather it is a general approach that facilitates the access to the data and service resources in the most specific way.</p>
      </sec>
      <sec id="sec007">
        <title>Extending R Resources</title>
        <p>Thanks to its modular and dynamic architecture, the <italic>resourcer</italic> package can easily be extended to:</p>
        <list list-type="bullet">
          <list-item>
            <p>new file locations (see for instance the <italic>s3</italic>.<italic>resourcer</italic> R package which connects Amazon Web Service S3 file stores),</p>
          </list-item>
          <list-item>
            <p>new file readers (see Section 8 in our online book to see how VCF files are read in the <italic>dsOmics</italic> R package),</p>
          </list-item>
          <list-item>
            <p>new DBI-compatible databases. For instance, using <italic>bigrquery</italic> R package, it would be easy to implement access to a resource stored in a Google’s BigQuery database.</p>
          </list-item>
          <list-item>
            <p>new domain specific applications which would expose data extraction and/or analysis services. The only requirement is that an R connection API exists for the considered resource application.</p>
          </list-item>
        </list>
      </sec>
      <sec id="sec008">
        <title>Resources with DataSHIELD/Opal</title>
        <p>DataSHIELD infrastructure is a software solution that allows simultaneous co-analysis of multiple data sets stored on different servers without the need to physically pool data or disclose sensitive information. DataSHIELD uses Opal servers to perform such analyses.</p>
        <p>At a high level DataSHIELD is set up as a client-server model, each server housing the data for its corresponding study. A request is made from the client to run specific functions on the data held in the remote servers and that is where the required analyses are actually performed. Non-sensitive and pre-approved summary statistics are returned from each study server to the client where they can then be combined for an overall analysis. An overview of what a multi-site DataSHIELD architecture would look like is illustrated in <bold><xref ref-type="fig" rid="pcbi.1008880.g001">Fig 1</xref></bold>.</p>
        <fig id="pcbi.1008880.g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008880.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <title>A schematic diagram of a multi-site DataSHIELD infrastructure.</title>
            <p>It includes one central analysis node (the client) and three data nodes (the servers).</p>
          </caption>
          <graphic xlink:href="pcbi.1008880.g001"/>
        </fig>
        <p>The current limitation of this infrastructure is that the data assignment operation consists of extracting the dataset from the data repository (the primary storage can be either a SQL database or a MongoDB database) and pushing it in the R server’s memory as a data.frame object. This data assignment process consumes time, physical memory and applies only to datasets in tabular format. Although acceptable for small datasets (usually less than 10M data points), this infrastructure cannot be used for big data systems, complex data structures and existing computation facilities. In order to overcome these limitations, data access can instead be delegated to the R servers using the concept of resources. The DataSHIELD middleware (Opal) will be responsible for performing the assignment of a resource description as a ResourceClient object in the R server (as soon as the relevant permissions have been granted). The connection to data or computation resources is then readily usable by the DataSHIELD user. In terms of data access security, the resource credentials are not visible via the DataSHIELD client node, just like the individual-level data.</p>
        <p>After converting a resource to a data.frame object, existing DataSHIELD analysis R packages can be used in a backward compatible way. New DataSHIELD R packages, such as dsOmics and dsGeo, described in this paper, can make use of the power of resources to apply DataSHIELD’s data privacy preserving paradigm to large datasets, complex data structures and external computation facilities.</p>
        <p>The integration of the resources concept in Opal consists of (1) dynamically discovering the different types of resources that can be handled by the associated R server, (2) providing an appropriate user-friendly graphical interface (GUI) for managing the resource descriptions and access permissions, and (3) assigning resource objects in the R server on user demand. The latest version of Opal (v 3.0) implements these capabilities, making resources accessible to the DataSHIELD framework.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <p><bold><xref rid="pcbi.1008880.t001" ref-type="table">Table 1</xref></bold> describes the main features of our proposed framework that are mainly driven by DataSHIELD’s capabilities. The table also shows the main advantages of disadvantages that can be found when using the <italic>resources</italic> in federated data analyses. Different features including scalability, disclosure prevention, deployment and future applications to other biomedical areas than genomics are discussed.</p>
    <table-wrap id="pcbi.1008880.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1008880.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Main characteristics of the proposed infrastructure for privacy-protected federated data analyses with big data.</title>
      </caption>
      <alternatives>
        <graphic id="pcbi.1008880.t001g" xlink:href="pcbi.1008880.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Feature</th>
              <th align="left" rowspan="1" colspan="1">Capabilities / Advantages</th>
              <th align="left" rowspan="1" colspan="1">Limitations / Disadvantages</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Resources</td>
              <td align="left" rowspan="1" colspan="1">Any data source or computation resource that can be accessed from R is made available in DataSHIELD. These include databases of any kind (SQL, NoSQL, distributed Big Data systems), most of the file formats, domain specific applications accessible through web services or remote commands etc. Applies to any scientific domain.</td>
              <td align="left" rowspan="1" colspan="1">Resource URL design can be complex when resource options need to be specified. R is the required entry point, which complexifies the use of analysis algorithms in Python for instance.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Scalability</td>
              <td align="left" rowspan="1" colspan="1">Scales with number of studies. The <italic>resources</italic> can interact with Apache Spark or Hadoop</td>
              <td align="left" rowspan="1" colspan="1">Some advanced statistical techniques may not scale well with number of records. The processing power can sometimes suffer from latency. There is a need for investigation share computation over multiple processors.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">R programming language</td>
              <td align="left" rowspan="1" colspan="1">R is an open-source and heterogenous programming language. Interpreters for available for many operating systems. A wide community support its users.</td>
              <td align="left" rowspan="1" colspan="1">Skills for other functional and statistical programming languages can be transferred to learn R. However not all of the analysts are familiar with other programming languages, which can raise some barriers of adoption.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Disclosure prevention</td>
              <td align="left" rowspan="1" colspan="1">Several complementary features that provide privacy preservation are implemented in the DataSHIELD architecture. Just one of these is that data custodians/owners (not <italic>analysts</italic>) have complete control over a series of optional filters that dictate the potential disclosivity of the analytic output. As one example, this includes the minimum count acceptable in a non-empty cell of a contingency table. When rare observations are critical to analysis, data custodians can actively choose to relax the filters to enable meaningful analysis to be undertaken. One of the implications of the combined effect of several of the privacy preservation features is that analysts can never see, copy or abstract the individual-level data on the primary data servers.</td>
              <td align="left" rowspan="1" colspan="1">Data protection is shared between existing computer systems and DataSHIELD. An existing computer system that has some poorly implemented secured network access and authentication may threaten the quality of disclosure prevention. In other words, as well as the active privacy preservation built into DataSHIELD software, it is also crucial that the hardware on which everything runs must satisfy good practice for conventional privacy protection.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Graphical User Interface (GUI)</td>
              <td align="left" rowspan="1" colspan="1">The use of R studio and the specialised data warehouse software have a GUI. Analysis can be integrated with GUI packages, such as R Shiny.</td>
              <td align="left" rowspan="1" colspan="1">An appropriate use of R Scripts, R notebooks and vignettes is helpful. DataSHIELD users then need to learn how to use these approaches before using DataSHIELD. The use of R Studio can make the learning curve less steep.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Applications to other biomedical areas than genomics</td>
              <td align="left" rowspan="1" colspan="1">Any other specific data infrastructures available in public repositories such as images (OpenNeuro), transcriptomic or epigenomic data (GEO) can be accessed and analyzed in a distributed and privacy preserving way. Applications outside biomedical, health and social science are also entirely possible.</td>
              <td align="left" rowspan="1" colspan="1">There are no obvious scientific or academic domains to which DataSHIELD could not in principle be applied. Particularly, if the aim is to facilitate the quantitative analysis of individual level data which are sensitive either because of ethico-legal or information-governance restrictions, or because of their intrinsic intellectual or commercial value.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Cost</td>
              <td align="left" rowspan="1" colspan="1">As everything is based on open-source freeware, the costs are minimized for any organisations who wishes to adopt DataSHIELD.</td>
              <td align="left" rowspan="1" colspan="1">While DataSHIELD development is substantively funded through grants, there is nevertheless a need to seek support from the user community (particularly large-scale users) to contribute to the core DataSHIELD provision: user training and support; on-line support materials; bug snagging and error correction; continuous testing of evolving code; preparing and smoothly undertaking new releases.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Time</td>
              <td align="left" rowspan="1" colspan="1">From the user perspective, DataSHIELD is a time-effective tool as does not require iterative in-person communication between the analyst and the data holders. This is most evident in comparing the time commitment required for a standard consortium-based meta-analysis and that required by a centrally controlled study-level meta-analysis via DataSHIELD. The former requires the analysis centre to ask each study to undertake a series of specified analysis and return results (typically several rounds of analysis and return). In contrast the latter is controlled in real time as if one was working directly with the raw data. This can speed things up by orders of magnitude.</td>
              <td align="left" rowspan="1" colspan="1">Like any specialised open-source software, DataSHIELD analysts, developers and installer need some time to adapt to the concepts of federated systems and disclosure limitations.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Server sharing</td>
              <td align="left" rowspan="1" colspan="1">DataSHIELD supports multi-tenancy, to permit multiple users to share a DataSHIELD server. It also permits multiple servers to be deployed if needed.</td>
              <td align="left" rowspan="1" colspan="1">DataSHIELD requires some specialised data warehouse software such as Opal. At the moment there is no white-paper that formally defines standards for further development in this area.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Documentation</td>
              <td align="left" rowspan="1" colspan="1">DataSHIELD has a wiki that provides beginners training to any new DataSHIELD analysts and developers. Some more advanced tutorials are available on multimedia contents through YouTube. Documentation for the Opal specialised data warehouse software is available online.<break/>The online book of this paper will be continuously being updated with more extensions (e.g. transcriptomics, epigenomics, imaging data, longitudinal data analyses, …)</td>
              <td align="left" rowspan="1" colspan="1">DataSHIELD documentation needs to be more supportive to the DataSHIELD developers. An online forum is available for community engagement and support.<break/>No advanced statistical techniques are explicitly taught, as it is assumed that any analyst planning to use DataSHIELD would already understand the theory and practice underpinning the analysis that is to be undertaken. However, in practice the DataSHIELD team knows that this is not always true and so some analytic theory is increasingly being presented when it is useful.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Deployment</td>
              <td align="left" rowspan="1" colspan="1">Software solution packages are available for different hosting systems (includes a container-based option) and the resource concept can adapt itself to the existing hosting infrastructure.<break/>It is advised that DataSHIELD should only be deployed in a setting in which all hardware and middleware systems satisfy conventional best practice for data management and privacy protection. Similarly, it is assumed that DataSHIELD will not be used if information governance or other restrictions already proscribe the particular analysis proposed.</td>
              <td align="left" rowspan="1" colspan="1">It is important that there is at least a minimum baseline level of system administration knowledge on the part of the data owner and proper dimensioning of the hardware (especially when targeting multi-user, computation intensive usage). Nobody should be making sensitive data available for analysis via any mechanism–including DataSHIELD–if they do not have a proper understanding of their data systems or of the governance framework under which analysis is to be enacted.</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <sec id="sec010">
      <title>Available resources extensions</title>
      <p>We have extended the resources available at the <italic>resourcer</italic> package into different settings. These extensions as well as the current resources that can be accessed through the Opal servers are described in <bold><xref rid="pcbi.1008880.t002" ref-type="table">Table 2</xref></bold>. So far, we can get data from different locations (Amazon Web Services, HL7 FHIR or Dremio), read other types of files which are specific in genomic studies (BAM, VCF and PLINK) and access data from other infrastructures such as GA4GH, a federated ecosystem for sharing genomic, clinical data [<xref rid="pcbi.1008880.ref018" ref-type="bibr">18</xref>] and EGA which is a permanent archive that promotes distribution and sharing of genetic and phenotype data consented for specific approved uses [<xref rid="pcbi.1008880.ref019" ref-type="bibr">19</xref>].</p>
      <table-wrap id="pcbi.1008880.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008880.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Available resources at the <italic>resourcer</italic> R package and extensions for genomic data.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008880.t002g" xlink:href="pcbi.1008880.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Type</th>
                <th align="left" rowspan="1" colspan="1">Resource</th>
                <th align="left" rowspan="1" colspan="1">Reference</th>
                <th align="left" rowspan="1" colspan="1">R package</th>
                <th align="left" rowspan="1" colspan="1">Use</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">R data</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/">https://cran.r-project.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">Tidy data (.csv,.tsv, txt, …)</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://www.tidyverse.org/">https://www.tidyverse.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File location</td>
                <td align="left" rowspan="1" colspan="1">S3 compatible file store</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com/">https://min.io/</ext-link>
                  <break/>
                  <ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com/">https://aws.amazon.com/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">s3.resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Database</td>
                <td align="left" rowspan="1" colspan="1">SQL</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://www.mysql.com/">https://www.mysql.com/</ext-link>
                  <break/>
                  <ext-link ext-link-type="uri" xlink:href="https://mariadb.org/">https://mariadb.org/</ext-link>
                  <break/>
                  <ext-link ext-link-type="uri" xlink:href="https://www.postgresql.org/">https://www.postgresql.org/</ext-link>
                  <break/>
                  <ext-link ext-link-type="uri" xlink:href="https://prestodb.io/">https://prestodb.io/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Database and Big Data analytics</td>
                <td align="left" rowspan="1" colspan="1">SQL</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://spark.apache.org/">https://spark.apache.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Database</td>
                <td align="left" rowspan="1" colspan="1">NoSQL</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://www.mongodb.com/">https://www.mongodb.com/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Computation service</td>
                <td align="left" rowspan="1" colspan="1">SSH</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Secure_Shell">https://en.wikipedia.org/wiki/Secure_Shell</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Domain specific</td>
                <td align="left" rowspan="1" colspan="1">HL7 FHIR</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="http://hl7.org/fhir/">http://hl7.org/fhir/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">fhir.resourcer</td>
                <td align="left" rowspan="1" colspan="1">Patient’s data</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Database</td>
                <td align="left" rowspan="1" colspan="1">SQL</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://www.dremio.com/">https://www.dremio.com/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">odbc.resourcer</td>
                <td align="left" rowspan="1" colspan="1">Any</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">VCF</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Variant_Call_Format">https://en.wikipedia.org/wiki/Variant_Call_Format</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">GDS</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/gdsfmt.html">https://bioconductor.org/packages/release/bioc/html/gdsfmt.html</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">BAM</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="http://samtools.github.io/hts-specs/SAMv1.pdf">http://samtools.github.io/hts-specs/SAMv1.pdf</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">File reader</td>
                <td align="left" rowspan="1" colspan="1">Bioconductor infrastructures (ExpressionSet, RangedSummarizedExperiment, MultiAssayExperiment, …)</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/">http://bioconductor.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Computation service</td>
                <td align="left" rowspan="1" colspan="1">PLINK</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="http://zzz.bwh.harvard.edu/plink/">http://zzz.bwh.harvard.edu/plink/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Domain specific</td>
                <td align="left" rowspan="1" colspan="1">GA4GH</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://www.ga4gh.org/">https://www.ga4gh.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic and clinical</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Domain specific</td>
                <td align="left" rowspan="1" colspan="1">EGA</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link ext-link-type="uri" xlink:href="https://ega-archive.org/">https://ega-archive.org/</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">dsOmics</td>
                <td align="left" rowspan="1" colspan="1">Genomic and clinical</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec011">
      <title>Real data analyses</title>
      <p>We illustrate how to perform privacy-protecting big data analyses using our proposed infrastructure. We have set up an Opal demo site (see Chapter 4 in our bookdown) to illustrate how to perform some basic analyses using DataSHIELD as well as how to deal with different <italic>resources</italic> for genomic and geographical data. These data are publicly available and can be accessed through DataSHIELD or using the URL available in the Opal site. The genomic example describes how to perform genome-wide association (GWAS). The geographic examples describe how to analyse information about journeys undertaken by specified individuals’, the environment through which they travel and whether the journeys have an impact on the individuals’ health. Chapter IV in our online book provides users with workflows and case studies for downstream analyses and visualizations.</p>
      <sec id="sec012">
        <title>Genomic data analysis</title>
        <p>Bioconductor provides core data structures and methods that enable genome-scale analysis of high-throughput data in the context of the rich statistical programming environment offered by the R project [<xref rid="pcbi.1008880.ref015" ref-type="bibr">15</xref>]. We have created two packages to perform privacy-protecting federated genomic data analysis with DataSHIELD and Bioconductor. The <italic>dsOmics</italic> package contains the functions that are used on the server side where the actual analysis is implemented and which specify the privacy-protecting summary statistics that will be send back to the client, while the <italic>dsOmicsClient</italic> has the functions that are used on the client side, to control the commands that are send to the server side and to combine the received outcomes for pooled analysis applications.</p>
        <p>Genomic data can be stored in different formats. Variant Call Format (VCF) and PLINK files [<xref rid="pcbi.1008880.ref020" ref-type="bibr">20</xref>]. are commonly used in genetic epidemiology studies. In order to deal with this type of data, we have extended the resources available at the <italic>resourcer</italic> package to VCF files. We use the Genomic Data Storage (GDS) format which is designed for large-scale data management of genome-wide variants and can efficiently manage VCF files into the R environment. This extension requires the creation of specific <italic>ResourceClient</italic> and <italic>ResourceResolver</italic> classes. This extension is available in the <italic>dsOmics</italic> package (See Section 8 in the supplementary book). Briefly, the client class uses <italic>snpgdsVCF2GDS</italic> function implemented in <italic>SNPrelate</italic> to coerce the VCF file to a GDS object [<xref rid="pcbi.1008880.ref021" ref-type="bibr">21</xref>]. Then, the GDS object is loaded into R as an object of class <italic>GdsGenotypeReader</italic> from <italic>GWASTools</italic> package [<xref rid="pcbi.1008880.ref022" ref-type="bibr">22</xref>]. that facilitates downstream analyses such quality control of SNPs and individual data, population stratification and association analyses using <italic>GENESIS</italic> Bioconductor package [<xref rid="pcbi.1008880.ref023" ref-type="bibr">23</xref>].</p>
        <p><bold><xref ref-type="fig" rid="pcbi.1008880.g002">Fig 2</xref></bold> describes how GWAS may be performed using DataSHIELD client-side functions (i.e dsOmicsClient package). Basically, data (genomic and phenotypes/covariates) can be stored in different sites (EGA, GA4GH, https, ssh, AWS S3, local,…) and are managed with Opal through the resourcer package and their extensions implemented in dsOmics. The association analyses involving GWAS are based on fitting different generalized linear models (GLMs) for each SNP that can be performed using a base DataSHIELD function (ds.glm). The difference between standard data analysis and that done by DataSHIELD is that the analysis is performed at the location of the data (e.g. the data nodes). No data is transferred from that location, only non-disclosive summary statistics. The set of analytical operations which can be requested to be performed at the location of the data, has been careful constructed to prevent any attempt for direct or inferential disclosure of any individual-level information. The R parser also blocks any form of arguments that are not allowed in DataSHIELD. For analytical operations which could potential yield results which are disclosive, for example if a small amount of data is being analysed, the operation will check if the results match the data protection policies of the location’s data governance rules, before returning any results back to the client (e.g. the analysis node). If any of the protection rules are violated, the client does not receive any results but gets study-side messages with information about potential disclosure issues [<xref rid="pcbi.1008880.ref002" ref-type="bibr">2</xref>].</p>
        <fig id="pcbi.1008880.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008880.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Scheme of DataSHIELD implementention of genomic data analysis.</title>
            <p>The <italic>dsOmics</italic> package contains functions to perform non-disclosive data analyses of resources encoding genomic data that are managed within Opal using the <italic>resourcer</italic> package. Genomic data normally have two pieces of information, one corresponding to variants (e.g. SNPs) and another for phenotypic data (grouping variable, outcome, covariates, …). Both can be stored in different resources. BAM/VCF/PLINK for SNPs and text/csv file for phenotypes and covariates. This package should be installed in the Opal server along with their dependences. The package <italic>dsOmicsClient</italic> must be available in the client side and contains functions that allow the interaction between the analysis computer and the servers.</p>
          </caption>
          <graphic xlink:href="pcbi.1008880.g002"/>
        </fig>
        <p>It should be noticed that repeatedly calling ds.glm function can be very time consuming when analysing thousands of SNPs which requires multiple iterations of calls over the network between the client and the server. In order to overcome this problem, we also implemented a federated meta-analysis approach that basically runs an independent GWAS at each server and then meta-analyse the results. GDS data at each server are analyzed using GWASTools and GENESIS Bioconductor packages that allows to perform GWAS very quickly. Once the study-specific estimates and standard errors generated by the analyses undertaken on each server have been returned to the client, they can be combined using whatever meta-analysis approaches—and whatever R meta-analysis packages—the user may choose. This methodology has some limitations when data are not properly harmonized (e.g. genotyping in different platforms, different VCF versions,…). In order to overcome this problem, data format validation can also be performed by the analyst using DataSHIELD functions. In genomics, this can be achieved by first doing imputation and then solving issues concerning genomic strand and file format [<xref rid="pcbi.1008880.ref024" ref-type="bibr">24</xref>].</p>
        <p>GWAS can also be performed using programs that are executed using shell commands. This is the case for PLINK, one of the state-of-the-art programs to run GWAS. Resources also allow the use of secure SSH service to run programs on a remote server accessible through SSH containing data and analysis tools where R is just used for launching the analyses and aggregating results. This feature allows us to create functions to analyze data using specific shell programs. Section 9 in our online book describes how the PLINK program can be used to perform GWAS. In this case, the resource describes that access is given via SSH, the credentials required to connect, and the commands that can be run (of which one is plink).</p>
        <p>We would like to emphasize that with DataSHIELD, analysis is performed at the location of the data. The data provider has full control over what information is transferred from their location to the location of the analyst by setting filters for a number of disclosure traps. This means that the results returned to the analyst can be carefully created to be non-disclosive, and match the policies of the data provider’s data governance rules.</p>
      </sec>
      <sec id="sec013">
        <title>Geographic Information System (GIS) and spatial analysis</title>
        <p>The R packages <italic>rgdal</italic>, <italic>rgeos</italic> and <italic>sp</italic> provide core data structures and methods that enable analysis of geospatial data in the context of the rich statistical programming environment offered by the R project. We have created two packages to perform privacy-protecting federated GIS data analysis with DataSHIELD and these packages. The <italic>dsGeo</italic> package contains the functions used on the server side to assure privacy-protecting analyses, while <italic>dsGeoClient</italic> has functions that command the data analyses from the client side and enable integration across studies.</p>
        <p>The <italic>resourcer</italic> package allows large geospatial datasets to be handled. These include data derived from standard storage systems, such as relational databases, making use of existing sp data structures such as <italic>SpatialPoints</italic> and <italic>SpatialLinesDataFrame</italic> among others. These types of data are the core of geospatial analysis in R, allowing users to work with geometries and their descriptive attributes. For example, we might want to know that a GPS trace corresponds to someone who is 45 years old, or that a region defined by a polygon has a particular air pollution level. As described in the methods section, resources can be extended to any type of data that can be managed within R. Here we describe how to extend the resources to the case of analysing Geographic Positioning System (GPS) traces and other geolocation data, combined with phenotypic data.</p>
        <p>Section 13 in our online book illustrates how to perform a realistic analysis of GPS traces and geolocation data. In this example, building on the work of Burgoine et al., [<xref rid="pcbi.1008880.ref025" ref-type="bibr">25</xref>] we consider daily commutes captured as GPS traces by 810 individuals in the eastern suburbs of London. We also have data on the location of 6100 fast food or takeaway outlets in the same area. Further data are available, relating to each individual’s Body Mass Index (BMI), age, sex, total household income, highest educational qualification and smoking status. These data therefore allow us to test the association between exposure to takeaway food on a commute and on individual’s BMI. We illustrate how the tools available in the dsGeo package allow this question to be addressed.</p>
        <p>We created three resources in Opal that contain the GPS journey data (<italic>SpatialLinesDataFrame</italic>), the locations of the food outlets (<italic>SpatialPointsDataFrame</italic>) and the phenotypic data (<italic>data</italic>.<italic>frame</italic>). These data can be manipulated to give a measure of exposure to the food outlets for each individual. Our package allows us to transform the point data denoting food outlets into buffer regions surrounding each point. The idea is that if an individual’s GPS trace falls within this buffer then we can say that the individual is ‘exposed’ to that food outlet. Thus, we find the intersection of each individual’s trace with each buffered region to obtain a vector of the intersecting buffers for each individual. This is further processed into a count of ‘exposures’ per individual. Finally we can run GLMs using the DataSHIELD base function <italic>ds</italic>.<italic>glm()</italic> to test the association between BMI and food outlet exposure, correcting for potential confounding factors such as income.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec014">
    <title>Availability</title>
    <p>We release resourcer R package under the open-source LGPL (≥ 2.1) license. The source code can be downloaded from CRAN and our public repository <ext-link ext-link-type="uri" xlink:href="https://github.com/obiba/resourcer">https://github.com/obiba/resourcer</ext-link>. The server site (e.g. Opal) packages dsOmics and dsGeo are R packages under the open-source MIT and GPL3 licenses, respectively. They can be installed from GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/isglobal-brge/dsOmics">https://github.com/isglobal-brge/dsOmics</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/tombisho/dsGeo">https://github.com/tombisho/dsGeo</ext-link>. The client site R packages dsOmicsClient and dsGeoClient are also publicy available at GitHub repositories <ext-link ext-link-type="uri" xlink:href="https://github.com/isglobal-brge/dsOmicsClient">https://github.com/isglobal-brge/dsOmicsClient</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/tombisho/dsGeoClient">https://github.com/tombisho/dsGeoClient</ext-link>. The “resources” extensions of GA4GH and EGA are available in the dsOmics package. R code describing how to perform the genomic and geographical data analyses using our proposed infrastructure are available in our bookdown <ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown">https://isglobal-brge.github.io/resource_bookdown</ext-link>. Data used in this bookdown are publicly available and can be accessed through DataSHIELD or using the URL available in the Opal site <ext-link ext-link-type="uri" xlink:href="https://opal-demo.obiba.org/">https://opal-demo.obiba.org</ext-link> (user: administrator, password: password, see <ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown/opal.html#opal-demo-site">https://isglobal-brge.github.io/resource_bookdown/opal.html#opal-demo-site</ext-link>). Users may report bugs or other issues via the “Issues” tab at GitHub repositories or using the online forum at <ext-link ext-link-type="uri" xlink:href="https://datashield.discourse.group/">https://datashield.discourse.group/</ext-link>.</p>
  </sec>
  <sec id="sec015">
    <title>Future perspectives</title>
    <sec id="sec016">
      <title>DataSHIELD</title>
      <p>The development of the new “resources” component of the OBiBa middle-ware that underpins the DataSHIELD platform has profound implications for the future of the overall DataSHIELD project. It has greatly relaxed constraints on the source, format and volume of the data that can be ingested into a DataSHIELD session while continuing to provide full flexibility in terms of the capacity to enact active disclosure control at a level appropriately tailored to the context of the particular analytic problem at hand. This has already allowed us to embark on exploring extensions of functionality to encompass some of the most widely used classes of contemporary research data, for example, Omic data and images. In tandem with recent advances we have made in learning how to simplify the extension of functionality in any field provided that a relevant R-package already exists, DataSHIELD is now on the cusp of being able to provide a generic easily usable and simply extendable approach to truly federated analysis across many science and technology domains. This will have a myriad of applications in academic research, commercial settings and health &amp; social care systems. The ability to finely tune disclosure controls in a manner that can only be modified by the data custodian will make this approach particularly attractive for anybody wishing to work with data that are sensitive. This not only includes human (or other) data subject to the appropriately stringent requirements of contemporary law, ethics and broader frameworks for data governance, but also encompasses data that are sensitive for reasons of intellectual property investment or commercial value. However, if disclosure controls are set to be very permissive or off, the convenience, flexibility and potential extendibility of the system could ultimately make this an approach of choice for any federated analysis even if the data are not especially sensitive.</p>
      <p>In light of the development of resources, it is envisaged that in the future there will be at least three flavours of DataSHIELD that will vary in their convenience of use, flexibility and ease of extension of functionality: (1) <bold>All disclosure checks set to off</bold>. This will permit maximum flexibility for analysing non-sensitive federated data and easily extendable by adding new functionality; (2) <bold>Disclosure checks on but minimal</bold>–<italic>e</italic>.<italic>g</italic>. preventing users from seeing or copying the individual level data but avoiding restrictions on the analyses themselves. This flavour is likely to be most useful when data from a large research platform cannot physically be shared but the analysis required is based on data objects that are fundamentally privacy-protecting such as Omics data or images based on internal scanning; (3) <bold>Full disclosure checks</bold>; this will be equivalent to the default situation that applies now.</p>
      <p>Now that it is possible for DataSHIELD to work much more readily with large/big datasets, we anticipate that DataSHIELD and the <italic>resourcer</italic> R package will offer functions based on the tidyverse as well as base-R. For example, this will include the option of using <italic>dplyr</italic> R package for operating on tabular datasets (see <bold>Interacting with R Resources</bold> section) and on tibbles as well as standard R data-frame objects. A resources integration improvement might therefore be to use the <italic>dplyr</italic> API for delegating as much as possible data filtering and mutating to the underlying data storage system (e.g. databases exposing a SQL query interface). This extension is already being explored.</p>
    </sec>
    <sec id="sec017">
      <title>Parallel computing</title>
      <p>Working effectively with large data may also require programming practices that match the available computer hardware infrastructure, both processing and storage. R is efficient when operating on vectors or arrays, so a pattern used by high-performing and scalable algorithms is to split the data into manageable chunks and to iterate over them. Chunks can be evaluated in parallel to gain speed. There are several R packages that can be used to this end (parallel, foreach, …) as well as <italic>BiocParallel</italic> Bioconductor package that facilitates parallel evaluation across different computing environments while allowing users from having to configure the technicalities. DataSHIELD analysis is parallelized by design (i.e. each server is working independently of the others). Therefore, for a server instance, the best approach is to use data structures and analysis tools that perform computations efficiently. This is the strongest point of the resources as we have done with the integration of dplyr and Bioconductor packages as well as those that can be implemented using, for instance, sparklyr [<xref rid="pcbi.1008880.ref026" ref-type="bibr">26</xref>].</p>
    </sec>
    <sec id="sec018">
      <title>Omic and geographical data</title>
      <p>We have provided some of the functionalities offered by Bioconductor and R packages in the DataSHIELD context that allow to analyse genomic and geographical data. These packages are extensive and more work is needed to repackage a more complete range of operations available in a privacy-protecting way. For instance, ds.Omics can be easily be extended to other omic data analyses such as differential gene expression analysis of methylation data analyses using the same strategy as the one used for genomic data. Visualisation can add great value and will be covered when being implemented in a privacy-protecting way. The <italic>dsBaseClient</italic> and <italic>dsBase</italic> packages already contain functions for privacy-protecting plots such as heatmaps and scatter plots. The privacy of data is protected in these cases by effectively blurring the data or by removing outlying points. These techniques could be adapted, for instance, to allow geospatial data to be visualised in a privacy-protecting way.</p>
    </sec>
    <sec id="sec019">
      <title>Data cataloging</title>
      <p>The next step of the resources integration in Opal is to make their meta-data findable to a researcher: exposing the data dictionaries, annotated with taxonomy or ontological terms, would benefit the research community when looking for datasets for a research question. OBiBa software application suite provides both Opal, the data repository (or data integration system, using the resources) and Mica [<xref rid="pcbi.1008880.ref009" ref-type="bibr">9</xref>], the data web portal application. Mica operates by extracting from Opal the dataset dictionaries to build a searchable data catalogue, with basic summary statistics and by allowing the submission of data access requests. Resources registered in Opal should be made visible from Mica as well.</p>
    </sec>
    <sec id="sec020">
      <title>Other applications</title>
      <p>We would like to highlight that there are dozens of disciplines other than genomics and geospatial that could also benefit from our infrastructure. For instance, extending the resources to other settings such as neuroimaging by using libraries from Neuroconductor, a similar project to Bioconductor for computational imaging, would be an important advance in that field since data confidentiality may also be an issue. Also, it is worth noting that one of the main advantages of using the resources is that we do not need to move data from their original repositories which can present a serious problem when dealing with neuroimaging data [<xref rid="pcbi.1008880.ref027" ref-type="bibr">27</xref>]. Another area that can readily benefit from our new framework is artificial intelligence. Big data and machine learning have applied innovatively many advanced statistical methodologies such as deep learning which is driving the creation of new and innovative clinical diagnostic applications among others [<xref rid="pcbi.1008880.ref028" ref-type="bibr">28</xref>]. The current trend is to include machine learning algorithms within Cloud capacities in different biomedical problems [<xref rid="pcbi.1008880.ref029" ref-type="bibr">29</xref>–<xref rid="pcbi.1008880.ref031" ref-type="bibr">31</xref>]. Our framework can interface with “Apache Spark”, a fast and general engine for big data processing [<xref rid="pcbi.1008880.ref032" ref-type="bibr">32</xref>], through the sparklyr R package that will allow the use of different machine learning algorithms for big data.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank the software developers and scientific staff who have worked on Opal. We also acknowledge support provided by Maelstrom Research partners and invaluable feedback we have received from Opal users over the years.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008880.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Bonomi</surname><given-names>L</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Ohno-Machado</surname><given-names>L</given-names></name>. <article-title>Privacy challenges and research opportunities for genomic data sharing</article-title>. <source>Nature Genetics. Nature Research</source>; <year>2020</year>. pp. <fpage>646</fpage>–<lpage>654</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-020-0651-0</pub-id><?supplied-pmid 32601475?><pub-id pub-id-type="pmid">32601475</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Gaye</surname><given-names>A</given-names></name>, <name><surname>Marcon</surname><given-names>Y</given-names></name>, <name><surname>Isaeva</surname><given-names>J</given-names></name>, <name><surname>LaFlamme</surname><given-names>P</given-names></name>, <name><surname>Turner</surname><given-names>A</given-names></name>, <name><surname>Jones</surname><given-names>EM</given-names></name>, <etal>et al</etal>. <article-title>DataSHIELD: taking the analysis to the data, not the data to the analysis</article-title>. <source>Int J Epidemiol</source>. <year>2014</year>;<volume>43</volume>: <fpage>1929</fpage>–<lpage>1944</lpage>. <pub-id pub-id-type="doi">10.1093/ije/dyu188</pub-id><?supplied-pmid 25261970?><pub-id pub-id-type="pmid">25261970</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref003">
      <label>3</label>
      <mixed-citation publication-type="other">Google AI Blog: Federated Analytics: Collaborative Data Science without Data Collection. [cited 7 Jul 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://ai.googleblog.com/2020/05/federated-analytics-collaborative-data.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+blogspot%2FgJZg+%28Google+AI+Blog%29">https://ai.googleblog.com/2020/05/federated-analytics-collaborative-data.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+blogspot%2FgJZg+%28Google+AI+Blog%29</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref004">
      <label>4</label>
      <mixed-citation publication-type="other">Is Federated Analysis the Way Forward for Genomics? | Trusted Digital Research Environment. [cited 6 Jul 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://www.aridhia.com/blog/is-federated-analysis-the-way-forward-for-genomics/">https://www.aridhia.com/blog/is-federated-analysis-the-way-forward-for-genomics/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Walport</surname><given-names>M</given-names></name>, <name><surname>Brest</surname><given-names>P</given-names></name>. <article-title>Sharing research data to improve public health</article-title>. <source>The Lancet.</source> Elsevier; <year>2011</year>. pp. <fpage>537</fpage>–<lpage>539</lpage>. <pub-id pub-id-type="doi">10.1016/S0140-6736(10)62234-9</pub-id>
<?supplied-pmid 21216456?><pub-id pub-id-type="pmid">21216456</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Burton</surname><given-names>PR</given-names></name>, <name><surname>Murtagh</surname><given-names>MJ</given-names></name>, <name><surname>Boyd</surname><given-names>A</given-names></name>, <name><surname>Williams</surname><given-names>JB</given-names></name>, <name><surname>Dove</surname><given-names>ES</given-names></name>, <name><surname>Wallace</surname><given-names>SE</given-names></name>, <etal>et al</etal>. <article-title>Data Safe Havens in health research and healthcare</article-title>. <source>Bioinformatics</source>. 2015/06/25. <year>2015</year>;<volume>31</volume>: <fpage>3241</fpage>–<lpage>3248</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv279</pub-id><?supplied-pmid 26112289?><pub-id pub-id-type="pmid">26112289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wolfson</surname><given-names>M</given-names></name>, <name><surname>Wallace</surname><given-names>SE</given-names></name>, <name><surname>Masca</surname><given-names>N</given-names></name>, <name><surname>Rowe</surname><given-names>G</given-names></name>, <name><surname>Sheehan</surname><given-names>NA</given-names></name>, <name><surname>Ferretti</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>DataSHIELD: resolving a conflict in contemporary bioscience—performing a pooled analysis of individual-level data without sharing the data</article-title>. <source>Int J Epidemiol.</source> 2010/07/14. <year>2010</year>;<volume>39</volume>: <fpage>1372</fpage>–<lpage>1382</lpage>. <pub-id pub-id-type="doi">10.1093/ije/dyq111</pub-id>
<?supplied-pmid 20630989?><pub-id pub-id-type="pmid">20630989</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Doiron</surname><given-names>D</given-names></name>, <name><surname>Burton</surname><given-names>P</given-names></name>, <name><surname>Marcon</surname><given-names>Y</given-names></name>, <name><surname>Gaye</surname><given-names>A</given-names></name>, <name><surname>Wolffenbuttel</surname><given-names>BHR</given-names></name>, <name><surname>Perola</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Data harmonization and federated analysis of population-based studies: The BioSHaRE project</article-title>. <source>Emerg Themes Epidemiol</source>. <year>2013</year>;<volume>10</volume>: <fpage>12</fpage>. <pub-id pub-id-type="doi">10.1186/1742-7622-10-12</pub-id><?supplied-pmid 24257327?><pub-id pub-id-type="pmid">24257327</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Doiron</surname><given-names>D</given-names></name>, <name><surname>Marcon</surname><given-names>Y</given-names></name>, <name><surname>Fortier</surname><given-names>I</given-names></name>, <name><surname>Burton</surname><given-names>P</given-names></name>, <name><surname>Ferretti</surname><given-names>V</given-names></name>. <article-title>Software Application Profile: Opal and Mica: open-source software solutions for epidemiological data management, harmonization and dissemination</article-title>. <source>Int J Epidemiol</source>. <year>2017</year>;<volume>46</volume>: <fpage>1372</fpage>–<lpage>1378</lpage>. <pub-id pub-id-type="doi">10.1093/ije/dyx180</pub-id><?supplied-pmid 29025122?><pub-id pub-id-type="pmid">29025122</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Wilson</surname><given-names>RC</given-names></name>, <name><surname>Butters</surname><given-names>OW</given-names></name>, <name><surname>Avraam</surname><given-names>D</given-names></name>, <name><surname>Baker</surname><given-names>J</given-names></name>, <name><surname>Tedds</surname><given-names>JA</given-names></name>, <name><surname>Turner</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>DataSHIELD–New Directions and Dimensions</article-title>. <source>Data Sci J</source>. <year>2017</year>;<volume>16</volume>. <pub-id pub-id-type="doi">10.5334/dsj-2017-015</pub-id><?supplied-pmid 31708979?><pub-id pub-id-type="pmid">31708979</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">EUCAN Connect. [cited 26 Mar 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://www.eucanconnect.eu/">https://www.eucanconnect.eu/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref012">
      <label>12</label>
      <mixed-citation publication-type="other">Home—LifeCycle. [cited 26 Mar 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://lifecycle-project.eu/">https://lifecycle-project.eu/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref013">
      <label>13</label>
      <mixed-citation publication-type="other">Advancing Tools for Human Early Lifecourse Exposome Research and Translation | ATHLETE Project | H2020 | CORDIS | European Commission. [cited 26 Mar 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://cordis.europa.eu/project/id/874583/es">https://cordis.europa.eu/project/id/874583/es</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref014">
      <label>14</label>
      <mixed-citation publication-type="other">Interconnect Project—Homepage. [cited 9 Jun 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://interconnectproject.eu/">https://interconnectproject.eu/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Carey</surname><given-names>VJ</given-names></name>, <name><surname>Gentleman</surname><given-names>R</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Carlson</surname><given-names>M</given-names></name>, <name><surname>Carvalho</surname><given-names>BS</given-names></name>, <etal>et al</etal>. <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>: <fpage>115</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id><?supplied-pmid 25633503?><pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Muschelli</surname><given-names>J</given-names></name>, <name><surname>Gherman</surname><given-names>A</given-names></name>, <name><surname>Fortin</surname><given-names>J-P</given-names></name>, <name><surname>Avants</surname><given-names>B</given-names></name>, <name><surname>Whitcher</surname><given-names>B</given-names></name>, <name><surname>Clayden</surname><given-names>JD</given-names></name>, <etal>et al</etal>. <article-title>Neuroconductor: an R platform for medical imaging analysis</article-title>. <source>Biostatistics.</source><year>2019</year>;<volume>20</volume>: <fpage>218</fpage>–<lpage>239</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxx068</pub-id><?supplied-pmid 29325029?><pub-id pub-id-type="pmid">29325029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Masinter</surname><given-names>L</given-names></name>, <name><surname>Berners-Lee</surname><given-names>T</given-names></name>, <name><surname>Fielding</surname><given-names>RT</given-names></name>. <article-title>Uniform Resource Identifier (URI): Generic Syntax</article-title>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><chapter-title>A federated ecosystem for sharing genomic, clinical data</chapter-title>. <source>Science.</source><publisher-name>American Association for the Advancement of Science</publisher-name>; <year>2016</year>. pp. <fpage>1278</fpage>–<lpage>1280</lpage>. <pub-id pub-id-type="doi">10.1126/science.aaf6162</pub-id><?supplied-pmid 27284183?></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lappalainen</surname><given-names>I</given-names></name>, <name><surname>Almeida-King</surname><given-names>J</given-names></name>, <name><surname>Kumanduri</surname><given-names>V</given-names></name>, <name><surname>Senf</surname><given-names>A</given-names></name>, <name><surname>Spalding</surname><given-names>JD</given-names></name>, <name><surname>Ur-Rehman</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The European Genome-phenome Archive of human data consented for biomedical research</article-title>. <source>Nature Genetics. Nature Publishing Group</source>; <year>2015</year>. pp. <fpage>692</fpage>–<lpage>695</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3312</pub-id><?supplied-pmid 26111507?><pub-id pub-id-type="pmid">26111507</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">PLINK: Whole genome data analysis toolset. [cited 15 May 2020]. Available: <ext-link ext-link-type="uri" xlink:href="http://zzz.bwh.harvard.edu/plink/">http://zzz.bwh.harvard.edu/plink/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>X</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name>, <name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Gogarten</surname><given-names>SM</given-names></name>, <name><surname>Laurie</surname><given-names>C</given-names></name>, <name><surname>Weir</surname><given-names>BS</given-names></name>. <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>3326</fpage>–<lpage>3328</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts606</pub-id><?supplied-pmid 23060615?><pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Gogarten</surname><given-names>SM</given-names></name>, <name><surname>Bhangale</surname><given-names>T</given-names></name>, <name><surname>Conomos</surname><given-names>MP</given-names></name>, <name><surname>Laurie</surname><given-names>CA</given-names></name>, <name><surname>McHugh</surname><given-names>CP</given-names></name>, <name><surname>Painter</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>3329</fpage>–<lpage>3331</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts610</pub-id><?supplied-pmid 23052040?><pub-id pub-id-type="pmid">23052040</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Gogarten</surname><given-names>SM</given-names></name>, <name><surname>Sofer</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>H</given-names></name>, <name><surname>Yu</surname><given-names>C</given-names></name>, <name><surname>Brody</surname><given-names>JA</given-names></name>, <name><surname>Thornton</surname><given-names>TA</given-names></name>, <etal>et al</etal>. <article-title>Genetic association testing using the GENESIS R/Bioconductor package</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>5346</fpage>–<lpage>5348</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz567</pub-id><?supplied-pmid 31329242?><pub-id pub-id-type="pmid">31329242</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Deelen</surname><given-names>P</given-names></name>, <name><surname>Bonder</surname><given-names>MJ</given-names></name>, <name><surname>Van Der Velde</surname><given-names>KJ</given-names></name>, <name><surname>Westra</surname><given-names>HJ</given-names></name>, <name><surname>Winder</surname><given-names>E</given-names></name>, <name><surname>Hendriksen</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Genotype harmonizer: Automatic strand alignment and format conversion for genotype data integration</article-title>. <source>BMC Res Notes</source>. <year>2014</year>;<volume>7</volume>: <fpage>901</fpage>. <pub-id pub-id-type="doi">10.1186/1756-0500-7-901</pub-id><?supplied-pmid 25495213?><pub-id pub-id-type="pmid">25495213</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Burgoine</surname><given-names>T</given-names></name>, <name><surname>Forouhi</surname><given-names>NG</given-names></name>, <name><surname>Griffin</surname><given-names>SJ</given-names></name>, <name><surname>Wareham</surname><given-names>NJ</given-names></name>, <name><surname>Monsivais</surname><given-names>P</given-names></name>. <article-title>Associations between exposure to takeaway food outlets, takeaway food consumption, and body weight in Cambridgeshire, UK: Population based, cross sectional study</article-title>. <source>BMJ</source>. <year>2014</year>;<fpage>348</fpage>. <pub-id pub-id-type="doi">10.1136/bmj.g1464</pub-id><?supplied-pmid 24625460?><pub-id pub-id-type="pmid">24625460</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">sparklyr. [cited 15 May 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://spark.rstudio.com/">https://spark.rstudio.com/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>SM</given-names></name>, <name><surname>Nichols</surname><given-names>TE</given-names></name>. <article-title>Statistical Challenges in “Big Data” Human Neuroimaging</article-title>. <source>Neuron. Cell Press</source>; <year>2018</year>. pp. <fpage>263</fpage>–<lpage>268</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2017.12.018</pub-id><?supplied-pmid 29346749?><pub-id pub-id-type="pmid">29346749</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Xue</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>. <article-title>Current status and future trends of clinical diagnoses via image-based deep learning Theranostics</article-title>. <source>Ivyspring International Publisher</source>; <year>2019</year>. pp. <fpage>7556</fpage>–<lpage>7565</lpage>. <pub-id pub-id-type="doi">10.7150/thno.38065</pub-id><?supplied-pmid 31695786?><pub-id pub-id-type="pmid">31695786</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Abedini</surname><given-names>M</given-names></name>, <name><surname>Von Cavallar</surname><given-names>S</given-names></name>, <name><surname>Chakravorty</surname><given-names>R</given-names></name>, <name><surname>Davis</surname><given-names>M</given-names></name>, <name><surname>Garnavi</surname><given-names>R</given-names></name>. <chapter-title>A Cloud-Based Infrastructure for Feedback-Driven Training and Image Recognition</chapter-title>. <source>Studies in Health Technology and Informatics</source>. <publisher-name>IOS Press</publisher-name>; <year>2015</year>. pp. <fpage>691</fpage>–<lpage>695</lpage>. <pub-id pub-id-type="doi">10.3233/978-1-61499-564-7-691</pub-id><?supplied-pmid 26262140?></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Ping</surname><given-names>P</given-names></name>, <name><surname>Hermjakob</surname><given-names>H</given-names></name>, <name><surname>Polson</surname><given-names>JS</given-names></name>, <name><surname>Benos</surname><given-names>PV</given-names></name>., <article-title>Wang W. Biomedical informatics on the cloud: A treasure hunt for advancing cardiovascular medicine</article-title>. <source>Circ Res</source>. <year>2018</year>;<volume>122</volume>: <fpage>1290</fpage>–<lpage>1301</lpage>. <pub-id pub-id-type="doi">10.1161/CIRCRESAHA.117.310967</pub-id><?supplied-pmid 29700073?><pub-id pub-id-type="pmid">29700073</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>De Sousa</surname><given-names>C</given-names></name>, <name><surname>Fatoyinbo</surname><given-names>L</given-names></name>, <name><surname>Neigh</surname><given-names>C</given-names></name>, <name><surname>Boucka</surname><given-names>F</given-names></name>, <name><surname>Angoue</surname><given-names>V</given-names></name>, <name><surname>Larsen</surname><given-names>T</given-names></name>. <article-title>Cloud-computing and machine learning in support of country-level land cover and ecosystem extent mapping in Liberia and Gabon</article-title>. <source>PLoS One</source>. <year>2020</year>;<volume>15</volume>. <pub-id pub-id-type="doi">10.1371/journal.pone.0227438</pub-id><?supplied-pmid 31923284?><pub-id pub-id-type="pmid">31923284</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008880.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>R</given-names></name>, <name><surname>Zhao</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Fang</surname><given-names>X</given-names></name>, <name><surname>Peng</surname><given-names>S</given-names></name>. <article-title>Bioinformatics applications on apache spark</article-title>. <source>Gigascience</source>. <year>2018</year>;<volume>7</volume>: <fpage>giy098</fpage>. <pub-id pub-id-type="doi">10.1093/gigascience/giy098</pub-id><?supplied-pmid 30101283?><pub-id pub-id-type="pmid">30101283</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008880.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008880.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="pmc" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008880" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">2 Oct 2020</named-content>
    </p>
    <p>Dear Dr Gonzalez,</p>
    <p>Thank you very much for submitting your manuscript "Orchestrating non-disclosive big data analyses of data from different resources with R and DataSHIELD" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>Specifically, please simplify and make the main manuscript clearer based on reviewer's suggestions.</p>
    <p>I didn't find a link to the code repository. Please provide it in the revised version.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Reproducibility report has been uploaded as an attachment.</p>
    <p>Reviewer #2: Abstract: This abstract is too wordy and uses long sentences.</p>
    <p>Example:</p>
    <p>Therefore, big data analyses should ensure appropriate levels of security and privacy, be rigorous with the application of the data confidentiality regulations and address the choice between central data warehousing and the distributed (federated) analysis of data that remain ‘in-house’.</p>
    <p>Why do we need "therefore"? What is "appropriate"? Why should analyses "address the choice"?</p>
    <p>I can understand the basic objective in two sentences: Integrative analysis of multiple large datasets is a common objective in research [here you might focus on computational biology and use that term instead]. When data components of an integrative analysis are managed in distinct and independent systems, steps must be taken to ensure that confidentiality requirements are satisfied at all stages of the analysis.</p>
    <p>With one more sentence you could describe key principles and tools to be described in the paper, and the abstract is done. For example, you could mention that DataSHIELD and Obiba are a decade old and that your work enhances these. Note that this reader has never heard of either of these projects, and that there is a cybersecurity company in Arizona USA called Datashield. This could be confusing, and you may want to clarify that Obiba is an open source project in the domain of bioinformatics, and that DataSHIELD is a collection of R packages usable by users of Opal.</p>
    <p>Text: The first paragraph repeats much of the abstract; this should be avoided. The phrase "the Opal data warehouse" is used without explanation. I have never heard of this.</p>
    <p>After browsing around obiba and looking at the three figures, I have a sense of what this project is about. The "book" <ext-link ext-link-type="uri" xlink:href="https://isglobal-brge.github.io/resource_bookdown/">https://isglobal-brge.github.io/resource_bookdown/</ext-link> is nicely done and is a good supplemental resource for the paper. The figures of the paper give a vague sense of the collections of components in scope, and show "firewalls". But there is no clear depiction of how "non-disclosure" is achieved or guaranteed.</p>
    <p>The paper suffers from the lack of tables that would help readers to understand capabilities and limitations in comparison to other frameworks. The paper also fails to mention GA4GH (Global Alliance for Genomics and Health), that aims to develop standards in this domain. See ga4<ext-link ext-link-type="uri" xlink:href="http://gh.org">gh.org</ext-link>, where all the main toolkits would seem to intersect with items described in the paper.</p>
    <p>In summary, the paper reads like a mix between advertising and user manual, and mentions but really does not illuminate connections to computational biology practices. The tools appear well-motivated and well-documented, and may well deserve broad adoption. But this paper as written does not provide a strong argument for engaging with an inevitably complex environment. The basic principles can be articulated simply, but the proof that they are implemented in the system described here, and a demonstration that this implementation should be used by anyone who shares its objectives, will take more work and a more self-critical stance.</p>
    <p>Reviewer #3: We were delighted to read about the datashield resources feature and think it is a great innovation that needs to get large attention from the scientific community. Datashield changes analysis practice by bringing analysis to the data, instead of first centralizing data, and does so in a practical usable way for researchers via the R statistical language. Thus, it provides a solution to the increasing difficult challenge of enabling pooled analysis of data from multiple centers and even countries for sensitive data which has become more challenging because of uncertainties around GDPR etc. However, datashield was limited to only the methods implemented by the datashield team and R who, while doing a great job, cannot be expected to address all analysis needs. The resources approach enables statististicians/bioinformaticians to create bespoke analysis pipelines and distribute them to centers automatically and provide access controls without needing to have much local analyst work (in contrast to sending around a cookbook and then requiring a local statistician to execute by hand).</p>
    <p>Below we have comments and suggestions:</p>
    <p>===</p>
    <p>Overall we have the following concerns:</p>
    <p>1.</p>
    <p>The manuscript is in places uses many more words then necessary. This proza sometimes makes it hard to follow. So we would urge the authors to shorten and simplify the text where possible. Also carefully check for typos, in particular on the nice online book.</p>
    <p>2.</p>
    <p>One of the core features should be that data providers can precisely access control. However, it is not clearly described but based on test we believe it is actually quite simple. We think you should make this explicit from the start, i.e., in abstract, and also deserves a short alinea to describe how it works in practice</p>
    <p>3.</p>
    <p>While the authors give nice examples on analysis (actually more than needed), one thing that we found missing is how the authors believe complex analysis protocols will be distributed from central analysis site to local data providres. Because in case of sensitive data, we expect data providers to want to limit access to only one resource, i.e. a particular analysis procedure. Then the question is: how will such procedures be distributed from a central analysis site (i.e. lead of a consortium analysis) to all connected sites (i.e. data providers) without needing large local expertise. We believe that for example for distributed meta analysis such process should be seamless (otherwise still local expertise is needed to operate)</p>
    <p>4.</p>
    <p>Finally, in our own experience the hosting environment of the participating data providers can be quite heterogeneous. You might want to discuss how you expect to deal with a resource based analysis in for example a network of 20 data providers and how you would expect the analysis to accommodate these differences (without having to address these all via the central analysis lead).</p>
    <p>===</p>
    <p>Some text was hard to follow, and you might want to rephrase</p>
    <p>5.</p>
    <p>“Such analysis not only demands scalable methods and</p>
    <p>appropriate mathematical models but must also maintain consistency with fundamental principles of</p>
    <p>sound data management and data sharing that are common across all areas of health, social and</p>
    <p>bioscience. Therefore, big data analyses should ensure appropriate levels of security and privacy, be</p>
    <p>rigorous with the application of the data confidentiality regulations and address the choice between</p>
    <p>central data warehousing and the distributed (federated) analysis of data that remain ‘in-house’.</p>
    <p>“</p>
    <p>6.</p>
    <p>“This</p>
    <p>requires data generators to physically transfer data [propose you add: to a central analysis server] to make them accessible to analytic users.”</p>
    <p>7.</p>
    <p>I got lost in the Methods section. It would greatly help if you give a short introduction, naming the main elements and how they fit together.</p>
    <p>8.</p>
    <p>“We define “resource” this data storage or computation access description”. I think you want to be more explicit, because apparently ‘resource’ is a URL that can denote file handle, data access protocol, or execution of some script.</p>
    <p>===</p>
    <p>Furthermore, we have minor suggestions that you can ignore but may be of use to the authors:</p>
    <p>You state on page 1 that data has to be physically transferred to the warehouse. There are several tools that federate analysis to overcome this issue so you might want to rephrase. For example: <ext-link ext-link-type="uri" xlink:href="https://www.dremio.com/">https://www.dremio.com/</ext-link>.</p>
    <p>Resources credentials are fixed and managed by Opal which implies you do not have a refresh token or something like that, that will expire over time. The policy decision and enforcement is now located in the DataSHIELD engine. This means that the resource owner can not decide anymore if someone has access to the resource. Audit logging at the resource side is hard to do this way.</p>
    <p>If the computational resource needs to do a lot, you need to program that either in the ResourceExtension or as given commands.</p>
    <p>When you program an extension you are dependent on the person's choices regarding the interface he/she exposes and when you give it as parameters in the resource you need to parse it in the resourcer package..</p>
    <p>For example, how do you prevent malicious SQL injection? We would expect that you would not open up such resources to the external source but only a pre-packaged analysis.</p>
    <p>You are still bound to the limitations of R in terms of memory and CPU usage when you want to correlate data in R against the data that is available in the resource. You need to either push the data you want to correlate against into the resource or extract it from the resource in the R-environment.</p>
    <p>What is going to happen when you want to finish the analysis on another moment. Or the analysis is taking days how do you retrieve the result.</p>
    <p>When the analysis is taking a lot of resources in terms of memory and CPU how do you limit this per DataSHIELD-user? Who is responsible for this, DataSHIELD or the resource owner?</p>
    <p>The resource owner needs to implement a way to be easily accessible for the resourcer-package. Especially when you want to run more complex jobs it usually takes a complex interface to work with.</p>
    <p>In the shell and ssh resource the Opal administrator is managing the actions that may be performed by the resource handler (researcher in general). When you host Opal on different infrastructure than the resource and is managed by someone who is not in charge of managing the resource the list of possible commands can be freely added to the resource. This possible allows</p>
    <p>On page 7 and 12 you state that the disclosure control on big data is often more relaxed. In practice we do not encounter this relaxation. We are very keen on analysing data outside our facility but are bound to the current contracts regarding data transfer or access agreements which take a lot of time to arrange.</p>
    <p>How can we make sure when you offer more open data in a way that it will be legally feasible to access the data without signing a data transfer or large access agreement?</p>
    <p>In other words is it practically feasible to do analysis in this way regarding the juridical implications?</p>
    <p>Maybe less dependencies in the resourcer package?</p>
    <p>When the interface of a dependency is changed the package needs to be changed as well.</p>
    <p>Think of a way to delegate the authorisation and authentication back to the resource owner. We would propose to change the way of passing credentials in the resource.</p>
    <p>Is it possible to restrict the usage of certain resources? For example, prohibit the use of resources.</p>
    <p>It would be nice to have some way of enforcing the metadata which is tight toi the data to be correct. This is often the problem with longitudinal data that metadata over all columns should be correct. It is likely that this also yields for big data structures that are analysed in a pooled manner. How do you handle multiple versions of VCF for example?</p>
    <p>Book 16.3 is not finished</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: <bold>No: </bold>It seems possible that the data related to Figure 3, or described in "Differential Gene Expression Analysis" is all available, but the paper does not provide explicit links, and it is not clear whether any reader would need to register or be authorized to interact with such data.</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Anand K. Rampadarath</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
    <supplementary-material content-type="local-data" id="pcbi.1008880.s001">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Reproducible_report_PCOMPBIOL_D_20_01312.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008880.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008880.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008880.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008880" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">4 Dec 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008880.s002">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Answer_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008880.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008880.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008880.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="pmc" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008880" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">17 Mar 2021</named-content>
    </p>
    <p>Dear Dr Gonzalez,</p>
    <p>We are pleased to inform you that your manuscript 'Orchestrating privacy-protected big data analyses of data from different resources with R and DataSHIELD' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The Reproducibility report has been submitted as an attachment.</p>
    <p>Reviewer #2: none</p>
    <p>Reviewer #3: Thank your for this work and precisely described responses and changes made.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Anand K. Rampadarath</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <supplementary-material content-type="local-data" id="pcbi.1008880.s003">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Reproducible_report_PCOMPBIOL_D_20_01312R1 (1).pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008880.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008880.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008880.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="pmc" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008880" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Mar 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-20-01312R1 </p>
    <p>Orchestrating privacy-protected big data analyses of data from different resources with R and DataSHIELD</p>
    <p>Dear Dr Gonzalez,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Katalin Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
