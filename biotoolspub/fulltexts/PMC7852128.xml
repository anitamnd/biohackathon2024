<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7852128</article-id>
    <article-id pub-id-type="publisher-id">3967</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-03967-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>tidyMicro</italic>: a pipeline for microbiome data analysis and visualization using the <italic>tidyverse</italic> in R</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4698-1516</contrib-id>
        <name>
          <surname>Carpenter</surname>
          <given-names>Charlie M.</given-names>
        </name>
        <address>
          <email>charles.carpenter@cuanschutz.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Frank</surname>
          <given-names>Daniel N.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williamson</surname>
          <given-names>Kayla</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arbet</surname>
          <given-names>Jaron</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wagner</surname>
          <given-names>Brandie D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kechris</surname>
          <given-names>Katerina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kroehl</surname>
          <given-names>Miranda E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Department of Biostatistics and Informatics, Colorado School of Public Health, </institution><institution>University of Colorado Anschutz Medical Campus, </institution></institution-wrap>Aurora, CO USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Division of Infectious Diseases, Department of Medicine, </institution><institution>University of Colorado Anschutz Medical Campus, </institution></institution-wrap>Denver, CO USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>41</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The drive to understand how microbial communities interact with their environments has inspired innovations across many fields. The data generated from sequence-based analyses of microbial communities typically are of high dimensionality and can involve multiple data tables consisting of taxonomic or functional gene/pathway counts. Merging multiple high dimensional tables with study-related metadata can be challenging. Existing microbiome pipelines available in R have created their own data structures to manage this problem. However, these data structures may be unfamiliar to analysts new to microbiome data or R and do not allow for deviations from internal workflows. Existing analysis tools also focus primarily on community-level analyses and exploratory visualizations, as opposed to analyses of individual taxa.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed the R package “<italic>tidyMicro”</italic> to serve as a more complete microbiome analysis pipeline. This open source software provides all of the essential tools available in other popular packages (e.g., management of sequence count tables, standard exploratory visualizations, and diversity inference tools) supplemented with multiple options for regression modelling (e.g., negative binomial, beta binomial, and/or rank based testing) and novel visualizations to improve interpretability (e.g., Rocky Mountain plots, longitudinal ordination plots). This comprehensive pipeline for microbiome analysis also maintains data structures familiar to R users to improve analysts’ control over workflow. A complete vignette is provided to aid new users in analysis workflow.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>tidyMicro</italic> provides a reliable alternative to popular microbiome analysis packages in R. We provide standard tools as well as novel extensions on standard analyses to improve interpretability results while maintaining object malleability to encourage open source collaboration. The simple examples and full workflow from the package are reproducible and applicable to external data sets.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Pipeline</kwd>
      <kwd>R</kwd>
      <kwd>Tidyverse</kwd>
      <kwd>Visualization</kwd>
      <kwd>Open source</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DK101659</award-id>
        <award-id>DK114711</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014450</institution-id>
            <institution>Anschutz Medical Campus, University of Colorado</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TR001082</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">The microbiome plays a large, sometimes even causal, role in the conditions of their environment [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. The drive to understand the interplay between microbiota community structure and host pathophysiology has sparked active research across several fields. Technological advances in sequencing accuracy, depth, and throughput now allow comprehensive analysis of microbial communities through both targeted (i.e., marker-gene surveys, such as 16S rRNA genes) and untargeted (i.e., shotgun metagenomics) approaches. However, the high dimensional nature of these data can be difficult to manage. Research projects often involve management and integration of multiple sequence-based datasets, along with the corresponding clinical data. Merging these data sets together into a workable format can be difficult and time consuming.</p>
    <p id="Par9">This problem inspired microbiome analysis pipelines to construct their own data structures for data management, the most popular in R [<xref ref-type="bibr" rid="CR6">6</xref>] being the <italic>phyloseq</italic>-class [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. The majority of omics analysis pipelines available in R rely on “S4” level objects since they provide flexibility beyond data frames and lists. However, these data structures impose severe limitations to the users’ control over their analysis and do not accommodate functions from external packages. Furthermore, popular microbiome pipelines focus heavily on community level analyses and exploratory visualizations (e.g. ordination plots, stacked bar charts of raw abundances). Those who offer taxon level models do not provide model visualization techniques. Model visualizations tailored to microbiome data would improve collaboration and convey “big picture” results better than using large summary tables alone.</p>
    <p id="Par10">We introduce a new R package, “<italic>tidyMicro</italic>,” that extends typical components of microbiome analysis tools by incorporating several new data analysis and visualization tools while following the principles of the <italic>tidyverse </italic>[<xref ref-type="bibr" rid="CR9">9</xref>]. These data structures and workflow principles grant the capability to adopt user extensions and integrate external functions, a unique feature that distinguishes <italic>tidyMicro</italic> from other R-based microbiome analysis pipelines. The viability of the pipeline was evaluated using published sequencing data from a study on bacterial community relationships to bronchopulmonary dysplasia in preterm infants [<xref ref-type="bibr" rid="CR10">10</xref>] and data from a study on the nasal microbiome of hospital inpatients suffering from Staphylococcus aureus infections [<xref ref-type="bibr" rid="CR11">11</xref>]. The package is currently available through GitHub and CRAN.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par11">The <italic>tidyMicro</italic> pipeline consists of 5 macro operations with several options within each (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). All operations are implemented and supported through R, with graphics and coding style following the general style of the <italic>tidyverse</italic>. The first step in the pipeline is merging OTU table(s) and clinical data together into a “tidy” format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). From here, several functions are provided to explore the data visually (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), calculate and analyze community diversity measures (i.e. alpha-diversity and beta-diversity analyses; Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), model abundance and prevalence of individual taxa (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), and summarize and visualize model results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e).<fig id="Fig1"><label>Fig. 1</label><caption><p>Flowchart of the <italic>tidyMicro</italic> pipeline. The supplied OTU table(s) must be in the standard format output by QIIME with column names that match a sequencing library names column in the clinical data. The initial step is merging all OTU tables and clinical data using the <italic>tidy_micro</italic> function (<bold>a</bold>). From here, the <italic>tidyMicro</italic> set can be used for exploratory visuals (<bold>b</bold>), community level analyses (<bold>c</bold>), and taxa level analyses (<bold>d</bold>, <bold>e</bold>)</p></caption><graphic xlink:href="12859_2021_3967_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par12">In this paper, we demonstrate a standard workflow using two published data sets. We use data from a study that set out to define the nasal microbiome of hospital inpatients who are persistently colonized with methicillin-resistant Staphylococcus aureus (MRSA) compared with matched, non-colonized controls [<xref ref-type="bibr" rid="CR11">11</xref>] as our primary example set. We also use a subset of a published data set from a study assessing connections between airway taxa and bronchopulmonary dysplasia (BPD) severity in prematurely born infants [<xref ref-type="bibr" rid="CR10">10</xref>]. The BPD study allows us to demonstrate a new visualization technique for longitudinal data and the package’s ability to handle multiple OTU tables. These examples do not illustrate all possible options and functions available through <italic>tidyMicro</italic>. Instead they serve as a useful overview of the pipeline’s primary functions with full descriptions of novel features. It also demonstrates the pipeline’s ability to create reproducible microbiome analyses through popular open source software.</p>
    <sec id="Sec3">
      <title>Motivating examples</title>
      <sec id="Sec4">
        <title>MRSA study</title>
        <p id="Par13">In the MRSA study researchers acquired samples from an active MRSA screening from the Department of Veterans Affairs Eastern Colorado Health Care System. Patients were screened for nasal MRSA colonization at admission, inter-ward transfer, weekly intervals of a <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 7$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq1.gif"/></alternatives></inline-formula> day stay in any ward, discharge, and death. An MRSA persistent carrier case was defined as someone from whom at least 5 swabs had been taken, at least 1 week apart, and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 80\%$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq2.gif"/></alternatives></inline-formula> of nasal swabs were positive for MRSA. An MRSA noncarrier control was defined as a someone from whom at least 5 swabs had been taken, at least 1 week apart, and all swabs were negative for MRSA. Noncarrier controls were then matched to persistent carriers based on known colonization risk factors including age, diabetes mellitus, long-term care residence (nursing home), and several others. Bacterial profiles were determined by broad-range amplification and sequence analysis of 16S ribosomal RNA (rRNA) genes. We have classified the sequencing reads into their genus level taxonomic ranks. This cohort’s demographics are summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
      </sec>
      <sec id="Sec5">
        <title>Bronchopulmonary dysplasia</title>
        <p id="Par14">In the BPD study, tracheal aspirate samples were collected at 7, 14, and 21 days of life (± 48 h) from pre-term infants requiring mechanical ventilation. This subset of the original data set contains sequences from 24 infants, all ventilated at 7 days of life. Only 15 of these 24 had samples from all 3 time points. Bacterial profiles were determined by broad-range amplification and sequence analysis of 16S rRNA genes. We have classified the sequencing reads into their phylum, class, order, and family level taxonomic ranks to demonstrate the pipeline’s ability to manage multiple OTU tables. These cohort demographics are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results:</title>
    <sec id="Sec7">
      <title>Data Structure</title>
      <p id="Par15">In a typical OTU table format [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>], the first column contains OTU names and the following columns contain sequence read counts for each sample (sequencing library). The <italic>tidy_micro</italic> function can read in any number of OTU tables from targeted or untargeted sequencing methods and merge them with clinical data into a tidy data format. Merging four OTU tables from sequences classified to the phylum, class, order, and family level taxonomic ranks is demonstrated below:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$tidy\_micro\left( {otu\_tabs = list\left( {Phylum = bpd\_phy,Class = bpd\_cla,Order = bpd\_ord,Family = bpd\_fam} \right),clinical = bpd\_clin,complete\_clin = TRUE} \right).$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>_</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>_</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>U</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3967_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par16">This creates a data frame with a hierarchical structure with a “block” for each OTU table and taxa “blocks” within each OTU table block (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The taxa blocks will contain the taxa counts for each sample and the samples’ corresponding clinical information.<fig id="Fig2"><label>Fig. 2</label><caption><p>Structure of a <italic>tidyMicro</italic> data set. A <italic>tidyMicro</italic> data set is a data frame with a hierarchical structure where each OTU table creates a block containing taxa blocks for each taxa within the table. Clinical data is repeated within each taxa block. This structure allows users to easily create custom extensions</p></caption><graphic xlink:href="12859_2021_3967_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par17">Within each taxa block <italic>tidy_micro</italic> also calculates taxa presence/absence, relative abundance, and centered log ratio (CLR) transformed counts <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{p}=\mathrm{log}\left(\frac{{X}_{p}}{g\left({X}_{p}\right)}\right),$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>X</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq3.gif"/></alternatives></inline-formula> where <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\left({X}_{p}\right)={\left({\prod }_{p}{X}_{p}\right)}^{1/P}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mo>∏</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{p}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>X</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq5.gif"/></alternatives></inline-formula> is the observed count of taxa <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M14"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq6.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M16"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq7.gif"/></alternatives></inline-formula> is the number of taxa in the OTU table. Aitchison introduced the CLR as a useful transformation of compositional data to a Euclidean space [<xref ref-type="bibr" rid="CR15">15</xref>]. We add <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{sequencing\;depth}$$\end{document}</tex-math><mml:math id="M18"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq8.gif"/></alternatives></inline-formula> to each taxa’s count before the CLR transformation in order to avoid issues with <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{log}(0)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq9.gif"/></alternatives></inline-formula>. Once data are wrangled into this framework the high dimensional nature of the data becomes manageable.</p>
    </sec>
    <sec id="Sec8">
      <title>Object Flexibility</title>
      <p id="Par18">The <italic>tidyMicro</italic> data format complies to the three primary principles of tidy data [<xref ref-type="bibr" rid="CR16">16</xref>]: 1. each variable forms a column, 2. each observation forms a row, and 3. each type of observational unit forms a table. This malleable data structure allows users to easily work with familiar packages and functions outside of this pipeline. For example, creating a subset of a <italic>tidyMicro</italic> set is easily accomplished using standard operations within R such as <italic>subset</italic> or <italic>filter</italic>. New functions necessary for unique analyses can easily be applied within the OTU table or taxa blocks through <italic>apply</italic> functions or the <italic>tidyverse</italic>’s <italic>d_ply</italic> family. Similarly, all visualizations are created using <italic>ggplot2,</italic> meaning they can be easily customized through additional “geoms”. This ability to integrate base and external functions is unique among microbiome analysis pipelines. This flexibility will be key in fostering innovation from future users and encouraging the collaborative nature of open source software.</p>
    </sec>
    <sec id="Sec9">
      <title>Exploratory data analyses</title>
      <p id="Par19">Preliminary data exploration is straightforward with a <italic>tidyMicro</italic> set. We provide several wrapper functions for basic summary statistics of taxa abundance. Tabular outputs are complemented by graphical representations of abundance data, which can be much easier to interpret. We provide several standard data visualization tools including ordination plots (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b), stacked bar charts (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), and heatmaps (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), as well as two novel visualization methods. The Rocky Mountain plot (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) is a variant of the Manhattan plot that displays both the direction and magnitude of correlations between a variable of interest and each taxon within an OTU table, resembling the peaks and valleys seen along the front range of the Rocky Mountains. All taxa are colored by phylum, and correlations that exceed a desired magnitude will be automatically labeled using <italic>ggrepel </italic>[<xref ref-type="bibr" rid="CR17">17</xref>]. Neither the CLR transformed counts nor the taxa abundances are normally distributed, so a rank-based correlation (e.g. Spearman, Kendall) is recommended and provided in the package. Three Mode principal component and principle coordinate analyses are tools used to account for the correlation structures of repeated measures within the ordination framework [<xref ref-type="bibr" rid="CR18">18</xref>]. They collapse over the time component of variation and perform principle component / coordinate analyses on the remaining two dimensions (subject and taxa). For the motivating example, we display plots (using the 15 infants with all 3 sequencing time points) made using principle components (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) and principle coordinates (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).<fig id="Fig3"><label>Fig. 3</label><caption><p>Example exploratory visualizations. <bold>a</bold> Principle component plot calculated from centered log ratio transformed genus level taxa counts, colored by MSRA infection. <bold>b</bold> Principle coordinate plot calculated from genus level Bray–Curtis beta diversity with normal ellipses, colored by MSRA infection. <bold>c</bold> Stacked bar charts of average genus level taxa abundances by MSRA infection. <bold>d</bold> Heatmap of Spearman correlations between centered log ratio transformed genus level taxa counts and subjects’ age</p></caption><graphic xlink:href="12859_2021_3967_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Rocky mountain plot. Spearman correlations between centered log ratio transformed genus level taxa counts and subjects’ age. Correlations are colored by phylum and taxa with correlations above 0.3 in magnitude are labeled</p></caption><graphic xlink:href="12859_2021_3967_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Three mode principle component (<bold>a</bold>) and three mode principle coordinate (<bold>b</bold>) plots. Plots created from sequences on the 7th, 14th, and 21st day of life of 15 infants collapsing over time component. Colors represent the three different time points. Principle coordinate plot created from Bray–Curtis beta diversity</p></caption><graphic xlink:href="12859_2021_3967_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Taxa filtering</title>
      <p id="Par20">This package provides taxa “filters”. Counts from taxa below a specified prevalence and/or abundance cutoff will be aggregated into an “Other” taxa category. There is also an option to specify taxa that you are not interested in analyzing to be aggregated into this “Other” taxa. This is analogous to the “pruning” function in <italic>phyloseq</italic>. Filtering can be applied within the initial <italic>tidy_micro</italic> step or externally at a later stage. Below is an example where counts from taxa present in fewer than 5% of sequence libraries and taxa with less than 0.01% abundance in all sequencing libraries are aggregated together.<disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$otu\_filter\left( {micro\_set, \, prev\_cutoff = 5, \, ra\_cutoff = 0.1} \right).$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>_</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>_</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>_</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3967_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec11">
      <title>Diversity calculations and analyses</title>
      <p id="Par21">Community-level analyses are an important step for understanding microbial community diversity. The community-level measures summarize key features within individual communities (alpha-diversity) and between individual communities (beta-diversity). As is standard among microbiome pipelines, <italic>tidyMicro</italic> provides optimized algorithms for calculating the following alpha diversity indices from bootstrapped rarefied sequence datasets: <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{obs}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq10.gif"/></alternatives></inline-formula>, Chao1, Shannon’s and Simpson’s diversity indices, and Shannon’s and Simpson’s evenness indices. Also included is Good’s coverage estimator, with options to filter out sequencing libraries with low coverage and/or low sequencing depth. <italic>tidyMicro</italic> gives the option to calculate alpha diversity indices for every OTU table or only one specified table. If the study contains an OTU table from multiple environments, each table’s diversity might be useful. Since diversities measure how many different taxa are present and how evenly they are distributed, aggregating counts together into few groups could bias these estimates. For this reason, we recommend only calculating diversity measures on the lowest taxonomic rank if the study has OTU tables of different taxonomic ranks from the same site. Calculating alpha diversities for the family level OTU table is demonstrated below:<disp-formula id="Equc"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$alpha\_div\left( {micro\_set, \, table = Genus, \, iter = 100, \, min\_depth = 10,000, \, min\_goods = 90} \right).$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>_</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>_</mml:mi><mml:mi>g</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3967_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par22">For beta diversity analyses we incorporate the <italic>vegan </italic>[<xref ref-type="bibr" rid="CR19">19</xref>] package, which provides a large array of methods to generate dissimilarity tables. <italic>vegan</italic> also provides a function to test for differences in beta diversities in a pseudo-regression framework using PERMANOVA.</p>
    </sec>
    <sec id="Sec12">
      <title>Analyses of Individual Taxa</title>
      <p id="Par23">In parallel with community analyses (i.e., alpha- and beta-diversity), identification of individual taxa that differ between groups of subjects often is of interest to investigators. Taxon abundance can be difficult to model due to strong right skews (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a), “U” or “J” shapes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), and sparsity (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). <italic>tidyMicro</italic> provides multiple modeling options and automated model summaries enabling greater user control over their analyses of taxon abundances. This level of flexibility and focus on taxa level models is a novel feature of <italic>tidyMicro</italic>.<fig id="Fig6"><label>Fig. 6</label><caption><p>Examples of common taxa abundance distributions. Strong right skews (<bold>a</bold>), “U” shaped distributions (<bold>b</bold>), and sparsity (<bold>c</bold>) are all common patterns</p></caption><graphic xlink:href="12859_2021_3967_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par24">Negative binomial and beta binomial regression are the current gold standards for modeling taxon abundance. Each method has advantages and disadvantages. Negative binomial models are often adequate and easier to fit, but they are unable to capture any “U” shapes that may arise in taxa abundances. Beta binomial models offer more flexibility but require more computational time. The negative binomial model coefficients also represent estimated rate ratios, which are a more straightforward representation of associations than the odds ratios provided by beta binomial models. <italic>tidyMicro</italic> has built in functions to fit negative binomial models using the <italic>MASS</italic> package [<xref ref-type="bibr" rid="CR20">20</xref>] or beta binomial models using the <italic>VGAM</italic> package [<xref ref-type="bibr" rid="CR21">21</xref>] to every taxa within a specified OTU table. Negative binomial models include sequencing depths as an <italic>offset</italic> term by default to deal with the compositionality of these data, and the beta binomial models handle this by directly modeling the taxa RA. We provide several useful summaries of the models and taxa abundances. An example of fitting negative binomial models to all genus-level taxa with MRSA infection and smoking status as covariates with sequencing depth as an offset term is demonstrated below:<disp-formula id="Equd"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$nb\_mods\left( {micro\_set, \, table = genus, \, MRSA\_Positive,Smoking,Offset = TRUE} \right).$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>U</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3967_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par25">These more complicated parametric models may have convergence issues when applied to microbiome studies and simpler methods may need to be considered. Consequently, <italic>tidyMicro</italic> includes functions to perform rank-sum tests on taxa abundance or Chi-squared tests on taxa presence to address this potential issue. These functions give the user the option to run the test on all taxa or just the taxa for which the regression models failed to converge.</p>
    </sec>
    <sec id="Sec13">
      <title>Model Summaries and Visualizations</title>
      <p id="Par26">Output from (potentially) hundreds of negative binomial or beta binomial models can be difficult to interpret. For this reason, <italic>tidyMicro</italic> includes model summaries and several model-visualization tools. The modeling functions produce summary tables from each taxa’s model (Additional file <xref rid="MOESM1" ref-type="media">1</xref> ) and estimate tables that contain rate ratios (or odds ratios), Wald confidence intervals, and false discovery rate (FDR) adjusted p-values (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). When interaction terms are present, the appropriate main effect estimates and covariances are summed together before being exponentiated into rate ratios (or odds ratios) and confidence intervals in the estimate table.</p>
      <p id="Par27"><italic>tidyMicro</italic> includes heatmaps and forest plots of <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M30"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq11.gif"/></alternatives></inline-formula> parameter estimates to help visualize consistent trends. The package also introduces novel regression-based rocky mountain plots and novel parametric stacked bar charts. The regression-based rocky mountain plots are similar to the association based rocky mountain plots used for exploratory data analysis (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). FDR p-values of a specified covariate are log transformed and the magnitude is plotted along the y-axis. For positive <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M32"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq12.gif"/></alternatives></inline-formula> estimates, the log(FDR p-value) is multiplied by -1 so the direction along the y-axis corresponds to the direction of the estimated relationship (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). Parametric stacked bar charts back-transform estimated <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M34"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq13.gif"/></alternatives></inline-formula> parameters to estimated taxa abundance. Back-transformed estimates allow the user to plot estimated continuous trends in composition and estimated composition controlling for confounders. Both main effects (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a) and interactions (Fig. <xref rid="Fig8" ref-type="fig">8</xref>b) can be plotted with the parametric stacked bar charts. An example of plotting the relationship between age and MRSA infection is demonstrated below:<disp-formula id="Eque"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$nb\_bars(nb\_model,bpd*MRSA\_Positive,top\_taxa = 5).$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi><mml:mi>_</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>b</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>_</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3967_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig7"><label>Fig. 7</label><caption><p>Rocky mountain plot made from negative binomial models. Relationships between MRSA infection and genus level taxa abundance after controlling for smoking status were estimated using negative binomial models using log(sequencing depth) as an offset. All models were fit using the <italic>glm.nb</italic> function in the MASS package. False discovery rate (FDR) adjusted p-values of estimated <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M38"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq14.gif"/></alternatives></inline-formula> coefficients are log transformed, and the magnitude is plotted along the y-axis. For positive <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M40"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq15.gif"/></alternatives></inline-formula> estimates, the log( FDR p-value) is multiplied by -1, so the direction along the y-axis corresponds to the direction of the estimated relationship</p></caption><graphic xlink:href="12859_2021_3967_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Parametric stacked bar charts. Parametric stacked bar charts back transform <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M42"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3967_Article_IEq16.gif"/></alternatives></inline-formula> parameter estimates to get estimated taxa abundance. (<bold>a</bold>) Parametric stacked bar charts from estimated relationships between MRSA infection and genus level taxa abundances after controlling for smoking status. (<bold>b</bold>) Parametric stacked bar charts from estimated relationships between genus level taxa abundance and subject age by MRSA infection. All models from both (<bold>a</bold>) and (<bold>b</bold>) used log(sequencing depth) as an offset</p></caption><graphic xlink:href="12859_2021_3967_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par28">The <italic>top_taxa</italic> argument is used to aggregate the estimated abundances of all but the 5 most abundant into an “Other” category. One can also specify an abundance cutoff for taxa to be excluded from the “Other” category. This functionality exists in all stacked bar chart functions within <italic>tidyMicro</italic>.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par29">As microbiome data and analyses become more common, user accessibility to reliable and extensible analysis pipelines has become increasingly important. Boosting user control through easily understandable and manipulatable data objects is a key step in expanding analysts’ toolkits. The <italic>tidyMicro</italic> pipeline helps meet this need by introducing the principles of tidy data and fully leveraging the <italic>tidyverse</italic> into microbiome analyses. We also extend functionality available in other popular microbiome pipelines with novel exploratory visualization methods (e.g., Rocky Mountain plots, Three Mode PCA and PCoA), a strong focus on modeling of individual taxa abundances with multiple modeling options, and automated summary and estimate tables.</p>
    <p id="Par30">This new tidy data structure paradigm also allows for the extension of <italic>tidyMicro</italic> to other omics data sets. Functions have the generalizability to support count data from any omics data in principle. For example, studies containing multiple omics (genomic, proteomic, metagenomic, marker gene profiles) could combine tables using the <italic>tidy_micro</italic> function as if they were multiple OTU tables and implement Three Mode PCA/PCoA as a data integration technique. Furthermore, as the analysis of microbiome data evolves, other extensions such as alternative modeling (e.g., zero inflated models from DESeq2[<xref ref-type="bibr" rid="CR22">22</xref>]) and other sequence data formats can be easily included given the flexibility provided in <italic>tidyMicro</italic>.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par31"><italic>tidyMicro</italic> provides a reliable complement to popular microbiome analysis R packages. We provide standard tools as well as novel extensions on standard analyses to improve interpretability and the analyst’s ability to communicate results while preserving the tidy data format to encourage open source collaboration. This new tidy data structure increases user control over analyses and novel visualizations improve collaborative efforts. External and custom functions can be easily integrated into any workflow. All visualizations are created through the <italic>ggplot2</italic> package in the <italic>tidyverse</italic>[<xref ref-type="bibr" rid="CR9">9</xref>] providing publication-quality graphics that can be further customized by the use of “geoms.” A full package vignette exploring all functions and function options is available through the package and GitHub. The simple examples and full workflow from the package are reproducible and can serve as a tutorial to analysts new to microbiome data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>MRSA study cohort demographic information </p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>S. aureus</italic> negative (n=26)</th><th align="left"><italic>S. aureus</italic> positive (n = 26)</th><th align="left">Total</th></tr></thead><tbody><tr><td align="left">Age</td><td align="left">71.81 (± 11.24)</td><td align="left">71.67 (± 11.38)</td><td align="left">71.74 (± 11.20)</td></tr><tr><td align="left"> Antibiotics</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  No</td><td align="left">11 (42.31%)</td><td align="left">11 (42.31%)</td><td align="left">21 (40.38%)</td></tr><tr><td align="left">  Yes</td><td align="left">15 (57.69%)</td><td align="left">15 (57.69%)</td><td align="left">31 (59.62%)</td></tr><tr><td align="left"> Diabetes</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  No</td><td align="left">13 (50.00%)</td><td align="left">13 (50.00%)</td><td align="left">26 (50.00%)</td></tr><tr><td align="left">  Yes</td><td align="left">13 (50.00%)</td><td align="left">13 (50.00%)</td><td align="left">26 (50.00%)</td></tr><tr><td align="left"> Nasal steroids</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  No</td><td align="left">23 (88.46%)</td><td align="left">23 (88.46%)</td><td align="left">46 (88.46%)</td></tr><tr><td align="left">  Yes</td><td align="left">3 (11.54%)</td><td align="left">3 (11.54%)</td><td align="left">6 (11.54%)</td></tr><tr><td align="left"> Nursing home</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  No</td><td align="left">21 (80.77%)</td><td align="left">21 (80.77%)</td><td align="left">42 (80.77%)</td></tr><tr><td align="left">  Yes</td><td align="left">5 (19.23%)</td><td align="left">5 (19.23%)</td><td align="left">10 (19.23%)</td></tr><tr><td align="left"> Smoking</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  Never</td><td align="left">7 (26.92%)</td><td align="left">9 (34.62%)</td><td align="left">16 (30.77%)</td></tr><tr><td align="left">  Former</td><td align="left">9 (34.62%)</td><td align="left">13 (50.00%)</td><td align="left">22 (42.31%)</td></tr><tr><td align="left">  Current</td><td align="left">10 (38.46%)</td><td align="left">4 (15.38%)</td><td align="left">14 (26.92%)</td></tr></tbody></table><table-wrap-foot><p>Continuous variables summarized using means (sd) and discrete variables are summarized using counts (%).</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>BPD infant cohort demographic information </p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Mild (n = 4)</th><th align="left">Moderate (n = 11)</th><th align="left">Severe (n = 9)</th><th align="left">Total (n = 24)</th></tr></thead><tbody><tr><td align="left">Birth Weight (Kg)</td><td align="left">0.81 (± 0.07)</td><td align="left">0.74 (± 0.16)</td><td align="left">0.82 (± 0.18)</td><td align="left">0.78 (± 0.15)</td></tr><tr><td align="left"> Sex</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  Female</td><td align="left">3 (75.00%)</td><td align="left">7 (63.64%)</td><td align="left">4 (44.44%)</td><td align="left">14 (58.33%)</td></tr><tr><td align="left">  Male</td><td align="left">1 (25.00%)</td><td align="left">4 (36.36%)</td><td align="left">5 (55.56%)</td><td align="left">10 (41.67%)</td></tr><tr><td align="left">Gestational age (Wks)</td><td align="left">25.25 (± 1.50)</td><td align="left">25.27 (± 1.10)</td><td align="left">25.67 (± 1.22)</td><td align="left">25.42 (±1.18)</td></tr><tr><td align="left"> Maternal ethnicity</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">  Hispanic</td><td align="left">2 (50.00%)</td><td align="left">5 (45.45%)</td><td align="left">2 (22.22%)</td><td align="left">9 (37.50%)</td></tr><tr><td align="left">  Non-hispanic white</td><td align="left">2 (50.00%)</td><td align="left">6 (54.55%)</td><td align="left">7 (77.78%)</td><td align="left">15 (62.50%)</td></tr></tbody></table><table-wrap-foot><p>Continuous variables summarized using means (sd) and discrete variables are summarized using counts (%).</p></table-wrap-foot></table-wrap></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_3967_MOESM1_ESM.csv">
            <caption>
              <p><bold>Additional file 1.</bold> Convergent model summary. Column 1: Taxa names. Column 2: Model coefficients. Column 3: β parameter estimates. Column 4: 95% profile likelihood confidence intervals for β estimates. Column 5: Z-statistics. Column 6: P-values from Wald tests on individual beta coefficients. Column 7: False discovery rate adjusted p-values. Column 8: P-values from likelihood ratio test for entire covariate (like an F-test).. </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_3967_MOESM2_ESM.csv">
            <caption>
              <p><bold>Additional file 2.</bold> Model estimates table. Column 1: Taxa names. Column 2: Model coefficients. Column 3: Estimated rate ratios from exponentiated β estimates. For models with interaction terms, the appropriate β estimates are summed before being exponentiated. Column 4: Exponentiated 95% Wald confidence intervals. For models with interaction terms, the appropriate β estimates and covariance terms are summed for the Wald intervals. Column 5: Z-statistics from β estimates. Column 6: False discovery rate adjusted p-value</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>OTU</term>
        <def>
          <p id="Par4">Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>MRSA</term>
        <def>
          <p id="Par5">Methicillin-resistant Staphylococcus aureus</p>
        </def>
      </def-item>
      <def-item>
        <term>BPD</term>
        <def>
          <p id="Par6">Bronchopulmonary dysplasia</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-021-03967-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>None</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author's contributions</title>
    <p>CMC performed the bulk of the coding efforts and writing of the manuscript. DNF provided early code for key functions. KW derived and provided early code for the three mode PCA/PCoA methods. DNF, BDW, KK, JA, and MK provided crucial guidance and ideas throughout the project. All authors approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded primarily by the R56 DK114711, R01 DK101659, and BERD UL1 TR001082 Grants. DNF is supported, in part, by the University of Colorado GI and Liver Innate Immunity Program.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analyzed during the current study are available in the [data] repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/CharlieCarpenter/tidyMicro">https://github.com/CharlieCarpenter/tidyMicro</ext-link>. The package and data are also available through the CRAN repository <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/tidyMicro/index.html">https://cran.r-project.org/web/packages/tidyMicro/index.html</ext-link></p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par32">Not Applicable</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par33">Not Applicable</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par34">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Zemanick</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Heltshe</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Changes in airway microbiome and inflammation with ivacaftor treatment in patients with cystic fibrosis and the G551D mutation</article-title>
        <source>Ann Am ThoracSoc</source>
        <year>2019</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>212</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1513/AnnalsATS.201907-493OC</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stanislawski</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Dabelea</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Gut microbiota phenotypes of obesity</article-title>
        <source>NPJ Biofilms Microbiomes</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1038/s41522-019-0091-8</pub-id>
        <pub-id pub-id-type="pmid">31285833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Manigart</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Leroy</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Meda</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Valéa</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Altered vaginal microbiota are associated with perinatal mother-to-child transmission of HIV in African women from Burkina Faso</article-title>
        <source>J Acquir Immune DeficSyndr</source>
        <year>2012</year>
        <volume>60</volume>
        <issue>3</issue>
        <fpage>299</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="doi">10.1097/QAI.0b013e31824e4bdb</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelly</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Colgan</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>Of microbes and meals: the health consequences of dietary endotoxemia</article-title>
        <source>NutrClinPract</source>
        <year>2012</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>215</fpage>
        <lpage>225</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sartor</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Investigating the biological and clinical significance of human dysbioses</article-title>
        <source>Trends Microbiol</source>
        <year>2011</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>427</fpage>
        <lpage>434</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tim.2011.06.005</pub-id>
        <pub-id pub-id-type="pmid">21775143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">phyloseq: Analyze microbiome census data using R [Internet]. [cited 2020 Jan 12]. Available from: <ext-link ext-link-type="uri" xlink:href="https://joey711.github.io/phyloseq/">https://joey711.github.io/phyloseq/</ext-link></mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Lahti L, Shetty S. Tools for microbiome analysis in R. Version 1.9.19 [Internet]. [cited 2020 Feb 17]. Available from: <ext-link ext-link-type="uri" xlink:href="https://microbiome.github.io/tutorials/">https://microbiome.github.io/tutorials/</ext-link></mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Averick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>McGowan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Welcome to the Tidyverse</article-title>
        <source>J Open Source Softw</source>
        <year>2019</year>
        <volume>4</volume>
        <issue>43</issue>
        <fpage>1686</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Sontag</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Morrow</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>CE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Airway microbial community turnover differs by bpd severity in ventilated preterm infants</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>e0170120</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0170120</pub-id>
        <pub-id pub-id-type="pmid">28129336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bessesen</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Kotter</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Kingery</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benoit</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MRSA colonization and the nasal microbiome in adults at high risk of colonization and infection</article-title>
        <source>J Infect</source>
        <year>2015</year>
        <volume>71</volume>
        <issue>6</issue>
        <fpage>649</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jinf.2015.08.008</pub-id>
        <pub-id pub-id-type="pmid">26335708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">E. Bolyen, J.R. Rideout, M.R. Dillon, et. al. Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2. Nature Biotechnology [Internet]. 2019 Aug 9;37. Available from: <ext-link ext-link-type="uri" xlink:href="https://qiime2.org/">https://qiime2.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Granger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Browne</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tatem</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Explicet: graphical user interface software for metadata-driven management, analysis and visualization of microbiome data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>23</issue>
        <fpage>3100</fpage>
        <lpage>3101</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt526</pub-id>
        <pub-id pub-id-type="pmid">24021386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: Open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <issue>23</issue>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Aitchison J. The Statistical Analysis of Compositional Data. (2):40.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Tidy data [Internet]. [cited 2020 Mar 11]. Available from: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html</ext-link></mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Slowikowski K, Schep A, Hughes S, Lukauskas S, Irisson J-O, Kamvar ZN, et al. ggrepel: Automatically Position Non-Overlapping Text Labels with “ggplot2” [Internet]. 2019 [cited 2020 Jan 16]. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</ext-link></mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tucker</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Some mathematical notes on three-mode factor analysis</article-title>
        <source>Psychometrika</source>
        <year>1966</year>
        <volume>31</volume>
        <issue>3</issue>
        <fpage>279</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02289464</pub-id>
        <pub-id pub-id-type="pmid">5221127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Oksanen J, Blanchet FG, Friendly M, Kindt R, Legendre P, McGlinn D, et al. vegan: Community Ecology Package [Internet]. 2019 [cited 2019 Sep 29]. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</ext-link></mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Ripley B, Venables B, Bates DM, ca 1998) KH (partial port, ca 1998) AG (partial port, Firth D. MASS: Support Functions and Datasets for Venables and Ripley’s MASS [Internet]. 2019 [cited 2020 Jan 12]. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=MASS">https://CRAN.R-project.org/package=MASS</ext-link></mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Yee T, routines) CM (author of several L. VGAM: Vector Generalized Linear and Additive Models [Internet]. 2019 [cited 2020 Jan 12]. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=VGAM">https://CRAN.R-project.org/package=VGAM</ext-link></mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
