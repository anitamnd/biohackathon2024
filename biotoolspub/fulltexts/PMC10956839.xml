<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10956839</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0298834</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-23-29038</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Nucleotide Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Nucleotide Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mottle: Accurate pairwise substitution distance at high divergence through the exploitation of short-read mappers and gradient descent</article-title>
      <alt-title alt-title-type="running-head">Mottle: Calculating pairwise substitution distances</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Prusokiene</surname>
          <given-names>Alisa</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boonham</surname>
          <given-names>Neil</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fox</surname>
          <given-names>Adrian</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5546-4043</contrib-id>
        <name>
          <surname>Howard</surname>
          <given-names>Thomas P.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Faculty of Science, Agriculture and Engineering, School of Natural and Environmental Sciences, Newcastle University, United Kingdom</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Fera Ltd., Biotech Campus, York, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mapder</surname>
          <given-names>Tarunendu</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Bristol-Myers Squibb Company, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Thomas.Howard@newcastle.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>19</volume>
    <issue>3</issue>
    <elocation-id>e0298834</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Prusokiene et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Prusokiene et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0298834.pdf"/>
    <abstract>
      <p>Current tools for estimating the substitution distance between two related sequences struggle to remain accurate at a high divergence. Difficulties at distant homologies, such as false seeding and over-alignment, create a high barrier for the development of a stable estimator. This is especially true for viral genomes, which carry a high rate of mutation, small size, and sparse taxonomy. Developing an accurate substitution distance measure would help to elucidate the relationship between highly divergent sequences, interrogate their evolutionary history, and better facilitate the discovery of new viral genomes. To tackle these problems, we propose an approach that uses short-read mappers to create whole-genome maps, and gradient descent to isolate the homologous fraction and calculate the final distance value. We implement this approach as <italic toggle="yes">Mottle</italic>. With the use of simulated and biological sequences, <italic toggle="yes">Mottle</italic> was able to remain stable to 0.66–0.96 substitutions per base pair and identify viral outgroup genomes with 95% accuracy at the family-order level. Our results indicate that <italic toggle="yes">Mottle</italic> performs as well as existing programs in identifying taxonomic relationships, with more accurate numerical estimation of genomic distance over greater divergences. By contrast, one limitation is a reduced numerical accuracy at low divergences, and on genomes where insertions and deletions are uncommon, when compared to alternative approaches. We propose that <italic toggle="yes">Mottle</italic> may therefore be of particular interest in the study of viruses, viral relationships, and notably for viral discovery platforms, helping in benchmarking of homology search tools and defining the limits of taxonomic classification methods. The code for Mottle is available at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme</institution>
        </funding-source>
        <award-id>2144113</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Fera Science Ltd.</institution>
        </funding-source>
        <award-id>CASE Partner</award-id>
      </award-group>
      <funding-statement>This work has been supported by the BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme (reference 2144113), with Fera Science Ltd. as the CASE partner. There was no additional external funding received for this study.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Pairwise nucleotide substitution distance is widely used in bioinformatic analyses. Pairwise comparisons within collections of genomes are commonly integrated to establish phylogenies, providing insight into their shared evolutionary history. They are similarly used to position novel genomes within an established phylogeny [<xref rid="pone.0298834.ref001" ref-type="bibr">1</xref>]. Substitution distances can also be converted to genome-wide percentage identity to define taxonomic demarcations, such as the distance a novel genome must be from known genomes to establish it as a new species [<xref rid="pone.0298834.ref002" ref-type="bibr">2</xref>]. Comparing the distances of discrete genetic molecules such as chromosomes, plasmids, plastids, and segments can find differences in their evolutionary histories, elucidating how genetic material has been exchanged between organisms or populations. Finding the most distinct or representative sequences in a set is used to create a compressed database for homology search and taxonomic classification [<xref rid="pone.0298834.ref003" ref-type="bibr">3</xref>]. A high substitution distance can however be a large barrier for sequence discovery [<xref rid="pone.0298834.ref004" ref-type="bibr">4</xref>]. Being able to accurately define this distance allows improved benchmarking of homology search and taxonomic classification tools to find their limits, allowing accurate estimates of what may pass through the silicon sieve of <italic toggle="yes">de novo</italic> sequencing-based discovery and diagnostics.</p>
    <p>Despite the considerable number of approaches available for pairwise genome comparison [<xref rid="pone.0298834.ref005" ref-type="bibr">5</xref>], many do not produce a biologically relevant substitution distance, and from those that do, there are few that are suitable for highly divergent sequences, i.e., those that have had many substitutions per site between them. This is for two main reasons–work has focused on creating faster and more efficient tools that work well at low divergences [<xref rid="pone.0298834.ref006" ref-type="bibr">6</xref>–<xref rid="pone.0298834.ref011" ref-type="bibr">11</xref>], combined with the inherent difficulties found when making comparisons at high divergences. The largest of these difficulties are false seeding and over-alignment. Seeding is the process of finding small sub-sequences, often in the tens of bases, that are identical or near identical in two sequences and can be extended to larger regions of homology. Finding seeds at non-homologous locations, i.e., false seeding, may add regions that otherwise have little similarity into the distance calculation, artificially inflating it. At low divergences a large seed size may be used as there would be few mutations between homologous regions. At increasing divergence, a smaller seed size is needed to find such regions, generating many seeding locations that are spurious, eventually overwhelming the limited number of truly homologous seed sites. Finding seed locations that have true homology while avoiding or removing false ones becomes a critical task at distant homologies. While false seeding can make sequences appear more divergent than they truly are, over-alignment can make them appear more similar. Alignment is usually done after seeding, inserting gaps into either sequence to match up homologous nucleotides that were shifted due to insertions and deletions (indels). This presents the danger of over-correcting for indels, falsely pairing matching nucleotides that are non-homologous, such as mistaking adjacent substitution events for an insertion, and therefore not contributing to the substitution distance. Avoiding over-alignment while still correctly aligning regions can be difficult at a low divergence, but at a high divergence, where multiple different mutation events may have occurred at the same nucleotide position, it may not be possible.</p>
    <p>These difficulties appear especially often when studying viral genomes, due to their high rate of mutation, small size, lack of universal marker genes, and the low proportion of known viruses [<xref rid="pone.0298834.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0298834.ref013" ref-type="bibr">13</xref>]. Viral replication machinery, especially those of single-stranded RNA based viruses, are known to introduce many substitutions every generation. Combined with a short generation time, these viruses can quickly diverge from their progenitor genome. Additionally, the ratio of indel event to substitution events is extremely high in these genomes [<xref rid="pone.0298834.ref014" ref-type="bibr">14</xref>], which makes finding true seeds more difficult and over-alignment more likely. The usually small size of viral genomes further reduces the number of possible seeding sites. Finally, the number of viral species that have been documented is a small proportion of the total estimated number of viral species [<xref rid="pone.0298834.ref015" ref-type="bibr">15</xref>], with estimates of the proportion of characterised orthornaviran RNA viruses being estimated as low as 0.006% [<xref rid="pone.0298834.ref016" ref-type="bibr">16</xref>], and environmental sampling projects discovering many previously unobserved viral genomes with each sequencing experiment [<xref rid="pone.0298834.ref017" ref-type="bibr">17</xref>]. The effect of sparse taxonomic coverage is that many viral genomes are highly diverged from any known viruses, making it difficult to study their relationship to other viruses. To this end, viral genome analysis is the field that may benefit the most from improvements in pairwise sequence distance accuracy at high divergences.</p>
    <p>In the face of these difficulties, current tools attempt to alleviate parts of the false seeding or over-alignment problems: some programs attempt to find non-exact matches for seeding, finding longer seeds which are more likely to be true seeds [<xref rid="pone.0298834.ref018" ref-type="bibr">18</xref>]. Others, such as Hachiya et al. [<xref rid="pone.0298834.ref019" ref-type="bibr">19</xref>], have sophisticated algorithms for distinguishing between true and false seeds. Programs that do not use any alignment step, known as alignment-free programs, are able to completely avoid the problem of over-alignment, instead using statistical information from across a sequence that is correlated to substitution distance–e.g., proportion of shared k-mers [<xref rid="pone.0298834.ref020" ref-type="bibr">20</xref>], shortest unique substrings [<xref rid="pone.0298834.ref021" ref-type="bibr">21</xref>], average common substring [<xref rid="pone.0298834.ref022" ref-type="bibr">22</xref>], or sequence embeddings [<xref rid="pone.0298834.ref023" ref-type="bibr">23</xref>]. This creates a separate issue–as sequence divergences increase, the correlation between these global statistical data and the local nucleotide substitutions they estimate can become increasingly decoupled. A new approach is needed, one which creates high-quality seeds and avoids over-alignment while incorporating direct nucleotide-level information.</p>
    <p>Short-read mappers (henceforth referred to as mappers) are tools used to map short sequence fragments of ~50-300bp, produced from High Throughput Sequencing runs, to reference genomes. These mappers already employ sophisticated seeding algorithms, give many parameters to tune mapping sensitivity, can use arbitrary queries and references, and are designed to handle thousands to millions of fragments. Sequence fragments created <italic toggle="yes">in silico</italic> can therefore be used as inputs to these mappers, finding the optimal homologous location for each fragment on another sequence, and allowing downstream processing to calculate substitution distance. This approach of running mappers on <italic toggle="yes">in silico</italic> fragments has been successfully utilised in other bioinformatic applications–for generating multiple sequence alignments in <italic toggle="yes">ViralMSA</italic> [<xref rid="pone.0298834.ref024" ref-type="bibr">24</xref>], and for constructing phylogenies in <italic toggle="yes">REALPHY</italic> [<xref rid="pone.0298834.ref025" ref-type="bibr">25</xref>]. In this paper we explore the application of these mappers for estimating pairwise nucleotide substitution distance, how careful use of their outputs can avoid false seeding and over-alignment and describe the implementation of <italic toggle="yes">Mottle</italic>—a tool for more accurate distance calculation between two highly divergent sequences. The tests carried out within this paper are based on consensus sequences of full viral genomes or RNA family sequences, but Mottle can be applied to any pair of DNA or RNA sequence files to give an estimated substitution distance.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <p><italic toggle="yes">Mottle</italic> takes two arbitrary nucleotide sequences of unknown relation, and outputs an estimated substitution distance between them. This can make use of any mapping software that aligns short fragments to larger sequences. Additionally, we have implemented a bespoke fragment mapping algorithm for this process, <italic toggle="yes">Mottle-map</italic>, which guarantees that each fragment is mapped but is not scalable to large sequences. Both algorithms are described in the subsections below.</p>
    <sec id="sec003">
      <title>Mottle: Calculating pairwise sequence distance from mapped fragments</title>
      <p>The main <italic toggle="yes">Mottle</italic> program can be split into three stages–fragment generation, alignment processing, and alignment clustering, presented in <xref rid="pone.0298834.g001" ref-type="fig">Fig 1A</xref> to c respectively and described in the following sections. Briefly, for each position, <italic toggle="yes">p</italic>, in query genome, Q, we set the nucleotide at that position, Q<sub><italic toggle="yes">p</italic></sub>, as the origin nucleotide. The set of flanking regions either side, Q<sub>[<italic toggle="yes">p+</italic>1..<italic toggle="yes">p</italic>+n]</sub> and Q<sub>[<italic toggle="yes">p-1</italic>..<italic toggle="yes">p</italic>-n</sub>] for a specified flank size <italic toggle="yes">n</italic>, of each origin nucleotide are mapped using a short-read mapper to a similar set of flanking regions in the target genome. For each mapping, we calculate flank alignments, and gather a set of statistics: the alignment identity, the indel rate of the alignment, and a binary value representing whether the corresponding origin nucleotides match or mismatch. We represent mappings as points defined by identity and indel statistics, labelled by match state, from which we can calculate a match probability that acts as an estimator for true identity without alignment bias. These points are clustered into two sets to separate homologous mappings from spurious ones, and genomic distance is estimated from the homologous set.</p>
      <fig position="float" id="pone.0298834.g001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">Mottle</italic>’s sequence distance estimation algorithm.</title>
          <p><bold>(a)</bold> Generating fragment alignments from input sequences. Each sequence is fragmented <italic toggle="yes">in silico</italic>. The origin nucleotide is excluded from each fragment sequence. Fragments are mapped onto the reciprocal sequence via a mapper, with each mapped fragment’s origin being paired. Origin pairs carry a binary state (match or mismatch). Fragment sequences are then fully aligned. <bold>(b) Truncating</bold> alignments on identity change. For each alignment, a sliding window calculates percentage identity. If a window’s identity diverges from the initial window’s, all nucleotides from that point onwards are discarded. <bold>(c)</bold> Fragment clustering and substitution distance estimation. For each alignment, identity and indel percentage statistics are calculated. These are fed into a Gradient Boosted Decision Tree (GBDT), which is trained to predict origin pair match state. This gives a predicted match probability on each alignment that can be interpreted as a bias-free identity. These three statistics are used for gradient-descent clustering, to find a cluster of alignments that were generated due to shared homology, and a cluster for those due to chance. Once both fractions are obtained, a mean origin identity is calculated for the homology cluster, which is used to derive the final substitution distance between the two sequences.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g001" position="float"/>
      </fig>
      <sec id="sec004">
        <title>(a) Fragment generation</title>
        <p><italic toggle="yes">Flank fragmentation</italic>. Each sequence can be separated into a discrete set of subsequences, each defined by a unique combination of origin nucleotide, subsequence size, and relative orientation. Each nucleotide in the full-length sequence can act as an origin—the first nucleotide of a subsequence—of multiple subsequences. But the possible sizes and relative orientations of these subsequences are restricted depending on the origin nucleotide’s location. If subsequence size is kept fixed, each nucleotide is an origin for up to two subsequences, for each of the forward and reverse complement orientations. The portion of each subsequence that does not contain the origin nucleotide is termed a fragment, and the two possible fragments for each origin are termed the forward and reverse flank fragments of the origin. Considering the origin nucleotide separately from the fragments is integral in estimating true identity in the later stages of the algorithm.</p>
        <p><italic toggle="yes">Reciprocal fragment mapping</italic>. This step takes the two full-length input sequences, their generated fragments, and a mapper program, to create a mapping between each fragment and a homologous area in the sequence of comparison. To allow the use of a variety of mapping algorithms, there are multiple modes of input depending on what the mapper accepts–sequence and fragments, fragments and fragments, or sequence and sequence. The mappings are done reciprocally–one sequence is used as the query with the other acting as the reference, and vice versa. The output of a mapper is a series of possibly homologous regions between the two inputs. This must either contain fragment names or sequence locations to allow identification of origin nucleotide, query location, and mapped location for each region. In cases where a mapper returns multiple regions for a query, all mapping is kept. The mapped region sequence pairs and corresponding origin nucleotides are extracted for use in later steps.</p>
        <p><italic toggle="yes">Mapped region alignment</italic>. While some mappers output a full alignment between mapped regions, many do not. To get consistent and well-defined alignments, Needleman-Wunsch global alignment is carried out between region sequences independent of mapper. This is because a representative region of homology adjacent to the origin nucleotide is desired, which Needleman-Wunsch global alignment maximises. Aligned regions that contain gaps in the first N bases are discarded, where N is a parameter of <italic toggle="yes">Mottle</italic>, as these gaps may shift the aligned region of homology and therefore the origin nucleotide.</p>
      </sec>
      <sec id="sec005">
        <title>(b) Alignment processing</title>
        <p><italic toggle="yes">Alignment truncation</italic>. Not all alignments will contain a consistent homology throughout. Some may begin with a high degree of similarity, but with a genomic rearrangement or large indel creating a discontinuity that suddenly reduces similarity. This non-homologous section would change alignment properties, adding noise to statistics calculations, and confounding downstream clustering. To remove these discontinuities, a sliding window is moved through the alignment. The length and identity, the proportion of aligned nucleotides that match, of the first window is used to estimate a binomial distribution for match/mismatch states. Where a later window’s identity is above or below that which would be expected by chance of this distribution, the alignment is clipped, discarding proceeding nucleotides. Clipped alignment shorter than a minimum size are additionally discarded. The window size, two-tailed binomial test p-value, and minimum clipped alignment size are configurable parameters.</p>
        <p><italic toggle="yes">Alignment statistics calculation</italic>. To distinguish homologous from non-homologous alignments, a set of statistics is calculated for each of the non-discarded windows produced during truncation. Alignment identity is the fraction of matches in non-gap positions, corrected for the GC composition of the alignment. The fraction of gap positions in the window could be used as another such statistic, where homologous alignments would contain fewer gaps at the same identity. This would, though, not inform us of the probability that the origin nucleotide is shifted by an Indel event, as each event can insert or delete multiple nucleotides in a row. The number of Indel events in a row between non-gap positions can be approximated by a geometric distribution with PMF,
<disp-formula id="pone.0298834.e001"><alternatives><graphic xlink:href="pone.0298834.e001.jpg" id="pone.0298834.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">l</italic> is the number of adjacent indel events between two non-gap positions regardless of the size of each event, <italic toggle="yes">P</italic>(<italic toggle="yes">L = l</italic>) is the probability of finding this number of events between two arbitrary sites in the sequence, and <italic toggle="yes">p</italic> is the fraction of indel events per site. <italic toggle="yes">p</italic> is directly related to the probability of no indel events having occurred between two adjacent homologous nucleotides via <italic toggle="yes">P</italic>(<italic toggle="yes">L</italic> = 0) = 1—<italic toggle="yes">p</italic>, which can be estimated from the fraction of adjacent aligned nucleotides that do not have gaps, <italic toggle="yes">q</italic>, in an observed sequence, (<italic toggle="yes">p</italic> = 1 –<italic toggle="yes">q</italic>). This produces a set of identities and indel fractions for each alignment—one for every fixed-size window within it. After this step, the alignments themselves are discarded, with only these statistics and the origin nucleotide match state being kept for the final steps.</p>
      </sec>
      <sec id="sec006">
        <title>(c) Alignment clustering</title>
        <p><italic toggle="yes">GBDT estimation of true identity</italic>. Identity and indel fraction can greatly vary between and within homologous alignments. For clustering to be effective, a more stable statistic needs to be calculated. For this purpose, we train a Gradient-Boosted Decision Tree (GBDT) to estimate a ’true identity’ for each window over the space defined by the previous statistics (<xref rid="pone.0298834.g001" ref-type="fig">Fig 1C</xref>, ’GBDT estimation’). This treats each window as a single point of data, with parameters identity and indel fraction, and with prediction value being origin nucleotide match state (1 = match, 0 = mismatch). The output of a GBDT can be thought of as a stepwise surface embedded within the input parameter space, which we enforce to be monotonically increasing with window identity and decreasing with indel fraction. This estimates the proportion of origin nucleotides that match within each area of parameter combinations, which we term the true identity estimate. As a wide area can have the same value estimated, similar alignments are likely to have windows that share similar true identities, making clustering more stable.</p>
        <p><italic toggle="yes">Gradient-descent clustering</italic>. The final step in <italic toggle="yes">Mottle</italic> is to isolate the homologous fraction of alignments through clustering. This approach involves the estimation of two cluster centres, one for homologous alignments (homologous cluster) and one for non-homologous alignments (null cluster), within the three-dimensional space defined by Alignment Identity, indel Fraction, and True Identity statistics. For every alignment, a set of windowed statistics had been generated from during alignment processing, meaning that each alignment contains a distribution of these statistics. Similar to how we approximated runs of indel events with a geometric distributions, we approximate these alignment statistics with a Binomial distribution. Clustering using these statistics directly would be difficult, as the expected variance of Binomially distributed values greatly decreases when the probability approaches zero or one. To rectify this, we utilise the following variance stabilising transformation,
<disp-formula id="pone.0298834.e002"><alternatives><graphic xlink:href="pone.0298834.e002.jpg" id="pone.0298834.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where p is equal to the value of the statistic, and l is equal to the expected lower bound of the statistic, i.e. 0.25 for GC-corrected nucleic acid sequences and 0 for indels. We then define a normalised distance to each cluster centre as,
<disp-formula id="pone.0298834.e003"><alternatives><graphic xlink:href="pone.0298834.e003.jpg" id="pone.0298834.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">mean</italic><sub><italic toggle="yes">I</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">I</italic></sub> equal to the mean and variance of the windowed set of stabilised alignment identities. Similarly, <italic toggle="yes">mean</italic><sub><italic toggle="yes">D</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">D</italic></sub> are generated from the set of indel fractions and <italic toggle="yes">mean</italic><sub><italic toggle="yes">T</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">T</italic></sub> from estimated true identities. The centre of the null cluster is initialised so that its True Identity is equal to the expected proportion of matches if it was due to chance, i.e., -1 after the stabilising transformation. To initialise the Alignment Identity and indel fraction, we choose the values of the alignment with the mean True Identity closest to this value. The centre of the Homologous cluster is initialised to the values of the alignment at the 90<sup>th</sup> percentile of mean True Identities. Once initialised, the cluster centres are shifted via gradient descent, with exception of the True identity of the null cluster which always remains at the expected null value, to reduce normalised distances between alignments and centres. The loss function for this process is as follows,
<disp-formula id="pone.0298834.e004"><alternatives><graphic xlink:href="pone.0298834.e004.jpg" id="pone.0298834.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where dist is equal to the distance between the alignment <italic toggle="yes">i</italic> and the cluster centre <italic toggle="yes">j</italic>, N is equal to the total number of alignments, and S is equal to the number of clusters, which is set to two corresponding to the null and homologous clusters. Additionally, weight is defined as follows.
<disp-formula id="pone.0298834.e005"><alternatives><graphic xlink:href="pone.0298834.e005.jpg" id="pone.0298834.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></disp-formula>
where binpow and eps are program parameters. A BFGS optimiser [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>] is used to find the locations that give the minimum loss values. Alignments are then each assigned to the cluster with the closest centre. The final distance value, <italic toggle="yes">D</italic> returned by <italic toggle="yes">Mottle</italic> is obtained from the origin match proportion of alignments in the homology cluster, corrected for GC-content, and transformed to an estimate of substitution distance via the Jukes-Cantor (JC) model [<xref rid="pone.0298834.ref026" ref-type="bibr">26</xref>],
<disp-formula id="pone.0298834.e006"><alternatives><graphic xlink:href="pone.0298834.e006.jpg" id="pone.0298834.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">I</italic> being equal to mean true identity of the homologous cluster.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Mottle-map: Bespoke fragment mapping algorithm</title>
      <p>While <italic toggle="yes">Mottle</italic> may use any short-read mapper for fragment mapping, a bespoke algorithm was developed to ensure that each position in a sequence is mapped even at large divergences. <italic toggle="yes">Mottle-map</italic> achieves this by transforming each fragment to a high-dimensional embedding via the Fast Fourier Transform (FFT) and subsequently finding the nearest neighbour in the reciprocal sequence. This is similar to the approach <italic toggle="yes">Satsuma</italic> takes for synteny detection [<xref rid="pone.0298834.ref027" ref-type="bibr">27</xref>]. To allow the FFT transformation of fragments, their values must first be mapped to the complex number plane. For this we use the same embeddings as MAFFT [<xref rid="pone.0298834.ref028" ref-type="bibr">28</xref>], with each base placed at axis-aligned unit lengths and bonding pairs placed in opposite sides of the origin G → + 1, C → - 1, A → + i, T/U → - i. If each position in the fragment is treated as an embedding dimension, then two sequences that are more similar will have a smaller Euclidean distance between embedding, if there are no indels, that give a mid-sequence shift that would misalign the embedding. Shifting this embedding into frequency space via the FFT allows a Euclidean distance calculation while allowing for indels. Before transformation, we divide the real and imaginary axes by the mean of their absolute values, to correct for GC-content. Afterwards, the frequency embeddings are normalised to unit L<sub>2</sub>-norm. These steps can be represented mathematically as follows,
<disp-formula id="pone.0298834.e007"><alternatives><graphic xlink:href="pone.0298834.e007.jpg" id="pone.0298834.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where, E is the set of embedded nucleotides of a sequence, and L is the length of the sequence, and
<disp-formula id="pone.0298834.e008"><alternatives><graphic xlink:href="pone.0298834.e008.jpg" id="pone.0298834.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Where F is the set of values generated from GC-corrected embeddings after transformation by FFT, and L is the length of the transformed sequence. Since Euclidean distance between frequency embeddings can be used as a dissimilarity metric between fragments, a nearest-neighbour search can be used between two sets of embeddings to find similar fragments. Since <italic toggle="yes">Mottle-map</italic> is made for small and highly-divergent sequences, we use a simple many-to-many comparison where the distance between each embedding vector is computed. The top N nearest-neighbour mappings for each fragment in two fragment sets are returned by <italic toggle="yes">Mottle-map</italic>, where N is a parameter.</p>
    </sec>
    <sec id="sec008">
      <title>Implementation and availability</title>
      <p><italic toggle="yes">Mottle</italic> and <italic toggle="yes">Mottle-map</italic> are implemented in Python 3.9 and both are available at <ext-link xlink:href="https://github.com/tphoward/Mottle/_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle\_Repo</ext-link>. Gradient-Boosted Decision Trees are calculated by LightGBM [<xref rid="pone.0298834.ref029" ref-type="bibr">29</xref>], gradient-descent clustering by Tensorflow-probability [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>], and nearest neighbour search by Faiss [<xref rid="pone.0298834.ref031" ref-type="bibr">31</xref>]. Parameters used within testing were as follows, ntrees: 100, nleaves: 32, learn_rate: 0.1, subsamp: 1.0, binpow: 64, learn_mult: 0.001, reltol: 1.00E-20, maxiter: 100, binthres: 0.75, and prior_size: 10.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Results and discussion</title>
    <p>To evaluate the performance of <italic toggle="yes">Mottle</italic>, we run a set of benchmarks where exact or approximate relationships between sequences are known. We run <italic toggle="yes">Mottle</italic> with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper. As a comparison, we include four other programs that are used for substitution distance calculation—<italic toggle="yes">Co-phylog</italic> which utilises micro-alignments between sequences [<xref rid="pone.0298834.ref032" ref-type="bibr">32</xref>], <italic toggle="yes">Mash</italic> which calculates distances based on shared k-mers [<xref rid="pone.0298834.ref033" ref-type="bibr">33</xref>], <italic toggle="yes">Slope-SpaM</italic> that uses spaced-word matches [<xref rid="pone.0298834.ref034" ref-type="bibr">34</xref>], and <italic toggle="yes">Swipe</italic> that calculates Smith-Waterman local alignments between sequences, utilising scores based on Karlin-Altschul statistics [<xref rid="pone.0298834.ref035" ref-type="bibr">35</xref>]. For the programs that output identities or alignments, a JC model is used to convert to substitution distances. A summary of the results of all benchmark tests can be seen in <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>.</p>
    <table-wrap position="float" id="pone.0298834.t001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0298834.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Summary of benchmarking results.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="pone.0298834.t001" id="pone.0298834.t001g" position="float"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Tool Name</th>
              <th align="center" rowspan="1" colspan="1">Sub</th>
              <th align="center" rowspan="1" colspan="1">Rfam</th>
              <th align="center" rowspan="1" colspan="1">Gen-fam</th>
              <th align="center" rowspan="1" colspan="1">Fam-ord</th>
              <th align="center" rowspan="1" colspan="1">Ord-class</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Slope-spam</td>
              <td align="center" rowspan="1" colspan="1">0.52</td>
              <td align="center" rowspan="1" colspan="1">0.22</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.70</td>
              <td align="center" rowspan="1" colspan="1">0.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Co-Phylog</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
              <td align="center" rowspan="1" colspan="1">0.82</td>
              <td align="center" rowspan="1" colspan="1">0.38</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mash</td>
              <td align="center" rowspan="1" colspan="1">0.44</td>
              <td align="center" rowspan="1" colspan="1">0.18</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.98</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.85</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.70</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Swipe</td>
              <td align="center" rowspan="1" colspan="1">0.36</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.89</td>
              <td align="center" rowspan="1" colspan="1">0.69</td>
              <td align="center" rowspan="1" colspan="1">0.33</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">BWA-MEM2*</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.24</td>
              <td align="center" rowspan="1" colspan="1">0.94</td>
              <td align="center" rowspan="1" colspan="1">0.71</td>
              <td align="center" rowspan="1" colspan="1">0.61</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mottle(-map)</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.96</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.66</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.95</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.75</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>Sub: Maximum stable distance of each program when tested on a simple <italic toggle="yes">in silico</italic> sequence evolution benchmark (section, <italic toggle="yes">Simple sequence evolution</italic>). Rfam: Maximum stable distance on concatenated RNA family alignments (section, <italic toggle="yes">Known family alignments</italic>). Gen-fam, Fam-ord and Ord-class: Proportion of correctly assigned outgroup genomes when comparing genomes in the same Genus/Family, Family/Order and Order/Class respectively (section, <italic toggle="yes">Known genome taxonomies</italic>). Scores in bold represent the best performing program in a benchmark test. *Here, <italic toggle="yes">Mottle</italic> was executed with BWA-MEM2 as the mapping software.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec id="sec010">
      <title>Simple sequence evolution</title>
      <p>Our first goal was to test how well <italic toggle="yes">Mottle</italic> performed in comparison to other programs designed to calculate pairwise substitution distances, in the absence of confounding factors. Specifically, we tested programs against the Tobacco mosaic virus genome, with several substitutions introduced <italic toggle="yes">in silico</italic> to a set substitution distance and monitored their effectiveness at estimating this distance over increasing divergence. To do this, we used the genomic sequence of Tobacco mosaic virus (RefSeq accession NC_001367.1), and introduced a set number, <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub>, of random substitution events <italic toggle="yes">in silico</italic>, following <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub> = <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub>⋅<italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub>, with <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub> being equal to the size of the full sequence and <italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub> being the desired substitution distance. Multiple substitution events were allowed to occur at each site. We then ran each substitution distance program on the original and modified genomes to find a calculated distance. This was run for every 0.02 substitution per base-pair (sub/bp) distance between 0 and 1 inclusive, giving a total sample size of 51 sequences. To have a measure of when the outputs of a program begin to consistently diverge from the true distance, that is independent of the number of trials, we calculated a running Mean Absolute Error (MAE) from the true distance as,
<disp-formula id="pone.0298834.e009"><alternatives><graphic xlink:href="pone.0298834.e009.jpg" id="pone.0298834.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">error</italic> is the calculated MAE, <italic toggle="yes">T</italic><sub><italic toggle="yes">k</italic></sub> being equal to the target substitution distance of a specified trial, <italic toggle="yes">P</italic><sub><italic toggle="yes">k</italic></sub> the output of a substitution distance program within this trial, and <italic toggle="yes">N</italic> increasing with the number of trials completed. As a threshold, we use an MAE value of 0.05 sub/bp, where the furthest distance a program’s output is within the MAE threshold is its maximum stable distance. The results indicated that many of the tools struggled to calculate the true distance between 0.25 and 0.35 substitutions per nucleotide base (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Erratic behaviour was seen in many as they passed a critical threshold, set at 5% MAE from the true identity (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>). <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> however tended to significantly underestimate true distance past this point. Interestingly, the results for <italic toggle="yes">Mash</italic> were incredibly stable after much deviation from the true distance (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>). The results indicated that <italic toggle="yes">Mottle</italic>, implemented with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper, was able to accurately calculate the true distance over nearly all the sequence divergences tested, only reaching the 5% threshold towards the upper end of the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Noticeable but non-critical deviations were observed in <italic toggle="yes">BWA-MEM2</italic> and <italic toggle="yes">Mottle</italic> throughout the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>), such that a stricter threshold would have been surpassed at a lower divergence. The results for existing tools were surprising, and it was expected that they would perform reliably over a greater distance. It should be noted, however, that the divergence tested here (up to 1 substitution per base) would be considered high for many non-viral scenarios. These programs were not designed and tested with the high mutation rates observed in viruses in mind.</p>
      <fig position="float" id="pone.0298834.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a simple <italic toggle="yes">in silico</italic> substitution model of sequence evolution.</title>
          <p><bold>(a)</bold> Program predictions vs true distance between sequences. Values are clipped to the range [0,1]. Vertical lines indicate the maximum stable distance. <bold>(b)</bold> Mean value of the cumulative deviation of each tool from the true distance. The maximum tolerable deviation is set to 0.05 sub/bp. The point at which curves cross tolerable levels defines the maximum stable distance. Curves are cut whenever NaN values are produced.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Known family alignments</title>
      <p>Having established that <italic toggle="yes">Mottle</italic> could successfully be used to predict true distance over a large sequence divergence space–albeit in a simplified system—we next wanted to test <italic toggle="yes">Mottle</italic> against real viral sequences. However, it was important to maintain knowledge of the true distance between sequences. A database that allows us to do this is the RNA families (Rfam) database [<xref rid="pone.0298834.ref036" ref-type="bibr">36</xref>]. Rfam catalogues homologous RNA sequences as families and holds multiple sequence alignments of them. In addition, while a simple substitution model can give an upper bound on the maximum stable distance for each program, indels are a common feature in biological sequences, especially those of viruses. To test how well <italic toggle="yes">Mottle</italic> can handle indels, we endeavoured to create a benchmark that incorporates <italic toggle="yes">in vivo</italic> substitutions and indels, while allowing us to know the ground truth in terms of substitution distance and giving a large range of such distances. This benchmark therefore assesses <italic toggle="yes">Mottle</italic> against both real viral sequences and sequences containing indels. To do this, we extracted all pairwise alignments in each family where both sequences are of viral origin and calculated a JC distance from their identities. To increase the length of these alignments and make them more comparable to a small RNA viral genome, alignments of similar divergence were concatenated until they reach the size of a small viral genome (&gt;4 kb). For a given target distance, we find the alignment with the closest JC distance. We then calculate the current JC distance of the artificial genome, if below the target distance we add the closest alignment that is above the target distance and vice versa. This process is repeated without replacement until either the target length is reached, or we run out of valid candidate alignments. This created a more realistic dataset to test the six programs against. We run this benchmark on the same distances as previously (Simple sequence evolution, a total of 51 pairs of sequences with increasing substitution distance) and calculate MAEs in the same process.</p>
      <p>For all tools, predictive performance was degraded compared to the previous test (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3</xref>). For many programs, calculating distance was effective initially, but soon diverged from the true value. For most, distance was difficult to calculate beyond 0.25 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3A</xref>). <italic toggle="yes">Co-Phylog</italic>, <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> tended towards underestimating sequence divergence from the true distance past this point, while <italic toggle="yes">Slope-Spam</italic> and <italic toggle="yes">BWA-MEM2</italic> displayed more erratic behaviour. By contrast, <italic toggle="yes">Mottle</italic> was able to track the true distance for longer, deviating only when reaching approximately 0.66 substitutions per base. All programs, except <italic toggle="yes">Mottle</italic>, had crossed the 5% cumulative deviation threshold by 0.3 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). In contrast to <xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>, all programs displayed similar deviation at low divergences. Taken together with the previous test, we conclude that <italic toggle="yes">Mottle</italic> is an effective tool for predicting true distance between highly divergent sequences, as may be found within viral populations.</p>
      <fig position="float" id="pone.0298834.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a concatenated family alignment dataset.</title>
          <p>Formatted as Fig 2. <bold>(a)</bold> Program predictions vs true distance between sequences. <bold>(b)</bold> Mean cumulative deviation of each tool from the true distance.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Known genome taxonomies</title>
      <p>We next wished to test the performance of these programs in identifying the relationship between genomes in the known viral taxonomy. We assembled a test set of viral genomes composed of three different genomes at two different taxonomic ranks (i.e., genus, order, family, class), as defined by the International Committee on Taxonomy of Viruses [<xref rid="pone.0298834.ref037" ref-type="bibr">37</xref>]. We used this dataset to assess how well each tool could identify outgroup genomes as the taxonomic rankings were increased. Briefly, each program was required to calculate the distance between one reference genome and two others, one that shares a chosen taxonomic ranking (comparator) and another that only shares the rank above (outgroup, <xref rid="pone.0298834.g004" ref-type="fig">Fig 4A</xref>). A correct identification gives the outgroup a higher distance to the reference. To carry out this benchmark, we select reference, comparator, and outgroup genomes randomly from the e NCBI taxonomy database [<xref rid="pone.0298834.ref038" ref-type="bibr">38</xref>] that exhibit this rank structure. On these, we run each program twice—once to calculate reference/comparator distance and once for reference/outgroup. If the distance to the outgroup is larger than to the comparator, this is recorded as a correct output, if smaller then incorrect, and if the output is the same for both then it is recorded as ambiguous. Some programs return NaN values or error codes if they are unable to find any homologous sites to calculate a distance from. In this case, the values are recorded as the maximal distance, which we store as infinity, and carry out the comparisons as before. The rank comparisons we used were Genus-Family, Family-Order, Order-Class. A total of 100 pairs of sequences were used within each rank of comparison.</p>
      <fig position="float" id="pone.0298834.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools for identifying taxonomic outgroup genomes.</title>
          <p><bold>(a)</bold> Taxonomic relationship between query, comparator and outgroup genomes. <bold>(b)</bold> Proportion of assignments that were correct (outgroup more distant than comparator genome), incorrect (outgroup less distant), or ambiguous (identical distances) for each tool when comparing genomes in the same Genus or same Family, in the same Family or same Order, and in the same Order or same Class, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g004" position="float"/>
      </fig>
      <p>Unsurprisingly, most of the programs were able to identify which genome shared the same Genus as the other, and which were only in the same Family (<xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>). <italic toggle="yes">Mash</italic> performed the best under these conditions, followed by <italic toggle="yes">Mottle</italic> and then <italic toggle="yes">BWA-MEM2</italic>. <italic toggle="yes">Co-Phylog</italic>, which was created with the genomes of cellular organisms in mind, did return several ambiguous results, perhaps a result of the instability of the output, even at low divergence, as seen in <xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>. In the next test, the reference genome was compared to genomes in the same Family or Order. Here, all programs performed less well than in the previous test, with <italic toggle="yes">Mottle</italic> performing the best, followed by <italic toggle="yes">Mash</italic> and then <italic toggle="yes">Swipe</italic>. Again, <italic toggle="yes">Co-Phylog</italic> struggled to unambiguously place genomes correctly at this taxonomic distance. In the final test, the reference genome was compared with ones sharing an Order and Class. This test was far more challenging. Once again, <italic toggle="yes">Mash</italic>, <italic toggle="yes">Mottle</italic> and <italic toggle="yes">BWA-MEM2</italic> were the most effective, showing mainly correct placements with few ambiguous results. The other tools demonstrated high levels of ambiguity in this challenge, being unable to find any regions of homology to calculate a stable distance. <italic toggle="yes">Mottle</italic>, <italic toggle="yes">Mash</italic> and <italic toggle="yes">BWA-MEM2</italic> are therefore useful tools for placing test genomes within known taxonomies, even at large taxonomic distances.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Conclusions</title>
    <p>Pairwise substitution distance has a wide set of applications, from building phylogenies to creating reduced databases. Finding a novel approach in this field can find utilisations in any of these areas, giving opportunities for further refinement specific to certain applications. <italic toggle="yes">Mottle</italic> represents an additional tool in this endeavour. It performs as well as existing programs in correctly identifying taxonomic relationships but comes with the added advantage of provided an accurate numerical estimation of genomic distance over a greater sequence divergence. A limitation of its use, though, is a reduced numerical accuracy, compared to alternative approaches, at low divergences on genomes that behave similarly to a simple substitution model, i.e., where insertions and deletions are uncommon. <italic toggle="yes">Mottle</italic> may therefore be of particular interest to the study of viruses, viral relationships, and viral discovery platforms, where available sequences for reference may be sparse, sequence diversity is high, and insertions/deletions occur at a high rate. The algorithms behind <italic toggle="yes">Mottle</italic> can be applied using any Short-Read mapper, Gradient-Boosted Decision Tree generator, Gradient-Descent software, and Nearest-Neighbour finder. This means that any advancements in such software would give increased efficiency or accuracy to new implementations. Further extensions to the algorithm could include support for amino acid input, simultaneous multiple sequence distance calculation and isolating sub-alignments of continuous homology. In conclusion, <italic toggle="yes">Mottle</italic> is an invaluable, novel approach in substitution distance estimation, with significant performance benefits compared to other algorithms.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0298834.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Zaharias</surname><given-names>P</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>Recent progress on methods for estimating and updating large phylogenies</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2022</year>;<volume>377</volume>: <fpage>20210244</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.2021.0244</pub-id><?supplied-pmid 35989607?><pub-id pub-id-type="pmid">35989607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>M</given-names></name>, <name><surname>Delwart</surname><given-names>E</given-names></name>, <name><surname>Rosario</surname><given-names>K</given-names></name>, <name><surname>Segales</surname><given-names>J</given-names></name>, <name><surname>Varsani</surname><given-names>A</given-names></name>, <name><surname>Ictv Report</surname><given-names>C</given-names></name>. <article-title>ICTV Virus Taxonomy Profile: Circoviridae</article-title>. <source>J Gen Virol</source>. <year>2017</year>;<volume>98</volume>: <fpage>1997</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1099/jgv.0.000871</pub-id><?supplied-pmid 28786778?><pub-id pub-id-type="pmid">28786778</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Su</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>. <article-title>Sketch distance-based clustering of chromosomes for large genome database compression</article-title>. <source>BMC Genomics</source>. <year>2019</year>;<volume>20</volume>: <fpage>978</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-019-6310-0</pub-id><?supplied-pmid 31888458?><pub-id pub-id-type="pmid">31888458</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Krishnamurthy</surname><given-names>SR</given-names></name>, <name><surname>Wang</surname><given-names>D</given-names></name>. <article-title>Origins and challenges of viral dark matter</article-title>. <source>Virus Res</source>. <year>2017</year>;<volume>239</volume>: <fpage>136</fpage>–<lpage>42</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.virusres.2017.02.002</pub-id><?supplied-pmid 28192164?><pub-id pub-id-type="pmid">28192164</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zielezinski</surname><given-names>A</given-names></name>, <name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>Bernard</surname><given-names>G</given-names></name>, <name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Tang</surname><given-names>K</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>144</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id><?supplied-pmid 31345254?><pub-id pub-id-type="pmid">31345254</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>DN</given-names></name>, <name><surname>Langmead</surname><given-names>B</given-names></name>. <article-title>Dashing: fast and accurate genomic distances with HyperLogLog</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>265</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1875-0</pub-id><?supplied-pmid 31801633?><pub-id pub-id-type="pmid">31801633</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Dorrer</surname><given-names>S</given-names></name>, <name><surname>Gerth</surname><given-names>M</given-names></name>, <name><surname>Bleidorn</surname><given-names>C</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Prot-SpaM: fast alignment-free phylogeny reconstruction based on whole-proteome sequences</article-title>. Gigascience. <year>2019</year>;<fpage>8</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giy148</pub-id><?supplied-pmid 30535314?><pub-id pub-id-type="pmid">30535314</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>X.</given-names></name><article-title>BinDash, software for fast genome distance estimation on a typical personal laptop</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>671</fpage>–<lpage>3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty651</pub-id><?supplied-pmid 30052763?><pub-id pub-id-type="pmid">30052763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Klotzl</surname><given-names>F</given-names></name>, <name><surname>Haubold</surname><given-names>B</given-names></name>. <article-title>Phylonium: fast estimation of evolutionary distances from large samples of similar genomes</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>: <fpage>2040</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz903</pub-id><?supplied-pmid 31790149?><pub-id pub-id-type="pmid">31790149</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>James</surname><given-names>BT</given-names></name>, <name><surname>Luczak</surname><given-names>BB</given-names></name>. <article-title>Identity: rapid alignment-free prediction of sequence alignment identity scores using self-supervised general linear models</article-title>. <source>NAR Genom Bioinform</source>. <year>2021</year>;<volume>3</volume>: <fpage>lqab001</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nargab/lqab001</pub-id><?supplied-pmid 33554117?><pub-id pub-id-type="pmid">33554117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Uddin</surname><given-names>M</given-names></name>, <name><surname>Islam</surname><given-names>MK</given-names></name>, <name><surname>Hassan</surname><given-names>MR</given-names></name>, <name><surname>Jahan</surname><given-names>F</given-names></name>, <name><surname>Baek</surname><given-names>JH</given-names></name>. <article-title>A fast and efficient algorithm for DNA sequence similarity identification</article-title>. <source>Complex Intell Systems</source>. <year>2023</year>;<volume>9</volume>: <fpage>1265</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40747-022-00846-y</pub-id><?supplied-pmid 36035628?><pub-id pub-id-type="pmid">36035628</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Duffy</surname><given-names>S</given-names></name>, <name><surname>Shackelton</surname><given-names>LA</given-names></name>, <name><surname>Holmes</surname><given-names>EC</given-names></name>. <article-title>Rates of evolutionary change in viruses: patterns and determinants</article-title>. <source>Nat Rev Genet</source>. <year>2008</year>;<volume>9</volume>: <fpage>267</fpage>–<lpage>76</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2323</pub-id><?supplied-pmid 18319742?><pub-id pub-id-type="pmid">18319742</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Santiago-Rodriguez</surname><given-names>TM</given-names></name>, <name><surname>Hollister</surname><given-names>EB</given-names></name>. <article-title>Unraveling the viral dark matter through viral metagenomics.</article-title><source>Front Immunol</source>. <year>2022</year>;<volume>13</volume>: <fpage>1005107</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fimmu.2022.1005107</pub-id><?supplied-pmid 36189246?><pub-id pub-id-type="pmid">36189246</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sanjuan</surname><given-names>R</given-names></name>, <name><surname>Nebot</surname><given-names>MR</given-names></name>, <name><surname>Chirico</surname><given-names>N</given-names></name>, <name><surname>Mansky</surname><given-names>LM</given-names></name>, <name><surname>Belshaw</surname><given-names>R</given-names></name>. <article-title>Viral mutation rates</article-title>. <source>J Virol</source>. <year>2010</year>;<volume>84</volume>: <fpage>9733</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JVI.00694-10</pub-id><?supplied-pmid 20660197?><pub-id pub-id-type="pmid">20660197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <name><surname>Dolja</surname><given-names>VV</given-names></name>. <article-title>The global virome: How much diversity and how many independent origins</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>40</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16207</pub-id><?supplied-pmid 36097140?><pub-id pub-id-type="pmid">36097140</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Dominguez-Huerta</surname><given-names>G</given-names></name>, <name><surname>Wainaina</surname><given-names>JM</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Culley</surname><given-names>AI</given-names></name>, <name><surname>Kuhn</surname><given-names>JH</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>The RNA virosphere: How big and diverse is it</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>209</fpage>–<lpage>15</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16312</pub-id><?supplied-pmid 36511833?><pub-id pub-id-type="pmid">36511833</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Neri</surname><given-names>U</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Camargo</surname><given-names>AP</given-names></name>, <name><surname>Lee</surname><given-names>B</given-names></name>, <name><surname>Kazlauskas</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Expansion of the global RNA virome reveals diverse clades of bacteriophages</article-title>. <source>Cell</source>. <year>2022</year>;<volume>185</volume>: <fpage>4023</fpage>–<lpage>37 e18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2022.08.023</pub-id><?supplied-pmid 36174579?><pub-id pub-id-type="pmid">36174579</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Accurate multiple alignment of distantly related genome sequences using filtered spaced word matches as anchor points</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>211</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty592</pub-id><?supplied-pmid 29992260?><pub-id pub-id-type="pmid">29992260</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Hachiya</surname><given-names>T</given-names></name>, <name><surname>Osana</surname><given-names>Y</given-names></name>, <name><surname>Popendorf</surname><given-names>K</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name>. <article-title>Accurate identification of orthologous segments among multiple genomes</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>853</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp070</pub-id><?supplied-pmid 19188192?><pub-id pub-id-type="pmid">19188192</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Criscuolo</surname><given-names>A.</given-names></name><article-title>On the transformation of MinHash-based uncorrected distances into proper evolutionary distances for phylogenetic inference.</article-title><source>F1000Res</source>. <year>2020</year>;<volume>9</volume>: <fpage>1309</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.26930.1</pub-id><?supplied-pmid 33335719?><pub-id pub-id-type="pmid">33335719</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Haubold</surname><given-names>B</given-names></name>, <name><surname>Pfaffelhuber</surname><given-names>P</given-names></name>, <name><surname>Domazet-Loso</surname><given-names>M</given-names></name>, <name><surname>Wiehe</surname><given-names>T</given-names></name>. <article-title>Estimating mutation distances from unaligned genomes</article-title>. <source>J Comput Biol</source>. <year>2009</year>;<volume>16</volume>: <fpage>1487</fpage>–<lpage>500</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2009.0106</pub-id><?supplied-pmid 19803738?><pub-id pub-id-type="pmid">19803738</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Kmacs: the k-mismatch average common substring approach to alignment-free sequence comparison</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>2000</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu331</pub-id><?supplied-pmid 24828656?><pub-id pub-id-type="pmid">24828656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Genco</surname><given-names>RJ</given-names></name>, <name><surname>Wactawski-Wende</surname><given-names>J</given-names></name>, <name><surname>Buck</surname><given-names>M</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>. <article-title>SENSE: Siamese neural network for sequence embedding and alignment-free comparison</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>1820</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty887</pub-id><?supplied-pmid 30346493?><pub-id pub-id-type="pmid">30346493</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Moshiri</surname><given-names>N</given-names></name>, <name><surname>Robinson</surname><given-names>P</given-names></name>. <article-title>ViralMSA: massively scalable reference-guided multiple sequence alignment of viral genomes</article-title>. <source>Bioinformatics</source>. <year>2021</year>;<volume>37</volume>: <fpage>714</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa743</pub-id><?supplied-pmid 32814953?><pub-id pub-id-type="pmid">32814953</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bertels</surname><given-names>F</given-names></name>, <name><surname>Silander</surname><given-names>OK</given-names></name>, <name><surname>Pachkov</surname><given-names>M</given-names></name>, <name><surname>Rainey</surname><given-names>PB</given-names></name>, <name><surname>van Nimwegen</surname><given-names>E</given-names></name>. <article-title>Automated reconstruction of whole-genome phylogenies from short-sequence reads</article-title>. <source>Mol Biol Evol</source>. <year>2014</year>;<volume>31</volume>: <fpage>1077</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msu088</pub-id><?supplied-pmid 24600054?><pub-id pub-id-type="pmid">24600054</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Jukes</surname><given-names>TH</given-names></name>, <name><surname>Cantor</surname><given-names>CR</given-names></name>. <part-title>Evolution of Protein Molecules</part-title>. In: <name><surname>Munro</surname><given-names>HN</given-names></name>, editor. <source>Mammalian Protein Metabolism</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1969</year>. p. <fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Grabherr</surname><given-names>MG</given-names></name>, <name><surname>Russell</surname><given-names>P</given-names></name>, <name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Mauceli</surname><given-names>E</given-names></name>, <name><surname>Alfoldi</surname><given-names>J</given-names></name>, <name><surname>Di Palma</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide synteny through highly sensitive sequence alignment: Satsuma</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>1145</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btq102</pub-id><?supplied-pmid 20208069?><pub-id pub-id-type="pmid">20208069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Rozewicki</surname><given-names>J</given-names></name>, <name><surname>Yamada</surname><given-names>KD</given-names></name>. <article-title>MAFFT online service: multiple sequence alignment, interactive sequence choice and visualization</article-title>. <source>Brief Bioinform</source>. <year>2019</year>;<volume>20</volume>: <fpage>1160</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx108</pub-id><?supplied-pmid 28968734?><pub-id pub-id-type="pmid">28968734</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Ke</surname><given-names>G</given-names></name>, <name><surname>Meng</surname><given-names>Q</given-names></name>, <name><surname>Finley</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Ma</surname><given-names>W</given-names></name>, <etal>et al</etal>., Eds. <name><surname>von Luxburg</surname><given-names>U</given-names></name>, <name><surname>Guyon</surname><given-names>I</given-names></name>, <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <part-title>Fergus R LightGBM: a highly efficient gradient boosting decision tree.</part-title><source>Proceedings of the 31st International Conference on Neural Information Processing Systems</source>; <year>2017</year>; <publisher-loc>Long Beach, California, USA</publisher-loc>: <publisher-name>Curran Associates Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>M</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Barham</surname><given-names>P</given-names></name>, <name><surname>Brevdo</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>TensorFlow: Large-Scale Machine Learning on Heterogeneous Distributed Systems</article-title>. <year>2015</year>. <source>Software available from tensorflow.org</source>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Douze</surname><given-names>M</given-names></name>, <name><surname>Jegou</surname><given-names>H</given-names></name>. <article-title>Billion-Scale Similarity Search with GPUs</article-title>. <source>IEEE Transactions on Big Data</source>. <year>2021</year>;<volume>7</volume>: <fpage>535</fpage>–<lpage>47</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tbdata.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Yi</surname><given-names>H</given-names></name>, <name><surname>Jin</surname><given-names>L</given-names></name>. <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>e75</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkt003</pub-id><?supplied-pmid 23335788?><pub-id pub-id-type="pmid">23335788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ondov</surname><given-names>BD</given-names></name>, <name><surname>Treangen</surname><given-names>TJ</given-names></name>, <name><surname>Melsted</surname><given-names>P</given-names></name>, <name><surname>Mallonee</surname><given-names>AB</given-names></name>, <name><surname>Bergman</surname><given-names>NH</given-names></name>, <name><surname>Koren</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>132</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id><?supplied-pmid 27323842?><pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Rohling</surname><given-names>S</given-names></name>, <name><surname>Linne</surname><given-names>A</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Hosseini</surname><given-names>M</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>The number of k-mer matches between two DNA sequences as a function of k and applications to estimate phylogenetic distances</article-title>. <source>PLoS One</source>. <year>2020</year>;<volume>15</volume>: <fpage>e0228070</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0228070</pub-id><?supplied-pmid 32040534?><pub-id pub-id-type="pmid">32040534</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rognes</surname><given-names>T.</given-names></name><article-title>Faster Smith-Waterman database searches with inter-sequence SIMD parallelisation</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>: <fpage>221</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-221</pub-id><?supplied-pmid 21631914?><pub-id pub-id-type="pmid">21631914</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kalvari</surname><given-names>I</given-names></name>, <name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Ontiveros-Palacios</surname><given-names>N</given-names></name>, <name><surname>Argasinska</surname><given-names>J</given-names></name>, <name><surname>Lamkiewicz</surname><given-names>K</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>. <source>Nucleic Acids Res</source>. <year>2021</year>;<volume>49</volume>: <fpage>D192</fpage>–<lpage>D200</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id><?supplied-pmid 33211869?><pub-id pub-id-type="pmid">33211869</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lefkowitz</surname><given-names>EJ</given-names></name>, <name><surname>Dempsey</surname><given-names>DM</given-names></name>, <name><surname>Hendrickson</surname><given-names>RC</given-names></name>, <name><surname>Orton</surname><given-names>RJ</given-names></name>, <name><surname>Siddell</surname><given-names>SG</given-names></name>, <name><surname>Smith</surname><given-names>DB</given-names></name>. <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV).</article-title><source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>: <fpage>D708</fpage>–<lpage>D17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id><?supplied-pmid 29040670?><pub-id pub-id-type="pmid">29040670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Federhen</surname><given-names>S.</given-names></name><article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>: <fpage>D136</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><?supplied-pmid 22139910?><pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10956839</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0298834</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-23-29038</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Nucleotide Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Nucleotide Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mottle: Accurate pairwise substitution distance at high divergence through the exploitation of short-read mappers and gradient descent</article-title>
      <alt-title alt-title-type="running-head">Mottle: Calculating pairwise substitution distances</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Prusokiene</surname>
          <given-names>Alisa</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boonham</surname>
          <given-names>Neil</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fox</surname>
          <given-names>Adrian</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5546-4043</contrib-id>
        <name>
          <surname>Howard</surname>
          <given-names>Thomas P.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Faculty of Science, Agriculture and Engineering, School of Natural and Environmental Sciences, Newcastle University, United Kingdom</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Fera Ltd., Biotech Campus, York, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mapder</surname>
          <given-names>Tarunendu</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Bristol-Myers Squibb Company, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Thomas.Howard@newcastle.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>19</volume>
    <issue>3</issue>
    <elocation-id>e0298834</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Prusokiene et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Prusokiene et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0298834.pdf"/>
    <abstract>
      <p>Current tools for estimating the substitution distance between two related sequences struggle to remain accurate at a high divergence. Difficulties at distant homologies, such as false seeding and over-alignment, create a high barrier for the development of a stable estimator. This is especially true for viral genomes, which carry a high rate of mutation, small size, and sparse taxonomy. Developing an accurate substitution distance measure would help to elucidate the relationship between highly divergent sequences, interrogate their evolutionary history, and better facilitate the discovery of new viral genomes. To tackle these problems, we propose an approach that uses short-read mappers to create whole-genome maps, and gradient descent to isolate the homologous fraction and calculate the final distance value. We implement this approach as <italic toggle="yes">Mottle</italic>. With the use of simulated and biological sequences, <italic toggle="yes">Mottle</italic> was able to remain stable to 0.66–0.96 substitutions per base pair and identify viral outgroup genomes with 95% accuracy at the family-order level. Our results indicate that <italic toggle="yes">Mottle</italic> performs as well as existing programs in identifying taxonomic relationships, with more accurate numerical estimation of genomic distance over greater divergences. By contrast, one limitation is a reduced numerical accuracy at low divergences, and on genomes where insertions and deletions are uncommon, when compared to alternative approaches. We propose that <italic toggle="yes">Mottle</italic> may therefore be of particular interest in the study of viruses, viral relationships, and notably for viral discovery platforms, helping in benchmarking of homology search tools and defining the limits of taxonomic classification methods. The code for Mottle is available at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme</institution>
        </funding-source>
        <award-id>2144113</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Fera Science Ltd.</institution>
        </funding-source>
        <award-id>CASE Partner</award-id>
      </award-group>
      <funding-statement>This work has been supported by the BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme (reference 2144113), with Fera Science Ltd. as the CASE partner. There was no additional external funding received for this study.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Pairwise nucleotide substitution distance is widely used in bioinformatic analyses. Pairwise comparisons within collections of genomes are commonly integrated to establish phylogenies, providing insight into their shared evolutionary history. They are similarly used to position novel genomes within an established phylogeny [<xref rid="pone.0298834.ref001" ref-type="bibr">1</xref>]. Substitution distances can also be converted to genome-wide percentage identity to define taxonomic demarcations, such as the distance a novel genome must be from known genomes to establish it as a new species [<xref rid="pone.0298834.ref002" ref-type="bibr">2</xref>]. Comparing the distances of discrete genetic molecules such as chromosomes, plasmids, plastids, and segments can find differences in their evolutionary histories, elucidating how genetic material has been exchanged between organisms or populations. Finding the most distinct or representative sequences in a set is used to create a compressed database for homology search and taxonomic classification [<xref rid="pone.0298834.ref003" ref-type="bibr">3</xref>]. A high substitution distance can however be a large barrier for sequence discovery [<xref rid="pone.0298834.ref004" ref-type="bibr">4</xref>]. Being able to accurately define this distance allows improved benchmarking of homology search and taxonomic classification tools to find their limits, allowing accurate estimates of what may pass through the silicon sieve of <italic toggle="yes">de novo</italic> sequencing-based discovery and diagnostics.</p>
    <p>Despite the considerable number of approaches available for pairwise genome comparison [<xref rid="pone.0298834.ref005" ref-type="bibr">5</xref>], many do not produce a biologically relevant substitution distance, and from those that do, there are few that are suitable for highly divergent sequences, i.e., those that have had many substitutions per site between them. This is for two main reasons–work has focused on creating faster and more efficient tools that work well at low divergences [<xref rid="pone.0298834.ref006" ref-type="bibr">6</xref>–<xref rid="pone.0298834.ref011" ref-type="bibr">11</xref>], combined with the inherent difficulties found when making comparisons at high divergences. The largest of these difficulties are false seeding and over-alignment. Seeding is the process of finding small sub-sequences, often in the tens of bases, that are identical or near identical in two sequences and can be extended to larger regions of homology. Finding seeds at non-homologous locations, i.e., false seeding, may add regions that otherwise have little similarity into the distance calculation, artificially inflating it. At low divergences a large seed size may be used as there would be few mutations between homologous regions. At increasing divergence, a smaller seed size is needed to find such regions, generating many seeding locations that are spurious, eventually overwhelming the limited number of truly homologous seed sites. Finding seed locations that have true homology while avoiding or removing false ones becomes a critical task at distant homologies. While false seeding can make sequences appear more divergent than they truly are, over-alignment can make them appear more similar. Alignment is usually done after seeding, inserting gaps into either sequence to match up homologous nucleotides that were shifted due to insertions and deletions (indels). This presents the danger of over-correcting for indels, falsely pairing matching nucleotides that are non-homologous, such as mistaking adjacent substitution events for an insertion, and therefore not contributing to the substitution distance. Avoiding over-alignment while still correctly aligning regions can be difficult at a low divergence, but at a high divergence, where multiple different mutation events may have occurred at the same nucleotide position, it may not be possible.</p>
    <p>These difficulties appear especially often when studying viral genomes, due to their high rate of mutation, small size, lack of universal marker genes, and the low proportion of known viruses [<xref rid="pone.0298834.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0298834.ref013" ref-type="bibr">13</xref>]. Viral replication machinery, especially those of single-stranded RNA based viruses, are known to introduce many substitutions every generation. Combined with a short generation time, these viruses can quickly diverge from their progenitor genome. Additionally, the ratio of indel event to substitution events is extremely high in these genomes [<xref rid="pone.0298834.ref014" ref-type="bibr">14</xref>], which makes finding true seeds more difficult and over-alignment more likely. The usually small size of viral genomes further reduces the number of possible seeding sites. Finally, the number of viral species that have been documented is a small proportion of the total estimated number of viral species [<xref rid="pone.0298834.ref015" ref-type="bibr">15</xref>], with estimates of the proportion of characterised orthornaviran RNA viruses being estimated as low as 0.006% [<xref rid="pone.0298834.ref016" ref-type="bibr">16</xref>], and environmental sampling projects discovering many previously unobserved viral genomes with each sequencing experiment [<xref rid="pone.0298834.ref017" ref-type="bibr">17</xref>]. The effect of sparse taxonomic coverage is that many viral genomes are highly diverged from any known viruses, making it difficult to study their relationship to other viruses. To this end, viral genome analysis is the field that may benefit the most from improvements in pairwise sequence distance accuracy at high divergences.</p>
    <p>In the face of these difficulties, current tools attempt to alleviate parts of the false seeding or over-alignment problems: some programs attempt to find non-exact matches for seeding, finding longer seeds which are more likely to be true seeds [<xref rid="pone.0298834.ref018" ref-type="bibr">18</xref>]. Others, such as Hachiya et al. [<xref rid="pone.0298834.ref019" ref-type="bibr">19</xref>], have sophisticated algorithms for distinguishing between true and false seeds. Programs that do not use any alignment step, known as alignment-free programs, are able to completely avoid the problem of over-alignment, instead using statistical information from across a sequence that is correlated to substitution distance–e.g., proportion of shared k-mers [<xref rid="pone.0298834.ref020" ref-type="bibr">20</xref>], shortest unique substrings [<xref rid="pone.0298834.ref021" ref-type="bibr">21</xref>], average common substring [<xref rid="pone.0298834.ref022" ref-type="bibr">22</xref>], or sequence embeddings [<xref rid="pone.0298834.ref023" ref-type="bibr">23</xref>]. This creates a separate issue–as sequence divergences increase, the correlation between these global statistical data and the local nucleotide substitutions they estimate can become increasingly decoupled. A new approach is needed, one which creates high-quality seeds and avoids over-alignment while incorporating direct nucleotide-level information.</p>
    <p>Short-read mappers (henceforth referred to as mappers) are tools used to map short sequence fragments of ~50-300bp, produced from High Throughput Sequencing runs, to reference genomes. These mappers already employ sophisticated seeding algorithms, give many parameters to tune mapping sensitivity, can use arbitrary queries and references, and are designed to handle thousands to millions of fragments. Sequence fragments created <italic toggle="yes">in silico</italic> can therefore be used as inputs to these mappers, finding the optimal homologous location for each fragment on another sequence, and allowing downstream processing to calculate substitution distance. This approach of running mappers on <italic toggle="yes">in silico</italic> fragments has been successfully utilised in other bioinformatic applications–for generating multiple sequence alignments in <italic toggle="yes">ViralMSA</italic> [<xref rid="pone.0298834.ref024" ref-type="bibr">24</xref>], and for constructing phylogenies in <italic toggle="yes">REALPHY</italic> [<xref rid="pone.0298834.ref025" ref-type="bibr">25</xref>]. In this paper we explore the application of these mappers for estimating pairwise nucleotide substitution distance, how careful use of their outputs can avoid false seeding and over-alignment and describe the implementation of <italic toggle="yes">Mottle</italic>—a tool for more accurate distance calculation between two highly divergent sequences. The tests carried out within this paper are based on consensus sequences of full viral genomes or RNA family sequences, but Mottle can be applied to any pair of DNA or RNA sequence files to give an estimated substitution distance.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <p><italic toggle="yes">Mottle</italic> takes two arbitrary nucleotide sequences of unknown relation, and outputs an estimated substitution distance between them. This can make use of any mapping software that aligns short fragments to larger sequences. Additionally, we have implemented a bespoke fragment mapping algorithm for this process, <italic toggle="yes">Mottle-map</italic>, which guarantees that each fragment is mapped but is not scalable to large sequences. Both algorithms are described in the subsections below.</p>
    <sec id="sec003">
      <title>Mottle: Calculating pairwise sequence distance from mapped fragments</title>
      <p>The main <italic toggle="yes">Mottle</italic> program can be split into three stages–fragment generation, alignment processing, and alignment clustering, presented in <xref rid="pone.0298834.g001" ref-type="fig">Fig 1A</xref> to c respectively and described in the following sections. Briefly, for each position, <italic toggle="yes">p</italic>, in query genome, Q, we set the nucleotide at that position, Q<sub><italic toggle="yes">p</italic></sub>, as the origin nucleotide. The set of flanking regions either side, Q<sub>[<italic toggle="yes">p+</italic>1..<italic toggle="yes">p</italic>+n]</sub> and Q<sub>[<italic toggle="yes">p-1</italic>..<italic toggle="yes">p</italic>-n</sub>] for a specified flank size <italic toggle="yes">n</italic>, of each origin nucleotide are mapped using a short-read mapper to a similar set of flanking regions in the target genome. For each mapping, we calculate flank alignments, and gather a set of statistics: the alignment identity, the indel rate of the alignment, and a binary value representing whether the corresponding origin nucleotides match or mismatch. We represent mappings as points defined by identity and indel statistics, labelled by match state, from which we can calculate a match probability that acts as an estimator for true identity without alignment bias. These points are clustered into two sets to separate homologous mappings from spurious ones, and genomic distance is estimated from the homologous set.</p>
      <fig position="float" id="pone.0298834.g001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">Mottle</italic>’s sequence distance estimation algorithm.</title>
          <p><bold>(a)</bold> Generating fragment alignments from input sequences. Each sequence is fragmented <italic toggle="yes">in silico</italic>. The origin nucleotide is excluded from each fragment sequence. Fragments are mapped onto the reciprocal sequence via a mapper, with each mapped fragment’s origin being paired. Origin pairs carry a binary state (match or mismatch). Fragment sequences are then fully aligned. <bold>(b) Truncating</bold> alignments on identity change. For each alignment, a sliding window calculates percentage identity. If a window’s identity diverges from the initial window’s, all nucleotides from that point onwards are discarded. <bold>(c)</bold> Fragment clustering and substitution distance estimation. For each alignment, identity and indel percentage statistics are calculated. These are fed into a Gradient Boosted Decision Tree (GBDT), which is trained to predict origin pair match state. This gives a predicted match probability on each alignment that can be interpreted as a bias-free identity. These three statistics are used for gradient-descent clustering, to find a cluster of alignments that were generated due to shared homology, and a cluster for those due to chance. Once both fractions are obtained, a mean origin identity is calculated for the homology cluster, which is used to derive the final substitution distance between the two sequences.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g001" position="float"/>
      </fig>
      <sec id="sec004">
        <title>(a) Fragment generation</title>
        <p><italic toggle="yes">Flank fragmentation</italic>. Each sequence can be separated into a discrete set of subsequences, each defined by a unique combination of origin nucleotide, subsequence size, and relative orientation. Each nucleotide in the full-length sequence can act as an origin—the first nucleotide of a subsequence—of multiple subsequences. But the possible sizes and relative orientations of these subsequences are restricted depending on the origin nucleotide’s location. If subsequence size is kept fixed, each nucleotide is an origin for up to two subsequences, for each of the forward and reverse complement orientations. The portion of each subsequence that does not contain the origin nucleotide is termed a fragment, and the two possible fragments for each origin are termed the forward and reverse flank fragments of the origin. Considering the origin nucleotide separately from the fragments is integral in estimating true identity in the later stages of the algorithm.</p>
        <p><italic toggle="yes">Reciprocal fragment mapping</italic>. This step takes the two full-length input sequences, their generated fragments, and a mapper program, to create a mapping between each fragment and a homologous area in the sequence of comparison. To allow the use of a variety of mapping algorithms, there are multiple modes of input depending on what the mapper accepts–sequence and fragments, fragments and fragments, or sequence and sequence. The mappings are done reciprocally–one sequence is used as the query with the other acting as the reference, and vice versa. The output of a mapper is a series of possibly homologous regions between the two inputs. This must either contain fragment names or sequence locations to allow identification of origin nucleotide, query location, and mapped location for each region. In cases where a mapper returns multiple regions for a query, all mapping is kept. The mapped region sequence pairs and corresponding origin nucleotides are extracted for use in later steps.</p>
        <p><italic toggle="yes">Mapped region alignment</italic>. While some mappers output a full alignment between mapped regions, many do not. To get consistent and well-defined alignments, Needleman-Wunsch global alignment is carried out between region sequences independent of mapper. This is because a representative region of homology adjacent to the origin nucleotide is desired, which Needleman-Wunsch global alignment maximises. Aligned regions that contain gaps in the first N bases are discarded, where N is a parameter of <italic toggle="yes">Mottle</italic>, as these gaps may shift the aligned region of homology and therefore the origin nucleotide.</p>
      </sec>
      <sec id="sec005">
        <title>(b) Alignment processing</title>
        <p><italic toggle="yes">Alignment truncation</italic>. Not all alignments will contain a consistent homology throughout. Some may begin with a high degree of similarity, but with a genomic rearrangement or large indel creating a discontinuity that suddenly reduces similarity. This non-homologous section would change alignment properties, adding noise to statistics calculations, and confounding downstream clustering. To remove these discontinuities, a sliding window is moved through the alignment. The length and identity, the proportion of aligned nucleotides that match, of the first window is used to estimate a binomial distribution for match/mismatch states. Where a later window’s identity is above or below that which would be expected by chance of this distribution, the alignment is clipped, discarding proceeding nucleotides. Clipped alignment shorter than a minimum size are additionally discarded. The window size, two-tailed binomial test p-value, and minimum clipped alignment size are configurable parameters.</p>
        <p><italic toggle="yes">Alignment statistics calculation</italic>. To distinguish homologous from non-homologous alignments, a set of statistics is calculated for each of the non-discarded windows produced during truncation. Alignment identity is the fraction of matches in non-gap positions, corrected for the GC composition of the alignment. The fraction of gap positions in the window could be used as another such statistic, where homologous alignments would contain fewer gaps at the same identity. This would, though, not inform us of the probability that the origin nucleotide is shifted by an Indel event, as each event can insert or delete multiple nucleotides in a row. The number of Indel events in a row between non-gap positions can be approximated by a geometric distribution with PMF,
<disp-formula id="pone.0298834.e001"><alternatives><graphic xlink:href="pone.0298834.e001.jpg" id="pone.0298834.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">l</italic> is the number of adjacent indel events between two non-gap positions regardless of the size of each event, <italic toggle="yes">P</italic>(<italic toggle="yes">L = l</italic>) is the probability of finding this number of events between two arbitrary sites in the sequence, and <italic toggle="yes">p</italic> is the fraction of indel events per site. <italic toggle="yes">p</italic> is directly related to the probability of no indel events having occurred between two adjacent homologous nucleotides via <italic toggle="yes">P</italic>(<italic toggle="yes">L</italic> = 0) = 1—<italic toggle="yes">p</italic>, which can be estimated from the fraction of adjacent aligned nucleotides that do not have gaps, <italic toggle="yes">q</italic>, in an observed sequence, (<italic toggle="yes">p</italic> = 1 –<italic toggle="yes">q</italic>). This produces a set of identities and indel fractions for each alignment—one for every fixed-size window within it. After this step, the alignments themselves are discarded, with only these statistics and the origin nucleotide match state being kept for the final steps.</p>
      </sec>
      <sec id="sec006">
        <title>(c) Alignment clustering</title>
        <p><italic toggle="yes">GBDT estimation of true identity</italic>. Identity and indel fraction can greatly vary between and within homologous alignments. For clustering to be effective, a more stable statistic needs to be calculated. For this purpose, we train a Gradient-Boosted Decision Tree (GBDT) to estimate a ’true identity’ for each window over the space defined by the previous statistics (<xref rid="pone.0298834.g001" ref-type="fig">Fig 1C</xref>, ’GBDT estimation’). This treats each window as a single point of data, with parameters identity and indel fraction, and with prediction value being origin nucleotide match state (1 = match, 0 = mismatch). The output of a GBDT can be thought of as a stepwise surface embedded within the input parameter space, which we enforce to be monotonically increasing with window identity and decreasing with indel fraction. This estimates the proportion of origin nucleotides that match within each area of parameter combinations, which we term the true identity estimate. As a wide area can have the same value estimated, similar alignments are likely to have windows that share similar true identities, making clustering more stable.</p>
        <p><italic toggle="yes">Gradient-descent clustering</italic>. The final step in <italic toggle="yes">Mottle</italic> is to isolate the homologous fraction of alignments through clustering. This approach involves the estimation of two cluster centres, one for homologous alignments (homologous cluster) and one for non-homologous alignments (null cluster), within the three-dimensional space defined by Alignment Identity, indel Fraction, and True Identity statistics. For every alignment, a set of windowed statistics had been generated from during alignment processing, meaning that each alignment contains a distribution of these statistics. Similar to how we approximated runs of indel events with a geometric distributions, we approximate these alignment statistics with a Binomial distribution. Clustering using these statistics directly would be difficult, as the expected variance of Binomially distributed values greatly decreases when the probability approaches zero or one. To rectify this, we utilise the following variance stabilising transformation,
<disp-formula id="pone.0298834.e002"><alternatives><graphic xlink:href="pone.0298834.e002.jpg" id="pone.0298834.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where p is equal to the value of the statistic, and l is equal to the expected lower bound of the statistic, i.e. 0.25 for GC-corrected nucleic acid sequences and 0 for indels. We then define a normalised distance to each cluster centre as,
<disp-formula id="pone.0298834.e003"><alternatives><graphic xlink:href="pone.0298834.e003.jpg" id="pone.0298834.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">mean</italic><sub><italic toggle="yes">I</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">I</italic></sub> equal to the mean and variance of the windowed set of stabilised alignment identities. Similarly, <italic toggle="yes">mean</italic><sub><italic toggle="yes">D</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">D</italic></sub> are generated from the set of indel fractions and <italic toggle="yes">mean</italic><sub><italic toggle="yes">T</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">T</italic></sub> from estimated true identities. The centre of the null cluster is initialised so that its True Identity is equal to the expected proportion of matches if it was due to chance, i.e., -1 after the stabilising transformation. To initialise the Alignment Identity and indel fraction, we choose the values of the alignment with the mean True Identity closest to this value. The centre of the Homologous cluster is initialised to the values of the alignment at the 90<sup>th</sup> percentile of mean True Identities. Once initialised, the cluster centres are shifted via gradient descent, with exception of the True identity of the null cluster which always remains at the expected null value, to reduce normalised distances between alignments and centres. The loss function for this process is as follows,
<disp-formula id="pone.0298834.e004"><alternatives><graphic xlink:href="pone.0298834.e004.jpg" id="pone.0298834.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where dist is equal to the distance between the alignment <italic toggle="yes">i</italic> and the cluster centre <italic toggle="yes">j</italic>, N is equal to the total number of alignments, and S is equal to the number of clusters, which is set to two corresponding to the null and homologous clusters. Additionally, weight is defined as follows.
<disp-formula id="pone.0298834.e005"><alternatives><graphic xlink:href="pone.0298834.e005.jpg" id="pone.0298834.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></disp-formula>
where binpow and eps are program parameters. A BFGS optimiser [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>] is used to find the locations that give the minimum loss values. Alignments are then each assigned to the cluster with the closest centre. The final distance value, <italic toggle="yes">D</italic> returned by <italic toggle="yes">Mottle</italic> is obtained from the origin match proportion of alignments in the homology cluster, corrected for GC-content, and transformed to an estimate of substitution distance via the Jukes-Cantor (JC) model [<xref rid="pone.0298834.ref026" ref-type="bibr">26</xref>],
<disp-formula id="pone.0298834.e006"><alternatives><graphic xlink:href="pone.0298834.e006.jpg" id="pone.0298834.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">I</italic> being equal to mean true identity of the homologous cluster.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Mottle-map: Bespoke fragment mapping algorithm</title>
      <p>While <italic toggle="yes">Mottle</italic> may use any short-read mapper for fragment mapping, a bespoke algorithm was developed to ensure that each position in a sequence is mapped even at large divergences. <italic toggle="yes">Mottle-map</italic> achieves this by transforming each fragment to a high-dimensional embedding via the Fast Fourier Transform (FFT) and subsequently finding the nearest neighbour in the reciprocal sequence. This is similar to the approach <italic toggle="yes">Satsuma</italic> takes for synteny detection [<xref rid="pone.0298834.ref027" ref-type="bibr">27</xref>]. To allow the FFT transformation of fragments, their values must first be mapped to the complex number plane. For this we use the same embeddings as MAFFT [<xref rid="pone.0298834.ref028" ref-type="bibr">28</xref>], with each base placed at axis-aligned unit lengths and bonding pairs placed in opposite sides of the origin G → + 1, C → - 1, A → + i, T/U → - i. If each position in the fragment is treated as an embedding dimension, then two sequences that are more similar will have a smaller Euclidean distance between embedding, if there are no indels, that give a mid-sequence shift that would misalign the embedding. Shifting this embedding into frequency space via the FFT allows a Euclidean distance calculation while allowing for indels. Before transformation, we divide the real and imaginary axes by the mean of their absolute values, to correct for GC-content. Afterwards, the frequency embeddings are normalised to unit L<sub>2</sub>-norm. These steps can be represented mathematically as follows,
<disp-formula id="pone.0298834.e007"><alternatives><graphic xlink:href="pone.0298834.e007.jpg" id="pone.0298834.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where, E is the set of embedded nucleotides of a sequence, and L is the length of the sequence, and
<disp-formula id="pone.0298834.e008"><alternatives><graphic xlink:href="pone.0298834.e008.jpg" id="pone.0298834.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Where F is the set of values generated from GC-corrected embeddings after transformation by FFT, and L is the length of the transformed sequence. Since Euclidean distance between frequency embeddings can be used as a dissimilarity metric between fragments, a nearest-neighbour search can be used between two sets of embeddings to find similar fragments. Since <italic toggle="yes">Mottle-map</italic> is made for small and highly-divergent sequences, we use a simple many-to-many comparison where the distance between each embedding vector is computed. The top N nearest-neighbour mappings for each fragment in two fragment sets are returned by <italic toggle="yes">Mottle-map</italic>, where N is a parameter.</p>
    </sec>
    <sec id="sec008">
      <title>Implementation and availability</title>
      <p><italic toggle="yes">Mottle</italic> and <italic toggle="yes">Mottle-map</italic> are implemented in Python 3.9 and both are available at <ext-link xlink:href="https://github.com/tphoward/Mottle/_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle\_Repo</ext-link>. Gradient-Boosted Decision Trees are calculated by LightGBM [<xref rid="pone.0298834.ref029" ref-type="bibr">29</xref>], gradient-descent clustering by Tensorflow-probability [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>], and nearest neighbour search by Faiss [<xref rid="pone.0298834.ref031" ref-type="bibr">31</xref>]. Parameters used within testing were as follows, ntrees: 100, nleaves: 32, learn_rate: 0.1, subsamp: 1.0, binpow: 64, learn_mult: 0.001, reltol: 1.00E-20, maxiter: 100, binthres: 0.75, and prior_size: 10.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Results and discussion</title>
    <p>To evaluate the performance of <italic toggle="yes">Mottle</italic>, we run a set of benchmarks where exact or approximate relationships between sequences are known. We run <italic toggle="yes">Mottle</italic> with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper. As a comparison, we include four other programs that are used for substitution distance calculation—<italic toggle="yes">Co-phylog</italic> which utilises micro-alignments between sequences [<xref rid="pone.0298834.ref032" ref-type="bibr">32</xref>], <italic toggle="yes">Mash</italic> which calculates distances based on shared k-mers [<xref rid="pone.0298834.ref033" ref-type="bibr">33</xref>], <italic toggle="yes">Slope-SpaM</italic> that uses spaced-word matches [<xref rid="pone.0298834.ref034" ref-type="bibr">34</xref>], and <italic toggle="yes">Swipe</italic> that calculates Smith-Waterman local alignments between sequences, utilising scores based on Karlin-Altschul statistics [<xref rid="pone.0298834.ref035" ref-type="bibr">35</xref>]. For the programs that output identities or alignments, a JC model is used to convert to substitution distances. A summary of the results of all benchmark tests can be seen in <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>.</p>
    <table-wrap position="float" id="pone.0298834.t001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0298834.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Summary of benchmarking results.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="pone.0298834.t001" id="pone.0298834.t001g" position="float"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Tool Name</th>
              <th align="center" rowspan="1" colspan="1">Sub</th>
              <th align="center" rowspan="1" colspan="1">Rfam</th>
              <th align="center" rowspan="1" colspan="1">Gen-fam</th>
              <th align="center" rowspan="1" colspan="1">Fam-ord</th>
              <th align="center" rowspan="1" colspan="1">Ord-class</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Slope-spam</td>
              <td align="center" rowspan="1" colspan="1">0.52</td>
              <td align="center" rowspan="1" colspan="1">0.22</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.70</td>
              <td align="center" rowspan="1" colspan="1">0.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Co-Phylog</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
              <td align="center" rowspan="1" colspan="1">0.82</td>
              <td align="center" rowspan="1" colspan="1">0.38</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mash</td>
              <td align="center" rowspan="1" colspan="1">0.44</td>
              <td align="center" rowspan="1" colspan="1">0.18</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.98</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.85</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.70</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Swipe</td>
              <td align="center" rowspan="1" colspan="1">0.36</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.89</td>
              <td align="center" rowspan="1" colspan="1">0.69</td>
              <td align="center" rowspan="1" colspan="1">0.33</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">BWA-MEM2*</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.24</td>
              <td align="center" rowspan="1" colspan="1">0.94</td>
              <td align="center" rowspan="1" colspan="1">0.71</td>
              <td align="center" rowspan="1" colspan="1">0.61</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mottle(-map)</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.96</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.66</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.95</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.75</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>Sub: Maximum stable distance of each program when tested on a simple <italic toggle="yes">in silico</italic> sequence evolution benchmark (section, <italic toggle="yes">Simple sequence evolution</italic>). Rfam: Maximum stable distance on concatenated RNA family alignments (section, <italic toggle="yes">Known family alignments</italic>). Gen-fam, Fam-ord and Ord-class: Proportion of correctly assigned outgroup genomes when comparing genomes in the same Genus/Family, Family/Order and Order/Class respectively (section, <italic toggle="yes">Known genome taxonomies</italic>). Scores in bold represent the best performing program in a benchmark test. *Here, <italic toggle="yes">Mottle</italic> was executed with BWA-MEM2 as the mapping software.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec id="sec010">
      <title>Simple sequence evolution</title>
      <p>Our first goal was to test how well <italic toggle="yes">Mottle</italic> performed in comparison to other programs designed to calculate pairwise substitution distances, in the absence of confounding factors. Specifically, we tested programs against the Tobacco mosaic virus genome, with several substitutions introduced <italic toggle="yes">in silico</italic> to a set substitution distance and monitored their effectiveness at estimating this distance over increasing divergence. To do this, we used the genomic sequence of Tobacco mosaic virus (RefSeq accession NC_001367.1), and introduced a set number, <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub>, of random substitution events <italic toggle="yes">in silico</italic>, following <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub> = <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub>⋅<italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub>, with <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub> being equal to the size of the full sequence and <italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub> being the desired substitution distance. Multiple substitution events were allowed to occur at each site. We then ran each substitution distance program on the original and modified genomes to find a calculated distance. This was run for every 0.02 substitution per base-pair (sub/bp) distance between 0 and 1 inclusive, giving a total sample size of 51 sequences. To have a measure of when the outputs of a program begin to consistently diverge from the true distance, that is independent of the number of trials, we calculated a running Mean Absolute Error (MAE) from the true distance as,
<disp-formula id="pone.0298834.e009"><alternatives><graphic xlink:href="pone.0298834.e009.jpg" id="pone.0298834.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">error</italic> is the calculated MAE, <italic toggle="yes">T</italic><sub><italic toggle="yes">k</italic></sub> being equal to the target substitution distance of a specified trial, <italic toggle="yes">P</italic><sub><italic toggle="yes">k</italic></sub> the output of a substitution distance program within this trial, and <italic toggle="yes">N</italic> increasing with the number of trials completed. As a threshold, we use an MAE value of 0.05 sub/bp, where the furthest distance a program’s output is within the MAE threshold is its maximum stable distance. The results indicated that many of the tools struggled to calculate the true distance between 0.25 and 0.35 substitutions per nucleotide base (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Erratic behaviour was seen in many as they passed a critical threshold, set at 5% MAE from the true identity (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>). <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> however tended to significantly underestimate true distance past this point. Interestingly, the results for <italic toggle="yes">Mash</italic> were incredibly stable after much deviation from the true distance (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>). The results indicated that <italic toggle="yes">Mottle</italic>, implemented with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper, was able to accurately calculate the true distance over nearly all the sequence divergences tested, only reaching the 5% threshold towards the upper end of the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Noticeable but non-critical deviations were observed in <italic toggle="yes">BWA-MEM2</italic> and <italic toggle="yes">Mottle</italic> throughout the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>), such that a stricter threshold would have been surpassed at a lower divergence. The results for existing tools were surprising, and it was expected that they would perform reliably over a greater distance. It should be noted, however, that the divergence tested here (up to 1 substitution per base) would be considered high for many non-viral scenarios. These programs were not designed and tested with the high mutation rates observed in viruses in mind.</p>
      <fig position="float" id="pone.0298834.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a simple <italic toggle="yes">in silico</italic> substitution model of sequence evolution.</title>
          <p><bold>(a)</bold> Program predictions vs true distance between sequences. Values are clipped to the range [0,1]. Vertical lines indicate the maximum stable distance. <bold>(b)</bold> Mean value of the cumulative deviation of each tool from the true distance. The maximum tolerable deviation is set to 0.05 sub/bp. The point at which curves cross tolerable levels defines the maximum stable distance. Curves are cut whenever NaN values are produced.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Known family alignments</title>
      <p>Having established that <italic toggle="yes">Mottle</italic> could successfully be used to predict true distance over a large sequence divergence space–albeit in a simplified system—we next wanted to test <italic toggle="yes">Mottle</italic> against real viral sequences. However, it was important to maintain knowledge of the true distance between sequences. A database that allows us to do this is the RNA families (Rfam) database [<xref rid="pone.0298834.ref036" ref-type="bibr">36</xref>]. Rfam catalogues homologous RNA sequences as families and holds multiple sequence alignments of them. In addition, while a simple substitution model can give an upper bound on the maximum stable distance for each program, indels are a common feature in biological sequences, especially those of viruses. To test how well <italic toggle="yes">Mottle</italic> can handle indels, we endeavoured to create a benchmark that incorporates <italic toggle="yes">in vivo</italic> substitutions and indels, while allowing us to know the ground truth in terms of substitution distance and giving a large range of such distances. This benchmark therefore assesses <italic toggle="yes">Mottle</italic> against both real viral sequences and sequences containing indels. To do this, we extracted all pairwise alignments in each family where both sequences are of viral origin and calculated a JC distance from their identities. To increase the length of these alignments and make them more comparable to a small RNA viral genome, alignments of similar divergence were concatenated until they reach the size of a small viral genome (&gt;4 kb). For a given target distance, we find the alignment with the closest JC distance. We then calculate the current JC distance of the artificial genome, if below the target distance we add the closest alignment that is above the target distance and vice versa. This process is repeated without replacement until either the target length is reached, or we run out of valid candidate alignments. This created a more realistic dataset to test the six programs against. We run this benchmark on the same distances as previously (Simple sequence evolution, a total of 51 pairs of sequences with increasing substitution distance) and calculate MAEs in the same process.</p>
      <p>For all tools, predictive performance was degraded compared to the previous test (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3</xref>). For many programs, calculating distance was effective initially, but soon diverged from the true value. For most, distance was difficult to calculate beyond 0.25 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3A</xref>). <italic toggle="yes">Co-Phylog</italic>, <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> tended towards underestimating sequence divergence from the true distance past this point, while <italic toggle="yes">Slope-Spam</italic> and <italic toggle="yes">BWA-MEM2</italic> displayed more erratic behaviour. By contrast, <italic toggle="yes">Mottle</italic> was able to track the true distance for longer, deviating only when reaching approximately 0.66 substitutions per base. All programs, except <italic toggle="yes">Mottle</italic>, had crossed the 5% cumulative deviation threshold by 0.3 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). In contrast to <xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>, all programs displayed similar deviation at low divergences. Taken together with the previous test, we conclude that <italic toggle="yes">Mottle</italic> is an effective tool for predicting true distance between highly divergent sequences, as may be found within viral populations.</p>
      <fig position="float" id="pone.0298834.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a concatenated family alignment dataset.</title>
          <p>Formatted as Fig 2. <bold>(a)</bold> Program predictions vs true distance between sequences. <bold>(b)</bold> Mean cumulative deviation of each tool from the true distance.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Known genome taxonomies</title>
      <p>We next wished to test the performance of these programs in identifying the relationship between genomes in the known viral taxonomy. We assembled a test set of viral genomes composed of three different genomes at two different taxonomic ranks (i.e., genus, order, family, class), as defined by the International Committee on Taxonomy of Viruses [<xref rid="pone.0298834.ref037" ref-type="bibr">37</xref>]. We used this dataset to assess how well each tool could identify outgroup genomes as the taxonomic rankings were increased. Briefly, each program was required to calculate the distance between one reference genome and two others, one that shares a chosen taxonomic ranking (comparator) and another that only shares the rank above (outgroup, <xref rid="pone.0298834.g004" ref-type="fig">Fig 4A</xref>). A correct identification gives the outgroup a higher distance to the reference. To carry out this benchmark, we select reference, comparator, and outgroup genomes randomly from the e NCBI taxonomy database [<xref rid="pone.0298834.ref038" ref-type="bibr">38</xref>] that exhibit this rank structure. On these, we run each program twice—once to calculate reference/comparator distance and once for reference/outgroup. If the distance to the outgroup is larger than to the comparator, this is recorded as a correct output, if smaller then incorrect, and if the output is the same for both then it is recorded as ambiguous. Some programs return NaN values or error codes if they are unable to find any homologous sites to calculate a distance from. In this case, the values are recorded as the maximal distance, which we store as infinity, and carry out the comparisons as before. The rank comparisons we used were Genus-Family, Family-Order, Order-Class. A total of 100 pairs of sequences were used within each rank of comparison.</p>
      <fig position="float" id="pone.0298834.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools for identifying taxonomic outgroup genomes.</title>
          <p><bold>(a)</bold> Taxonomic relationship between query, comparator and outgroup genomes. <bold>(b)</bold> Proportion of assignments that were correct (outgroup more distant than comparator genome), incorrect (outgroup less distant), or ambiguous (identical distances) for each tool when comparing genomes in the same Genus or same Family, in the same Family or same Order, and in the same Order or same Class, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g004" position="float"/>
      </fig>
      <p>Unsurprisingly, most of the programs were able to identify which genome shared the same Genus as the other, and which were only in the same Family (<xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>). <italic toggle="yes">Mash</italic> performed the best under these conditions, followed by <italic toggle="yes">Mottle</italic> and then <italic toggle="yes">BWA-MEM2</italic>. <italic toggle="yes">Co-Phylog</italic>, which was created with the genomes of cellular organisms in mind, did return several ambiguous results, perhaps a result of the instability of the output, even at low divergence, as seen in <xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>. In the next test, the reference genome was compared to genomes in the same Family or Order. Here, all programs performed less well than in the previous test, with <italic toggle="yes">Mottle</italic> performing the best, followed by <italic toggle="yes">Mash</italic> and then <italic toggle="yes">Swipe</italic>. Again, <italic toggle="yes">Co-Phylog</italic> struggled to unambiguously place genomes correctly at this taxonomic distance. In the final test, the reference genome was compared with ones sharing an Order and Class. This test was far more challenging. Once again, <italic toggle="yes">Mash</italic>, <italic toggle="yes">Mottle</italic> and <italic toggle="yes">BWA-MEM2</italic> were the most effective, showing mainly correct placements with few ambiguous results. The other tools demonstrated high levels of ambiguity in this challenge, being unable to find any regions of homology to calculate a stable distance. <italic toggle="yes">Mottle</italic>, <italic toggle="yes">Mash</italic> and <italic toggle="yes">BWA-MEM2</italic> are therefore useful tools for placing test genomes within known taxonomies, even at large taxonomic distances.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Conclusions</title>
    <p>Pairwise substitution distance has a wide set of applications, from building phylogenies to creating reduced databases. Finding a novel approach in this field can find utilisations in any of these areas, giving opportunities for further refinement specific to certain applications. <italic toggle="yes">Mottle</italic> represents an additional tool in this endeavour. It performs as well as existing programs in correctly identifying taxonomic relationships but comes with the added advantage of provided an accurate numerical estimation of genomic distance over a greater sequence divergence. A limitation of its use, though, is a reduced numerical accuracy, compared to alternative approaches, at low divergences on genomes that behave similarly to a simple substitution model, i.e., where insertions and deletions are uncommon. <italic toggle="yes">Mottle</italic> may therefore be of particular interest to the study of viruses, viral relationships, and viral discovery platforms, where available sequences for reference may be sparse, sequence diversity is high, and insertions/deletions occur at a high rate. The algorithms behind <italic toggle="yes">Mottle</italic> can be applied using any Short-Read mapper, Gradient-Boosted Decision Tree generator, Gradient-Descent software, and Nearest-Neighbour finder. This means that any advancements in such software would give increased efficiency or accuracy to new implementations. Further extensions to the algorithm could include support for amino acid input, simultaneous multiple sequence distance calculation and isolating sub-alignments of continuous homology. In conclusion, <italic toggle="yes">Mottle</italic> is an invaluable, novel approach in substitution distance estimation, with significant performance benefits compared to other algorithms.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0298834.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Zaharias</surname><given-names>P</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>Recent progress on methods for estimating and updating large phylogenies</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2022</year>;<volume>377</volume>: <fpage>20210244</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.2021.0244</pub-id><?supplied-pmid 35989607?><pub-id pub-id-type="pmid">35989607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>M</given-names></name>, <name><surname>Delwart</surname><given-names>E</given-names></name>, <name><surname>Rosario</surname><given-names>K</given-names></name>, <name><surname>Segales</surname><given-names>J</given-names></name>, <name><surname>Varsani</surname><given-names>A</given-names></name>, <name><surname>Ictv Report</surname><given-names>C</given-names></name>. <article-title>ICTV Virus Taxonomy Profile: Circoviridae</article-title>. <source>J Gen Virol</source>. <year>2017</year>;<volume>98</volume>: <fpage>1997</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1099/jgv.0.000871</pub-id><?supplied-pmid 28786778?><pub-id pub-id-type="pmid">28786778</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Su</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>. <article-title>Sketch distance-based clustering of chromosomes for large genome database compression</article-title>. <source>BMC Genomics</source>. <year>2019</year>;<volume>20</volume>: <fpage>978</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-019-6310-0</pub-id><?supplied-pmid 31888458?><pub-id pub-id-type="pmid">31888458</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Krishnamurthy</surname><given-names>SR</given-names></name>, <name><surname>Wang</surname><given-names>D</given-names></name>. <article-title>Origins and challenges of viral dark matter</article-title>. <source>Virus Res</source>. <year>2017</year>;<volume>239</volume>: <fpage>136</fpage>–<lpage>42</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.virusres.2017.02.002</pub-id><?supplied-pmid 28192164?><pub-id pub-id-type="pmid">28192164</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zielezinski</surname><given-names>A</given-names></name>, <name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>Bernard</surname><given-names>G</given-names></name>, <name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Tang</surname><given-names>K</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>144</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id><?supplied-pmid 31345254?><pub-id pub-id-type="pmid">31345254</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>DN</given-names></name>, <name><surname>Langmead</surname><given-names>B</given-names></name>. <article-title>Dashing: fast and accurate genomic distances with HyperLogLog</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>265</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1875-0</pub-id><?supplied-pmid 31801633?><pub-id pub-id-type="pmid">31801633</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Dorrer</surname><given-names>S</given-names></name>, <name><surname>Gerth</surname><given-names>M</given-names></name>, <name><surname>Bleidorn</surname><given-names>C</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Prot-SpaM: fast alignment-free phylogeny reconstruction based on whole-proteome sequences</article-title>. Gigascience. <year>2019</year>;<fpage>8</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giy148</pub-id><?supplied-pmid 30535314?><pub-id pub-id-type="pmid">30535314</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>X.</given-names></name><article-title>BinDash, software for fast genome distance estimation on a typical personal laptop</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>671</fpage>–<lpage>3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty651</pub-id><?supplied-pmid 30052763?><pub-id pub-id-type="pmid">30052763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Klotzl</surname><given-names>F</given-names></name>, <name><surname>Haubold</surname><given-names>B</given-names></name>. <article-title>Phylonium: fast estimation of evolutionary distances from large samples of similar genomes</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>: <fpage>2040</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz903</pub-id><?supplied-pmid 31790149?><pub-id pub-id-type="pmid">31790149</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>James</surname><given-names>BT</given-names></name>, <name><surname>Luczak</surname><given-names>BB</given-names></name>. <article-title>Identity: rapid alignment-free prediction of sequence alignment identity scores using self-supervised general linear models</article-title>. <source>NAR Genom Bioinform</source>. <year>2021</year>;<volume>3</volume>: <fpage>lqab001</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nargab/lqab001</pub-id><?supplied-pmid 33554117?><pub-id pub-id-type="pmid">33554117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Uddin</surname><given-names>M</given-names></name>, <name><surname>Islam</surname><given-names>MK</given-names></name>, <name><surname>Hassan</surname><given-names>MR</given-names></name>, <name><surname>Jahan</surname><given-names>F</given-names></name>, <name><surname>Baek</surname><given-names>JH</given-names></name>. <article-title>A fast and efficient algorithm for DNA sequence similarity identification</article-title>. <source>Complex Intell Systems</source>. <year>2023</year>;<volume>9</volume>: <fpage>1265</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40747-022-00846-y</pub-id><?supplied-pmid 36035628?><pub-id pub-id-type="pmid">36035628</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Duffy</surname><given-names>S</given-names></name>, <name><surname>Shackelton</surname><given-names>LA</given-names></name>, <name><surname>Holmes</surname><given-names>EC</given-names></name>. <article-title>Rates of evolutionary change in viruses: patterns and determinants</article-title>. <source>Nat Rev Genet</source>. <year>2008</year>;<volume>9</volume>: <fpage>267</fpage>–<lpage>76</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2323</pub-id><?supplied-pmid 18319742?><pub-id pub-id-type="pmid">18319742</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Santiago-Rodriguez</surname><given-names>TM</given-names></name>, <name><surname>Hollister</surname><given-names>EB</given-names></name>. <article-title>Unraveling the viral dark matter through viral metagenomics.</article-title><source>Front Immunol</source>. <year>2022</year>;<volume>13</volume>: <fpage>1005107</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fimmu.2022.1005107</pub-id><?supplied-pmid 36189246?><pub-id pub-id-type="pmid">36189246</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sanjuan</surname><given-names>R</given-names></name>, <name><surname>Nebot</surname><given-names>MR</given-names></name>, <name><surname>Chirico</surname><given-names>N</given-names></name>, <name><surname>Mansky</surname><given-names>LM</given-names></name>, <name><surname>Belshaw</surname><given-names>R</given-names></name>. <article-title>Viral mutation rates</article-title>. <source>J Virol</source>. <year>2010</year>;<volume>84</volume>: <fpage>9733</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JVI.00694-10</pub-id><?supplied-pmid 20660197?><pub-id pub-id-type="pmid">20660197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <name><surname>Dolja</surname><given-names>VV</given-names></name>. <article-title>The global virome: How much diversity and how many independent origins</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>40</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16207</pub-id><?supplied-pmid 36097140?><pub-id pub-id-type="pmid">36097140</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Dominguez-Huerta</surname><given-names>G</given-names></name>, <name><surname>Wainaina</surname><given-names>JM</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Culley</surname><given-names>AI</given-names></name>, <name><surname>Kuhn</surname><given-names>JH</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>The RNA virosphere: How big and diverse is it</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>209</fpage>–<lpage>15</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16312</pub-id><?supplied-pmid 36511833?><pub-id pub-id-type="pmid">36511833</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Neri</surname><given-names>U</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Camargo</surname><given-names>AP</given-names></name>, <name><surname>Lee</surname><given-names>B</given-names></name>, <name><surname>Kazlauskas</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Expansion of the global RNA virome reveals diverse clades of bacteriophages</article-title>. <source>Cell</source>. <year>2022</year>;<volume>185</volume>: <fpage>4023</fpage>–<lpage>37 e18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2022.08.023</pub-id><?supplied-pmid 36174579?><pub-id pub-id-type="pmid">36174579</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Accurate multiple alignment of distantly related genome sequences using filtered spaced word matches as anchor points</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>211</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty592</pub-id><?supplied-pmid 29992260?><pub-id pub-id-type="pmid">29992260</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Hachiya</surname><given-names>T</given-names></name>, <name><surname>Osana</surname><given-names>Y</given-names></name>, <name><surname>Popendorf</surname><given-names>K</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name>. <article-title>Accurate identification of orthologous segments among multiple genomes</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>853</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp070</pub-id><?supplied-pmid 19188192?><pub-id pub-id-type="pmid">19188192</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Criscuolo</surname><given-names>A.</given-names></name><article-title>On the transformation of MinHash-based uncorrected distances into proper evolutionary distances for phylogenetic inference.</article-title><source>F1000Res</source>. <year>2020</year>;<volume>9</volume>: <fpage>1309</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.26930.1</pub-id><?supplied-pmid 33335719?><pub-id pub-id-type="pmid">33335719</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Haubold</surname><given-names>B</given-names></name>, <name><surname>Pfaffelhuber</surname><given-names>P</given-names></name>, <name><surname>Domazet-Loso</surname><given-names>M</given-names></name>, <name><surname>Wiehe</surname><given-names>T</given-names></name>. <article-title>Estimating mutation distances from unaligned genomes</article-title>. <source>J Comput Biol</source>. <year>2009</year>;<volume>16</volume>: <fpage>1487</fpage>–<lpage>500</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2009.0106</pub-id><?supplied-pmid 19803738?><pub-id pub-id-type="pmid">19803738</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Kmacs: the k-mismatch average common substring approach to alignment-free sequence comparison</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>2000</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu331</pub-id><?supplied-pmid 24828656?><pub-id pub-id-type="pmid">24828656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Genco</surname><given-names>RJ</given-names></name>, <name><surname>Wactawski-Wende</surname><given-names>J</given-names></name>, <name><surname>Buck</surname><given-names>M</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>. <article-title>SENSE: Siamese neural network for sequence embedding and alignment-free comparison</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>1820</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty887</pub-id><?supplied-pmid 30346493?><pub-id pub-id-type="pmid">30346493</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Moshiri</surname><given-names>N</given-names></name>, <name><surname>Robinson</surname><given-names>P</given-names></name>. <article-title>ViralMSA: massively scalable reference-guided multiple sequence alignment of viral genomes</article-title>. <source>Bioinformatics</source>. <year>2021</year>;<volume>37</volume>: <fpage>714</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa743</pub-id><?supplied-pmid 32814953?><pub-id pub-id-type="pmid">32814953</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bertels</surname><given-names>F</given-names></name>, <name><surname>Silander</surname><given-names>OK</given-names></name>, <name><surname>Pachkov</surname><given-names>M</given-names></name>, <name><surname>Rainey</surname><given-names>PB</given-names></name>, <name><surname>van Nimwegen</surname><given-names>E</given-names></name>. <article-title>Automated reconstruction of whole-genome phylogenies from short-sequence reads</article-title>. <source>Mol Biol Evol</source>. <year>2014</year>;<volume>31</volume>: <fpage>1077</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msu088</pub-id><?supplied-pmid 24600054?><pub-id pub-id-type="pmid">24600054</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Jukes</surname><given-names>TH</given-names></name>, <name><surname>Cantor</surname><given-names>CR</given-names></name>. <part-title>Evolution of Protein Molecules</part-title>. In: <name><surname>Munro</surname><given-names>HN</given-names></name>, editor. <source>Mammalian Protein Metabolism</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1969</year>. p. <fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Grabherr</surname><given-names>MG</given-names></name>, <name><surname>Russell</surname><given-names>P</given-names></name>, <name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Mauceli</surname><given-names>E</given-names></name>, <name><surname>Alfoldi</surname><given-names>J</given-names></name>, <name><surname>Di Palma</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide synteny through highly sensitive sequence alignment: Satsuma</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>1145</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btq102</pub-id><?supplied-pmid 20208069?><pub-id pub-id-type="pmid">20208069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Rozewicki</surname><given-names>J</given-names></name>, <name><surname>Yamada</surname><given-names>KD</given-names></name>. <article-title>MAFFT online service: multiple sequence alignment, interactive sequence choice and visualization</article-title>. <source>Brief Bioinform</source>. <year>2019</year>;<volume>20</volume>: <fpage>1160</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx108</pub-id><?supplied-pmid 28968734?><pub-id pub-id-type="pmid">28968734</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Ke</surname><given-names>G</given-names></name>, <name><surname>Meng</surname><given-names>Q</given-names></name>, <name><surname>Finley</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Ma</surname><given-names>W</given-names></name>, <etal>et al</etal>., Eds. <name><surname>von Luxburg</surname><given-names>U</given-names></name>, <name><surname>Guyon</surname><given-names>I</given-names></name>, <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <part-title>Fergus R LightGBM: a highly efficient gradient boosting decision tree.</part-title><source>Proceedings of the 31st International Conference on Neural Information Processing Systems</source>; <year>2017</year>; <publisher-loc>Long Beach, California, USA</publisher-loc>: <publisher-name>Curran Associates Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>M</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Barham</surname><given-names>P</given-names></name>, <name><surname>Brevdo</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>TensorFlow: Large-Scale Machine Learning on Heterogeneous Distributed Systems</article-title>. <year>2015</year>. <source>Software available from tensorflow.org</source>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Douze</surname><given-names>M</given-names></name>, <name><surname>Jegou</surname><given-names>H</given-names></name>. <article-title>Billion-Scale Similarity Search with GPUs</article-title>. <source>IEEE Transactions on Big Data</source>. <year>2021</year>;<volume>7</volume>: <fpage>535</fpage>–<lpage>47</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tbdata.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Yi</surname><given-names>H</given-names></name>, <name><surname>Jin</surname><given-names>L</given-names></name>. <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>e75</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkt003</pub-id><?supplied-pmid 23335788?><pub-id pub-id-type="pmid">23335788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ondov</surname><given-names>BD</given-names></name>, <name><surname>Treangen</surname><given-names>TJ</given-names></name>, <name><surname>Melsted</surname><given-names>P</given-names></name>, <name><surname>Mallonee</surname><given-names>AB</given-names></name>, <name><surname>Bergman</surname><given-names>NH</given-names></name>, <name><surname>Koren</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>132</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id><?supplied-pmid 27323842?><pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Rohling</surname><given-names>S</given-names></name>, <name><surname>Linne</surname><given-names>A</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Hosseini</surname><given-names>M</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>The number of k-mer matches between two DNA sequences as a function of k and applications to estimate phylogenetic distances</article-title>. <source>PLoS One</source>. <year>2020</year>;<volume>15</volume>: <fpage>e0228070</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0228070</pub-id><?supplied-pmid 32040534?><pub-id pub-id-type="pmid">32040534</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rognes</surname><given-names>T.</given-names></name><article-title>Faster Smith-Waterman database searches with inter-sequence SIMD parallelisation</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>: <fpage>221</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-221</pub-id><?supplied-pmid 21631914?><pub-id pub-id-type="pmid">21631914</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kalvari</surname><given-names>I</given-names></name>, <name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Ontiveros-Palacios</surname><given-names>N</given-names></name>, <name><surname>Argasinska</surname><given-names>J</given-names></name>, <name><surname>Lamkiewicz</surname><given-names>K</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>. <source>Nucleic Acids Res</source>. <year>2021</year>;<volume>49</volume>: <fpage>D192</fpage>–<lpage>D200</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id><?supplied-pmid 33211869?><pub-id pub-id-type="pmid">33211869</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lefkowitz</surname><given-names>EJ</given-names></name>, <name><surname>Dempsey</surname><given-names>DM</given-names></name>, <name><surname>Hendrickson</surname><given-names>RC</given-names></name>, <name><surname>Orton</surname><given-names>RJ</given-names></name>, <name><surname>Siddell</surname><given-names>SG</given-names></name>, <name><surname>Smith</surname><given-names>DB</given-names></name>. <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV).</article-title><source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>: <fpage>D708</fpage>–<lpage>D17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id><?supplied-pmid 29040670?><pub-id pub-id-type="pmid">29040670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Federhen</surname><given-names>S.</given-names></name><article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>: <fpage>D136</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><?supplied-pmid 22139910?><pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10956839</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0298834</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-23-29038</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Nucleotide Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Nucleotide Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mottle: Accurate pairwise substitution distance at high divergence through the exploitation of short-read mappers and gradient descent</article-title>
      <alt-title alt-title-type="running-head">Mottle: Calculating pairwise substitution distances</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Prusokiene</surname>
          <given-names>Alisa</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boonham</surname>
          <given-names>Neil</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fox</surname>
          <given-names>Adrian</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5546-4043</contrib-id>
        <name>
          <surname>Howard</surname>
          <given-names>Thomas P.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Faculty of Science, Agriculture and Engineering, School of Natural and Environmental Sciences, Newcastle University, United Kingdom</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Fera Ltd., Biotech Campus, York, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mapder</surname>
          <given-names>Tarunendu</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Bristol-Myers Squibb Company, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Thomas.Howard@newcastle.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>19</volume>
    <issue>3</issue>
    <elocation-id>e0298834</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Prusokiene et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Prusokiene et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0298834.pdf"/>
    <abstract>
      <p>Current tools for estimating the substitution distance between two related sequences struggle to remain accurate at a high divergence. Difficulties at distant homologies, such as false seeding and over-alignment, create a high barrier for the development of a stable estimator. This is especially true for viral genomes, which carry a high rate of mutation, small size, and sparse taxonomy. Developing an accurate substitution distance measure would help to elucidate the relationship between highly divergent sequences, interrogate their evolutionary history, and better facilitate the discovery of new viral genomes. To tackle these problems, we propose an approach that uses short-read mappers to create whole-genome maps, and gradient descent to isolate the homologous fraction and calculate the final distance value. We implement this approach as <italic toggle="yes">Mottle</italic>. With the use of simulated and biological sequences, <italic toggle="yes">Mottle</italic> was able to remain stable to 0.66–0.96 substitutions per base pair and identify viral outgroup genomes with 95% accuracy at the family-order level. Our results indicate that <italic toggle="yes">Mottle</italic> performs as well as existing programs in identifying taxonomic relationships, with more accurate numerical estimation of genomic distance over greater divergences. By contrast, one limitation is a reduced numerical accuracy at low divergences, and on genomes where insertions and deletions are uncommon, when compared to alternative approaches. We propose that <italic toggle="yes">Mottle</italic> may therefore be of particular interest in the study of viruses, viral relationships, and notably for viral discovery platforms, helping in benchmarking of homology search tools and defining the limits of taxonomic classification methods. The code for Mottle is available at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme</institution>
        </funding-source>
        <award-id>2144113</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Fera Science Ltd.</institution>
        </funding-source>
        <award-id>CASE Partner</award-id>
      </award-group>
      <funding-statement>This work has been supported by the BBSRC Newcastle-Liverpool-Durham DTP (Doctoral Training Partnership) scheme (reference 2144113), with Fera Science Ltd. as the CASE partner. There was no additional external funding received for this study.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data supporting the benchmarking of comparator tools alongside Mottle in a series of performance tests is accessible from the NCL data repository at <ext-link xlink:href="https://doi.org/10.25405/data.ncl.24808263" ext-link-type="uri">https://doi.org/10.25405/data.ncl.24808263</ext-link>. Additionally, the code for Mottle can be found on Github at <ext-link xlink:href="https://github.com/tphoward/Mottle_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle_Repo</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Pairwise nucleotide substitution distance is widely used in bioinformatic analyses. Pairwise comparisons within collections of genomes are commonly integrated to establish phylogenies, providing insight into their shared evolutionary history. They are similarly used to position novel genomes within an established phylogeny [<xref rid="pone.0298834.ref001" ref-type="bibr">1</xref>]. Substitution distances can also be converted to genome-wide percentage identity to define taxonomic demarcations, such as the distance a novel genome must be from known genomes to establish it as a new species [<xref rid="pone.0298834.ref002" ref-type="bibr">2</xref>]. Comparing the distances of discrete genetic molecules such as chromosomes, plasmids, plastids, and segments can find differences in their evolutionary histories, elucidating how genetic material has been exchanged between organisms or populations. Finding the most distinct or representative sequences in a set is used to create a compressed database for homology search and taxonomic classification [<xref rid="pone.0298834.ref003" ref-type="bibr">3</xref>]. A high substitution distance can however be a large barrier for sequence discovery [<xref rid="pone.0298834.ref004" ref-type="bibr">4</xref>]. Being able to accurately define this distance allows improved benchmarking of homology search and taxonomic classification tools to find their limits, allowing accurate estimates of what may pass through the silicon sieve of <italic toggle="yes">de novo</italic> sequencing-based discovery and diagnostics.</p>
    <p>Despite the considerable number of approaches available for pairwise genome comparison [<xref rid="pone.0298834.ref005" ref-type="bibr">5</xref>], many do not produce a biologically relevant substitution distance, and from those that do, there are few that are suitable for highly divergent sequences, i.e., those that have had many substitutions per site between them. This is for two main reasons–work has focused on creating faster and more efficient tools that work well at low divergences [<xref rid="pone.0298834.ref006" ref-type="bibr">6</xref>–<xref rid="pone.0298834.ref011" ref-type="bibr">11</xref>], combined with the inherent difficulties found when making comparisons at high divergences. The largest of these difficulties are false seeding and over-alignment. Seeding is the process of finding small sub-sequences, often in the tens of bases, that are identical or near identical in two sequences and can be extended to larger regions of homology. Finding seeds at non-homologous locations, i.e., false seeding, may add regions that otherwise have little similarity into the distance calculation, artificially inflating it. At low divergences a large seed size may be used as there would be few mutations between homologous regions. At increasing divergence, a smaller seed size is needed to find such regions, generating many seeding locations that are spurious, eventually overwhelming the limited number of truly homologous seed sites. Finding seed locations that have true homology while avoiding or removing false ones becomes a critical task at distant homologies. While false seeding can make sequences appear more divergent than they truly are, over-alignment can make them appear more similar. Alignment is usually done after seeding, inserting gaps into either sequence to match up homologous nucleotides that were shifted due to insertions and deletions (indels). This presents the danger of over-correcting for indels, falsely pairing matching nucleotides that are non-homologous, such as mistaking adjacent substitution events for an insertion, and therefore not contributing to the substitution distance. Avoiding over-alignment while still correctly aligning regions can be difficult at a low divergence, but at a high divergence, where multiple different mutation events may have occurred at the same nucleotide position, it may not be possible.</p>
    <p>These difficulties appear especially often when studying viral genomes, due to their high rate of mutation, small size, lack of universal marker genes, and the low proportion of known viruses [<xref rid="pone.0298834.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0298834.ref013" ref-type="bibr">13</xref>]. Viral replication machinery, especially those of single-stranded RNA based viruses, are known to introduce many substitutions every generation. Combined with a short generation time, these viruses can quickly diverge from their progenitor genome. Additionally, the ratio of indel event to substitution events is extremely high in these genomes [<xref rid="pone.0298834.ref014" ref-type="bibr">14</xref>], which makes finding true seeds more difficult and over-alignment more likely. The usually small size of viral genomes further reduces the number of possible seeding sites. Finally, the number of viral species that have been documented is a small proportion of the total estimated number of viral species [<xref rid="pone.0298834.ref015" ref-type="bibr">15</xref>], with estimates of the proportion of characterised orthornaviran RNA viruses being estimated as low as 0.006% [<xref rid="pone.0298834.ref016" ref-type="bibr">16</xref>], and environmental sampling projects discovering many previously unobserved viral genomes with each sequencing experiment [<xref rid="pone.0298834.ref017" ref-type="bibr">17</xref>]. The effect of sparse taxonomic coverage is that many viral genomes are highly diverged from any known viruses, making it difficult to study their relationship to other viruses. To this end, viral genome analysis is the field that may benefit the most from improvements in pairwise sequence distance accuracy at high divergences.</p>
    <p>In the face of these difficulties, current tools attempt to alleviate parts of the false seeding or over-alignment problems: some programs attempt to find non-exact matches for seeding, finding longer seeds which are more likely to be true seeds [<xref rid="pone.0298834.ref018" ref-type="bibr">18</xref>]. Others, such as Hachiya et al. [<xref rid="pone.0298834.ref019" ref-type="bibr">19</xref>], have sophisticated algorithms for distinguishing between true and false seeds. Programs that do not use any alignment step, known as alignment-free programs, are able to completely avoid the problem of over-alignment, instead using statistical information from across a sequence that is correlated to substitution distance–e.g., proportion of shared k-mers [<xref rid="pone.0298834.ref020" ref-type="bibr">20</xref>], shortest unique substrings [<xref rid="pone.0298834.ref021" ref-type="bibr">21</xref>], average common substring [<xref rid="pone.0298834.ref022" ref-type="bibr">22</xref>], or sequence embeddings [<xref rid="pone.0298834.ref023" ref-type="bibr">23</xref>]. This creates a separate issue–as sequence divergences increase, the correlation between these global statistical data and the local nucleotide substitutions they estimate can become increasingly decoupled. A new approach is needed, one which creates high-quality seeds and avoids over-alignment while incorporating direct nucleotide-level information.</p>
    <p>Short-read mappers (henceforth referred to as mappers) are tools used to map short sequence fragments of ~50-300bp, produced from High Throughput Sequencing runs, to reference genomes. These mappers already employ sophisticated seeding algorithms, give many parameters to tune mapping sensitivity, can use arbitrary queries and references, and are designed to handle thousands to millions of fragments. Sequence fragments created <italic toggle="yes">in silico</italic> can therefore be used as inputs to these mappers, finding the optimal homologous location for each fragment on another sequence, and allowing downstream processing to calculate substitution distance. This approach of running mappers on <italic toggle="yes">in silico</italic> fragments has been successfully utilised in other bioinformatic applications–for generating multiple sequence alignments in <italic toggle="yes">ViralMSA</italic> [<xref rid="pone.0298834.ref024" ref-type="bibr">24</xref>], and for constructing phylogenies in <italic toggle="yes">REALPHY</italic> [<xref rid="pone.0298834.ref025" ref-type="bibr">25</xref>]. In this paper we explore the application of these mappers for estimating pairwise nucleotide substitution distance, how careful use of their outputs can avoid false seeding and over-alignment and describe the implementation of <italic toggle="yes">Mottle</italic>—a tool for more accurate distance calculation between two highly divergent sequences. The tests carried out within this paper are based on consensus sequences of full viral genomes or RNA family sequences, but Mottle can be applied to any pair of DNA or RNA sequence files to give an estimated substitution distance.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <p><italic toggle="yes">Mottle</italic> takes two arbitrary nucleotide sequences of unknown relation, and outputs an estimated substitution distance between them. This can make use of any mapping software that aligns short fragments to larger sequences. Additionally, we have implemented a bespoke fragment mapping algorithm for this process, <italic toggle="yes">Mottle-map</italic>, which guarantees that each fragment is mapped but is not scalable to large sequences. Both algorithms are described in the subsections below.</p>
    <sec id="sec003">
      <title>Mottle: Calculating pairwise sequence distance from mapped fragments</title>
      <p>The main <italic toggle="yes">Mottle</italic> program can be split into three stages–fragment generation, alignment processing, and alignment clustering, presented in <xref rid="pone.0298834.g001" ref-type="fig">Fig 1A</xref> to c respectively and described in the following sections. Briefly, for each position, <italic toggle="yes">p</italic>, in query genome, Q, we set the nucleotide at that position, Q<sub><italic toggle="yes">p</italic></sub>, as the origin nucleotide. The set of flanking regions either side, Q<sub>[<italic toggle="yes">p+</italic>1..<italic toggle="yes">p</italic>+n]</sub> and Q<sub>[<italic toggle="yes">p-1</italic>..<italic toggle="yes">p</italic>-n</sub>] for a specified flank size <italic toggle="yes">n</italic>, of each origin nucleotide are mapped using a short-read mapper to a similar set of flanking regions in the target genome. For each mapping, we calculate flank alignments, and gather a set of statistics: the alignment identity, the indel rate of the alignment, and a binary value representing whether the corresponding origin nucleotides match or mismatch. We represent mappings as points defined by identity and indel statistics, labelled by match state, from which we can calculate a match probability that acts as an estimator for true identity without alignment bias. These points are clustered into two sets to separate homologous mappings from spurious ones, and genomic distance is estimated from the homologous set.</p>
      <fig position="float" id="pone.0298834.g001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">Mottle</italic>’s sequence distance estimation algorithm.</title>
          <p><bold>(a)</bold> Generating fragment alignments from input sequences. Each sequence is fragmented <italic toggle="yes">in silico</italic>. The origin nucleotide is excluded from each fragment sequence. Fragments are mapped onto the reciprocal sequence via a mapper, with each mapped fragment’s origin being paired. Origin pairs carry a binary state (match or mismatch). Fragment sequences are then fully aligned. <bold>(b) Truncating</bold> alignments on identity change. For each alignment, a sliding window calculates percentage identity. If a window’s identity diverges from the initial window’s, all nucleotides from that point onwards are discarded. <bold>(c)</bold> Fragment clustering and substitution distance estimation. For each alignment, identity and indel percentage statistics are calculated. These are fed into a Gradient Boosted Decision Tree (GBDT), which is trained to predict origin pair match state. This gives a predicted match probability on each alignment that can be interpreted as a bias-free identity. These three statistics are used for gradient-descent clustering, to find a cluster of alignments that were generated due to shared homology, and a cluster for those due to chance. Once both fractions are obtained, a mean origin identity is calculated for the homology cluster, which is used to derive the final substitution distance between the two sequences.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g001" position="float"/>
      </fig>
      <sec id="sec004">
        <title>(a) Fragment generation</title>
        <p><italic toggle="yes">Flank fragmentation</italic>. Each sequence can be separated into a discrete set of subsequences, each defined by a unique combination of origin nucleotide, subsequence size, and relative orientation. Each nucleotide in the full-length sequence can act as an origin—the first nucleotide of a subsequence—of multiple subsequences. But the possible sizes and relative orientations of these subsequences are restricted depending on the origin nucleotide’s location. If subsequence size is kept fixed, each nucleotide is an origin for up to two subsequences, for each of the forward and reverse complement orientations. The portion of each subsequence that does not contain the origin nucleotide is termed a fragment, and the two possible fragments for each origin are termed the forward and reverse flank fragments of the origin. Considering the origin nucleotide separately from the fragments is integral in estimating true identity in the later stages of the algorithm.</p>
        <p><italic toggle="yes">Reciprocal fragment mapping</italic>. This step takes the two full-length input sequences, their generated fragments, and a mapper program, to create a mapping between each fragment and a homologous area in the sequence of comparison. To allow the use of a variety of mapping algorithms, there are multiple modes of input depending on what the mapper accepts–sequence and fragments, fragments and fragments, or sequence and sequence. The mappings are done reciprocally–one sequence is used as the query with the other acting as the reference, and vice versa. The output of a mapper is a series of possibly homologous regions between the two inputs. This must either contain fragment names or sequence locations to allow identification of origin nucleotide, query location, and mapped location for each region. In cases where a mapper returns multiple regions for a query, all mapping is kept. The mapped region sequence pairs and corresponding origin nucleotides are extracted for use in later steps.</p>
        <p><italic toggle="yes">Mapped region alignment</italic>. While some mappers output a full alignment between mapped regions, many do not. To get consistent and well-defined alignments, Needleman-Wunsch global alignment is carried out between region sequences independent of mapper. This is because a representative region of homology adjacent to the origin nucleotide is desired, which Needleman-Wunsch global alignment maximises. Aligned regions that contain gaps in the first N bases are discarded, where N is a parameter of <italic toggle="yes">Mottle</italic>, as these gaps may shift the aligned region of homology and therefore the origin nucleotide.</p>
      </sec>
      <sec id="sec005">
        <title>(b) Alignment processing</title>
        <p><italic toggle="yes">Alignment truncation</italic>. Not all alignments will contain a consistent homology throughout. Some may begin with a high degree of similarity, but with a genomic rearrangement or large indel creating a discontinuity that suddenly reduces similarity. This non-homologous section would change alignment properties, adding noise to statistics calculations, and confounding downstream clustering. To remove these discontinuities, a sliding window is moved through the alignment. The length and identity, the proportion of aligned nucleotides that match, of the first window is used to estimate a binomial distribution for match/mismatch states. Where a later window’s identity is above or below that which would be expected by chance of this distribution, the alignment is clipped, discarding proceeding nucleotides. Clipped alignment shorter than a minimum size are additionally discarded. The window size, two-tailed binomial test p-value, and minimum clipped alignment size are configurable parameters.</p>
        <p><italic toggle="yes">Alignment statistics calculation</italic>. To distinguish homologous from non-homologous alignments, a set of statistics is calculated for each of the non-discarded windows produced during truncation. Alignment identity is the fraction of matches in non-gap positions, corrected for the GC composition of the alignment. The fraction of gap positions in the window could be used as another such statistic, where homologous alignments would contain fewer gaps at the same identity. This would, though, not inform us of the probability that the origin nucleotide is shifted by an Indel event, as each event can insert or delete multiple nucleotides in a row. The number of Indel events in a row between non-gap positions can be approximated by a geometric distribution with PMF,
<disp-formula id="pone.0298834.e001"><alternatives><graphic xlink:href="pone.0298834.e001.jpg" id="pone.0298834.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">l</italic> is the number of adjacent indel events between two non-gap positions regardless of the size of each event, <italic toggle="yes">P</italic>(<italic toggle="yes">L = l</italic>) is the probability of finding this number of events between two arbitrary sites in the sequence, and <italic toggle="yes">p</italic> is the fraction of indel events per site. <italic toggle="yes">p</italic> is directly related to the probability of no indel events having occurred between two adjacent homologous nucleotides via <italic toggle="yes">P</italic>(<italic toggle="yes">L</italic> = 0) = 1—<italic toggle="yes">p</italic>, which can be estimated from the fraction of adjacent aligned nucleotides that do not have gaps, <italic toggle="yes">q</italic>, in an observed sequence, (<italic toggle="yes">p</italic> = 1 –<italic toggle="yes">q</italic>). This produces a set of identities and indel fractions for each alignment—one for every fixed-size window within it. After this step, the alignments themselves are discarded, with only these statistics and the origin nucleotide match state being kept for the final steps.</p>
      </sec>
      <sec id="sec006">
        <title>(c) Alignment clustering</title>
        <p><italic toggle="yes">GBDT estimation of true identity</italic>. Identity and indel fraction can greatly vary between and within homologous alignments. For clustering to be effective, a more stable statistic needs to be calculated. For this purpose, we train a Gradient-Boosted Decision Tree (GBDT) to estimate a ’true identity’ for each window over the space defined by the previous statistics (<xref rid="pone.0298834.g001" ref-type="fig">Fig 1C</xref>, ’GBDT estimation’). This treats each window as a single point of data, with parameters identity and indel fraction, and with prediction value being origin nucleotide match state (1 = match, 0 = mismatch). The output of a GBDT can be thought of as a stepwise surface embedded within the input parameter space, which we enforce to be monotonically increasing with window identity and decreasing with indel fraction. This estimates the proportion of origin nucleotides that match within each area of parameter combinations, which we term the true identity estimate. As a wide area can have the same value estimated, similar alignments are likely to have windows that share similar true identities, making clustering more stable.</p>
        <p><italic toggle="yes">Gradient-descent clustering</italic>. The final step in <italic toggle="yes">Mottle</italic> is to isolate the homologous fraction of alignments through clustering. This approach involves the estimation of two cluster centres, one for homologous alignments (homologous cluster) and one for non-homologous alignments (null cluster), within the three-dimensional space defined by Alignment Identity, indel Fraction, and True Identity statistics. For every alignment, a set of windowed statistics had been generated from during alignment processing, meaning that each alignment contains a distribution of these statistics. Similar to how we approximated runs of indel events with a geometric distributions, we approximate these alignment statistics with a Binomial distribution. Clustering using these statistics directly would be difficult, as the expected variance of Binomially distributed values greatly decreases when the probability approaches zero or one. To rectify this, we utilise the following variance stabilising transformation,
<disp-formula id="pone.0298834.e002"><alternatives><graphic xlink:href="pone.0298834.e002.jpg" id="pone.0298834.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where p is equal to the value of the statistic, and l is equal to the expected lower bound of the statistic, i.e. 0.25 for GC-corrected nucleic acid sequences and 0 for indels. We then define a normalised distance to each cluster centre as,
<disp-formula id="pone.0298834.e003"><alternatives><graphic xlink:href="pone.0298834.e003.jpg" id="pone.0298834.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">mean</italic><sub><italic toggle="yes">I</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">I</italic></sub> equal to the mean and variance of the windowed set of stabilised alignment identities. Similarly, <italic toggle="yes">mean</italic><sub><italic toggle="yes">D</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">D</italic></sub> are generated from the set of indel fractions and <italic toggle="yes">mean</italic><sub><italic toggle="yes">T</italic></sub> and <italic toggle="yes">var</italic><sub><italic toggle="yes">T</italic></sub> from estimated true identities. The centre of the null cluster is initialised so that its True Identity is equal to the expected proportion of matches if it was due to chance, i.e., -1 after the stabilising transformation. To initialise the Alignment Identity and indel fraction, we choose the values of the alignment with the mean True Identity closest to this value. The centre of the Homologous cluster is initialised to the values of the alignment at the 90<sup>th</sup> percentile of mean True Identities. Once initialised, the cluster centres are shifted via gradient descent, with exception of the True identity of the null cluster which always remains at the expected null value, to reduce normalised distances between alignments and centres. The loss function for this process is as follows,
<disp-formula id="pone.0298834.e004"><alternatives><graphic xlink:href="pone.0298834.e004.jpg" id="pone.0298834.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where dist is equal to the distance between the alignment <italic toggle="yes">i</italic> and the cluster centre <italic toggle="yes">j</italic>, N is equal to the total number of alignments, and S is equal to the number of clusters, which is set to two corresponding to the null and homologous clusters. Additionally, weight is defined as follows.
<disp-formula id="pone.0298834.e005"><alternatives><graphic xlink:href="pone.0298834.e005.jpg" id="pone.0298834.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></disp-formula>
where binpow and eps are program parameters. A BFGS optimiser [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>] is used to find the locations that give the minimum loss values. Alignments are then each assigned to the cluster with the closest centre. The final distance value, <italic toggle="yes">D</italic> returned by <italic toggle="yes">Mottle</italic> is obtained from the origin match proportion of alignments in the homology cluster, corrected for GC-content, and transformed to an estimate of substitution distance via the Jukes-Cantor (JC) model [<xref rid="pone.0298834.ref026" ref-type="bibr">26</xref>],
<disp-formula id="pone.0298834.e006"><alternatives><graphic xlink:href="pone.0298834.e006.jpg" id="pone.0298834.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>With <italic toggle="yes">I</italic> being equal to mean true identity of the homologous cluster.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Mottle-map: Bespoke fragment mapping algorithm</title>
      <p>While <italic toggle="yes">Mottle</italic> may use any short-read mapper for fragment mapping, a bespoke algorithm was developed to ensure that each position in a sequence is mapped even at large divergences. <italic toggle="yes">Mottle-map</italic> achieves this by transforming each fragment to a high-dimensional embedding via the Fast Fourier Transform (FFT) and subsequently finding the nearest neighbour in the reciprocal sequence. This is similar to the approach <italic toggle="yes">Satsuma</italic> takes for synteny detection [<xref rid="pone.0298834.ref027" ref-type="bibr">27</xref>]. To allow the FFT transformation of fragments, their values must first be mapped to the complex number plane. For this we use the same embeddings as MAFFT [<xref rid="pone.0298834.ref028" ref-type="bibr">28</xref>], with each base placed at axis-aligned unit lengths and bonding pairs placed in opposite sides of the origin G → + 1, C → - 1, A → + i, T/U → - i. If each position in the fragment is treated as an embedding dimension, then two sequences that are more similar will have a smaller Euclidean distance between embedding, if there are no indels, that give a mid-sequence shift that would misalign the embedding. Shifting this embedding into frequency space via the FFT allows a Euclidean distance calculation while allowing for indels. Before transformation, we divide the real and imaginary axes by the mean of their absolute values, to correct for GC-content. Afterwards, the frequency embeddings are normalised to unit L<sub>2</sub>-norm. These steps can be represented mathematically as follows,
<disp-formula id="pone.0298834.e007"><alternatives><graphic xlink:href="pone.0298834.e007.jpg" id="pone.0298834.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mo>]</mml:mo><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>I</mml:mi><mml:mi>m</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where, E is the set of embedded nucleotides of a sequence, and L is the length of the sequence, and
<disp-formula id="pone.0298834.e008"><alternatives><graphic xlink:href="pone.0298834.e008.jpg" id="pone.0298834.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Where F is the set of values generated from GC-corrected embeddings after transformation by FFT, and L is the length of the transformed sequence. Since Euclidean distance between frequency embeddings can be used as a dissimilarity metric between fragments, a nearest-neighbour search can be used between two sets of embeddings to find similar fragments. Since <italic toggle="yes">Mottle-map</italic> is made for small and highly-divergent sequences, we use a simple many-to-many comparison where the distance between each embedding vector is computed. The top N nearest-neighbour mappings for each fragment in two fragment sets are returned by <italic toggle="yes">Mottle-map</italic>, where N is a parameter.</p>
    </sec>
    <sec id="sec008">
      <title>Implementation and availability</title>
      <p><italic toggle="yes">Mottle</italic> and <italic toggle="yes">Mottle-map</italic> are implemented in Python 3.9 and both are available at <ext-link xlink:href="https://github.com/tphoward/Mottle/_Repo" ext-link-type="uri">https://github.com/tphoward/Mottle\_Repo</ext-link>. Gradient-Boosted Decision Trees are calculated by LightGBM [<xref rid="pone.0298834.ref029" ref-type="bibr">29</xref>], gradient-descent clustering by Tensorflow-probability [<xref rid="pone.0298834.ref030" ref-type="bibr">30</xref>], and nearest neighbour search by Faiss [<xref rid="pone.0298834.ref031" ref-type="bibr">31</xref>]. Parameters used within testing were as follows, ntrees: 100, nleaves: 32, learn_rate: 0.1, subsamp: 1.0, binpow: 64, learn_mult: 0.001, reltol: 1.00E-20, maxiter: 100, binthres: 0.75, and prior_size: 10.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Results and discussion</title>
    <p>To evaluate the performance of <italic toggle="yes">Mottle</italic>, we run a set of benchmarks where exact or approximate relationships between sequences are known. We run <italic toggle="yes">Mottle</italic> with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper. As a comparison, we include four other programs that are used for substitution distance calculation—<italic toggle="yes">Co-phylog</italic> which utilises micro-alignments between sequences [<xref rid="pone.0298834.ref032" ref-type="bibr">32</xref>], <italic toggle="yes">Mash</italic> which calculates distances based on shared k-mers [<xref rid="pone.0298834.ref033" ref-type="bibr">33</xref>], <italic toggle="yes">Slope-SpaM</italic> that uses spaced-word matches [<xref rid="pone.0298834.ref034" ref-type="bibr">34</xref>], and <italic toggle="yes">Swipe</italic> that calculates Smith-Waterman local alignments between sequences, utilising scores based on Karlin-Altschul statistics [<xref rid="pone.0298834.ref035" ref-type="bibr">35</xref>]. For the programs that output identities or alignments, a JC model is used to convert to substitution distances. A summary of the results of all benchmark tests can be seen in <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>.</p>
    <table-wrap position="float" id="pone.0298834.t001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0298834.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Summary of benchmarking results.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="pone.0298834.t001" id="pone.0298834.t001g" position="float"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Tool Name</th>
              <th align="center" rowspan="1" colspan="1">Sub</th>
              <th align="center" rowspan="1" colspan="1">Rfam</th>
              <th align="center" rowspan="1" colspan="1">Gen-fam</th>
              <th align="center" rowspan="1" colspan="1">Fam-ord</th>
              <th align="center" rowspan="1" colspan="1">Ord-class</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Slope-spam</td>
              <td align="center" rowspan="1" colspan="1">0.52</td>
              <td align="center" rowspan="1" colspan="1">0.22</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.70</td>
              <td align="center" rowspan="1" colspan="1">0.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Co-Phylog</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
              <td align="center" rowspan="1" colspan="1">0.82</td>
              <td align="center" rowspan="1" colspan="1">0.38</td>
              <td align="center" rowspan="1" colspan="1">0.12</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mash</td>
              <td align="center" rowspan="1" colspan="1">0.44</td>
              <td align="center" rowspan="1" colspan="1">0.18</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.98</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.85</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.70</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Swipe</td>
              <td align="center" rowspan="1" colspan="1">0.36</td>
              <td align="center" rowspan="1" colspan="1">0.28</td>
              <td align="center" rowspan="1" colspan="1">0.89</td>
              <td align="center" rowspan="1" colspan="1">0.69</td>
              <td align="center" rowspan="1" colspan="1">0.33</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">BWA-MEM2*</td>
              <td align="center" rowspan="1" colspan="1">0.92</td>
              <td align="center" rowspan="1" colspan="1">0.24</td>
              <td align="center" rowspan="1" colspan="1">0.94</td>
              <td align="center" rowspan="1" colspan="1">0.71</td>
              <td align="center" rowspan="1" colspan="1">0.61</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mottle(-map)</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.96</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.66</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.95</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.75</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>Sub: Maximum stable distance of each program when tested on a simple <italic toggle="yes">in silico</italic> sequence evolution benchmark (section, <italic toggle="yes">Simple sequence evolution</italic>). Rfam: Maximum stable distance on concatenated RNA family alignments (section, <italic toggle="yes">Known family alignments</italic>). Gen-fam, Fam-ord and Ord-class: Proportion of correctly assigned outgroup genomes when comparing genomes in the same Genus/Family, Family/Order and Order/Class respectively (section, <italic toggle="yes">Known genome taxonomies</italic>). Scores in bold represent the best performing program in a benchmark test. *Here, <italic toggle="yes">Mottle</italic> was executed with BWA-MEM2 as the mapping software.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec id="sec010">
      <title>Simple sequence evolution</title>
      <p>Our first goal was to test how well <italic toggle="yes">Mottle</italic> performed in comparison to other programs designed to calculate pairwise substitution distances, in the absence of confounding factors. Specifically, we tested programs against the Tobacco mosaic virus genome, with several substitutions introduced <italic toggle="yes">in silico</italic> to a set substitution distance and monitored their effectiveness at estimating this distance over increasing divergence. To do this, we used the genomic sequence of Tobacco mosaic virus (RefSeq accession NC_001367.1), and introduced a set number, <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub>, of random substitution events <italic toggle="yes">in silico</italic>, following <italic toggle="yes">N</italic><sub><italic toggle="yes">sub</italic></sub> = <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub>⋅<italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub>, with <italic toggle="yes">N</italic><sub><italic toggle="yes">nuc</italic></sub> being equal to the size of the full sequence and <italic toggle="yes">D</italic><sub><italic toggle="yes">sub</italic></sub> being the desired substitution distance. Multiple substitution events were allowed to occur at each site. We then ran each substitution distance program on the original and modified genomes to find a calculated distance. This was run for every 0.02 substitution per base-pair (sub/bp) distance between 0 and 1 inclusive, giving a total sample size of 51 sequences. To have a measure of when the outputs of a program begin to consistently diverge from the true distance, that is independent of the number of trials, we calculated a running Mean Absolute Error (MAE) from the true distance as,
<disp-formula id="pone.0298834.e009"><alternatives><graphic xlink:href="pone.0298834.e009.jpg" id="pone.0298834.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">error</italic> is the calculated MAE, <italic toggle="yes">T</italic><sub><italic toggle="yes">k</italic></sub> being equal to the target substitution distance of a specified trial, <italic toggle="yes">P</italic><sub><italic toggle="yes">k</italic></sub> the output of a substitution distance program within this trial, and <italic toggle="yes">N</italic> increasing with the number of trials completed. As a threshold, we use an MAE value of 0.05 sub/bp, where the furthest distance a program’s output is within the MAE threshold is its maximum stable distance. The results indicated that many of the tools struggled to calculate the true distance between 0.25 and 0.35 substitutions per nucleotide base (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Erratic behaviour was seen in many as they passed a critical threshold, set at 5% MAE from the true identity (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>). <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> however tended to significantly underestimate true distance past this point. Interestingly, the results for <italic toggle="yes">Mash</italic> were incredibly stable after much deviation from the true distance (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2A</xref>). The results indicated that <italic toggle="yes">Mottle</italic>, implemented with either <italic toggle="yes">Mottle-map</italic> or <italic toggle="yes">BWA-MEM2</italic> as the mapper, was able to accurately calculate the true distance over nearly all the sequence divergences tested, only reaching the 5% threshold towards the upper end of the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). Noticeable but non-critical deviations were observed in <italic toggle="yes">BWA-MEM2</italic> and <italic toggle="yes">Mottle</italic> throughout the testing space (<xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>), such that a stricter threshold would have been surpassed at a lower divergence. The results for existing tools were surprising, and it was expected that they would perform reliably over a greater distance. It should be noted, however, that the divergence tested here (up to 1 substitution per base) would be considered high for many non-viral scenarios. These programs were not designed and tested with the high mutation rates observed in viruses in mind.</p>
      <fig position="float" id="pone.0298834.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a simple <italic toggle="yes">in silico</italic> substitution model of sequence evolution.</title>
          <p><bold>(a)</bold> Program predictions vs true distance between sequences. Values are clipped to the range [0,1]. Vertical lines indicate the maximum stable distance. <bold>(b)</bold> Mean value of the cumulative deviation of each tool from the true distance. The maximum tolerable deviation is set to 0.05 sub/bp. The point at which curves cross tolerable levels defines the maximum stable distance. Curves are cut whenever NaN values are produced.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Known family alignments</title>
      <p>Having established that <italic toggle="yes">Mottle</italic> could successfully be used to predict true distance over a large sequence divergence space–albeit in a simplified system—we next wanted to test <italic toggle="yes">Mottle</italic> against real viral sequences. However, it was important to maintain knowledge of the true distance between sequences. A database that allows us to do this is the RNA families (Rfam) database [<xref rid="pone.0298834.ref036" ref-type="bibr">36</xref>]. Rfam catalogues homologous RNA sequences as families and holds multiple sequence alignments of them. In addition, while a simple substitution model can give an upper bound on the maximum stable distance for each program, indels are a common feature in biological sequences, especially those of viruses. To test how well <italic toggle="yes">Mottle</italic> can handle indels, we endeavoured to create a benchmark that incorporates <italic toggle="yes">in vivo</italic> substitutions and indels, while allowing us to know the ground truth in terms of substitution distance and giving a large range of such distances. This benchmark therefore assesses <italic toggle="yes">Mottle</italic> against both real viral sequences and sequences containing indels. To do this, we extracted all pairwise alignments in each family where both sequences are of viral origin and calculated a JC distance from their identities. To increase the length of these alignments and make them more comparable to a small RNA viral genome, alignments of similar divergence were concatenated until they reach the size of a small viral genome (&gt;4 kb). For a given target distance, we find the alignment with the closest JC distance. We then calculate the current JC distance of the artificial genome, if below the target distance we add the closest alignment that is above the target distance and vice versa. This process is repeated without replacement until either the target length is reached, or we run out of valid candidate alignments. This created a more realistic dataset to test the six programs against. We run this benchmark on the same distances as previously (Simple sequence evolution, a total of 51 pairs of sequences with increasing substitution distance) and calculate MAEs in the same process.</p>
      <p>For all tools, predictive performance was degraded compared to the previous test (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3</xref>). For many programs, calculating distance was effective initially, but soon diverged from the true value. For most, distance was difficult to calculate beyond 0.25 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3A</xref>). <italic toggle="yes">Co-Phylog</italic>, <italic toggle="yes">Swipe</italic> and <italic toggle="yes">Mash</italic> tended towards underestimating sequence divergence from the true distance past this point, while <italic toggle="yes">Slope-Spam</italic> and <italic toggle="yes">BWA-MEM2</italic> displayed more erratic behaviour. By contrast, <italic toggle="yes">Mottle</italic> was able to track the true distance for longer, deviating only when reaching approximately 0.66 substitutions per base. All programs, except <italic toggle="yes">Mottle</italic>, had crossed the 5% cumulative deviation threshold by 0.3 substitutions per base (<xref rid="pone.0298834.g003" ref-type="fig">Fig 3B</xref>, <xref rid="pone.0298834.t001" ref-type="table">Table 1</xref>). In contrast to <xref rid="pone.0298834.g002" ref-type="fig">Fig 2</xref>, all programs displayed similar deviation at low divergences. Taken together with the previous test, we conclude that <italic toggle="yes">Mottle</italic> is an effective tool for predicting true distance between highly divergent sequences, as may be found within viral populations.</p>
      <fig position="float" id="pone.0298834.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools on a concatenated family alignment dataset.</title>
          <p>Formatted as Fig 2. <bold>(a)</bold> Program predictions vs true distance between sequences. <bold>(b)</bold> Mean cumulative deviation of each tool from the true distance.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Known genome taxonomies</title>
      <p>We next wished to test the performance of these programs in identifying the relationship between genomes in the known viral taxonomy. We assembled a test set of viral genomes composed of three different genomes at two different taxonomic ranks (i.e., genus, order, family, class), as defined by the International Committee on Taxonomy of Viruses [<xref rid="pone.0298834.ref037" ref-type="bibr">37</xref>]. We used this dataset to assess how well each tool could identify outgroup genomes as the taxonomic rankings were increased. Briefly, each program was required to calculate the distance between one reference genome and two others, one that shares a chosen taxonomic ranking (comparator) and another that only shares the rank above (outgroup, <xref rid="pone.0298834.g004" ref-type="fig">Fig 4A</xref>). A correct identification gives the outgroup a higher distance to the reference. To carry out this benchmark, we select reference, comparator, and outgroup genomes randomly from the e NCBI taxonomy database [<xref rid="pone.0298834.ref038" ref-type="bibr">38</xref>] that exhibit this rank structure. On these, we run each program twice—once to calculate reference/comparator distance and once for reference/outgroup. If the distance to the outgroup is larger than to the comparator, this is recorded as a correct output, if smaller then incorrect, and if the output is the same for both then it is recorded as ambiguous. Some programs return NaN values or error codes if they are unable to find any homologous sites to calculate a distance from. In this case, the values are recorded as the maximal distance, which we store as infinity, and carry out the comparisons as before. The rank comparisons we used were Genus-Family, Family-Order, Order-Class. A total of 100 pairs of sequences were used within each rank of comparison.</p>
      <fig position="float" id="pone.0298834.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0298834.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Accuracy of substitution distance prediction tools for identifying taxonomic outgroup genomes.</title>
          <p><bold>(a)</bold> Taxonomic relationship between query, comparator and outgroup genomes. <bold>(b)</bold> Proportion of assignments that were correct (outgroup more distant than comparator genome), incorrect (outgroup less distant), or ambiguous (identical distances) for each tool when comparing genomes in the same Genus or same Family, in the same Family or same Order, and in the same Order or same Class, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0298834.g004" position="float"/>
      </fig>
      <p>Unsurprisingly, most of the programs were able to identify which genome shared the same Genus as the other, and which were only in the same Family (<xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>). <italic toggle="yes">Mash</italic> performed the best under these conditions, followed by <italic toggle="yes">Mottle</italic> and then <italic toggle="yes">BWA-MEM2</italic>. <italic toggle="yes">Co-Phylog</italic>, which was created with the genomes of cellular organisms in mind, did return several ambiguous results, perhaps a result of the instability of the output, even at low divergence, as seen in <xref rid="pone.0298834.g004" ref-type="fig">Fig 4B</xref>. In the next test, the reference genome was compared to genomes in the same Family or Order. Here, all programs performed less well than in the previous test, with <italic toggle="yes">Mottle</italic> performing the best, followed by <italic toggle="yes">Mash</italic> and then <italic toggle="yes">Swipe</italic>. Again, <italic toggle="yes">Co-Phylog</italic> struggled to unambiguously place genomes correctly at this taxonomic distance. In the final test, the reference genome was compared with ones sharing an Order and Class. This test was far more challenging. Once again, <italic toggle="yes">Mash</italic>, <italic toggle="yes">Mottle</italic> and <italic toggle="yes">BWA-MEM2</italic> were the most effective, showing mainly correct placements with few ambiguous results. The other tools demonstrated high levels of ambiguity in this challenge, being unable to find any regions of homology to calculate a stable distance. <italic toggle="yes">Mottle</italic>, <italic toggle="yes">Mash</italic> and <italic toggle="yes">BWA-MEM2</italic> are therefore useful tools for placing test genomes within known taxonomies, even at large taxonomic distances.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Conclusions</title>
    <p>Pairwise substitution distance has a wide set of applications, from building phylogenies to creating reduced databases. Finding a novel approach in this field can find utilisations in any of these areas, giving opportunities for further refinement specific to certain applications. <italic toggle="yes">Mottle</italic> represents an additional tool in this endeavour. It performs as well as existing programs in correctly identifying taxonomic relationships but comes with the added advantage of provided an accurate numerical estimation of genomic distance over a greater sequence divergence. A limitation of its use, though, is a reduced numerical accuracy, compared to alternative approaches, at low divergences on genomes that behave similarly to a simple substitution model, i.e., where insertions and deletions are uncommon. <italic toggle="yes">Mottle</italic> may therefore be of particular interest to the study of viruses, viral relationships, and viral discovery platforms, where available sequences for reference may be sparse, sequence diversity is high, and insertions/deletions occur at a high rate. The algorithms behind <italic toggle="yes">Mottle</italic> can be applied using any Short-Read mapper, Gradient-Boosted Decision Tree generator, Gradient-Descent software, and Nearest-Neighbour finder. This means that any advancements in such software would give increased efficiency or accuracy to new implementations. Further extensions to the algorithm could include support for amino acid input, simultaneous multiple sequence distance calculation and isolating sub-alignments of continuous homology. In conclusion, <italic toggle="yes">Mottle</italic> is an invaluable, novel approach in substitution distance estimation, with significant performance benefits compared to other algorithms.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0298834.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Zaharias</surname><given-names>P</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>Recent progress on methods for estimating and updating large phylogenies</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2022</year>;<volume>377</volume>: <fpage>20210244</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.2021.0244</pub-id><?supplied-pmid 35989607?><pub-id pub-id-type="pmid">35989607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>M</given-names></name>, <name><surname>Delwart</surname><given-names>E</given-names></name>, <name><surname>Rosario</surname><given-names>K</given-names></name>, <name><surname>Segales</surname><given-names>J</given-names></name>, <name><surname>Varsani</surname><given-names>A</given-names></name>, <name><surname>Ictv Report</surname><given-names>C</given-names></name>. <article-title>ICTV Virus Taxonomy Profile: Circoviridae</article-title>. <source>J Gen Virol</source>. <year>2017</year>;<volume>98</volume>: <fpage>1997</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1099/jgv.0.000871</pub-id><?supplied-pmid 28786778?><pub-id pub-id-type="pmid">28786778</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Su</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>. <article-title>Sketch distance-based clustering of chromosomes for large genome database compression</article-title>. <source>BMC Genomics</source>. <year>2019</year>;<volume>20</volume>: <fpage>978</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-019-6310-0</pub-id><?supplied-pmid 31888458?><pub-id pub-id-type="pmid">31888458</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Krishnamurthy</surname><given-names>SR</given-names></name>, <name><surname>Wang</surname><given-names>D</given-names></name>. <article-title>Origins and challenges of viral dark matter</article-title>. <source>Virus Res</source>. <year>2017</year>;<volume>239</volume>: <fpage>136</fpage>–<lpage>42</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.virusres.2017.02.002</pub-id><?supplied-pmid 28192164?><pub-id pub-id-type="pmid">28192164</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zielezinski</surname><given-names>A</given-names></name>, <name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>Bernard</surname><given-names>G</given-names></name>, <name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Tang</surname><given-names>K</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>144</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id><?supplied-pmid 31345254?><pub-id pub-id-type="pmid">31345254</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>DN</given-names></name>, <name><surname>Langmead</surname><given-names>B</given-names></name>. <article-title>Dashing: fast and accurate genomic distances with HyperLogLog</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>: <fpage>265</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1875-0</pub-id><?supplied-pmid 31801633?><pub-id pub-id-type="pmid">31801633</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Dorrer</surname><given-names>S</given-names></name>, <name><surname>Gerth</surname><given-names>M</given-names></name>, <name><surname>Bleidorn</surname><given-names>C</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Prot-SpaM: fast alignment-free phylogeny reconstruction based on whole-proteome sequences</article-title>. Gigascience. <year>2019</year>;<fpage>8</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giy148</pub-id><?supplied-pmid 30535314?><pub-id pub-id-type="pmid">30535314</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>X.</given-names></name><article-title>BinDash, software for fast genome distance estimation on a typical personal laptop</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>671</fpage>–<lpage>3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty651</pub-id><?supplied-pmid 30052763?><pub-id pub-id-type="pmid">30052763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Klotzl</surname><given-names>F</given-names></name>, <name><surname>Haubold</surname><given-names>B</given-names></name>. <article-title>Phylonium: fast estimation of evolutionary distances from large samples of similar genomes</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>: <fpage>2040</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz903</pub-id><?supplied-pmid 31790149?><pub-id pub-id-type="pmid">31790149</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Girgis</surname><given-names>HZ</given-names></name>, <name><surname>James</surname><given-names>BT</given-names></name>, <name><surname>Luczak</surname><given-names>BB</given-names></name>. <article-title>Identity: rapid alignment-free prediction of sequence alignment identity scores using self-supervised general linear models</article-title>. <source>NAR Genom Bioinform</source>. <year>2021</year>;<volume>3</volume>: <fpage>lqab001</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nargab/lqab001</pub-id><?supplied-pmid 33554117?><pub-id pub-id-type="pmid">33554117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Uddin</surname><given-names>M</given-names></name>, <name><surname>Islam</surname><given-names>MK</given-names></name>, <name><surname>Hassan</surname><given-names>MR</given-names></name>, <name><surname>Jahan</surname><given-names>F</given-names></name>, <name><surname>Baek</surname><given-names>JH</given-names></name>. <article-title>A fast and efficient algorithm for DNA sequence similarity identification</article-title>. <source>Complex Intell Systems</source>. <year>2023</year>;<volume>9</volume>: <fpage>1265</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40747-022-00846-y</pub-id><?supplied-pmid 36035628?><pub-id pub-id-type="pmid">36035628</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Duffy</surname><given-names>S</given-names></name>, <name><surname>Shackelton</surname><given-names>LA</given-names></name>, <name><surname>Holmes</surname><given-names>EC</given-names></name>. <article-title>Rates of evolutionary change in viruses: patterns and determinants</article-title>. <source>Nat Rev Genet</source>. <year>2008</year>;<volume>9</volume>: <fpage>267</fpage>–<lpage>76</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2323</pub-id><?supplied-pmid 18319742?><pub-id pub-id-type="pmid">18319742</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Santiago-Rodriguez</surname><given-names>TM</given-names></name>, <name><surname>Hollister</surname><given-names>EB</given-names></name>. <article-title>Unraveling the viral dark matter through viral metagenomics.</article-title><source>Front Immunol</source>. <year>2022</year>;<volume>13</volume>: <fpage>1005107</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fimmu.2022.1005107</pub-id><?supplied-pmid 36189246?><pub-id pub-id-type="pmid">36189246</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sanjuan</surname><given-names>R</given-names></name>, <name><surname>Nebot</surname><given-names>MR</given-names></name>, <name><surname>Chirico</surname><given-names>N</given-names></name>, <name><surname>Mansky</surname><given-names>LM</given-names></name>, <name><surname>Belshaw</surname><given-names>R</given-names></name>. <article-title>Viral mutation rates</article-title>. <source>J Virol</source>. <year>2010</year>;<volume>84</volume>: <fpage>9733</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JVI.00694-10</pub-id><?supplied-pmid 20660197?><pub-id pub-id-type="pmid">20660197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <name><surname>Dolja</surname><given-names>VV</given-names></name>. <article-title>The global virome: How much diversity and how many independent origins</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>40</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16207</pub-id><?supplied-pmid 36097140?><pub-id pub-id-type="pmid">36097140</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Dominguez-Huerta</surname><given-names>G</given-names></name>, <name><surname>Wainaina</surname><given-names>JM</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Culley</surname><given-names>AI</given-names></name>, <name><surname>Kuhn</surname><given-names>JH</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>The RNA virosphere: How big and diverse is it</article-title>? <source>Environ Microbiol</source>. <year>2023</year>;<volume>25</volume>: <fpage>209</fpage>–<lpage>15</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1462-2920.16312</pub-id><?supplied-pmid 36511833?><pub-id pub-id-type="pmid">36511833</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Neri</surname><given-names>U</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Camargo</surname><given-names>AP</given-names></name>, <name><surname>Lee</surname><given-names>B</given-names></name>, <name><surname>Kazlauskas</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Expansion of the global RNA virome reveals diverse clades of bacteriophages</article-title>. <source>Cell</source>. <year>2022</year>;<volume>185</volume>: <fpage>4023</fpage>–<lpage>37 e18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2022.08.023</pub-id><?supplied-pmid 36174579?><pub-id pub-id-type="pmid">36174579</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Accurate multiple alignment of distantly related genome sequences using filtered spaced word matches as anchor points</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>211</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty592</pub-id><?supplied-pmid 29992260?><pub-id pub-id-type="pmid">29992260</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Hachiya</surname><given-names>T</given-names></name>, <name><surname>Osana</surname><given-names>Y</given-names></name>, <name><surname>Popendorf</surname><given-names>K</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name>. <article-title>Accurate identification of orthologous segments among multiple genomes</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>853</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp070</pub-id><?supplied-pmid 19188192?><pub-id pub-id-type="pmid">19188192</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Criscuolo</surname><given-names>A.</given-names></name><article-title>On the transformation of MinHash-based uncorrected distances into proper evolutionary distances for phylogenetic inference.</article-title><source>F1000Res</source>. <year>2020</year>;<volume>9</volume>: <fpage>1309</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.26930.1</pub-id><?supplied-pmid 33335719?><pub-id pub-id-type="pmid">33335719</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Haubold</surname><given-names>B</given-names></name>, <name><surname>Pfaffelhuber</surname><given-names>P</given-names></name>, <name><surname>Domazet-Loso</surname><given-names>M</given-names></name>, <name><surname>Wiehe</surname><given-names>T</given-names></name>. <article-title>Estimating mutation distances from unaligned genomes</article-title>. <source>J Comput Biol</source>. <year>2009</year>;<volume>16</volume>: <fpage>1487</fpage>–<lpage>500</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2009.0106</pub-id><?supplied-pmid 19803738?><pub-id pub-id-type="pmid">19803738</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Leimeister</surname><given-names>CA</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>Kmacs: the k-mismatch average common substring approach to alignment-free sequence comparison</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>2000</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu331</pub-id><?supplied-pmid 24828656?><pub-id pub-id-type="pmid">24828656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Genco</surname><given-names>RJ</given-names></name>, <name><surname>Wactawski-Wende</surname><given-names>J</given-names></name>, <name><surname>Buck</surname><given-names>M</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>. <article-title>SENSE: Siamese neural network for sequence embedding and alignment-free comparison</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>1820</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty887</pub-id><?supplied-pmid 30346493?><pub-id pub-id-type="pmid">30346493</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Moshiri</surname><given-names>N</given-names></name>, <name><surname>Robinson</surname><given-names>P</given-names></name>. <article-title>ViralMSA: massively scalable reference-guided multiple sequence alignment of viral genomes</article-title>. <source>Bioinformatics</source>. <year>2021</year>;<volume>37</volume>: <fpage>714</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa743</pub-id><?supplied-pmid 32814953?><pub-id pub-id-type="pmid">32814953</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bertels</surname><given-names>F</given-names></name>, <name><surname>Silander</surname><given-names>OK</given-names></name>, <name><surname>Pachkov</surname><given-names>M</given-names></name>, <name><surname>Rainey</surname><given-names>PB</given-names></name>, <name><surname>van Nimwegen</surname><given-names>E</given-names></name>. <article-title>Automated reconstruction of whole-genome phylogenies from short-sequence reads</article-title>. <source>Mol Biol Evol</source>. <year>2014</year>;<volume>31</volume>: <fpage>1077</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msu088</pub-id><?supplied-pmid 24600054?><pub-id pub-id-type="pmid">24600054</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Jukes</surname><given-names>TH</given-names></name>, <name><surname>Cantor</surname><given-names>CR</given-names></name>. <part-title>Evolution of Protein Molecules</part-title>. In: <name><surname>Munro</surname><given-names>HN</given-names></name>, editor. <source>Mammalian Protein Metabolism</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1969</year>. p. <fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Grabherr</surname><given-names>MG</given-names></name>, <name><surname>Russell</surname><given-names>P</given-names></name>, <name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Mauceli</surname><given-names>E</given-names></name>, <name><surname>Alfoldi</surname><given-names>J</given-names></name>, <name><surname>Di Palma</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide synteny through highly sensitive sequence alignment: Satsuma</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>1145</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btq102</pub-id><?supplied-pmid 20208069?><pub-id pub-id-type="pmid">20208069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Rozewicki</surname><given-names>J</given-names></name>, <name><surname>Yamada</surname><given-names>KD</given-names></name>. <article-title>MAFFT online service: multiple sequence alignment, interactive sequence choice and visualization</article-title>. <source>Brief Bioinform</source>. <year>2019</year>;<volume>20</volume>: <fpage>1160</fpage>–<lpage>6</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx108</pub-id><?supplied-pmid 28968734?><pub-id pub-id-type="pmid">28968734</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Ke</surname><given-names>G</given-names></name>, <name><surname>Meng</surname><given-names>Q</given-names></name>, <name><surname>Finley</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Ma</surname><given-names>W</given-names></name>, <etal>et al</etal>., Eds. <name><surname>von Luxburg</surname><given-names>U</given-names></name>, <name><surname>Guyon</surname><given-names>I</given-names></name>, <name><surname>Bengio</surname><given-names>S</given-names></name>, <name><surname>Wallach</surname><given-names>H</given-names></name>, <part-title>Fergus R LightGBM: a highly efficient gradient boosting decision tree.</part-title><source>Proceedings of the 31st International Conference on Neural Information Processing Systems</source>; <year>2017</year>; <publisher-loc>Long Beach, California, USA</publisher-loc>: <publisher-name>Curran Associates Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>M</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Barham</surname><given-names>P</given-names></name>, <name><surname>Brevdo</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>TensorFlow: Large-Scale Machine Learning on Heterogeneous Distributed Systems</article-title>. <year>2015</year>. <source>Software available from tensorflow.org</source>.</mixed-citation>
    </ref>
    <ref id="pone.0298834.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Douze</surname><given-names>M</given-names></name>, <name><surname>Jegou</surname><given-names>H</given-names></name>. <article-title>Billion-Scale Similarity Search with GPUs</article-title>. <source>IEEE Transactions on Big Data</source>. <year>2021</year>;<volume>7</volume>: <fpage>535</fpage>–<lpage>47</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tbdata.2019.2921572</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Yi</surname><given-names>H</given-names></name>, <name><surname>Jin</surname><given-names>L</given-names></name>. <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>e75</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkt003</pub-id><?supplied-pmid 23335788?><pub-id pub-id-type="pmid">23335788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ondov</surname><given-names>BD</given-names></name>, <name><surname>Treangen</surname><given-names>TJ</given-names></name>, <name><surname>Melsted</surname><given-names>P</given-names></name>, <name><surname>Mallonee</surname><given-names>AB</given-names></name>, <name><surname>Bergman</surname><given-names>NH</given-names></name>, <name><surname>Koren</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>132</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id><?supplied-pmid 27323842?><pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Rohling</surname><given-names>S</given-names></name>, <name><surname>Linne</surname><given-names>A</given-names></name>, <name><surname>Schellhorn</surname><given-names>J</given-names></name>, <name><surname>Hosseini</surname><given-names>M</given-names></name>, <name><surname>Dencker</surname><given-names>T</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>The number of k-mer matches between two DNA sequences as a function of k and applications to estimate phylogenetic distances</article-title>. <source>PLoS One</source>. <year>2020</year>;<volume>15</volume>: <fpage>e0228070</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0228070</pub-id><?supplied-pmid 32040534?><pub-id pub-id-type="pmid">32040534</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rognes</surname><given-names>T.</given-names></name><article-title>Faster Smith-Waterman database searches with inter-sequence SIMD parallelisation</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>: <fpage>221</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-221</pub-id><?supplied-pmid 21631914?><pub-id pub-id-type="pmid">21631914</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kalvari</surname><given-names>I</given-names></name>, <name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Ontiveros-Palacios</surname><given-names>N</given-names></name>, <name><surname>Argasinska</surname><given-names>J</given-names></name>, <name><surname>Lamkiewicz</surname><given-names>K</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>. <source>Nucleic Acids Res</source>. <year>2021</year>;<volume>49</volume>: <fpage>D192</fpage>–<lpage>D200</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id><?supplied-pmid 33211869?><pub-id pub-id-type="pmid">33211869</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lefkowitz</surname><given-names>EJ</given-names></name>, <name><surname>Dempsey</surname><given-names>DM</given-names></name>, <name><surname>Hendrickson</surname><given-names>RC</given-names></name>, <name><surname>Orton</surname><given-names>RJ</given-names></name>, <name><surname>Siddell</surname><given-names>SG</given-names></name>, <name><surname>Smith</surname><given-names>DB</given-names></name>. <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV).</article-title><source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>: <fpage>D708</fpage>–<lpage>D17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id><?supplied-pmid 29040670?><pub-id pub-id-type="pmid">29040670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0298834.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Federhen</surname><given-names>S.</given-names></name><article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>: <fpage>D136</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><?supplied-pmid 22139910?><pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
