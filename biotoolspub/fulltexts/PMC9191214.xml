<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9191214</article-id>
    <article-id pub-id-type="pmid">35482476</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac294</article-id>
    <article-id pub-id-type="publisher-id">btac294</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dysregulated ligand–receptor interactions from single-cell transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8892-7078</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Qi</given-names>
        </name>
        <aff><institution>Department of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <aff><institution> Department of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <xref rid="btac294-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsu</surname>
          <given-names>Chih-Yuan</given-names>
        </name>
        <aff><institution>Department of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <aff><institution>Department  of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <xref rid="btac294-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Jia</given-names>
        </name>
        <aff><institution>Department of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <aff><institution>Department of  Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Shyr</surname>
          <given-names>Yu</given-names>
        </name>
        <xref rid="btac294-cor1" ref-type="corresp"/>
        <aff><institution>Department of Biostatistics, Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics,  Vanderbilt University Medical Center</institution>, Nashville, TN 37232, <country country="US">USA</country></aff>
        <!--yu.shyr@vumc.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btac294-FM1">
        <label>†</label>
        <p>The authors wish it to be known that, in their opinion, Qi Liu and Chih-Yuan Hsu should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btac294-cor1">To whom correspondence should be addressed. <email>yu.shyr@vumc.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-04-28">
      <day>28</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>12</issue>
    <fpage>3216</fpage>
    <lpage>3221</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>18</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac294.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Intracellular communication is crucial to many biological processes, such as differentiation, development, homeostasis and inflammation. Single-cell transcriptomics provides an unprecedented opportunity for studying cell-cell communications mediated by ligand–receptor interactions. Although computational methods have been developed to infer cell type-specific ligand–receptor interactions from one single-cell transcriptomics profile, there is lack of approaches considering ligand and receptor simultaneously to identifying dysregulated interactions across conditions from multiple single-cell profiles.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed scLR, a statistical method for examining dysregulated ligand–receptor interactions between two conditions. scLR models the distribution of the product of ligands and receptors expressions and accounts for inter-sample variances and small sample sizes. scLR achieved high sensitivity and specificity in simulation studies. scLR revealed important cytokine signaling between macrophages and proliferating T cells during severe acute COVID-19 infection, and activated TGF-β signaling from alveolar type II cells in the pathogenesis of pulmonary fibrosis.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>scLR is freely available at <ext-link xlink:href="https://github.com/cyhsuTN/scLR" ext-link-type="uri">https://github.com/cyhsuTN/scLR</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Cancer Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100000054</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U2C CA233291</award-id>
        <award-id>U54 CA217450</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>P01 AI139449</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Cancer Center Support Grant</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30CA068485</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cells constantly communicate with each other to orchestrate their behaviors, ensuring normal functions of tissues, organs and bodies. One important mode of intercellular communication is ligand–receptor interactions, where ligands from a ‘sender’ cell bind to receptors in a ‘receiver’ cell that triggers response inside the cell. The recent advance of single-cell RNA sequencing technology provides a powerful way to study ligand–receptor interactions at an unprecedented scale and depth (<xref rid="btac294-B1" ref-type="bibr">Almet <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B3" ref-type="bibr">Armingol <italic toggle="yes">et al.</italic>, 2021</xref>). Deciphering ligand–receptor interactions from single-cell transcriptomics has become routine for understanding the biological systems (<xref rid="btac294-B23" ref-type="bibr">Martin <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Computational methods have been developed rapidly to infer cell-cell communications mediated by ligand–receptor interactions from single-cell transcriptomics (<xref rid="btac294-B5" ref-type="bibr">Browaeys <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac294-B7" ref-type="bibr">Cabello-Aguilar <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac294-B11" ref-type="bibr">Efremova <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac294-B19" ref-type="bibr">Hou <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac294-B20" ref-type="bibr">Hu <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B21" ref-type="bibr">Jin <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B24" ref-type="bibr">Noel <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B27" ref-type="bibr">Solovey and Scialdone, 2020</xref>; <xref rid="btac294-B32" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2021</xref>). Ligand–receptor interactions are detected and quantified based on the pairwise expression of ligands and receptors between single cells or cell clusters. Some methods, such as ICELLNET (<xref rid="btac294-B24" ref-type="bibr">Noel <italic toggle="yes">et al.</italic>, 2021</xref>), determine the interaction strength by the product of ligands and receptors expressions. Other methods, such as CellChat (<xref rid="btac294-B21" ref-type="bibr">Jin <italic toggle="yes">et al.</italic>, 2021</xref>) and SingleCellSignalR (<xref rid="btac294-B7" ref-type="bibr">Cabello-Aguilar <italic toggle="yes">et al.</italic>, 2020</xref>), calculate the interaction by a non-linear transformation of the product of ligands and receptors expressions. The significance of cell type-specific interactions is estimated based on a null distribution generated by shuffling cluster labels of all cells. These methods have been successfully applied in a number of single-cell transcriptomics datasets, which uncovered key signaling mechanisms controlling cell fate and state transitions (<xref rid="btac294-B4" ref-type="bibr">Bassez <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B15" ref-type="bibr">Gong <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B18" ref-type="bibr">Hildreth <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac294-B29" ref-type="bibr">Tian <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Existing methods focus primarily on the inference of ligand–receptor interactions between cells/cell clusters in one condition. The identification of dysregulated communications across conditions, however, is even more important for revealing potential driving signals. iTalk and CellChat predict up- (gained) or down-regulated (loss) interactions based on the differentially expressed ligands and/or receptors, where upregulated/gained interactions are defined based on upregulated ligands and/or receptors and vice versa. The differential analysis compares expressions from pooled cells between two conditions, which fail to consider inter-sample variances in each condition. Moreover, identification of dysregulated ligand–receptor interactions based on expression changes of ligands or receptors alone would result in false positives and false negatives. For example, a ligand–receptor interaction with an upregulated ligand but a downregulated receptor is probably not a strong candidate.</p>
    <p>We developed scLR to identify dysregulated ligand–receptor interactions across conditions. scLR not only models the distribution of the product of ligands and receptors expressions, but also accounts for inter-sample variances, small sample sizes and dropout events. scLR achieved high recall (sensitivity) and specificity in four simulation datasets. scLR revealed important cytokine signaling between macrophages and proliferating T cells in severe COVID-19 infection, and activated TGF-β signaling from alveolar type II cells in the pathogenesis of pulmonary fibrosis.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data preprocessing</title>
      <p>The inputs of scLR are one raw gene–cell count matrix along with the cell cluster and the sample information (sample ID and condition) from single-cell RNA-seq data. The sample represents a replicate, such as one patient. For example, the sample size is 20 if the single-cell RNA-seq dataset is generated from10 tumor patients and 10 controls. scLR first sums gene counts in each cell cluster in each sample to estimate gene expression in the cluster and in the sample. Then scLR normalizes the summed data using a median normalization method in DESeq2, which assumes expression profiles have the same median value (<xref rid="btac294-B2" ref-type="bibr">Anders and Huber, 2010</xref>) (details in Normalization in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref>). After normalization, scLR transforms the data by log2 (x + 1) to obtain expression abundances for the ligand <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>and the receptor <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in the cluster <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> of sample <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula>. <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of clusters and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of samples.</p>
    </sec>
    <sec>
      <title>2.2 The distribution of the product of ligand and receptor expressions</title>
      <p>We assume <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> follow a bivariate normal distribution with correlation <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>denote the expression of ligand and receptor in the cluster <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of sample <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>, respectively. To simply the equation, we use <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to represent <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (<xref rid="E1" ref-type="disp-formula">Equation 1</xref>).
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula><inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>the product of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, can be expressed as (<xref rid="E2" ref-type="disp-formula">Equation 2</xref>).
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></disp-formula>where <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> are independent, which follow non-central chi-square distributions with the degree of freedom of 1 and the non-central parameters of <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, respectively. As shown in (2), the distribution of <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is equal to that of the difference of two independent non-central chi-square random variables (regardless of constants), which depends on <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula>, <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>b</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo></mml:math></inline-formula>. The expectation <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.3 Differential analysis of ligand–receptor interactions</title>
      <p>scLR is aimed to identify cell-type specific dysregulated interactions between two conditions. It first calculates the interaction strength of each ligand–receptor pair between two cell clusters (the ‘sender’ and ‘receiver’) and then assesses its alteration between two conditions statistically. The interaction strength of ligand–receptor between clusters <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in sample <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> is measured by the product of the ligand and receptor in the corresponding cluster <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of sample <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>: <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. Assume there are <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> samples from condition A and <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> samples from condition B, where<inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The mean interaction strength of ligand and receptor between clusters <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across all the samples under condition A can bedenoted as <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>where <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Similarly, <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. We compare the mean interaction strengths of ligand–receptor interactions under two different conditions.</p>
      <p>The null hypothesis is that the mean of ligand–receptor interaction strengths are the same under two conditions. The alternative hypothesis is that they are not the same.
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>If the difference <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> for some specified <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, we reject the null hypothesis and conclude that ligand and receptor interactions are significantly altered between two conditions.</p>
      <p>We use Monte Carlo simulation to estimate the null distribution of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. We first estimate the means and standard deviations of the ligand and receptor expressions in clusters <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> under two conditions A and B, denoted by <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>,<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>,<inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. To assess inter-sample variances accurately when the sample size is small, we use a Bayesian method to shrink the estimated variances toward a pooled estimate (<xref rid="btac294-B26" ref-type="bibr">Smyth, 2004</xref>), which is performed by eBayes in the R package limma. Moreover, we assume <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> based on the observation of a very low percentage of significant non-zero correlations in real datasets, e.g. only 0.05% of ligand–receptor pairs in the COVID-19 data, 0.6% pairs were found in the IPF data and 0.03% were detected in AVP data at adjusted <italic toggle="yes">P</italic>-value &lt; 0.05. The scLR package also provides a function to estimate <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo></mml:math></inline-formula> (default = 0) in case there are a number of significant non-zero correlations. When the null hypothesis is true, <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">which</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">can</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">be</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>simplified as <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>between clusters <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we can assume <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> based on <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>, where <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the non-central parameters of non-central chi-square distributions in conditions A and B. We let <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. Based on <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, we simulate the distribution of <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> based on the <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. We randomly choose <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> samples to estimate <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>and <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> samples to derive <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. The difference between two conditions <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. When we repeat the simulation K times, we have <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math></inline-formula>. The <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> required is the <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mn>100</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">%</mml:mi></mml:math></inline-formula> percentile of <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula> and the <italic toggle="yes">P</italic>-value is given by the proportion of <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mo>|</mml:mo><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula>.</p>
      <p>A decent number of simulations is needed to obtain an accurate estimation of the significance of dysregulated ligand–receptor interactions. It is very time consuming, however, if a large number of simulations are conducted for every ligand–receptor pair between any two cell clusters since there are thousands of ligand–receptor pairs and tens of cell clusters. To address this problem, we estimate the density of <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math></inline-formula> using a kernel density approach with the Gaussian kernel and a large data-driven bandwidth <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mi>h</mml:mi></mml:math></inline-formula> in each ligand–receptor pair comparison. The bandwidth <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>h</mml:mi></mml:math></inline-formula> controls smoothness of the estimated density. A small <italic toggle="yes">h</italic> gives very rough estimates while a large <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mi>h</mml:mi></mml:math></inline-formula> gives smoother estimates but weakens local features, for example, smoothing tails but weakening the mode(s) of the density. The main purpose here is to obtain an accurate tail probability rather than an overall density estimate. We use a data-driven approach to estimate <italic toggle="yes">h</italic> via the R function <italic toggle="yes">density</italic> (parameters: bw = ‘SJ’ and adjust = 3).</p>
      <p>Based on the estimated density <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:msqrt><mml:mi>h</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">xp</mml:mi><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:math></inline-formula>, the <italic toggle="yes">P</italic>-value is estimated by two times the tail probability beyond the <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mi>d</mml:mi></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.4 Pseudo-counts for reducing false positives</title>
      <p>The prevalence of dropout events is one of the greatest challenges in single-cell RNA sequencing data analysis, which introduces excessive number of zeros and unwanted technical variability. There is a close relationship between dropout rate and expression level, where genes with high dropout rate indicate low expression (<xref rid="btac294-B25" ref-type="bibr">Qiu, 2020</xref>). The excessive number of zeros make ligand–receptor interaction analysis even more difficult. The product would be zero if the ligand or the receptor expression in one condition are undetected, which leads to many false positives especially when sample sizes are small. To reduce the number of false positives caused by dropout events, we add pseudo-count of 1 to the zero values. Comparing scLR with and without pseudo-counts using simulation data, we found that scLR with pseudo-counts achieved higher precision and specificity (i.e. lower false positive rates) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The scLR package also provides a parameter (zero.impute, default=TRUE) to turn off pseudo-counts.</p>
    </sec>
    <sec>
      <title>2.5 Single-cell RNA-seq datasets</title>
      <p>We used three single-cell RNA-seq datasets to evaluate the performance of scLR, including data generated from patients with and without COVID-19 infection (<xref rid="btac294-B16" ref-type="bibr">Grant <italic toggle="yes">et al.</italic>, 2021</xref>), pulmonary fibrosis lungs (PF) and non-fibrotic controls (<xref rid="btac294-B17" ref-type="bibr">Habermann <italic toggle="yes">et al.</italic>, 2020</xref>), and patients with Anterior vaginal prolapse (AVP) and controls (<xref rid="btac294-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>). Three datasets were all generated by 10X platform. The COVID-19 data were downloaded from GSE155249, including five patients with severe COVID-19 infection and two COVID-19 negatives. There were 33 000 cells with 18 337 genes, clustered into six cell types, macrophages, dendritic cells (DC), T cells, proliferating T cells, ciliated and alveolar cells. The PF data were downloaded from GSE135893, consisting of 11 PF patients and nine controls. There were 70 512 cells with 33 694 genes, classified into 12 cell types. The AVP data were downloaded from GSE151202, involving 16 AVP patients and five controls. There were 53 133 cells with 20 328 genes, categorized into seven cell types. Multivariate normality test showed that only 2.1% of ligand–receptor pairs were significant different from bivariate normal distributions in the COVID-19 data, 12.1% pairs in IPF data and 1.6% in AVP data at an adjusted <italic toggle="yes">P</italic>-value &lt; 0.05. These results suggested that a small percentage of ligand–receptor pairs might be modeled poorly by bivariate normal distributions. For those pairs violating normality assumption, we found that rectified normal distributions and gamma distributions fitted the data well, especially rectified normal distributions.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulation</title>
      <sec>
        <title>3.1.1 Simulation settings</title>
        <p>We designed four scenarios to evaluate the performance of scLR (<xref rid="btac294-T1" ref-type="table">Table 1</xref>). Each scenario has three samples in each of two conditions. Both ligands and receptors are upregulated in the first setting, whereas only ligands or receptors are upregulated in the second scenario. The third setting is challenging, where ligands and receptors are overexpressed complementarily, e.g. highly upregulated ligands but slightly or non-upregulated receptors in one sample and vice versa in the other sample, leading to increased products of ligand and receptor expressions. Upregulated interactions in this scenario are not driven by ligands or receptors alone, but the complementary increase of ligands and receptors. We simulated complementary increase by upregulation of ligands but slight overexpression of receptors in the samples 1 and 3, and upregulation of receptors but slight overexpression of ligands in the sample 2. The fourth scenario is a special case, where ligands are upregulated but receptors are downregulated, resulting in unchanged ligand–receptor interactions. There are 2000 ligand–receptor pairs in each setting. There are 500 significant and 1500 non-significant pairs in the first three scenarios. There are no true positives but 2000 non-significant pairs in the fourth scenario. Every sample in the simulation studies consists of 16 672 genes and 11 cell clusters. The expression abundances were generated from normal distributions, where the parameters of means and standard deviations for each gene in each cell cluster were derived from real single-cell RNA-seq datasets. The normalized counts were increased/decreased to simulate the upregulation/downregulation on the expression abundances (see Simulation Settings in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref>). Ten simulated datasets were generated for each scenario.</p>
        <table-wrap position="float" id="btac294-T1">
          <label>Table 1.</label>
          <caption>
            <p>Simulation settings in four scenarios</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="char" char="(" span="1"/>
              <col valign="top" align="char" char="(" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">Ligand</th>
                <th rowspan="1" colspan="1">Receptor</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Scenario 1</td>
                <td rowspan="1" colspan="1">(↑, ↑, ↑)</td>
                <td rowspan="1" colspan="1">(↑, ↑, ↑)</td>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">Scenario 2</td>
                <td rowspan="1" colspan="1">(↑, ↑, ↑)</td>
                <td rowspan="1" colspan="1">(–, –, –)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">(–, –, –)</td>
                <td rowspan="1" colspan="1">(↑, ↑, ↑)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Scenario 3</td>
                <td rowspan="1" colspan="1">(↑, <sc>↑</sc>, ↑)</td>
                <td rowspan="1" colspan="1">(<sc>↑</sc>, ↑, <sc>↑</sc>)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Scenario 4</td>
                <td rowspan="1" colspan="1">(↑, ↑, ↑)</td>
                <td rowspan="1" colspan="1">(↓, ↓, ↓)</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn1">
              <p><italic toggle="yes">Note</italic>: Three samples in each condition.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>3.1.2 Performance on simulation studies</title>
        <p>We compared scLR with Welch’s <italic toggle="yes">t</italic>-test and differential gene expression analysis by limma under four simulation settings. Welch’s <italic toggle="yes">t</italic>-test was used to compare the mean difference of the product of ligands and receptors expressions between two conditions based on the assumption that the product follows a normal distribution. Limma was performed to identify differential expression in ligands or receptors, where ligand–receptor pairs with either ligands or receptors differentially expressed between two conditions were considered as dysregulated ligand–receptor interactions.</p>
        <p>We evaluated the performances based on the following metrics: (i) the F1 score curve at different thresholds; (ii) the recall (sensitivity) and specificity curve at different thresholds; and (iii) the number of true positives (TP), precision (TP/TP+FP), recall (TP/TP+FN), specificity (TN/TN+FP) and F1 score at the threshold of adjusted <italic toggle="yes">P</italic>-value &lt; 0.01.</p>
        <p>In the first scenario where dysregulated ligand–receptor interactions were caused by both upregulation in the ligand and receptor expressions, scLR showed the best performance. scLR achieved much higher F1 score and recall than the other two methods at different thresholds (<xref rid="btac294-F1" ref-type="fig">Fig. 1A</xref>). The three methods obtained similar specificity (<xref rid="btac294-F1" ref-type="fig">Fig. 1A</xref>). At the threshold of adjust <italic toggle="yes">P</italic>-value &lt; 0.01, scLR recovered ∼430 out of 500 significant ligand–receptor pairs (84% recall), while <italic toggle="yes">t</italic>-test only identified ∼100 pairs (20% recall) and limma detected ∼330 pairs (66% recall) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). When there were an increasing percentage of pairs (ranging from 0% to 90%) violating the normality assumption (either from Gamma or rectified normal distributions), the specificity of scLR was controlled well but the recall decreased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). scLR showed much better performance in terms of recall and F1 scores than limma and <italic toggle="yes">t</italic>-test when there were 50% of non-normal pairs (Gamma or rectified normal distributions), indicating the power of scLR decreased less than limma and <italic toggle="yes">t</italic>-test as the percentage of non-normal pairs increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
        <fig position="float" id="btac294-F1">
          <label>Fig. 1.</label>
          <caption>
            <p><bold>Performance evaluation in simulation studies</bold>. Performance in the first scenario (A), the second scenario (B) and the third scenario (C). </p>
          </caption>
          <graphic xlink:href="btac294f1" position="float"/>
        </fig>
        <p>In the second scenario where dysregulated ligand–receptor interactions were driven by either the ligand or the receptor alterations alone, scLR had slightly inferior performance than limma (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). The F1 and recall curve at different thresholds showed that scLR obtained better performance at rigorous cutoffs (0.001 &lt; adjusted <italic toggle="yes">P</italic>-value &lt; 0.01), while limma had better performance at relaxed cutoffs (0.01 ≤ adjusted <italic toggle="yes">P</italic>-value &lt; 0.1) (<xref rid="btac294-F1" ref-type="fig">Fig. 1B</xref>).</p>
        <p>The third scenario is challenging, where dysregulated ligand–receptor interactions are driven by complementary ligand and receptor alterations. scLR achieved the best performance, which had much higher F1 score and recall than <italic toggle="yes">t</italic>-test and limma at different thresholds (<xref rid="btac294-F1" ref-type="fig">Fig. 1C</xref>). limma, relying on differential expression of either ligands or receptors alone, showed poor performance. scLR identified ∼330 interacting pairs with 64% recall, whereas <italic toggle="yes">t</italic>-test and limma both failed to detect any ligand–receptor pairs at the threshold of adjusted <italic toggle="yes">P</italic>-value &lt; 0.01 (<xref rid="btac294-F1" ref-type="fig">Fig. 1C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
        <p>The fourth scenario simulated a special case where none of dysregulations exist due to opposite changes in ligands and receptors expression. In this case, scLR and <italic toggle="yes">t</italic>-test performed better than limma, which obtained much lower false positives rates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
        <p>The simulation studies demonstrated that scLR overall achieved higher performance than limma and <italic toggle="yes">t</italic>-test. Similar results were also obtained in the same four scenarios with five samples in each condition (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8–S11</xref>). Since dysregulated ligand–receptor interactions involve both ligands and receptors, methods considering ligands or receptors alone like limma are not effective, such as in scenarios 1, 3 and 4. <italic toggle="yes">T</italic>-test considers ligand–receptor interactions in terms of their products, but it is conservative due to both large estimates for the standard deviations of the products and the inappropriate normal distribution assumption for non-normal products (see <xref rid="E2" ref-type="disp-formula">Equation 2</xref>). scLR directly models the distribution of the product of ligands and receptors expressions, therefore, it achieved much better performance than <italic toggle="yes">t</italic>-test.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Identification of dysregulated ligand–receptor interactions in severe COVID-19</title>
      <p>We applied scLR on single-cell RNA-seq data on BAL fluid collected from patients with severe SARS-COV-2 pneumonia and two control patients, one with bacterial pneumonia and one non-pneumonia control (<xref rid="btac294-B16" ref-type="bibr">Grant <italic toggle="yes">et al.</italic>, 2021</xref>). The integrated analysis of five patients with severe SARS-COV-2 pneumonia and two patients without SARS-COV-2 pneumonia resolved multiple clusters corresponding to macrophages, dendritic cells, T cells, proliferating T cells, ciliated and alveolar cells.</p>
      <p>Using the curated ligand–receptor database (LRdb) compiled by SingleCellSignalR (<xref rid="btac294-B7" ref-type="bibr">Cabello-Aguilar <italic toggle="yes">et al.</italic>, 2020</xref>), scLR identified 1313 dysregulated ligand–receptor interactions in SARS-COV-2 infection compared to non-SARS-COV-2 infection (adjusted <italic toggle="yes">P</italic>-value &lt; 0.01) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), of which 938 upregulated and 375 downregulated pairs. Among them, 16% of interactions did not have significantly altered ligands or receptors even at a loose cut off (adjusted <italic toggle="yes">P</italic>-value &lt; 0.1) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). Those interactions generally ranked lower than those with significantly altered ligands or receptors (ranking by adjusted <italic toggle="yes">P</italic>-values). Macrophages have the most disrupted autocrine ligand–receptor interactions (128), followed by 88 altered interactions from proliferating T cells to macrophages and 81 from macrophages to proliferating T cells, suggesting active communications between macrophage and proliferating T cells during SARS-COV-2 infection. The most upregulated ligand–receptor pairs involve several cytokines and chemokines that are important for T cell and monocytes recruitment and alveolar macrophage maturation, such as CCL2, CCL3, CCL4, CCL5, CCL7, CCL8, CXCL13, CXCL10, CXCL11 and CXCL16. Macrophages is the major source of dysregulated interactions involving CCL2, CCL7 and CCL8, while proliferating T cell is the source for CCL4, CCL3 and CCL5 (<xref rid="btac294-F2" ref-type="fig">Fig. 2A</xref>). CCL2-CCR1 interaction is most upregulated across all cell type pairs, especially between macrophage itself. In the CXC family, CXCL10-CXCR3 is most upregulated in the macrophage-proliferating T cells communication (<xref rid="btac294-F2" ref-type="fig">Fig. 2B</xref>). Recent studies reveal that innate immune interferons dysregulation is key to determine SARS-COV-2 pathogenesis. scLR detected the dysregulated IFNG-IFNGR1 and IFNG-IFNGR2 between proliferating T cells and other immune cells, especially between proliferating T and macrophages (<xref rid="btac294-F2" ref-type="fig">Fig. 2C</xref>). These findings are consistent with recent studies reporting that macrophages drove the inflammatory response to SARS-COV-2 infection (<xref rid="btac294-B28" ref-type="bibr">Speranza <italic toggle="yes">et al.</italic>, 2021</xref>) and macrophages and T cells form a positive feedback loop that derives persistent alveolar infection (<xref rid="btac294-B16" ref-type="bibr">Grant <italic toggle="yes">et al.</italic>, 2021</xref>). In addition, scLR found that it is proliferating T cells that produce IFNG to induce inflammatory cytokine release from macrophages, such as CCL2, CCL7, CCL8, CXCL10 and CXCL16, which further promote T cell activation and proliferation.</p>
      <fig position="float" id="btac294-F2">
        <label>Fig. 2.</label>
        <caption>
          <p><bold>Dysregulated ligand–receptor interactions in SARS-COV-2 infection compared to control</bold>. Dysregulated CC chemokine interactions (<bold>A</bold>), CXC chemokine interactions (<bold>B</bold>) and IFNG interactions (<bold>C</bold>). △LR is the difference of expression products of ligands and receptors between two conditions</p>
        </caption>
        <graphic xlink:href="btac294f2" position="float"/>
      </fig>
      <p>We compared scLR with CellChat and iTALK. Instead of considering ligands and receptors simultaneously, CellChat and iTALK detect dysregulated interactions based on expression changes of either ligands or receptors alone. Additionally, scLR calculates the difference at the sample-level, while CellChat and iTALK pool cells from all samples in one condition together to estimate the difference, which ignore sample-level variances and might lead to biased results. Using the same ligand–receptor database LRdb (<xref rid="btac294-B7" ref-type="bibr">Cabello-Aguilar <italic toggle="yes">et al.</italic>, 2020</xref>), CellChat identified 1720 dysregulated interactions (|log<sub>2</sub>FC|&gt;0.2 &amp; <italic toggle="yes">P</italic>-value &lt; 0.01) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>) and iTALK discovered 4385 interactions (|log<sub>2</sub>FC|&gt;0.2 &amp; adjusted <italic toggle="yes">P</italic>-value &lt; 0.01) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). We focused on major findings from the original study to further investigate those interactions, which revealed that T cells produce IFNG to induce inflammatory cytokine release and further promote T cell activation (<xref rid="btac294-B16" ref-type="bibr">Grant <italic toggle="yes">et al.</italic>, 2021</xref>). We listed IFNG-related interactions between immune cells by scLR, CellChat and iTALK in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>, along with differential expression results of ligands and receptors at the patient-level (scLR) and at the cell-level (CellChat and iTalk). scLR found IFNG-related interactions all upregulated after COVID-19 infection, including IFNG-IFNGR1 between proliferating T and all other cell types and IFNG-IFNGR2 between proliferating T and macrophages/DC. The upregulated interactions were mainly due to <italic toggle="yes">IFNG</italic> overexpression in proliferating T cells after COVID-19 infection (log<sub>2</sub>FC = 5.1 &amp; adjusted <italic toggle="yes">P</italic>-value = 0.002, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>). To be noted, the interaction of IFNG-IFNGR1 was detected to be significantly upregulated between proliferating T and T cells, whereas IFNG-IFNGR2 was not due to large variances of <italic toggle="yes">IFNGR2</italic> in T cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S15</xref>). The same phenomena were observed for IFNG-IFNGR2 in the autocrine proliferating T interactions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>). CellChat and iTALK, in contrast, performed differential expression at cell-level by pooling cells, resulting in biased results toward patients with large number of cells. They detected upregulation of <italic toggle="yes">IFNGR1</italic> and <italic toggle="yes">IFNGR2</italic> in macrophages, and even their downregulation in proliferating T cells, which were not true at the patient-level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>). The downregulation of receptors (<italic toggle="yes">IFNGR1</italic> or <italic toggle="yes">IFNGR2</italic>) led to undetermined/wrong directions of interaction changes. Another example about important CCL8<italic toggle="yes">-</italic>CCR5 interactions was described in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref>. In summary, the analysis strategy employed by scLR enables to find more biologically meaningful results than CellChat and iTALK. First, differential analysis at patient-level is able to find consistent changes across patients, such as <italic toggle="yes">IFNG</italic> upregulation in proliferating T cells. In contrast, differential analysis at cell-level by pooling cells together (CellChat and iTALK) was likely to be dominated by patients with large number of cells, resulting in biased results, such as false downregulation of <italic toggle="yes">IFNGR1</italic> and <italic toggle="yes">IFNGR2</italic> in proliferating T cells. Second, the strategy of considering ligands and receptors simultaneously helps remove false positives and false negatives. Although <italic toggle="yes">IFNG</italic> was strongly upregulated in proliferating T cells, scLR detected a non-significant change of IFNG-IFNGR2 between proliferating T and T cells due to large variances of <italic toggle="yes">IFNGR2</italic> in T cells, which would be a false positive if only consider <italic toggle="yes">IFNG</italic> alone. Moreover, 16% of 1313 interactions did not have significantly altered ligands or receptors even at a loose cutoff (adjusted <italic toggle="yes">P</italic>-value &lt; 0.1) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>), which would be missed if only consider ligands or receptors alone (false negatives). Third, scLR is able to rank dysregulated interactions by their statistical results, which is very useful to find the most important cell-type specific interactions. For example, the most dysregulated IFNG-interaction was found between proliferating T and macrophages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S17</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Identification of dysregulated ligand–receptor interactions in PF and AVP</title>
      <p>We applied scLR on two additional single-cell RNA-seq datasets generated from patients with pulmonary fibrosis (PF) (<xref rid="btac294-B17" ref-type="bibr">Habermann <italic toggle="yes">et al.</italic>, 2020</xref>) and Anterior vaginal prolapse (AVP) (<xref rid="btac294-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>). The PF data contained 12 cell types, such as type II alveolar cells (AT2), fibroblasts, endothelial cells. Using the curated ligand–receptor database (LRdb) compiled by SingleCellSignalR (<xref rid="btac294-B7" ref-type="bibr">Cabello-Aguilar <italic toggle="yes">et al.</italic>, 2020</xref>), scLR identified 567 dysregulated ligand–receptor interactions in IPF patients compared to controls (adjusted <italic toggle="yes">P</italic>-value &lt; 0.01) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). The most upregulated interactions all involve TGF-β1 signaling from AT2 cells, such as TGFB1-ITGB6, TNC-ITGAV, TGFB1-ITGB1 and TGFB1-TGFBR1/TGFBR2. TGF-β1 is a master regulator of ECM accumulation and a key driver of lung fibrosis (<xref rid="btac294-B13" ref-type="bibr">Fernandez and Eickelberg, 2012</xref>; <xref rid="btac294-B31" ref-type="bibr">Yue <italic toggle="yes">et al.</italic>, 2010</xref>). Integrins αVβ3, αVβ5, αVβ8 and αVβ6 play vital roles in TGF-β activation in fibrotic disorders (<xref rid="btac294-B10" ref-type="bibr">Dong <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac294-B13" ref-type="bibr">Fernandez and Eickelberg, 2012</xref>; <xref rid="btac294-B31" ref-type="bibr">Yue <italic toggle="yes">et al.</italic>, 2010</xref>). Expression of <italic toggle="yes">TNC</italic>, an extracellular matrix protein, is significantly upregulated in fibrotic lungs, which is induced by <italic toggle="yes">TGFB1</italic> and contributes to TGF-β mediated lung fibrosis (<xref rid="btac294-B12" ref-type="bibr">Estany <italic toggle="yes">et al.</italic>, 2014</xref>). One recent study found that sustained elevated mechanical tension, the most common driver of lung fibrosis, activates a TGF-β signaling loop in AT2 cells and then leads to the periphery-to-center progression of lung fibrosis (<xref rid="btac294-B30" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2020</xref>). This is consistent with our results, which discovered strong TGF-β activation between AT2 cells and other cell types.</p>
      <p>The AVP dataset involved seven cell types, endothelial cells, fibroblasts, lymphatic endothelial, macrophages, myoepithelial cells (MEP), smooth muscle cells and T cells. scLR detected 34 dysregulated ligand–receptor interactions in AVP patients compared to control samples (adjusted <italic toggle="yes">P</italic>-value &lt; 0.01) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Endothelial cells and fibroblast participate in the highest level of changes in ligand–receptor interactions. The most upregulated interactions are mainly related to ECM organization, such as APP-LRP1 and HSPG2-LRP1 between fibroblasts and endothelial cells, autocrine A2M-LRP1 in endothelial cells, autocrine ECM1-CACHD1 in fibroblasts. LRP1 regulates ECM remodeling (<xref rid="btac294-B14" ref-type="bibr">Gaultier <italic toggle="yes">et al.</italic>, 2010</xref>), while its partner A2M and APP are all involved in ECM organization. Heparan sulfate proteoglycan 2 (HSPG2), also known as perlecan, is a large multi-domain extracellular matrix proteoglycan. ECM1, extracellular matrix protein 1, is known to be upregulated in pelvic organ prolapse (<xref rid="btac294-B8" ref-type="bibr">Cecati <italic toggle="yes">et al.</italic>, 2018</xref>). This agrees with previous findings that POP is an acquired disorder of extracellular matrix (<xref rid="btac294-B6" ref-type="bibr">Budatha <italic toggle="yes">et al.</italic>, 2011</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented scLR, a statistical method for differential analysis of ligand–receptor interactions on single-cell transcriptomics data. scLR models the distribution of the product of ligand and receptor expressions and takes the inter-sample variances, small sample sizes and dropout events into account. Overall, scLR achieved the best performance than other methods in four simulation settings, especially when the ligand and receptor are both dysregulated, or they have complementary alterations. Applied on single-cell RNA-seq datasets from severe SARS-COV-2 infection, scLR revealed the important dysregulated interactions between macrophages and proliferating T cells that lead to persistent infection. Moreover, scLR discovered activated TGF-β signaling from alveolar type II cells contributing to the pathogenesis of pulmonary fibrosis.</p>
    <p>scLR is designed for single-cell RNA-seq datasets with small sample sizes, which assesses sample variances by shrinkage of the estimated variances toward a pooled estimate using a Bayesian method. It can work for data with only one sample in either one of the two conditions based on the additional assumption that variances of ligand/receptor expressions in the two conditions are the same (<xref rid="btac294-B26" ref-type="bibr">Smyth, 2004</xref>). When there are enough samples, model-free methods, such as permutation, might be better for estimating the background distribution of expression products of ligands and receptors rather than assuming bivariate normal distributions. However, it is difficult to determine the exact number of sufficient sample sizes. The sample size depends on the number of permutations needed to generate an accurate <italic toggle="yes">P</italic>-value, whereas the minimum number of permutations is subject to the total number of ligand–receptor pairs and pair-wise cell types combinations.</p>
    <p>The current version of scLR only compares ligand–receptor interactions between two conditions. If there are any batch effects, they should be removed by single-cell RNA-seq batch correction methods (Tran <italic toggle="yes">et al.</italic>, 2020) before the application of scLR. We plan to extend scLR for experiments with complex designs, which would broaden its applicability and also remove potential biases from confounders such as batch effects. Moreover, scLR only models the interactions between ligands and receptors without considering other stimulatory and inhibitory cofactors. Combining ligands, receptors and cofactors together would require new modeling framework. Identification of dysregulated LR interactions from single-cell RNA-seq alone would introduce false-positive results since cells only communicate within a certain distance. Integrating single-cell RNA-seq with spatial transcriptomics would further narrow down the important communications between cells.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Data from COVID-19, pulmonary fibrosis and anterior vaginal prolapse can be accessed through the Gene Expression Omnibus (GEO) with accession numbers GSE155249, GSE135893, and GSE151202 respectively.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Cancer Institute [U2C CA233291 and U54 CA217450]; National Institutes of Health [P01 AI139449]; and Cancer Center Support Grant [P30CA068485].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac294_Supplementary_Data</label>
      <media xlink:href="btac294_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac294-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almet</surname><given-names>A.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>The landscape of cell–cell communication through single-cell transcriptomics</article-title>. <source>Curr. Opin. Syst. Biol</source>., <volume>26</volume>, <fpage>12</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">33969247</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armingol</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Deciphering cell-cell interactions and communication from gene expression</article-title>. <source>Nat. Rev. Genet</source>., <volume>22</volume>, <fpage>71</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">33168968</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bassez</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>A single-cell map of intratumoral changes during anti-PD1 treatment of patients with breast cancer</article-title>. <source>Nat. Med</source>., <volume>27</volume>, <fpage>820</fpage>–<lpage>832</lpage>.<pub-id pub-id-type="pmid">33958794</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browaeys</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>NicheNet: modeling intercellular communication by linking ligands to target genes</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>159</fpage>–<lpage>162</lpage>.<pub-id pub-id-type="pmid">31819264</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Budatha</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Extracellular matrix proteases contribute to progression of pelvic organ prolapse in mice and humans</article-title>. <source>J. Clin. Invest</source>., <volume>121</volume>, <fpage>2048</fpage>–<lpage>2059</lpage>.<pub-id pub-id-type="pmid">21519142</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cabello-Aguilar</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>SingleCellSignalR: inference of intercellular networks from single-cell transcriptomics</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>e55</fpage>.<pub-id pub-id-type="pmid">32196115</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cecati</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Expression of extracellular matrix and adhesion proteins in pelvic organ prolapse</article-title>. <source>Cell. Mol. Biol. (Noisy-le-Grand)</source>, <volume>64</volume>, <fpage>142</fpage>–<lpage>148</lpage>.<pub-id pub-id-type="pmid">29729708</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell analysis reveals urothelial cell heterogeneity and regenerative cues following cyclophosphamide-induced bladder injury</article-title>. <source>Cell Death Dis</source>., <volume>12</volume>, <fpage>446</fpage>.<pub-id pub-id-type="pmid">33953164</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Force interacts with macromolecular structure in activation of TGF-beta</article-title>. <source>Nature</source>, <volume>542</volume>, <fpage>55</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">28117447</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efremova</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>CellPhoneDB: inferring cell-cell communication from combined expression of multi-subunit ligand–receptor complexes</article-title>. <source>Nat. Protoc</source>., <volume>15</volume>, <fpage>1484</fpage>–<lpage>1506</lpage>.<pub-id pub-id-type="pmid">32103204</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Estany</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Lung fibrotic tenascin-C upregulation is associated with other extracellular matrix proteins and induced by TGFbeta1</article-title>. <source>BMC Pulm. Med</source>., <volume>14</volume>, <fpage>120</fpage>.<pub-id pub-id-type="pmid">25064447</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fernandez</surname><given-names>I.E.</given-names></string-name>, <string-name><surname>Eickelberg</surname><given-names>O.</given-names></string-name></person-group> (<year>2012</year>) <article-title>The impact of TGF-beta on lung fibrosis: from targeting to biomarkers</article-title>. <source>Proc. Am. Thorac. Soc</source>., <volume>9</volume>, <fpage>111</fpage>–<lpage>116</lpage>.<pub-id pub-id-type="pmid">22802283</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaultier</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>LRP1 regulates remodeling of the extracellular matrix by fibroblasts</article-title>. <source>Matrix Biol</source>., <volume>29</volume>, <fpage>22</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">19699300</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gong</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Comprehensive single-cell sequencing reveals the stromal dynamics and tumor-specific characteristics in the microenvironment of nasopharyngeal carcinoma</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1540</fpage>.<pub-id pub-id-type="pmid">33750785</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname><given-names>R.A.</given-names></string-name></person-group>  <etal>et al</etal>; The NU SCRIPT Study Investigators. (<year>2021</year>) <article-title>Circuits between infected macrophages and T cells in SARS-CoV-2 pneumonia</article-title>. <source>Nature</source>, <volume>590</volume>, <fpage>635</fpage>–<lpage>641</lpage>.<pub-id pub-id-type="pmid">33429418</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habermann</surname><given-names>A.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA sequencing reveals profibrotic roles of distinct epithelial and mesenchymal lineages in pulmonary fibrosis</article-title>. <source>Sci. Adv</source>., <volume>6</volume>, <fpage>eaba1972</fpage>.<pub-id pub-id-type="pmid">32832598</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hildreth</surname><given-names>A.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell sequencing of human white adipose tissue identifies new cell states in health and obesity</article-title>. <source>Nat. Immunol</source>., <volume>22</volume>, <fpage>639</fpage>–<lpage>653</lpage>.<pub-id pub-id-type="pmid">33907320</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hou</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Predicting cell-to-cell communication networks using NATMI</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>5011</fpage>.<pub-id pub-id-type="pmid">33024107</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>CytoTalk: de novo construction of signal transduction networks using single-cell transcriptomic data</article-title>. <source>Sci Adv</source>, <volume>7</volume>, <fpage>eabf1356</fpage>.<pub-id pub-id-type="pmid">33853780</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Inference and analysis of cell-cell communication using CellChat</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1088</fpage>.<pub-id pub-id-type="pmid">33597522</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell transcriptome profiling of the vaginal wall in women with severe anterior vaginal prolapse</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>87</fpage>.<pub-id pub-id-type="pmid">33397933</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-Cell analysis of crohn's disease lesions identifies a pathogenic cellular module associated with resistance to anti-TNF therapy</article-title>. <source>Cell</source>, <volume>178</volume>, <fpage>1493</fpage>–<lpage>1508.e20</lpage>.<pub-id pub-id-type="pmid">31474370</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noel</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Dissection of intercellular communication using the transcriptome-based framework ICELLNET</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1089</fpage>.<pub-id pub-id-type="pmid">33597528</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>P.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Embracing the dropouts in single-cell RNA-seq analysis</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>1169</fpage>.<pub-id pub-id-type="pmid">32127540</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group> (<year>2004</year>) <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>3</volume>, Article3.</mixed-citation>
    </ref>
    <ref id="btac294-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Solovey</surname><given-names>M.</given-names></string-name>, <string-name><surname>Scialdone</surname><given-names>A.</given-names></string-name></person-group> (<year>2020</year>) <article-title>COMUNET: a tool to explore and visualize intercellular communication</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>4296</fpage>–<lpage>4300</lpage>.<pub-id pub-id-type="pmid">32399572</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Speranza</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell RNA sequencing reveals SARS-CoV-2 infection dynamics in lungs of African green monkeys</article-title>. <source>Sci. Transl. Med</source>., <volume>13</volume>, <fpage>eabe8146</fpage>.<pub-id pub-id-type="pmid">33431511</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Single-cell transcriptomic profiling provides insights into the toxic effects of zearalenone exposure on primordial follicle assembly</article-title>. <source>Theranostics</source>, <volume>11</volume>, <fpage>5197</fpage>–<lpage>5213</lpage>.<pub-id pub-id-type="pmid">33859742</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Progressive pulmonary fibrosis is caused by elevated mechanical tension on alveolar stem cells</article-title>. <source>Cell</source>, <volume>180</volume>, <fpage>107</fpage>–<lpage>121.e17</lpage>.<pub-id pub-id-type="pmid">31866069</pub-id></mixed-citation>
    </ref>
    <ref id="btac294-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yue</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>TGF-beta: titan of lung fibrogenesis</article-title>. <source>Curr Enzym Inhib</source>, <volume>6</volume>, <fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="btac294-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Cellinker: a platform of ligand–receptor interactions for intercellular communication analysis</article-title>. <source>Bioinformatics</source>.</mixed-citation>
    </ref>
  </ref-list>
</back>
