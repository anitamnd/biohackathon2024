<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5415185</article-id>
    <article-id pub-id-type="pmid">28467460</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0176469</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-16-45179</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Nucleotide Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Nucleotide Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacteriology</subject>
            <subj-group>
              <subject>Bacterial Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Microbial Taxonomy</subject>
            <subj-group>
              <subject>Bacterial Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Microbial Taxonomy</subject>
              <subj-group>
                <subject>Bacterial Taxonomy</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MGmapper: Reference based mapping and taxonomy annotation of metagenomics sequence reads</article-title>
      <alt-title alt-title-type="running-head">MGmapper: Annotation of metagenomics sequence reads</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2484-5716</contrib-id>
        <name>
          <surname>Petersen</surname>
          <given-names>Thomas Nordahl</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lukjancenko</surname>
          <given-names>Oksana</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomsen</surname>
          <given-names>Martin Christen Fr√∏lund</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maddalena Sperotto</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lund</surname>
          <given-names>Ole</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>M√∏ller Aarestrup</surname>
          <given-names>Frank</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sicheritz-Pont√©n</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Bio and Health Informatics, Technical University of Denmark, Kongens Lyngby, Denmark</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>National Food Institute, Technical University of Denmark, Kongens Lyngby, Denmark</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>An</surname>
          <given-names>Lingling</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Arizona, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>
          <list list-type="simple">
            <list-item>
              <p><bold>Conceptualization:</bold> TNP O. Lund FMA TSP.</p>
            </list-item>
            <list-item>
              <p><bold>Data curation:</bold> TNP O. Lukjancenko.</p>
            </list-item>
            <list-item>
              <p><bold>Formal analysis:</bold> TNP O. Lukjancenko.</p>
            </list-item>
            <list-item>
              <p><bold>Funding acquisition:</bold> TSP FMA.</p>
            </list-item>
            <list-item>
              <p><bold>Investigation:</bold> TNP.</p>
            </list-item>
            <list-item>
              <p><bold>Methodology:</bold> TNP.</p>
            </list-item>
            <list-item>
              <p><bold>Project administration:</bold> TSP FMA.</p>
            </list-item>
            <list-item>
              <p><bold>Resources:</bold> FMA TSP.</p>
            </list-item>
            <list-item>
              <p><bold>Software:</bold> TNP MCFT TSP.</p>
            </list-item>
            <list-item>
              <p><bold>Supervision:</bold> TSP.</p>
            </list-item>
            <list-item>
              <p><bold>Validation:</bold> O. Lukjancenko MCFT.</p>
            </list-item>
            <list-item>
              <p><bold>Visualization:</bold> TNP TSP.</p>
            </list-item>
            <list-item>
              <p><bold>Writing ‚Äì original draft:</bold> TNP.</p>
            </list-item>
            <list-item>
              <p><bold>Writing ‚Äì review &amp; editing:</bold> TNP MMS.</p>
            </list-item>
          </list>
        </p>
      </fn>
      <corresp id="cor001">* E-mail: <email>tnp@cbs.dtu.dk</email> (TNP); <email>thomas@cbs.dtu.dk</email> (TSP)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>5</issue>
    <elocation-id>e0176469</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>4</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>¬© 2017 Petersen et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Petersen et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0176469.pdf"/>
    <abstract>
      <p>An increasing amount of species and gene identification studies rely on the use of next generation sequence analysis of either single isolate or metagenomics samples. Several methods are available to perform taxonomic annotations and a previous metagenomics benchmark study has shown that a vast number of false positive species annotations are a problem unless thresholds or post-processing are applied to differentiate between correct and false annotations. MGmapper is a package to process raw next generation sequence data and perform reference based sequence assignment, followed by a post-processing analysis to produce reliable taxonomy annotation at species and strain level resolution. An in-vitro bacterial mock community sample comprised of 8 genuses, 11 species and 12 strains was previously used to benchmark metagenomics classification methods. After applying a post-processing filter, we obtained 100% correct taxonomy assignments at species and genus level. A sensitivity and precision at 75% was obtained for strain level annotations. A comparison between MGmapper and Kraken at species level, shows MGmapper assigns taxonomy at species level using 84.8% of the sequence reads, compared to 70.5% for Kraken and both methods identified all species with no false positives. Extensive read count statistics are provided in plain text and excel sheets for both rejected and accepted taxonomy annotations. The use of custom databases is possible for the command-line version of MGmapper, and the complete pipeline is freely available as a bitbucked package (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/mgmapper">https://bitbucket.org/genomicepidemiology/mgmapper</ext-link>). A web-version (<ext-link ext-link-type="uri" xlink:href="https://cge.cbs.dtu.dk/services/MGmapper">https://cge.cbs.dtu.dk/services/MGmapper</ext-link>) provides the basic functionality for analysis of small fastq datasets.</p>
    </abstract>
    <funding-group>
      <funding-statement>This study was funded by the European Community's Seventh Framework Programme [FP7/2007‚Äì2013], under grant agreement n¬∞613754, and by The Villum Foundation (VKR023052). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="1"/>
      <table-count count="6"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The advances in rapid and efficient DNA sequencing technologies have made it possible to study microbial communities from a wide variety of environments, such as sediments [<xref rid="pone.0176469.ref001" ref-type="bibr">1</xref>][<xref rid="pone.0176469.ref002" ref-type="bibr">2</xref>], water [<xref rid="pone.0176469.ref003" ref-type="bibr">3</xref>], ice [<xref rid="pone.0176469.ref004" ref-type="bibr">4</xref>], and humans [<xref rid="pone.0176469.ref005" ref-type="bibr">5</xref>][<xref rid="pone.0176469.ref006" ref-type="bibr">6</xref>]. Among the known DNA sequencing platforms, Illumina HiSeq and MiSeq are often preferred for both single genome and metagenomics studies, due to the large data output and a relatively low cost per base pair. Applying the whole genome shotgun sequencing technique, all DNA in a biological sample is sequenced and several millions of short read nucleotide sequences are produced. Metagenomics data from a single human gut sample is a complex system representing hundreds of organism and even more diversity is expected when samples originate as a mixture from many individuals e.g. humans or animals from sewage systems, public transportation sites or animal farms. The interest in analyzing such datasets may be monitoring of bacterial or viral pathogens, identification of anti-microbial resistance genes, phage identification or simply obtaining a complete catalogue of the organisms that are present. Such analysis is not straight-forward, it requires programs that can perform the mapping of fastq sequence reads to many reference sequence databases without an extensive memory usage, parsing and validating sequence alignment hits, taxonomy annotation with a reduced false positive rate and finally presenting output of the taxonomy analysis and also providing files for further downstream analysis (SNP or contig assembly. MGmapper was made to provide an access for routine analysis of complex datasets, enabling usage of many whole genome reference sequence databases like bacteria, virus, fungi, plant, vertebrate-mammals, invertebrates and also enables the usage of gene databases like anti-microbial resistance genes, 16S rRNA or any custom database based on a set of fasta sequences. The huge fasta sequence databases like plant (208gb fasta) vertebrate mammals (316gb fasta) or invertebrates (150gb fasta) can be split into smaller chunks (10gb fasta) thus the total memory requirement is reduced to 30‚Äì40gb memory when running MGmapper. Also, most tasks are run in parallel for fast execution.</p>
    <p>The task to assign each of those nucleotide reads to the genome that they represent is challenging and the problem of false positive predictions is always an issue to be considered for alignment based methods where a query sequence is mapped against a large database of target sequences. As target databases increase in size, the chance of finding hits for random reasons also increases. For decades the Blast program suite [<xref rid="pone.0176469.ref007" ref-type="bibr">7</xref>] has been one of the most frequently used programs for pairwise alignment of a query sequence against a large database of target sequences. Blast utilizes a filter in form of an expect value as a threshold, to reduce the number of false positives. In general methods within the field of taxonomy annotation rarely use filters or cutoffs, but a recent benchmark study showed the need, as several methods vastly over predict the number of species present when evaluated on both <italic>in vitro</italic> and <italic>in silico</italic> datasets [<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>]. The study involved benchmarking of 15 taxonomy annotation methods where two of them, a filtered version Kraken [<xref rid="pone.0176469.ref009" ref-type="bibr">9</xref>] and CARMA3 [<xref rid="pone.0176469.ref010" ref-type="bibr">10</xref>], correctly identified all species present in an <italic>in vitro</italic> dataset, using a read count abundance threshold at 0.1%. Also, the methods MEGAN4 [<xref rid="pone.0176469.ref011" ref-type="bibr">11</xref>][<xref rid="pone.0176469.ref012" ref-type="bibr">12</xref>] RAPSearch2 [<xref rid="pone.0176469.ref013" ref-type="bibr">13</xref>] performed well with only one false positive species annotation.</p>
    <p>The read count abundance measure is biased as more reads are sequenced from larger genomes compared to smaller genomic sequences like viruses and plasmids. Thus a normalization of read count abundances with the reference sequence size can adjust for a skewed performance that favors large reference sequences. In the MGmapper method we have introduced such a measure to reduce the false positive taxonomy annotations. During whole genome shotgun sequencing, all DNA is fragmented and sequenced from one or both ends depending on whether single-end or paired-end reads are produced. Thus our size normalized read count abundance (S_Abundance) is divided by 2 in case paired-end reads are used and multiplied by 100 for convenience i.e. 100*<italic>ReadCount/Size(bp)*2</italic>, where <italic>Size</italic> is the length of a reference sequence. Using the normal read count abundance (ReadCount/Reads_in_sample) as in the work by Peabody et al. [<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>], a threshold at 0.1% appeared to be the best cut-off to differentiate between true and false taxonomy annotations. For the S_Abundance, a threshold of 0.01 was the best cut-off, based on benchmarking data as used by Peabody et al. One drawback of using a size normalized abundance as criterion for true positive annotations is that, in case of small reference sequences, only a few assigned reads are needed to pass the cutoff. Therefore a lower read-count abundance-threshold could be introduced, although the exact value may be difficult to assign.</p>
    <p>Identifying a specific reference sequence e.g. a bacterial strain or an anti-microbial resistance gene in a pool of highly similar sequences is a challenge for any taxonomy annotation method. Only a few sequence reads aligned to specific marker regions may enable the differentiation between closely related genes or strains. For this reason the presence of uniquely mapped sequence reads to one specific target reference sequence is a strong indicator that the target sequence is actually present in the sample. K-mer based methods like Kraken [<xref rid="pone.0176469.ref009" ref-type="bibr">9</xref>] or KmerFinder [<xref rid="pone.0176469.ref014" ref-type="bibr">14</xref>] require a 100% identity between a query fragment and a database hit with the annotation for that fragment. Typically k-mers with a of length of 31bp are used and at that size a kmer may be assigned to several reference sequences. For the Kmerfinder [<xref rid="pone.0176469.ref014" ref-type="bibr">14</xref>] method an expectation value is calculated as the number kmers assigned to a specific reference sequence within a database compared to the number of hits to other reference sequences in the same database. The Kraken [<xref rid="pone.0176469.ref009" ref-type="bibr">9</xref>] method utilizes another approach based on identifying the Lowest Common Ancestor (LCA) for each of the kmers originating from a sequence read. A score is calculated as the fraction of kmers that are rooted to a specific taxa compared to total number of LCA kmers that are assigned to a fastq read. As Kraken can calculate a score for a fastq read based on k-mer counts, alignment based methods utilize a sequence alignment score for the individual reads. Alignment based methods can handle nucleotide variations between a query read and a reference sequence, and the alignment score is typically used to differentiate the best alignment from secondary alignments with a lower score. The scoring scheme itself is based on heuristics arguments as in Blast [<xref rid="pone.0176469.ref007" ref-type="bibr">7</xref>], and BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>], where scores for a nucleotide match, mis-match and inserts/deletions (INDELs) are summed to an overall alignment score. Thus alignment-based methods provide both numbers for uniquely mapped reads and total number of nucleotide matches, mis-matches and INDELs. Also, in BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>] the edit-distance is the number of changes that are needed to obtain a perfect match between a sequence read and a reference sequence.</p>
    <p>In summary, the normalized read count abundance, a low-read-count value, the number uniquely mapped reads and the edit-distance are measures used by MGmapper, rather than a single read count abundance threshold, with the aim to reduce the number of false positive taxonomy annotations from next generation sequence data.</p>
  </sec>
  <sec id="sec002">
    <title>Materials</title>
    <sec id="sec003">
      <title>Mock bacterial datasets</title>
      <p>Two mock bacterial datasets were previously used to benchmark metagenomics classification methods at genus and species level [<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>]. An <italic>in vitro</italic> dataset comprised of single-end reads with an average length of 223bp can be downloaded from the metagenomics RAST server [<xref rid="pone.0176469.ref016" ref-type="bibr">16</xref>] with accession id 4545485.3. Also, 4 paired-end <italic>in silico</italic> datasets were downloaded: 4545483.3 (100bp), 4548385.3 (250bp), 4548991.3 (500bp) and 4548990.3 (100bp). There are a few changes in species nomenclature and dataset composition compared to the taxonomy that was presented in the original work by Peabody et al.[<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>]. For the sake of clarity the updated taxonomy annotations for both the <italic>in vitro</italic> and <italic>in silico</italic> datasets are given in <xref rid="pone.0176469.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="pone.0176469.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Mock bacterial composition of <italic>in vitro</italic> and <italic>in silico</italic> datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0176469.t001g" xlink:href="pone.0176469.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Genus</th>
                <th align="left" rowspan="1" colspan="1">Species</th>
                <th align="left" rowspan="1" colspan="1">Strain</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>In vitro</italic>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>In silico</italic>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Bacillus</td>
                <td align="left" rowspan="1" colspan="1"><italic>B</italic>.<italic>amyloliquefaciens</italic></td>
                <td align="left" rowspan="1" colspan="1">DSM7</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Bacillus</td>
                <td align="left" rowspan="1" colspan="1"><italic>B</italic>.<italic>cereus</italic></td>
                <td align="left" rowspan="1" colspan="1">ATCC 14579</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Burkholderia</td>
                <td align="left" rowspan="1" colspan="1"><italic>B</italic>.<italic>cenocepacia</italic></td>
                <td align="left" rowspan="1" colspan="1">J2315</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Escherichia</td>
                <td align="left" rowspan="1" colspan="1"><italic>E</italic>.<italic>coli</italic></td>
                <td align="left" rowspan="1" colspan="1">K-12</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Frankia</td>
                <td align="left" rowspan="1" colspan="1"><italic>Frankia</italic>.<italic>sp</italic>.</td>
                <td align="left" rowspan="1" colspan="1">CcI3</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Micrococcus</td>
                <td align="left" rowspan="1" colspan="1"><italic>M</italic>.<italic>luteus</italic></td>
                <td align="left" rowspan="1" colspan="1">NCTC 2665</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pseudomonas</td>
                <td align="left" rowspan="1" colspan="1"><italic>P</italic>.<italic>aeruginosa</italic></td>
                <td align="left" rowspan="1" colspan="1">PAO1</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pseudomonas</td>
                <td align="left" rowspan="1" colspan="1"><italic>P</italic>.<italic>aeruginosa</italic></td>
                <td align="left" rowspan="1" colspan="1">UCBPP-PA14</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pseudomonas</td>
                <td align="left" rowspan="1" colspan="1"><italic>P</italic>.<italic>Fluorescens</italic></td>
                <td align="left" rowspan="1" colspan="1">Pf-5</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pseudomonas</td>
                <td align="left" rowspan="1" colspan="1"><italic>P</italic>.<italic>putida</italic></td>
                <td align="left" rowspan="1" colspan="1">KT2440</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rhodobacter</td>
                <td align="left" rowspan="1" colspan="1"><italic>R</italic>.<italic>capsulatus</italic></td>
                <td align="left" rowspan="1" colspan="1">SB 1003</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Streptomyces</td>
                <td align="left" rowspan="1" colspan="1"><italic>S</italic>.<italic>coelicolor</italic></td>
                <td align="left" rowspan="1" colspan="1">A3(2)</td>
                <td align="center" rowspan="1" colspan="1">x</td>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Nocardioides</td>
                <td align="left" rowspan="1" colspan="1"><italic>Nocardioides sp</italic>.</td>
                <td align="left" rowspan="1" colspan="1">JS614</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">x</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Taxonomy clades are as follows: 12 strains, 11 species and 8 genuses for <italic>in vitro</italic> data and 13 strains, 12 species and 9 genuses for the <italic>in silico</italic> dataset.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Both the <italic>in vitro</italic> and the four <italic>in silico</italic> datasets were mapped against a bacteria and a plasmid reference sequence database. Databases were compiled as subset of entries from the assembly_summary file available at <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/genomes/genbank/bacteria/assembly_summary.txt">ftp://ftp.ncbi.nlm.nih.gov/genomes/genbank/bacteria/assembly_summary.txt</ext-link>. Criteria for sequence selection were defined by these parameters: version_status = ‚Äòlatest‚Äô, genome_rep = ‚ÄòFull‚Äô and assembly_level = 'Complete Genome' or assembly_level = 'Chromosome'. In total the bacteria database is composed of 7451 genomic sequences (created: Feb 23, 2016), where entries with the word ‚Äòplasmid‚Äô in the fasta header were compiled into a separate plasmid database composed of 4429 genomic sequences.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec004">
    <title>Methods</title>
    <p>The MGmapper package consists of a pipeline of scripts to process FASTQ files as either single or paired-end reads to perform sequence mapping and taxonomy annotation against user defined reference sequence databases. MGmapper utilizes a number of publicly available programs: Cutadapt [<xref rid="pone.0176469.ref017" ref-type="bibr">17</xref>] for trimming and adaptor removal, BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>] and SAMtools [<xref rid="pone.0176469.ref018" ref-type="bibr">18</xref>] to produce and process the reference based sequence alignments to one of many reference sequence databases. A short summary of the procedure is described below for paired-end sequence data, followed by more details outlined in the section ‚Äú<italic>Fastq mapping procedure‚Äù</italic>.</p>
    <p>Initially, a filtering step checks for properly paired reads, followed by trimming and adaptor removal. The biological relevant reads are obtained by always mapping to a PhiX bacteria phage and continuing with the subset of reads that do not align to the PhiX genome (commonly used as a control in Illumina sequencing runs). Next, sequence reads are mapped to user defined reference sequences and only properly paired reads are accepted, provided that both reads pass a lower alignment score threshold and relative alignment length. After mapping reads to all reference sequence databases (eg human, bacteria, fungi etc.), some reads may align to reference sequences in different databases and depending on the mapping mode (<italic>bestmode</italic> or <italic>fullmode</italic> explained further down) the best hit is identified and used to assign taxonomy. Taxonomy annotations (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz">ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz</ext-link>) are added via lookup in a pre-made Kyoto Cabinet database (<ext-link ext-link-type="uri" xlink:href="http://fallabs.com/kyotocabinet/">http://fallabs.com/kyotocabinet/</ext-link>) containing <italic>key</italic>, <italic>value</italic> pairs in form of the reference sequence name (the <italic>key</italic>) and full taxonomy path from strain to superfamily clades (the <italic>value</italic>). Finally, a post-processing step (section ‚Äú<italic>post-processing</italic>‚Äù) identifies confident assignments at strain, species, genus or any user defined taxonomy clade up to superfamily.</p>
    <p>MGmapper can map sequence reads against any nucleotide sequence database i.e. both genomic and gene sequence databases and for each database the mapping can be performed in either <italic>bestmode</italic> or <italic>fullmode</italic>. In <italic>bestmode</italic>, reads are assigned to only one reference sequence if it is the best hit that is observed when mapping to all databases specified for <italic>bestmode</italic> mapping. Best hit is identified based on the highest alignment score. In <italic>fullmode</italic> reads are assigned to a reference sequence even if a better hit is seen when mapping to another database. Typically the <italic>fullmode</italic> is used to search for sequences (e.g. a gene database), that may be a subset of another database (e.g. a full genome database). Analyzing a sample for both genomic bacterial composition and anti-microbial resistance genes is a situation where MGmapper should be run with the bacterial database specified for <italic>bestmode</italic> mapping and at the same time specifying the anti-microbial resistance gene database for <italic>fullmode</italic> mapping. The reason is that the resistance genes are or may be a subset of the bacterial genomic sequences and we want to assign a sequence read both a bacteria genome and also a resistance gene. If both databases were specified for <italic>bestmode</italic> mapping (bacteria, anti-microbial genes), then a read can only be assigned to one of the databases and if identical alignment scores are observed, then priority is to the database that was specified first.</p>
    <sec id="sec005">
      <title>Fastq read mapping procedure</title>
      <p>The MGmapper pipeline analysis is done in four main steps: I. Pre-processing of raw reads to remove potential positive control reads, II. Mapping of reads to one or more reference sequence databases and filtration of alignment hits, III. Identification the best hits, and IV. Post-processing of taxonomy annotations and preparation of excel and text files with insert-size distribution, size normalized abundances, read and nucleotide count statistics, depth, and coverage. A schematic flowchart of the paired-end mapping processing is shown in <xref ref-type="fig" rid="pone.0176469.g001">Fig 1</xref>.</p>
      <fig id="pone.0176469.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0176469.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A schematic flowchart for processing of paired-end sequences with MGmapper.</title>
          <p>MGmapper processes fastq reads in four steps. These consist of: (I) Trimming and mapping reads against a phiX bacteriophage to remove potential positive control reads. (II) Mapping to specified reference databases, post-processing of BWA-mem alignments to remove reads with low alignment score or insufficient alignment coverage. (III) Identification of best hits in <italic>bestmode</italic>: Assignment of a read-pairs to only one specific reference sequence based on the highest sum of alignment scores. In <italic>fullmode</italic>, assigned a read-pair to a reference sequence even if a higher alignment score is found when mapping to another reference sequence database. This will provide best target match, considering only the sequences present in one particular reference database. (IV) Compilation of abundance statistics, read and nucleotide counts, depth, coverage, and summary reports.</p>
        </caption>
        <graphic xlink:href="pone.0176469.g001"/>
      </fig>
      <sec id="sec006">
        <title>I. Pre-processing of raw reads</title>
        <p>An optional trimming and filtering of raw reads is performed by use of the Cutadapt [<xref rid="pone.0176469.ref017" ref-type="bibr">17</xref>] program. Users can skip this step if reads are already trimmed. Default setting is that reads are initially trimmed before searching for adaptor sequences (equivalent to the Cutadapt option‚Äîq). In addition, a read is discarded unless a minimum of 30 nucleotides remains after trimming. Trimmed reads are next paired up and singleton reads are removed when using the paired-end version of MGmapper. To this follows another cleaning process where reads from potential PhiX Control v3 adapter-ligated libraries are removed via BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>] and SAMtools [<xref rid="pone.0176469.ref018" ref-type="bibr">18</xref>], as they may originate from a control for Illumina sequencing runs (<ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/products/phix_control_v3.html">http://www.illumina.com/products/phix_control_v3.html</ext-link>). The outcome is a cleaned set of reads that are believed to originate from the biological sample of interest. The number of reads in this set (noPhiX dataset) is set to 100% and used for calculation of R_abundance, a read count abundance measure.</p>
      </sec>
      <sec id="sec007">
        <title>II. Mapping of reads to reference sequence databases and alignment based filtering</title>
        <p>FASTQ reads are first extracted from the noPhiX set and mapped to one or several reference databases via ‚Äò<italic>bwa mem‚Äît procs‚ÄîM database‚Äô</italic> marking shorter splits as secondary hits, which are then removed when piping to ‚Äò<italic>samtools view -F 256 -Sb -f2‚Äô</italic> in paired-end mode or ‚Äò<italic>samtools view -F 260 ‚ÄìSb‚Äô</italic> in single-end mode i.e. keeping properly paired reads or mapped reads, respectively. Next, reads with insufficient alignment qualities are removed based on user-defined minimum alignment score (MAS) and minimum fraction of nucleotides being assigned with an ‚ÄòM‚Äô state in the CIGAR format, where an ‚ÄòM‚Äô indicates a match or mismatch. The user-defined threshold for fraction of matches+mismatches (FMM) is in relation to the full length of a read. In paired-end mapping both reads are removed if just one of them does not fulfill the filtering criteria. Default settings in the MGmapper programs are MAS = 30 and FMM = 0.8. At this step properly paired read may align to more than one reference sequences, located in different reference sequence databases. In <italic>bestmode</italic> a read pair can only be assigned to one reference sequence (section ‚Äú<italic>Identification of the best hit</italic>‚Äù).</p>
      </sec>
      <sec id="sec008">
        <title>III. Identification of the best hit</title>
        <p>Having paired-end sequences, both the forward and the reverse fastq reads are aligned to a reference sequence, each with an associated alignment score. The sum of alignment scores (SAS) is used as a measure to identify the best hit for a read-pair. Typically, all input query reads are mapped to multiple reference sequence databases e.g. bacteria, virus, fungi, human and others. Thus a read-pair may map to multiple reference sequences from different databases and in <italic>bestmode</italic> the taxonomy annotation is only assigned to one best hit, namely the one with the highest SAS score.</p>
        <p>For single-end reads mapped to several databases, the best hit is the one with the highest alignment score. In cases where a read or read-pair achieves identical alignment scores to reference sequences from different databases, the priority is given to the order by which the databases are specified by the user, and thus a read or read-pair can still be associated to one single reference sequence.</p>
      </sec>
      <sec id="sec009">
        <title>IV. Output and post-processing of results</title>
        <p>The fastq reads are mapped to multiple user-defined reference sequence databases. A tab-separated file is produced for each database including reference sequence hits with read count statistics provided at strain level. A strain is named according to the header name originating from the fasta file that was used to make the database. The tab-separated file is composed of 14+16 columns of read count statistics and annotations, where the latter are taxid and taxonomy clade name for 8 clades, i.e. strain, species, genus, family, order, class, order and superfamily.</p>
        <p>The first 14 columns are described below in <xref rid="pone.0176469.t002" ref-type="table">Table 2</xref>.</p>
        <table-wrap id="pone.0176469.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Read count statistics and reference sequence information.</title>
          </caption>
          <alternatives>
            <graphic id="pone.0176469.t002g" xlink:href="pone.0176469.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Column identifier</th>
                  <th align="left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Database</td>
                  <td align="left" rowspan="1" colspan="1">Name of reference sequence database</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Ref. seq</td>
                  <td align="left" rowspan="1" colspan="1">Name of reference sequence or clade name</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">S_Abundance(10^2)</td>
                  <td align="left" rowspan="1" colspan="1">Size normalized read count abundance</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">R_Abundance(%)</td>
                  <td align="left" rowspan="1" colspan="1">Read count abundance</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Size(bp)</td>
                  <td align="left" rowspan="1" colspan="1">Size of reference sequence</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Seq_count</td>
                  <td align="left" rowspan="1" colspan="1">Number of sequences in the clade (always 1 at strain level)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Nucleotides</td>
                  <td align="left" rowspan="1" colspan="1">Total number of nucleotides mapped to reference sequence</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Covered positions</td>
                  <td align="left" rowspan="1" colspan="1">Number of nucleotide positions covered by the reads</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Coverage</td>
                  <td align="left" rowspan="1" colspan="1">Covered positions/size of ref sequence</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Depth</td>
                  <td align="left" rowspan="1" colspan="1">Nucleotides/size of ref sequence</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">ReadCount</td>
                  <td align="left" rowspan="1" colspan="1">Number of reads mapped a ref seq or clade</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">ReadCount uniq</td>
                  <td align="left" rowspan="1" colspan="1">Number of uniquely mapped reads a ref seq or clade</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Mismatches</td>
                  <td align="left" rowspan="1" colspan="1">Number of nucleotide mismatches also known as edit-distance</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Description</td>
                  <td align="left" rowspan="1" colspan="1">Description from fasta header or clade name</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t002fn001">
              <p>The size normalized abundance is calculated as S_Abundance = ‚ÄòReadCount x 100/Size‚Äô for single-end reads and ‚ÄòReadCount x100/(2 x Size)‚Äô for paired-end reads. R_Abundance(%) is the number of reads mapped to a taxonomy clade in relation to number of reads after trimming and cleaning versus PhiX genome.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>The tab-separated files contains the unprocessed results as obtained by the BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>] mapping and Samtools mpileup [<xref rid="pone.0176469.ref018" ref-type="bibr">18</xref>]. As false positive annotations are likely to be present, a subset of confident mapping results is obtained at a specified clade level (strain, species ‚Ä¶superfamily) via a post-processing procedure described in the section below.</p>
      </sec>
      <sec id="sec010">
        <title>Post-processing</title>
        <p>A combination of four criteria (I-IV) is used to identify a positive taxonomy annotation. Identifiers highlighted in italics are also described in <xref rid="pone.0176469.t002" ref-type="table">Table 2</xref>.</p>
        <list list-type="simple">
          <list-item>
            <label>I</label>
            <p>Minimum <italic>ReadCount</italic> of 10</p>
          </list-item>
          <list-item>
            <label>II</label>
            <p>Mismatch ratio &lt; 0.01, defined as <italic>Mismatches/Nucloetides</italic>.</p>
          </list-item>
          <list-item>
            <label>III</label>
            <p><italic>S_Abundance</italic>, the size normalized abundance &gt; 0.01.</p>
          </list-item>
          <list-item>
            <label>IV</label>
            <p>Unique read count fraction &gt; 0.5%, defined as <italic>ReadCount uniq/ReadCount</italic>.</p>
          </list-item>
        </list>
        <p>At strain level all four criteria are imposed. At species level, the criteria IV is used in a pre-cycle, to identify the lowest S_Abundance for the selected species. The new S_Abundance threshold is used in a second round where criteria IV are omitted. At genus level or higher only criteria I, II and III are used.</p>
        <p>Taxid values are used to identify strains belonging to the same species or species belonging to the same genus etc. All identifiers as shown in <xref rid="pone.0176469.t002" ref-type="table">Table 2</xref>, are summed at clade levels higher than strain i.e. the S_Abundance value for a species is the sum of all strain S_Abundance values. It is likewise for R_Abundance, Size, Seq_Count, Nucleotides, Covered positions, Coverage Depth, ReadCount, ReadCount uniq and Mismatches.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec011">
    <title>Results</title>
    <p>Benchmarking of MGmapper at strain, species and genus level against the <italic>in vitro</italic> and the four <italic>in silico</italic> datasets is shown in Tables <xref rid="pone.0176469.t003" ref-type="table">3</xref> and <xref rid="pone.0176469.t004" ref-type="table">4</xref>. Excel sheets are provided as supplementary information in <xref ref-type="supplementary-material" rid="pone.0176469.s001">S1</xref>‚Äì<xref ref-type="supplementary-material" rid="pone.0176469.s010">S10</xref> Files, at strain and species level for both annotations that passes the post-processing criteria and for those that are rejected. Also, plasmids sequence annotations are provided in the supplementary excel sheets.</p>
    <table-wrap id="pone.0176469.t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Benchmarking of the <italic>in vitro</italic> data mapped against a bacteria reference sequence database.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0176469.t003g" xlink:href="pone.0176469.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Clade level</th>
              <th align="left" rowspan="1" colspan="1">TP</th>
              <th align="left" rowspan="1" colspan="1">FN</th>
              <th align="left" rowspan="1" colspan="1">FP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Strain</td>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Species</td>
              <td align="left" rowspan="1" colspan="1">11</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Genus</td>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t003fn001">
          <p>The columns TP, FN and FP refer to the true positive, false negative and false positive taxonomy annotations for strain, species and genus, respectively.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="pone.0176469.t004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t004</object-id>
      <label>Table 4</label>
      <caption>
        <title>Benchmarking of the <italic>in silico</italic> data mapped against a bacteria reference sequence database.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0176469.t004g" xlink:href="pone.0176469.t004"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Clade level</th>
              <th align="left" rowspan="1" colspan="1">TP</th>
              <th align="left" rowspan="1" colspan="1">FN</th>
              <th align="left" rowspan="1" colspan="1">FP</th>
              <th align="left" rowspan="1" colspan="1">Dataset id</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Strain</td>
              <td align="left" rowspan="1" colspan="1">11</td>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">A</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Species</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Genus</td>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Strain</td>
              <td align="left" rowspan="1" colspan="1">11</td>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">B</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Species</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Genus</td>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Strain</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">C</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Species</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Genus</td>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Strain</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">D</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Species</td>
              <td align="left" rowspan="1" colspan="1">12</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Genus</td>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t004fn001">
          <p>The columns TP, FN and FP refer to the true positive, false negative and false positive taxonomy annotations for strain, species and genus, respectively. The column ‚ÄòDataset id‚Äô referees to the four datasets A, B, C and D with read lengths of 100bp, 250bp, 500bp and 1000bp, respectively.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>A summary of mapping the <italic>in vitro</italic> and <italic>in silico</italic> datasets are shown in Tables <xref rid="pone.0176469.t003" ref-type="table">3</xref> and <xref rid="pone.0176469.t004" ref-type="table">4</xref>, respectively.</p>
    <p>For both the <italic>in vitro</italic> data and the four <italic>in silico</italic> datasets, MGmapper identifies all species correctly with no false positive predictions.</p>
    <p>The work by Peabody et al. [<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>] benchmarked several methods at species level using a read count abundance &gt; 0.1% for the <italic>in vitro</italic> data and the <italic>in silico</italic> dataset (although only for the 250bp dataset).</p>
    <p>When benchmarked against the <italic>in vitro</italic> dataset, the methods that correctly identified all species with no false positives were a filtered version of Kraken [<xref rid="pone.0176469.ref009" ref-type="bibr">9</xref>] and CARMA3 [<xref rid="pone.0176469.ref010" ref-type="bibr">10</xref>]. For the <italic>in silico</italic> dataset (250bp), six methods performed with no errors i.e. CLARK, Kraken, Kraken filtered, MEGAN4 BLASTN, MetaCV and RITA.</p>
    <p>In <xref rid="pone.0176469.t003" ref-type="table">Table 3</xref> we showed that MGmapper was able to identify all species and genuses present in the <italic>in vitro</italic> dataset without any false positives. Peabody et al., reported that a filtered version of Kraken the same result. Both MGmapper and the filtered version of Kraken need to reject sequence reads in order to report only reliable annotations. In Tables <xref rid="pone.0176469.t005" ref-type="table">5</xref> and <xref rid="pone.0176469.t006" ref-type="table">6</xref> MGmapper and Kraken have been benchmarked on the percentage of reads that are assigned to each of the genusus and species present in the <italic>in vitro</italic> dataset. The Kraken data was prepared by filtering the read assignments, using a threshold in kraken-filter (version 0.10.6-unreleased-20160118) of 0.2. Next, setting a fair read count abundance threshold for Kraken is not straightforward. We chose to set it at 1.1% such that all species were correctly identified by the Kraken method with no false positives. Also, at genus level a threshold was set at 2.2% to identify all 8 genuses with no false positives. The filters for MGmapper were those described in section ‚ÄòPost-processing‚Äô. Using these filters the read count abundances are shown in Tables <xref rid="pone.0176469.t005" ref-type="table">5</xref> and <xref rid="pone.0176469.t006" ref-type="table">6</xref> at genus and species level, respectively. The comparison shows that there is a high degree of similarity between the reported abundances for the individual species and genuses. Also, it shows that fewer reads are mis-classified by MGmapper where a higher total fraction of reads that have been correctly assigned at genus and species clade levels. A strain level comparison was not possible as taxid numbers that are now obsolete and only provided at species level and above.</p>
    <table-wrap id="pone.0176469.t005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t005</object-id>
      <label>Table 5</label>
      <caption>
        <title>Read count benchmark at genus level.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0176469.t005g" xlink:href="pone.0176469.t005"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Genus</th>
              <th align="left" rowspan="1" colspan="1">Read count abundance MGmapper (%)</th>
              <th align="left" rowspan="1" colspan="1">Read count abundance Kraken (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pseudomonas</td>
              <td align="char" char="." rowspan="1" colspan="1">34.82</td>
              <td align="char" char="." rowspan="1" colspan="1">34.98</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Bacillus</td>
              <td align="char" char="." rowspan="1" colspan="1">11.22</td>
              <td align="char" char="." rowspan="1" colspan="1">11.21</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Burkholderia</td>
              <td align="char" char="." rowspan="1" colspan="1">8.05</td>
              <td align="char" char="." rowspan="1" colspan="1">7.05</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Micrococcus</td>
              <td align="char" char="." rowspan="1" colspan="1">7.68</td>
              <td align="char" char="." rowspan="1" colspan="1">7.74</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Escherichia</td>
              <td align="char" char="." rowspan="1" colspan="1">7.53</td>
              <td align="char" char="." rowspan="1" colspan="1">2.48</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Frankia</td>
              <td align="char" char="." rowspan="1" colspan="1">7.31</td>
              <td align="char" char="." rowspan="1" colspan="1">7.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Streptomyces</td>
              <td align="char" char="." rowspan="1" colspan="1">7.24</td>
              <td align="char" char="." rowspan="1" colspan="1">7.29</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Rhodobacter</td>
              <td align="char" char="." rowspan="1" colspan="1">6.91</td>
              <td align="char" char="." rowspan="1" colspan="1">6.96</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="char" char="." rowspan="1" colspan="1">90.76</td>
              <td align="char" char="." rowspan="1" colspan="1">87.21</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t005fn001">
          <p>‚ÄòRead count abundance‚Äô is reported as the percentage of reads that were assigned to each of the 8 genuses present in the <italic>in vitro</italic> dataset for the two methods; MGmapper and Kraken. Last row ‚ÄòTotal‚Äô is the overall percentage sum of reads that were assigned to genuses present in the sample.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="pone.0176469.t006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0176469.t006</object-id>
      <label>Table 6</label>
      <caption>
        <title>Read count benchmark at species level.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0176469.t006g" xlink:href="pone.0176469.t006"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Species</th>
              <th align="left" rowspan="1" colspan="1">Read count Abundance MGmapper (%)</th>
              <th align="left" rowspan="1" colspan="1">Read count Abundance Kraken (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pseudomonas aeruginosa</td>
              <td align="char" char="." rowspan="1" colspan="1">15.93</td>
              <td align="char" char="." rowspan="1" colspan="1">15.93</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pseudomonas protegens</td>
              <td align="char" char="." rowspan="1" colspan="1">10.81</td>
              <td align="char" char="." rowspan="1" colspan="1">10.76</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pseudomonas putida</td>
              <td align="char" char="." rowspan="1" colspan="1">7.95</td>
              <td align="char" char="." rowspan="1" colspan="1">7.44</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Micrococcus luteus</td>
              <td align="char" char="." rowspan="1" colspan="1">7.68</td>
              <td align="char" char="." rowspan="1" colspan="1">7.74</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Escherichia coli</td>
              <td align="char" char="." rowspan="1" colspan="1">7.52</td>
              <td align="char" char="." rowspan="1" colspan="1">2.37</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Frankia sp. CcI3</td>
              <td align="char" char="." rowspan="1" colspan="1">7.31</td>
              <td align="char" char="." rowspan="1" colspan="1">7.36</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Rhodobacter capsulatus</td>
              <td align="char" char="." rowspan="1" colspan="1">6.91</td>
              <td align="char" char="." rowspan="1" colspan="1">6.96</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Burkholderia cenocepacia</td>
              <td align="char" char="." rowspan="1" colspan="1">6.17</td>
              <td align="char" char="." rowspan="1" colspan="1">4.19</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Bacillus amyloliquefaciens</td>
              <td align="char" char="." rowspan="1" colspan="1">5.75</td>
              <td align="char" char="." rowspan="1" colspan="1">1.96</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Streptomyces coelicolor</td>
              <td align="char" char="." rowspan="1" colspan="1">5.38</td>
              <td align="char" char="." rowspan="1" colspan="1">4.40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Bacillus cereus</td>
              <td align="char" char="." rowspan="1" colspan="1">3.40</td>
              <td align="char" char="." rowspan="1" colspan="1">1.34</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="char" char="." rowspan="1" colspan="1">84.82</td>
              <td align="char" char="." rowspan="1" colspan="1">70.45</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t006fn001">
          <p>‚ÄòRead count abundance‚Äô is reported as the percentage of reads that were assigned to each of the 11 species present in the <italic>in vitro</italic> dataset for the two methods; MGmapper and Kraken. Last row ‚ÄòTotal‚Äô is the overall percentage sum of reads that were assigned to the species present in the sample.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Discussion</title>
    <p>The intention behind the development of the MGmapper pipeline is to simplify the processing of next generation sequences from biological samples, and to enable users an easy access to an NGS analysis without necessarily understanding all the computational details of the process. Also, setting up threshold values to provide reliable taxonomy annotations by reducing the number of false positives.</p>
    <p>In its present form MGmapper follows a mapping protocols against reference sequence databases, and provide BAM files, text and Excel summary files. These contain read-count statistics for those reference sequences that passed a post-processing procedure, but also for those annotated reference sequences that did not meet the criteria set up in the post-processing, thus enabling a user to see discarded mapping results and possibly redo the post-processing if other threshold settings are preferred. Thus no time consuming fastq mapping needs to be re-done, just the fast post-processing that finishes in seconds.</p>
    <p>One of the challenging issues that arise when short sequence reads are mapped against a set of reference sequences is that a read, or a pair of reads, may map equally well to more than one reference in a sequence database i.e. multiple hits with identical alignment scores. When this happens, the reference sequence assignment reported by BWA-mem [<xref rid="pone.0176469.ref015" ref-type="bibr">15</xref>] is arbitrary, as there is not yet any procedure available to unravel the multiple hit ambiguity. However, the fact that there are a number of reads that can be uniquely assigned to one single reference sequence, is a strong indicator that a reported strain or species is actually the one present in the sample. Benchmarking against an <italic>in vitro</italic> dataset, we obtained a sensitivity and precision at 75% for taxonomy annotations at strain level resolution. At higher clade level annotations we identified all species and genuses with no false positives.</p>
    <p>The four <italic>in silico</italic> datasets proved easier to annotate correctly compared to the <italic>in vitro</italic> dataset. Only two false negatives were observed at strain level for the 100bp and 250bp datasets and one false negative for the 500bp and 1000bp datasets. At higher clade level annotations, i.e., species and genus, we obtained 100% correct taxonomy annotation. As the most challenging sample was the <italic>in vitro</italic> dataset, we used that in a benchmark analysis to the well performing Kraken method [<xref rid="pone.0176469.ref009" ref-type="bibr">9</xref>]. Overall the MGmapper method correctly assigned 84.82% of the reads at species level, compared to the Kraken method that assigned 70.45% of the reads correctly. At genus level the percentages were 90.75% and 87.21% for MGmapper and Kraken, respectively.</p>
    <p>Benchmarking of metagenomics taxonomy classification methods is a challenging effort as programs produce different output and the benchmarking can be done in terms of correctly annotated reads or collapsed into strain/species annotations, run time and memory usage. We chose to compare to the extensive work by Peabody et al. [<xref rid="pone.0176469.ref008" ref-type="bibr">8</xref>], where methods were benchmarked to correctly identify species taxonomy. One of the main results from that study was that all methods, evaluated on an <italic>in vitro</italic> dataset, vastly over predicted the number of species present in a sample unless a post-processing was performed. In this work we have shown that our mapping results together with the post-processing procedure provide 100% correct taxonomy annotations at species and genus level and even at strain level resolution we have trustworthy annotations with sensitivity and precision at 75% when using a combination of up to four criteria to filter the initial mapping results. However, those datasets have limited complexity and for real metagenomics data we can expect much more diversity compared to the 11 and 12 species that are present in the <italic>in vitro</italic> and <italic>in silico</italic> datasets. Metagenomic samples from soil, human gut, sewage or public sites like metro stations, will likely contain a highly diverse set of organisms and also many closely related strains. Reference based sequence alignment methods allow for nucleotide mis-matches between a query read and a reference sequence and the mis-match threshold can be adjusted to assign sequence reads with a remote identity. For practical purposes, a threshold at 10‚Äì15% nucleotide mis-matches may be used. A specific organism assigned to be present in a sample may be a representative sequence for closely related sequences with nucleotide variations (SNPs or INDEls). Also Kmer based methods are challenged by highly diverse metagenomics data as they rely on perfect matches between a query fragment and a database hit.</p>
    <p>The mapping procedure is the most time-consuming task when running MGmapper. Small datasets that only needs to be mapped against a bacteria, plasmid, fungi or virus databases will finish within minutes up to an hour, whereas mapping millions of fastq reads against many big reference sequence databases like plant (208gb fasta), vertebrate mammals (316gb fasta), invertebrates (150gb fasta) and nt (125gb fasta) will finish days (3‚Äì7) even when run in parallel on 16 processors. The <italic>in vitro</italic> and <italic>in silico</italic> datasets used in this study were both run against a bacteria and a plasmid database using 8 cores. The runtime for each of the datasets was 7 min using Computerome‚Äîthe Danish National Supercomputer for Life Sciences (<ext-link ext-link-type="uri" xlink:href="https://computerome.dtu.dk/">https://computerome.dtu.dk/</ext-link>).</p>
    <p>In future golden benchmark dataset would be most welcome and initiatives like <ext-link ext-link-type="uri" xlink:href="https://data.cami-challenge.org/">CAMI</ext-link> (Critical Assessment of Metagenome Interpretation) may be a useful platform for benchmark comparison of metagenomics classification tools.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec013">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0176469.s001">
      <label>S1 File</label>
      <caption>
        <title>Strain and species from in-vitro dataset that pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s001.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s002">
      <label>S2 File</label>
      <caption>
        <title>Strain and species from in-vitro dataset that do not pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s003">
      <label>S3 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (100bp) that pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s004">
      <label>S4 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (100bp) that do not pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s005">
      <label>S5 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (250bp) that pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s005.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s006">
      <label>S6 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (250bp) that do not pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s007">
      <label>S7 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (500bp) that pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s008">
      <label>S8 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (500bp) that do not pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s009">
      <label>S9 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (1000bp) that pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0176469.s010">
      <label>S10 File</label>
      <caption>
        <title>Strain and species from in-silico dataset (1000bp) that do not pass post-processing filters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0176469.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Peter Wad Sackett and John Damm S√∏rensen for their contribution to programming and computational setup of the pipeline. This study was funded by the European Community's Seventh Framework Programme [FP7/2007‚Äì2013], under grant agreement n¬∞613754, and by The Villum Foundation (VKR023052).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0176469.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Mackelprang</surname><given-names>R</given-names></name>, <name><surname>Waldrop</surname><given-names>MP</given-names></name>, <name><surname>DeAngelis</surname><given-names>KM</given-names></name>, <name><surname>David</surname><given-names>MM</given-names></name>, <name><surname>Chavarria</surname><given-names>KL</given-names></name>, <name><surname>Blazewicz</surname><given-names>SJ</given-names></name>, <etal>et al</etal><article-title>Metagenomic analysis of a permafrost microbial community reveals a rapid response to thaw</article-title>. <source>Nature</source>. <year>2011</year> pp. <fpage>368</fpage>‚Äì<lpage>371</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0176469.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Mason</surname><given-names>OU</given-names></name>, <name><surname>Scott</surname><given-names>NM</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Robbins-Pianka</surname><given-names>A</given-names></name>, <name><surname>B√¶lum</surname><given-names>J</given-names></name>, <name><surname>Kimbrel</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Metagenomics reveals sediment microbial community response to Deepwater Horizon oil spill</article-title>. <source>ISME J</source>. <year>2014</year>;<volume>8</volume>: <fpage>1464</fpage>‚Äì<lpage>75</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2013.254</pub-id><?supplied-pmid 24451203?><pub-id pub-id-type="pmid">24451203</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Hazen</surname><given-names>TC</given-names></name>, <name><surname>Dubinsky</surname><given-names>EA</given-names></name>, <name><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name><surname>Andersen</surname><given-names>GL</given-names></name>, <name><surname>Piceno</surname><given-names>YM</given-names></name>, <name><surname>Singh</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Deep-sea oil plume enriches indigenous oil-degrading bacteria</article-title>. <source>Science</source>. <year>2010</year>;<volume>330</volume>: <fpage>204</fpage>‚Äì<lpage>208</lpage>. <pub-id pub-id-type="doi">10.1126/science.1195979</pub-id><?supplied-pmid 20736401?><pub-id pub-id-type="pmid">20736401</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Hauptmann</surname><given-names>AL</given-names></name>, <name><surname>Stibal</surname><given-names>M</given-names></name>, <name><surname>B√¶lum</surname><given-names>J</given-names></name>, <name><surname>Sicheritz-Pont√©n</surname><given-names>T</given-names></name>, <name><surname>Brunak</surname><given-names>S</given-names></name>, <name><surname>Bowman</surname><given-names>JS</given-names></name>, <etal>et al</etal><article-title>Bacterial diversity in snow on North Pole ice floes</article-title>. <source>Extremophiles</source>. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pone.0176469.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Arumugam</surname><given-names>M</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Pelletier</surname><given-names>E</given-names></name>, <name><surname>Le Paslier</surname><given-names>D</given-names></name>, <name><surname>Yamada</surname><given-names>T</given-names></name>, <name><surname>Mende</surname><given-names>DR</given-names></name>, <etal>et al</etal><article-title>Enterotypes of the human gut microbiome</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>: <fpage>174</fpage>‚Äì<lpage>180</lpage>. <pub-id pub-id-type="doi">10.1038/nature09944</pub-id><?supplied-pmid 21508958?><pub-id pub-id-type="pmid">21508958</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>HB</given-names></name>, <name><surname>Almeida</surname><given-names>M</given-names></name>, <name><surname>Juncker</surname><given-names>AS</given-names></name>, <name><surname>Rasmussen</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>: <fpage>822</fpage>‚Äì<lpage>828</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2939</pub-id><?supplied-pmid 24997787?><pub-id pub-id-type="pmid">24997787</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>, <name><surname>Sch√§ffer</surname><given-names>AA</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: A new generation of protein database search programs</article-title>. <source>Nucleic Acids Research</source>. <year>1997</year> pp. <fpage>3389</fpage>‚Äì<lpage>3402</lpage>. <?supplied-pmid 9254694?><pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Peabody</surname><given-names>MA</given-names></name>, <name><surname>Van Rossum</surname><given-names>T</given-names></name>, <name><surname>Lo</surname><given-names>R</given-names></name>, <name><surname>Brinkman</surname><given-names>FSL</given-names></name>. <article-title>Evaluation of shotgun metagenomics sequence classification methods using in silico and in vitro simulated communities</article-title>. <source>BMC Bioinformatics. BMC Bioinformatics</source>; <year>2015</year>;<volume>16</volume>: <fpage>363</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0176469.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wood</surname><given-names>DE</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>: <fpage>R46</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id><?supplied-pmid 24580807?><pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Gerlach</surname><given-names>W</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name>. <article-title>Taxonomic classification of metagenomic shotgun sequences with CARMA3</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>;<volume>39</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0176469.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Auch</surname><given-names>AF</given-names></name>, <name><surname>Qi</surname><given-names>J</given-names></name>, <name><surname>Schuster</surname><given-names>SC</given-names></name>. <article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>: <fpage>377</fpage>‚Äì<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id><?supplied-pmid 17255551?><pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Mitra</surname><given-names>S</given-names></name>, <name><surname>Ruscheweyh</surname><given-names>H-J</given-names></name>, <name><surname>Weber</surname><given-names>N</given-names></name>, <name><surname>Schuster</surname><given-names>SC</given-names></name>. <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>: <fpage>1552</fpage>‚Äì<lpage>1560</lpage>. <pub-id pub-id-type="doi">10.1101/gr.120618.111</pub-id><?supplied-pmid 21690186?><pub-id pub-id-type="pmid">21690186</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Ye</surname><given-names>Y</given-names></name>. <article-title>RAPSearch2: A fast and memory-efficient protein similarity search tool for next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>125</fpage>‚Äì<lpage>126</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr595</pub-id><?supplied-pmid 22039206?><pub-id pub-id-type="pmid">22039206</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Larsen</surname><given-names>M V.</given-names></name>, <name><surname>Cosentino</surname><given-names>S</given-names></name>, <name><surname>Lukjancenko</surname><given-names>O</given-names></name>, <name><surname>Saputra</surname><given-names>D</given-names></name>, <name><surname>Rasmussen</surname><given-names>S</given-names></name>, <name><surname>Hasman</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Benchmarking of methods for genomic taxonomy</article-title>. <source>J Clin Microbiol</source>. <year>2014</year>;<volume>52</volume>: <fpage>1529</fpage>‚Äì<lpage>1539</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.02981-13</pub-id><?supplied-pmid 24574292?><pub-id pub-id-type="pmid">24574292</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>589</fpage>‚Äì<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id><?supplied-pmid 20080505?><pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>F</given-names></name>, <name><surname>Paarmann</surname><given-names>D</given-names></name>, <name><surname>D‚ÄôSouza</surname><given-names>M</given-names></name>, <name><surname>Olson</surname><given-names>R</given-names></name>, <name><surname>Glass</surname><given-names>EM</given-names></name>, <name><surname>Kubal</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The metagenomics RAST server‚Äîa public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>: <fpage>386</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-386</pub-id><?supplied-pmid 18803844?><pub-id pub-id-type="pmid">18803844</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0176469.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>M</given-names></name>. <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>EMBnet.journal</source>. <year>2011</year>;<volume>17</volume>: <fpage>10</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0176469.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>2078</fpage>‚Äì<lpage>2079</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
