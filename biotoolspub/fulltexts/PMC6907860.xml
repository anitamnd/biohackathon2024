<?properties open_access?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6907860</article-id>
    <article-id pub-id-type="pmid">31790389</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01111</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007510</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Random Variables</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Spectrophotometry</subject>
            <subj-group>
              <subject>Cytophotometry</subject>
              <subj-group>
                <subject>Flow Cytometry</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>Antibody-Producing Cells</subject>
                  <subj-group>
                    <subject>B Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>Antibody-Producing Cells</subject>
              <subj-group>
                <subject>B Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>Antibody-Producing Cells</subject>
              <subj-group>
                <subject>B Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>B Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>B Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>B Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>B Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Extraction techniques</subject>
          <subj-group>
            <subject>RNA extraction</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CDSeq: A novel complete deconvolution method for dissecting heterogeneous samples using gene expression data</article-title>
      <alt-title alt-title-type="running-head">A novel complete deconvolution method for dissecting heterogeneous samples</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4348-3941</contrib-id>
        <name>
          <surname>Kang</surname>
          <given-names>Kai</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meng</surname>
          <given-names>Qian</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shats</surname>
          <given-names>Igor</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7142-2812</contrib-id>
        <name>
          <surname>Umbach</surname>
          <given-names>David M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5223-0092</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Melissa</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0320-5664</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Yuanyuan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Xiaoling</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4208-0259</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Leping</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Biostatistics and Computational Biology Branch, National Institute of Environmental Health Sciences, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Signal Transduction Laboratory, National Institute of Environmental Health Sciences, Durham, North Carolina, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Przytycka</surname>
          <given-names>Teresa M.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>National Center for Biotechnology Information (NCBI), UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>kai.kang@nih.gov</email> (KK); <email>li3@niehs.nih.gov</email> (LL)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>e1007510</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">
        <license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0</ext-link> public domain dedication.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007510.pdf"/>
    <abstract>
      <p>Quantifying cell-type proportions and their corresponding gene expression profiles in tissue samples would enhance understanding of the contributions of individual cell types to the physiological states of the tissue. Current approaches that address tissue heterogeneity have drawbacks. Experimental techniques, such as fluorescence-activated cell sorting, and single cell RNA sequencing are expensive. Computational approaches that use expression data from heterogeneous samples are promising, but most of the current methods estimate either cell-type proportions or cell-type-specific expression profiles by requiring the other as input. Although such partial deconvolution methods have been successfully applied to tumor samples, the additional input required may be unavailable. We introduce a novel complete deconvolution method, CDSeq, that uses only RNA-Seq data from bulk tissue samples to simultaneously estimate both cell-type proportions and cell-type-specific expression profiles. Using several synthetic and real experimental datasets with known cell-type composition and cell-type-specific expression profiles, we compared CDSeq’s complete deconvolution performance with seven other established deconvolution methods. Complete deconvolution using CDSeq represents a substantial technical advance over partial deconvolution approaches and will be useful for studying cell mixtures in tissue samples. CDSeq is available at GitHub repository (MATLAB and Octave code): <ext-link ext-link-type="uri" xlink:href="https://github.com/kkang7/CDSeq">https://github.com/kkang7/CDSeq</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Understanding the cellular composition of bulk tissues is critical to investigate the underlying mechanisms of many biological processes. Single cell sequencing is a promising technique, however, it is expensive and the analysis of single cell data is non-trivial. Therefore, tissue samples are still routinely processed in bulk. To estimate cell-type composition using bulk gene expression data, computational deconvolution methods are needed. Many deconvolution methods have been proposed, however, they often estimate only cell type proportions using a reference cell type gene expression profile, which in many cases may not be available. We present a novel complete deconvolution method that uses only bulk gene expression data to simultaneously estimate cell-type-specific gene expression profiles and sample-specific cell-type proportions. We showed that, using multiple RNA-Seq and microarray datasets where the cell-type composition was previously known, our method could accurately determine the cell-type composition. By providing a method that requires a single input to determine both cell-type proportion and cell-type-specific expression profiles, we expect that our method will be beneficial to biologists and facilitate the research and identification of mechanisms underlying many biological processes.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Institute of Environmental Health Sciences (US)</institution>
        </funding-source>
        <award-id>ES101765</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4208-0259</contrib-id>
          <name>
            <surname>Li</surname>
            <given-names>Leping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was supported by Intramural Research Program of the National Institutes of Health, National Institute of Environmental Health Sciences, <ext-link ext-link-type="uri" xlink:href="https://www.niehs.nih.gov">https://www.niehs.nih.gov</ext-link> (ES101765). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="1"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-12-12</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The GEO accession number for the experimental data is GSE123604.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The GEO accession number for the experimental data is GSE123604.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The measured expression of a gene in a bulk sample reflects the expression of that gene in every cell in the sample. Consequently, the measured gene expression profile (GEP) of a tissue sample is commonly regarded as a weighted average of the GEPs of the different component cell types [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1007510.ref002" ref-type="bibr">2</xref>].</p>
    <p>The heterogeneous nature of bulk tissue samples complicates the interpretation of bulk measurements such as RNA-Seq. Often researchers are interested in understanding whether an experimental treatment targets one particular cell type in a heterogeneous tissue or in investigating possible sources of variation among samples [<xref rid="pcbi.1007510.ref003" ref-type="bibr">3</xref>]. For example, the composition of tumor-infiltrating lymphocytes impacts tumor growth and patients’ clinical outcomes [<xref rid="pcbi.1007510.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1007510.ref009" ref-type="bibr">9</xref>]. With expression measurements on bulk tissue, it is often difficult to distinguish between low expression in a highly abundant cell type and high expression in less abundant cell type [<xref rid="pcbi.1007510.ref003" ref-type="bibr">3</xref>]. Consequently, understanding the cell-type composition of each sample and the GEP of each constituent cell type becomes important. “Deconvolution” is a generic term for a procedure that estimates the proportion of each cell type in a bulk sample together with their corresponding cell-type-specific GEPs [<xref rid="pcbi.1007510.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007510.ref011" ref-type="bibr">11</xref>]. Deconvolution can be approached experimentally using flow cytometry or single cell RNA sequencing. For solid tissues, these techniques require isolating individual cells, thereby presenting laboratory challenges as well as potentially sacrificing a systems perspective. Single cell RNA sequencing is also expensive and requires challenging data handling and analysis [<xref rid="pcbi.1007510.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1007510.ref013" ref-type="bibr">13</xref>].</p>
    <p>Deconvolution can also be approached computationally using GEP profiles from collections of bulk tissue samples [<xref rid="pcbi.1007510.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1007510.ref014" ref-type="bibr">14</xref>]. Many deconvolution methods have been developed in the past decade. The pioneering work of Venet et al. [<xref rid="pcbi.1007510.ref015" ref-type="bibr">15</xref>] employed an algorithm based on matrix factorization to deconvolve a matrix of GEPs (each normalized to sum to 1) into a product of two matrices, one containing the cell-type proportions for each sample and the other containing the GEPs for each cell type. The constraints required for each matrix in the product (proportions must be nonnegative and sum to 1 across cell types; expression levels must obey the same constraints across genes) impose technical challenges on matrix factorization in this context. Deconvolution methods that are based on nonnegative matrix factorization (NMF) may not be guaranteed to find cell-type-specific components [<xref rid="pcbi.1007510.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1007510.ref017" ref-type="bibr">17</xref>]. Consequently, most existing methods only perform partial deconvolution: either the algorithms require cell-type proportions as input to estimate cell-type-specific GEPs [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1007510.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1007510.ref020" ref-type="bibr">20</xref>] or vice versa [<xref rid="pcbi.1007510.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1007510.ref029" ref-type="bibr">29</xref>]. These methods generally use regression techniques and some also use marker genes [<xref rid="pcbi.1007510.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007510.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1007510.ref031" ref-type="bibr">31</xref>] to estimate the unknowns of interest. Such deconvolution approaches have shown important findings [<xref rid="pcbi.1007510.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1007510.ref031" ref-type="bibr">31</xref>], however they could suffer if the needed information is unavailable or if the fidelity of reference GEP profiles or cell-type proportions is questionable.</p>
    <p>Our goal was to develop a complete deconvolution method using only bulk RNA-Seq data by estimating cell-type proportions and cell-type-specific GEPs simultaneously. The underlying model was based on latent Dirichlet allocation (LDA) [<xref rid="pcbi.1007510.ref032" ref-type="bibr">32</xref>], a probabilistic model designed for natural language processing. LDA was designed to use text corpora as input and extract essential structure, namely, the topics that constitute the content of documents in the corpus. The problem of deriving abstract yet meaningful topics from a corpus of documents shares a fundamental similarity with the problem of extracting cell-type-specific information from bulk RNA-Seq data. The original LDA model cannot, however, fully capture the complexity of bulk RNA-Seq data. Although some existing methods are based on the LDA model [<xref rid="pcbi.1007510.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1007510.ref027" ref-type="bibr">27</xref>, <xref rid="pcbi.1007510.ref033" ref-type="bibr">33</xref>], those methods were designed for partial deconvolution and require cell-type-specific GEPs as input. We refer to our method as CDSeq (Complete Deconvolution for Sequencing data). We assessed CDSeq’s performance using several synthetic and real experimental datasets with known cell-type composition and cell-type-specific GEPs and compared it with seven other deconvolution methods.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Overview of CDSeq</title>
      <p>Using only bulk RNA-Seq expression data for multiple samples as input, CDSeq provides estimates of both cell-type-specific GEPs and sample-specific cell-type proportions simultaneously (<xref ref-type="fig" rid="pcbi.1007510.g001">Fig 1</xref>). Our model extends the LDA model in the following ways: first, the random variable that models cell-type-specific GEPs depends on gene length [<xref rid="pcbi.1007510.ref034" ref-type="bibr">34</xref>]; second, the probability of having a read from a cell type depends on both the proportion of that cell type present in a sample and the typical amount of RNA produced by cells of that type [<xref rid="pcbi.1007510.ref024" ref-type="bibr">24</xref>, <xref rid="pcbi.1007510.ref035" ref-type="bibr">35</xref>]. This second extension accommodates the possibility that different cell types produce different amounts of RNA, a circumstance that could bias estimates of cell-type proportions.</p>
      <fig id="pcbi.1007510.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic of the CDSeq approach.</title>
          <p>Heterogeneous samples consist of different cell types. The bulk RNA-Seq profile represents a weighted average of the expression profiles of the constituent cell types. CDSeq takes as input the bulk RNA-Seq data for a collection of samples and performs complete deconvolution that outputs estimates of both the cell-type-specific expression profiles and the cell-type proportions for each sample. This Figure depicts a simple scenario of six biological samples comprising four cell types, each with gene expression measurements on eight genes.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g001"/>
      </fig>
      <p>To describe our model and the statistical inference scheme, we first introduce the notation. Let <italic>M</italic> denote the number of samples and <italic>T</italic> denote the number of cell types comprising each heterogeneous sample. We model the vector containing the cell-type-specific proportions for sample <italic>i</italic>, denoted <italic>θ</italic><sub><italic>i</italic></sub> = (<italic>θ</italic><sub><italic>i</italic>,1</sub>, ⋯, <italic>θ</italic><sub><italic>i</italic>,<italic>T</italic></sub>) ∈ <italic>S</italic><sup><italic>T</italic></sup>, where <italic>S</italic><sup><italic>T</italic></sup> denotes a (<italic>T</italic> − 1)-simplex, as a Dirichlet random variable with hyperparameter <inline-formula id="pcbi.1007510.e001"><alternatives><graphic xlink:href="pcbi.1007510.e001.jpg" id="pcbi.1007510.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Next, let <italic>G</italic> denote the number of genes in the reference genome to which reads are mapped. We denote the GEP of pure cell type <italic>t</italic>, a vector of gene expression values for the entire genome normalized to sum to 1, as <italic>ϕ</italic><sub><italic>t</italic></sub> = (<italic>ϕ</italic><sub><italic>t</italic>,1</sub>, ⋯, <italic>ϕ</italic><sub><italic>t</italic>,<italic>G</italic></sub>) ∈ <italic>S</italic><sup><italic>G</italic></sup>, where <italic>S</italic><sup><italic>G</italic></sup> denotes a (<italic>G</italic> − 1)-simplex and model it as a Dirichlet random variable with hyperparameter <inline-formula id="pcbi.1007510.e002"><alternatives><graphic xlink:href="pcbi.1007510.e002.jpg" id="pcbi.1007510.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. With <italic>T</italic> cell types in all <italic>M</italic> samples, the matrices <italic>θ</italic> = [<italic>θ</italic><sub>1</sub>, ⋯, <italic>θ</italic><sub><italic>M</italic></sub>] and <italic>ϕ</italic> = [<italic>ϕ</italic><sub>1</sub>, ⋯, <italic>ϕ</italic><sub><italic>T</italic></sub>] encapsulate all the features that we seek to estimate from the data based on our model.</p>
      <p>We denote the true GEP of heterogeneous sample <italic>i</italic> by Φ<sub><italic>i</italic></sub> = (Φ<sub><italic>i</italic>,1</sub>, Φ<sub><italic>i</italic>,2</sub>, Φ<sub><italic>i</italic>,<italic>G</italic></sub>) ∈ <italic>S</italic><sup><italic>G</italic></sup>. Φ<sub><italic>i</italic></sub> is a weighted average of the pure cell-type GEPs with weights given by the sample-specific cell-type proportions, namely, <inline-formula id="pcbi.1007510.e003"><alternatives><graphic xlink:href="pcbi.1007510.e003.jpg" id="pcbi.1007510.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msub><mml:mo>Φ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. This random variable controls the rate of generating RNA copies from genes.</p>
      <p>We do not observe the true Φ<sub><italic>i</italic></sub> directly but instead observe reads from each sample and we can obtain the read assignments to genes. Assume that the length of every sequenced read, denoted <italic>m</italic>, is the same. Let categorical random variable <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> denote read <italic>j</italic> from sample <italic>i</italic> (after mapped to a gene, the possible outcomes of <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> depend on the gene and its length), and let categorical random variable <italic>g</italic><sub><italic>i</italic>,<italic>j</italic></sub> ∈ {1, ⋯, <italic>G</italic>} denote the gene or transcript assignment of read <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub>. Both <inline-formula id="pcbi.1007510.e004"><alternatives><graphic xlink:href="pcbi.1007510.e004.jpg" id="pcbi.1007510.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007510.e005"><alternatives><graphic xlink:href="pcbi.1007510.e005.jpg" id="pcbi.1007510.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are observed for every heterogeneous sample, where <italic>N</italic><sub><italic>i</italic></sub> denotes the number of reads from sample <italic>i</italic>. In transcript <italic>k</italic>, the number of positions in which a read can start is <inline-formula id="pcbi.1007510.e006"><alternatives><graphic xlink:href="pcbi.1007510.e006.jpg" id="pcbi.1007510.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> where <italic>ℓ</italic><sub><italic>k</italic></sub> is the length of transcript <italic>k</italic>. The adjusted length <inline-formula id="pcbi.1007510.e007"><alternatives><graphic xlink:href="pcbi.1007510.e007.jpg" id="pcbi.1007510.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is called the effective length of transcript <italic>k</italic>, then <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> has <inline-formula id="pcbi.1007510.e008"><alternatives><graphic xlink:href="pcbi.1007510.e008.jpg" id="pcbi.1007510.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> possibilities [<xref rid="pcbi.1007510.ref034" ref-type="bibr">34</xref>]. If the reads are mapped to genes instead of to transcript isoforms, then we need to consider the effective length of gene, denoted by <italic>ℓ</italic><sub><italic>g</italic></sub>, which is total length of all the transcripts comprising the gene after projection into genomic coordinates. All the analyses reported here were done on the gene level.</p>
      <p>Different cell types may generate different amounts of RNA owing to their varying sizes, therefore we employ a Poisson random variable with parameter <italic>η</italic><sub><italic>t</italic></sub> to model the number of reads generated from cell type <italic>t</italic>. Let <italic>η</italic> = (<italic>η</italic><sub>1</sub>, ⋯, <italic>η</italic><sub><italic>T</italic></sub>). Parameter <italic>η</italic> can be estimated from RNA-Seq read counts from pure cell types using the unweighted sample mean, a maximum likelihood unbiased estimator. CDSeq uses the user-specified <italic>η</italic> to adjust RNA proportions to cell proportions. If such information is not provided, CDSeq will assign each element of <italic>η</italic> the same value, indicating no differences in cell sizes (<italic>θ</italic> then represents RNA proportions, not cell proportions).</p>
      <p>Finally, to complete specification of our model, we need to be able to assign reads in the heterogeneous sample to individual cell types; thus, we introduce a latent categorical random variable <italic>c</italic><sub><italic>i</italic>,<italic>j</italic></sub> ∈ {1, ⋯, <italic>T</italic>} that is the cell type indicator of read <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub>. Our model specifies that RNA-Seq reads from bulk tissues are generated as follows:</p>
      <list list-type="order">
        <list-item>
          <p>Generate gene expression profiles for different cell types, i.e., <italic>ϕ</italic><sub><italic>t</italic></sub> ∼ <italic>Dir</italic>(<italic>β</italic>) for cell type <italic>t</italic>, <italic>t</italic> = 1, ⋯, <italic>T</italic>, and <inline-formula id="pcbi.1007510.e009"><alternatives><graphic xlink:href="pcbi.1007510.e009.jpg" id="pcbi.1007510.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>Choose <italic>θ</italic><sub><italic>i</italic></sub> ∼ <italic>Dir</italic>(<italic>α</italic>) which denotes the mixture proportion of different cell types in the sample <italic>i</italic>, <italic>i</italic> = 1, ⋯, <italic>M</italic>, and <inline-formula id="pcbi.1007510.e010"><alternatives><graphic xlink:href="pcbi.1007510.e010.jpg" id="pcbi.1007510.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>For each of the <italic>N</italic><sub><italic>i</italic></sub> RNA-Seq reads in sample <italic>i</italic>, where <italic>N</italic><sub><italic>i</italic></sub> denotes the total reads of sample <italic>i</italic>
<list list-type="alpha-lower"><list-item><p>Choose a cell type <inline-formula id="pcbi.1007510.e011"><alternatives><graphic xlink:href="pcbi.1007510.e011.jpg" id="pcbi.1007510.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>j</italic> = 1, ⋯, <italic>N</italic><sub><italic>i</italic></sub>, <inline-formula id="pcbi.1007510.e012"><alternatives><graphic xlink:href="pcbi.1007510.e012.jpg" id="pcbi.1007510.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007510.e013"><alternatives><graphic xlink:href="pcbi.1007510.e013.jpg" id="pcbi.1007510.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∝</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> (adjusting cell proportion <italic>θ</italic> to RNA proportion <inline-formula id="pcbi.1007510.e014"><alternatives><graphic xlink:href="pcbi.1007510.e014.jpg" id="pcbi.1007510.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and “·” denotes element-wise product.</p></list-item><list-item><p>Choose a gene <inline-formula id="pcbi.1007510.e015"><alternatives><graphic xlink:href="pcbi.1007510.e015.jpg" id="pcbi.1007510.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>j</italic> = 1, ⋯, <italic>N</italic><sub><italic>i</italic></sub>, <inline-formula id="pcbi.1007510.e016"><alternatives><graphic xlink:href="pcbi.1007510.e016.jpg" id="pcbi.1007510.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007510.e017"><alternatives><graphic xlink:href="pcbi.1007510.e017.jpg" id="pcbi.1007510.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>∝</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (adjusting gene expression <inline-formula id="pcbi.1007510.e018"><alternatives><graphic xlink:href="pcbi.1007510.e018.jpg" id="pcbi.1007510.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> by considering the effective gene length) and <inline-formula id="pcbi.1007510.e019"><alternatives><graphic xlink:href="pcbi.1007510.e019.jpg" id="pcbi.1007510.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. <inline-formula id="pcbi.1007510.e020"><alternatives><graphic xlink:href="pcbi.1007510.e020.jpg" id="pcbi.1007510.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> denotes the effective lengths of genes and “·” denotes element-wise product.</p></list-item><list-item><p>Generate a read sequence <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> by uniformly choosing one of the <inline-formula id="pcbi.1007510.e021"><alternatives><graphic xlink:href="pcbi.1007510.e021.jpg" id="pcbi.1007510.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msub><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></alternatives></inline-formula> positions in gene <italic>g</italic><sub><italic>i</italic>,<italic>j</italic></sub>.</p></list-item></list></p>
        </list-item>
      </list>
      <p>To this end, a graphical model of CDSeq is presented in <xref ref-type="fig" rid="pcbi.1007510.g002">Fig 2</xref> depicting the stochastic process of generating RNA-Seq data. Details on parameter estimation and method for determining the optimal number of cell types in the data are provided in <xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>.</p>
      <fig id="pcbi.1007510.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Graphical representation of CDSeq probabilistic model.</title>
          <p>The light blue nodes, <italic>α</italic>, <italic>β</italic>, denote the hyperparameters that are assumed to be known. The dark blue nodes, <italic>ℓ</italic>, <italic>g</italic><sub><italic>ij</italic></sub>, <italic>r</italic><sub><italic>ij</italic></sub>, denote the values of observable random variables (either measured in the study or established in previous studies) whereas the white nodes, <italic>η</italic>, Φ, <italic>θ</italic>, <italic>c</italic><sub><italic>ij</italic></sub>, are unobservable random variables that need to be inferred from data. The outer box represents samples where <italic>M</italic> is the sample size, and the inner box denotes the RNA-Seq data of a sample where <italic>N</italic> is the total number of reads from the sample (see <xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref> for details).</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g002"/>
      </fig>
      <p>The cell types delineated by CDSeq are mathematical entities that must be matched to corresponding biological cell types. To match the CDSeq cell types to actual cell types requires a list of reference cell-type-specific GEPs and metric of similarity (for example, Pearson’s correlation coefficient or Kullback-Leibler divergence) (<xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>). Depending on the application, many reference profiles are available, e.g., the LM22 [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>] for immune cell subsets. We employed the Munkres algorithm [<xref rid="pcbi.1007510.ref036" ref-type="bibr">36</xref>] in CDSeq for cell type association when a list of reference GEPs is provided. An alternative way to identify CDSeq-estimated cell types, without using a reference GEP profile, is to evaluate enrichment scores of marker gene sets similar to scRNA-Seq analysis [<xref rid="pcbi.1007510.ref009" ref-type="bibr">9</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>Computational complexity and a data dilution strategy to speed up the algorithm</title>
      <p>In CDSeq, the Gibbs sampler iteratively assigns a cell type to each read using a binary search with a time complexity of <inline-formula id="pcbi.1007510.e022"><alternatives><graphic xlink:href="pcbi.1007510.e022.jpg" id="pcbi.1007510.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mo form="prefix">log</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>T</italic> is the number of cell types. Assume the number of total reads is <italic>R</italic>, then the time complexity of the Gibbs sampler is <inline-formula id="pcbi.1007510.e023"><alternatives><graphic xlink:href="pcbi.1007510.e023.jpg" id="pcbi.1007510.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo form="prefix">log</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. If needed, we have also provided a way to speed up the CDSeq using a data dilution strategy (<xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>). Specifically, one could divide all the read counts by a positive constant—dilution factor. We systematically tested the effect of the dilution factor on the accuracy of estimation using both synthetic and experimental mixture data. For our 32 experimental mixtures with ∼ 20<italic>k</italic> genes using a dilution factor of 10, it took CDSeq about 2 hours to finish on an iMac (3.5 GHz Intel Core i7 with 32GB memory).</p>
    </sec>
    <sec id="sec005">
      <title>A quasi-unsupervised learning strategy</title>
      <p>CDSeq is an unsupervised learning method that aims at discovering the latent pattern from data without any labeling or prior knowledge. The GEPs of the cell types identified by CDSeq may not closely match any available pure cell line GEPs. This issue may arise because highly correlated GEPs of multiple cell types or subtypes complicates the deconvolution problem and renders CDSeq less able to definitively separate cell types. For example, this issue is escalated in the problem of deep deconvolution. Deep deconvolution refers to the problem of using a whole blood or peripheral blood mononuclear cell (PBMC) sample to estimate the proportions and gene expression profiles of a greater number of cell subtypes, going further down into the hematopoietic tree [<xref rid="pcbi.1007510.ref011" ref-type="bibr">11</xref>]. To mitigate this kind of problem, we developed a quasi-unsupervised learning strategy. The idea is to provide CDSeq some guidance that leads the algorithm to more biologically meaningful latent information. The guidance consists of appending a set GEPs of pure cell lines to the original input GEPs of heterogeneous samples. The choice of GEPs appended should reflect pure cell lines that are believed to constitute the samples.</p>
      <p>To apply the quasi-unsupervised approach, one could simply append a set of pure cell line GEPs to the GEPs of the bulk samples for the same genes. Each appended pure cell line GEP is treated as a “bulk” sample by CDSeq. For example, let <italic>X</italic><sub><italic>G</italic>×<italic>M</italic></sub> denote bulk RNA-Seq data for <italic>G</italic> genes and <italic>M</italic> samples, to append a set of <italic>W</italic> pure cell line GEPs, say, <inline-formula id="pcbi.1007510.e024"><alternatives><graphic xlink:href="pcbi.1007510.e024.jpg" id="pcbi.1007510.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, one would need to create <inline-formula id="pcbi.1007510.e025"><alternatives><graphic xlink:href="pcbi.1007510.e025.jpg" id="pcbi.1007510.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, a data matrix with <italic>G</italic> rows (genes) and <italic>M</italic> + <italic>W</italic> columns (samples), as the input for CDSeq. We showed that, using this quasi-unsupervised strategy, CDSeq provided more informative estimates than those obtained using the fully unsupervised mode (<xref ref-type="sec" rid="sec008">Results</xref>). We call this learning strategy “quasi-unsupervised” because, although we do not incorporate any labeling information within CDSeq algorithm itself, we do inject strong signals about likely relevant cell types into the input data. In short, CDSeq is not explicitly aware of such labeling information (pure cell line GEPs appended to input) and treats them the same as other input samples unlike traditional semi-supervised methods where the labeling information is explicitly taken into account by the algorithms.</p>
    </sec>
    <sec id="sec006">
      <title>Comparisons with other deconvolution methods</title>
      <p>We compared CDSeq to seven competing deconvolution methods using their default settings when applicable (<xref rid="pcbi.1007510.t001" ref-type="table">Table 1</xref>). We present detailed comparisons with csSAM and CIBERSORT in the main text and full comparisons in <xref ref-type="supplementary-material" rid="pcbi.1007510.s004">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007510.s011">S8</xref> Figs. For the purpose of comparison, we used reads per kilobase per million mapped reads (RPKM) [<xref rid="pcbi.1007510.ref037" ref-type="bibr">37</xref>] normalization as input for RNA-Seq data. Using our experimental mixtures, we also showed that the RPKM-normalized RNA-Seq data fit well with the linearity assumption employed by deconvolution methods (<xref ref-type="supplementary-material" rid="pcbi.1007510.s013">S10 Fig</xref>). Details on the linearity assumption are given in <xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>.</p>
      <table-wrap id="pcbi.1007510.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Deconvolution methods for comparison.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007510.t001g" xlink:href="pcbi.1007510.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Deconvolution methods</th>
                <th align="left" rowspan="1" colspan="1">Estimate proportions</th>
                <th align="left" rowspan="1" colspan="1">Estimate GEPs</th>
                <th align="left" rowspan="1" colspan="1">Reference</th>
                <th align="left" rowspan="1" colspan="1">Dataset<xref ref-type="table-fn" rid="t001fn001">*</xref></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">CDSeq</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">①-⑥</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CIBERSORT</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-⑥</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DeconRNAseq</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref022" ref-type="bibr">22</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-⑥</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">UNDO</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref029" ref-type="bibr">29</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-②</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">csSAM</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-③</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DSA</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref020" ref-type="bibr">20</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-③</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">deconf</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref016" ref-type="bibr">16</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-⑥</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">ssKL</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pcbi.1007510.ref017" ref-type="bibr">17</xref>]</td>
                <td align="center" rowspan="1" colspan="1">①-⑥</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>* <bold>Dataset</bold>: ① Synthetic mixtures (<xref ref-type="supplementary-material" rid="pcbi.1007510.s002">S1 Table</xref>); ② Experimental mixtures (<xref ref-type="supplementary-material" rid="pcbi.1007510.s003">S2 Table</xref>); ③ Mixtures of liver, lung and brain [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>]; ④ Leukocyte subtypes(LM22) [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]; ⑤ Lymphoma samples [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]; ⑥ PBMC samples [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>].</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec007">
      <title>Synthetic and experimental mixtures and gene expression profiling</title>
      <p>We generated 40 synthetic samples (<xref ref-type="supplementary-material" rid="pcbi.1007510.s002">S1 Table</xref>) and 32 experimental mixtures measured using RNA-Seq (<xref ref-type="supplementary-material" rid="pcbi.1007510.s003">S2 Table</xref>) for benchmarking CDSeq. The details of data generation procedure are given in <xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec008">
    <title>Results</title>
    <sec id="sec009">
      <title>Performance on synthetic data</title>
      <p>We first benchmarked CDSeq on synthetic mixtures with known compositions that we created numerically from publicly available GEPs from Cold Spring Harbor Laboratory. In this synthetic numerical experiment, we amplified the potential bias between RNA proportions and cell-type proportions by artificially increasing the RNA amount of certain cell types before mixing them together to generate the synthetic samples. We generated 40 synthetic samples where each sample was a combination of six different cell types in different proportions (<xref ref-type="supplementary-material" rid="pcbi.1007510.s002">S1 Table</xref>).</p>
      <p>In estimating cell-type proportions, CDSeq outperformed CIBERSORT, showing smaller differences between the true and estimated proportions for each cell type and, consequently, smaller root mean square error (RMSE) (<xref ref-type="fig" rid="pcbi.1007510.g003">Fig 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s004">S1 Fig</xref>). The RMSE of CDSeq was overall 77% lower than that of CIBERSORT.</p>
      <fig id="pcbi.1007510.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Deconvolution of synthetic mixtures.</title>
          <p>We ran CDSeq with six cell types, <italic>α</italic> = 5, <italic>β</italic> = 0.5, and 700 MCMC runs. (A) Difference (“residual”) between estimated and true cell-type proportion plotted against true proportion for CDSeq (green) and CIBERSORT (red). Each plotted point represents the value for a single sample. (B) Radar plot of RMSE for estimates of sample-specific cell-type proportions. CDSeq (green); CIBERSORT (red). (C) Difference (“residual”) between estimated and true log2 gene expression level (log2(RPKM)) plotted against true log2 gene expression level for CDseq (green) and csSAM (red). Each plotted point represents a single gene, 22498 genes total. (D) Radar plot of RMSE for gene expression levels (RPKM). CDSeq (green); csSAM (red).</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g003"/>
      </fig>
      <p>In estimating GEPs, performances of CDSeq and csSAM were comparable. However, CDSeq still outperformed csSAM with 64% lower RMSE values than csSAM (<xref ref-type="fig" rid="pcbi.1007510.g003">Fig 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s004">S1 Fig</xref>). Notice that RMSE is not calculated on log scale because some of the gene expression values are zeros. In addition, CDSeq outperformed all other seven competing deconvolution methods as shown in <xref ref-type="fig" rid="pcbi.1007510.g004">Fig 4</xref>. CDSeq in general requires more running time than competing methods. For the synthetic mixtures, CDSeq took about 2 hours and CIBERSORT took about 3 hours whereas the remaining tools took seconds to complete.</p>
      <fig id="pcbi.1007510.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Performance comparisons on synthetic mixtures.</title>
          <p>(A) RMSEs of sample-specific cell-type proportion estimations; (B) RMSEs of cell-type-specific GEPs estimations.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g004"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Performance on mixture of RNAs extracted from cultured cells</title>
      <p>Our second performance evaluation used data from a designed experiment that created 32 mixture samples using known RNA proportions isolated from four pure cell lines (<xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>). CDSeq predicted both the cell proportions and GEPs well (<xref ref-type="fig" rid="pcbi.1007510.g005">Fig 5</xref>). CDSeq generally outperformed all competitors as indicated by smaller total RMSE (<xref ref-type="fig" rid="pcbi.1007510.g006">Fig 6</xref>); For example, CDSeq had 17% smaller RMSE than CIBERSORT for estimating cell-type proportions and 16% smaller RMSE than csSAM for estimating GEPs (<xref ref-type="supplementary-material" rid="pcbi.1007510.s005">S2 Fig</xref>).</p>
      <fig id="pcbi.1007510.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Deconvolution of mixed RNA from cultured cell lines.</title>
          <p>We ran CDSeq with four cell types, <italic>α</italic> = 5, <italic>β</italic> = 0.5, and 700 MCMC runs. (A) Difference (“residual”) between estimated and true cell-type proportion plotted against true proportion for CDSeq (green) and CIBERSORT (red). Each plotted point represents the value for a single sample. (B) Radar plot of RMSE for estimates of sample-specific cell-type proportions. CDSeq (green); CIBERSORT (red). Total RMSE summing over cell types is 17% smaller for CDseq compared to CIBERSORT. (C) Difference (“residual”) between estimated and true log2 gene expression level (log2(RPMK)) plotted against true log2 gene expression level for CDseq (green) and csSAM (red). Each plotted point displays the expression value of a single gene, 19653 genes in total. (D) Radar plot of RMSE for gene expression levels. CDSeq (green); csSAM (red). Total RMSE of gene expression (summing over cell types) is 16% smaller for CDseq compared to csSAM.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g005"/>
      </fig>
      <fig id="pcbi.1007510.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Performance comparisons on experimental mixtures.</title>
          <p>(A) RMSEs of sample-specific cell-type proportion estimations; (B) RMSEs of cell-type-specific GEPs estimations.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g006"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Dissecting mixtures of liver, lung, and brain cells</title>
      <p>We evaluated CDSeq using the experimental data set designed for csSAM [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>]. The microarray data set consists of 11 mixtures (each with 3 replicates) of liver, brain and lung cells with varying known RNA proportions. We showed that CDSeq outperformed all competing methods in estimating both cell-type-specific GEPs and sample-specific proportions of cell types (<xref ref-type="fig" rid="pcbi.1007510.g007">Fig 7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s006">S3 Fig</xref>). For example, the RMSE of the CDSeq-estimated cell proportion was 44% lower than the corresponding CIBERSORT RMSE, and the RMSE of CDSeq-estimated GEPs was similar to the corresponding csSAM RMSE.</p>
      <fig id="pcbi.1007510.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Deconvolution of mixed liver, lung and brain cell lines.</title>
          <p>Comparisons with CIBERSORT and csSAM on mixtures of liver, brain and lung cells. (A) Residual of proportion estimation; (B) Radar plot of RMSE for proportion estimation; (C) Residual of GEPs estimation; (D) Radar plot of RMSE for GEPs estimation.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g007"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Evaluation using leukocyte subtypes</title>
      <p>To test the performance of CDSeq on some extreme cases, we applied CDSeq to a set of GEPs from pure cell lines. We chose LM22 designed by Newman et al. [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>], which comprises 22 human hematopoietic cell phenotypes. Thus, the GEPs of some of the cell lines are highly correlated with each other. CDSeq successfully uncovered the 22 cell types. CDSeq’s estimates of cell-type proportions, which should be 100% for these pure cell lines, generally exceeded 90%. Overall, CDSeq performed comparably with CIBERSORT, deconRNAseq, and ssKL in estimating sample-specific cell-type proportions (<xref ref-type="supplementary-material" rid="pcbi.1007510.s007">S4 Fig</xref>), even though CIBERSORT and deconRNAseq require the GEPs of leukocyte subtypes as input (deconf performed much worse, in comparison to CDSeq). For cell-type-specific GEPs estimation, CDSeq performed comparably with deconf and ssKL (<xref ref-type="supplementary-material" rid="pcbi.1007510.s007">S4 Fig</xref>).</p>
    </sec>
    <sec id="sec013">
      <title>Immune cell analysis of lymphoma data with comparison to flow-cytometry</title>
      <p>We evaluated CDSeq against flow-cytometry measurements of leukocyte content in solid tumors. Data comprised GEPs from 14 bulk follicular lymphoma samples and corresponding flow-cytometry measurements [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]. Our goal was to estimate the proportions of B cells (naive B cell and memory B cell) and T cells (CD8 T cell, CD4 naive T cell, CD4 memory resting T cell, CD4 memory activated T cell, follicular helper T cell, regulatory T cell) in those 14 samples using CDSeq. We set the number of cell types to be eight (the number of all B cell and T cell subtypes in our reference file). We carried out two approaches—fully unsupervised and quasi-unsupervised. The quasi-unsupervised performed better than the fully unsupervised approach for this dataset when the GEPs of constituent cell types are highly correlated (<xref ref-type="supplementary-material" rid="pcbi.1007510.s009">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s010">S7</xref> Figs). We showed that CDSeq outperformed deconf and ssKL and performed comparably with CIBERSORT and DeconRNAseq (<xref ref-type="fig" rid="pcbi.1007510.g008">Fig 8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s010">S7 Fig</xref>), both of which require a reference GEP set as input.</p>
      <fig id="pcbi.1007510.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Comparison of CDSeq using the quasi-unsupervised strategy with CIBERSOFT on deconvolution of B cells and T cells in lymphoma samples.</title>
          <p>We ran CDSeq with 22 cell types, <italic>α</italic> = 0.5, <italic>β</italic> = 0.5, and 700 MCMC runs. We considered an anonymous CDSeq-identified cell type to match one of the B cell (blue dots) or T cell subtypes (red dots) if the Pearson correlation of their GEPs exceeded 0.6. (A) Correlation between estimated GEPs and true GEPs; (B) CDSeq estimated proportions versus flow cytometry; (C) CIBERSORT estimation versus flow cytometry.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g008"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>CDSeq on deep deconvolution</title>
      <p>To assess CDSeq’s performance on deep deconvolution, we used a set of 20 PBMC samples [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]. To evaluate performance, we also used information provided by Newman et al. [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]: namely, flow-cytometry measurements for nine of the 22 leukocyte subtypes (the only subtypes with flow cytometry available). That LM22-provided GEPs of about half of these nine subtypes were highly correlated (<xref ref-type="supplementary-material" rid="pcbi.1007510.s008">S5 Fig</xref>) should challenge CDSeq’s ability both to find the corresponding GEPs of those nine subtypes in the 20 PMBC samples and to accurately estimate their proportions. We first ran CDSeq in fully unsupervised mode and set the number of cell types to be 22. Using the GEPs of LM22 as references, we found that CDSeq could not uncover the nine subtypes (<xref ref-type="supplementary-material" rid="pcbi.1007510.s011">S8 Fig</xref>), possibly because of the highly correlated GEPs among subtypes.</p>
      <p>To improve estimation, we turned to the quasi-unsupervised strategy when running CDSeq by appending the 22 GEPs of LM22 to the 20 samples, 42 samples in total. Using the 0.6 correlation threshold to match CDSeq-identified cell types to the corresponding 22 leukocyte subtypes, we found that the quasi-unsupervised strategy improved CDSeq’s performance (<xref ref-type="fig" rid="pcbi.1007510.g009">Fig 9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s011">S8 Fig</xref>): one CDSeq-identified cell type matched both naive and activated B cells; another matched both resting and activated mast cells; two CDSeq-identified cell types did not match any of the 22 LM22 known subtypes; the remainder matched only one LM22 subtype each.</p>
      <fig id="pcbi.1007510.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Deep deconvolution of PBMC data.</title>
          <p>We applied CDSeq using the quasi-unsupervised learning strategy and ran CDSeq with 22 cell types, <italic>α</italic> = 50, <italic>β</italic> = 20. The black line is the linear regression line; the dashed line is the <italic>x</italic> = <italic>y</italic> line; <italic>R</italic> is the correlation coefficient; and <italic>P</italic> is the p-value for testing the null hypothesis of no correlation.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g009"/>
      </fig>
      <p>We next compared CDSeq-estimated cell-type proportions of these nine cell subtypes to flow-cytometry measurements. However, since CDSeq could not distinguish between naive B cells and memory B cells, we combined these two types into one overall B cell type, resulting in eight total subtypes (<xref ref-type="fig" rid="pcbi.1007510.g009">Fig 9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s011">S8 Fig</xref>). In restricting attention to the resulting eight subtypes, we renormalized their proportions to sum to one for comparison with corresponding flow cytometry measured proportions.</p>
      <p>For six of the eight subtypes, the CDSeq-estimated relative proportions were significantly correlated (<italic>p</italic> &lt; 0.05) with the flow-cytometry-based relative proportions. The correlations with activated memory CD4 and <italic>γδ</italic> T cells were not significant (<italic>p</italic> = 0.31 and 0.07, respectively). The CIBERSORT estimated relative proportions were significant correlated (<italic>p</italic> &lt; 0.05) with the corresponding flow-cytometry-based relative proportions for all subtypes except <italic>γδ</italic> T cells (<italic>p</italic> = 0.19). In an overall comparison of CDSeq and CIBERSORT estimates, however, the total RMSE of CDSeq was about 6% lower than that of CIBERSORT. On the other hand, the estimated relative proportions by both CDSeq and CIBERSORT showed systematic bias in departing from equality with the flow-cytometry-based proportions. Besides the possible technical issues of flow-cytometry and the fidelity of the LM22 reference profiles, another possible reason for this systematic bias with this microarray data is that flow cytometry reports relative cell proportions whereas CDSeq and CIBERSORT report relative RNA proportions. Though CDSeq is capable of reporting either RNA proportions or cell proportions from RNA-Seq raw counts, it can report only RNA proportions with microarray data. We show CDSeq outperformed all other competing methods by having the smallest RMSE in <xref ref-type="supplementary-material" rid="pcbi.1007510.s011">S8 Fig</xref>.</p>
    </sec>
    <sec id="sec015">
      <title>Estimating the number of cell types present from the data</title>
      <p>We have been applying CDSeq by fixing the number of cell types at the correct number, since we know it in advance. CDSeq can, however, estimate the number of constituent cell types in a collection of samples, if necessary, by maximizing the posterior distribution (<xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref>). The framework of CDSeq is built for RNA-Seq raw count data, therefore, raw count data is required for estimating the number of cell types. Consequently, we did not apply this feature for microarray data.</p>
      <p>Applying this method to the synthetic data and to the data on mixed RNA described above correctly estimated number of cell types in each case (<xref ref-type="fig" rid="pcbi.1007510.g010">Fig 10</xref>). In <xref ref-type="fig" rid="pcbi.1007510.g010">Fig 10(A)</xref>, the values of log posterior at 4 and 6 cell types are close, however, the maximum occurs at 6.</p>
      <fig id="pcbi.1007510.g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007510.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Estimating the number of cell types.</title>
          <p>The maximum of the log posterior provides an estimate of the number of cell types. (A) synthetic data; (B) mixed RNA data. In each data set, the method correctly estimated the number of cell types.</p>
        </caption>
        <graphic xlink:href="pcbi.1007510.g010"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec016">
    <title>Discussion</title>
    <p>As a complete deconvlution method, CDSeq has many advantages over existing partial deconvolution methods, like csSAM [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>] and CIBERSORT [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]. For example, CDSeq requires only one input (expression data from mixtures) to produce two outputs (estimates of cell-type-specific GEPs and sample-specific cell-type proportions). Partial deconvlution methods that require cell-type-specific GEPs as input face concerns about the accuracy or appropriateness of the reference profiles. Complete deconvolution avoids these concerns, although reference GEPs or marker genes are still required to match cell types constructed by the algorithm with actual biological cell types. Complete deconvlution also lowers the cost compared to methods that require cell-type proportions as input, which is typically estimated by using costly antibodies and flow cytometry.</p>
    <p>In addition, our probabilistic model is conceptually more advanced than methods using matrix decomposition [<xref rid="pcbi.1007510.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1007510.ref017" ref-type="bibr">17</xref>] or regression techniques [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>] for a couple reasons. First, our generative model explicitly considers how reads are generated and estimates cell proportions instead of RNA proportions whereas matrix decomposition or regression-based methods are not. Second, our model employs multinomial random variables to capture the stochastic nature of reads and therefore inherently builds in the constraint that proportions are nonnegative and sum to one on the parameters of interest; whereas matrix decomposition or regression-based methods need to impose those constraints on the parameter space explicitly, which brings technical challenges for numerical procedures.</p>
    <p>Our proposed model extended the original LDA model in two primary ways that would be unnecessary in the context of natural language processing, but are crucial for RNA-Seq data. First, we built in a dependence of gene expression on gene length. Second, we accommodated possibly different amounts of RNA per cell from cell types whose cells differ in size when estimating the proportion of cells of each type in the sample. In addition, instead of specifying the number of cell types a priori, we provided an algorithm that allows the data to guide selection of the number of cell types. Finally, we proposed a quasi-unsupervised learning strategy that augments the input data (GEPs from mixed samples) with additional GEPs from pure cell lines that are anticipated to be components of the mixture.</p>
    <p>We systematically compared the performance of CDSeq with seven competing deconvolution methods: CIBERSORT [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>], DeconRNAseq [<xref rid="pcbi.1007510.ref022" ref-type="bibr">22</xref>], deconf [<xref rid="pcbi.1007510.ref016" ref-type="bibr">16</xref>], ssKL [<xref rid="pcbi.1007510.ref017" ref-type="bibr">17</xref>], UNDO [<xref rid="pcbi.1007510.ref029" ref-type="bibr">29</xref>], DSA [<xref rid="pcbi.1007510.ref020" ref-type="bibr">20</xref>] and csSAM [<xref rid="pcbi.1007510.ref001" ref-type="bibr">1</xref>]. Our comparisons encompassed a range of data sets: synthetic mixtures created numerically from GEPs of pure cell lines, GEPs measured on heterogeneous RNA samples constructed in our lab by mixing RNA extracted from pure cell lines in different proportions, the experimental expression data that was used to evaluate csSAM, expression data of 22 leukocyte subtypes (LM22) [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>], expression data from follicular lymphoma samples [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>], and expression data from samples of peripheral blood mononuclear cells (PBMC) [<xref rid="pcbi.1007510.ref025" ref-type="bibr">25</xref>]. In all these comparisons, CDSeq performed as well or better than competitors in estimating of cell-type proportions and cell-type-specific GEPs from heterogeneous tissue samples.</p>
    <p>CDSeq, an unsupervised data mining tool, is fully data-driven and allows simultaneous estimation of both cell-type-specific GEPs and sample-specific cell mixing proportions. In some real data analyses when constituent cell types had highly correlated GEPs, the cell types found by CDSeq lacked a one-to-one correspondence with the known component cell lines. Our quasi-unsupervised approach ameliorates this problem. It involves augmenting the available GEPs from heterogeneous samples with GEPs from pure cultures of the cell types anticipated to be constituents. We showed that this quasi-unsupervised approach can improve CDSeq’s performance in lymphoma and deep deconvolution examples. In practice, whether or not to apply quasi-unsupervised approach would depend on the goal of the study. If a user is interested in deep deconvolution where one would like to know the proportions of related cell subtypes (e.g., different T subpopulations in samples), then the quasi-unsupervised approach would be recommended. In this case, the appended pure cell line GEPs should be those of the T cell subpopulations. Furthermore, inclusion of such cell line GEPs does not exclude identification of cell types other than those appended pure cell lines.</p>
    <p>To improve CDSeq’s computational efficiency, we developed a data dilution strategy that can speed up the algorithm while retaining the accuracy of estimation (<xref ref-type="supplementary-material" rid="pcbi.1007510.s001">S1 Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007510.s012">S9 Fig</xref>). Furthermore, filtering out genes with low expression levels or with little sample-to-sample variation will reduce the running time and memory usage. CDSeq often manages to finish within couple hours. Currently, CDSeq is coded in MATLAB and Octave. An R package is currently being developed for a broader accessibility.</p>
    <p>A limitation of current CDSeq model is the impossibility of fine tuning the hyperparameters to obtain optimal results without ground truth. In practice, we suggest setting <italic>α</italic> = 5, <italic>β</italic> = 0.5. When heterogeneous samples are likely dominated by one or two cell types, setting <italic>α</italic> &lt; 1 may help; when cell-type-specific GEPs are likely to have relatively high correlation, setting <italic>β</italic> &gt; 1 may help—though we cannot specify a definitive threshold for high correlation. From a practical point of view, the higher the correlations are, the fuzzier the discovered signal would be. Another potentially helpful technique is the quasi-unsupervised strategy. Efforts at enabling CDSeq to self-adjust hyperparameters based on given data are underway. Another possible extension for the current model is that the fundamental multinomial model used for gene expression imposes a certain negative correlation between expression counts at different loci. However, it is conceivable that, because genetic pathways can be regulated as units, the counts could be positively correlated among certain subsets of genes. The current CDSeq model cannot handle that kind of correlation structure.</p>
    <p>In addition, the RNA-Seq mixtures generated in this work can serve as a valuable benchmarking dataset for other deconvolution methods.</p>
    <p>We expect that CDSeq will prove valuable for analysis of cellular heterogeneity on bulk RNA-Seq data. This computational method provides a practical and promising alternative to methods that require expensive laboratory apparatus and extensive labor to isolate individual cells from heterogeneous samples, which could also entail possible loss of a systems perspective. Application of CDSeq will aid in deciphering complex genomic data from heterogeneous tissues.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s001">
      <label>S1 Methods</label>
      <caption>
        <title>Statistical inference for CDSeq.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s002">
      <label>S1 Table</label>
      <caption>
        <title>Randomly generated sample-specific cell-type proportions (%) used to create synthetic data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s003">
      <label>S2 Table</label>
      <caption>
        <title>Cell-type (RNA) proportions (%) used to create mixed samples in the experiment with cultured cell types.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s004">
      <label>S1 Fig</label>
      <caption>
        <title>Results for synthetic data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s005">
      <label>S2 Fig</label>
      <caption>
        <title>Results for experimental data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s006">
      <label>S3 Fig</label>
      <caption>
        <title>Results for liver, brain and lung mixtures data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s007">
      <label>S4 Fig</label>
      <caption>
        <title>Deconvolution of 22 leukocyte subtypes (LM22) data set.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s008">
      <label>S5 Fig</label>
      <caption>
        <title>Correlation among true LM22 GEPs.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s009">
      <label>S6 Fig</label>
      <caption>
        <title>Result of deconvolution of follicular lymphoma tumors data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s010">
      <label>S7 Fig</label>
      <caption>
        <title>Results of deconvolution of 14 follicular lymphoma tumors samples.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s011">
      <label>S8 Fig</label>
      <caption>
        <title>Performance comparisons on deep deconvolution.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s012">
      <label>S9 Fig</label>
      <caption>
        <title>Running time of CDSeq plotted against the dilution factor for data dilution using the synthetic data and experimental data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007510.s013">
      <label>S10 Fig</label>
      <caption>
        <title>Linearity assumption test using 32 experimental mixtures.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007510.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Dr. Jiajia Wang and Dr. Zongli Xu for their comments and suggestions. We thank the Integrative Bioinformatics Group and the Epige-nomics Core for the assistance on RNA sequencing and data quality control. We thank the Computational Biology Facility for computing time.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007510.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Shen-Orr</surname><given-names>SS</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Bodian</surname><given-names>DL</given-names></name>, <name><surname>Staedtler</surname><given-names>F</given-names></name>, <name><surname>Perry</surname><given-names>NM</given-names></name>, <etal>et al</etal><article-title>Cell type–specific gene expression differences in complex tissues</article-title>. <source>Nature methods</source>. <year>2010</year>;<volume>7</volume>(<issue>4</issue>):<fpage>287</fpage>–<lpage>289</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id><?supplied-pmid 20208531?><pub-id pub-id-type="pmid">20208531</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Zhong</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>Z</given-names></name>. <article-title>Gene expression deconvolution in linear space</article-title>. <source>Nature methods</source>. <year>2012</year>;<volume>9</volume>(<issue>1</issue>):<fpage>8</fpage><pub-id pub-id-type="doi">10.1038/nmeth.1830</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhn</surname><given-names>A</given-names></name>, <name><surname>Thu</surname><given-names>D</given-names></name>, <name><surname>Waldvogel</surname><given-names>HJ</given-names></name>, <name><surname>Faull</surname><given-names>RL</given-names></name>, <name><surname>Luthi-Carter</surname><given-names>R</given-names></name>. <article-title>Population-specific expression analysis (PSEA) reveals molecular changes in diseased brain</article-title>. <source>Nature methods</source>. <year>2011</year>;<volume>8</volume>(<issue>11</issue>):<fpage>945</fpage>–<lpage>947</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1710</pub-id><?supplied-pmid 21983921?><pub-id pub-id-type="pmid">21983921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Alizadeh</surname><given-names>AA</given-names></name>, <name><surname>Aranda</surname><given-names>V</given-names></name>, <name><surname>Bardelli</surname><given-names>A</given-names></name>, <name><surname>Blanpain</surname><given-names>C</given-names></name>, <name><surname>Bock</surname><given-names>C</given-names></name>, <name><surname>Borowski</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Toward understanding and exploiting tumor heterogeneity</article-title>. <source>Nature medicine</source>. <year>2015</year>;<volume>21</volume>(<issue>8</issue>):<fpage>846</fpage><pub-id pub-id-type="doi">10.1038/nm.3915</pub-id><?supplied-pmid 26248267?><pub-id pub-id-type="pmid">26248267</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Calon</surname><given-names>A</given-names></name>, <name><surname>Lonardo</surname><given-names>E</given-names></name>, <name><surname>Berenguer-Llergo</surname><given-names>A</given-names></name>, <name><surname>Espinet</surname><given-names>E</given-names></name>, <name><surname>Hernando-Momblona</surname><given-names>X</given-names></name>, <name><surname>Iglesias</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Stromal gene expression defines poor-prognosis subtypes in colorectal cancer</article-title>. <source>Nature genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>4</issue>):<fpage>320</fpage><pub-id pub-id-type="doi">10.1038/ng.3225</pub-id><?supplied-pmid 25706628?><pub-id pub-id-type="pmid">25706628</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Galon</surname><given-names>J</given-names></name>, <name><surname>Mlecnik</surname><given-names>B</given-names></name>, <name><surname>Bindea</surname><given-names>G</given-names></name>, <name><surname>Angell</surname><given-names>HK</given-names></name>, <name><surname>Berger</surname><given-names>A</given-names></name>, <name><surname>Lagorce</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Towards the introduction of the ‘Immunoscore’in the classification of malignant tumours</article-title>. <source>The Journal of pathology</source>. <year>2014</year>;<volume>232</volume>(<issue>2</issue>):<fpage>199</fpage>–<lpage>209</lpage>. <pub-id pub-id-type="doi">10.1002/path.4287</pub-id><?supplied-pmid 24122236?><pub-id pub-id-type="pmid">24122236</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Gentles</surname><given-names>AJ</given-names></name>, <name><surname>Newman</surname><given-names>AM</given-names></name>, <name><surname>Liu</surname><given-names>CL</given-names></name>, <name><surname>Bratman</surname><given-names>SV</given-names></name>, <name><surname>Feng</surname><given-names>W</given-names></name>, <name><surname>Kim</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>The prognostic landscape of genes and infiltrating immune cells across human cancers</article-title>. <source>Nature medicine</source>. <year>2015</year>;<volume>21</volume>(<issue>8</issue>):<fpage>938</fpage><pub-id pub-id-type="doi">10.1038/nm.3909</pub-id><?supplied-pmid 26193342?><pub-id pub-id-type="pmid">26193342</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mlecnik</surname><given-names>B</given-names></name>, <name><surname>Bindea</surname><given-names>G</given-names></name>, <name><surname>Angell</surname><given-names>HK</given-names></name>, <name><surname>Maby</surname><given-names>P</given-names></name>, <name><surname>Angelova</surname><given-names>M</given-names></name>, <name><surname>Tougeron</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Integrative analyses of colorectal cancer show immunoscore is a stronger predictor of patient survival than microsatellite instability</article-title>. <source>Immunity</source>. <year>2016</year>;<volume>44</volume>(<issue>3</issue>):<fpage>698</fpage>–<lpage>711</lpage>. <pub-id pub-id-type="doi">10.1016/j.immuni.2016.02.025</pub-id><?supplied-pmid 26982367?><pub-id pub-id-type="pmid">26982367</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>C</given-names></name>, <name><surname>Zheng</surname><given-names>L</given-names></name>, <name><surname>Yoo</surname><given-names>JK</given-names></name>, <name><surname>Guo</surname><given-names>H</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Landscape of infiltrating T cells in liver cancer revealed by single-cell sequencing</article-title>. <source>Cell</source>. <year>2017</year>;<volume>169</volume>(<issue>7</issue>):<fpage>1342</fpage>–<lpage>1356</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.035</pub-id><?supplied-pmid 28622514?><pub-id pub-id-type="pmid">28622514</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hackl</surname><given-names>H</given-names></name>, <name><surname>Charoentong</surname><given-names>P</given-names></name>, <name><surname>Finotello</surname><given-names>F</given-names></name>, <name><surname>Trajanoski</surname><given-names>Z</given-names></name>. <article-title>Computational genomics tools for dissecting tumour–immune cell interactions</article-title>. <source>Nature Reviews Genetics</source>. <year>2016</year>;<volume>17</volume>(<issue>8</issue>):<fpage>441</fpage><pub-id pub-id-type="doi">10.1038/nrg.2016.67</pub-id><?supplied-pmid 27376489?><pub-id pub-id-type="pmid">27376489</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Shen-Orr</surname><given-names>SS</given-names></name>, <name><surname>Gaujoux</surname><given-names>R</given-names></name>. <article-title>Computational deconvolution: extracting cell type-specific information from heterogeneous samples</article-title>. <source>Current opinion in immunology</source>. <year>2013</year>;<volume>25</volume>(<issue>5</issue>):<fpage>571</fpage>–<lpage>578</lpage>. <pub-id pub-id-type="doi">10.1016/j.coi.2013.09.015</pub-id><?supplied-pmid 24148234?><pub-id pub-id-type="pmid">24148234</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gawad</surname><given-names>C</given-names></name>, <name><surname>Koh</surname><given-names>W</given-names></name>, <name><surname>Quake</surname><given-names>SR</given-names></name>. <article-title>Single-cell genome sequencing: current state of the science</article-title>. <source>Nature Reviews Genetics</source>. <year>2016</year>;<volume>17</volume>(<issue>3</issue>):<fpage>175</fpage><pub-id pub-id-type="doi">10.1038/nrg.2015.16</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Vallejos</surname><given-names>CA</given-names></name>, <name><surname>Risso</surname><given-names>D</given-names></name>, <name><surname>Scialdone</surname><given-names>A</given-names></name>, <name><surname>Dudoit</surname><given-names>S</given-names></name>, <name><surname>Marioni</surname><given-names>JC</given-names></name>. <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>6</issue>):<fpage>565</fpage><pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><?supplied-pmid 28504683?><pub-id pub-id-type="pmid">28504683</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Avila Cobos</surname><given-names>F</given-names></name>, <name><surname>Vandesompele</surname><given-names>J</given-names></name>, <name><surname>Mestdagh</surname><given-names>P</given-names></name>, <name><surname>De Preter</surname><given-names>K</given-names></name>. <article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>11</issue>):<fpage>1969</fpage>–<lpage>1979</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty019</pub-id><?supplied-pmid 29351586?><pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Venet</surname><given-names>D</given-names></name>, <name><surname>Pecasse</surname><given-names>F</given-names></name>, <name><surname>Maenhaut</surname><given-names>C</given-names></name>, <name><surname>Bersini</surname><given-names>H</given-names></name>. <article-title>Separation of samples into their constituents using gene expression data</article-title>. <source>Bioinformatics</source>. <year>2001</year>;<volume>17</volume>(<issue>suppl_1</issue>):<fpage>S279</fpage>–<lpage>S287</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/17.suppl_1.s279</pub-id><?supplied-pmid 11473019?><pub-id pub-id-type="pmid">11473019</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Repsilber</surname><given-names>D</given-names></name>, <name><surname>Kern</surname><given-names>S</given-names></name>, <name><surname>Telaar</surname><given-names>A</given-names></name>, <name><surname>Walzl</surname><given-names>G</given-names></name>, <name><surname>Black</surname><given-names>GF</given-names></name>, <name><surname>Selbig</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Biomarker discovery in heterogeneous tissue samples-taking the in-silico deconfounding approach</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>27</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-27</pub-id><?supplied-pmid 20070912?><pub-id pub-id-type="pmid">20070912</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Gaujoux</surname><given-names>R</given-names></name>, <name><surname>Seoighe</surname><given-names>C</given-names></name>. <article-title>Semi-supervised Nonnegative Matrix Factorization for gene expression deconvolution: a case study</article-title>. <source>Infection, Genetics and Evolution</source>. <year>2012</year>;<volume>12</volume>(<issue>5</issue>):<fpage>913</fpage>–<lpage>921</lpage>. <pub-id pub-id-type="doi">10.1016/j.meegid.2011.08.014</pub-id><?supplied-pmid 21930246?><pub-id pub-id-type="pmid">21930246</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Erkkilä</surname><given-names>T</given-names></name>, <name><surname>Lehmusvaara</surname><given-names>S</given-names></name>, <name><surname>Ruusuvuori</surname><given-names>P</given-names></name>, <name><surname>Visakorpi</surname><given-names>T</given-names></name>, <name><surname>Shmulevich</surname><given-names>I</given-names></name>, <name><surname>Lähdesmäki</surname><given-names>H</given-names></name>. <article-title>Probabilistic analysis of gene expression measurements from heterogeneous tissues</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>20</issue>):<fpage>2571</fpage>–<lpage>2577</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq406</pub-id><?supplied-pmid 20631160?><pub-id pub-id-type="pmid">20631160</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>P</given-names></name>, <name><surname>Nakorchevskiy</surname><given-names>A</given-names></name>, <name><surname>Marcotte</surname><given-names>EM</given-names></name>. <article-title>Expression deconvolution: a reinterpretation of DNA microarray data reveals dynamic changes in cell populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>18</issue>):<fpage>10370</fpage>–<lpage>10375</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1832361100</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Zhong</surname><given-names>Y</given-names></name>, <name><surname>Wan</surname><given-names>YW</given-names></name>, <name><surname>Pang</surname><given-names>K</given-names></name>, <name><surname>Chow</surname><given-names>LM</given-names></name>, <name><surname>Liu</surname><given-names>Z</given-names></name>. <article-title>Digital sorting of complex tissues for cell type-specific gene expression profiles</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>89</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-89</pub-id><pub-id pub-id-type="pmid">23497278</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Dimitrakopoulou</surname><given-names>K</given-names></name>, <name><surname>Wik</surname><given-names>E</given-names></name>, <name><surname>Akslen</surname><given-names>LA</given-names></name>, <name><surname>Jonassen</surname><given-names>I</given-names></name>. <article-title>Deblender: a semi-/unsupervised multi-operational computational method for complete deconvolution of expression data from heterogeneous samples</article-title>. <source>BMC bioinformatics</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>408</fpage><pub-id pub-id-type="doi">10.1186/s12859-018-2442-5</pub-id><?supplied-pmid 30404611?><pub-id pub-id-type="pmid">30404611</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Szustakowski</surname><given-names>JD</given-names></name>. <article-title>DeconRNASeq: a statistical framework for deconvolution of heterogeneous tissue samples based on mRNA-Seq data</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1083</fpage>–<lpage>1085</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt090</pub-id><?supplied-pmid 23428642?><pub-id pub-id-type="pmid">23428642</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Xie</surname><given-names>X</given-names></name>. <article-title>A mixture model for expression deconvolution from RNA-seq in heterogeneous tissues</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>5</issue>):<fpage>S11</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Monaco</surname><given-names>G</given-names></name>, <name><surname>Lee</surname><given-names>B</given-names></name>, <name><surname>Xu</surname><given-names>W</given-names></name>, <name><surname>Mustafah</surname><given-names>S</given-names></name>, <name><surname>Hwang</surname><given-names>YY</given-names></name>, <name><surname>Carre</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>RNA-Seq Signatures Normalized by mRNA Abundance Allow Absolute Deconvolution of Human Immune Cell Types</article-title>. <source>Cell reports</source>. <year>2019</year>;<volume>26</volume>(<issue>6</issue>):<fpage>1627</fpage>–<lpage>1640</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id><?supplied-pmid 30726743?><pub-id pub-id-type="pmid">30726743</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Newman</surname><given-names>AM</given-names></name>, <name><surname>Liu</surname><given-names>CL</given-names></name>, <name><surname>Green</surname><given-names>MR</given-names></name>, <name><surname>Gentles</surname><given-names>AJ</given-names></name>, <name><surname>Feng</surname><given-names>W</given-names></name>, <name><surname>Xu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nature methods</source>. <year>2015</year>;<volume>12</volume>(<issue>5</issue>):<fpage>453</fpage><pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id><?supplied-pmid 25822800?><pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Qiao</surname><given-names>W</given-names></name>, <name><surname>Quon</surname><given-names>G</given-names></name>, <name><surname>Csaszar</surname><given-names>E</given-names></name>, <name><surname>Yu</surname><given-names>M</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>, <name><surname>Zandstra</surname><given-names>PW</given-names></name>. <article-title>PERT: a method for expression deconvolution of human blood samples from varied microenvironmental and developmental conditions</article-title>. <source>PLoS computational biology</source>. <year>2012</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e1002838</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002838</pub-id><?supplied-pmid 23284283?><pub-id pub-id-type="pmid">23284283</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Quon</surname><given-names>G</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>. <article-title>ISOLATE: a computational strategy for identifying the primary origin of cancers using high-throughput sequencing</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>21</issue>):<fpage>2882</fpage>–<lpage>2889</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp378</pub-id><pub-id pub-id-type="pmid">19542156</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Park</surname><given-names>J</given-names></name>, <name><surname>Susztak</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>NR</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>. <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>. <source>Nature communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>380</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id><?supplied-pmid 30670690?><pub-id pub-id-type="pmid">30670690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>N</given-names></name>, <name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Clarke</surname><given-names>R</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Shih</surname><given-names>IM</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <etal>et al</etal><article-title>UNDO: a Bioconductor R package for unsupervised deconvolution of mixed gene expressions in tumor samples</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>31</volume>(<issue>1</issue>):<fpage>137</fpage>–<lpage>139</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu607</pub-id><?supplied-pmid 25212756?><pub-id pub-id-type="pmid">25212756</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>JS</given-names></name>, <name><surname>Liu</surname><given-names>XS</given-names></name>. <article-title>Revisit linear regression-based deconvolution methods for tumor gene expression data</article-title>. <source>Genome biology</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>127</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1256-5</pub-id><?supplied-pmid 28679386?><pub-id pub-id-type="pmid">28679386</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Severson</surname><given-names>E</given-names></name>, <name><surname>Pignon</surname><given-names>JC</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>, <name><surname>Novak</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>. <source>Genome biology</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>174</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id><?supplied-pmid 27549193?><pub-id pub-id-type="pmid">27549193</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Ng</surname><given-names>AY</given-names></name>, <name><surname>Jordan</surname><given-names>MI</given-names></name>. <article-title>Latent dirichlet allocation</article-title>. <source>Journal of machine Learning research</source>. <year>2003</year>;<volume>3</volume>(<issue>Jan</issue>):<fpage>993</fpage>–<lpage>1022</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Quon</surname><given-names>G</given-names></name>, <name><surname>Haider</surname><given-names>S</given-names></name>, <name><surname>Deshwar</surname><given-names>AG</given-names></name>, <name><surname>Cui</surname><given-names>A</given-names></name>, <name><surname>Boutros</surname><given-names>PC</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>. <article-title>Computational purification of individual tumor gene expression profiles leads to significant improvements in prognostic prediction</article-title>. <source>Genome medicine</source>. <year>2013</year>;<volume>5</volume>(<issue>3</issue>):<fpage>29</fpage><pub-id pub-id-type="doi">10.1186/gm433</pub-id><?supplied-pmid 23537167?><pub-id pub-id-type="pmid">23537167</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Pachter L. Models for transcript quantification from RNA-Seq. arXiv preprint arXiv:11043889. 2011.</mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Marguerat</surname><given-names>S</given-names></name>, <name><surname>Bähler</surname><given-names>J</given-names></name>. <article-title>Coordinating genome expression with cell size</article-title>. <source>Trends in Genetics</source>. <year>2012</year>;<volume>28</volume>(<issue>11</issue>):<fpage>560</fpage>–<lpage>565</lpage>. <pub-id pub-id-type="doi">10.1016/j.tig.2012.07.003</pub-id><pub-id pub-id-type="pmid">22863032</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref036">
      <label>36</label>
      <mixed-citation publication-type="book"><name><surname>Burkard</surname><given-names>RE</given-names></name>, <name><surname>Dell’Amico</surname><given-names>M</given-names></name>, <name><surname>Martello</surname><given-names>S</given-names></name>. <source>Assignment problems, revised reprint</source>. <volume>vol. 125</volume><publisher-name>Siam</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007510.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <name><surname>McCue</surname><given-names>K</given-names></name>, <name><surname>Schaeffer</surname><given-names>L</given-names></name>, <name><surname>Wold</surname><given-names>B</given-names></name>. <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nature methods</source>. <year>2008</year>;<volume>5</volume>(<issue>7</issue>):<fpage>621</fpage><pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id><?supplied-pmid 18516045?><pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
