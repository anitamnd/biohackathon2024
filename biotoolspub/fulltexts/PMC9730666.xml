<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9730666</article-id>
    <article-id pub-id-type="publisher-id">5087</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05087-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EndHiC: assemble large contigs into chromosome-level scaffolds using the Hi-C links from contig ends</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Sen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Hengchao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Jiang</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Anqi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Hangwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Hanbo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Boyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Dong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Yan</given-names>
        </name>
        <address>
          <email>milrazhang@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5036-8733</contrib-id>
        <name>
          <surname>Fan</surname>
          <given-names>Wei</given-names>
        </name>
        <address>
          <email>fanwei@caas.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.410727.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0526 1937</institution-id><institution>Guangdong Laboratory for Lingnan Modern Agriculture (Shenzhen Branch), Genome Analysis Laboratory of the Ministry of Agriculture and Rural Affairs, Agricultural Genomics Institute at Shenzhen, </institution><institution>Chinese Academy of Agricultural Sciences, </institution></institution-wrap>Shenzhen, 518120 Guangdong China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>528</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The application of PacBio HiFi and ultra-long ONT reads have enabled huge progress in the contig-level assembly, but it is still challenging to assemble large contigs into chromosomes with available Hi-C scaffolding tools, which count Hi-C links between contigs using the whole or a large part of contig regions. As the Hi-C links of two adjacent contigs concentrate only at the neighbor ends of the contigs, larger contig size will reduce the power to differentiate adjacent (signal) and non-adjacent (noise) contig linkages, leading to a higher rate of mis-assembly.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We design and develop a novel Hi-C based scaffolding tool EndHiC, which is suitable to assemble large contigs into chromosomal-level scaffolds. The core idea behind EndHiC, which distinguishes it from other Hi-C scaffolding tools, is using Hi-C links only from the most effective regions of contig ends. By this way, the signal neighbor contig linkages and noise non-neighbor contig linkages are separated more clearly. Benefiting from the increased signal to noise ratio, the reciprocal best requirement, as well as the robustness evaluation, EndHiC achieves higher accuracy for scaffolding large contigs compared to existing tools. EndHiC has been successfully applied in the Hi-C scaffolding of simulated data from human, rice and Arabidopsis, and real data from human, great burdock, water spinach, chicory, endive, yacon, and <italic>Ipomoea cairica</italic>, suggesting that EndHiC can be applied to a broad range of plant and animal genomes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">EndHiC is a novel Hi-C scaffolding tool, which is suitable for scaffolding of contig assemblies with contig N50 size near or over 10 Mb and N90 size near or over 1 Mb. EndHiC is efficient both in time and memory, and it is interface-friendly to the users. As more genome projects have been launched and the contig continuity constantly improved, we believe EndHiC has the potential to make a great contribution to the genomics field and liberate the scientists from labor-intensive manual curation works.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-05087-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Hi-C</kwd>
      <kwd>Scaffolding</kwd>
      <kwd>Contig end</kwd>
      <kwd>Assembly</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Grant No. 32000408</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Yan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">The long accurate reads generated by PacBio High-Fidelity (HiFi) technology, with an average read length over 10-Kb and base accuracy over 99%, has been widely applied in the de novo assembly of plant and animal genomes [<xref ref-type="bibr" rid="CR1">1</xref>]. Specific software for assembling HiFi reads have also been developed, such as Hifiasm [<xref ref-type="bibr" rid="CR2">2</xref>] and HiCanu [<xref ref-type="bibr" rid="CR3">3</xref>], which in general can produce large contigs with N50 size over tens of mega-bases for a substantial part of genomes [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Besides, the ultra-long noisy reads with an average length over 50-Kb from Oxford Nanopore Technology (ONT) and related software development such as wtdbg2 [<xref ref-type="bibr" rid="CR7">7</xref>], also largely improve the contig continuity in genome assemblies. The huge progress in the contig-level assembly makes the goal of telomere-to-telomere assembly more visible than ever before, however, chromosomal-scale linkage data is still needed to assemble these large contigs into complete chromosomes.</p>
    <p id="Par9">Hi-C sequencing provides a fast and cost-effective way for scaffolding the contigs into chromosome-level sequences [<xref ref-type="bibr" rid="CR8">8</xref>], based on the facts that the density of Hi-C linked pairs between adjacent contigs is higher than that of between non-adjacent contigs. Several Hi-C scaffolding tools have been developed: LACHESIS and ALLHiC use hierarchical agglomerative clustering algorithm to group contigs, and perform ordering and orientation in the following steps [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]; 3D-DNA cuts contigs in the middle site to form sister-contigs, assigns links to non-sister contigs with reciprocal best requirement, and finishes clustering, ordering and orientation tasks simultaneously [<xref ref-type="bibr" rid="CR11">11</xref>]; HiC-Hiker aims to improve the contig order and orientation generated by other Hi-C scaffolding tools, adopting a probability model and dynamic programming algorithm [<xref ref-type="bibr" rid="CR12">12</xref>]; HiRise is specially designed for the in vitro Hi-C data [<xref ref-type="bibr" rid="CR13">13</xref>], while SALSA2 constructs scaffolds using both edges from the contig graphical fragment assembly (GFA) file and linkages inferred from the Hi-C data [<xref ref-type="bibr" rid="CR14">14</xref>]. All these tools were mainly tested on the relatively shorter contig assemblies, with contig N50 size equal or lower than 1 Mb, which can be routinely obtained from second-generation accurate short reads or third-generation noisy long reads sequencing. Thanks to the contribution of these pioneer algorithms, hundreds to thousands of chromosomal-scale reference genomes of plants and animals have been successfully generated and published.</p>
    <p id="Par10">Logically, larger contigs will simplify scaffolding with Hi-C data, but it is not as expected for the above Hi-C scaffolding tools. Although they can successfully achieve chromosomal-level scaffolds with the relatively shorter contigs (N50 size ≤ 1 Mb), they will fail to do so with the much larger contigs (N50 size ≥ 10 Mb). A major reason is that all above tools compute the pairwise contig linkages using Hi-C links from the whole contig regions, which is reasonable and suitable for scaffolding of relatively shorter contigs [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. Considering that the Hi-C links of two adjacent contigs concentrate only at the neighbor ends of the contigs (usually &lt; 3-Mb) and large amount Hi-C links also exist between some non-adjacent contigs, the number of Hi-C links between adjacent contigs and that between non-adjacent contigs will become closer when the contig size gets larger. Therefore, the large contig size will reduce the power to differentiate adjacent contig linkages from non-adjacent contig linkages calculated using Hi-C links from the whole contig regions, leading to a high error rate in scaffolding these large contigs. The recently published Pin_hic has realized and tried to resolve this problem [<xref ref-type="bibr" rid="CR15">15</xref>]. In Pin_hic, each contig is split into 3 equal parts, and only the first and third part are used to represent the 5′- and 3′- ends of the contig, respectively. Beyond Pin_hic, the same research group has been developing another advanced Hi-C scaffold algorithm, YaHS [<xref ref-type="bibr" rid="CR16">16</xref>], which also adopts the contig end idea to improve the accuracy of the contig contact matrix. Combined with a set of comprehensive graph cleaning methods, it was reported that YaHS can generate genome assemblies with much higher accuracy and contiguity than the previous Hi-C scaffolding tools.</p>
    <p id="Par11">Using the current long accurate HiFi reads, we can routinely generate highly continuous contigs with N50 size approaching or larger than 10 Mb and N90 size approaching or larger than 1 Mb for a certain part of plant and animal genomes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Here we do not include complex genomes, such as polyploidy or those enriched in long repeats, which tend to generate more fragmental contig assemblies. For some simpler genomes with less repeat sequences, the contig assemblies can even achieve near-chromosome level, i.e., most chromosome is just composed of one to five contigs. LACHESIS, ALLHiC and 3D-DNA were not designed and not suitable for scaffolding of these large contigs. Pin_hic and YaHS do not thoroughly implement the contig end idea, and they were also mainly tested on relatively fragmental contig assemblies. Therefore, it is still challenging for scaffolding these large contigs from HiFi reads assembly with all the available Hi-C scaffolding tools. To resolve this problem, here we developed an independent Hi-C scaffolding tool EndHiC, which constructs scaffolds with only Hi-C links from the most effective region of contig ends. To illustrate the EndHiC method, we used the genome data of a medical and vegetable plant great burdock (<italic>Arctium lappa</italic>) sequenced by our group [<xref ref-type="bibr" rid="CR4">4</xref>], which was EndHiC’s first successful application and also on which the inspiration of using contig end was born.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par12">The overall workflow of EndHiC is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. EndHiC needs two necessary input data: (1) The high continuous contigs generated by Hifiasm [<xref ref-type="bibr" rid="CR2">2</xref>], HiCanu [<xref ref-type="bibr" rid="CR3">3</xref>], etc. If the contig correction option is chosen, the contigs will be broken at the mis-joining site when assembly error is detected; (2) The analyzing results of reads mapping from the HiC-Pro pipeline. To fully utilize the professional efforts of HiC-Pro [<xref ref-type="bibr" rid="CR17">17</xref>], the “.bed” file recording relationships between contigs and bins, the raw and normalized “.matrix” files storing contact values of all bin pairs, with bin size of 100-Kb (recommend), are used by EndHiC.<fig id="Fig1"><label>Fig. 1</label><caption><p>Illustration of EndHiC algorithm; <bold>a</bold> The overall workflow of EndHiC, the five parts inside the dashed lines are the core of EndHiC algorithm, and “optional” means that this step is not necessary for all the cases. <bold>b</bold> Schema chart for contig head and tail end with size 1-Mb, each end contains 10 of 100-kb bins; The last bin of the contig is generally shorter than 100-Kb, but for bin number over 5, i.e. contig end size over 500-Kb, recommended in practice, the size of head and tail ends using specified number of bins can be thought as equal</p></caption><graphic xlink:href="12859_2022_5087_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par13">When the optional module of contig error correction is implemented, EndHiC also needs another optional input data: the mapping file of unitigs to contigs, which can be generated by the EndHiC built-in script “map_utg_to_ctg.pl”. This script reads the HiFiasm output files *_utg.noseq.gfa and *_ctg.noseq.gfa and outputs the mapping relationships of unitigs to contigs. Even without the unitig-to-contig mapping file, EndHiC can still perform contig error correction with only the HiC-Pro output results.</p>
      <p id="Par14">Inside the dashed region of Fig. <xref rid="Fig1" ref-type="fig">1</xref>a is the core of EndHiC algorithm, including five steps: (1) The contact value for each pair of contig ends is calculated by summing the contact values of bins falling into the corresponding contig end regions. Each contig has two ends, the left-side end is defined as head end, while the right-side end is defined as tail end. The size of the contig ends is determined as the number of 100-Kb bins (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). (2) Get the turning point of all contact values by a linear transformation method. The turning point is a natural separation of signal and noise contact values. (3) Identify reliable contig linkages which satisfy two requirements: over a specified cutoff and is reciprocal best hits. (4) The contig linkages were converted to GFA format file, which can be graphically displayed in Bandage software [<xref ref-type="bibr" rid="CR18">18</xref>]. (5) Output the linkage groups (cluster) with order and orientation information.</p>
      <p id="Par15">To increase the accuracy and provide robustness estimation, the scaffolding results with various contig end sizes and contact value cutoffs were merged to generate a consensus scaffolding result, which is generally more reliable. When the contig assembly is quite good, then just one round of EndHiC can produce chromosomal-level scaffolds. However, when the contig assembly is relatively fragmental, multiple rounds of EndHiC with increasing contig end sizes are needed to achieve such goals. Finally, AGP and Fasta format files were generated for downstream applications.</p>
    </sec>
    <sec id="Sec4">
      <title>Eliminate assembly errors in contigs</title>
      <p id="Par16">Error-free contigs are important for the scaffold assembly using any Hi-C scaffolding tool. In EndHiC, we detect and correct the contig assembly errors using both Hi-C contact heatmap and the mapping relationship of unitigs to contigs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Unitigs are the basic non-branching units in the assembly graph constructed from overlapped reads. After complex graph cleaning processes such as tip removal and bubble cleavage, contigs are generated by traversing the linearized paths of unitigs. Therefore, the assembly error in contigs are often caused by incorrect graph cleaning, resulting in mis-join of two non-neighbor unitigs. Previous Hi-C scaffolding tool such as 3D-DNA and YaHS identify the assembly error in contigs based on the intra-contig Hi-C contact heatmap, because mis-join will cause a lack of Hi-C links crossing the point of mis-join. However, we think only using Hi-C is not enough, for that some correctly-assembled genomic regions may also have very low Hi-C links. In EndHiC, we determine the mis-join positions by these two requirements: (1) the Hi-C contact value between two 100-Kb bins (500-Kb apart) is lower than 10% of the median of all 100-Kb bin pairs (500-Kb apart); (2) two separate unitigs surrounding this position. Then, EndHiC will break the contig at the detected mis-join position. When the unitig-to-contig mapping is not available, EndHiC can still perform contig error correction with only the Hi-C contact heatmap, just like 3D-DNA and YaHS do. Note that this step is optional for EndHiC, and you can pass it if you are confident about the accuracy of contig assemblies.<fig id="Fig2"><label>Fig. 2</label><caption><p>Example of assembly error detection in a contig from chicory. The upper part shows the change of Hi-C contact between two 100-Kb bins 500-Kb apart along the 20-Mb long contig “ptg000050l” from left to right. The lower part is the Hi-C contact heatmap of the contig “ptg000050l”, in which the size of each bin is 100-Kb and the color of each bin is proportional to the Hi-C contact value between two bins. The mapping relationship of unitigs to the contig “ptg000050l” were shown in the horizontal axis. The genomic site with sharp change of Hi-C contact pattern and also is the boundary of two neighbor unitigs, indicates an assembly error</p></caption><graphic xlink:href="12859_2022_5087_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Estimate the optimal size for contig ends</title>
      <p id="Par17">The size of the contig ends is vital for the effectiveness of EndHiC. Then, what is the optimal size value? To answer this question, we calculated the contact values for contig ends with different contig end sizes ranging from 500-Kb to 40-Mb, using the human simulated data and the real great burdock (<italic>Arctium lappa</italic>) genome data that was finely assembled by Hifiasm and further scaffolded into 18 chromosomes [<xref ref-type="bibr" rid="CR4">4</xref>]. We took the contact values from adjacent contig ends as signal contact values, while that from non-adjacent contigs ends as noise contact values. From the boxplot distribution of the contact values, we observed that the signal and noise contact values were better separated under smaller contig end sizes, but weakly separated under larger contig end sizes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a, b).<fig id="Fig3"><label>Fig. 3</label><caption><p>Distribution of signal and noise values using data from great burdock. Boxplot for signal and noise Hi-C contact values along contig end sizes, using the raw links data (<bold>a</bold>) and normalized links data (<bold>b</bold>). For each contig end size, both the signal and noise values are normalized by the median of noise values. Signal to noise ratio (SNR) along contig end sizes calculated from the raw links data (<bold>c</bold>) and normalized links data (<bold>d</bold>). The contact values from adjacent contig ends and non-adjacent contigs ends are taken as signal and noise contact values, respectively. The signal to noise ratio, is defined as the median of signal contact values divided by the median of noise contact values. Both the boxplot distribution and the signal to noise curve showed that the difference between signal and noise contact values will become smaller as the contig end size grows larger</p></caption><graphic xlink:href="12859_2022_5087_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par18">To quantitatively evaluate the power of using various contig end sizes to differentiate between signal and noise contact values, we further adopted a signal to noise ratio (SNR) approach. For each contig end size, the SNR is defined as the median of signal contact values divided by the median of noise contact values. From the distribution of SNR along contig end sizes, we observed that the SNR is higher than 100: 1 for contig end size less than 2.5-Mb, but becomes lower than 10: 1 for contig end size larger than 20-Mb (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1c, d, Table S1). That is to say, using the contig end sizes larger than 2.5-Mb will have lower ability to differentiate between adjacent and non-adjacent contig linkages. On the other hand, we also noticed that the number of Hi-C links fluctuate severely within smaller contig regions. Thus, the use of contig end sizes smaller than 500-Kb tends to generate instable scaffold results. Therefore, contig end sizes from 500-Kb to 2.5-Mb are preferentially recommended for EndHiC, and the users can change the contig end sizes through parameter settings of EndHiC.</p>
    </sec>
    <sec id="Sec6">
      <title>Determine the turning point of contact values</title>
      <p id="Par19">When the contact values among all the contig ends with a specified size are calculated, the key job is to differentiate the signal from noise contact values. The signal contact values are generated from adjacent contig ends, whereas the noise contact values are generated from non-adjacent contig ends. Is there a cutoff value able to clearly separate the signal and noise contact values? To resolve this question, we sorted all the contact values of contig ends (1.5-Mb) in great burdock, and found a sharp turning point around 1500 in the distribution (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2a). The contact values larger than the turning point composes all the signal contact values and a small number of noise signal values, whereas the contact values smaller than the turning point composes only the noise contact values. Based on this finding, we developed a linear transforming method to automatically detect the turning point, which is used as a potential contact cutoff in EndHiC. In the linear transforming method, the adjusted contact values were anticlockwise rotated by 45 degree and the lowest point was identified as the turning point (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2bc).</p>
    </sec>
    <sec id="Sec7">
      <title>Scaffolding graph construction and cleaning</title>
      <p id="Par20">WE construct a scaffolding graph with the contig ends as nodes, thus each contig will have two nodes representing the left contig end and the right contig end. The two nodes from the same contig were connected firstly and would not be broken, and then EndHiC assign an edge between two nodes from different contigs if the corresponding contact value is larger than a specified cutoff. As the turning point often falls in the top part of the noise contact values, it is a not a good separation border for the signal and noise contact values. From our experience, we found that 1.5–4.5 times of the automatically identified turning point are more appropriate values to be used as a cutoff here. Lower cutoff tends to cause mis-joining of contigs from different chromosomes, whereas larger cutoff tends to cause segmental assembly of the chromosomes. To clean the graph, EndHiC adopts a reciprocal best approach [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], requiring the contact value between two adjacent contig ends to be the max contact value for both two contig ends. Thus, branching edges that do not satisfy the reciprocal best requirement will be excluded from the scaffolding graph. Given the reciprocal best requirement, one contig end will have only one link to the other contig end, which makes sure that most paths in the scaffolding graph are linear. However, circular path might still occur when the two ends of a chromosome are connected. When this happens, EndHiC will break the circular paths at the position with lowest contact value (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a).<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Construction and cleaning of the scaffolding graph. Each contig have two nodes representing the left contig end and the right contig end. The two nodes from the same contig were tied together and won’t be broken, and the two nodes from different contigs if the corresponding contact value is larger than a specified cutoff, were assigned an edge. Branching edges that do not satisfy the reciprocal best requirement will be excluded, and circular paths are broken at the position with lowest contact value. <bold>b</bold> Rules for determining relative contig order and orientation by the reliable links (edge) between neighbor contig ends. The color green and blue indicate contig and contig end, respectively. The connecting line indicate reliable link between adjacent contig ends. The mark “+” and “−” means forward and reverse strands assigned in the GFA file. <bold>c</bold> Example graphic view (Bandage) of cleaned scaffolding graph with contig end size 1.5 Mb and contact cutoff of 1.5 times of the turning point for great burdock, 28 large contigs were linked into 18 linear paths (anchor rate &gt; 99%), with each path corresponding to a natural chromosome. Small clusters with length less than 1 Mb are not shown. Using raw and normalized matrix data generates the same result</p></caption><graphic xlink:href="12859_2022_5087_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">Then, EndHiC converts the raw and cleaned scaffolding graphs into separate GFA format files, following the rules showed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b. If the link is assigned to the tail end of contig_1 (on the left side), a strand mark “+” will be given to contig_1, whereas if the link is assigned to the head end of contig_1, a strand mark “−” will be given to contig_1; the opposite rules are applied to contig_2 (on the right side). Conveniently, the GFA file representing the scaffolding graph can be viewed in Bandage, a tool for visualizing assembly graphs with connections [<xref ref-type="bibr" rid="CR18">18</xref>]. As an example, the Bandage view of cleaned scaffolding graph from great burdock with contig end size 1.5 Mb and contact cutoff of 1.5 times of the turning point is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c. With the graphic tool, the users can quickly have an overall view about the scaffolding quality, and find the assembly errors more easily. On this example, the 18 linear paths were displayed, with each path corresponding to a natural chromosome of great burdock. Finally, the resulting cluster file with order and orientation information were generated by traversing each linear path independently on the cleaned scaffolding graph.</p>
    </sec>
    <sec id="Sec8">
      <title>Merge clusters from parallel results with various parameters</title>
      <p id="Par22">To increase scaffolding accuracy, the EndHiC pipeline (endhic.pl) runs in parallel with various contig end sizes from 500 to 2500-Kb in step of 500-Kb, and various contact cutoffs from 1 to 5 times of the basic cutoff (turning point value) in step of 0.5, using both raw and normalized matrix data. Each combination of the parameters generates an independent cluster file with contig order and orientation. Most of these cluster files contain correct chromosomal-scale scaffolds, but a few chromosomes in some cluster files may be mis-scaffolded. Then, EndHiC summarizes all these cluster results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), merges the cluster units and counts their frequency. The cluster units were output sequentially based on the frequency from high to low, because cluster units with a relatively higher frequency are thought to be more reliable. During this process, cluster units with contigs that have appeared in previously outputted cluster units were not chosen to output. By this way, a set of non-redundant cluster units is generated as the best result of EndHiC scaffolds. In addition, the frequency of the cluster unit is also used as a robustness evaluation, reflecting the accuracy of each individual cluster unit.</p>
      <p id="Par23">For the great burdock example, the consensus clusters (Table <xref rid="Tab1" ref-type="table">1</xref>) are the same to that shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, which just use one parameter combination: contig end size 1.5 Mb and contact cutoff of 1.5 times of the turning point. Although both the consensus method and single parameter method have successfully generated 18 chromosomal-level scaffolds, we strongly recommend the users to run the consensus method which can generate the correct result automatically at most times. In contrast, it will be a little difficult to determine the optimal contig end size and contact cutoff value for a single parameter method, which needs more experience and will not guarantee to generate the correct result every time. When the consensus clusters seem not totally correct, you can also look into the cluster files generated from various parameter combinations and choose the best cluster file from one parameter combination. At last, EndHiC converts the consensus cluster file from all parameter combinations or the best cluster file from one parameter combination into AGP and Fasta format files, which are compatible for most downstream analysis.<table-wrap id="Tab1"><label>Table 1</label><caption><p>EndHiC consensus clusters for great burdock with robustness information</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster_id</th><th align="left">Contig count</th><th align="left">Cluster length (bp)</th><th align="left">Robustness [max:90]</th><th align="left">Included contigs with order and orientation</th></tr></thead><tbody><tr><td align="left">Cluster_A01</td><td align="left">1</td><td char="," align="char">180,134,246</td><td align="left">90</td><td align="left">ptg000007l + </td></tr><tr><td align="left">Cluster_A02</td><td align="left">4</td><td char="," align="char">157,781,296</td><td align="left">54</td><td align="left">ptg000019l + ;ptg000017l + ;ptg000037l + ;ptg000033l-</td></tr><tr><td align="left">Cluster_A03</td><td align="left">2</td><td char="," align="char">137,502,900</td><td align="left">81</td><td align="left">ptg000003l + ;ptg000004l-</td></tr><tr><td align="left">Cluster_A04</td><td align="left">2</td><td char="," align="char">116,070,885</td><td align="left">80</td><td align="left">ptg000002l + ;ptg000026l + </td></tr><tr><td align="left">Cluster_A05</td><td align="left">1</td><td char="," align="char">103,325,058</td><td align="left">90</td><td align="left">ptg000009l + </td></tr><tr><td align="left">Cluster_A06</td><td align="left">1</td><td char="," align="char">98,139,150</td><td align="left">90</td><td align="left">ptg000005l + </td></tr><tr><td align="left">Cluster_A07</td><td align="left">2</td><td char="," align="char">91,022,879</td><td align="left">90</td><td align="left">ptg000020l + ;ptg000021l-</td></tr><tr><td align="left">Cluster_A08</td><td align="left">2</td><td char="," align="char">90,391,671</td><td align="left">90</td><td align="left">ptg000011l-;ptg000023l + </td></tr><tr><td align="left">Cluster_A09</td><td align="left">2</td><td char="," align="char">89,788,315</td><td align="left">76</td><td align="left">ptg000018l-;ptg000028l + </td></tr><tr><td align="left">Cluster_A10</td><td align="left">2</td><td char="," align="char">83,430,363</td><td align="left">89</td><td align="left">ptg000010l-;ptg000025l + </td></tr><tr><td align="left">Cluster_A11</td><td align="left">1</td><td char="," align="char">76,614,701</td><td align="left">90</td><td align="left">ptg000013l + </td></tr><tr><td align="left">Cluster_A12</td><td align="left">1</td><td char="," align="char">76,000,989</td><td align="left">90</td><td align="left">ptg000012l + </td></tr><tr><td align="left">Cluster_A13</td><td align="left">1</td><td char="," align="char">73,598,797</td><td align="left">90</td><td align="left">ptg000022l + </td></tr><tr><td align="left">Cluster_A14</td><td align="left">1</td><td char="," align="char">70,868,591</td><td align="left">90</td><td align="left">ptg000016l + </td></tr><tr><td align="left">Cluster_A15</td><td align="left">1</td><td char="," align="char">69,740,074</td><td align="left">90</td><td align="left">ptg000001l + </td></tr><tr><td align="left">Cluster_A16</td><td align="left">2</td><td char="," align="char">67,669,029</td><td align="left">90</td><td align="left">ptg000015l + ;ptg000027l-</td></tr><tr><td align="left">Cluster_A17</td><td align="left">1</td><td char="," align="char">61,985,296</td><td align="left">90</td><td align="left">ptg000008l + </td></tr><tr><td align="left">Cluster_A18</td><td align="left">1</td><td char="," align="char">60,844,256</td><td align="left">90</td><td align="left">ptg000014l + </td></tr></tbody></table><table-wrap-foot><p>This is the final merged cluster results from one round of EndHiC, with each cluster corresponding to a natural chromosome. Robustness represents the frequency of this cluster type in the EndHiC results of all parameter combinations. For the order and orientation of contigs, “+” stands for the forward strand, while “−” stands for the reverse strand</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec9">
      <title>Run multiple rounds with increasing contig end sizes</title>
      <p id="Par24">Originally, EndHiC was designed for long continuous contig assemblies, such as the great burdock, on which just one round of EndHiC is able to produce the chromosome-scale scaffolds. The contig end sizes ranging from 500 to 2500-Kb in the default EndHiC parameters are the most effective values. However, even the large contigs might have repetitive sequences on the contig ends, and sometimes the contig assemblies might be a little fragmental than expected. For these cases, one round EndHiC might fail to scaffold all the chromosomes, resulting in non-chromosomal-level scaffolds.</p>
      <p id="Par25">To resolve these problems, we further developed an iterative mode of EndHiC (endhic_iterate.pl), with each iterative round using increased contig end sizes. The following round will use the assembly result of previous round as the input data. By default, the first round still uses contig end sizes from 0.5 to 2.5 Mb, and the following rounds will use contig end sizes 3–5 Mb, 5.5–7.5 Mb, 8–10 Mb, …, with each round increasing 2.5 Mb. Note that the increasing step of the contig end sizes can be set by the users. It should be emphasized that the scaffolding accuracy will decrease as the contig end size grow larger, so the round number no larger than 3, i.e., contig end size no larger than 10 Mb, is recommended in order to get relatively reliable scaffolding results. When the chromosome number is available, you can choose the scaffolding results from the round in which the scaffold number is approaching or equal to the chromosome number. However, if the chromosome number is not known, we do not suggest to run the iterative mode of EndHiC, because it is hard to determine the appropriate round number. EndHiC does not take long scaffold length as its primary goal, but aims to generate a reliable scaffolding result. Furthermore, the EndHiC result files can be converted into Juicebox’s “.assembly” and “.hic” format files, which can be loaded into the graphical viewing tool Juicebox for verification and manual curation [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <sec id="Sec11">
      <title>Comparison of scaffolding accuracy using simulated and real data</title>
      <p id="Par26">The accuracy of EndHiC was compared with LACHESIS [<xref ref-type="bibr" rid="CR9">9</xref>], ALLHiC [<xref ref-type="bibr" rid="CR10">10</xref>], 3D-DNA [<xref ref-type="bibr" rid="CR11">11</xref>], Pin_hic [<xref ref-type="bibr" rid="CR15">15</xref>] and YaHS [<xref ref-type="bibr" rid="CR16">16</xref>] using both the simulated data (human, rice, Arabidopsis) and the real data (human, great burdock, water spinach) (Table <xref rid="Tab2" ref-type="table">2</xref>). In the simulated data, the contigs are simulated from the reference genome (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3), whereas in the real data, the contigs were assembled from HiFi reads. The continuity (N50 size) of the simulated contigs is comparable to those of real contigs that assembled from HiFi reads, in average about 5 contigs per chromosome. In addition, smaller contigs with size less than 1 Mb were excluded. Considering that assembly errors were not added in the simulated contigs and there were no obvious assembly errors in the analyzed contigs of real data, contig error corrections were not performed for all the Hi-C scaffolding tools. All the Hi-C data used here are real sequencing data, with coverage depth ranging from 40 to 130× (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). The human, rice and Arabidopsis data have been widely used in testing of Hi-C scaffolding tools, while the genomes of two species great burdock and water spinach were recently sequenced by our group.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of simulated and real contig data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Assembly type</th><th align="left">Species</th><th align="left">Chromo-somes (n)</th><th align="left">Genome size</th><th align="left">Total contig number</th><th align="left">Total contig length</th><th align="left">Assembled percent (%)</th><th align="left">Average contig number</th><th align="left">Contig N50</th><th align="left">Contig N90</th></tr></thead><tbody><tr><td align="left" rowspan="3">Simulated assembly</td><td align="left">Human</td><td char="." align="char">23</td><td char="." align="char">3,054,815,472</td><td char="." align="char">104</td><td char="." align="char">3,054,815,472</td><td char="." align="char">100%</td><td char="." align="char">4.52</td><td char="," align="char">47,909,438</td><td char="," align="char">14,532,355</td></tr><tr><td align="left">Rice</td><td char="." align="char">12</td><td char="." align="char">373,094,580</td><td char="." align="char">42</td><td char="." align="char">373,094,580</td><td char="." align="char">100%</td><td char="." align="char">3.50</td><td char="," align="char">11,071,427</td><td char="," align="char">5,000,429</td></tr><tr><td align="left">Arabidopsis</td><td char="." align="char">5</td><td char="." align="char">119,146,348</td><td char="." align="char">11</td><td char="." align="char">119,146,348</td><td char="." align="char">100%</td><td char="." align="char">2.20</td><td char="," align="char">9,660,775</td><td char="," align="char">5,994,203</td></tr><tr><td align="left" rowspan="3">Hifiasm-assembly</td><td align="left">Human</td><td char="." align="char">23</td><td char="." align="char">3,054,815,472</td><td char="." align="char">82</td><td char="." align="char">3,007,080,905</td><td char="." align="char">98%</td><td char="." align="char">3.57</td><td char="," align="char">89,131,734</td><td char="," align="char">28,203,557</td></tr><tr><td align="left">Great burdock</td><td char="." align="char">18</td><td char="." align="char">1,720,000,000</td><td char="." align="char">30</td><td char="." align="char">1,709,056,189</td><td char="." align="char">99%</td><td char="." align="char">1.67</td><td char="," align="char">74,692,580</td><td char="," align="char">38,981,084</td></tr><tr><td align="left">Water spinach</td><td char="." align="char">15</td><td char="." align="char">485,000,000</td><td char="." align="char">29</td><td char="." align="char">480,197,403</td><td char="." align="char">99%</td><td char="." align="char">1.61</td><td char="," align="char">23,511,778</td><td char="," align="char">9,860,712</td></tr></tbody></table><table-wrap-foot><p>Genome size are validated or estimated value. The contigs with size &gt; 1 Mb are used for statistics in this table. Assembled percent = total contig length/genome size. Average contig number means average contig number per chromosome. For simulated data, the reference genomes of human CHM13 v1.1, rice (Nipponbare) ASM386523v1, Arabidopsis thaliana (Columbia) TAIR10.1 were used to simulate large contigs, and each chromosome of reference genome was randomly split into 1–6 contigs. In the simulated assembly, contigs size smaller than 1 Mb were not allowed, and all the contigs are larger than 1 Mb. For real data, the hifiasm-assembled contigs of human were downloaded from <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4393631/files/CHM13.HiFi.hifiasm-0.12.fa.gz">https://zenodo.org/record/4393631/files/CHM13.HiFi.hifiasm-0.12.fa.gz</ext-link>, while the contigs of great burdock and water spinach were assembled by hifiasm using default parameters from HiFi reads downloaded from NCBI-SRA databases (PRJNA764011 and PRJNA764042)</p></table-wrap-foot></table-wrap></p>
      <p id="Par27">One round of EndHiC with default parameters is applied to all the datasets except for the human real data, which needs two rounds of EndHiC to achieve chromosome-level scaffolds. In the human real data, some contig ends have relatively lower link density due to long heterochromatin repeat sequences, so the first round (A) of EndHiC with default contig end sizes 0.5–2.5-Mb failed to cluster these contigs into chromosome-level scaffolds, resulting in 34 clusters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a). Larger contig ends will span the repetitive regions in the contig end and overcome this problem, so the second round (B) using contig end sizes 3.0–5.0-Mb have successfully clustered these contigs, resulting in 23 clusters, which is equal to the chromosome number of human (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3b).</p>
      <p id="Par28">We used the corresponding reference genomes to validate the EndHiC assembly accuracy of species human, rice and Arabidposis, and used the Bandage graphic view (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4), Hi-C heatmap (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5), as well as the synteny relationship with closely related species (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6), to validate the EndHiC assembly accuracy of species great burdock and water spinach, whose reference genome are not available. Considering all these evidences, EndHiC have correctly clustered all the simulated and real large contigs into chromosomes. In respect to order and orientation, EndHiC only makes a mistake for two neighbor contigs in chromosome_1 of the human real data, caused by the extremely long heterochromatin repeat sequence (~ 20 Mb) between them. For the anchor rate, EndHiC has anchored 100% of the contigs into chromosomes in simulated data, and anchored 99.3%, 99.8%, 99.7% of the contigs into chromosomes for human, great burdock, and water spinach real data, respectively. These results suggest that EndHiC is able to assemble the large contigs generated from the current HiFi reads into chromosome-level scaffolds, with high accuracy in the cluster, order and orientation, for a certain part of diploid plant and animal genomes.</p>
      <p id="Par29">In contrast, LACHESIS, ALLHiC, 3D-DNA, Pin_hic and YaHS only correctly clustered 0%, 17%, 53%, 72% and 87% of the chromosomes, respectively, in average of the simulated and real data (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). For the round number, there was no iterative scaffolding process for Lachesis and AllHiC, which use hierarchical agglomerative clustering algorithm; Pin_hic iterative model was used, and it iterated three times by default; 3D-DNA and YaHS determines the iterative round number automatically inside the tools. The round number for all the tools on all the datasets were shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6. In general, the major problem for LACHESIS and ALLHiC is mis-joining of different chromosomes, whereas the major problems for 3D-DNA, Pin_hic and YaHS are segmental assembly of chromosomes and mis-joining of different chromosomes. Taking the scaffolding results of the human (n = 23) real data as an example, LACHESIS, ALLHiC and Pin_hic mis-joined 23, 7 and 3 chromosomes. In addition, 3D-DNA, Pin_hic and YaHS generated segmental scaffolds for 10, 1 and 3 chromosomes, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). Similar to EndHiC, none of these tools can assign the two neighbor contigs from chromosome_1 of the human real data into one cluster. For the order and orientation, all these scaffolding tools still work well with the large contigs, and the accuracy is comparable to that of EndHiC. Therefore, the major problem for these tools is insufficient (segment) or excessive (mis-join) clustering, which limits their application ranges. For scaffolding large contigs, in average, the overall performance from worse to better is: LACHESIS &lt; ALLHiC &lt; 3D-DNA &lt; Pin_hic &lt; YaHS &lt; EndHiC.<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of clustering accuracy for 6 Hi-C scaffolding tools. LACHESIS and ALLHiC were run with chromosome number as input, and the other Hi-C scaffolding tools do not need the chromosome number. For human (n = 23), rice (n = 12), Arabidopisis (n = 5), the reference genomes of human CHM13 v1.1, rice (Nipponbare) ASM386523v1, Arabidopsis thaliana (Columbia) TAIR10.1 were used for comparison with the results of four Hi-C scaffolders. For great burdock (n = 18) and water spinach (n = 15), the genomes of closely related species <italic>Cynara cardunculus</italic> (NCBI RefSeq GCF_001531365.1) and <italic>Ipomoea triloba</italic> (NCBI RefSeq GCF_003576645.1) were used for comparison. For fairness, only larger contigs with size &gt; 1 Mb were used for all the 6 Hi-C scaffolding tools, and the percent of used contigs were shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Just one round of EndHiC was applied to all the 3 simulated datasets (human, rice, Arabidopsis) and two real datasets (great burdock, water spinach), and two rounds of EndHiC were applied to the human real dataset. Complete: A Hi-C scaffold includes most fragments only from one chromosome, i.e. the total length of shared contigs between a Hi-C scaffold (cluster) and the reference chromosome accounts for over 85% of both the scaffold (cluster) and the chromosome. Segment: A chromosome is fragmented into two or more large scaffold, and each segment scaffold accounts for 5–85% of the corresponding chromosome. Mis-joined: A Hi-C scaffold includes large fragments from two or more chromosomes. In overall, the clustering accuracy for these large contigs is: LACHESIS &lt; ALLHiC &lt; 3D-DNA &lt; Pin_hic &lt; YaHS &lt; EndHiC</p></caption><graphic xlink:href="12859_2022_5087_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Evaluation of the accuracy of contig error detection</title>
      <p id="Par30">To evaluate the accuracy of EndHiC contig error detection, we randomly simulated comparable number of erroneous (with one mis-join error) and error-free (with no error) contigs with comparable contig sizes (&gt; 1 Mb), using the reference genomes of Arabidopsis, rice, and human. The corresponding Hi-C reads were mapped to simulated contigs using HiC-Pro, and EndHiC used the *.bed and *.matrix files to detect mis-join errors since unitigs are not available for simulation. Of the simulated 56, 101, and 221 erroneous contigs for Arabidopsis, rice, and human, EndHiC successfully identified 52, 93, and 200 contigs to have mis-join errors, respectively. Of the simulated 43, 78, and 167 error-free contigs for Arabidopsis, rice, and human, EndHiC predicted 43, 78, and 160 contigs to have no assembly errors, respectively. Overall, the sensitivity and specificity of EndHiC mis-join detection with Hi-C data are both higher than 0.9 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S7, S8). However, we should be alert that the simulated contig data cannot fully mimic the complexity of genome assembly from real sequencing data. Thus, the accuracy of contig error detection for real data may be different from that of these simulated data.</p>
    </sec>
    <sec id="Sec13">
      <title>Applications of EndHiC in other genome projects</title>
      <p id="Par31">Till now, EndHiC has also been applied to resolve the scaffolding assemblies of several other genomes, including 3 economic plants chicory (<italic>Cichorium intybus</italic>, n = 9), endive (<italic>Cichorium endivia</italic>, n = 9), yacon (<italic>Smallanthus sonchifolius</italic>, n = 29) [<xref ref-type="bibr" rid="CR4">4</xref>], and an invasive weed <italic>Ipomoea cairica</italic> (n = 15) [<xref ref-type="bibr" rid="CR5">5</xref>], whose genome sizes are 1.3 Gb, 0.85 Gb, 2.6 Gb, and 0.73 Gb. Applying the contig error correction module of EndHiC, 3, 0, 0, and 1 contigs were identified with assembly errors for chicory, endive, yacon and <italic>Ipomoea cairica</italic>, respectively. These contigs were broken at the assembly error sites before the major Hi-C scaffolding workflow. The contig N50 sizes are 15 Mb, 9 Mb, 87 Mb and 44 Mb, and the contig N90 sizes are 4 Mb, 0.8 Mb, 43 Mb and 23 Mb, for chicory, endive, yacon, and <italic>I.cairica</italic> respectively. It is obvious that the contig continuity for yacon and <italic>I.cairica</italic> is much better that of chicory and endive. Not surprisingly, only one round of EndHiC was able to achieve chromosome-level scaffolds for yacon and <italic>I.cairica</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S8, S9), but two rounds of EndHiC can just generate near-chromosome-level scaffolds for chicory and endive, which were further linked to chromosomes by manual works based on the Hi-C heatmaps (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S10, S11). The final anchoring rate of contigs into chromosomes are 95.8%, 85.6%, 97.7% and 97.9% for chicory, endive, yacon, and <italic>I.cairica</italic> respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9), most of which are comparable or higher than those of previously published genomes, suggesting that EndHiC can be applied to a broad range of common diploid genomes.</p>
      <p id="Par32">Through in-depth analysis, we found that the chicory and endive genomes contain higher amount of long tandem repeats than yacon and <italic>I.cairica</italic> [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], which largely explains the differences in contig continuities. The existing of long tandem repeats in some contig ends, as well as the relatively larger gap sizes between neighbor contigs for chicory and endive, may be the major reasons why EndHiC works less well on chicory and endive. Otherwise, the excellent performance on yacon and <italic>I.cairica</italic> showed again that EndHiC is suitable for scaffolding of very large and even up to near-chromosome contigs. In these genome projects, the authors have also tried to use the other available Hi-C scaffolding tools and found that they all can’t generate chromosome-level scaffolds automatically without manual curation, suggesting that EndHiC is more suitable than previous Hi-C scaffolding tools on the applications of these large contigs with N50 size near or over 10 M and N90 size near or over 1 Mb.</p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation of EndHiC performance on contig assemblies with various length</title>
      <p id="Par33">TO further investigate the scope of application for EndHiC, we simulated human contigs with various length and analyzed the scaffolding results from EndHiC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10). These results clearly showed that when the contigs are very large with contig N50 size over 40 Mb, i.e., the average contig number per chromosome less than 5, just one round of EndHiC is able to achieve chromosome-level assembly. For moderate large contigs with contig N50 size between 20 and 40 Mb, i.e., the average contig number per chromosome between 5 and 10, two to three rounds of EndHiC can achieve chromosome-level assembly. For lower large contigs with contig N50 size between 10 and 20 Mb, i.e., the average contig number per chromosome between 10 and 30, three rounds of EndHiC can successfully scaffold most of the human chromosomes. However, for relatively shorter contigs, with contig N50 size less than 10 Mb, EndHiC can’t get chromosome-level or near-chromosome-level assembly automatically. In addition, the assembly error may increase as the contigs become shorter. Therefore, we suggest that EndHiC should only be applied to contig assemblies with an N50 size near or over 10 Mb and an N90 size near or over 1 Mb. For assemblies with relatively shorter contigs, other Hi-C scaffolding tools such as 3D-DNA, Pin_hic, and YaHS have been proved to be more suitable and can generate better assembly results [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec15">
      <title>Application of EndHiC to ONT-assembled contigs</title>
      <p id="Par34">To evaluate the performance of EndHiC on the ONT data, an ONT-assembled human (CHM13) genome by Shasta was used [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The total contig length of this ONT-assembly is 2.72 Gb, which is ~ 10% shorter than the human reference genome (3 Gb), indicating that about 300 Mb sequences have been missed from the contig assembly. After filtering the smaller contigs with size less than 1 Mb, we obtained a total contig size of 2.64 Gb, including 130 contigs with a N50 size of 48.8 Mb and a N90 size of 10.7 Mb, which was used for testing the performance of EndHiC. From the Hi-C heatmaps of contigs, we observed no obvious assembly errors in the contigs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12a), so the contig error correction module of EndHiC was not applied. Then, three rounds of EndHiC with default parameters were applied to acquire the 23 clusters, whose number is equal to the chromosome number of human (CHM13), and the three rounds of EndHiC resulted in a total of 44, 26, and 23 clusters, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12b, c). In the final 23 clusters, up to 98.6% of the used contig sequences have been anchored to the chromosomes.</p>
      <p id="Par35">Most of the contigs were in correct order and orientation except that in Chr1, Chr9 and Chr17 of human (CHM13), mainly caused by missing large fragment between the neighbor contigs (Chr1 miss 34.4 Mb, Chr9 miss 42.6 Mb, Chr17 miss 26.8 Mb) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12d). Compared to the EndHiC results of HiFi-assmebled human genome, one more round of EndHiC was performed here, and there are two more chromosomes with contig order and orientation problem in the ONT-assembled human genome, suggesting that EndHiC is applicable to the scaffolding of ONT-assembled contigs but more assembly errors may occur compared to the scaffolding of HiFi-assembled contigs. However, along with the continuous improvement of the ONT contig assembly, we believe that EndHiC will generate better scaffolding results with the ONT-assembled contigs in future.</p>
    </sec>
    <sec id="Sec16">
      <title>Performance comparison in memory and time</title>
      <p id="Par36">Although written in Perl, EndHiC has very high efficiency in the computer memory and CPU time due to innovative algorithm. Generally, only a few minutes and less than 1-G memory is needed by EndHiC for most genomes. The speed of EndHiC is ~ 10 times faster than LACHESIS, ALLHiC, Pin_hic and YaHS, and ~ 1000 times faster than 3D-DNA. In addition, the memory consumption of EndHiC is also the lowest among all the Hi-C scaffolding tools (Table <xref rid="Tab3" ref-type="table">3</xref>). We did not include the preprocessing steps (reads mapping and filtering) here for all the compared tools, so it is fair for the comparison of the core Hi-C scaffolding algorithm among each tool. Generally, the preprocessing steps consumed much more time (10–10,000 times) than the core Hi-C scaffolding algorithm, and HiC-pro takes slightly more time (1–6 times) than the other preprocessing methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S11). Moreover, EndHiC is easy to setup and use, with no dependent packages and fewer parameters needed to be determined by the users at most cases, and the human-readable text-format cluster file as well as the graphic GFA format output file bring great convenience to the users.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance comparison for EndHiC with other 5 Hi-C scaffolding tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Hi-C scaffolder</th><th align="left" colspan="3">Human</th><th align="left" colspan="3">Rice</th><th align="left" colspan="3">Arabidopsis</th></tr><tr><th align="left">Elapsed time (m)</th><th align="left">CPU time (m)</th><th align="left">Peak memory (Gb)</th><th align="left">Elapsed time (m)</th><th align="left">CPU time (m)</th><th align="left">Peak memory (Gb)</th><th align="left">Elapsed time (m)</th><th align="left">CPU time (m)</th><th align="left">Peak memory (Gb)</th></tr></thead><tbody><tr><td align="left">LACHESIS</td><td char="." align="char">5.6</td><td char="." align="char">5.6</td><td char="." align="char">2.7</td><td char="." align="char">9.9</td><td char="." align="char">9.9</td><td char="." align="char">0.4</td><td char="." align="char">1.5</td><td char="." align="char">1.5</td><td char="." align="char">0.30</td></tr><tr><td align="left">ALLHiC</td><td char="." align="char">22.3</td><td char="." align="char">43.2</td><td char="." align="char">38.2</td><td char="." align="char">17.1</td><td char="." align="char">40.7</td><td char="." align="char">16.8</td><td char="." align="char">3.2</td><td char="." align="char">7.0</td><td char="." align="char">2.80</td></tr><tr><td align="left">3D-DNA</td><td char="." align="char">1,314.0</td><td char="." align="char">2,100.0</td><td char="." align="char">51.6</td><td char="." align="char">354.0</td><td char="." align="char">816.0</td><td char="." align="char">51.6</td><td char="." align="char">102.0</td><td char="." align="char">534.0</td><td char="." align="char">28.70</td></tr><tr><td align="left">Pin_hic</td><td char="." align="char">171.7</td><td char="." align="char">150.3</td><td char="." align="char">5.6</td><td char="." align="char">24.6</td><td char="." align="char">22.9</td><td char="." align="char">0.6</td><td char="." align="char">15.8</td><td char="." align="char">14.2</td><td char="." align="char">0.60</td></tr><tr><td align="left">YaHS</td><td char="." align="char">29.7</td><td char="." align="char">29.4</td><td char="." align="char">7.0</td><td char="." align="char">5.0</td><td char="." align="char">3.7</td><td char="." align="char">0.4</td><td char="." align="char">1.6</td><td char="." align="char">1.6</td><td char="." align="char">0.14</td></tr><tr><td align="left">EndHiC</td><td char="." align="char">0.5</td><td char="." align="char">3.6</td><td char="." align="char">0.2</td><td char="." align="char">0.2</td><td char="." align="char">1.1</td><td char="." align="char">0.1</td><td char="." align="char">0.1</td><td char="." align="char">0.6</td><td char="." align="char">0.02</td></tr></tbody></table><table-wrap-foot><p>All the statistics here do not include the preprocessing steps (reads mapping and filtering), so it is fair to compare the major Hi-C scaffolding algorithms among the 6 tools. The simulated contig data of three model species shown in Table <xref rid="Tab2" ref-type="table">2</xref> were used to test EndHiC, LACHESIS, ALLHiC, 3D-DNA, Pin_hic and YaHS. For all these simulated datasets, just one round of EndHiC was applied. Note that LACHESIS only finished the cluster step and then exited, it did not perform order and orientation here. The reason might be that LACHESIS grouped all the simulated large contigs into a single cluster and produced invalid intermediate files for later steps. Based on previous experience, the speed and memory consumption of LACHESIS is comparable to that of ALLHiC</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Discussion</title>
    <p id="Par37">EndHiC implements a simple but effective Hi-C scaffolding algorithm specially for large contigs, leveraging on the HiC-Pro professional works for valid pair detection, calculation and normalization of bin matrix [<xref ref-type="bibr" rid="CR17">17</xref>]. Unlike LACHESIS [<xref ref-type="bibr" rid="CR9">9</xref>] and ALLHiC [<xref ref-type="bibr" rid="CR10">10</xref>], the core algorithm of EndHiC is more similar to 3D-DNA [<xref ref-type="bibr" rid="CR11">11</xref>], Pin_hic [<xref ref-type="bibr" rid="CR15">15</xref>] and YaHS [<xref ref-type="bibr" rid="CR16">16</xref>], which all break the contigs into parts and perform clustering, ordering, and orientation simultaneously. Besides, none of them needs the chromosome number as input. By using only the Hi-C links from the most effective region of the contig ends, EndHiC has a greater SNR compared to other available Hi-C scaffolding tools, contributing mostly to the higher scaffolding accuracy. The scaffolding results from using various contig end sizes and various contact cutoffs with both raw and normalized links data, have also been compared and merged to get a more accurate consensus assembly as well as a robustness evaluation. For genomes with a high proportion of heterochromatin, long repetitive sequences often exist in the contig ends, or genomes with relatively fragmental contig assemblies, one round of EndHiC may fail to assemble all the large contigs into chromosome-level scaffolds. Under these circumstances, we suggest iteratively running multiple rounds of EndHiC, each round with increasing contig end sizes, until the resulting cluster number is equal or close to the known chromosome number. Similarly, 3D-DNA, Pin_hic and YaHS also have the multiple iteration mode.</p>
    <p id="Par38">Unlike the previously developed Hi-C scaffolding tools that are mostly suitable for scaffolding relatively shorter contigs with contig N50 size near or less than 1 Mb, EndHiC is specially designed and has great advantage for scaffolding of much larger contigs. For a certain part of the diploid plant and animal genomes, the contig assemblies derived from the current HiFi sequencing technologies generally reach an N50 size over 10 Mb and an N90 size over 1 Mb. As EndHiC only process contigs with size larger than two times of the contig end size (2 * 500 Kb = 1 Mb), in this case, the majority of the contig sequences (&gt; 90%) are analyzed by EndHiC. Thus, the N90 size requirement is more important than N50 size requirement. To ensure the success of EndHiC, the contig N90 size should be approaching or larger than 1 Mb. The excluded smaller contigs with size lower than 1 Mb are likely rich in repeat sequences and have low Hi-C link density, therefore, by removing the interference of small repetitive contigs that may cause mis-assemblies, it also assures the assembly accuracy of those larger contigs, which forms a correct chromosome framework. Then, the EndHiC package provides a mapping program to assign these small contigs into each of the chromosome frameworks based on the overall maximum Hi-C links. Compared to large contigs, the order and orientation for these small repeat-rich contigs is more difficult to determine, and our contig end rule no longer works. In future, we will try to improve this by further investigations of the small contig data and developing more powerful algorithms.</p>
    <p id="Par39">The chromosome-scale genome assemblies, especially telomere-to-telomere assembly, has been the primary goal for most genome projects. Thanks to the HiFi long-accurate read sequencing technology and the Hifiasm assembling algorithm, we got a surprisingly good contig assembly in the great burdock genome project, with a contig N50 size of 75 Mb and a contig N90 size of 39 Mb. Notably, the total length of contigs with size larger than 1 Mb occupy over 99% of the whole contig assemblies. However, depression follows excitement. With such large contigs, we are still unable to assemble them into correct chromosome-level scaffolds with all available Hi-C scaffolding tools. Then, we found that all these software have used the entire region or a large part of the contig region to calculate Hi-C links among contigs, and suspected that this may be the problem why they failed on scaffolding of these large contigs. To validate our suspicion, we developed the EndHiC algorithm and successfully resolved the chromosome-level assembly of the great burdock. After that, we applied EndHiC to a set of genomes sequenced by our group and our partners, including chicory, endive, yacon, <italic>Ipomoea cairica</italic>, etc., and all achieved chromosome-level or near-chromosome-level scaffold assemblies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. During these practices, the default parameters of EndHiC were obtained and optimized, which may be applied to a broad range of genomes.</p>
    <p id="Par40">Although someone may think that scaffolding of such large or even near-chromosome contigs is a trivial work, which can be done directly by manual curation with the Hi-C heatmaps in a graphical tool such as Juicebox [<xref ref-type="bibr" rid="CR19">19</xref>], we insisted that automatic inferring of the chromosome-level scaffolds like EndHiC is important. As the sequenced genomes become more and more, automatic inferring will save a lot of labor and time. In addition, automatic inferring will also be more reliable than the human eyes. It is worth emphasizing that EndHiC is not going to replace previous Hi-C scaffolding tools, but can be complemented with them. EndHiC is only suitable for contig assemblies with N50 size near or larger than 10 Mb and N90 size near or larger than 1 Mb. With EndHiC, only contigs with size larger than 1 Mb will be assembled into the chromosome framework. Then, you can use EndHiC’s build-in program to assign the leaving small contigs back to each chromosome by the maximum Hi-C links rule, but for the ordering and orientating of the leaving small contigs, currently we suggest apply the global optimization algorithm implemented in HiC-Hiker [<xref ref-type="bibr" rid="CR12">12</xref>] or the genetic algorithm implemented in AllHiC [<xref ref-type="bibr" rid="CR10">10</xref>], to obtain the acceptable order and orientation for these small contigs. In contrast, when the contig N50 size is relatively small (&lt; 10 Mb), previous developed tools 3D-DNA, Pin_hic, YaHS, etc. can be adopted firstly. If they failed to generate chromosome-level assemblies, then the resulting large scaffolds can be fed to EndHiC to try to get the chromosome-level scaffolds.</p>
  </sec>
  <sec id="Sec18">
    <title>Conclusion</title>
    <p id="Par41">We developed an independent scaffolding tool EndHiC, which is suitable for scaffolding of long-continuous contig assemblies with a contig N50 size near or over 10 Mb and a contig N90 size near or over 1 Mb. The core idea behind EndHiC, which distinguishes it from other Hi-C scaffolding tools, is using Hi-C links only from the most effective regions of contig ends. By this way, the signal and noise contact values from the corresponding neighbor and non-neighbor contigs are separated more clearly, which makes it easier for the scaffolding graph cleaning and improves the scaffolding accuracy. For performance, EndHiC runs extremely fast with trivial memory consumption, and is easy to use. In summary, the reliable cutoff of contact values, the reciprocal best requirement, the GFA graphic viewing in Bandage, the robustness evaluation, and the compatibility with Juicebox for manual curation, ensure the high scaffolding accuracy of EndHiC. As more genome projects have been launched and the contig continuity constantly improved, we believe that EndHiC has the potential to make a great contribution to the genomics field and liberate the scientists from labor-intensive manual curation works.</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p id="Par42">Project name: EndHiC.</p>
    <p id="Par43">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/fanagislab/EndHiC">https://github.com/fanagislab/EndHiC</ext-link>.</p>
    <p id="Par44">Operating system(s): Linux, MacOS.</p>
    <p id="Par45">Programming language: Perl, Python</p>
    <p id="Par46">Other requirements: HiC-pro.</p>
    <p id="Par47">License: GNU GPL.</p>
    <p id="Par48">Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_5087_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary figures and tables.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HiFi</term>
        <def>
          <p id="Par4">High-fidelity</p>
        </def>
      </def-item>
      <def-item>
        <term>ONY</term>
        <def>
          <p id="Par5">Oxford nanopore technology</p>
        </def>
      </def-item>
      <def-item>
        <term>GFA</term>
        <def>
          <p id="Par6">Graphical fragment assembly</p>
        </def>
      </def-item>
      <def-item>
        <term>SNR</term>
        <def>
          <p id="Par7">Signal to noise ratio</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Sen Wang, Hengchao Wang and Fan Jiang are joint first authors.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Xingtan Zhang, Weihua Pan, and Jue Ruan for helpful discussions and constructive suggestions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>SW and WF developed the source codes of EndHiC, HW and FJ performed the testing works, WF and YZ conceived the study and drafted the manuscript. We did not require any copyright permissions to reproduce any figures or tables in this manuscript from any copyright holders. All authors have read and approved the final version of the manuscript. </p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by National Natural Science Foundation of China (Grant No. 32000408); Shenzhen science and technology program (JCYJ20190814163805604); Shenzhen Science and Technology Program (Grant No. KQTD20180411143628272); Fund of Key Laboratory of Shenzhen (ZDSYS20141118170111640); The Agricultural Science and Technology Innovation Program. All these funding bodies did not participate in the design, collection, analysis, data interpretation, and manuscript writing of this project.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>For simulated data, the reference genomes of human CHM13 v1.1 (<ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/CHM13">https://github.com/marbl/CHM13</ext-link>), rice (Nipponbare) ASM386523v1 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCA_003865235.1/">https://www.ncbi.nlm.nih.gov/assembly/GCA_003865235.1/</ext-link>), Arabidopsis thaliana (Columbia) TAIR10.1 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001735.4/">https://www.ncbi.nlm.nih.gov/assembly/GCF_000001735.4/</ext-link>) were used to simulate large contigs. For real data, the hifiasm-assembled contigs of human (CHM13) were downloaded from <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4393631/files/CHM13.HiFi.hifiasm-0.12.fa.gz">https://zenodo.org/record/4393631/files/CHM13.HiFi.hifiasm-0.12.fa.gz</ext-link>, while the contigs of great burdock and water spinach were assembled by hifiasm using default parameters from HiFi reads downloaded from NCBI-SRA databases (PRJNA764011 and PRJNA764042). The ONT-assembled contigs of human (CHM13) were downloaded from <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4393631/files/CHM13.ONT.Shasta-0.1.0_Helen.fa.gz">https://zenodo.org/record/4393631/files/CHM13.ONT.Shasta-0.1.0_Helen.fa.gz</ext-link>. The testing data of EndHiC is also available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/fanagislab/EndHiC/tree/master/z.testing_data">https://github.com/fanagislab/EndHiC/tree/master/z.testing_data</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par50">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par51">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marx</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Long road to long-read assembly</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>125</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01057-y</pub-id>
        <pub-id pub-id-type="pmid">33526887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>170</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01056-5</pub-id>
        <pub-id pub-id-type="pmid">33526886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vollger</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Logsdon</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Grothe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1291</fpage>
        <lpage>1305</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.263566.120</pub-id>
        <pub-id pub-id-type="pmid">32801147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>The genomes of chicory, endive, great burdock and yacon provide insights into Asteraceae palaeo-polyploidization history and plant inulin production</article-title>
        <source>Mol Ecol Resour</source>
        <year>2022</year>
        <volume>22</volume>
        <fpage>3124</fpage>
        <lpage>3140</lpage>
        <pub-id pub-id-type="doi">10.1111/1755-0998.13675</pub-id>
        <pub-id pub-id-type="pmid">35751596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A chromosome-level reference genome of a Convolvulaceae species <italic>Ipomoea cairica</italic></article-title>
        <source>G3 (Bethesda)</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>187</fpage>
        <pub-id pub-id-type="doi">10.1093/g3journal/jkac187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Wang S, Wang A, Wang H, Jiang F, Xu D, Fan W. Chromosome-level genome of a leaf vegetable <italic>Glebionis coronaria</italic> provides insights into the biosynthesis of monoterpenoids contributing to its special aroma. DNA Res. 2022.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0669-3</pub-id>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>MO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burton</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Adey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patwardhan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Chromosome-scale scaffolding of de novo genome assemblies based on chromatin interactions</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>1119</fpage>
        <lpage>1125</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2727</pub-id>
        <pub-id pub-id-type="pmid">24185095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Assembly of allele-aware, chromosomal-scale autopolyploid genomes based on Hi-C data</article-title>
        <source>Nat Plants</source>
        <year>2019</year>
        <volume>5</volume>
        <issue>8</issue>
        <fpage>833</fpage>
        <lpage>845</lpage>
        <pub-id pub-id-type="doi">10.1038/s41477-019-0487-8</pub-id>
        <pub-id pub-id-type="pmid">31383970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudchenko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Batra</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Nyquist</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hoeger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of the Aedes aegypti genome using Hi-C yields chromosome-length scaffolds</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <issue>6333</issue>
        <fpage>92</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aal3327</pub-id>
        <pub-id pub-id-type="pmid">28336562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nakabayashi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morishita</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>HiC-Hiker: a probabilistic model to determine contig orientation in chromosome-length scaffolds with Hi-C</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>13</issue>
        <fpage>3966</fpage>
        <lpage>3974</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa288</pub-id>
        <pub-id pub-id-type="pmid">32369554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Putnam</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>O'Connell</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Stites</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Calef</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Troll</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hartley</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale shotgun assembly using an in vitro method for long-range linkage</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>3</issue>
        <fpage>342</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.193474.115</pub-id>
        <pub-id pub-id-type="pmid">26848124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghurye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Integrating Hi-C links with assembly graphs for chromosome-scale assembly</article-title>
        <source>PLoS Comput Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>e1007273</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007273</pub-id>
        <pub-id pub-id-type="pmid">31433799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient iterative Hi-C scaffolder based on N-best neighbors</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>569</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04453-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Zhou C, McCarthy SA, Durbin R. YaHS: yet another Hi-C scaffolding tool. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Viara</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>259</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0831-x</pub-id>
        <pub-id pub-id-type="pmid">26619908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wick</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Zobel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Bandage: interactive visualization of de novo genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>20</issue>
        <fpage>3350</fpage>
        <lpage>3352</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv383</pub-id>
        <pub-id pub-id-type="pmid">26099265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.07.012</pub-id>
        <pub-id pub-id-type="pmid">27467250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lorig-Roach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haukness</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Bosworth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tigyi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Maurer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>9</issue>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
