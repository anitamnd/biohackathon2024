<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub August-6-2010?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3001052</article-id>
    <article-id pub-id-type="pmid">20693400</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkq661</article-id>
    <article-id pub-id-type="publisher-id">gkq661</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SEWAL: an open-source platform for next-generation sequence analysis and visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pitt</surname>
          <given-names>Jason N.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rajapakse</surname>
          <given-names>Indika</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ferré-D’Amaré</surname>
          <given-names>Adrian R.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Howard Hughes Medical Institute, <sup>2</sup>Division of Basic Sciences, Fred Hutchinson Cancer Research Center, 1100 Fairview Avenue North, Seattle WA 98109-1024 and <sup>3</sup>Biostatistics and Biomathematics, Public Health Sciences, Fred Hutchinson Cancer Research Center, 1100 Fairview Avenue North, Seattle WA 98109-1024, USA</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+1 206 667 3603</phone>; Fax: <fax>+1 206 667 3331</fax>; Email: <email>jpitt@fhcrc.org</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>12</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>38</volume>
    <issue>22</issue>
    <fpage>7908</fpage>
    <lpage>7915</lpage>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>7</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>7</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Next-generation DNA sequencing platforms provide exciting new possibilities for <italic>in vitro</italic> genetic analysis of functional nucleic acids. However, the size of the resulting data sets presents computational and analytical challenges. We present an open-source software package that employs a locality-sensitive hashing algorithm to enumerate all unique sequences in an entire Illumina sequencing run (∼10<sup>8</sup> sequences). The algorithm results in quasilinear time processing of entire Illumina lanes (∼10<sup>7</sup> sequences) on a desktop computer in minutes. To facilitate visual analysis of sequencing data, the software produces three-dimensional scatter plots similar in concept to Sewall Wright and John Maynard Smith’s adaptive or fitness landscape. The software also contains functions that are particularly useful for doped selections such as mutation frequency analysis, information content calculation, multivariate statistical functions (including principal component analysis), sequence distance metrics, sequence searches and sequence comparisons across multiple Illumina data sets. Source code, executable files and links to sample data sets are available at <ext-link ext-link-type="uri" xlink:href="http://www.sourceforge.net/projects/sewal">http://www.sourceforge.net/projects/sewal</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Recent advances in DNA sequencing technology afford new opportunities and new challenges in nucleic acid sequence analysis (<xref ref-type="bibr" rid="B1">1</xref>). The ability routinely to generate gigabases of data in laboratories outside of sequencing centers has necessitated the advent of computationally and monetarily inexpensive software. We present here an open-source software package entitled SEWAL <bold>(S</bold>equence <bold>E</bold>volution <bold>W</bold>ith <bold>A</bold>daptive <bold>L</bold>andscapes) designed to analyze Illumina deep-sequencing data and display it in the form of interactive three-dimensional (3D) scatter plots. To generate these plots, SEWAL also features a variety of sequence manipulation and analysis options designed to run with high speed on desktop computers. SEWAL is currently compiled for the 64-bit Apple Macintosh operating system; however the code is open-source (<ext-link ext-link-type="uri" xlink:href="http://www.sourceforge.net/projects/sewal">http://www.sourceforge.net/projects/sewal</ext-link>), written in gnu C++, and should be easily compiled on any 64-bit operating system that supports OpenGL.</p>
    <p>SEWAL (<xref ref-type="fig" rid="F1">Figure 1</xref>) analyzes deep-sequencing data sets generated from <italic>in vitro</italic> selection pools of functional nucleic acids and performs nearest-neighbor analysis of all sequences in a sequencing run using a locality sensitive hashing (LSH) algorithm (<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>). SEWAL then tabulates the frequency of every observed sequence and displays the data from the entire sequencing run in the form of a 3D scatter plot hereafter referred to as mutant spectrum (<xref ref-type="bibr" rid="B4">4</xref>). The goal in this type of analysis is to leverage massive sequencing as a tool to perform functional genetics of nucleic acids <italic>in vitro</italic>. This idea is based on the assumption that the frequency of a sequence in an <italic>in vitro</italic> selection experiment is proportional to the fitness of that sequence. Using SEWAL and high-throughput biochemical analysis, we have recently shown this assumption to be true for one class of catalytic RNA molecules (J. N. Pitt and A. R. Ferré-D’Amaré, submitted for publication). Therefore, data from SEWAL can be used to construct empirical fitness landscapes. A fitness landscape as originally conceived by Wright is analogous to a topographic map, depicting differing allele combinations in the horizontal axes with the height of any given allele combination representing Darwinian fitness of that allele combination in the vertical axis (<xref ref-type="bibr" rid="B5">5</xref>). The concept was extended to macromolecules by Maynard Smith (<xref ref-type="bibr" rid="B6">6</xref>). In this case, a given macromolecule sequence (allele), is characterized by specific combination of nucleotide or amino acid substitutions (i.e. a haplotype) relative to a reference sequence. These fitness landscapes have attracted considerable theoretical interest, but constructing them experimentally involves phenotypic analysis of all of alleles in the mutant spectrum, which can be technically challenging (<xref ref-type="bibr" rid="B7">7</xref>). In molecular evolution, the fitness landscape is a hyper-dimensional object with its dimensionality being a function of the length of the polymer in question (<xref ref-type="bibr" rid="B8">8</xref>). If one were able to generate a fitness landscapes for a sequence of interest under a variety of environmental conditions, these could be used to infer accessible evolutionary paths and even predict the course of evolution for that sequence. To this end, SEWAL can compare the frequency of all unique sequences across multiple next-generation sequencing runs. While our application (J. N. Pitt and A. R. Ferré-D’Amaré, submitted for publication) has been limited to analyzing <italic>in vitro</italic> selection pools of a catalytic RNA (<xref ref-type="bibr" rid="B9">9</xref>), SEWAL should prove useful for any assay where the copy number of unique nucleic acids in a complex data set may be informative, for instance, viral quasispecies evolution in response to immune selection or drug therapy, or differential mRNA expression (<xref ref-type="bibr" rid="B10">10</xref>).
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>SEWAL pipeline for sequence analysis. SEWAL currently reads qseq.txt files generated by the Illumina pipeline. SEWAL commands are shown in italics. File types are shown by white boxes. All files are tab-delimited text files with defined formatting. Inset graphic is a screenshot of the SEWAL interactive graphics window.</p></caption><graphic xlink:href="gkq661f1"/></fig></p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <p>The primary computational task with our analysis is the <italic>de novo</italic> comparison of every sequence in a data set to every other sequence in the data set in order to determine a frequency for each observed sequence. To determine the copy number of individual sequences in the data set, sequences first pass quality filtering and are then compared to each other to determine the frequency of each unique sequence. A brute-force comparison of all members in the set would result in a worst-case complexity of <italic>O</italic>(<italic>ν n</italic><sup>2</sup>), where <italic>ν</italic> is the length of the sequence and <italic>n</italic> is the total number of sequences in the data set. In practice, these searches become time limiting on single-processor systems for data sets exceeding 2 × 10<sup>5</sup> sequences (<italic>ν</italic> = 58). LSH is a technique that uses LSH functions to preprocess the set using <italic>k</italic> number of hash functions (<italic>h<sub>i</sub></italic>) and hash tables (<xref ref-type="bibr" rid="B3">3</xref>). (A hash function is a deterministic function that reduces a high dimensional data set, such as a long polynucleotide sequence, to a single data point, such as an integer.) The hashing step can be performed with random strings or with a search string of interest (<italic>q</italic>), with the latter hash value being a distance metric to <italic>q</italic> (defined in the sewal.prefs file or subsequently using the <italic>newdim</italic> command). Hashing is performed (<italic>k</italic> = 4) and the set sequentially sorted using a stable sort for all stored hash values <italic>O</italic>[<italic>knν + kn log</italic>(<italic>kn</italic>)] (<xref ref-type="bibr" rid="B11">11</xref>). The probability of collision of non-equal sequences during hashing is a function of <italic>ν</italic> and <italic>k</italic> (<xref ref-type="fig" rid="F2">Figure 2</xref>). Following hashing, the set is then traversed and copy number determined using pairwise comparison [limited to <italic>h<sub>i</sub></italic> (<italic>q</italic>) = <italic>h<sub>i</sub></italic> (<italic>n</italic>)] to prevent equating of non-equal sequences that collided during hashing. We determined empirically that for our typical Illumina data sets with (<italic>n</italic> ∼ 10<sup>7</sup>, <italic>ν</italic> = 58) a pairwise comparison after sorting with <italic>k</italic> = 4 was faster than allowing the LSH to converge without pairwise comparison (<italic>k</italic> ∼ 20). The <italic>Q</italic><sub>phred</sub> scores (<xref ref-type="bibr" rid="B12">12</xref>) of identical sequences are summed and stored. After the list is traversed it is pruned, and mean <italic>Q</italic><sub>phred</sub> scores for each sequence are calculated as: <inline-formula><inline-graphic xlink:href="gkq661i1.jpg"/></inline-formula>
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Expected mutant frequencies and empirically determined algorithm performance. SEWAL is designed to analyze pools of nucleic acids to determine the frequency of specific mutant sequences in the pool. The worst-case comparison of all observed mutants to all other observed mutants would have a complexity of <italic>O</italic>(<italic>ν n</italic><sup>2</sup>) where <italic>O</italic> is the upper bound of the growth of the function, <italic>n</italic> is the total number of sequences, and <italic>ν</italic> is the length of each sequence. The blue line is the probability of encountering any mutant in a pool composed of random RNAs as a function of <italic>ν</italic>. The red line is the probability of encountering a reference sequence with a pool mutagenized at a rate of 21% (7% each possible point mutation). The dashed red lines correspond to the probability of encountering a reference sequence with <italic>m</italic> number of specific point mutations. Black lines show the performance of the SEWAL sorting algorithm on test data sets (<italic>n</italic> = 10<sup>7</sup>) using <italic>k</italic> number of LSH functions expressed as the probability of a collision between any two nonidentical sequences with equal hash values. Solid black lines represent random test data sets; dashed lines, <italic>in silico</italic> generated data sets mutagenized at 21% per position.</p></caption><graphic xlink:href="gkq661f2"/></fig></p>
  </sec>
  <sec>
    <title>RESULTS AND DISCUSSION</title>
    <p>We chose to focus on the Illumina platform because its short read length and higher read density were advantageous in analyzing populations of small RNAs (<xref ref-type="bibr" rid="B13">13</xref>). The current release of SEWAL is designed to accept qseq.txt files from the Illumina Genome Analyzer v1.4 (Illumina, San Diego, CA, USA). These files are merged, filtered for quality, hashed, sorted, tabulated, merged with similar data sets generated under differing conditions and then formatted as a SEWAL aggregate frequency file, which can be analyzed using several sequence and graphic analysis features built into SEWAL. Experimentally generated test data sets are available for download at the NCBI Trace Archives (accession number SRA020870.1). An overview of the SEWAL computational pipeline is shown in <xref ref-type="fig" rid="F1">Figure 1</xref> and a detailed explanation is presented below. All SEWAL text commands are hereafter presented in italics.</p>
    <sec>
      <title>Process</title>
      <p>Illumina pipeline qseq files are first merged into a single data set using the SEWAL commands <italic>mergetiles</italic> and <italic>truncate</italic> to generate a fixed number of clusters that pass quality filtering for cross-sample or cross-lane comparison. This step is critical when inferring changes in the frequency of a particular sequence in multiple sequencing runs or flow-cell lanes. Similar comparisons can be achieved using the <italic>scale</italic> command to scale two data sets relative to each other based on the sequencing of a loading control sequence following construction of a SEWAL frequency file (<italic>readruler</italic> command). Quality filtering is user-controllable using a configuration file (sewal.prefs; see file header for details). Default quality-control settings ignore Illumina quality flags, but remove clusters containing one or more of the following errors: base calls flagged as gaps, clusters with homo-polymer runs longer than six residues, and more than six positions with <italic>Q</italic><sub>phred</sub> scores of 3 or higher. A <italic>Q</italic><sub>phred</sub> score (<xref ref-type="bibr" rid="B12">12</xref>) is the probability that a base call is incorrect. The Illumina pipeline encodes <italic>Q</italic><sub>phred</sub> scores as an ASCII string (ASCII value −64 = <italic>Q</italic><sub>phred</sub>; one char per base) as: <italic>Q</italic><sub>phred</sub> = –10 log (<italic>ep</italic>), where (<italic>ep</italic>) is the error probability for that position. A <italic>Q</italic><sub>phred</sub> score equal to 3 is a 50% chance that the base is incorrectly assigned.</p>
    </sec>
    <sec>
      <title>Locality sensitive hashing</title>
      <p>We have solved the problem of comparison of every sequence in the data set to every other sequence using the approach of LSH to reduce the dimensionality of the data from <italic>ν</italic> sequence positions to 4 LSH values. Using four successive table sorts of the LSH values, the frequency of each sequence is then determined in quasilinear time (<xref ref-type="table" rid="T1">Table 1</xref>). This approach has the added advantage that the data set has been preprocessed, accelerating subsequent nearest-neighbor searches (<italic>finds</italic>). We set the number LSH functions (<italic>k</italic>) to 4 because of the nature of our data; namely, mutant pools with high similarity (<italic>n</italic> ∼ 10<sup>7</sup>, <italic>ν</italic> = 58). The primary trade-off between small and large values of <italic>k</italic> is between preprocessing/sorting time and pair-wise comparison time. In practice, all sorts with <italic>k</italic> &gt; 1 resulted in efficient tabulation of data of the scale currently generated by the Illumina platform (<xref ref-type="table" rid="T1">Table 1</xref>). A <italic>k</italic> of 4 translated into brute-force searches for ∼0.001% of our data set or 10 000 sequences (<xref ref-type="fig" rid="F2">Figure 2</xref>). For larger data sets (&gt;&gt;<italic>n</italic>) a greater number of LSH values could be computed, increasing the preprocessing time and space linearly, and incorporating additional sorts, but decreasing the collision probability and requisite pair-wise comparisons. A useful feature of the LSH algorithm used in this context is that as the length of a random polymer (<italic>ν</italic>) increases, the performance of the algorithm also increases (<xref ref-type="table" rid="T1">Table 1</xref> and refs 2 and 3). This behavior results from the LSH function and is dependent on both <italic>k</italic> and <italic>ν</italic>. Therefore, as Illumina read lengths improve, this sorting procedure will remain highly efficient.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Performance of the SEWAL LSH sorting algorithm as a function of <italic>k</italic> (number of hash functions) and <italic>ν</italic> (length of each sequence) for <italic>in silico</italic> generated populations (<italic>n</italic> = 10<sup>7</sup>)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"><italic>k</italic></th><th rowspan="1" colspan="1"><italic>ν</italic></th><th rowspan="1" colspan="1">Processing time (s)</th><th rowspan="1" colspan="1">Library type</th><th rowspan="1" colspan="1">Collision probability</th><th rowspan="1" colspan="1">Total collisions</th><th rowspan="1" colspan="1">Total comparisons</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.8837</td><td rowspan="1" colspan="1">8 838 480</td><td rowspan="1" colspan="1">10 001 677</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.3819</td><td rowspan="1" colspan="1">3 819 630</td><td rowspan="1" colspan="1">10 000 378</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">75</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.3768</td><td rowspan="1" colspan="1">3 779 490</td><td rowspan="1" colspan="1">10 029 480</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">106</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.0029</td><td rowspan="1" colspan="1">29 165</td><td rowspan="1" colspan="1">10 029 165</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.446</td><td rowspan="1" colspan="1">4 460 760</td><td rowspan="1" colspan="1">10 001 360</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">48</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.1805</td><td rowspan="1" colspan="1">1 805 160</td><td rowspan="1" colspan="1">10 000 409</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">63</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.1845</td><td rowspan="1" colspan="1">1 853 660</td><td rowspan="1" colspan="1">10 048 838</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">83</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.0004</td><td rowspan="1" colspan="1">4474</td><td rowspan="1" colspan="1">10 004 474</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">21</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9986</td><td rowspan="1" colspan="1">15 475 100</td><td rowspan="1" colspan="1">15 496 479</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">46</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9512</td><td rowspan="1" colspan="1">11 955 500</td><td rowspan="1" colspan="1">12 568 309</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">75</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.6172</td><td rowspan="1" colspan="1">6 715 260</td><td rowspan="1" colspan="1">1 088 0872</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">103</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.3455</td><td rowspan="1" colspan="1">3 600 590</td><td rowspan="1" colspan="1">10 422 430</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.8302</td><td rowspan="1" colspan="1">8 892 800</td><td rowspan="1" colspan="1">10 711 457</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">53</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.5035</td><td rowspan="1" colspan="1">5 183 970</td><td rowspan="1" colspan="1">10 295 630</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">76</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.3278</td><td rowspan="1" colspan="1">3 304 510</td><td rowspan="1" colspan="1">10 082 137</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">103</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.1769</td><td rowspan="1" colspan="1">1 775 630</td><td rowspan="1" colspan="1">10 040 221</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">78523</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9999</td><td rowspan="1" colspan="1">1.61 607 × 10<sup>11</sup></td><td rowspan="1" colspan="1">1.61 617 × 10<sup>11</sup></td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">93</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9813</td><td rowspan="1" colspan="1">525 142 000</td><td rowspan="1" colspan="1">535 141 971</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">104</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.2522</td><td rowspan="1" colspan="1">3 373 350</td><td rowspan="1" colspan="1">13 373 353</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">140</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.0036</td><td rowspan="1" colspan="1">35 779</td><td rowspan="1" colspan="1">10 035 779</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">72806</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.9999</td><td rowspan="1" colspan="1">1.77 183 × 10<sup>11</sup></td><td rowspan="1" colspan="1">177 193 × 10<sup>11</sup></td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">118</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.9878</td><td rowspan="1" colspan="1">811 783 000</td><td rowspan="1" colspan="1">821 773 604</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">106</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.4301</td><td rowspan="1" colspan="1">7 545 680</td><td rowspan="1" colspan="1">17 544 589</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">140</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.0062</td><td rowspan="1" colspan="1">62 612</td><td rowspan="1" colspan="1">10 062 405</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">58</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9987</td><td rowspan="1" colspan="1">78 376 300</td><td rowspan="1" colspan="1">78 481 204</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">63</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.9359</td><td rowspan="1" colspan="1">33 599 300</td><td rowspan="1" colspan="1">35 900 313</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">108</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.1513</td><td rowspan="1" colspan="1">1 690 980</td><td rowspan="1" colspan="1">11 174 301</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">129</td><td rowspan="1" colspan="1">Random</td><td rowspan="1" colspan="1">0.0029</td><td rowspan="1" colspan="1">29 433</td><td rowspan="1" colspan="1">10 027 028</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">91994</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.9999</td><td rowspan="1" colspan="1">1.44 037 × 10<sup>11</sup></td><td rowspan="1" colspan="1">1.44 047 × 10<sup>11</sup></td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">81</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.9793</td><td rowspan="1" colspan="1">473 721 000</td><td rowspan="1" colspan="1">483 721 331</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">88</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.2376</td><td rowspan="1" colspan="1">3 116 040</td><td rowspan="1" colspan="1">13 116 042</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">122</td><td rowspan="1" colspan="1">Doped</td><td rowspan="1" colspan="1">0.0032</td><td rowspan="1" colspan="1">32 331</td><td rowspan="1" colspan="1">10 032 331</td></tr></tbody></table><table-wrap-foot><fn><p>Library type is random (a 25% probability of each nucleotide at each position) or doped (a 79% probability of a wild-type residue at each position and a 7% probability of each possible mutant residue.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>Processall</title>
      <p>Following LSH, SEWAL generates a frequency file, sorted by copy number, which is equivalent to the tab-delimited qseq file with the <italic>Q</italic><sub>phred</sub> string replaced by the mean <italic>Q</italic><sub>phred</sub> string, and a unique ID tag, sequence copy number and hash values appended. The <italic>processall</italic> command compares the frequency of all sequences between two or more frequency files (maximum number of experiments/Illumina lanes is currently 7). SEWAL generates an aggregate frequency file by concatenating the individual frequency files and then sorting the sequences based on the stored LSH values. This sorting of data sets from multiple Illumina lanes is memory-intensive, and in the current implementation requires a 64-bit OS with &gt;20 GB physical memory. After sorting, the duplicates in the list are collapsed as above, and a SEWAL aggregate frequency file created. This file contains each sequence with a unique ID number, a mean <italic>Q</italic><sub>phred</sub> score string, the copy number of the observed sequence in each lane, the four LSH scores, the observed copy numbers from each lane, and the lane number containing the maximal copy number.</p>
    </sec>
    <sec>
      <title>Data analysis</title>
      <sec>
        <title>Histogram, hamminghistogram</title>
        <p>These commands generate histograms of a user-defined bin size and bin number. The output is a tab-delimited text file containing the limits for each bin and the number of sequences in each bin. Both the number of unique sequences and the total number of observations of all members in the bin are given in the table. The difference between the <italic>hamminghistogram</italic> and <italic>histogram</italic> commands is the distance metric used to determine the bin placement for each sequence. Bins for the <italic>histogram</italic> command are measured using one of the four LSH values (user-defined), while <italic>hamminghistogram</italic> takes an input string for distance comparison and the outputted histogram bins are based on the Hamming distance from the query string (<xref ref-type="bibr" rid="B14">14</xref>).</p>
      </sec>
      <sec>
        <title>Finda, findg, finds</title>
        <p>These three search commands, <italic>finda, findg</italic> and <italic>finds</italic>, find sequences in the aggregate frequency file based on specific search queries. The <italic>finda</italic> (find all) and <italic>finds</italic> (find sequence) commands return a new aggregate frequency file containing sequences that existed in a specified region of the mutant spectrum or are similar to a specified search sequence, respectively. The <italic>findg</italic> (find and graph) command is similar to the <italic>finda</italic> command but returns either a .graph, .vector or .fit file. The .graph files are used to generate 3D scatter plots using the <italic>graph</italic> command. In these plots, each sequence is represented by a single dot with the axes being the copy number of the sequence and the other two axes being user-selected LSH values (<xref ref-type="fig" rid="F3">Figure 3</xref>). The .vect files have these same axes but contain vectors showing the changes in frequency of each sequence in each analyzed lane (<xref ref-type="fig" rid="F4">Figure 4</xref>b), while the .fit files depict the magnitude of the vector between any two Illumina lanes as a scatter plot.
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Orthogonal views of 3D mutant spectra generated by SEWAL. Each colored ball represents a unique sequence in the pool. Vertical axis is the log<sub>10</sub> of the observed frequency of the sequence. Horizontal axes are the SEWAL LSH values using a wild-type sequence (Projection 1) or a sequence with no similarity to the data set (a segment of the <italic>Ornithorhynchus anatinus</italic> lysozyme gene; Projection 2). Sequences have been colored using the <italic>colorbase</italic> command based on the identity of the base at position 21 in the sequence (G, green, A, red, T,U, blue, C, orange). Curved arrow depicts the relative orientation of the views.</p></caption><graphic xlink:href="gkq661f3"/></fig>
<fig id="F4" position="float"><label>Figure 4.</label><caption><p>3D Vector and fitness plots of genotype distributions in four separate sequencing experiments generated by SEWAL. (<bold>A</bold>) Each vertical line represents a unique sequence present in four separate sequencing experiments. Vectors are color coded to show the frequency of each sequence in each experimental condition. Sequences sorted using the SEWAL <italic>findg</italic> command to display only sequences that have a maximal distribution in condition 1 (red). (<bold>B)</bold> Sequences from the same data set plotted to display the magnitude of the difference between condition 1 (high stringency selection) and condition 4 (low stringency selection).</p></caption><graphic xlink:href="gkq661f4"/></fig></p>
      </sec>
      <sec>
        <title>Covary, buildmutant</title>
        <p>One of the main uses of SEWAL is to understand the mapping between the sequence of a nucleic acid and its fitness. To display this mapping, SEWAL can generate mutation frequency tables based on defined regions of sequence space using the <italic>buildmutant</italic> command. The <italic>buildmutant</italic> command outputs a tab-delimited text file that contains a table of observed point mutant frequencies from a user provided reference sequence. The table also contains positional information content, in bits (<xref ref-type="bibr" rid="B15">15</xref>). This information content calculation can be adjusted to account for sequence bias in the starting population (<xref ref-type="bibr" rid="B16">16</xref>). In a structured nucleic acid, many positions are not conserved at the primary sequence level but are required to maintain Watson–Crick base pairing (<xref ref-type="bibr" rid="B17">17</xref>). At these positions, a mutation can be said to ‘covary’ with a mutation at another position in the RNA to maintain base pairing. These data can be used to infer the secondary structure of the nucleic acid. SEWAL can analyze the data set to look for instances of covariation using the <italic>covary</italic> command. The <italic>covary</italic> command takes a reference sequence and a defined region of the mutant spectrum and uses the sequence data from the deep sequencing run to output a covariation matrix for all of the sequenced positions that are separated by a minimum of three residues.</p>
      </sec>
    </sec>
    <sec>
      <title>Singular value decomposition and principal component analysis</title>
      <p>A specified region of the genotype frequency plot may be expressed in terms of a matrix <italic>A</italic>, consisting of <italic>m</italic> rows of positional nucleotide frequencies or information content, over <italic>z</italic> columns of differing sequencing lanes (e.g. <italic>z</italic> differing selective pressures). Any <italic>m</italic> × <italic>z</italic> matrix <italic>A</italic> can be factored into <italic>A</italic> = <italic>UDV<sup>T</sup></italic> (<xref ref-type="bibr" rid="B18">18</xref>). The columns of <italic>U</italic>(<italic>m</italic> × <italic>m</italic>) are eigenvectors of <italic>AA<sup>T</sup></italic>, and the columns of <italic>V</italic> (<italic>z</italic> × <italic>z</italic>) are eigenvectors of <italic>A<sup>T</sup>A</italic>. The <italic>r</italic> singular values on the diagonal of <italic>D</italic>(<italic>m</italic> × <italic>z</italic>) are the square roots of the nonzero eigenvalues of both <italic>AA<sup>T</sup></italic> and <italic>A<sup>T</sup>A</italic>. The matrix <italic>A<sup>T</sup>A</italic> is known as the covariance matrix of <italic>A</italic>, and it has familiar interpretations in statistics and other fields (<xref ref-type="bibr" rid="B18">18</xref>). When a data matrix has been <italic>centered</italic>, by subtracting the mean of each column from the entire column, this process is known as ‘principal component analysis’ (PCA). The right singular vectors are the components, and the scaled left singular vectors are the <italic>scores</italic>. PCAs are described in terms of the eigenvalues and eigenvectors of the covariance matrix, <italic>A<sup>T</sup>A</italic> (<xref ref-type="bibr" rid="B19">19</xref>). The first singular vectors or principal components, when applied to positional nucleotide frequencies for a single defined peak in the mutant spectrum, provides eigenvectors corresponding to the reference sequence of the spectrum (J. N. Pitt and A. R. Ferré-D’Amaré, submitted for publication, <xref ref-type="bibr" rid="B20">20</xref>). The <italic>svd</italic> and <italic>pca</italic> commands return matrixes <italic>UDV<sup>T</sup></italic> for <italic>A</italic>(<italic>m</italic>, <italic>z</italic>) where <italic>m</italic> is specified by the user as either the information content of a position or the library bias adjusted base frequency at each position over <italic>z</italic> sequencing lanes. The commands <italic>svddmax</italic> or <italic>pcadmax</italic> perform identical calculations; however, sequences are presorted depending on their maximum observed distribution across lanes, and are binned in terms of their maximal distribution (<italic>z</italic>(<italic>i</italic>) = sequences with a maximal distribution in lane <italic>d</italic><sub>max</sub>(<italic>z</italic>):1, …, <italic>z</italic>).</p>
      <sec>
        <title>Covariance</title>
        <p>The <italic>covariance</italic> command can be used to generate <italic>AA<sup>T</sup></italic> or <italic>A<sup>T</sup>A</italic> for a specified region of the mutant spectrum. <italic>AA<sup>T</sup></italic> provides the correlation of each possible mutant residue in the sequence with every other possible mutant residue. For mutant spectra containing RNA secondary structures, this could be interpreted as Watson–Crick base-pairing covariance or any other structural feature dependent on more than one position. The magnitude of the covariance indicates critical (i.e. invariant) interactions, in that they are independent of the selective condition, or in terms of the matrix, highly correlated. Conversely, <italic>A<sup>T</sup>A</italic> provides the dependence or independence of a region of the mutant spectrum across sequencing lanes or selective conditions, indicating the correlation between selective regimes as indicated by the mutant spectra.</p>
      </sec>
    </sec>
    <sec>
      <title>Symmetrized Kullback–Leibler divergence</title>
      <p>The relative entropy or Kullback–Leibler <inline-formula><inline-graphic xlink:href="gkq661i2.jpg"/></inline-formula> divergence is a measure in statistics (<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>) that quantifies how close a probability distribution <inline-formula><inline-graphic xlink:href="gkq661i3.jpg"/></inline-formula> is to a model (or candidate) distribution <inline-formula><inline-graphic xlink:href="gkq661i4.jpg"/></inline-formula>:</p>
      <p>
        <inline-formula>
          <inline-graphic xlink:href="gkq661i5.jpg"/>
        </inline-formula>
      </p>
      <p>KL divergence is often used as a measure of the difference between two distributions (<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>). The KL divergence is not symmetric, thus we define the symmetrized Kullback–Leibler divergence <inline-formula><inline-graphic xlink:href="gkq661i6.jpg"/></inline-formula> (<xref ref-type="bibr" rid="B23">23</xref>) as:</p>
      <p>
        <inline-formula>
          <inline-graphic xlink:href="gkq661i7.jpg"/>
        </inline-formula>
      </p>
      <p>SKL is a useful metric for quantifying the difference between mutant spectra sequenced under differing conditions. When the selective pressures are equal, SKL should approach 0 and under differing selective pressures SKL is much greater than 0. SKL can be performed on specified regions of the mutant spectrum to determine regions of maximal or minimal divergence. The SKL command can also bin the sequences depending on their <italic>d</italic><sub>max</sub> across multiple sequencing lanes providing a measure of the relative entropy in bits between these populations:</p>
      <p>
        <inline-formula>
          <inline-graphic xlink:href="gkq661i8.jpg"/>
        </inline-formula>
      </p>
      <p>Where <italic>A</italic> is the symmetric matrix produced by SKL between the <italic>d</italic><sub>max</sub> binned populations from four example <italic>in vitro</italic> selection experiments with decreasing selective stringency.</p>
      <sec>
        <title>Similarity</title>
        <p>The similarity command returns several traditional population-based similarity indexes (Jaccard, Søresen and Mountford) frequently used in ecology to quantify the total relationship between two different populations (in this case, Illumina lanes) (<xref ref-type="bibr" rid="B24">24</xref>).</p>
      </sec>
      <sec>
        <title>Graph, fit, select, colorbase</title>
        <p>SEWAL consists of two windows, a text-based interface launched from the terminal/command line and an interactive 3D graphical interface that is activated by running the <italic>graph</italic> command from the SEWAL command line. Sequences are displayed as a mutant spectrum (<xref ref-type="fig" rid="F3">Figure 3</xref>) using the <italic>open</italic> command to load a .graph (<xref ref-type="fig" rid="F3">Figure 3</xref>), .vector (<xref ref-type="fig" rid="F4">Figure 4</xref>A) or .fit file (<xref ref-type="fig" rid="F4">Figure 4</xref>B) generated using <italic>findg</italic> (above). Multiple files can be loaded simultaneously, and the software has successfully produced graphs of as many as 7 × 10<sup>6</sup> sequences. Alternatively, using the .vector file format, the frequency of each sequence in different sequencing experiments is displayed visually as a color-coded vector (<xref ref-type="fig" rid="F4">Figure 4</xref>). The .fit files are particularly useful when the difference in the frequency of a genotype across lanes is known (or hypothesized) to be correlated with a difference in that genotype’s phenotypic fitness, because this plot then represents an empirical fitness landscape (J. N. Pitt and A. R. Ferré-D’Amaré, submitted for publication).</p>
        <p>From the graphical window, sequences can be selected using the mouse and exported using the <italic>select</italic> command to generate a new aggregate frequency file. Sequences can be colored using specified sequence parameters using the <italic>colorbase</italic> command (<xref ref-type="fig" rid="F3">Figure 3</xref>). The graphical window contains a menu system to adjust how elements are displayed, and the 3D plot can be rotated and zoomed using the mouse and captured and exported as a .tif file. The graphical window also generates a histogram for each of the three axes that can be displayed.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSIONS</title>
    <p>Visualization of hyperdimensional objects is not trivial; however, several software applications have been written to visualize multivariate data (<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>). We chose to build a new interactive 3D interface into SEWAL for several reasons. First, the standard software graphing packages available in most laboratories simply cannot graph more than 10<sup>5</sup> – 10<sup>6</sup> points. Illumina data sets routinely generate 10<sup>7</sup> – 10<sup>8</sup> sequences in a single run, and therefore all of these data cannot be visualized simultaneously. SEWAL has been used to graph (albeit slowly) data sets approaching 10<sup>7</sup> points, and there is no practical limit to the number it could graph at reduced frame rates. Second, using the 3D frequency plots to identify patterns or regions of interest in the data and exporting those DNA sequences is a useful feature. SEWAL supports this point-and-click methodology. Third, graphical representation of DNA sequence information in multiple colors and dimensions reveals interesting patterns in the data not provided by other applications.</p>
    <p>SEWAL provides a new platform for DNA sequence analysis and visualization of large data sets generated by massive sequencing to perform functional <italic>in vitro</italic> genetics. The visualization incorporates the underlying LSH information in a visually intuitive manner to generate mutant spectra. When the differences in these plots resulting from altered selective pressures are visualized, they can represent projections of the hyperdimensional fitness landscape, if the frequency of the sequences has been demonstrated to correlate with phenotypic fitness (<xref ref-type="bibr" rid="B8">8</xref>).</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>The W.M. Keck Foundation; <funding-source>Howard Hughes Medical Institute (HHMI)</funding-source>; <funding-source>Mentored Quantitative Research Career Development Award</funding-source> (K25) from <funding-source>National Institutes of Health</funding-source> grant <award-id>1K25DK082791-01A109</award-id> (to I.R.). Funding for open access charge: Howard Hughes Medical Institute.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>SEWAL contains data processing code from the ALGLIB library, written by Sergey Bochkanov (<ext-link ext-link-type="uri" xlink:href="http://www.alglib.net">http://www.alglib.net</ext-link>). We thank R. Basom, A. Marty, and the staff of the Fred Hutchison Cancer Research Center Genomics Shared Resource for performing the Illumina sequencing required for testing the software, and D. Bartel, B. Fritz, R. Knight, H. Malik, W.S. Noble, H. Robins, A. Roll-Mecak, and M. Tewari, for discussions. A.R.F. is an Investigator of the HHMI. We have released the SEWAL as an open source project on SourceForge (<ext-link ext-link-type="uri" xlink:href="http://www.sourceforge.net/projects/sewal">http://www.sourceforge.net/projects/sewal</ext-link>). This should allow the software to be adapted to other sequencing platforms and other applications not foreseen at the time of writing.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rusk</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Focus on next-generation sequencing data analysis</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>S1</fpage>
        <pub-id pub-id-type="pmid">19885970</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buhler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Efficient large-scale sequence comparison by locality-sensitive hashing</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>419</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="pmid">11331236</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Indyk</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal hashing algorithms for approximate nearest neighbor in high dimensions</article-title>
        <source>Commun. ACM</source>
        <year>2008</year>
        <volume>51</volume>
        <fpage>117</fpage>
        <lpage>122</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domingo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Escarmis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sevilla</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Moya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Elena</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Novella</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Basic concepts in RNA virus evolution</article-title>
        <source>FASEB J.</source>
        <year>1996</year>
        <volume>10</volume>
        <fpage>859</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="pmid">8666162</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The roles of mutation, inbreeding, crossbreeding and selection in evolution</article-title>
        <source>Proceedings of the Sixth International Congress of Genetics</source>
        <year>1932</year>
        <volume>1</volume>
        <fpage>356</fpage>
        <lpage>366</lpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard Smith</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Natural selection and the concept of a protein space</article-title>
        <source>Nature</source>
        <year>1970</year>
        <volume>225</volume>
        <fpage>563</fpage>
        <lpage>564</lpage>
        <pub-id pub-id-type="pmid">5411867</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poelwijk</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Kiviet</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Weinreich</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Tans</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Empirical fitness landscapes reveal accessible evolutionary paths</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>445</volume>
        <fpage>383</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">17251971</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Genotypes and phenotypes in the evolution of molecules</article-title>
        <source>Eur. Rev.</source>
        <year>2009</year>
        <volume>17</volume>
        <fpage>281</fpage>
        <lpage>319</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pitt</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Ferré-D’Amaré</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Structure-guided engineering of the regioselectivity of RNA ligase ribozymes</article-title>
        <source>J. Am. Chem. Soc</source>
        <year>2009</year>
        <volume>131</volume>
        <fpage>3532</fpage>
        <lpage>3540</lpage>
        <pub-id pub-id-type="pmid">19220054</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domingo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wain-Hobson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The 30th anniversary of quasispecies. Meeting on ‘Quasispecies: past, present and future'</article-title>
        <source>EMBO Rep.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>444</fpage>
        <lpage>448</lpage>
        <pub-id pub-id-type="pmid">19343047</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Musser</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Introspective sorting and selection algorithms</article-title>
        <source>Software Pract. Exper.</source>
        <year>1997</year>
        <volume>27</volume>
        <fpage>983</fpage>
        <lpage>993</lpage>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>PJA</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Heuer</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>1767</fpage>
        <lpage>1771</lpage>
        <pub-id pub-id-type="pmid">20015970</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quail</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scally</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Swerdlow</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A large genome center's improvements to the Illumina sequencing system</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>1005</fpage>
        <lpage>1010</lpage>
        <pub-id pub-id-type="pmid">19034268</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamming</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Error detecting and error correcting codes</article-title>
        <source>Bell Sys. Tech. J.</source>
        <year>1950</year>
        <volume>29</volume>
        <fpage>147</fpage>
        <lpage>160</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gold</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ehrenfeucht</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Information content of binding sites on nucleotide sequences</article-title>
        <source>J. Mol. Biol.</source>
        <year>1986</year>
        <volume>188</volume>
        <fpage>415</fpage>
        <lpage>431</lpage>
        <pub-id pub-id-type="pmid">3525846</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carothers</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Oestreich</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Szostak</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Informational complexity and functional activity of RNA structures</article-title>
        <source>J. Am. Chem. Soc.</source>
        <year>2004</year>
        <volume>126</volume>
        <fpage>5130</fpage>
        <lpage>5137</lpage>
        <pub-id pub-id-type="pmid">15099096</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNA sequence analysis using covariance models</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>2079</fpage>
        <lpage>2088</lpage>
        <pub-id pub-id-type="pmid">8029015</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Strang</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Introduction to Linear Algebra</source>
        <year>2009</year>
        <edition>4th edn</edition>
        <publisher-loc>Wellesley</publisher-loc>
        <publisher-name>Wellesley-Cambridge Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <source>An Introduction to Multivariate Statistical Analysis</source>
        <year>2003</year>
        <edition>3rd edn</edition>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Wiley-Interscience</publisher-name>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shokeer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mannervik</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Emergence of novel enzyme quasi-species depends on the substrate matrix</article-title>
        <source>J. Mol. Biol.</source>
        <year>2008</year>
        <volume>382</volume>
        <fpage>136</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="pmid">18640124</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kullback</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Information Theory and Statistics</source>
        <year>1997</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Courier Dover Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cover</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>Elements of Information Theory</source>
        <year>2006</year>
        <edition>2nd edn</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley-Interscience</publisher-name>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajapakse</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Perlman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Scalzo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kooperberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Groudine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kosak</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>The emergence of lineage-specific chromosomal topologies from coordinate gene regulation</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>6679</fpage>
        <lpage>6684</lpage>
        <pub-id pub-id-type="pmid">19276122</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolda</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Similarity indices, sample size and diversity</article-title>
        <source>Oecologia</source>
        <year>1981</year>
        <volume>50</volume>
        <fpage>296</fpage>
        <lpage>302</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubisz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Falush</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Inferring weak population structure with the assistance of sample group information</article-title>
        <source>Mol. Ecol. Resour.</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="pmid">21564903</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Swayne</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Extending the GGobi pipeline from R</article-title>
        <source>Computat. Stat.</source>
        <year>2009</year>
        <volume>24</volume>
        <fpage>195</fpage>
        <lpage>205</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
