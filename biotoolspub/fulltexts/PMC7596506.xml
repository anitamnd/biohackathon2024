<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7596506</article-id>
    <article-id pub-id-type="publisher-id">75586</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-75586-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ERgene: Python library for screening endogenous reference genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zeng</surname>
          <given-names>Zehua</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiong</surname>
          <given-names>Yuzhe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Wenhuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Du</surname>
          <given-names>Hongwu</given-names>
        </name>
        <address>
          <email>hongwudu@ustb.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.69775.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 0705</institution-id><institution>112 Lab, School of Chemistry and Biological Engineering, </institution><institution>University of Science and Technology Beijing, </institution></institution-wrap>Beijing, 100083 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>18557</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">In gene expression analysis, sample differences and experimental operation differences are common, but sometimes, these differences will cause serious errors to the results or even make the results meaningless. Finding suitable internal reference genes efficiently to eliminate errors is a challenge. Aside from the need for high efficiency, there is no package for screening endogenous genes available in Python. Here, we introduce ERgene, a Python library for screening endogenous reference genes. It has extremely high computational efficiency and simple operation steps. The principle is based on the inverse process of the internal reference method, and the robust matrix block operation makes the selection of internal reference genes faster than any other method.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Genomic analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Hebei Provincial Department of Science and Technology</institution>
        </funding-source>
        <award-id>No.19942410G</award-id>
        <award-id>No.19942410G</award-id>
        <award-id>No.19942410G</award-id>
        <award-id>No.19942410G</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zeng</surname>
            <given-names>Zehua</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>Yuzhe</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Wenhuan</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>Hongwu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Gene expression analysis has become increasingly important in many areas of biological research. The commonly used measurement methods include microarray<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, RT-PCR<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> and massively parallel sequencing<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. However, these measurements also require normalization to reduce the differences between samples. The existing normalization methods include geNorm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, Normfinder<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and BestKeeper<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. All three methods start with a limited set of candidate reference genes. Further, geNorm and BestKeeper also calculate a normalization factor. On the one hand, the calculation efficiency of the above methods is not high enough, and the screening process is sometimes complicated. On the other hand, there are currently no available package for screening endogenous reference genes in Python. In order to solve these problems, a new approach is proposed by analyzing the principle of the internal reference method. Using the computational power of the Pandas library in Python, we build a Python library to meet the requirements of normalization and internal reference gene screening.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Screening effect of laboratory gene expression data</title>
      <p id="Par3">We took some tissues from the same location in the brains of two aging mice injected with SHED (Stem cells from human exfoliated deciduous teeth) and two aging mice injected with salt. And gene expression analysis was performed on these tissues to obtain test data. The test data can be found on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/Starlitnightly/ERgene/tree/master/example">https://github.com/Starlitnightly/ERgene/tree/master/example</ext-link>). First, we analyzed the difference of the sample spectral density in the test data and made a box and a density diagram (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a,b). The difference of the sample spectral density generally refers to differences in the spectral density of all gene expressions between each sample, such as the differences between individual mice, or the differences between experiments. If the difference of the sample spectral density is too large, the subsequent analysis will be meaningless. To avoid this, researchers typically use internal reference genes to normalize the data. Therefore, it is very important to look for stable internal reference genes. In the test data, we used the ERgene.FindERG method. Then the candidate internal reference gene Atp1a3 was found. Using the gene Atp1a3, we normalized the test data and made the boxplot in the same way (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c,d). By comparing Figs. <xref rid="Fig1" ref-type="fig">1</xref>a,c and Fig. <xref rid="Fig1" ref-type="fig">1</xref>b,d, we can see that the difference of the sample spectral density has been significantly reduced. Therefore, ERgene has a significant effect on reduce the difference of the sample spectral density when it comes to processing raw lab data.<fig id="Fig1"><label>Figure 1</label><caption><p>(<bold>a</bold>) The boxplot of test data before processing. (<bold>b</bold>) The density plot of the test data before processing. (<bold>c</bold>) The boxplot of test data after processing. (<bold>d</bold>) The density plot of the test data after processing. The boxplot’s abscissa is the sample, the ordinate is the gene expression, the green line is the median, the blue box line is the quartile, and the black point is the outlier. The density plot’s abscissa is the length of the data, the ordinate is the data density, and the lines of different colors represent different samples.</p></caption><graphic xlink:href="41598_2020_75586_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Screening effect of public datasets</title>
      <p id="Par4">After obtaining good results from the raw lab test data, we selected a dataset in the GEO database that had not been well normalized for verification. The dataset selected was the mouse dataset GSE4786 of Someya<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. We analyzed the difference of the sample spectral in the experimental data and made a box diagram and a density diagram (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a,b). Then, we used the ERgene.FindERG method and found the internal reference gene 1439423_x_at. Using the gene 1439423_x_at, we normalized the data and plotted the boxplot in the same way (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c,d). By comparing Figs. <xref rid="Fig2" ref-type="fig">2</xref>a,c and Fig. <xref rid="Fig2" ref-type="fig">2</xref>b,d, we can see that the difference of the sample spectral has been narrowed. The reason for choosing this dataset is that most of the data on GEO have been normalized. It is not surprising that ERgene had achieved this effect for a dataset that was not so well normalized.<fig id="Fig2"><label>Figure 2</label><caption><p>(<bold>a</bold>) The boxplot of GSE4786-MC before processing. (<bold>b</bold>) The density plot of the GSE4786-MC before processing. (<bold>c</bold>) The boxplot of GSE4786-MC after processing. (<bold>d</bold>) The density plot of the GSE4786-MC after processing. The boxplot’s abscissa is the sample, the ordinate is the gene expression, the green line is the median, the blue box line is the quartile, and the black point is the outlier. The density plot’s abscissa is the length of the data, the ordinate is the data density, and the lines of different colors represent different samples.</p></caption><graphic xlink:href="41598_2020_75586_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Further confirmed the screening results by literature</title>
      <p id="Par5">In the study of Horrison, the main purpose was to investigate the related internal reference genes for aortic lesions associated with bicuspid valve<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. A total of 12 reference genes ATP5B, ACTB, B2M, CYC1, EIF4A2, GAPDH, SDHA, RPL13A, TOP1, UBC, YWHAZ, and 18S were detected. In his report, geNorm was used to test these 12 genes to determine the most stable single internal reference gene. We used ERgene to analyze the author’s raw data. Twenty possible reference genes were obtained (CYC16, CYC11, TOP16, CYC4, TOP11, CYC2, CYC10, CYC7, CYC12, CYC1, CYC9, EIF4A17, CYC8, TOP4, TOP10, TOP2, CYC5, TOP9, CYC3 and TOP7). All the genes that were found can divided into three families: CYC, TOP, and EIF4A. Only one member in each family should be used for normalization to not bias the results because family members may be coregulated. By comparing these three families with the 12 reference genes obtained in the study, we can see that CYC1 and TOP1 coincide, consistent with the report.</p>
      <p id="Par6">McLoughlin et al. selected a Real-Time PCR Housekeeping Gene Panel in Human Endothelial Colony Forming Cells<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. A total of 28 candidate internal reference genes were screened out by geNorm (RPL37, RPS29, RPL9, VIM, NDUFB3, ATP51, RPL31, RPS27, CTGF, NDUPB4, ATP5J, RPS6, ACTB, ATP5FI, RPL27A, PGAM4, RPSIO, RPL30, HSPA8, RPL13, RPLI9, NDUFB8, ATP5L, UBC, VWHAC, PRDX1, GAPDH and B2M). And six stable reference genes (RPL13, RPL31, RPL37, RPL30, RPS6, and RPL19) were verified by experiments. We used ERgene to analyze the authors’ original dataset GSE125792. When the depth was set to 2, we obtained twenty candidate reference genes (RPL19, RPS4X, RPL13, TUBA1A, SF3B5, RPS3a, RPL9, RPL39L, LDHA, RPS8, RPL31, FTL, RPS3, RPL22, PINLYP, CAPG, UQCRH, RPS5, RPSAP58, and RPL36). When the depth was set to 3, seven candidate reference genes (RPL13, FTL, RPS3a, SF3B5, RPS4X, TUBA1A, and RPL19) were obtained. RPL13, the most stable reference gene determined by experiments, ranks high in our algorithm results.</p>
    </sec>
    <sec id="Sec6">
      <title>The overlap rate of genes in sample pairs</title>
      <p id="Par7">ERgene screened 20 candidate internal reference genes from the two groups of samples in the dataset, and the computational depth represented the number of samples selected. When the computational depth reached 3, the 20 candidates were selected from the three pairs of samples (1, 2) (1, 3) and (2, 3), and then take the intersection. Here, we selected 12 samples of the dataset GSE125792 used by McLoughlin et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, calculated the 20 internal reference genes screened by 66 pairs of samples, and then showed the overlap of samples through the form of Upsetplot (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). There are 10 genes in Fig. <xref rid="Fig3" ref-type="fig">3</xref> with sample coverage of more than 80%. The result means that when we increase the computational depth, the duplication rate of the selected candidate internal reference gene is still more than 50%. Ten genes are included in RPL13 (probe ID: ASHGV40056316; platform: GPL21827). RPL13 was experimentally confirmed as a stable candidate internal reference gene<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.<fig id="Fig3"><label>Figure 3</label><caption><p>The upsetplot of 66 sample pairs overlap (GSE125792, 12 samples). The abscissa represents the sample pair, and the ordinate represents the appearance of the candidate internal reference genes. The height of the column in the upper bar chart represents the number of the sample pairs. In the upper bar chart, the height of the column represents the ordinal number of the sample pair. The higher the ordinal number, the higher the column.</p></caption><graphic xlink:href="41598_2020_75586_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par8">ERgene makes up for the fact that python library do not have a right method for screening reference genes, and geNorm is embedded in qbase + or Excel 2003. Normfinder is a source for the R language or Excel 2003. The application of these methods is troublesome and not particularly friendly to Python users. On the Python platform, the user only needs to enter three sentences to start filtering the internal reference gene. It seems extremely simple and friendly. The computational efficiency of ERgene is increased by nearly 90% higher than that of Normfinder, which also uses all genes for reference genes (Table <xref rid="Tab1" ref-type="table">1</xref>). Besides, the internal reference genes found by ERgene, NormFinder and geNorm were similar (Table <xref rid="Tab2" ref-type="table">2</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Normfinder versus ERgene in computational time.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">The Number of genes</th><th align="left" colspan="2">2 samples</th><th align="left" colspan="2">3 samples</th><th align="left" colspan="2">4 samples</th></tr><tr><th align="left">Normfinder</th><th align="left">ERgene</th><th align="left">Normfinder</th><th align="left">ERgene</th><th align="left">Normfinder</th><th align="left">ERgene</th></tr></thead><tbody><tr><td align="left">100</td><td align="left">0.1 s</td><td align="left">0.1 s</td><td align="left">0.5 s</td><td align="left">0.66 s</td><td align="left">1 s</td><td align="left">1.37 s</td></tr><tr><td align="left">500</td><td align="left">35 s</td><td align="left">0.48 s</td><td align="left">42 s</td><td align="left">1.35 s</td><td align="left">44 s</td><td align="left">2.67 s</td></tr><tr><td align="left">1000</td><td align="left">6 min</td><td align="left">1.05 s</td><td align="left">6 min 11 s</td><td align="left">3.20 s</td><td align="left">6 min 40 s</td><td align="left">10.89 s</td></tr><tr><td align="left">2000</td><td align="left">55 min</td><td align="left">4.58 s</td><td align="left">55 min</td><td align="left">10.95 s</td><td align="left">56 min</td><td align="left">28.47 s</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of internal reference genes found (the genes in bold are identical; the genes in italics are in the same family) (The test data are not converted by a probe).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Normfinder &amp; geNorm</th><th align="left">ERgene</th></tr></thead><tbody><tr><td align="left">Test dataset (<bold>No probe conversion was performed</bold>)</td><td align="left">P47754, <bold>Q68FG2,</bold> A0A0G2JDX4, Q9WVA2, P26443, Q8BU30, Q8R1Q8, Q8CBG6, Q80UW2, A0A494BAX5, <bold>Q6PIC6</bold></td><td align="left"><bold>Q6PIC6</bold>, A3KGU7, Q03265, P63260, O08553, Q62261, P63101, <bold>Q68FG2</bold>, P05064, P17182</td></tr><tr><td align="left">Horrison dataset</td><td align="left">ATP5B, ACTB, B2M, <bold><italic>CYC1</italic></bold>, <italic>EIF4A2</italic>, GAPDH, SDHA, RPL13A, <italic>TOP1</italic>, UBC, YWHAZ</td><td align="left"><italic>CYC16</italic><italic>, </italic><italic>CYC11</italic><italic>, </italic><italic>TOP16</italic><italic>, </italic><italic>CYC4</italic><italic>, </italic><italic>TOP11</italic><italic>, </italic><italic>CYC2</italic><italic>, </italic><italic>CYC10</italic><italic>, </italic><italic>CYC7</italic><italic>, </italic><italic>CYC12</italic><italic>, </italic><bold><italic>CYC1</italic></bold><italic>, </italic><italic>CYC9</italic><italic>, </italic><italic>EIF4A17</italic><italic>, </italic><italic>CYC8</italic><italic>, </italic><italic>TOP4</italic><italic>, </italic><italic>TOP10</italic><italic>, </italic><italic>TOP2, CYC5</italic><italic>, </italic><italic>TOP9</italic><italic>, </italic><italic>CYC3</italic><italic>, </italic><italic>TOP7</italic></td></tr><tr><td align="left">McLoughlin dataset</td><td align="left"><italic>RPL37</italic><italic>, </italic><italic>RPS29</italic><italic>, </italic><bold><italic>RPL9,</italic></bold> VIM, NDUFB3, ATP51, <bold><italic>RPL31</italic></bold><italic>, </italic><italic>RPS27,</italic> CTGF, NDUPB4, ATP5J, <italic>RPS6,</italic> ACTB, ATP5FI, <italic>RPL27A,</italic> PGAM4, RPSIO, <italic>RPL30,</italic> HSPA8, <bold><italic>RPL13</italic></bold><italic>, </italic><bold><italic>RPL19</italic></bold>, NDUFB8, ATP5L, UBC, VWHAC, PRDX1, GAPDH, B2M</td><td align="left"><bold><italic>RPL19</italic></bold>, <italic>RPS4X</italic><italic>, </italic><bold><italic>RPL13,</italic></bold> TUBA1A, SF3B5, <italic>RPS3a</italic><italic>, </italic><bold><italic>RPL9</italic></bold><italic>, </italic><italic>RPL39L,</italic> LDHA, <italic>RPS8</italic><italic>, </italic><bold><italic>RPL31,</italic></bold> FTL, <italic>RPS3</italic><italic>, </italic><italic>RPL22,</italic> PINLYP, CAPG, UQCRH, <italic>RPS5</italic><italic>, </italic><italic>RPSAP58</italic><italic>, </italic><italic>RPL36</italic></td></tr></tbody></table></table-wrap></p>
    <p id="Par9">Although ERgene may not be new in principle, the calculation uses a new formula, which leads to a significant improvement in computing time over that of the complex matrix operations of geNorm and NormFinder. ERgene using each gene as a normalizer, calculates the ratio of each gene pair as done in the geNorm method (formula Eq. (<xref rid="Equ2" ref-type="">2</xref>)). Also, the sigma squared value is equivalent to that of geNorm (formula Eq. (<xref rid="Equ3" ref-type="">3</xref>)). NormFinder does not use candidate reference genes, but uses all genes to search for internal reference genes, thus, candidate instability can be avoided to a certain extent. The total number of genes tested was 1968. When the computational depth was set to 2 (screening internal reference genes with two samples) it only took the 4.58 s to obtain the possible internal reference genes because there is no complicated exponentiation. When the computational depth is set to 3 or larger, the efficiency begins to decline. When the computational depth set too large, there may be no result. Because when the computational depth is 3 or larger, the screening will select the internal reference genes from two different sample combinations, and then take the intersection from the screening results for all combinations.</p>
    <p id="Par10">The geNorm algorithm has the unique advantage of identifying the most stable reference gene from a tested set of candidate reference genes in each sample. Bestkeeper calculates all kinds of unique Bestkeeper indexes bases on the genes of the housekeeper. The amount of calculation is larger than that of geNorm, but the accuracy is improved. Both algorithms require researchers to provide genes in advance, and their applications are limited. However, ERgene directly searches and analyzes all genes according to existing samples, without the need for candidate reference genes; thus its application scope is greatly improved.</p>
    <p id="Par11">Normfinder constructed a mathematical model. It first synthesized a stable value for screening based on the intra-group variation and inter-group variation of all genes, which were improved over those of geNorm and Bestkeeper. This algorithm was excellent. ERgene used the expression multiple during internal standard normalization in the calculation of intra-group variation. And the expression multiple refered to the expression multiple of a gene relative to the internal reference gene. For example, in sample 1, if gene1 was the internal reference, gene2 should be about three times as much as gene1 in sample 2. Then the internal reference gene was screened out by the magnitude of expression multiple changes between different groups. The principle of internal reference was more consistent in ERgene than in Normfinder.</p>
    <p id="Par12">ERgene also provides a processing method for internal reference data, which is not the optimal internal reference processing method but only uses a single gene provided by ERgene. FindERG calculate the normalization factor, and the verification effect is better than other exist methods for the same experimental group. According to the MIQE guidelines<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, it is not acceptable to normalize a single internal reference gene unless the investigator provides clear evidence to the reviewer to confirm its invariable expression under the above experimental conditions. Several studies<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> have demonstrated the problem of using a single reference gene and recommend using at least two stably expressed reference genes. And the clustering algorithm for normalizing computing factors is most incisive in geNorm, so it is a good choice to use ERgene to screen out internal reference genes and then use geNorm or Normfinder to calculate the normalized factors for normalization processing.</p>
  </sec>
  <sec id="Sec8">
    <title>Features and methods</title>
    <sec id="Sec9">
      <title>Algorithms and mathematical descriptions</title>
      <sec id="Sec10">
        <title>Principle</title>
        <p id="Par13">Based on internal standard method, the ratio of each gene expression quantity to the other gene expression quantity was calculated as a relative correction factor, and the calculated results were presented in the form of matrix. The ERgene algorithm inverts this process. Sample 1 calculates the relative correction factor <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F$$\end{document}</tex-math><mml:math id="M2"><mml:mi>F</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq1.gif"/></alternatives></inline-formula> of each gene, and sample 2 repeats the process. The differences between the results of the two samples were compared to obtain the range <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta F$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq2.gif"/></alternatives></inline-formula> of the relative correction factor between each gene. <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }^{2}$$\end{document}</tex-math><mml:math id="M6"><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq3.gif"/></alternatives></inline-formula> was calculated for the range of variation of each gene, then sort the results of variation from smallest to largest. The program will return the top 20 genes as a result.</p>
        <p id="Par14">When the depth is greater than two samples, for example, a depth of three samples will be selected according to the combined counting method. Three samples (1, 2), (1, 3) and (2, 3) will be selected to obtain the internal reference genes, and then the intersection will be obtained.</p>
      </sec>
      <sec id="Sec11">
        <title>Optimization</title>
        <p id="Par15">When the gene dataset is too large, block calculation is adopted. Every 1000 genes are taken as a block. When all the blocks have been computed, the results are combined and sorted by sorting them from smallest to largest. The program will return the top 20 genes as a result.</p>
      </sec>
      <sec id="Sec12">
        <title>Mathematical description</title>
        <p id="Par16">Let sample 1 be <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}={\left[{A}_{1},{A}_{2},{A}_{3},\dots ,{A}_{n}\right]}^{T}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq4.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq5.gif"/></alternatives></inline-formula> is the expression of the i-th gene in sample 1. The relative correction factor matrix <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${F}_{1}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq6.gif"/></alternatives></inline-formula> is<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F_{1} &amp; = \left[ {x_{1} \div A_{1} ,x_{1} \div A_{2} ,x_{1} \div A_{3} , \ldots ,x_{1} \div A_{n} } \right] \\ &amp; = \left[ {\begin{array}{*{20}c} {\frac{{A_{1} }}{{A_{1} }}} &amp; \cdots &amp; {\frac{{A_{n} }}{{A_{1} }}} \\ \vdots &amp; \ddots &amp; \vdots \\ {\frac{{A_{n} }}{{A_{1} }}} &amp; \cdots &amp; {\frac{{A_{n} }}{{A_{n} }}} \\ \end{array} } \right] \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>÷</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>÷</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>÷</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>÷</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2020_75586_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par17">Similarly, let sample 2 be <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}={\left[{B}_{1},{B}_{2},{B}_{3},\dots ,{B}_{n}\right]}^{T}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq7.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{i}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq8.gif"/></alternatives></inline-formula> is the expression of the i-th gene in sample 2. The relative correction factor matrix <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${F}_{2}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq9.gif"/></alternatives></inline-formula> is<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${F}_{2}=\left[\begin{array}{ccc}\frac{{B}_{1}}{{B}_{1}}&amp; \cdots &amp; \frac{{B}_{n}}{{B}_{1}}\\ \vdots &amp; \ddots &amp; \vdots \\ \frac{{B}_{n}}{{B}_{1}}&amp; \cdots &amp; \frac{{B}_{n}}{{B}_{n}}\end{array}\right]$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2020_75586_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par18">The relative factor change amplitude matrix <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta F$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq10.gif"/></alternatives></inline-formula> is<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta F={F}_{1}-{F}_{2}=\left[\begin{array}{ccc}\frac{{A}_{1}}{{A}_{1}}-\frac{{B}_{1}}{{B}_{1}}&amp; \cdots &amp; \frac{{A}_{n}}{{A}_{1}}-\frac{{B}_{n}}{{B}_{1}}\\ \vdots &amp; \ddots &amp; \vdots \\ \frac{{A}_{n}}{{A}_{1}}-\frac{{B}_{n}}{{B}_{1}}&amp; \cdots &amp; \frac{{A}_{n}}{{A}_{n}}-\frac{{B}_{n}}{{B}_{n}}\end{array}\right]$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2020_75586_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par19">The variance vector <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }^{2}$$\end{document}</tex-math><mml:math id="M28"><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2020_75586_Article_IEq11.gif"/></alternatives></inline-formula> of the magnitude of change in relative factors for each gene is<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }^{2}={\left[\begin{array}{ccc}\frac{\sum {(\Delta {F}_{1i}-\frac{\sum ({\Delta F}_{1i})}{n})}^{2}}{n}&amp; \dots &amp; \frac{\sum {(\Delta {F}_{ni}-\frac{\sum ({\Delta F}_{ni})}{n})}^{2}}{n}\end{array}\right]}^{T}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">ni</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ni</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><graphic xlink:href="41598_2020_75586_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Function description</title>
      <sec id="Sec14">
        <title>ERgene.FindERG(data, depth)</title>
        <p id="Par20">This function is used to screen internal reference genes. The parameter data are in DataFrame format, where the first column is the gene ID, and the other column is the expression level of each gene in the sample. The depth of the parameter refers to the number of samples to be selected for internal reference genes. For example, a depth of 2 is used for screening samples 1 and 2. A depth of 3 means sample 1 and sample 2, sample 1 and sample 3, and sample 2 and sample 3 are screened separately, and then the intersection is removed. The greater the depth, the fewer the number of internal reference genes screened, which cannot be fewer than 2 or more than the number of samples. And users can compare the results at different depths. The speed of calculation depends on the depth of calculation. Genes in calculation results may come from the same family, and only one family member should be used in normalization. When the calculation depth is larger than 2, an Upsetplot will be generated to show the overlap rate of the candidate internal reference genes generated by each pair of samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
      </sec>
      <sec id="Sec100">
        <title>ERgene.normalizationdata(data, ERGname)</title>
        <p id="Par21">This function is used for the standardization of a single internal reference gene. The parameter data are in DataFrame format, where the first column is the gene ID, and the second column is the expression level of each gene in the sample. The parameter ERGname is the name of the internal reference gene to be processed. The computation speed is accelerated by using the multi-threaded matrix operation of Pandas, making the computation speed faster.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank James Bruner for his proofread and native processing of this manuscript. This work was supported by Hebei Provincial Department of Science and Technology (No.19942410G).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Z.Z. conceived and designed ERgene, implemented it in Python, tested ERgene, analyzed the data, and prepared all figures. W.G. provided the test data by mouse experiment. Z.Z. and H.D. wrote the main manuscript text. Y.X. reviewed and modified the full text. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Raw test data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Starlitnightly/ERgene/tree/master/example">https://github.com/Starlitnightly/ERgene/tree/master/example</ext-link><underline>.</underline> The GEO datasets analyzed during the current study are available in the Gene Expression Omnibus repository, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE4786">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE4786</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125792">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125792</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Source code is available for academic non-commercial research purposes. Links to code and documentation are provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/Starlitnightly/ERgene">https://github.com/Starlitnightly/ERgene</ext-link><underline>.</underline></p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par22">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schena</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shalon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Quantitative monitoring of gene expression patterns with a complementary DNA microarray</article-title>
        <source>Science (New York, N. Y.)</source>
        <year>1995</year>
        <volume>270</volume>
        <fpage>467</fpage>
        <lpage>470</lpage>
        <pub-id pub-id-type="doi">10.1126/science.270.5235.467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fink</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time quantitative RT–PCR after laser-assisted cell picking</article-title>
        <source>Nat. Med.</source>
        <year>1998</year>
        <volume>4</volume>
        <fpage>1329</fpage>
        <lpage>1333</lpage>
        <pub-id pub-id-type="doi">10.1038/3327</pub-id>
        <pub-id pub-id-type="pmid">9809560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel sequencing</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>326</fpage>
        <lpage>327</lpage>
        <?supplied-pmid 16163333?>
        <pub-id pub-id-type="pmid">16163333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandesompele</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate normalization of real-time quantitative RT-PCR data by geometric averaging of multiple internal control genes</article-title>
        <source>Genome Biol.</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>h31</fpage>
        <lpage>h34</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersen</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ørntoft</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>Normalization of real-time quantitative reverse transcription-PCR data: a model-based variance estimation approach to identify genes suited for normalization, applied to bladder and colon cancer data sets</article-title>
        <source>Cancer Res.</source>
        <year>2004</year>
        <volume>64</volume>
        <fpage>5245</fpage>
        <lpage>5250</lpage>
        <?supplied-pmid 15289330?>
        <pub-id pub-id-type="pmid">15289330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Tichopad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prgomet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Neuvians</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Determination of stable housekeeping genes, differentially regulated target genes and sample integrity: bestkeeper-excel-based tool using pair-wise correlations</article-title>
        <source>Biotechnol. Lett.</source>
        <year>2004</year>
        <volume>26</volume>
        <fpage>509</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">15127793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Someya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamasoba</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weindruch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Prolla</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tanokura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Caloric restriction suppresses apoptotic cell death in the mammalian cochlea and leads to prevention of presbycusis</article-title>
        <source>Neurobiol. Aging</source>
        <year>2007</year>
        <volume>28</volume>
        <fpage>1613</fpage>
        <lpage>1622</lpage>
        <?supplied-pmid 16890326?>
        <pub-id pub-id-type="pmid">16890326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Moorjani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Torrens</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ohri</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Cagampang</surname>
            <given-names>FR</given-names>
          </name>
        </person-group>
        <article-title>Endogenous reference genes for gene expression studies on bicuspid aortic valve associated aortopathy in humans</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>e164329</fpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLoughlin</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Pedrini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>MacMahon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guduric-Fuchs</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Selection of a real-time PCR housekeeping gene panel in human endothelial colony forming cells for cellular senescence studies</article-title>
        <source>Front. Med.</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>33</fpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bustin</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>The MIQE Guidelines: M Inimum I Nformation for Publication of Q Uantitative Real-Time PCR Experiments</source>
        <year>2009</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
