<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10663984</article-id>
    <article-id pub-id-type="pmid">37952198</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad657</article-id>
    <article-id pub-id-type="publisher-id">btad657</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>oggmap: a Python package to extract gene ages per orthogroup and link them with single-cell RNA data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4308-9626</contrib-id>
        <name>
          <surname>Ullrich</surname>
          <given-names>Kristian K</given-names>
        </name>
        <aff><institution>Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
        <xref rid="btad657-cor1" ref-type="corresp"/>
        <!--ullrich@evolbio.mpg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2943-3622</contrib-id>
        <name>
          <surname>Glytnasi</surname>
          <given-names>Nikoleta E</given-names>
        </name>
        <aff><institution>Max Planck Research Group: Dynamics of Social Behavior, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad657-cor1">Corresponding author. Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology, August Thienemann Str. 2, 24306 Plön, Germany. E-mail: <email>ullrich@evolbio.mpg.de</email> (K.K.U.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-11">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad657</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad657.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>For model species, single-cell RNA-based cell atlases are available. A good cell atlas includes all major stages in a species’ ontogeny, and soon, they will be standard even for nonmodel species. Here, we propose a Python package called <italic toggle="yes">oggmap</italic>, which allows for the easy extraction of an orthomap (gene ages per orthogroup) for any given query species from OrthoFinder and other gene family data resources, like homologous groups from eggNOG or PLAZA. <italic toggle="yes">oggmap</italic> provides extracted gene ages for more than thousand eukaryotic species which can be further used to calculate gene age-weighted expression data from scRNA sequencing objects using the Python Scanpy toolkit. Not limited to one transcriptome evolutionary index, <italic toggle="yes">oggmap</italic> can visualize the individual gene category (e.g. age class, nucleotide diversity bin) and their corresponding expression profiles to investigate scRNA-based cell type assignments in an evolutionary context.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">oggmap</italic> source code is available at <ext-link xlink:href="https://github.com/kullrich/oggmap" ext-link-type="uri">https://github.com/kullrich/oggmap</ext-link>, documentation is available at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>. <italic toggle="yes">oggmap</italic> can be installed via PyPi or directly used via a docker container.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council Starting</institution>
          </institution-wrap>
        </funding-source>
        <award-id>850529</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, the availability of single-cell RNA (scRNA) sequencing data and its analysis tools has constantly been on the rise. However, using phylogenetic information with scRNA data to, e.g. better predict cell types in a cross-species manner is so far sparse (<xref rid="btad657-B27" ref-type="bibr">Tarashansky <italic toggle="yes">et al.</italic> 2021</xref>). Linking gene age with RNA sequencing data to better explain the developmental stages of an organism in the context of evolution has been a topic for over a decade (<xref rid="btad657-B2" ref-type="bibr">Domazet-Lošo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi 2018</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). Methods to infer phyletic pattern of genes for a given query species are still a time-consuming step and as such a bottleneck to weight expression of a gene by its gene age. Once gene ages are inferred, the transcriptome age index (short TAI) can distinguish between a “young” and an “old” transcriptome to, e.g. investigate the hourglass model of embryonic development (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>) or to highlight cell type-specific enrichment patterns (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>). TAI calculation is already implemented in the R <italic toggle="yes">myTAI</italic> package, primarily working with bulk-RNA data (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>), so far lacking a Python supplement.</p>
    <p>Since introducing TAI, a variety of analysis types have been created to link and weight transcriptome data with an evolutionary age or a different evolutionary index, like gene substitution rates or promoter conservation score (<xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B4" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad657-B8" ref-type="bibr">Gossmann <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). As a consequence, not be limited to age, we use the parent term transcriptome evolutionary index (short TEI) as introduced by <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi (2018)</xref>. The transition of the TEI analysis from bulk-RNA data to scRNA data, which both rely on an evolutionary age category, just recently begun (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). If based on blast sequence searches, the resulting gene ages are collected for each individual gene (so-called <italic toggle="yes">phylostratigraphic maps</italic>). The age assignment is based on the “oldest” found homolog along the tree of life.</p>
    <p>In contrast to the original implementation (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>) using blast hits to extract gene ages, orthologous groups can be used (<xref rid="btad657-B24" ref-type="bibr">Ruprecht <italic toggle="yes">et al.</italic> 2017</xref>). This will assign gene ages not per gene, but will assign the same evolutionary age to all genes of a given <italic toggle="yes">orthogroup</italic>. It is important to note that to extract the gene age for a given <italic toggle="yes">orthogroup</italic>, one needs to define a query species to start from (sometimes called focal species). Given a query species, all other species members of the same <italic toggle="yes">orthogroup</italic> are compared using a species tree to extract the lowest common ancestor (LCA). In other words, the deepest node from the query species tip to the root node or the last universal common ancestor of the species tree (<xref rid="btad657-B12" ref-type="bibr">Julca <italic toggle="yes">et al.</italic> 2021</xref>). We call the resulting gene age classification <italic toggle="yes"><bold>o</bold>rtholo<bold>g</bold>ous</italic><italic toggle="yes"><bold>g</bold>roups</italic><bold><italic toggle="yes">map</italic></bold> (short <italic toggle="yes">orthomap</italic>).</p>
  </sec>
  <sec>
    <title>2 Oggmap implementation</title>
    <p><italic toggle="yes">oggmap</italic> (implemented in Python) uses different bioinformatic methods for importing, analyzing, and visualizing. All main steps of <italic toggle="yes">oggmap</italic> are illustrated in <xref rid="btad657-F1" ref-type="fig">Fig. 1a</xref>. The documentation of <italic toggle="yes">oggmap</italic> will guide the user through all necessary steps. <italic toggle="yes">oggmap</italic> relies on orthogroups and can parse so far results from either OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), or precalculated gene family databases, like eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) or PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>). <italic toggle="yes">oggmap</italic> provides gene age class assignments for a high number of species (Ensembl release-110: 317; eggNOG v6: 1322, PLAZA v5: 98 dicots and 52 monocots), so that a researcher might start directly to analyze scRNA data for a given query species of interest. If the query species is not among them, the guide will help how to perform the mandatory step 0. All further steps to create an <italic toggle="yes">orthomap</italic> (steps 1 and 2) can be run on command line as well as using the Python API. Given a query species, the taxonomic lineage information will be used (<italic toggle="yes">qlin module</italic>) to assign an age class per <italic toggle="yes">orthogroup</italic> based on the LCA (<italic toggle="yes">of2orthomap module</italic>). Internally, these steps use the Python toolkit <italic toggle="yes">ete3</italic> (<xref rid="btad657-B11" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic> 2016</xref>) to fetch NCBI taxonomic tree information. In addition, for each <italic toggle="yes">orthogroup</italic> a continuity score can be optionally calculated, which represents the species completeness along the tree nodes from the LCA to the focal species. A low continuity score would thereby highlight, e.g. a possible horizontal gene transfer event, where intermediate tree nodes lack any detectable <italic toggle="yes">orthologs</italic>. All further steps (3, 4, and downstream analysis 5) to match gene names from the <italic toggle="yes">orthomap</italic> and scRNA data (in case of different annotation source; <italic toggle="yes">gtf2t2g module</italic>), calculate TEI, and visualizing the results (<italic toggle="yes">orthomap2tei module</italic>) are run with the Python API in, e.g. a Jupyter notebook (<xref rid="btad657-F1" ref-type="fig">Fig. 1b–g</xref>). Internally, NumPy (<xref rid="btad657-B9" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2020</xref>), pandas <italic toggle="yes">DataFrame</italic> objects (<xref rid="btad657-B19" ref-type="bibr">McKinney <italic toggle="yes">et al.</italic> 2011</xref>), and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) with <italic toggle="yes">AnnData</italic> objects are the working horses.</p>
    <fig position="float" id="btad657-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(a) Overview of <italic toggle="yes">oggmap</italic> steps. (b) <italic toggle="yes">Orthomap</italic> for the query species zebrafish (<italic toggle="yes">Danio rerio</italic>). Each gene (seqID) from an Orthogroup is assigned to a gene age class (PSnum, PSname) given a continuity score (PScontinuity). (c) Number of genes per gene age class. (d) Boxplot of zebrafish (<italic toggle="yes">D.rerio</italic>) TEI values grouped per embryo stage. (e) Contribution of gene age classes to the global TEI per embryo time (nematode). Zebrafish scRNA data UMAP, each cell is colored by embryo stage (f) or its corresponding TEI value (g).</p>
      </caption>
      <graphic xlink:href="btad657f1" position="float"/>
    </fig>
    <p>Dealing with scRNA data introduces a computational burden to TEI calculation, since unlike for bulk-RNA data with a rather low number of stages, now thousand of cells need to be processed. TEI is implemented as given in <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz (2010)</xref> and due to sparse-matrix calculation scales for millions of cells. TEI represents the weighted arithmetic mean (expression levels as weights for the age category) over all evolutionary age categories denoted as <italic toggle="yes">phylostra</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>*</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the TEI value in a cell or a cell type <italic toggle="yes">c</italic>, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the gene expression level of gene <italic toggle="yes">i</italic> in cell <italic toggle="yes">c</italic>, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the corresponding <italic toggle="yes">phylostratum</italic> of gene <italic toggle="yes">i</italic>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">N</italic> is the total number of genes.</p>
    <p>Next to adding TEI values to scRNA data (<italic toggle="yes">get_tei</italic>), other useful function from the <italic toggle="yes">myTAI</italic> R package (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>) has been ported to Python and extended to deal with cell-type groups. For example, one can calculate partial TEI values (<italic toggle="yes">get_pstrata</italic>) to visualize the contribution of each gene age class to the global TEI pattern. Or extract the relative expression per gene age class grouped by any annotated observation like cell-type or sampling timepoint starting either from raw counts or using the implemented expression transformation options (<italic toggle="yes">get_rematrix</italic>). Other gene based metric, like Tajima’s D (<xref rid="btad657-B26" ref-type="bibr">Tajima 1989</xref>) or F-statistics (<xref rid="btad657-B32" ref-type="bibr">Wright 1965</xref>) can be binned and used as gene groups to weigh expression (<italic toggle="yes">get_bins</italic>).</p>
  </sec>
  <sec>
    <title>3 Case study: re-analysis of zebrafish (<italic toggle="yes">Danio rerio</italic>) and nematode (<italic toggle="yes">Caenorhabditis elegans</italic>) single-cell data</title>
    <p>To demonstrate <italic toggle="yes">oggmap</italic>, we re-analyzed a single-cell dataset of combined and integrated <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>70 000 zebrafish cells (<xref rid="btad657-B7" ref-type="bibr">Farrell <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B30" ref-type="bibr">Wagner <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>) and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>90 000 nematode cells (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>). A detailed Jupyter notebook to reproduce the case study for zebrafish (<italic toggle="yes">D.rerio</italic>) and nematode (<italic toggle="yes">C.elegans</italic>) is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <p>In brief, to obtain an <italic toggle="yes">orthomap</italic> for zebrafish, we first run OrthoFinder (-S last) (<xref rid="btad657-B13" ref-type="bibr">Kiełbasa <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) to get orthologous groups for the complete species set of Ensembl release-110. Starting from coding sequences only the longest-isoform per gene was retained and converted into amino acid sequences (<xref rid="btad657-B28" ref-type="bibr">Ullrich 2020</xref>). For nematode, a pre-existing gene age map was imported (<xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>Further, setting zebrafish as the focal species, we extracted the corresponding <italic toggle="yes">orthomap</italic> (<xref rid="btad657-F1" ref-type="fig">Fig. 1b</xref>) and highlight the number of genes per gene age class (<xref rid="btad657-F1" ref-type="fig">Fig. 1c</xref>). TEI was calculated for each cell and the distribution of TEI values visualized per developmental stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1d</xref>). As compared to the original publication, showing the hourglass model of embryonic development in zebrafish and the vertebrate phylotypic phase falling between 11- and 42-h postfertilization (hpf) (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>), the re-analysis using scRNA data shows the lowest global TAI values at the 12-h stage (12 hpf). Here, like recently shown for <italic toggle="yes">C.elegans</italic> by <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref>, this results confirms the “hourglass” pattern using embryonic zebrafish scRNA data. Researcher should now be able to investigate in more detail individual cell types that contribute to the development stages in the context of evolution (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). The stacked partial TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>) can highlight the contribution of each gene age class to the total TEI pattern. Here, the results confirm the findings of <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref> that the “youngest” genes specific to <italic toggle="yes">C.elegans</italic> and sister species (age class 11–13) peak in early embryos (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>). Following the basic tutorial of Scanpy (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to get a dimensional reduction of the given scRNA data and the Uniform Manifold Approximation and Projection (UMAP) algorithm (<xref rid="btad657-B18" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>), cells were visualized and colored by stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1f</xref>) or its corresponding TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1g</xref>).</p>
    <p>Additional downstream analysis and other species, like <italic toggle="yes">Xenopus tropicalis</italic>, <italic toggle="yes">Mus musculus</italic>, and <italic toggle="yes">Hydra vulgaris</italic>, are available via the documentation of <italic toggle="yes">oggmap</italic> at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><italic toggle="yes">oggmap</italic> is a versatile Python package to extract gene ages per orthologous group from OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>), and PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>) results and seamless integrate the resulting evolutionary age index with transcriptome data from scRNA datasets and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>). <italic toggle="yes">oggmap</italic> can help the investigator to map gene and transcript names to be able to integrate nonstandard gene annotations (e.g. for species with only transcriptome assemblies). Next to evolutionary age indices, other indices like gene adaptation scores become relevant (<xref rid="btad657-B20" ref-type="bibr">Moutinho <italic toggle="yes">et al.</italic> 2022</xref>) and can be used to calculate TEI to look into cell-type specific pattern. With <italic toggle="yes">oggmap</italic>, evolutionary biologist, medical research data analysts, and the up-rising community of single-cell data researchers will be able to enrich their scRNA data by another layer, namely evolution.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad657_Supplementary_Data</label>
      <media xlink:href="btad657_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Julien Y. Dutheil for discussions on this project.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>K.K.U and N.E.G. wrote oggmap. K.K.U. analyzed the results. K.K.U. and N.E.G. wrote and reviewed the manuscript.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Max Planck Society (to K.K.U.); the European Research Council Starting Grant [850529] (E-DIRECT) to Christian Hilbe (to N.E.G.).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) results for Ensembl release-110, including species taxonomic IDs, are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. For each species of the eggNOG database v6.0 (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) and each species of the PLAZA database v5.0 (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>), an <italic toggle="yes">orthomap</italic> is available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. scRNA data for zebrafish (<italic toggle="yes">Danio rerio</italic>), frog (<italic toggle="yes">Xenopus tropicalis</italic>), and mouse (<italic toggle="yes">Mus musculus</italic>) were obtained from <ext-link xlink:href="http://tome.gs.washington.edu/" ext-link-type="uri">https://tome.gs.washington.edu</ext-link>(<xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>), converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7243602" ext-link-type="uri">https://doi.org/10.5281/zenodo.7243602</ext-link>, <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244440" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244440</ext-link>, and <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244567" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244567</ext-link>. scRNA data for <italic toggle="yes">Caenorhabditis elegans</italic> (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>) were obtained from <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link> using the accession number GSE126954, converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7245548" ext-link-type="uri">https://doi.org/10.5281/zenodo.7245548</ext-link>. Precalculated gene age assignments were obtained from <xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> (2021)</xref>. Precalculated gene adaptation indices were obtained from <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> (2021)</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad657-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cazet</surname><given-names>J</given-names></string-name>, <string-name><surname>Siebert</surname><given-names>S</given-names></string-name>, <string-name><surname>Little</surname><given-names>HM</given-names></string-name></person-group><etal>et al</etal> New hydra genomes reveal conserved principles of hydrozoan transcriptional regulation. bioRxiv, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Brajković</surname><given-names>J</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylostratigraphy approach to uncover the genomic history of major adaptations in metazoan lineages</article-title>. <source>Trends Genet</source><year>2007</year>;<volume>23</volume>:<fpage>533</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18029048</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns</article-title>. <source>Nature</source><year>2010</year>;<volume>468</volume>:<fpage>815</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21150997</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Grosse</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Evidence for active maintenance of phylotranscriptomic hourglass patterns in animal and plant embryogenesis</article-title>. <source>Mol Biol Evol</source><year>2015</year>;<volume>32</volume>:<fpage>1221</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">25631928</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>myTAI: evolutionary transcriptomics with R</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1589</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">29309527</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>DM</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farrell</surname><given-names>JA</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Riesenfeld</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>eaar3131</fpage>.<pub-id pub-id-type="pmid">29700225</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gossmann</surname><given-names>TI</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>D</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>MW</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptomes of plant gametophytes have a higher proportion of rapidly evolving and young genes than sporophytes</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1669</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">26956888</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>CR</given-names></string-name>, <string-name><surname>Millman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Van Der Walt</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Array programming with NumPy</article-title>. <source>Nature</source><year>2020</year>;<volume>585</volume>:<fpage>357</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hernández-Plaza</surname><given-names>A</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Botas</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>EggNOG 6.0: enabling comparative genomics across 12 535 organisms</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D389</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">36399505</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1635</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Julca</surname><given-names>I</given-names></string-name>, <string-name><surname>Ferrari</surname><given-names>C</given-names></string-name>, <string-name><surname>Flores-Tornero</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Comparative transcriptomic analysis reveals conserved programmes underpinning organogenesis and reproduction in land plants</article-title>. <source>Nat Plants</source><year>2021</year>;<volume>7</volume>:<fpage>1143</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">34253868</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source><year>2011</year>;<volume>21</volume>:<fpage>487</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Frochaux</surname><given-names>M</given-names></string-name>, <string-name><surname>Gardeux</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Inter-embryo gene expression variability recapitulates the hourglass pattern of evo-devo</article-title>. <source>BMC Biol</source><year>2020</year>;<volume>18</volume>:<fpage>129</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">32950053</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname><given-names>M.</given-names></string-name></person-group><article-title>Developmental constraints on genome evolution in four bilaterian model species</article-title>. <source>Genome Biol Evol</source><year>2018</year>;<volume>10</volume>:<fpage>2266</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">30137380</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Lau</surname><given-names>CY</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Large genetic diversity and strong positive selection in F-box and GPCR genes among the wild isolates of <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Genome Biol Evol</source><year>2021</year>;<volume>13</volume>:<fpage>evab048</fpage>.<pub-id pub-id-type="pmid">33693740</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Transcriptome age of individual cell types in <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Proc Natl Acad Sci USA</source><year>2023</year>;<volume>120</volume>:<fpage>e2216351120</fpage>.<pub-id pub-id-type="pmid">36812209</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> UMAP: Uniform Manifold Approximation and Projection for dimension reduction. arXiv, arXiv:1802.03426, <year>2018</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W.</given-names></string-name></person-group><article-title>pandas: a foundational Python library for data analysis and statistics</article-title>. <source>Python for High Performance and Scientific Computing</source><year>2011</year>;<volume>14</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moutinho</surname><given-names>AF</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A</given-names></string-name>, <string-name><surname>Dutheil</surname><given-names>JY.</given-names></string-name></person-group><article-title>Strong evidence for the adaptive walk model of gene evolution in <italic toggle="yes">Drosophila</italic> and <italic toggle="yes">Arabidopsis</italic></article-title>. <source>PLoS Biol</source><year>2022</year>;<volume>20</volume>:<fpage>e3001775</fpage>.<pub-id pub-id-type="pmid">36099311</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Packer</surname><given-names>JS</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huynh</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>A lineage-resolved molecular atlas of <italic toggle="yes">C. elegans</italic> embryogenesis at single-cell resolution</article-title>. <source>Science</source><year>2019</year>;<volume>365</volume>:<fpage>eaax1971</fpage>.<pub-id pub-id-type="pmid">31488706</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>C</given-names></string-name>, <string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Martin</surname><given-names>BK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic reconstruction of cellular trajectories across mouse embryogenesis</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>328</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35288709</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quint</surname><given-names>M</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A transcriptomic hourglass in plant embryogenesis</article-title>. <source>Nature</source><year>2012</year>;<volume>490</volume>:<fpage>98</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">22951968</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruprecht</surname><given-names>C</given-names></string-name>, <string-name><surname>Proost</surname><given-names>S</given-names></string-name>, <string-name><surname>Hernandez-Coronado</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenomic analysis of gene co-expression networks reveals the evolution of functional modules</article-title>. <source>Plant J</source><year>2017</year>;<volume>90</volume>:<fpage>447</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">28161902</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Rödelsperger</surname><given-names>C</given-names></string-name>, <string-name><surname>Sommer</surname><given-names>RJ.</given-names></string-name></person-group><article-title>Single worm transcriptomics identifies a developmental core network of oscillating genes with deep conservation across nematodes</article-title>. <source>Genome Res</source><year>2021</year>;<volume>31</volume>:<fpage>1590</fpage>–<lpage>601</lpage>.<pub-id pub-id-type="pmid">34301622</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tajima</surname><given-names>F.</given-names></string-name></person-group><article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title>. <source>Genetics</source><year>1989</year>;<volume>123</volume>:<fpage>585</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">2513255</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarashansky</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Khariton</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping single-cell atlases throughout metazoa unravels cell type evolution</article-title>. <source>Elife</source><year>2021</year>;<volume>10</volume>:<fpage>e66747</fpage>.<pub-id pub-id-type="pmid">33944782</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ullrich</surname><given-names>KK.</given-names></string-name></person-group><article-title>CRBHits: from conditional reciprocal best hits to codon alignments and Ka/Ks in R</article-title>. <source>J Open Source Softw</source><year>2020</year>;<volume>5</volume>:<fpage>2424</fpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Bel</surname><given-names>M</given-names></string-name>, <string-name><surname>Silvestri</surname><given-names>F</given-names></string-name>, <string-name><surname>Weitz</surname><given-names>EM</given-names></string-name></person-group><etal>et al</etal><article-title>PLAZA 5.0: extending the scope and power of comparative and functional genomics in plants</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>D1468</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">34747486</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>DE</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C</given-names></string-name>, <string-name><surname>Collins</surname><given-names>ZM</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>981</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29700229</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><article-title>The interpretation of population structure by F-statistics with special regard to systems of mating</article-title>. <source>Evolution</source><year>1965</year>;<volume>19</volume>:<fpage>395</fpage>–<lpage>420</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10663984</article-id>
    <article-id pub-id-type="pmid">37952198</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad657</article-id>
    <article-id pub-id-type="publisher-id">btad657</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>oggmap: a Python package to extract gene ages per orthogroup and link them with single-cell RNA data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4308-9626</contrib-id>
        <name>
          <surname>Ullrich</surname>
          <given-names>Kristian K</given-names>
        </name>
        <aff><institution>Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
        <xref rid="btad657-cor1" ref-type="corresp"/>
        <!--ullrich@evolbio.mpg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2943-3622</contrib-id>
        <name>
          <surname>Glytnasi</surname>
          <given-names>Nikoleta E</given-names>
        </name>
        <aff><institution>Max Planck Research Group: Dynamics of Social Behavior, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad657-cor1">Corresponding author. Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology, August Thienemann Str. 2, 24306 Plön, Germany. E-mail: <email>ullrich@evolbio.mpg.de</email> (K.K.U.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-11">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad657</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad657.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>For model species, single-cell RNA-based cell atlases are available. A good cell atlas includes all major stages in a species’ ontogeny, and soon, they will be standard even for nonmodel species. Here, we propose a Python package called <italic toggle="yes">oggmap</italic>, which allows for the easy extraction of an orthomap (gene ages per orthogroup) for any given query species from OrthoFinder and other gene family data resources, like homologous groups from eggNOG or PLAZA. <italic toggle="yes">oggmap</italic> provides extracted gene ages for more than thousand eukaryotic species which can be further used to calculate gene age-weighted expression data from scRNA sequencing objects using the Python Scanpy toolkit. Not limited to one transcriptome evolutionary index, <italic toggle="yes">oggmap</italic> can visualize the individual gene category (e.g. age class, nucleotide diversity bin) and their corresponding expression profiles to investigate scRNA-based cell type assignments in an evolutionary context.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">oggmap</italic> source code is available at <ext-link xlink:href="https://github.com/kullrich/oggmap" ext-link-type="uri">https://github.com/kullrich/oggmap</ext-link>, documentation is available at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>. <italic toggle="yes">oggmap</italic> can be installed via PyPi or directly used via a docker container.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council Starting</institution>
          </institution-wrap>
        </funding-source>
        <award-id>850529</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, the availability of single-cell RNA (scRNA) sequencing data and its analysis tools has constantly been on the rise. However, using phylogenetic information with scRNA data to, e.g. better predict cell types in a cross-species manner is so far sparse (<xref rid="btad657-B27" ref-type="bibr">Tarashansky <italic toggle="yes">et al.</italic> 2021</xref>). Linking gene age with RNA sequencing data to better explain the developmental stages of an organism in the context of evolution has been a topic for over a decade (<xref rid="btad657-B2" ref-type="bibr">Domazet-Lošo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi 2018</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). Methods to infer phyletic pattern of genes for a given query species are still a time-consuming step and as such a bottleneck to weight expression of a gene by its gene age. Once gene ages are inferred, the transcriptome age index (short TAI) can distinguish between a “young” and an “old” transcriptome to, e.g. investigate the hourglass model of embryonic development (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>) or to highlight cell type-specific enrichment patterns (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>). TAI calculation is already implemented in the R <italic toggle="yes">myTAI</italic> package, primarily working with bulk-RNA data (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>), so far lacking a Python supplement.</p>
    <p>Since introducing TAI, a variety of analysis types have been created to link and weight transcriptome data with an evolutionary age or a different evolutionary index, like gene substitution rates or promoter conservation score (<xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B4" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad657-B8" ref-type="bibr">Gossmann <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). As a consequence, not be limited to age, we use the parent term transcriptome evolutionary index (short TEI) as introduced by <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi (2018)</xref>. The transition of the TEI analysis from bulk-RNA data to scRNA data, which both rely on an evolutionary age category, just recently begun (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). If based on blast sequence searches, the resulting gene ages are collected for each individual gene (so-called <italic toggle="yes">phylostratigraphic maps</italic>). The age assignment is based on the “oldest” found homolog along the tree of life.</p>
    <p>In contrast to the original implementation (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>) using blast hits to extract gene ages, orthologous groups can be used (<xref rid="btad657-B24" ref-type="bibr">Ruprecht <italic toggle="yes">et al.</italic> 2017</xref>). This will assign gene ages not per gene, but will assign the same evolutionary age to all genes of a given <italic toggle="yes">orthogroup</italic>. It is important to note that to extract the gene age for a given <italic toggle="yes">orthogroup</italic>, one needs to define a query species to start from (sometimes called focal species). Given a query species, all other species members of the same <italic toggle="yes">orthogroup</italic> are compared using a species tree to extract the lowest common ancestor (LCA). In other words, the deepest node from the query species tip to the root node or the last universal common ancestor of the species tree (<xref rid="btad657-B12" ref-type="bibr">Julca <italic toggle="yes">et al.</italic> 2021</xref>). We call the resulting gene age classification <italic toggle="yes"><bold>o</bold>rtholo<bold>g</bold>ous</italic><italic toggle="yes"><bold>g</bold>roups</italic><bold><italic toggle="yes">map</italic></bold> (short <italic toggle="yes">orthomap</italic>).</p>
  </sec>
  <sec>
    <title>2 Oggmap implementation</title>
    <p><italic toggle="yes">oggmap</italic> (implemented in Python) uses different bioinformatic methods for importing, analyzing, and visualizing. All main steps of <italic toggle="yes">oggmap</italic> are illustrated in <xref rid="btad657-F1" ref-type="fig">Fig. 1a</xref>. The documentation of <italic toggle="yes">oggmap</italic> will guide the user through all necessary steps. <italic toggle="yes">oggmap</italic> relies on orthogroups and can parse so far results from either OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), or precalculated gene family databases, like eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) or PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>). <italic toggle="yes">oggmap</italic> provides gene age class assignments for a high number of species (Ensembl release-110: 317; eggNOG v6: 1322, PLAZA v5: 98 dicots and 52 monocots), so that a researcher might start directly to analyze scRNA data for a given query species of interest. If the query species is not among them, the guide will help how to perform the mandatory step 0. All further steps to create an <italic toggle="yes">orthomap</italic> (steps 1 and 2) can be run on command line as well as using the Python API. Given a query species, the taxonomic lineage information will be used (<italic toggle="yes">qlin module</italic>) to assign an age class per <italic toggle="yes">orthogroup</italic> based on the LCA (<italic toggle="yes">of2orthomap module</italic>). Internally, these steps use the Python toolkit <italic toggle="yes">ete3</italic> (<xref rid="btad657-B11" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic> 2016</xref>) to fetch NCBI taxonomic tree information. In addition, for each <italic toggle="yes">orthogroup</italic> a continuity score can be optionally calculated, which represents the species completeness along the tree nodes from the LCA to the focal species. A low continuity score would thereby highlight, e.g. a possible horizontal gene transfer event, where intermediate tree nodes lack any detectable <italic toggle="yes">orthologs</italic>. All further steps (3, 4, and downstream analysis 5) to match gene names from the <italic toggle="yes">orthomap</italic> and scRNA data (in case of different annotation source; <italic toggle="yes">gtf2t2g module</italic>), calculate TEI, and visualizing the results (<italic toggle="yes">orthomap2tei module</italic>) are run with the Python API in, e.g. a Jupyter notebook (<xref rid="btad657-F1" ref-type="fig">Fig. 1b–g</xref>). Internally, NumPy (<xref rid="btad657-B9" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2020</xref>), pandas <italic toggle="yes">DataFrame</italic> objects (<xref rid="btad657-B19" ref-type="bibr">McKinney <italic toggle="yes">et al.</italic> 2011</xref>), and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) with <italic toggle="yes">AnnData</italic> objects are the working horses.</p>
    <fig position="float" id="btad657-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(a) Overview of <italic toggle="yes">oggmap</italic> steps. (b) <italic toggle="yes">Orthomap</italic> for the query species zebrafish (<italic toggle="yes">Danio rerio</italic>). Each gene (seqID) from an Orthogroup is assigned to a gene age class (PSnum, PSname) given a continuity score (PScontinuity). (c) Number of genes per gene age class. (d) Boxplot of zebrafish (<italic toggle="yes">D.rerio</italic>) TEI values grouped per embryo stage. (e) Contribution of gene age classes to the global TEI per embryo time (nematode). Zebrafish scRNA data UMAP, each cell is colored by embryo stage (f) or its corresponding TEI value (g).</p>
      </caption>
      <graphic xlink:href="btad657f1" position="float"/>
    </fig>
    <p>Dealing with scRNA data introduces a computational burden to TEI calculation, since unlike for bulk-RNA data with a rather low number of stages, now thousand of cells need to be processed. TEI is implemented as given in <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz (2010)</xref> and due to sparse-matrix calculation scales for millions of cells. TEI represents the weighted arithmetic mean (expression levels as weights for the age category) over all evolutionary age categories denoted as <italic toggle="yes">phylostra</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>*</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the TEI value in a cell or a cell type <italic toggle="yes">c</italic>, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the gene expression level of gene <italic toggle="yes">i</italic> in cell <italic toggle="yes">c</italic>, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the corresponding <italic toggle="yes">phylostratum</italic> of gene <italic toggle="yes">i</italic>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">N</italic> is the total number of genes.</p>
    <p>Next to adding TEI values to scRNA data (<italic toggle="yes">get_tei</italic>), other useful function from the <italic toggle="yes">myTAI</italic> R package (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>) has been ported to Python and extended to deal with cell-type groups. For example, one can calculate partial TEI values (<italic toggle="yes">get_pstrata</italic>) to visualize the contribution of each gene age class to the global TEI pattern. Or extract the relative expression per gene age class grouped by any annotated observation like cell-type or sampling timepoint starting either from raw counts or using the implemented expression transformation options (<italic toggle="yes">get_rematrix</italic>). Other gene based metric, like Tajima’s D (<xref rid="btad657-B26" ref-type="bibr">Tajima 1989</xref>) or F-statistics (<xref rid="btad657-B32" ref-type="bibr">Wright 1965</xref>) can be binned and used as gene groups to weigh expression (<italic toggle="yes">get_bins</italic>).</p>
  </sec>
  <sec>
    <title>3 Case study: re-analysis of zebrafish (<italic toggle="yes">Danio rerio</italic>) and nematode (<italic toggle="yes">Caenorhabditis elegans</italic>) single-cell data</title>
    <p>To demonstrate <italic toggle="yes">oggmap</italic>, we re-analyzed a single-cell dataset of combined and integrated <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>70 000 zebrafish cells (<xref rid="btad657-B7" ref-type="bibr">Farrell <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B30" ref-type="bibr">Wagner <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>) and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>90 000 nematode cells (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>). A detailed Jupyter notebook to reproduce the case study for zebrafish (<italic toggle="yes">D.rerio</italic>) and nematode (<italic toggle="yes">C.elegans</italic>) is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <p>In brief, to obtain an <italic toggle="yes">orthomap</italic> for zebrafish, we first run OrthoFinder (-S last) (<xref rid="btad657-B13" ref-type="bibr">Kiełbasa <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) to get orthologous groups for the complete species set of Ensembl release-110. Starting from coding sequences only the longest-isoform per gene was retained and converted into amino acid sequences (<xref rid="btad657-B28" ref-type="bibr">Ullrich 2020</xref>). For nematode, a pre-existing gene age map was imported (<xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>Further, setting zebrafish as the focal species, we extracted the corresponding <italic toggle="yes">orthomap</italic> (<xref rid="btad657-F1" ref-type="fig">Fig. 1b</xref>) and highlight the number of genes per gene age class (<xref rid="btad657-F1" ref-type="fig">Fig. 1c</xref>). TEI was calculated for each cell and the distribution of TEI values visualized per developmental stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1d</xref>). As compared to the original publication, showing the hourglass model of embryonic development in zebrafish and the vertebrate phylotypic phase falling between 11- and 42-h postfertilization (hpf) (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>), the re-analysis using scRNA data shows the lowest global TAI values at the 12-h stage (12 hpf). Here, like recently shown for <italic toggle="yes">C.elegans</italic> by <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref>, this results confirms the “hourglass” pattern using embryonic zebrafish scRNA data. Researcher should now be able to investigate in more detail individual cell types that contribute to the development stages in the context of evolution (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). The stacked partial TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>) can highlight the contribution of each gene age class to the total TEI pattern. Here, the results confirm the findings of <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref> that the “youngest” genes specific to <italic toggle="yes">C.elegans</italic> and sister species (age class 11–13) peak in early embryos (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>). Following the basic tutorial of Scanpy (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to get a dimensional reduction of the given scRNA data and the Uniform Manifold Approximation and Projection (UMAP) algorithm (<xref rid="btad657-B18" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>), cells were visualized and colored by stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1f</xref>) or its corresponding TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1g</xref>).</p>
    <p>Additional downstream analysis and other species, like <italic toggle="yes">Xenopus tropicalis</italic>, <italic toggle="yes">Mus musculus</italic>, and <italic toggle="yes">Hydra vulgaris</italic>, are available via the documentation of <italic toggle="yes">oggmap</italic> at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><italic toggle="yes">oggmap</italic> is a versatile Python package to extract gene ages per orthologous group from OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>), and PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>) results and seamless integrate the resulting evolutionary age index with transcriptome data from scRNA datasets and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>). <italic toggle="yes">oggmap</italic> can help the investigator to map gene and transcript names to be able to integrate nonstandard gene annotations (e.g. for species with only transcriptome assemblies). Next to evolutionary age indices, other indices like gene adaptation scores become relevant (<xref rid="btad657-B20" ref-type="bibr">Moutinho <italic toggle="yes">et al.</italic> 2022</xref>) and can be used to calculate TEI to look into cell-type specific pattern. With <italic toggle="yes">oggmap</italic>, evolutionary biologist, medical research data analysts, and the up-rising community of single-cell data researchers will be able to enrich their scRNA data by another layer, namely evolution.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad657_Supplementary_Data</label>
      <media xlink:href="btad657_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Julien Y. Dutheil for discussions on this project.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>K.K.U and N.E.G. wrote oggmap. K.K.U. analyzed the results. K.K.U. and N.E.G. wrote and reviewed the manuscript.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Max Planck Society (to K.K.U.); the European Research Council Starting Grant [850529] (E-DIRECT) to Christian Hilbe (to N.E.G.).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) results for Ensembl release-110, including species taxonomic IDs, are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. For each species of the eggNOG database v6.0 (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) and each species of the PLAZA database v5.0 (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>), an <italic toggle="yes">orthomap</italic> is available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. scRNA data for zebrafish (<italic toggle="yes">Danio rerio</italic>), frog (<italic toggle="yes">Xenopus tropicalis</italic>), and mouse (<italic toggle="yes">Mus musculus</italic>) were obtained from <ext-link xlink:href="http://tome.gs.washington.edu/" ext-link-type="uri">https://tome.gs.washington.edu</ext-link>(<xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>), converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7243602" ext-link-type="uri">https://doi.org/10.5281/zenodo.7243602</ext-link>, <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244440" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244440</ext-link>, and <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244567" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244567</ext-link>. scRNA data for <italic toggle="yes">Caenorhabditis elegans</italic> (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>) were obtained from <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link> using the accession number GSE126954, converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7245548" ext-link-type="uri">https://doi.org/10.5281/zenodo.7245548</ext-link>. Precalculated gene age assignments were obtained from <xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> (2021)</xref>. Precalculated gene adaptation indices were obtained from <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> (2021)</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad657-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cazet</surname><given-names>J</given-names></string-name>, <string-name><surname>Siebert</surname><given-names>S</given-names></string-name>, <string-name><surname>Little</surname><given-names>HM</given-names></string-name></person-group><etal>et al</etal> New hydra genomes reveal conserved principles of hydrozoan transcriptional regulation. bioRxiv, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Brajković</surname><given-names>J</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylostratigraphy approach to uncover the genomic history of major adaptations in metazoan lineages</article-title>. <source>Trends Genet</source><year>2007</year>;<volume>23</volume>:<fpage>533</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18029048</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns</article-title>. <source>Nature</source><year>2010</year>;<volume>468</volume>:<fpage>815</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21150997</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Grosse</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Evidence for active maintenance of phylotranscriptomic hourglass patterns in animal and plant embryogenesis</article-title>. <source>Mol Biol Evol</source><year>2015</year>;<volume>32</volume>:<fpage>1221</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">25631928</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>myTAI: evolutionary transcriptomics with R</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1589</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">29309527</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>DM</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farrell</surname><given-names>JA</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Riesenfeld</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>eaar3131</fpage>.<pub-id pub-id-type="pmid">29700225</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gossmann</surname><given-names>TI</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>D</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>MW</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptomes of plant gametophytes have a higher proportion of rapidly evolving and young genes than sporophytes</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1669</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">26956888</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>CR</given-names></string-name>, <string-name><surname>Millman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Van Der Walt</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Array programming with NumPy</article-title>. <source>Nature</source><year>2020</year>;<volume>585</volume>:<fpage>357</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hernández-Plaza</surname><given-names>A</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Botas</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>EggNOG 6.0: enabling comparative genomics across 12 535 organisms</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D389</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">36399505</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1635</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Julca</surname><given-names>I</given-names></string-name>, <string-name><surname>Ferrari</surname><given-names>C</given-names></string-name>, <string-name><surname>Flores-Tornero</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Comparative transcriptomic analysis reveals conserved programmes underpinning organogenesis and reproduction in land plants</article-title>. <source>Nat Plants</source><year>2021</year>;<volume>7</volume>:<fpage>1143</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">34253868</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source><year>2011</year>;<volume>21</volume>:<fpage>487</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Frochaux</surname><given-names>M</given-names></string-name>, <string-name><surname>Gardeux</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Inter-embryo gene expression variability recapitulates the hourglass pattern of evo-devo</article-title>. <source>BMC Biol</source><year>2020</year>;<volume>18</volume>:<fpage>129</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">32950053</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname><given-names>M.</given-names></string-name></person-group><article-title>Developmental constraints on genome evolution in four bilaterian model species</article-title>. <source>Genome Biol Evol</source><year>2018</year>;<volume>10</volume>:<fpage>2266</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">30137380</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Lau</surname><given-names>CY</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Large genetic diversity and strong positive selection in F-box and GPCR genes among the wild isolates of <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Genome Biol Evol</source><year>2021</year>;<volume>13</volume>:<fpage>evab048</fpage>.<pub-id pub-id-type="pmid">33693740</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Transcriptome age of individual cell types in <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Proc Natl Acad Sci USA</source><year>2023</year>;<volume>120</volume>:<fpage>e2216351120</fpage>.<pub-id pub-id-type="pmid">36812209</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> UMAP: Uniform Manifold Approximation and Projection for dimension reduction. arXiv, arXiv:1802.03426, <year>2018</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W.</given-names></string-name></person-group><article-title>pandas: a foundational Python library for data analysis and statistics</article-title>. <source>Python for High Performance and Scientific Computing</source><year>2011</year>;<volume>14</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moutinho</surname><given-names>AF</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A</given-names></string-name>, <string-name><surname>Dutheil</surname><given-names>JY.</given-names></string-name></person-group><article-title>Strong evidence for the adaptive walk model of gene evolution in <italic toggle="yes">Drosophila</italic> and <italic toggle="yes">Arabidopsis</italic></article-title>. <source>PLoS Biol</source><year>2022</year>;<volume>20</volume>:<fpage>e3001775</fpage>.<pub-id pub-id-type="pmid">36099311</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Packer</surname><given-names>JS</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huynh</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>A lineage-resolved molecular atlas of <italic toggle="yes">C. elegans</italic> embryogenesis at single-cell resolution</article-title>. <source>Science</source><year>2019</year>;<volume>365</volume>:<fpage>eaax1971</fpage>.<pub-id pub-id-type="pmid">31488706</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>C</given-names></string-name>, <string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Martin</surname><given-names>BK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic reconstruction of cellular trajectories across mouse embryogenesis</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>328</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35288709</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quint</surname><given-names>M</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A transcriptomic hourglass in plant embryogenesis</article-title>. <source>Nature</source><year>2012</year>;<volume>490</volume>:<fpage>98</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">22951968</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruprecht</surname><given-names>C</given-names></string-name>, <string-name><surname>Proost</surname><given-names>S</given-names></string-name>, <string-name><surname>Hernandez-Coronado</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenomic analysis of gene co-expression networks reveals the evolution of functional modules</article-title>. <source>Plant J</source><year>2017</year>;<volume>90</volume>:<fpage>447</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">28161902</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Rödelsperger</surname><given-names>C</given-names></string-name>, <string-name><surname>Sommer</surname><given-names>RJ.</given-names></string-name></person-group><article-title>Single worm transcriptomics identifies a developmental core network of oscillating genes with deep conservation across nematodes</article-title>. <source>Genome Res</source><year>2021</year>;<volume>31</volume>:<fpage>1590</fpage>–<lpage>601</lpage>.<pub-id pub-id-type="pmid">34301622</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tajima</surname><given-names>F.</given-names></string-name></person-group><article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title>. <source>Genetics</source><year>1989</year>;<volume>123</volume>:<fpage>585</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">2513255</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarashansky</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Khariton</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping single-cell atlases throughout metazoa unravels cell type evolution</article-title>. <source>Elife</source><year>2021</year>;<volume>10</volume>:<fpage>e66747</fpage>.<pub-id pub-id-type="pmid">33944782</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ullrich</surname><given-names>KK.</given-names></string-name></person-group><article-title>CRBHits: from conditional reciprocal best hits to codon alignments and Ka/Ks in R</article-title>. <source>J Open Source Softw</source><year>2020</year>;<volume>5</volume>:<fpage>2424</fpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Bel</surname><given-names>M</given-names></string-name>, <string-name><surname>Silvestri</surname><given-names>F</given-names></string-name>, <string-name><surname>Weitz</surname><given-names>EM</given-names></string-name></person-group><etal>et al</etal><article-title>PLAZA 5.0: extending the scope and power of comparative and functional genomics in plants</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>D1468</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">34747486</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>DE</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C</given-names></string-name>, <string-name><surname>Collins</surname><given-names>ZM</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>981</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29700229</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><article-title>The interpretation of population structure by F-statistics with special regard to systems of mating</article-title>. <source>Evolution</source><year>1965</year>;<volume>19</volume>:<fpage>395</fpage>–<lpage>420</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10663984</article-id>
    <article-id pub-id-type="pmid">37952198</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad657</article-id>
    <article-id pub-id-type="publisher-id">btad657</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>oggmap: a Python package to extract gene ages per orthogroup and link them with single-cell RNA data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4308-9626</contrib-id>
        <name>
          <surname>Ullrich</surname>
          <given-names>Kristian K</given-names>
        </name>
        <aff><institution>Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
        <xref rid="btad657-cor1" ref-type="corresp"/>
        <!--ullrich@evolbio.mpg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2943-3622</contrib-id>
        <name>
          <surname>Glytnasi</surname>
          <given-names>Nikoleta E</given-names>
        </name>
        <aff><institution>Max Planck Research Group: Dynamics of Social Behavior, Max Planck Institute for Evolutionary Biology</institution>, 24306 Plön, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad657-cor1">Corresponding author. Department for Evolutionary Genetics, Max Planck Institute for Evolutionary Biology, August Thienemann Str. 2, 24306 Plön, Germany. E-mail: <email>ullrich@evolbio.mpg.de</email> (K.K.U.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-11">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad657</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad657.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>For model species, single-cell RNA-based cell atlases are available. A good cell atlas includes all major stages in a species’ ontogeny, and soon, they will be standard even for nonmodel species. Here, we propose a Python package called <italic toggle="yes">oggmap</italic>, which allows for the easy extraction of an orthomap (gene ages per orthogroup) for any given query species from OrthoFinder and other gene family data resources, like homologous groups from eggNOG or PLAZA. <italic toggle="yes">oggmap</italic> provides extracted gene ages for more than thousand eukaryotic species which can be further used to calculate gene age-weighted expression data from scRNA sequencing objects using the Python Scanpy toolkit. Not limited to one transcriptome evolutionary index, <italic toggle="yes">oggmap</italic> can visualize the individual gene category (e.g. age class, nucleotide diversity bin) and their corresponding expression profiles to investigate scRNA-based cell type assignments in an evolutionary context.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">oggmap</italic> source code is available at <ext-link xlink:href="https://github.com/kullrich/oggmap" ext-link-type="uri">https://github.com/kullrich/oggmap</ext-link>, documentation is available at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>. <italic toggle="yes">oggmap</italic> can be installed via PyPi or directly used via a docker container.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council Starting</institution>
          </institution-wrap>
        </funding-source>
        <award-id>850529</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, the availability of single-cell RNA (scRNA) sequencing data and its analysis tools has constantly been on the rise. However, using phylogenetic information with scRNA data to, e.g. better predict cell types in a cross-species manner is so far sparse (<xref rid="btad657-B27" ref-type="bibr">Tarashansky <italic toggle="yes">et al.</italic> 2021</xref>). Linking gene age with RNA sequencing data to better explain the developmental stages of an organism in the context of evolution has been a topic for over a decade (<xref rid="btad657-B2" ref-type="bibr">Domazet-Lošo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi 2018</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). Methods to infer phyletic pattern of genes for a given query species are still a time-consuming step and as such a bottleneck to weight expression of a gene by its gene age. Once gene ages are inferred, the transcriptome age index (short TAI) can distinguish between a “young” and an “old” transcriptome to, e.g. investigate the hourglass model of embryonic development (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>) or to highlight cell type-specific enrichment patterns (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>). TAI calculation is already implemented in the R <italic toggle="yes">myTAI</italic> package, primarily working with bulk-RNA data (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>), so far lacking a Python supplement.</p>
    <p>Since introducing TAI, a variety of analysis types have been created to link and weight transcriptome data with an evolutionary age or a different evolutionary index, like gene substitution rates or promoter conservation score (<xref rid="btad657-B23" ref-type="bibr">Quint <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad657-B4" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad657-B8" ref-type="bibr">Gossmann <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad657-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). As a consequence, not be limited to age, we use the parent term transcriptome evolutionary index (short TEI) as introduced by <xref rid="btad657-B15" ref-type="bibr">Liu and Robinson-Rechavi (2018)</xref>. The transition of the TEI analysis from bulk-RNA data to scRNA data, which both rely on an evolutionary age category, just recently begun (<xref rid="btad657-B1" ref-type="bibr">Cazet <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng 2023</xref>). If based on blast sequence searches, the resulting gene ages are collected for each individual gene (so-called <italic toggle="yes">phylostratigraphic maps</italic>). The age assignment is based on the “oldest” found homolog along the tree of life.</p>
    <p>In contrast to the original implementation (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>) using blast hits to extract gene ages, orthologous groups can be used (<xref rid="btad657-B24" ref-type="bibr">Ruprecht <italic toggle="yes">et al.</italic> 2017</xref>). This will assign gene ages not per gene, but will assign the same evolutionary age to all genes of a given <italic toggle="yes">orthogroup</italic>. It is important to note that to extract the gene age for a given <italic toggle="yes">orthogroup</italic>, one needs to define a query species to start from (sometimes called focal species). Given a query species, all other species members of the same <italic toggle="yes">orthogroup</italic> are compared using a species tree to extract the lowest common ancestor (LCA). In other words, the deepest node from the query species tip to the root node or the last universal common ancestor of the species tree (<xref rid="btad657-B12" ref-type="bibr">Julca <italic toggle="yes">et al.</italic> 2021</xref>). We call the resulting gene age classification <italic toggle="yes"><bold>o</bold>rtholo<bold>g</bold>ous</italic><italic toggle="yes"><bold>g</bold>roups</italic><bold><italic toggle="yes">map</italic></bold> (short <italic toggle="yes">orthomap</italic>).</p>
  </sec>
  <sec>
    <title>2 Oggmap implementation</title>
    <p><italic toggle="yes">oggmap</italic> (implemented in Python) uses different bioinformatic methods for importing, analyzing, and visualizing. All main steps of <italic toggle="yes">oggmap</italic> are illustrated in <xref rid="btad657-F1" ref-type="fig">Fig. 1a</xref>. The documentation of <italic toggle="yes">oggmap</italic> will guide the user through all necessary steps. <italic toggle="yes">oggmap</italic> relies on orthogroups and can parse so far results from either OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), or precalculated gene family databases, like eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) or PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>). <italic toggle="yes">oggmap</italic> provides gene age class assignments for a high number of species (Ensembl release-110: 317; eggNOG v6: 1322, PLAZA v5: 98 dicots and 52 monocots), so that a researcher might start directly to analyze scRNA data for a given query species of interest. If the query species is not among them, the guide will help how to perform the mandatory step 0. All further steps to create an <italic toggle="yes">orthomap</italic> (steps 1 and 2) can be run on command line as well as using the Python API. Given a query species, the taxonomic lineage information will be used (<italic toggle="yes">qlin module</italic>) to assign an age class per <italic toggle="yes">orthogroup</italic> based on the LCA (<italic toggle="yes">of2orthomap module</italic>). Internally, these steps use the Python toolkit <italic toggle="yes">ete3</italic> (<xref rid="btad657-B11" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic> 2016</xref>) to fetch NCBI taxonomic tree information. In addition, for each <italic toggle="yes">orthogroup</italic> a continuity score can be optionally calculated, which represents the species completeness along the tree nodes from the LCA to the focal species. A low continuity score would thereby highlight, e.g. a possible horizontal gene transfer event, where intermediate tree nodes lack any detectable <italic toggle="yes">orthologs</italic>. All further steps (3, 4, and downstream analysis 5) to match gene names from the <italic toggle="yes">orthomap</italic> and scRNA data (in case of different annotation source; <italic toggle="yes">gtf2t2g module</italic>), calculate TEI, and visualizing the results (<italic toggle="yes">orthomap2tei module</italic>) are run with the Python API in, e.g. a Jupyter notebook (<xref rid="btad657-F1" ref-type="fig">Fig. 1b–g</xref>). Internally, NumPy (<xref rid="btad657-B9" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2020</xref>), pandas <italic toggle="yes">DataFrame</italic> objects (<xref rid="btad657-B19" ref-type="bibr">McKinney <italic toggle="yes">et al.</italic> 2011</xref>), and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) with <italic toggle="yes">AnnData</italic> objects are the working horses.</p>
    <fig position="float" id="btad657-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(a) Overview of <italic toggle="yes">oggmap</italic> steps. (b) <italic toggle="yes">Orthomap</italic> for the query species zebrafish (<italic toggle="yes">Danio rerio</italic>). Each gene (seqID) from an Orthogroup is assigned to a gene age class (PSnum, PSname) given a continuity score (PScontinuity). (c) Number of genes per gene age class. (d) Boxplot of zebrafish (<italic toggle="yes">D.rerio</italic>) TEI values grouped per embryo stage. (e) Contribution of gene age classes to the global TEI per embryo time (nematode). Zebrafish scRNA data UMAP, each cell is colored by embryo stage (f) or its corresponding TEI value (g).</p>
      </caption>
      <graphic xlink:href="btad657f1" position="float"/>
    </fig>
    <p>Dealing with scRNA data introduces a computational burden to TEI calculation, since unlike for bulk-RNA data with a rather low number of stages, now thousand of cells need to be processed. TEI is implemented as given in <xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz (2010)</xref> and due to sparse-matrix calculation scales for millions of cells. TEI represents the weighted arithmetic mean (expression levels as weights for the age category) over all evolutionary age categories denoted as <italic toggle="yes">phylostra</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>*</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>TEI</mml:mtext></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the TEI value in a cell or a cell type <italic toggle="yes">c</italic>, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the gene expression level of gene <italic toggle="yes">i</italic> in cell <italic toggle="yes">c</italic>, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the corresponding <italic toggle="yes">phylostratum</italic> of gene <italic toggle="yes">i</italic>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">N</italic> is the total number of genes.</p>
    <p>Next to adding TEI values to scRNA data (<italic toggle="yes">get_tei</italic>), other useful function from the <italic toggle="yes">myTAI</italic> R package (<xref rid="btad657-B5" ref-type="bibr">Drost <italic toggle="yes">et al.</italic> 2018</xref>) has been ported to Python and extended to deal with cell-type groups. For example, one can calculate partial TEI values (<italic toggle="yes">get_pstrata</italic>) to visualize the contribution of each gene age class to the global TEI pattern. Or extract the relative expression per gene age class grouped by any annotated observation like cell-type or sampling timepoint starting either from raw counts or using the implemented expression transformation options (<italic toggle="yes">get_rematrix</italic>). Other gene based metric, like Tajima’s D (<xref rid="btad657-B26" ref-type="bibr">Tajima 1989</xref>) or F-statistics (<xref rid="btad657-B32" ref-type="bibr">Wright 1965</xref>) can be binned and used as gene groups to weigh expression (<italic toggle="yes">get_bins</italic>).</p>
  </sec>
  <sec>
    <title>3 Case study: re-analysis of zebrafish (<italic toggle="yes">Danio rerio</italic>) and nematode (<italic toggle="yes">Caenorhabditis elegans</italic>) single-cell data</title>
    <p>To demonstrate <italic toggle="yes">oggmap</italic>, we re-analyzed a single-cell dataset of combined and integrated <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>70 000 zebrafish cells (<xref rid="btad657-B7" ref-type="bibr">Farrell <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B30" ref-type="bibr">Wagner <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>) and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>90 000 nematode cells (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>). A detailed Jupyter notebook to reproduce the case study for zebrafish (<italic toggle="yes">D.rerio</italic>) and nematode (<italic toggle="yes">C.elegans</italic>) is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <p>In brief, to obtain an <italic toggle="yes">orthomap</italic> for zebrafish, we first run OrthoFinder (-S last) (<xref rid="btad657-B13" ref-type="bibr">Kiełbasa <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) to get orthologous groups for the complete species set of Ensembl release-110. Starting from coding sequences only the longest-isoform per gene was retained and converted into amino acid sequences (<xref rid="btad657-B28" ref-type="bibr">Ullrich 2020</xref>). For nematode, a pre-existing gene age map was imported (<xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>Further, setting zebrafish as the focal species, we extracted the corresponding <italic toggle="yes">orthomap</italic> (<xref rid="btad657-F1" ref-type="fig">Fig. 1b</xref>) and highlight the number of genes per gene age class (<xref rid="btad657-F1" ref-type="fig">Fig. 1c</xref>). TEI was calculated for each cell and the distribution of TEI values visualized per developmental stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1d</xref>). As compared to the original publication, showing the hourglass model of embryonic development in zebrafish and the vertebrate phylotypic phase falling between 11- and 42-h postfertilization (hpf) (<xref rid="btad657-B3" ref-type="bibr">Domazet-Lošo and Tautz 2010</xref>), the re-analysis using scRNA data shows the lowest global TAI values at the 12-h stage (12 hpf). Here, like recently shown for <italic toggle="yes">C.elegans</italic> by <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref>, this results confirms the “hourglass” pattern using embryonic zebrafish scRNA data. Researcher should now be able to investigate in more detail individual cell types that contribute to the development stages in the context of evolution (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). The stacked partial TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>) can highlight the contribution of each gene age class to the total TEI pattern. Here, the results confirm the findings of <xref rid="btad657-B17" ref-type="bibr">Ma and Zheng (2023)</xref> that the “youngest” genes specific to <italic toggle="yes">C.elegans</italic> and sister species (age class 11–13) peak in early embryos (<xref rid="btad657-F1" ref-type="fig">Fig. 1e</xref>). Following the basic tutorial of Scanpy (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to get a dimensional reduction of the given scRNA data and the Uniform Manifold Approximation and Projection (UMAP) algorithm (<xref rid="btad657-B18" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>), cells were visualized and colored by stage (<xref rid="btad657-F1" ref-type="fig">Fig. 1f</xref>) or its corresponding TEI values (<xref rid="btad657-F1" ref-type="fig">Fig. 1g</xref>).</p>
    <p>Additional downstream analysis and other species, like <italic toggle="yes">Xenopus tropicalis</italic>, <italic toggle="yes">Mus musculus</italic>, and <italic toggle="yes">Hydra vulgaris</italic>, are available via the documentation of <italic toggle="yes">oggmap</italic> at <ext-link xlink:href="https://oggmap.readthedocs.io/en/latest/" ext-link-type="uri">https://oggmap.readthedocs.io/en/latest/</ext-link>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><italic toggle="yes">oggmap</italic> is a versatile Python package to extract gene ages per orthologous group from OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>), eggNOG (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>), and PLAZA (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>) results and seamless integrate the resulting evolutionary age index with transcriptome data from scRNA datasets and the Scanpy toolkit (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>). <italic toggle="yes">oggmap</italic> can help the investigator to map gene and transcript names to be able to integrate nonstandard gene annotations (e.g. for species with only transcriptome assemblies). Next to evolutionary age indices, other indices like gene adaptation scores become relevant (<xref rid="btad657-B20" ref-type="bibr">Moutinho <italic toggle="yes">et al.</italic> 2022</xref>) and can be used to calculate TEI to look into cell-type specific pattern. With <italic toggle="yes">oggmap</italic>, evolutionary biologist, medical research data analysts, and the up-rising community of single-cell data researchers will be able to enrich their scRNA data by another layer, namely evolution.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad657_Supplementary_Data</label>
      <media xlink:href="btad657_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Julien Y. Dutheil for discussions on this project.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>K.K.U and N.E.G. wrote oggmap. K.K.U. analyzed the results. K.K.U. and N.E.G. wrote and reviewed the manuscript.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Max Planck Society (to K.K.U.); the European Research Council Starting Grant [850529] (E-DIRECT) to Christian Hilbe (to N.E.G.).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>OrthoFinder (<xref rid="btad657-B6" ref-type="bibr">Emms and Kelly 2019</xref>) results for Ensembl release-110, including species taxonomic IDs, are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. For each species of the eggNOG database v6.0 (<xref rid="btad657-B10" ref-type="bibr">Hernández-Plaza <italic toggle="yes">et al.</italic> 2023</xref>) and each species of the PLAZA database v5.0 (<xref rid="btad657-B29" ref-type="bibr">Van Bel <italic toggle="yes">et al.</italic> 2022</xref>), an <italic toggle="yes">orthomap</italic> is available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7242263" ext-link-type="uri">https://doi.org/10.5281/zenodo.7242263</ext-link>. scRNA data for zebrafish (<italic toggle="yes">Danio rerio</italic>), frog (<italic toggle="yes">Xenopus tropicalis</italic>), and mouse (<italic toggle="yes">Mus musculus</italic>) were obtained from <ext-link xlink:href="http://tome.gs.washington.edu/" ext-link-type="uri">https://tome.gs.washington.edu</ext-link>(<xref rid="btad657-B22" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic> 2022</xref>), converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7243602" ext-link-type="uri">https://doi.org/10.5281/zenodo.7243602</ext-link>, <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244440" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244440</ext-link>, and <ext-link xlink:href="https://doi.org/10.5281/zenodo.7244567" ext-link-type="uri">https://doi.org/10.5281/zenodo.7244567</ext-link>. scRNA data for <italic toggle="yes">Caenorhabditis elegans</italic> (<xref rid="btad657-B21" ref-type="bibr">Packer <italic toggle="yes">et al.</italic> 2019</xref>) were obtained from <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link> using the accession number GSE126954, converted into Scanpy AnnData objects (<xref rid="btad657-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and are available here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7245548" ext-link-type="uri">https://doi.org/10.5281/zenodo.7245548</ext-link>. Precalculated gene age assignments were obtained from <xref rid="btad657-B25" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> (2021)</xref>. Precalculated gene adaptation indices were obtained from <xref rid="btad657-B16" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> (2021)</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad657-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cazet</surname><given-names>J</given-names></string-name>, <string-name><surname>Siebert</surname><given-names>S</given-names></string-name>, <string-name><surname>Little</surname><given-names>HM</given-names></string-name></person-group><etal>et al</etal> New hydra genomes reveal conserved principles of hydrozoan transcriptional regulation. bioRxiv, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Brajković</surname><given-names>J</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylostratigraphy approach to uncover the genomic history of major adaptations in metazoan lineages</article-title>. <source>Trends Genet</source><year>2007</year>;<volume>23</volume>:<fpage>533</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18029048</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domazet-Lošo</surname><given-names>T</given-names></string-name>, <string-name><surname>Tautz</surname><given-names>D.</given-names></string-name></person-group><article-title>A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns</article-title>. <source>Nature</source><year>2010</year>;<volume>468</volume>:<fpage>815</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21150997</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Grosse</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Evidence for active maintenance of phylotranscriptomic hourglass patterns in animal and plant embryogenesis</article-title>. <source>Mol Biol Evol</source><year>2015</year>;<volume>32</volume>:<fpage>1221</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">25631928</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>myTAI: evolutionary transcriptomics with R</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1589</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">29309527</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>DM</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farrell</surname><given-names>JA</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Riesenfeld</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>eaar3131</fpage>.<pub-id pub-id-type="pmid">29700225</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gossmann</surname><given-names>TI</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>D</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>MW</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptomes of plant gametophytes have a higher proportion of rapidly evolving and young genes than sporophytes</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1669</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">26956888</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>CR</given-names></string-name>, <string-name><surname>Millman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Van Der Walt</surname><given-names>SJ</given-names></string-name></person-group><etal>et al</etal><article-title>Array programming with NumPy</article-title>. <source>Nature</source><year>2020</year>;<volume>585</volume>:<fpage>357</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hernández-Plaza</surname><given-names>A</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Botas</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>EggNOG 6.0: enabling comparative genomics across 12 535 organisms</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D389</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">36399505</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1635</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Julca</surname><given-names>I</given-names></string-name>, <string-name><surname>Ferrari</surname><given-names>C</given-names></string-name>, <string-name><surname>Flores-Tornero</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Comparative transcriptomic analysis reveals conserved programmes underpinning organogenesis and reproduction in land plants</article-title>. <source>Nat Plants</source><year>2021</year>;<volume>7</volume>:<fpage>1143</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">34253868</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source><year>2011</year>;<volume>21</volume>:<fpage>487</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Frochaux</surname><given-names>M</given-names></string-name>, <string-name><surname>Gardeux</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Inter-embryo gene expression variability recapitulates the hourglass pattern of evo-devo</article-title>. <source>BMC Biol</source><year>2020</year>;<volume>18</volume>:<fpage>129</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">32950053</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Robinson-Rechavi</surname><given-names>M.</given-names></string-name></person-group><article-title>Developmental constraints on genome evolution in four bilaterian model species</article-title>. <source>Genome Biol Evol</source><year>2018</year>;<volume>10</volume>:<fpage>2266</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">30137380</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Lau</surname><given-names>CY</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Large genetic diversity and strong positive selection in F-box and GPCR genes among the wild isolates of <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Genome Biol Evol</source><year>2021</year>;<volume>13</volume>:<fpage>evab048</fpage>.<pub-id pub-id-type="pmid">33693740</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><article-title>Transcriptome age of individual cell types in <italic toggle="yes">Caenorhabditis elegans</italic></article-title>. <source>Proc Natl Acad Sci USA</source><year>2023</year>;<volume>120</volume>:<fpage>e2216351120</fpage>.<pub-id pub-id-type="pmid">36812209</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> UMAP: Uniform Manifold Approximation and Projection for dimension reduction. arXiv, arXiv:1802.03426, <year>2018</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad657-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W.</given-names></string-name></person-group><article-title>pandas: a foundational Python library for data analysis and statistics</article-title>. <source>Python for High Performance and Scientific Computing</source><year>2011</year>;<volume>14</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moutinho</surname><given-names>AF</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A</given-names></string-name>, <string-name><surname>Dutheil</surname><given-names>JY.</given-names></string-name></person-group><article-title>Strong evidence for the adaptive walk model of gene evolution in <italic toggle="yes">Drosophila</italic> and <italic toggle="yes">Arabidopsis</italic></article-title>. <source>PLoS Biol</source><year>2022</year>;<volume>20</volume>:<fpage>e3001775</fpage>.<pub-id pub-id-type="pmid">36099311</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Packer</surname><given-names>JS</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huynh</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>A lineage-resolved molecular atlas of <italic toggle="yes">C. elegans</italic> embryogenesis at single-cell resolution</article-title>. <source>Science</source><year>2019</year>;<volume>365</volume>:<fpage>eaax1971</fpage>.<pub-id pub-id-type="pmid">31488706</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>C</given-names></string-name>, <string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Martin</surname><given-names>BK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic reconstruction of cellular trajectories across mouse embryogenesis</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>328</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">35288709</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quint</surname><given-names>M</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G</given-names></string-name>, <string-name><surname>Gabel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A transcriptomic hourglass in plant embryogenesis</article-title>. <source>Nature</source><year>2012</year>;<volume>490</volume>:<fpage>98</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">22951968</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruprecht</surname><given-names>C</given-names></string-name>, <string-name><surname>Proost</surname><given-names>S</given-names></string-name>, <string-name><surname>Hernandez-Coronado</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenomic analysis of gene co-expression networks reveals the evolution of functional modules</article-title>. <source>Plant J</source><year>2017</year>;<volume>90</volume>:<fpage>447</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">28161902</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Rödelsperger</surname><given-names>C</given-names></string-name>, <string-name><surname>Sommer</surname><given-names>RJ.</given-names></string-name></person-group><article-title>Single worm transcriptomics identifies a developmental core network of oscillating genes with deep conservation across nematodes</article-title>. <source>Genome Res</source><year>2021</year>;<volume>31</volume>:<fpage>1590</fpage>–<lpage>601</lpage>.<pub-id pub-id-type="pmid">34301622</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tajima</surname><given-names>F.</given-names></string-name></person-group><article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title>. <source>Genetics</source><year>1989</year>;<volume>123</volume>:<fpage>585</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">2513255</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarashansky</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Khariton</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping single-cell atlases throughout metazoa unravels cell type evolution</article-title>. <source>Elife</source><year>2021</year>;<volume>10</volume>:<fpage>e66747</fpage>.<pub-id pub-id-type="pmid">33944782</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ullrich</surname><given-names>KK.</given-names></string-name></person-group><article-title>CRBHits: from conditional reciprocal best hits to codon alignments and Ka/Ks in R</article-title>. <source>J Open Source Softw</source><year>2020</year>;<volume>5</volume>:<fpage>2424</fpage>.</mixed-citation>
    </ref>
    <ref id="btad657-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Bel</surname><given-names>M</given-names></string-name>, <string-name><surname>Silvestri</surname><given-names>F</given-names></string-name>, <string-name><surname>Weitz</surname><given-names>EM</given-names></string-name></person-group><etal>et al</etal><article-title>PLAZA 5.0: extending the scope and power of comparative and functional genomics in plants</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>D1468</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">34747486</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>DE</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C</given-names></string-name>, <string-name><surname>Collins</surname><given-names>ZM</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>981</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29700229</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad657-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><article-title>The interpretation of population structure by F-statistics with special regard to systems of mating</article-title>. <source>Evolution</source><year>1965</year>;<volume>19</volume>:<fpage>395</fpage>–<lpage>420</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
