<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7750933</article-id>
    <article-id pub-id-type="pmid">32696040</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa570</article-id>
    <article-id pub-id-type="publisher-id">btaa570</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Metasubtract: an R‐package to analytically produce leave‐one‐out meta‐analysis GWAS summary statistics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Nolte</surname>
          <given-names>Ilja M</given-names>
        </name>
        <xref rid="btaa570-cor1" ref-type="corresp"/>
        <!--i.m.nolte@umcg.nl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa570-cor1">To whom correspondence should be addressed. Email: <email>i.m.nolte@umcg.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-21">
      <day>21</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>16</issue>
    <fpage>4521</fpage>
    <lpage>4522</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa570.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Summary statistics from a meta‐analysis of genome‐wide association studies (meta-GWAS) can be used for many follow-up analyses. One valuable application is the creation of polygenic scores. However, if polygenic scores are calculated in a validation cohort that was part of the meta-GWAS consortium, this cohort is not independent and analyses will therefore yield inflated results. The R package ‘MetaSubtract’ was developed to subtract the results of the validation cohort from meta‐GWAS summary statistics analytically. The statistical formulas for a meta‐analysis were inverted to compute corrected summary statistics of a meta‐GWAS leaving one (or more) cohort(s) out. These formulas have been implemented in MetaSubtract for different meta‐analyses methods (fixed effects inverse variance or square root sample size weighted <italic toggle="yes">z</italic>‐score) accounting for no, single or double genomic control correction. Results obtained by MetaSubtract correlate very well to those calculated using the traditional way, i.e. by performing a meta‐analysis leaving out the validation cohort. In conclusion, MetaSubtract allows researchers to compute meta‐GWAS summary statistics that are independent of the GWAS results of the validation cohort without requiring access to the cohort level GWAS results of the corresponding meta-GWAS consortium.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://cran.r-project.org/web/packages/MetaSubtract" ext-link-type="uri">https://cran.r-project.org/web/packages/MetaSubtract</ext-link>.</p>
      </sec>
      <sec id="s6">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Summary statistics from meta‐analyses of genome‐wide association studies (meta-GWAS) have been made freely available by many consortia. These meta‐GWAS summary statistics can, for instance, be used to construct polygenic scores. However, if the summary statistics are used for validation in one of the cohorts that was included in the meta‐analysis, the polygenic score analysis will yield inflated results (<xref rid="btaa570-B4" ref-type="bibr">Wray <italic toggle="yes">et al.</italic>, 2013</xref>). For unbiased results, the validation cohort needs to be independent from the meta‐GWAS results. It is common practice to contact the consortium and ask them to rerun the meta-analysis with the validation cohort left out. As this could be time inefficient, I developed the R package ‘MetaSubtract’ to subtract the results of the validation cohort from the meta‐GWAS results analytically. For this package, it is sufficient to have the meta‐GWAS results and the cohort’s GWAS results that have been contributed. The statistical formulas for a meta‐analysis were inverted to compute corrected summary statistics of a meta‐GWAS leaving one cohort out. These formulas have been implemented in MetaSubtract for different meta‐analyses methods [fixed effects inverse variance or square root (sqrt) sample size weighted <italic toggle="yes">z</italic>‐score]. It can take into account results from single or double genomic control correction. Finally, it can be used for an entire GWAS, but also for a limited set of genetic markers, e.g. only the tophits from a meta-GWAS.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>MetaSubtract was built as a package for R (<xref rid="btaa570-B2" ref-type="bibr">R Development Core Team, 2012</xref>). The R platform was chosen because it is operating-system independent, commonly used, freely available, can handle large datasets and is flexible regarding input file format. The main function is <italic toggle="yes"><monospace>meta.subtract(…)</monospace></italic> with arguments for the filename of the meta-GWAS summary statistics, the filename(s) of the cohort(s) results, the meta-analysis method and the genomic control lambdas for the meta-analysis and the cohorts or whether these should be calculated from the data. The workflow diagram with respect to the genomic control correction is explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.
</p>
    <sec>
      <title>2.1 Statistics</title>
      <p>In a meta-GWAS results from <italic toggle="yes">N</italic> different cohorts are combined using meta-analysis. The formulas for a meta-analysis can be inverted to get the meta-GWAS summary statistics of all but one cohort. For example for a fixed effects inverse variance meta-analysis, the effect size of a genetic marker of <italic toggle="yes">N</italic>-1 cohorts, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula>, can be computed as
<disp-formula id="E2"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mover><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:msup><mml:mover><mml:msub><mml:mtext>SE</mml:mtext><mml:mi>N</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>⋅</mml:mo><mml:mover><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:msubsup><mml:mtext>SE</mml:mtext><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup></mml:mfrac><mml:mo>⋅</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:msup><mml:mover><mml:msub><mml:mtext>SE</mml:mtext><mml:mi>N</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:msubsup><mml:mtext>SE</mml:mtext><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mover><mml:msub><mml:mtext>SE</mml:mtext><mml:mi>N</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> are the effect size and corresponding standard error (SE), respectively, of the marker from the meta-GWAS, and <italic toggle="yes">β</italic><sub>1</sub> and SE<sub>1</sub> those from the validation cohort. The derivation of this formula and for the SE, the allele frequency and the heterogeneity <italic toggle="yes">Q</italic> value for a fixed effect inverse variance are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Appendix</xref> SA in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Appendix</xref> SB the corresponding formulas are given for a sqrt(sample size) weighted <italic toggle="yes">z</italic>-score meta-analysis. The package also automatically corrects the <italic toggle="yes">P</italic>-values, <italic toggle="yes">z</italic>-scores, sample size, number of studies, direction of effects, <italic toggle="yes">P</italic>-value of <italic toggle="yes">Q</italic> and the <italic toggle="yes">I</italic><sup>2</sup> heterogeneity value if available in the meta-GWAS summary statistics.</p>
    </sec>
    <sec>
      <title>2.2 Validation</title>
      <p>To validate the package data from the VgHRV consortium were used (<xref rid="btaa570-B1" ref-type="bibr">Nolte <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). One phenotype was analyzed by the inverse variance meta-analysis using data of 13 cohorts and another by the sqrt(sample size) weighted meta-analysis of <italic toggle="yes">z</italic>-scores using data from 15 cohorts. Here the GWAS results of the contributing cohorts were meta-analyzed with METAL (<xref rid="btaa570-B3" ref-type="bibr">Willer <italic toggle="yes">et al.</italic>, 2010</xref>). Cohort results were next excluded from the meta-analysis in alphabetical order by METAL or subtracted from the meta-GWAS results using MetaSubtract. METAL and MetaSubtract results of genetic markers that were present in every cohort were compared for the corrected effect size, SE, <italic toggle="yes">z</italic>-score, -log(<italic toggle="yes">P</italic>-value), allele frequency and <italic toggle="yes">Q</italic> statistic using two-way mixed ANOVA intraclass correlation (ICC) coefficients with absolute agreement. The polygenic score calculated from uncorrected and corrected meta-GWAS summary statistics by both MetaSubtract and METAL were associated using linear regression in the TRAILS population cohort.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Results of MetaSubtract correlated very well with those of METAL for all statistical parameters, for all ranges of effect allele frequencies, and both for the inverse variance and sqrt(sample size) weighted <italic toggle="yes">z</italic>-score meta-analysis (<xref rid="btaa570-F1" ref-type="fig">Fig. 1</xref>; Supplementary Figs S2–S7). Even when almost all cohorts were left out, the correlations were mostly still &gt;0.95. Only for the SE in the inverse variance weighted meta-analysis (<xref rid="btaa570-F1" ref-type="fig">Fig. 1c</xref>), the correlation dropped to 0.7, which is likely caused by the small SE and METAL rounding it to four decimals. The latter also explains the decreasing correlation with increasing minor allele frequencies because for such genetic markers the SE becomes even smaller. Corrected polygenic scores applied in TRAILS showed similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>).</p>
    <fig position="float" id="btaa570-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Intraclass correlation coefficients (ICCs) between the meta-GWAS results calculated with METAL and MetaSubtract for an inverse variance meta-analysis (<bold>a–e</bold>) and a sqrt(sample size) weighted <italic toggle="yes">z</italic>-score meta-analysis (<bold>f–h</bold>) both using double genomic control correction. The percentage of remaining samples after exclusion of 1 to 10 (a–e) or 12 (f–h) cohorts is shown on the <italic toggle="yes">x</italic>-axis. Different forms of the dots indicate different minor allele frequency ranges</p>
      </caption>
      <graphic xlink:href="btaa570f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The R package MetaSubtract is an efficient and convenient alternative to the leave-one-out meta-GWAS traditionally used to get meta-GWAS summary statistics that are independent from those of a validation cohort. The results of both methods correlate very highly. However, MetaSubtract has the distinct advantage of not requiring access to the cohort level GWAS results of the meta-GWAS consortium.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa570_supplementary_data</label>
      <media xlink:href="btaa570_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The author thanks Harold Snieder for critical reading of the manuscript.</p>
    <p><italic toggle="yes">Financial Support</italic>: none declared.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa570-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nolte</surname><given-names>I.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Genetic loci associated with heart rate variability and their effects on cardiac disease risk</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15805</fpage>.<pub-id pub-id-type="pmid">28613276</pub-id></mixed-citation>
    </ref>
    <ref id="btaa570-B2">
      <mixed-citation publication-type="book">R Development Core Team. (<year>2012</year>) <source>R: A Language and Environment for Statistical Computing</source>. 
<publisher-name>R Foundation for Statistical Computing</publisher-name>, 
<publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa570-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Willer</surname><given-names>C.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>METAL: fast and efficient meta-analysis of genomewide association scans</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2190</fpage>–<lpage>2191</lpage>.<pub-id pub-id-type="pmid">20616382</pub-id></mixed-citation>
    </ref>
    <ref id="btaa570-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wray</surname><given-names>N.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Pitfalls of predicting complex traits from SNPs</article-title>. <source>Nat. Rev. Genet</source>., <volume>14</volume>, <fpage>507</fpage>–<lpage>515</lpage>.<pub-id pub-id-type="pmid">23774735</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
