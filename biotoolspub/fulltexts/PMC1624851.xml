<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1624851</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-7-454</article-id>
    <article-id pub-id-type="pmid">17042942</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-7-454</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Whole genome association mapping by incompatibilities and local perfect phylogenies</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" equal-contrib="yes" corresp="yes" contrib-type="author">
        <name>
          <surname>Mailund</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mailund@stats.ox.ac.uk</email>
      </contrib>
      <contrib id="A2" equal-contrib="yes" contrib-type="author">
        <name>
          <surname>Besenbacher</surname>
          <given-names>Søren</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>besen@birc.au.dk</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Schierup</surname>
          <given-names>Mikkel H</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mheide@birc.au.dk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, University of Oxford, UK</aff>
    <aff id="I2"><label>2</label>Bioinformatics Research Center, University of Aarhus, Denmark</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2006</year>
    </pub-date>
    <volume>7</volume>
    <fpage>454</fpage>
    <lpage>454</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/454"/>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>7</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>10</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Mailund et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Mailund et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Mailund
               Thomas
               
               
               mailund@stats.ox.ac.uk
            </dc:author><dc:title>
            Whole genome association mapping by incompatibilities and local perfect phylogenies
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 454-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;454&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>With current technology, vast amounts of data can be cheaply and efficiently produced in association studies, and to prevent data analysis to become the bottleneck of studies, fast and efficient analysis methods that scale to such data set sizes must be developed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a fast method for accurate localisation of disease causing variants in high density case-control association mapping experiments with large numbers of cases and controls. The method searches for significant clustering of case chromosomes in the "perfect" phylogenetic tree defined by the largest region around each marker that is compatible with a single phylogenetic tree. This perfect phylogenetic tree is treated as a decision tree for determining disease status, and scored by its accuracy as a decision tree. The rationale for this is that the perfect phylogeny near a disease affecting mutation should provide more information about the affected/unaffected classification than random trees. If regions of compatibility contain few markers, due to e.g. large marker spacing, the algorithm can allow the inclusion of incompatibility markers in order to enlarge the regions prior to estimating their phylogeny. Haplotype data and phased genotype data can be analysed. The power and efficiency of the method is investigated on 1) simulated genotype data under different models of disease determination 2) artificial data sets created from the HapMap ressource, and 3) data sets used for testing of other methods in order to compare with these. Our method has the same accuracy as single marker association (SMA) in the simplest case of a single disease causing mutation and a constant recombination rate. However, when it comes to more complex scenarios of mutation heterogeneity and more complex haplotype structure such as found in the HapMap data our method outperforms SMA as well as other fast, data mining approaches such as HapMiner and Haplotype Pattern Mining (HPM) despite being significantly faster. For unphased genotype data, an initial step of estimating the phase only slightly decreases the power of the method. The method was also found to accurately localise the known susceptibility variants in an empirical data set – the ΔF508 mutation for cystic fibrosis – where the susceptibility variant is already known – and to find significant signals for association between the CYP2D6 gene and poor drug metabolism, although for this dataset the highest association score is about 60 kb from the CYP2D6 gene.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Our method has been implemented in the Blossoc (BLOck aSSOCiation) software. Using Blossoc, genome wide chip-based surveys of 3 million SNPs in 1000 cases and 1000 controls can be analysed in less than two CPU hours.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>With the publication of the human HapMap, phase I [<xref ref-type="bibr" rid="B1">1</xref>], and the completion of genotyping for phase II, association mapping is entering a new era. Whole genome scans using 317 K or 500 K SNP chips, currently available [<xref ref-type="bibr" rid="B2">2</xref>], and their higher density descendants, will be performed in large sets of cases and controls in a search for high-frequency, low penetrance variants that increases susceptibility to common, complex diseases [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. Recently published genome scans in very large cohorts have yielded such variants that show reproducible effects [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B7">7</xref>]. Knowledge about these variants is expected to lead to a better understanding of disease initiation and progression, to identify pharmacological targets for prevention of the disease in high risk individuals as well as individually based treatment. Case-control association mapping allows zooming in on relatively smaller regions than linkage mapping in pedigrees because recombination events in the (deep) unknown genealogy of the sample have decoupled all but the closest markers from the (unknown) susceptibility variants. Furthermore, it is usually easier to recruit large numbers of unrelated individuals for these studies.</p>
    <p>With the immense data generation (a single data set readily contains more than 1 billion genotypes), there is an evident need for efficient methods for localisation of susceptibility variants which are also very fast and which can guide the subsequent selection of further markers in two- or multi-stage designs [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. Many studies resort to a marker by marker approach, i.e. single marker tests for independence between cases and controls, typically by a 2 × 2 (allelic) or 2 × 3 (genotypic) Fisher's exact test or <italic>χ</italic><sup>2</sup>-test. The best set of markers (and markers close to these, i.e. in strong linkage disequilibrium) will then be selected for scrutiny in a larger set of individuals or a different population for replication of the association. However, unless the susceptibility variant is included among the markers typed, a marker by marker approach does not seem efficient [<xref ref-type="bibr" rid="B10">10</xref>] since it disregards the dependency of close markers caused by their sharing of common genealogical history, a sharing that decreases with the level of recombination between the markers. For instance, if a strongly associated marker is flanked to the right by another associated marker (and not to the left), then one would expect a higher probability for the true location slightly to the right of the marker than slightly to the left.</p>
    <p>A popular alternative to single marker association is to (approximately) model the whole data generating process. In this case this is termed the <italic>ancestral recombination graph </italic>(ARG) [<xref ref-type="bibr" rid="B11">11</xref>]. This has most often been done by treating the disease locus as an unknown parameter, whose posterior distribution is estimated from genotype data and an underlying model of the process that generated the data. The posterior is usually numerically evaluated through Monte Carlo methods such as <italic>importance sampling </italic>[<xref ref-type="bibr" rid="B12">12</xref>] and <italic>Markov Chain Monte Carlo </italic>(MCMC) integration [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. For the mathematical model of the underlying process, the complexity varies from assuming no relationship among diseased individuals except through the original mutation of the disease gene (a star topology of cases) [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>], through coalescent theory based methods where either a tree [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>] or an ancestral recombinaion graph is modelled [<xref ref-type="bibr" rid="B12">12</xref>]. These models have shown to be accurate on small data sets [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>], but so far they are not able to treat much more than hundreds of cases and controls and hundreds of markers in a reasonable time.</p>
    <p>Furthermore, being based on very specific models, these methods are also sensitive to a bad fit to the model, which may well be the case for the human genome where recombination hotspots seem prevalent as do signs of recent population growth, and where the ascertainment biases introduced by the choice of markers are generally unknown and therefore difficult to control for [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    <p>Thus, there is a need for more sophisticated methods than single marker associations; methods that include further aspects of the data generating process or observable patterns in the haplotype structure of the data without being prohibitively slow. Some data mining methods have been proposed, e.g. haplotype pattern mining [<xref ref-type="bibr" rid="B20">20</xref>] and HapMiner [<xref ref-type="bibr" rid="B21">21</xref>], as well as cladistic methods that aim at associating the disease chromosomes to some subset of a reconstructed tree for either the whole or a part of the region surveyed [<xref ref-type="bibr" rid="B22">22</xref>-<xref ref-type="bibr" rid="B26">26</xref>]. These methods have been applied to small real data sets and have shown to perform well, especially when more than one mutation in the gene is responsible.</p>
    <p>We propose to follow a similar approach by building perfect phylogenies around each marker. We accomplish this by using as many markers as possible (on either side of a given marker) that fit on a single phylogenetic tree. We assume the infinite sites model [<xref ref-type="bibr" rid="B27">27</xref>], i.e. each segregating site has a unique mutation. Thus, the procedure is equivalent to defining a region around each focal marker, such that all markers in this region are compatible with the marker in focus as judged by the four gamete test [<xref ref-type="bibr" rid="B28">28</xref>]. Following, we use different clustering measures of case chromosomes in the phylogeny thus defined. The idea behind the clustering measures is that we treat the perfect phylogeny as a decision tree and measure how well it explains the case/control classification: If the tree explains the classification well, there is an association between the tree topology and the disease, if the tree does not explain the classification, the tree and disease status are considered independent.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>We have implemented our new method, named Blossoc for BLOck aSSOCiation, and evaluated it on a number of simulated datasets and two real datasets, and compared the accuracy with a number of existing methods. Our implementation is efficient enough to handle very large datasets, analysing simulated sets of 10 MB regions of 1000 case and 1000 controls with 1000 SNPs in ~15 seconds on a 3GHz Intel Xeon. Scaling this to 300 K SNPs over the entire genome, the running time will be less than two hours.</p>
    <p>In evaluating our algorithm, we calculated scores for each marker locus in a dataset; an example is shown in Fig. <xref ref-type="fig" rid="F1">1</xref>. Our method does not in any way restrict us to calculating scores for marker loci only, and perhaps the most appropriate approach would be to select the points uniformly placed on the region of interest. However, in our simulated data, the density of markers is high and the marker positions are uniformly randomly placed, so scoring only marker loci is not a major limitation, and has the benefit that we can immediately compare with single marker association (SMA).</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Example result</bold>. Plot showing the clustering scores from our algorithm for each locus across a region, using the HQC score (top). The horizontal lines indicate "positive" significance, "strong" significance, and "very strong" significance, respectively (see main text). P-values, obtained by a permutation test (1000 replicates), are shown below, where the bottommost line shows 5% significance and the topmost line 1% significance. At the bottom, the corresponding single marker association is shown, where the two lines again show 5% and 1% significance.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-454-1"/>
    </fig>
    <p>Comparing our scoring to SMA, shows a high correlation between high clustering scores for our method and small p-values for SMA. However, our scoring gives a smoother "curve" since neighbouring markers are included when scoring a locus and neighbouring scores are therefore more dependent (compare the topmost and bottommost plots in Fig. <xref ref-type="fig" rid="F1">1</xref>).</p>
    <p>To test significance of scores in our method we generally have to rely on time-consuming permutation tests. Relatively time-consuming tests, that is. Although doing thousands of permutation tests slows down our method significantly, it still completes in around 12 hours for our simulated data sets. Compared to this, many model-based Bayesian approaches requires days of CPU time. When using the BIC score, however, theoretical results in [<xref ref-type="bibr" rid="B29">29</xref>], described in the Methods section, suggest to simply use the score to judge evidence of significance. The HQC score is very similar to the BIC score, and hence we would expect to be able to use the HQC score to evaluate significance as well. We tested this suggestion by two different experiments. In the first experiment, we simulated 500 data sets under the null model, i.e. where cases and controls are simulated under the coalescent process, but where status is assigned randomly. This way we collected the null distribution of scores, for which the 95%, 99% and 99.9% percentiles were 0.61, 4.40, and 9.14, respectively.</p>
    <p>In the second experiment, we compared scores with p-values obtained by running permutation tests on a subset of our simulated data, selecting 50 random sets with one mutation and 50 random sets with two mutations, each with 1000 individuals (500 cases and 500 controls) and 1000 permutations. Using scores 2, 6, and 10 to mean positive, strong, and very strong evidence for association, as suggested in [<xref ref-type="bibr" rid="B29">29</xref>] – and consistent with our null-model simulations – we examined the p-values corresponding to loci with those scores higher, see Table <xref ref-type="table" rid="T1">1</xref>. These data indicate that, at least as a good approximation, the scores alone can be used to indicate significant association.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>P-values and HQC scores</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">Evidence</td>
            <td align="center">max p-value</td>
            <td align="center">mean p-value (± s.d.)</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Positive (HQC &gt; 2)</td>
            <td align="center">0.038</td>
            <td align="center">0.0021 (± 0.0048)</td>
          </tr>
          <tr>
            <td align="left">Strong (HQC &gt; 6)</td>
            <td align="center">0.009</td>
            <td align="center">0.0003 (± 0.0008)</td>
          </tr>
          <tr>
            <td align="left">Very Strong (HQC &gt; 10)</td>
            <td align="center">0.004</td>
            <td align="center">4.059 · 10<sup>-5 </sup>(± 0.0002)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Statistics for p-values for different levels of significance as determined by the HQC score.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>In the following, we measure the accuracy of our algorithm by taking simply the maximal scoring locus as a point-estimate of the disease locus, and measure the distance from this inferred locus to the true locus. This, of course, does not give as much information about the analysis as does knowledge of the scores over the entire region, but greatly simplifies summarising results over large number of data sets.</p>
    <sec>
      <title>Performance on simulated data sets</title>
      <p>We initially investigated the different scoring criteria (AIC, BIC, HQC, and Prob scores, see Methods) on simulated data sets, either haploid or diploid (genotype) data, with a single or two disease mutations, see Fig. <xref ref-type="fig" rid="F2">2</xref> and Table <xref ref-type="table" rid="T2">2</xref>.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Comparison of scoring functions</bold>. The x-axis shows the distance from the true locus, in units of <italic>ρ </italic>= 40, i.e. approximately 100 Kbp, while the y-axis shows the accumulated percentage of data sets where the predicted locus falls within a certain distance from the true locus.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-454-2"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Score comparison</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Setup</td>
              <td align="center">AIC score</td>
              <td align="center">BIC score</td>
              <td align="center">HQC score</td>
              <td align="center">Prob. score</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1000 individuals</td>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">1 mutation</td>
              <td align="center">0.0787 ± 0.118</td>
              <td align="center">0.0705 ± 0.111</td>
              <td align="center">
                <bold>0.068 ± 0.111</bold>
              </td>
              <td align="center">
                <bold>0.068 ± 0.103</bold>
              </td>
            </tr>
            <tr>
              <td align="left">2 mutations</td>
              <td align="center">0.061 ± 0.09</td>
              <td align="center">0.068 ± 0.113</td>
              <td align="center">
                <bold>0.059 ± 0.091</bold>
              </td>
              <td align="center">0.066 ± 0.103</td>
            </tr>
            <tr>
              <td align="left">200 individuals</td>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">1 mutation</td>
              <td align="center">0.235 ± 0.230</td>
              <td align="center">
                <bold>0.214 ± 0.227</bold>
              </td>
              <td align="center">0.219 ± 0.227</td>
              <td align="center">0.220 ± 0.230</td>
            </tr>
            <tr>
              <td align="left">2 mutations</td>
              <td align="center">0.148 ± 0.184</td>
              <td align="center">0.140 ± 0.179</td>
              <td align="center">0.140 ± 0.174</td>
              <td align="center">
                <bold>0.126 ± 0.174</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Summary of the accuracy of the four scoring functions (mean prediction error ± s.d.) in units of <italic>ρ </italic>= 40, i.e. 1.0 corresponds to a recombination rate of <italic>ρ </italic>= 40. For each simulation setup, the best performing score (measured by smallest mean prediction error) is highlighted.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The best scoring function varies from data set to data set, and no scoring scheme is consistently superior to the others, either on individual data sets (Fig. <xref ref-type="fig" rid="F2">2</xref>) or on average (Table <xref ref-type="table" rid="T2">2</xref>). It seems, however, the prob. scoring performs best on smaller datasets while the prob. score and the Hannan and Quinn criterion are about equally accurate on larger datasets. Of the two, however, the HQC is much faster to compute, especially for large datasets, making it our preferred scoring function. As a result of this, we used the HQC score in the following experiments whenever analysing more than 200 individuals and the prob. score whenever analysing fewer. Another experiment (not shown) showed that performance is slightly better when a minimum of 10 markers are forced to be included. It also showed that it did not affect the accuracy significantly if more than 10 markers where forced to be included, because the following pruning (see Methods) removes the additional edges in the tree if they are insigninficant. In all reported experiments, we have therefore required at least 10 markers to be included.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> compares our method, with these optimal scoring choices, to single marker association. For data sets with a single mutation, the two methods seem equally matched for the large data sets, while the single marker association seems to have a slight advantage on the smaller data sets. For two mutations our method is more accurate than SMA in both cases.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Comparison with single marker association</bold>. The plots show the accuracy of our method compared with SMA for one and two mutations (topmost and bottommost, respectively) and with 1000 and 200 individuals (leftmost and rightmost, respectively).</p>
        </caption>
        <graphic xlink:href="1471-2105-7-454-3"/>
      </fig>
      <p>The data sets were simulated assuming constant population size, but the human population is believed to have gone through a number of expansions. To test robustness of our method under population growth we also simulated data under exponential growth; growth parameter <italic>β </italic>= 100, see [[<xref ref-type="bibr" rid="B30">30</xref>], Chap. 4]. Results are shown in Fig. <xref ref-type="fig" rid="F4">4</xref>. Encouragingly, the results are not much affected by growth. Compared to data sets without growth, the accuracy for Blossoc drops – which is to be expected since the growth drives the genealogy towards more star-shaped topologies, in which our method will find no signal – but it still behaves similar to single marker association on the one-mutation data sets and it is more accurate on the two-mutations data sets.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Robustness under population growth</bold>. The graph compares the mapping accuracy when data was simulated assuming constant population size (<italic>β </italic>= 0) with data simulated assuming exponential growth (<italic>β </italic>= 100). The single marker association accuracy shown is for the exponential growth data sets; for contrast with single marker association without growth, see Fig.3.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-454-4"/>
      </fig>
      <p>To avoid systematic bias due to our simulation setup, we also generated data in a completely different manner, by boosting data from the HapMap project (see Methods section). Results for this setup are shown in Fig. <xref ref-type="fig" rid="F5">5</xref> and resemble the results obtained from our simulated data.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Performance on data sets generated from HapMap data</bold>. The comparison between out Blossoc method and single marker association resembles the setup for our simulated sequences based on a single mutation.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-454-5"/>
      </fig>
    </sec>
    <sec>
      <title>Comparison with other methods</title>
      <p>The large number of association mapping methods developed makes it infeasible to compare all methods, and thus we are forced to make a choice as to which we should compare our new method to. Our primary criterion in this choice was to compare with methods in the same niche as ours: methods aimed at fast exploration of very large data sets (as opposed to highly accurate at the cost of very long running times). Under this criterion we found the following methods: <italic>HapMiner </italic>[<xref ref-type="bibr" rid="B21">21</xref>], <italic>Haplotype Pattern Mining </italic>[<xref ref-type="bibr" rid="B20">20</xref>], and <italic>HapCluster </italic>[<xref ref-type="bibr" rid="B31">31</xref>]. All three methods are aimed at finding areas in the data where cases appear more similar than controls, but define such areas, and scores loci accordingly, in different ways.</p>
      <sec>
        <title>Comparison with HapMiner</title>
        <p>An implementation of the HapMiner method is available from the authors' homepage as a binary executable. We downloaded this implementation, and ran it on our simulated data sets with default parameters except for parameter number 5 which was set to 0 to prevent permutation testing. For data sets with a single mutation, whether large or small, the HapMiner method and our method perform similarly (results not shown), but for two mutations Blossoc is slightly more accurate, see Fig. <xref ref-type="fig" rid="F6">6</xref>.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p><bold>Comparison with HapMiner</bold>. Topmost plot shows the cumulative error for large data sets while the bottommost plot shows the cumulative error for small data sets, in each case for data sets with two mutations.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-6"/>
        </fig>
        <p>Compared to our new method, HapMiner is significantly slower, with an average running time of ~40 minutes per data set when run on a 3GHz Intel Xeon, compared to a few seconds for our Blossoc method. The long running times for HapMiner made it impractical to compare the two methods on the larger HapMap based data sets.</p>
      </sec>
      <sec>
        <title>Comparison with Haplotype Pattern Mining</title>
        <p>The Haplotype Pattern Mining (HPM) implementation is not freely available, but the simulated data sets used to evaluate the method in [<xref ref-type="bibr" rid="B20">20</xref>] can be obtained from the authors' homepage. We therefore compare the two methods by running Blossoc on these data sets and compare them with the results reported in [<xref ref-type="bibr" rid="B20">20</xref>], see Fig. <xref ref-type="fig" rid="F7">7</xref>. These data sets are much smaller than our own simulated data sets – with 100 cases and 100 controls – so following the guidelines described earlier in this section, we use the prob. score for Blossoc. The data sets come in four different classes, of increasing complexity, based on the number of cases carrying the disease mutation. As shown in Fig. <xref ref-type="fig" rid="F7">7</xref>, Blossoc is more accurate on the two easiest classes (on the left of the figure) while the two methods are comparable on the two hardest (on the right in the figure). Only on the last data set does single marker association compare to the other two; in the three easiest cases both Blossoc and Haplotype Pattern Mining outperforms single marker association.</p>
        <fig position="float" id="F7">
          <label>Figure 7</label>
          <caption>
            <p><bold>Comparison with Haplotype Pattern Mining</bold>. The data sets are split into four groups of increasing difficulty, based on the number of cases carrying the disease mutation: <italic>A </italic>= 10%, 7.5%, 5%, and 2.5%.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-7"/>
        </fig>
      </sec>
      <sec>
        <title>Comparison with HapCluster</title>
        <p>Though an implementation of the HapCluster method is available from the authors, this implementation is in the scripting language R and therefore much too slow to practically compare Blossoc and HapCluster on our simulated data. Instead, as for HPM, we rely on results reported by the authors, and compare Blossoc with HapCluster on the simulated data described in [<xref ref-type="bibr" rid="B31">31</xref>]. The data sets in [<xref ref-type="bibr" rid="B31">31</xref>] come in five different classes, based on the spacing of markers, the frequency of the causal allele, and the minor allele frequency (MAF) of the markers: All data sets represent regions of 750 Kbp, but the number of SNP markers come in three sizes: 30 (giving an average spacing of 25 Kbp), 75 (a spacing of 10 Kbp) and 150 (a spacing of 5 Kbp); the frequency of the causal allele comes in two ranges: common (15%–25%) and moderately rare (5%–10%); and finally, the MAF was either 5% or 10%. This was combined in five combinations: the 25 Kbp spacing had MAF 10% and common causal allele; the 10 Kbp spacing had MAF 10% and moderately rare causal allele; and the 5 Kbp spacing had two moderately rare causal allele versions, with MAF 5% and 10%, respectively, and one common causal allele version with MAF 10%. All data sets consisted of 200 cases and 200 controls, selected with genotype relative risk in ratio 1:3:9 for the 25 Kbp and 10 Kbp spacing data sets and in the ratio 1:2:4 for the 5 Kbp spacing data sets. Each parameter class was used to simulate 100 data sets.</p>
        <p>For the 5 Kbp data set with common causal variant, we saw no difference between Blossoc, HapCluster, and single marker association; a comparison of the three methods is shown for the four other parameter combinations in Fig. <xref ref-type="fig" rid="F8">8</xref>. For the 25 Kbp spacing data sets, HapCluster seems slightly better than Blossoc and single marker association, while in the 10 Kbp spacing data sets, Blossoc and HapCluster seem equally good and both better than single marker association. For the remaining two data sets, Blossoc is slightly better than the other two.</p>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p><bold>Comparison with HapCluster</bold>. The plots show the accuracy over 100 data sets for each setup. The data sets are split into four group, depending on the spacing of markers, the allele frequency for the disease allele and the minor allele frequency of the SNP markers.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-8"/>
        </fig>
        <p>Since the Blossoc method uses a very simple model of the data to achieve very fast running times – simple tree topologies based on segregating sites only – we don't expect it to be as accurate as more time consuming methods with more detailed data models. Nevertheless, it is interesting to compare our method with such methods to get an impression of how great a loss in accuracy we accept by using the faster method.</p>
        <p>Since it is impractical to run CPU intensive methods on our simulated data sets, we choose again to run Blossoc on previously published data sets and compare with only a single, but state of the art, representative of this class of methods, the LATAG method from [<xref ref-type="bibr" rid="B25">25</xref>].</p>
        <p>We used our Blossoc method to analyse simulated data sets from and compared it with reported results from [<xref ref-type="bibr" rid="B25">25</xref>]. The data consist of 50 sets 1 cM regions with 45–65 markers for 30 diploid cases and 30 diploid controls, where the causal allele frequency is in the range 0.1–0.2 and the disease status is assigned with probabilities</p>
        <p><italic>P </italic>(affected | homozygote mutant) = 0.80</p>
        <p><italic>P </italic>(affected | heterozygote) = 0.10</p>
        <p><italic>P </italic>(affected | homozygote wild - type) = 0.05</p>
        <p>Compared to the other simulated data sets described previously, these data sets are very small. Complex methods, such as LATAG, do not scale to large data sets – even these very small data sets require hours of CPU time to analyse – but are often capable of detecting signals in data sets where faster methods, such as ours, have insufficient power.</p>
        <p>Results are shown in Fig. <xref ref-type="fig" rid="F9">9</xref> and Blossoc is again more accurate than SMA. We were not able to get the exact results from Figure 6 in [<xref ref-type="bibr" rid="B25">25</xref>], but a visual comparison of Fig. <xref ref-type="fig" rid="F9">9</xref> with Figure 6 in [<xref ref-type="bibr" rid="B25">25</xref>] suggest that Blossoc is slightly less accurate than LATAG, with an accuracy somewhere half-way between single marker association and the LATAG method. The improved accuracy of LATAG, however, is at the expense of running time where a reported ~5 hours per data set for LATAG needs to be compared with a few seconds per data set for Blossoc.</p>
        <fig position="float" id="F9">
          <label>Figure 9</label>
          <caption>
            <p>Performance on datasets from [25].</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-9"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Results on real data sets</title>
      <sec>
        <title>CF Data Set</title>
        <p>We ran our method on the ΔF508 mutation for cystic fibrosis data from [<xref ref-type="bibr" rid="B32">32</xref>]. The data set consists of 94 cases and 92 controls, genotyped for 23 markers. Because of the small size of the data set we used the prob. score. The results from this analysis are shown in Figure <xref ref-type="fig" rid="F10">10</xref>. The markers are very un-evenly spaced in the region, and this is a case where a uniform placement of scoring points would probably be preferable to scoring only the marker loci, but to be able to immediately compare it with single marker association (shown at the bottom of the figure) we still use the marker loci. The wide tail to the right of the disease locus, however, is probably an artifact of this choice.</p>
        <fig position="float" id="F10">
          <label>Figure 10</label>
          <caption>
            <p><bold>Analysis of the CF data set</bold>. The topmost plot shows the clustering scores assigned to the loci using our Blossoc method while the bottommost plot shows single marker association.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-10"/>
        </fig>
        <p>Blossoc takes its maximal score in the true locus, but this maximal score stretches over the range 0.87–0.96 with center at 0.91. This is comparable to other fine-maping tools (Table <xref ref-type="table" rid="T3">3</xref>).</p>
        <table-wrap position="float" id="T3">
          <label>Table 3</label>
          <caption>
            <p>Comparison of location estimates</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td align="left">Method</td>
                <td align="center">Estimate</td>
                <td align="center">95%-interval</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">Liu et al. [15]</td>
                <td align="center">0.87</td>
                <td align="center">0.82–0.93</td>
              </tr>
              <tr>
                <td align="left">Morris et al. [14]</td>
                <td align="center">0.85</td>
                <td align="center">0.65–1.00</td>
              </tr>
              <tr>
                <td align="left">Zöllner and Pritchard [25]</td>
                <td align="center">0.87</td>
                <td align="center">0.81–0.92</td>
              </tr>
              <tr>
                <td align="left">Mailund et al. [42]</td>
                <td align="center">0.82</td>
                <td align="center">0.73–1.03</td>
              </tr>
              <tr>
                <td align="left">Blossoc</td>
                <td align="center">0.91</td>
                <td align="center">NA</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Comparison of location estimates of the ΔF508 mutation for cystic fibrosis data [32] by Blossoc and other coalescent-based fine mapping tools. The mutation is located at 0.88. Blossoc only gives a point estimate of the true locus and no credibility interval, but the maximal score stretches over the interval 0.87–0.96.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>CYP2D6 Data Set</title>
        <p>The CYP2D6 gene plays a role in drug metabolism and in [<xref ref-type="bibr" rid="B33">33</xref>] 32 SNPs in a 890 kb region spanning the CYP2D6 locus were genotyped in 1,018 individuals, of which 41 were classified as having the "poor drug metaboliser" (PM) phenotype. We ran Blossoc on this dataset and tested for association with the PM phenotype; the results are shown in Fig. <xref ref-type="fig" rid="F11">11</xref>. The entire region around the CYP2D6 scores very strongly (&gt; 100) with a HQC-score of 156 at the actual gene, but with a higher score, 181, about 60 kb upstream of the gene (but in high LD with the gene).</p>
        <fig position="float" id="F11">
          <label>Figure 11</label>
          <caption>
            <p><bold>Analysis of the CYP2D6 data set</bold>. The topmost plot shows the clustering scores assigned to the loci using our Blossoc method while the bottommost plot shows single marker association.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-11"/>
        </fig>
        <p>In [<xref ref-type="bibr" rid="B31">31</xref>], Waldron et al. finds two modes in the CYP2D6 dataset when analysed with HapCluster. The smaller of the two corresponds to our maximal peak, while the highest mode of HapCluster is located at the CYP2D6 gene.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Our Blossoc method is based on the very simple idea of compatibility in a region around a marker combined with perfect phylogenies based on binary traits assuming the infinite sites model. This idea has not previously been explicitly exploited for association mapping. A single marker often belongs to different intervals of compatible sets of markers but here we choose the most symmetric interval around the marker in focus (see Methods). An interval with only compatible markers may well have experienced recombination events in the history of a large sample, but these recombination events have left relatively little imprint on the data. Thus, the method uses parts of the observable haplotype structure without making any reference to the underlying evolutionary process that created this haplotype structure – aside from the infinite sites model that is typically considered reasonable for SNP data. Apart from what compatibility tells us about recombination away from a focal marker, the method can be classified as a data mining approach. This can be considered a strength in cases where little is known about the process that generated the data, e.g. the demographic process, the recombination process and the ascertainment biases in choice of markers used.</p>
    <p>The Blossoc method is mainly designed to handle a very dense set of markers with high linkage disequilibrium since, in this case, blocks of compatibility are expected to include several markers. To extend the use of the method to cases of more distantly spaced markers we have investigated the effect of forcing a preset minimum number of markers to be included. While this has little effect on densely spaced markers where the number of compatible markers usually exceeds this minimum, it was found to increase the mapping accuracy for less densely spaced markers and to be relatively insensitive to minimum values, as long as they exceed 5, due to the subsequent pruning of the tree.</p>
    <p>The method is evidently heuristic and its efficiency can therefore only be evaluated through the application of the method to well defined data sets where the result is already known and comparing its accuracy to other methods. Due to the almost absence of publicly available case-control data sets where susceptibility mutations are known, we have mainly evaluated the performance of the method on artificial data sets either simulated under simple demographic models or based on augmentation of data from the public HapMap project.</p>
    <p>We initially used these test data sets to evaluate which scoring function to use for establishing significant clustering, and were able to conclude that the HQC scoring is generally superior except for small data sets (fewer than 100 cases and 100 controls) in which case the prob. score is superior. We thus recommend choice of HCQ if more than 200 sequences are available and otherwise the prob. score. Our experiments also prompt us to recommend that a minimum of 10 markers are always included.</p>
    <p>Using our recommended choice of scoring function, the results encouragingly show that the simple method generally outperforms marker by marker association as well as competing fast methods where we could get access to the software and/or previous analyses which we could directly compare our results against. If only a single mutation affects the disease status, then most of the competing methods are indistinguishable from just choosing the most strongly associated single marker. However, when disease heterogeneity or non-additive genotypic effects are modelled, single marker association is inferior to the other methods. Among these, our Blossoc method generally outperforms HapMiner, HPM and HapCluster, even on the data sets used in the original publications of these alternative methods. Blossoc is also very competitive in regards to running time. For our simulated data sets, Blossoc completes the analysis within a few seconds on a 3GHz Xeon processor, compared to less than a second for SMA and ~40 minutes for HapMiner. We do not compare running time with HPM, since we do not have access to the tool, or to HapCluster, since this method has only been implemented as an R prototype, and a runtime comparison with this will not be a fair comparison. Blossoc is thus only slightly slower than the simple single marker association and much faster than HapMiner.</p>
    <p>Surprisingly, Blossoc also performs reasonable compared with more involved methods such as the method by Zöllner and Pritchard. However, we expect that model based approaches always will be superior to our method as long as the model is a reasonable approximation to the data generating process, and our experiments also show that Zöllner's and Pritchard's LATAG outperforms Blossoc. Model based approaches, however, are many orders of magnitude slower than our new method, and more importantly will not scale to the size of our own simulated data sets. Blossoc can analyse 3 million SNPs in 1000 cases and 1000 controls in a few days, while the method of Zöllner and Pritchard will not be able to handle such data sets. We expect that boosting the power in a study, by increasing the number of samples and being able to analyse the larger data sets, will more than compensate for the cruder model.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have presented a fast method, Blossoc, for accurate localisation of disease causing variants in high density case-control association mapping experiments. Blossoc has the same accuracy as single marker association in the simplest case of a single disease causing mutation and a constant recombination rate. However, when it comes to more complex scenarios of mutation heterogeneity and more complex haplotype structure such as found in the HapMap data our method outperforms SMA as well as other fast, data mining approaches such as HapMiner and Haplotype Pattern Mining (HPM) while being significantly faster.</p>
    <p>Several extensions to the method are currently under investigation, e.g. the ability to handle unphased genotype data directly without the pre-phasing step (which at present is more CPU intensive than the actual mapping step), an ability to alleviate gene conversion events by skipping single incompatible markers in the centre of a block of compatible markers, and the ability to handle quantitative traits. Multi-allelic markers such as micro-satellites can already be handled if they are assumed to evolve under the infinite alleles model, but the efficiency of the algorithm has not been investigated in this case. Furthermore, the method is sufficiently fast that investigation of interactions between regions should also be feasible to score by a similar principle [<xref ref-type="bibr" rid="B34">34</xref>].</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>The mapping algorithm</title>
      <sec>
        <title>The basic algorithm for construcing perfect phylogenies</title>
        <p>At a given point in the genome, a sample of cases and controls will be related by a true genealogy that can usually only be partly inferred from a set of markers. Mutations that directly affect the probability of belonging to the case category (disease mutations) induce non-uniform distributions of individuals in sub-parts of the tree: descendants of a given disease mutation will have higher risk of the disease, and all such descendants will be found in some sub-tree rooted in the original mutant. Testing the presence of such a mutant locus therefor reduces to testing for a significant clustering of affected individuals, as has been exploited in several methods [<xref ref-type="bibr" rid="B23">23</xref>-<xref ref-type="bibr" rid="B25">25</xref>]. The method presented in this paper differs from the methods in [<xref ref-type="bibr" rid="B23">23</xref>] and [<xref ref-type="bibr" rid="B24">24</xref>] in that we do not restrict ourselves to regions with no or very little recombination, and from [<xref ref-type="bibr" rid="B25">25</xref>] in how we infer genealogies.</p>
        <p>Assuming an infinite sites model, each polymorphic site splits a present day sample of individual haplotypes into a set of descendants of the original mutant and a set of non-descendants; if a haplotype has a mutant allele, it must be a descendant of the original mutant of which there is only one, and if it is a descendant of a mutant it must also carry the mutant allele at the site. Under this model, assuming no recombinations, the true (un-rooted) genealogy can be inferred, assuming enough segregating sites, and efficient algorithms exist [<xref ref-type="bibr" rid="B35">35</xref>]. If there are insufficient segregating sites, the fully resolved tree cannot be reconstructed as some sequences will be indistinguishable and therefore their relationship cannot be inferred. In this case, all resolved edges are still part of the true phylogeny, and the identical sequences will only resolve in high-degree nodes, leading to a multi-furcating tree.</p>
        <p>If recombinations have occurred, a single tree may not explain the genealogy of the sample; if the recombination results in trees with different topology on each side of the recombination point – and for large sample sizes, this will be the case in almost all recombinations [<xref ref-type="bibr" rid="B30">30</xref>] – then different trees are needed to explain the genealogy for the first part and for the last part of the sample sequences. This can be exploited for locating disease genes. If we can split the sequences into regions where no recombination has occurred, we can infer the trees of these regions and test for significant clustering of affected individuals. The regions containing the significant clusterings are our candidates for containing the disease affecting locus.</p>
        <p>Unfortunately, there is no efficient way to recognize the regions without recombinations. Hence we are forced to use heuristics to select the non-recombining regions we build trees over. A sufficient, but not necessary, condition for a recombination to have occurred – assuming the infinite sites model – is the four-gamete test: if all four haplotypes 00, 01, 10, and 11 are observed for two loci, a recombination must have occurred between the two [<xref ref-type="bibr" rid="B28">28</xref>]. In the following, we will treat any contiguous set of loci, where no pair of loci has all four haplotypes, as if devoid of recombination events.</p>
        <p>We attempt to infer the local tree for different loci across the region; for each locus, we consider the region around the locus including as many markers as possible without violating the four-gamete rule, and build the perfect phylogeny for this region, see Figs. <xref ref-type="fig" rid="F12">12</xref> and <xref ref-type="fig" rid="F13">13</xref>. When deciding which markers to include in the perfect phylogeny, we add markers in a "closest to the current marker" ordering, until no new marker can be added without incompatibilities, in one of the directions (left or right), after which we add markers in the other direction until we cannot add markers in that direction either. Selecting regions in this way allow us to use as many neighbouring markers as possible when building the tree of a locus – at the risk of including too many, of course – while attempting to keep the current locus as near center of the region as possible.</p>
        <fig position="float" id="F12">
          <label>Figure 12</label>
          <caption>
            <p><bold>Compatible regions</bold>. Illustration of the definition of regions around each SNP that are included in building the genealogy. The top-most six solid lines represent chromosomes, where circles represent the presence of a mutant allele and the absence of a circle the presence of the corresponding wild-type allele. The dashed lines show maximal regions around each segregating site, not violating the four-gamete test.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-12"/>
        </fig>
        <fig position="float" id="F13">
          <label>Figure 13</label>
          <caption>
            <p><bold>Local tree</bold>. Local tree for the region of the fourth segregating site. The region covers the third, fourth, and fifth segregating sites. Each site splits the chromosomes into two sets, corresponding to edges in the local tree for site four, shown at the bottom</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-13"/>
        </fig>
        <p>In cases where too few markers are included due to many incompatibilities (further described below), incompatible mutations are used to resolve more than one node in the tree; each node that contains sequences with both variants are split into two sub-trees, resulting in a uniquely defined phylogeny.</p>
      </sec>
      <sec>
        <title>Scoring functions</title>
        <p>Once a tree has been built for a locus, we consider the tree a hierarchical clustering of the individuals in the sample, and we perform a test for significant clustering of affected individuals. We define clusters by either inner nodes only containing leaf-subtrees (in which case the cluster consist of all the leaves connected to the node) or single leaves, for leaves not connected to such inner nodes.</p>
        <p>If the markers used to build the tree are independent of the affected/unaffected status, we would expect that the affected individuals are distributed identically in all the clusters of the tree; if, on the other hand, the tree is similar to the true genealogy of the disease locus, the affected individuals are expected to be overrepresented in one or more subtrees. The level of significant clustering gives us a score for the tree, and this score is assigned to the locus for which the tree was built.</p>
        <p>To score trees, we look at the clustering implied by a tree as a model for the generation of the data, i.e. we consider the perfect phylogeny as a decision tree for the case/control classification, and we assume that the probability of being affected are the same for all individuals that are in the same cluster of the tree, but can vary between clusters. The model selection criteria (MSC) that we used were of the form:</p>
        <p>MSC = -2 ln Pr(data|model) + <italic>K </italic>· <italic>D</italic>(<italic>M</italic>)   (1)</p>
        <p>Where <italic>K </italic>is the number of free parameters in the model, which is equivalent to the number of clusters in the tree, and <italic>D</italic>(<italic>M</italic>) is a function of the number of samples, <italic>M</italic>, used to penalize over-fitting. The first term is the maximum likelihood estimate and scores how good the model, i.e. the tree, fits the data. The maximum likelihood estimate Pr(data|model) is just factored as the product of the likelihood of each of the individuals. Each cluster has a probability of affectedness independent of the other clusters, and thus the number of free parameters, <italic>K</italic>, is equal to the number of clusters in the tree. The contribution of a cluster <italic>C</italic>, with <italic>C</italic><sub><italic>A </italic></sub>affected individuals, and <italic>C</italic><sub><italic>U </italic></sub>unaffected individuals, to the total log likelihood is:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-7-454-i1" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>ln</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>mod</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mtext>el</mml:mtext>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>C</mml:mi>
                    <mml:mi>A</mml:mi>
                  </mml:msub>
                  <mml:mi>ln</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>A</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>A</mml:mi>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>U</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>C</mml:mi>
                    <mml:mi>U</mml:mi>
                  </mml:msub>
                  <mml:mi>ln</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>U</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>A</mml:mi>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mi>C</mml:mi>
                            <mml:mi>U</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacyGGSbaBcqGGUbGBcyGGqbaucqGGYbGCcqqGGaaicqGGOaakcqWGdbWqcqGG8baFcyGGTbqBcqGGVbWBcqGGKbazcqqGLbqzcqqGSbaBcqGGPaqkcqGH9aqpcqWGdbWqdaWgaaWcbaGaemyqaeeabeaakiGbcYgaSjabc6gaUnaabmaabaWaaSaaaeaacqWGdbWqdaWgaaWcbaGaemyqaeeabeaaaOqaaiabdoeadnaaBaaaleaacqWGbbqqaeqaaOGaey4kaSIaem4qam0aaSbaaSqaaiabdwfavbqabaaaaaGccaGLOaGaayzkaaGaey4kaSIaem4qam0aaSbaaSqaaiabdwfavbqabaGccyGGSbaBcqGGUbGBdaqadaqaamaalaaabaGaem4qam0aaSbaaSqaaiabdwfavbqabaaakeaacqWGdbWqdaWgaaWcbaGaemyqaeeabeaakiabgUcaRiabdoeadnaaBaaaleaacqWGvbqvaeqaaaaaaOGaayjkaiaawMcaaiaaxMaacaWLjaWaaeWaaeaacqaIYaGmaiaawIcacaGLPaaaaaa@6123@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The second term, involving <italic>D</italic>(<italic>M</italic>), penalizes model complexity. The choice <italic>D</italic>(<italic>M</italic>) = 2 gives Akaike's information criterion (AIC) [<xref ref-type="bibr" rid="B36">36</xref>], whereas <italic>D</italic>(<italic>M</italic>) = ln(<italic>M</italic>) gives BIC [<xref ref-type="bibr" rid="B37">37</xref>], and <italic>D</italic>(<italic>M</italic>) = 2ln ln(<italic>M</italic>) gives the criterion of Hannan and Quinn (HQC) [<xref ref-type="bibr" rid="B38">38</xref>].</p>
        <p>The penalty in this function is used to avoid over-fitting the data. If there are few incompatibilities the tree for a given position might be large and overfit the data, a well known phenomenon from decision tree literature. A standard way of combating too large trees when building decision trees is to prune any branches where removing the branch improves the score.</p>
        <p>We compute the score in a bottom-up fashion, starting at the leaves and pruning any branch that would decrease the trees score.</p>
        <p>When building the local tree for a locus we include markers in the order determined by their physical distance from the locus in focus (as described above). By considering the split caused by the first marker the root of the decision tree, this ensures that edges inferred from markers closer to the locus are nearer the root of the tree than edges inferred from markers further away from the locus. This is important for a subsequent pruning since pruning is done from the leaves and moving up in the tree, retains splits caused by SNPs close to the point for which the tree was built, while removing splits caused by SNPs further away (when this improves the score). Keeping edges corresponding to nearby sites higher in the tree than edges caused by sites further away is done solely for technical reasons; it lets us weight nearby markers higher, when pruning, than markers further from the current locus. This should in no way be interpreted as meaning that mutations on nearby markers are more likely to be near the root of the local tree than mutations at other markers. The inferred perfect phylogeny is essentially unrooted, and we have no knowledge of where the "real" root should be placed; we simply select a root that simplifies the decision tree pruning. We never prune the split at the root because this would turn the root into one single cluster with no information about the distribution of affected and unaffected individuals. Since we never remove the root split, if there is no significant information in the tree we just get the single marker score. The smaller the MSC value is, the better the tree explains the data. When scoring the trees we look at the difference between the MSC-value of the tree, <italic>T</italic><sub>1</sub>, and the MSC value of the simplest tree, <italic>T</italic><sub>0</sub>, that consists of a single cluster.</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-7-454-i2" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtable columnalign="left">
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>Δ</mml:mi>
                          <mml:mtext>MSC</mml:mtext>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mo>=</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mtext>MSC</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>T</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mtext>MSC</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>T</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow/>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mo>=</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mo>−</mml:mo>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>M</mml:mi>
                                <mml:mi>a</mml:mi>
                              </mml:msub>
                              <mml:mo>⋅</mml:mo>
                              <mml:mi>ln</mml:mi>
                              <mml:mo>⁡</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>M</mml:mi>
                                    <mml:mi>a</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mi>M</mml:mi>
                              </mml:mfrac>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mi>M</mml:mi>
                                <mml:mi>u</mml:mi>
                              </mml:msub>
                              <mml:mo>⋅</mml:mo>
                              <mml:mi>ln</mml:mi>
                              <mml:mo>⁡</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>M</mml:mi>
                                    <mml:mi>u</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mi>M</mml:mi>
                              </mml:mfrac>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow/>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow/>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>2</mml:mn>
                          <mml:mi>ln</mml:mi>
                          <mml:mo>⁡</mml:mo>
                          <mml:mtext>Pr </mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mtext>data</mml:mtext>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mtext>T</mml:mtext>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>K</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>⋅</mml:mo>
                          <mml:mi>D</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>M</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeWadaaabaGaeuiLdqKaeeyta0Kaee4uamLaee4qameabaGaeyypa0dabaGaeeyta0Kaee4uamLaee4qamKaeiikaGIaemivaq1aaSbaaSqaaiabicdaWaqabaGccqGGPaqkcqGHsislcqqGnbqtcqqGtbWucqqGdbWqcqGGOaakcqWGubavdaWgaaWcbaGaeGymaedabeaakiabcMcaPaqaaaqaaiabg2da9aqaaiabgkHiTiabikdaYmaabmaabaGaemyta00aaSbaaSqaaiabdggaHbqabaGccqGHflY1cyGGSbaBcqGGUbGBdaWcaaqaaiabd2eannaaBaaaleaacqWGHbqyaeqaaaGcbaGaemyta0eaaiabgUcaRiabd2eannaaBaaaleaacqWG1bqDaeqaaOGaeyyXICTagiiBaWMaeiOBa42aaSaaaeaacqWGnbqtdaWgaaWcbaGaemyDauhabeaaaOqaaiabd2eanbaaaiaawIcacaGLPaaaaeaaaeaaaeaacqGHRaWkcqaIYaGmcyGGSbaBcqGGUbGBcqqGqbaucqqGYbGCcqqGGaaicqGGOaakcqqGKbazcqqGHbqycqqG0baDcqqGHbqycqGG8baFcqqGubavdaWgaaWcbaGaeGymaedabeaakiabcMcaPiabgkHiTiabcIcaOiabdUealjabgkHiTiabigdaXiabcMcaPiabgwSixlabdseaejabcIcaOiabd2eanjabcMcaPaaacaWLjaGaaCzcamaabmaabaGaeG4mamdacaGLOaGaayzkaaaaaa@8148@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Where <italic>M</italic><sub><italic>a </italic></sub>and <italic>M</italic><sub><italic>u </italic></sub>is the number of affected and unaffected individuals, respectively, in the entire data set. According to [<xref ref-type="bibr" rid="B29">29</xref>] the ΔMSC value is approximately equal to two times the logarithm of the Bayes factor if the BIC model selection criterion is used. This means that it can be used directly as a measure of significance. Since the HQ model selection criterion approximates the same value as the BIC, this correspondence between ΔBIC and significance should also apply to the HQ criterion. This claim is supported by empirical tests shown in the results section.</p>
        <p>Alternatively, statistical significance of a given score is evaluated by a permutation test where the case-control status of all haplotypes is randomly permuted and the tree is pruned again and the score is recalculated. The P-value is then the fraction of permutations where the score is larger than the score obtained from the original data set.</p>
        <p>We have also tried another scoring method for the trees, a method that is not based on the model selection criterion. In this method we give scores to trees by looking only at the subtree that has the most significant over-representation of affected individuals. When scoring a cluster we calculate the probability that the cluster would get a number of affected individuals that is greater than or equal to its present number, if the affected/unaffected status of all the individuals were reassigned at random. This probability is small if there is a significant over-representation of affected individuals in a cluster. The probability that a subtree consisting of <italic>n </italic>individuals has got at least <italic>m </italic>affected individuals is:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-7-454-i3" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>p</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mi>n</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mi>i</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>⋅</mml:mo>
                      <mml:mi>p</mml:mi>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>a</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msup>
                      <mml:mo>⋅</mml:mo>
                      <mml:mi>p</mml:mi>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>u</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>4</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCdaWgaaWcbaGaem4Camhabeaakiabg2da9maaqahabaWaaeWaaeaafaqabeGabaaabaGaemOBa4gabaGaemyAaKgaaaGaayjkaiaawMcaaiabgwSixJqaciab=bhaWjabcIcaOiabdggaHjabcMcaPmaaCaaaleqabaGaemyAaKgaaOGaeyyXICTaemiCaaNaeiikaGIaemyDauNaeiykaKYaaWbaaSqabeaacqWGUbGBcqGHsislcqWGPbqAaaaabaGae8xAaKMaeyypa0JaemyBa0gabaGaemOBa4ganiabggHiLdGccaWLjaGaaCzcamaabmaabaGaeGinaqdacaGLOaGaayzkaaaaaa@533A@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Where <italic>p</italic>(<italic>a</italic>) and <italic>p</italic>(<italic>u</italic>) is the fraction of affected and unaffected individuals, respectively, in the entire data set the score of a tree, <italic>T</italic>, is made from the subtree with the smallest p-value:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-7-454-i4" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtext>Score</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>min</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mtext>subtree</mml:mtext>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>ln</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:msub>
                        <mml:mi>p</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mtext>depth</mml:mtext>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>5</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGtbWucqqGJbWycqqGVbWBcqqGYbGCcqqGLbqzcqGGOaakcqWGubavcqGGPaqkcqGH9aqpdaWfqaqaaiGbc2gaTjabcMgaPjabc6gaUbWcbaGaem4CamNaeyicI4Saee4CamNaeeyDauNaeeOyaiMaeeiDaqNaeeOCaiNaeeyzauMaeeyzauMaeiikaGIaemivaqLaeiykaKcabeaakmaabmaabaGaeyOeI0IagiiBaWMaeiOBa4MaemiCaa3aaSbaaSqaaiabdohaZbqabaGccqGHRaWkcqqGKbazcqqGLbqzcqqGWbaCcqqG0baDcqqGObaAcqGGOaakcqWGZbWCcqGGPaqkaiaawIcacaGLPaaacaWLjaGaaCzcamaabmaabaGaeGynaudacaGLOaGaayzkaaaaaa@61EF@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Where depth(<italic>s</italic>) is the depth of the subtree <italic>s </italic>in the tree ie. the number of markers necessary to determine the subtree. In the results section we refer to this scoring function as the Prob score.</p>
        <p>Figure <xref ref-type="fig" rid="F14">14</xref> illustrates the definition of decicion trees and their associated scores for the 23 markers in the cystic fibrosis data set.</p>
        <fig position="float" id="F14">
          <label>Figure 14</label>
          <caption>
            <p><bold>Local trees for the CF dataset</bold>. Illustration of the decision trees and scores of markers (Prob-score) for the cystic fibrosis data set. In each circle diagram, the case leaves are red and the control leaves green. The branching patterns are defined by the markers included in the segment around the marker in focus, which is also placing the root in the decision tree. The decision trees shown are before pruning is attempted. Pruning collapses som of the branch points. The score is then calculated and can be seen to attain a maximum close the the true location of the the causative mutation (vertical line). The decision trees can also be visually seen to cluster cases more around the causative variant.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-454-14"/>
        </fig>
      </sec>
      <sec>
        <title>Data with many incompatibilities</title>
        <p>With a large sample size, the width of regions where all markers are compatible tends to be very small. Consequently, the markers that can be used to split sampled individuals into clusters are few and the resulting trees will contain only few edges; in the limit, only the single marker for which the tree is built will be used, reducing the method to a single marker association test. To alleviate this problem, we forced a minimum number of markers or a minimum length of sequence to be included. In this case the markers in a region can be incompatible, so we cannot build a perfect phylogeny under the infinite sites model. Instead, when adding a marker to the tree that is incompatible with one or more of the markers already added, we add as many new splits as needed to separate individuals with the 0 allele at the new marker from individuals with the 1 allele in the tree.</p>
        <p>This heuristic approach to dealing with many incompatibilities is clearly not justified by the infinite sites model with recombination; under this model, the resulting tree is clearly a combination of two or more local phylogenies, since the incompatibility implies that at least one recombination has occurred. The splits in the tree, however, still provide information about the local genealogy, and the reasoning behind the heuristic is that this information is not completely lost when combining two or more local trees, as long as the (unknown) number of trees is low. Simulation results (now shown) justifies this, since using the heuristic outperforms relying on single marker association for the regions where no tree can be built using only compatible markers.</p>
      </sec>
    </sec>
    <sec>
      <title>Tests of the algorithm</title>
      <sec>
        <title>Simulated data sets</title>
        <p>We simulated data sets with a known causative locus with one or two responsible mutations using the coalescent based simulator CoaSim [<xref ref-type="bibr" rid="B39">39</xref>]. For each data set, we simulated 20,000 (haploid) sequences and paired them up randomly to obtain (phased) genotype data sets. The sequences were simulated with scaled recombination rate <italic>ρ </italic>= 40-corresponding to 0.1 centi-Morgan assuming an effective population size of 10,000, or roughly 100 Kbp assuming 1 cM = 1 Mbp – and with 200 SNP markers placed uniformly at random over the sequence.</p>
        <p>For a fixed simulated ancestral recombination graph, rejection sampling was used to ensure that all minor allele frequencies of the SNP markers were above 10%, reflecting a typical SNP selection bias. The causative locus was placed uniformly at random on the simulated sequence, and we simulated either one or two mutations on the locus, rejecting the entire simulation when the mutant allele frequency was outside the range 18%–22%, for the single mutation case, or outside the range 9%–11% for both mutations in the two mutation cases. We assigned affected status using probabilities:</p>
        <p><italic>P </italic>(affected | homozygote mutant) = 0.20</p>
        <p><italic>P </italic>(affected | heterozygote) = 0.08</p>
        <p><italic>P </italic>(affected | homozygote wild - type) = 0.05</p>
        <p>After assigning affected/unaffected status to the simulated individuals, we randomly selected an equal number of affected and unaffected as our test data set. From the simulated genotypes we made data sets of two sizes; large data sets where we selected 500 affected and 500 unaffected individuals (or 1000 haploid sequences of each class) and small data sets where we selected 100 affected and 100 unaffected individuals (or 200 haploid sequences of each class).</p>
      </sec>
      <sec>
        <title>Artificial data sets created from HapMap</title>
        <p>A random 1 Mb section (chromosome 3, position 64893548–65893547, containing 1646 SNPs) of the HapMap data from the Chinese and Japanese populations (90 independent individuals in total) were downloaded from the HapMap home page [<xref ref-type="bibr" rid="B40">40</xref>]. For each of the 90 unphased genotypes (with missing data) 50 different genotype configurations without missing data were sampled using fastPHASE [<xref ref-type="bibr" rid="B41">41</xref>] resulting in a data set with 4500 genotypes. The sampling utilises that fastPHASE estimates probabilities of all possible haplotypes consistent with the sampled genotypes, and additional haplotypes were sampled using these probabilities. From this data set a marker with minor allele frequency in the range 20%–30% was subsequently treated as causing a disease imitation. The genotypes in the sample were given status as case or control based on the value at the marker with probabilities:</p>
        <p><italic>P </italic>(affected | homozygote mutant) = 0.30</p>
        <p><italic>P </italic>(affected | heterozygote) = 0.15</p>
        <p><italic>P </italic>(affected | homozygote wild - type) = 0.075</p>
        <p>Next the data set was created by sampling 500 cases and 500 controls from the sample and 400 of the markers whereupon analyses were performed using our algorithm and SMA. After determining disease status for the simulated individuals, the marker at the selected disease locus was removed. This procedure was repeated to make 500 different data sets.</p>
      </sec>
      <sec>
        <title>Tests on real data sets</title>
        <p>To test our method on real data, we used the CF data set described in [<xref ref-type="bibr" rid="B32">32</xref>] the CYP2D6 data set described in [<xref ref-type="bibr" rid="B33">33</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: Blossoc</p>
    <p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="http://www.daimi.au.dk/~mailund/Blossoc"/></p>
    <p><bold>Operating system(s)</bold>: Binaries available for Intel Linux; should compile on all platforms with C++ and Qt 3 for the GUI version.</p>
    <p><bold>Programming language</bold>: C++</p>
    <p><bold>Licence</bold>: GNU GPL</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>TM conceived the original approach and all authors participated in developing it. TM and SB implemented the method in the software package Blossoc and SB conducted the experiments. All authors participated in drafting the manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank R. Sainudiin and Y. Song for fruitful discussions and tests of the software, and E.B. Knudsen for improving the English of this manuscript. We are grateful to E. Waldron for providing data for the comparison in Fig. <xref ref-type="fig" rid="F8">8</xref>, to S. Zöllner and J. Pritchard for providing data for the comparison in Fig. <xref ref-type="fig" rid="F9">9</xref>, to H. Toivonen for providing the data for the comparison in Fig. <xref ref-type="fig" rid="F7">7</xref> and to L. Hosking for providing access to the CYP2D6 dataset [<xref ref-type="bibr" rid="B33">33</xref>].</p>
      <p>TM is funded by the Danish Research Agency, FNU grant 272-05-0283 and FTP grant 274-05-0365. MHS acknowledges support from SJVF grant 2052-01-0032.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>International HapMap Consortium</collab>
        </person-group>
        <article-title>A haplotype map of the human genome</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>1299</fpage>
        <lpage>1320</lpage>
        <pub-id pub-id-type="pmid">16255080</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature04226</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Evaluating coverage of genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>659</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="pmid">16715099</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1801</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reich</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>On the allelic spectrum of human disease</article-title>
        <source>Trends Genet</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>502</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="pmid">11525833</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(01)02410-6</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsuzaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Loi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Di</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hubbell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berntsen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chadha</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hui</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Cawley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>SPA</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Genotyping over 100,000 SNPs on a pair of oligonucleotide arrays</article-title>
        <source>Nat Methods</source>
        <year>2004</year>
        <volume>1</volume>
        <fpage>109</fpage>
        <lpage>111</lpage>
        <comment>[Evaluation Studies]</comment>
        <pub-id pub-id-type="pmid">15782172</pub-id>
        <pub-id pub-id-type="doi">10.1038/nmeth718</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arking</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pfeufer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Post</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Newton-Cheh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kashuk</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Akyol</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jalilzadeh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Illig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gieger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wichmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marban</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>O'donnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hirschhorn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Spooner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Meitinger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A common genetic variant in the NOS1 regulator NOS1AP modulates cardiac repolarization</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>644</fpage>
        <lpage>651</lpage>
        <pub-id pub-id-type="pmid">16648850</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1790</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burren</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Smink</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Guja</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ionescu-Tirgoviste</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Widmer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dunger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Todd</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A genome-wide association study of nonsynonymous SNPs identifies a type 1 diabetes locus in the interferon-induced helicase (IFIH1) region</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>617</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="pmid">16699517</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1800</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amundadottir</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Sulem</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gudmundsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Helgason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Agnarsson</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Sigurdsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Benediktsdottir</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Cazier</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Sainz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jakobsdottir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Magnusdottir</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Agnarsson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Birgisdottir</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Le Roux</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Olafsdottir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blondal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Andresdottir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gretarsdottir</surname>
            <given-names>OS</given-names>
          </name>
          <name>
            <surname>Bergthorsson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gylfason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thorleifsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Manolescu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kristjansson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Geirsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Isaksson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Douglas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johansson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Balter</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wiklund</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Montie</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Suarez</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cooney</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Gronberg</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Catalona</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Einarsson</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Barkardottir</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Gulcher</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thorsteinsdottir</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Stefansson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A common variant associated with prostate cancer in European and African populations</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>652</fpage>
        <lpage>658</lpage>
        <pub-id pub-id-type="pmid">16682969</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1808</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skol</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Boehnke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Joint analysis is more efficient than replication-based analysis for two-stage genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>209</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="pmid">16415888</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1706</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gebregziabher</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Two-Stage sampling designs for gene association studies</article-title>
        <source>Genet Epidemiol</source>
        <year>2004</year>
        <volume>27</volume>
        <fpage>401</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="pmid">15543639</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.20047</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pe'er</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yelensky</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Evaluating and improving power in whole-genome association studies using fixed marker sets</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>663</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="pmid">16715096</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1816</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Marjoram</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Ancestral inference from samples of DNA sequences with recombination</article-title>
        <source>J Comput Biol</source>
        <year>1996</year>
        <volume>3</volume>
        <fpage>479</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">9018600</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larribe</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lessard</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schork</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>Gene mapping via the ancestral recombination graph</article-title>
        <source>Theor Popul Biol</source>
        <year>2002</year>
        <volume>62</volume>
        <fpage>215</fpage>
        <lpage>229</lpage>
        <pub-id pub-id-type="pmid">12167358</pub-id>
        <pub-id pub-id-type="doi">10.1006/tpbi.2002.1601</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reeve</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>High-resolution multipoint linkage-disequilibrium mapping in the context of a human genome sequence</article-title>
        <source>Am J Hum Genet</source>
        <year>2001</year>
        <volume>69</volume>
        <fpage>159</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="pmid">11410841</pub-id>
        <pub-id pub-id-type="doi">10.1086/321279</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Fine-scale mapping of disease loci via shattered coalescent modeling of genealogies</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>70</volume>
        <fpage>686</fpage>
        <lpage>707</lpage>
        <pub-id pub-id-type="pmid">11836651</pub-id>
        <pub-id pub-id-type="doi">10.1086/339271</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Sabatti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Keats</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Bayesian analysis of haplotypes for linkage disequilibrium mapping</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1716</fpage>
        <lpage>1724</lpage>
        <pub-id pub-id-type="pmid">11591648</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.194801</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molitor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marjoram</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fine-scale mapping of disease genes with multiple mutations via spatial clustering techniques</article-title>
        <source>Am J Hum Genet</source>
        <year>2003</year>
        <volume>73</volume>
        <fpage>1368</fpage>
        <lpage>1384</lpage>
        <pub-id pub-id-type="pmid">14631555</pub-id>
        <pub-id pub-id-type="doi">10.1086/380415</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rafnar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Thorlacius</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steingrimsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Madsen</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Calian</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Eldon</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thorgeirsson</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>The Icelandic Cancer Project-a population-wide approach to studying cancer</article-title>
        <source>Nat Rev Cancer</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>488</fpage>
        <lpage>492</lpage>
        <pub-id pub-id-type="pmid">15170451</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrc1371</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Little loss of information due to unknown phase for fine-scale linkage-disequilibrium mapping with single-nucleotide-polymorphism genotype data</article-title>
        <source>Am J Hum Genet</source>
        <year>2004</year>
        <volume>74</volume>
        <fpage>945</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="pmid">15077198</pub-id>
        <pub-id pub-id-type="doi">10.1086/420773</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Hubisz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Ascertainment bias in studies of human genome-wide polymorphism</article-title>
        <source>Genome Res</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1496</fpage>
        <lpage>1502</lpage>
        <pub-id pub-id-type="pmid">16251459</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.4107905</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toivonen</surname>
            <given-names>HT</given-names>
          </name>
          <name>
            <surname>Onkamo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vasko</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sevon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mannila</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Herr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kere</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Data mining applied to linkage disequilibrium mapping</article-title>
        <source>Am J Hum Genet</source>
        <year>2000</year>
        <volume>67</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="pmid">10848493</pub-id>
        <pub-id pub-id-type="doi">10.1086/302954</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-based linkage disequilibrium mapping via direct data mining</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>4384</fpage>
        <lpage>4393</lpage>
        <pub-id pub-id-type="pmid">16249262</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti732</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durrant</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zondervan</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Linkage disequilibrium mapping via cladistic analysis of single-nucleotide polymorphism haplotypes</article-title>
        <source>Am J Hum Genet</source>
        <year>2004</year>
        <volume>75</volume>
        <fpage>35</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="pmid">15148658</pub-id>
        <pub-id pub-id-type="doi">10.1086/422174</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bardel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Danjean</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hugot</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Darlu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Génin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>On the use of haplotype phylogeny to detect disease susceptibility loci</article-title>
        <source>BMC Genet</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>24</fpage>
        <pub-id pub-id-type="pmid">15904492</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2156-6-24</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Templeton</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Maxwell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stengård</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sing</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Tree scanning: a method for using haplotype trees in phenotype/genotype association studies</article-title>
        <source>Genetics</source>
        <year>2005</year>
        <volume>169</volume>
        <fpage>441</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">15371364</pub-id>
        <pub-id pub-id-type="doi">10.1534/genetics.104.030080</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zöllner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Coalescent-based association mapping and fine mapping of complex trait loci</article-title>
        <source>Genetics</source>
        <year>2005</year>
        <volume>169</volume>
        <fpage>1071</fpage>
        <lpage>1092</lpage>
        <pub-id pub-id-type="pmid">15489534</pub-id>
        <pub-id pub-id-type="doi">10.1534/genetics.104.031799</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sevon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Toivonen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>TreeDT: Tree pattern mining for gene mapping</article-title>
        <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>174</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="pmid">17048403</pub-id>
        <pub-id pub-id-type="doi">10.1109/TCBB.2006.28</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations</article-title>
        <source>Genetics</source>
        <year>1969</year>
        <volume>61</volume>
        <fpage>893</fpage>
        <lpage>903</lpage>
        <pub-id pub-id-type="pmid">5364968</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>Statistical properties of the number of recombination events in the history of a sample of DNA sequences</article-title>
        <source>Genetics</source>
        <year>1985</year>
        <volume>111</volume>
        <fpage>147</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">4029609</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Raftery</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayesian Model Selection in Social Research</article-title>
        <source>Sociological Methodology</source>
        <year>1995</year>
        <ext-link ext-link-type="uri" xlink:href="http://citeseer.ist.psu.edu/raftery95bayesian.html"/>
        <comment>[With discussion by Andrew Gelman, Donald B. Rubin, and Robert M. Hauser, and a rejoinder]</comment>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Wiuf</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>Gene genealogies variation and evolution – A primer in coalescent theory</source>
        <year>2005</year>
        <publisher-name>Oxford University Press</publisher-name>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waldron</surname>
            <given-names>ERB</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Fine mapping of disease genes via haplotype clustering</article-title>
        <source>Genet Epidemiol</source>
        <year>2006</year>
        <volume>30</volume>
        <fpage>170</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="pmid">16385468</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.20134</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerem</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rommens</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Buchanan</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Markiewicz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buchwald</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>LC</given-names>
          </name>
        </person-group>
        <article-title>Identification of the cystic fibrosis gene: genetic analysis</article-title>
        <source>Science</source>
        <year>1989</year>
        <volume>245</volume>
        <fpage>1073</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="pmid">2570460</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.2570460</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosking</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Nissum</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cantone</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Purvis</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Khakhar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Liberwirth</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hagen-Mann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ehm</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Riley</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Linkage disequilibrium mapping identifies a 390 kb region associated with CYP2D6 poor drug metabolising activity</article-title>
        <source>Pharmacogenomics J</source>
        <year>2002</year>
        <volume>2</volume>
        <fpage>165</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">12082588</pub-id>
        <pub-id pub-id-type="doi">10.1038/sj.tpj.6500096</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide strategies for detecting multiple loci that influence complex diseases</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>413</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="pmid">15793588</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1537</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for inferring evolutionary trees</article-title>
        <source>Networks</source>
        <year>1991</year>
        <volume>21</volume>
        <fpage>19</fpage>
        <lpage>28</lpage>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akaike</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fitting autoregressive models for prediction</article-title>
        <source>Ann Institute of Statistical Mathematics</source>
        <year>1969</year>
        <volume>21</volume>
        <fpage>243</fpage>
        <lpage>247</lpage>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>The Annals of Statistics</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hannan</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>The determination of the Order of an autoregression</article-title>
        <source>Journal of the Royal Statistical Society Series B</source>
        <year>1979</year>
        <volume>41</volume>
        <fpage>190</fpage>
        <lpage>195</lpage>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mailund</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mechlenborg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Madsen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schauser</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CoaSim: A flexible environment for simulating genetic data under coalescent models</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <pub-id pub-id-type="pmid">16225674</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="other">
        <article-title>The HapMap Project</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.hapmap.org"/>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>629</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="pmid">16532393</pub-id>
        <pub-id pub-id-type="doi">10.1086/502802</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Mailund</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>CNS</given-names>
          </name>
          <name>
            <surname>Madsen</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schauser</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>GeneRecon-a coalescent based tool for fine-scale association mapping</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <comment/>
      </citation>
    </ref>
  </ref-list>
</back>
