<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8058774</article-id>
    <article-id pub-id-type="pmid">32745185</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa692</article-id>
    <article-id pub-id-type="publisher-id">btaa692</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pyGenomeTracks: reproducible plots for multivariate genomic datasets </article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1964-4960</contrib-id>
        <name>
          <surname>Lopez-Delisle</surname>
          <given-names>Lucille</given-names>
        </name>
        <aff><institution>UPDUB, ISREC Department, School of Life Sciences (SV), EPFL,</institution> 1015 Lausanne, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rabbani</surname>
          <given-names>Leily</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Max Planck Institute of Immunobiology and Epigenetics</institution>, 79108 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9985-955X</contrib-id>
        <name>
          <surname>Wolff</surname>
          <given-names>Joachim</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bhardwaj</surname>
          <given-names>Vivek</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Max Planck Institute of Immunobiology and Epigenetics</institution>, 79108 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg, <country country="DE">Germany</country></aff>
        <aff><institution>Signalling Research Centres BIOSS and CIBSS, University of Freiburg</institution>, 79104 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grüning</surname>
          <given-names>Björn</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, 79110 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9142-417X</contrib-id>
        <name>
          <surname>Ramírez</surname>
          <given-names>Fidel</given-names>
        </name>
        <xref rid="btaa692-cor1" ref-type="corresp"/>
        <aff><institution>Bioinformatics Group, Max Planck Institute of Immunobiology and Epigenetics</institution>, 79108 Freiburg, <country country="DE">Germany</country></aff>
        <!--fidel.ramirez@boehringer-ingelheim.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manke</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Max Planck Institute of Immunobiology and Epigenetics</institution>, 79108 Freiburg, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Peter</surname>
          <given-names>Robinson</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa692-cor1">To whom correspondence should be addressed. <email>fidel.ramirez@boehringer-ingelheim.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-03">
      <day>03</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>3</issue>
    <fpage>422</fpage>
    <lpage>423</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>21</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa692.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Generating publication ready plots to display multiple genomic tracks can pose a serious challenge. Making desirable and accurate figures requires considerable effort. This is usually done by hand or using a vector graphic software.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>pyGenomeTracks (PGT) is a modular plotting tool that easily combines multiple tracks. It enables a reproducible and standardized generation of highly customizable and publication ready images.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>PGT is available through a graphical interface on <ext-link xlink:href="https://usegalaxy.eu" ext-link-type="uri">https://usegalaxy.eu</ext-link> and through the command line. It is provided on conda via the bioconda channel, on pip and it is openly developed on github: <ext-link xlink:href="https://github.com/deeptools/pyGenomeTracks" ext-link-type="uri">https://github.com/deeptools/pyGenomeTracks</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Deutsche Forschungsgemeinschaft</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>192904750</award-id>
        <award-id>SFB 992</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Federal Ministry of Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>031 A538A</award-id>
        <award-id>031 L0101C</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Research Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Germany’s Excellence Strategy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>390939984</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ecole Polytechnique Fédérale</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>RegulHox</institution>
          </institution-wrap>
        </funding-source>
        <award-id>588029</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The analysis and visualization of multivariate genomic data faces several challenges. On one hand, there is a wide range of processing steps needed to analyze and to summarize large-scale data at a genome-wide level. Considerable effort has led to efficient tools as well as the adoption of scalable pipelines and frameworks, which provide a high degree of standardization and reproducibility (<xref rid="btaa692-B2" ref-type="bibr">Bhardwaj <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa692-B4" ref-type="bibr">Grüning <italic toggle="yes">et al.</italic>, 2018</xref>). On the other hand, advanced tools have been developed to support the visualization of genome-wide information and global patterns (<xref rid="btaa692-B3" ref-type="bibr">Gehlenborg <italic toggle="yes">et al.</italic>, 2010</xref>). However, to turn genome-wide insights into testable interventions and validation experiments, researchers will usually return to locus-specific exploration. This is possible with a wide range of interactive genome browsers (<xref rid="btaa692-B8" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2011</xref>), and advanced browsers for three-dimensional data (<xref rid="btaa692-B5" ref-type="bibr">Kerpedjiev <italic toggle="yes">et al.</italic>, 2018</xref>). Unfortunately, this exploration process is hard to standardize and yields heavily post-processed ‘snapshots’ to communicate the results. With pyGenomeTracks (PGT), we present a new and open software, which helps to standardize the generation of high-quality images in a programmatic approach. PGT supports the integrated visualization for a large variety of data sources, such as gene annotations, gene expression, chromatin signals and chromatin interactions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>PGT provides an opportunity to map several genomic data tracks from a variety of resources onto one or a given list of genomic coordinates and generates an image per given coordinate including all of the input tracks. It offers support for a wide range of standard data formats in bioinformatics such as bigwig, bedgraph, epilogos, bed, gtf, narrow peaks, cool and HiCExplorer’s native h5 format.</p>
    <p>The only preprocessing step to generate a multitracks plot is to prepare a configuration file which contains all necessary parameters to plot the desired tracks of multiple input files. PGT provides a simple script (<italic toggle="yes">make_tracks_file</italic>) to generate a configuration file from a collection of input files. A usage example of it is shown in Supplementary Section S1.</p>
    <p>This configuration file defines best practice, but it can also be fully customized by the user. In a configuration file, each track is defined as a block of parameters starting with its name <italic toggle="yes">[track name]</italic> and continues with the parameters for that track such as the file location, its title, height, color and so on, as has been shown in the Supplementary Section S1.</p>
    <p>For the plot generation, users need to define the precise genomic coordinates either by providing a single coordinate or by providing a bed file with multiple genomic regions. PGT supports several output formats such as <italic toggle="yes">eps, pdf, pgf, png, ps, raw, rgba, svg</italic> and <italic toggle="yes">svgz</italic>, which offers a broad degree of flexibility. The tool can easily generate the requested figure by running a single command line as has been presented below.</p>
    <p>
      <monospace>$ pyGenomeTracks ––tracks tracks.ini ––region \</monospace>
    </p>
    <p>
      <monospace>chr2L:8050000-8300000 ––outFileName image.pdf</monospace>
    </p>
    <p>Moreover, for users who prefer a graphical interface, PGT is available as a tool on the European Galaxy server <ext-link xlink:href="https://usegalaxy.eu" ext-link-type="uri">https://usegalaxy.eu</ext-link>, and can be installed on any local Galaxy instance (<xref rid="btaa692-B1" ref-type="bibr">Afgan <italic toggle="yes">et al.</italic>, 2016</xref>) via ToolShed (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
    <p>To illustrate the functionality of PGT, <xref rid="btaa692-F1" ref-type="fig">Figure 1</xref> provides an example of a multitrack visualization from an integrated multiomics screen (<xref rid="btaa692-B7" ref-type="bibr">Ramírez <italic toggle="yes">et al.</italic>, 2018</xref>) generated with PGT version 3.5. Please refer to the <xref rid="sup1" ref-type="supplementary-material">Supplementary Data</xref> for additional examples and a detailed documentation is available on <ext-link xlink:href="https://pygenometracks.readthedocs.io" ext-link-type="uri">https://pygenometracks.readthedocs.io</ext-link>.</p>
    <fig position="float" id="btaa692-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>An example plot generated by PGT on <italic toggle="yes">Drosophila melanogaster</italic> (dm3) data, Kc167 cell line. The first track from the top shows the genomic locus (chromosome 2L 8.05–8.31 Mb). The second track illustrates a Hi-C matrix track (<xref rid="btaa692-B6" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2015</xref>) overlaid by its detected TADs, via HiCExplorer and a coverage profile of CP190 ChIP. The matrix was in HiCExplorer h5 format, TADs are given as a bed file which is a direct output of HiCExplorer’s hicFindTADs and the ChIP-Seq profile is provided as a bigwig file. The succeeding track shows the chromatin states, provided as a bed file, where the colors used are as defined in the ninth field of the bed file. The next track visualizes the TAD separation scores, the data are presented in a bedgraph matrix file format from HiCExplorer hicFindTADs. The green track shows a filled-out curve representation of the data from H3K36me3 histone mark, provided as a bigwig file along with an additional horizontal threshold line as well as a scale bar indicating the distance between two different peaks of interest. The blue arcs show artificially created links that could be contacts between different CP190 peaks. Finally, the last track is a gene track of dm3, available in bed format. The configuration file is available in Supplementary Section S3</p>
      </caption>
      <graphic xlink:href="btaa692f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>With PGT, it is possible to integrate multiple data sources from a wide variety of genomics assays and to generate publication ready plots. The presence of a configuration file (.ini file) provides flexibility to easily change or reorder the data tracks. To ensure maximal reproducibility, PGT also uses conda, which allows specific versions of all dependent tools to be flexibly chosen. This approach enables other researchers to readily reproduce the images and validate them swiftly. The supported output file formats, such as eps, svg or png, offer a high degree of freedom to generate plots in standardized formats which are required by a variety of major journals. PGT can be used as a command line or Galaxy-based tool. The latter is available on <ext-link xlink:href="https://usegalaxy.eu" ext-link-type="uri">https://usegalaxy.eu</ext-link> with all configuration options, or it can be installed on any local Galaxy instance. It provides an easy way for users to run their analysis on Galaxy in a transparent and reproducible way. PGT presents a well-structured approach for generating genomics data plots and can also be used in automated workflow processing.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) – Project-ID 192904750 – SFB 992. German Federal Ministry of Education and Research [031 A538A de. NBI-RBC awarded to R.B.; 031 L0101C de. NBI-epi awarded to B.G.]. R.B. was supported by the German Research Foundation (DFG) under Germany’s Excellence Strategy [CIBSS-EXC-2189-Project ID 390939984]. We acknowledge funding from the Ecole Polytechnique Fédérale (EPFL, Lausanne). LD was paid by the European Research Council (ERC) grant RegulHox (No 588029). </p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa692_Supplementary_Data</label>
      <media xlink:href="btaa692_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa692-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Afgan</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2016 update</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W3</fpage>–<lpage>W10</lpage>.<pub-id pub-id-type="pmid">27137889</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhardwaj</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>snakepipes: facilitating flexible, scalable and integrative epigenomic analysis</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4757</fpage>–<lpage>4759</lpage>.<pub-id pub-id-type="pmid">31134269</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gehlenborg</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Visualization of omics data for systems biology</article-title>. <source>Nat. Methods</source>, <volume>7</volume>, <fpage>S56</fpage>–<lpage>S68</lpage>.<pub-id pub-id-type="pmid">20195258</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal>; The Bioconda Team. (<year>2018</year>) 
<article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>475</fpage>–<lpage>476</lpage>.<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kerpedjiev</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>HiGlass: web-based visual exploration and analysis of genome interaction maps</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Widespread rearrangement of 3D chromatin organization underlies polycomb-mediated stress-induced silencing</article-title>. <source>Mol. Cell</source>, <volume>58</volume>, <fpage>216</fpage>–<lpage>231</lpage>.<pub-id pub-id-type="pmid">25818644</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramírez</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>High-resolution tads reveal DNA sequences underlying genome organization in flies</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
    <ref id="btaa692-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol</source>., <volume>29</volume>, <fpage>24</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
