<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neuroinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neuroinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neuroinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5196</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8782204</article-id>
    <article-id pub-id-type="doi">10.3389/fninf.2021.773890</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BrainQuake: An Open-Source Python Toolbox for the Stereoelectroencephalography Spatiotemporal Analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cai</surname>
          <given-names>Fang</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1599947/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Kang</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1599950/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Tong</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1599981/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Haixiang</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1355160/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Wenjing</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/386007/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hong</surname>
          <given-names>Bo</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">
          <sup>*</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/12839/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Biomedical Engineering, School of Medicine, Tsinghua University</institution>, <addr-line>Beijing</addr-line>, <country>China</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Epilepsy Center, Yuquan Hospital, Tsinghua University</institution>, <addr-line>Beijing</addr-line>, <country>China</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Ting Zhao, Janelia Research Campus, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Dingguo Zhang, University of Bath, United Kingdom; Shuang Wang, Zhejiang University, China</p>
      </fn>
      <corresp id="c001">*Correspondence: Bo Hong <email>hongbo@tsinghua.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>773890</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Cai, Wang, Zhao, Wang, Zhou and Hong.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Cai, Wang, Zhao, Wang, Zhou and Hong</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Intracranial stereoelectroencephalography (SEEG) is broadly used in the presurgical evaluation of intractable epilepsy, due to its high temporal resolution in neural activity recording and high spatial resolution within suspected epileptogenic zones. Neurosurgeons or technicians face the challenge of conducting a workflow of post-processing operations with the multimodal data (e.g., MRI, CT, and EEG) after the implantation surgery, such as brain surface reconstruction, electrode contact localization, and SEEG data analysis. Several software or toolboxes have been developed to take one or more steps in the workflow but without an end-to-end solution. In this study, we introduced BrainQuake, an open-source Python software for the SEEG spatiotemporal analysis, integrating modules and pipelines in surface reconstruction, electrode localization, seizure onset zone (SOZ) prediction based on ictal and interictal SEEG analysis, and final visualizations, each of which is highly automated with a user-friendly graphical user interface (GUI). BrainQuake also supports remote communications with a public server, which is facilitated with automated and standardized preprocessing pipelines, high-performance computing power, and data curation management to provide a time-saving and compatible platform for neurosurgeons and researchers.</p>
    </abstract>
    <kwd-group>
      <kwd>epilepsy</kwd>
      <kwd>stereoelectroencephalography</kwd>
      <kwd>electrode localization</kwd>
      <kwd>Epileptogenicity Index</kwd>
      <kwd>interictal high-frequency oscillation</kwd>
      <kwd>Hough Transform</kwd>
    </kwd-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="0"/>
      <equation-count count="3"/>
      <ref-count count="41"/>
      <page-count count="15"/>
      <word-count count="9214"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Nearly 30% of the patients with epilepsy eventually become intractable patients resistant to antiepileptic drugs (Kwan and Brodie, <xref rid="B23" ref-type="bibr">2000</xref>). To these patients, the intracranial stereoelectroencephalography (SEEG) surgery, first developed by Talairach and Bancaud at the Hospital Sainte Anne, Paris (Bancaud et al., <xref rid="B3" ref-type="bibr">1965</xref>), is now a common clinical approach to consider about. SEEG aims at identifying the epileptogenic zones (EZs; Rosenow and Lüders, <xref rid="B33" ref-type="bibr">2001</xref>) in the suspicious area of the brain of an individual by implanting depth electrodes and capturing the abnormal neural activities, followed by a resection or thermocoagulation surgery (Cossu et al., <xref rid="B10" ref-type="bibr">2015</xref>; Wang et al., <xref rid="B38" ref-type="bibr">2020</xref>). During this procedure, a large number of neurodata with multiple modalities occur. Presurgical MRI T1 structural image and CT image after the implantation surgery can, respectively, be taken as information for brain surface reconstruction and SEEG electrode localization (Behrens et al., <xref rid="B6" ref-type="bibr">1994</xref>; Dykstra et al., <xref rid="B14" ref-type="bibr">2012</xref>). Neural activities before the resection surgery are recorded with SEEG electrodes for EZ localization and lesion analysis, usually lasting for 2 weeks. The neural activity acquired during the 2-week SEEG recording is vital to the presurgical planning (Cossu et al., <xref rid="B10" ref-type="bibr">2015</xref>) and of great value to brain research (Zhang et al., <xref rid="B39" ref-type="bibr">2019</xref>; Akkol et al., <xref rid="B1" ref-type="bibr">2021</xref>). However, exploiting the large number of multimodal neurodata and managing them effectively remain a problem to be solved.</p>
    <p>The SEEG electrode localization procedure using co-registered MR and CT images provides neurosurgeons with accurate anatomical positions of the implanted electrode contacts (Dykstra et al., <xref rid="B14" ref-type="bibr">2012</xref>). The traditional and broadly used method of electrode contact localization mostly depends on visual checking and manual operations (Darcey and Roberts, <xref rid="B13" ref-type="bibr">2010</xref>). After the registration of MR and CT images, technicians view the CT image slice by slice, locating highlighted contact voxels and mapping the positions onto the MRI (Darcey and Roberts, <xref rid="B13" ref-type="bibr">2010</xref>). Trouble occurs since every patient may have 100 contacts implanted on average, and one should check the slices back and forth for a highlighted contact centroid, which is a complicated and time-consuming task. Several previous studies have proposed semiautomated methods (Blenkmann et al., <xref rid="B7" ref-type="bibr">2017</xref>; Hamilton et al., <xref rid="B17" ref-type="bibr">2017</xref>; Narizzano et al., <xref rid="B25" ref-type="bibr">2017</xref>; Qin et al., <xref rid="B28" ref-type="bibr">2017</xref>; Li et al., <xref rid="B24" ref-type="bibr">2019</xref>) to improve the effectiveness and precision of electrode contact localization. The SEEG Assistant (SEEGA) extension of the 3D Slicer applies an algorithm of the center-of-mass convergence for the contact segmentation step (Arnulfo et al., <xref rid="B2" ref-type="bibr">2015</xref>; Narizzano et al., <xref rid="B25" ref-type="bibr">2017</xref>), which shows great feasibility and robustness in locating contacts along each electrode shaft. However, this method requires a prior manually defined fiducial file of the planned starting and ending points of each electrode and an additional presurgical CT scanning. Another study (Qin et al., <xref rid="B28" ref-type="bibr">2017</xref>) inherits the convergence algorithm and develops a preprocessing workflow to reduce the required input. This workflow includes MRI and CT registration, masking, eroding, and clustering steps but still needs to insert several pause points for visual checking and manual adjustments. Another toolbox (Blenkmann et al., <xref rid="B7" ref-type="bibr">2017</xref>) implements a k-means clustering algorithm to segment contacts along each electrode, in which the voxels of each electrode should be carefully thresholded, otherwise the contacts may not be completely segmented.</p>
    <p>In the clinical SEEG data analysis, doctors are mainly concerned about the effect of a few episodes of ictal data for the location of EZs. Channels with relatively early abnormal activity during the seizure often indicate the potential EZs. A previous study defined an Epileptogenicity Index (EI) using the onset of high-frequency energy to predict the onset area (Bartolomei et al., <xref rid="B5" ref-type="bibr">2008</xref>). However, in some cases, the onset period may not be captured to provide sufficient diagnostic information. In contrast to only a few seizures during the monitoring period, most of the SEEG signals recorded are seemingly ordinary interictal data. The sporadic abnormal activities in the interictal interval, such as spikes or high-frequency oscillations (HFOs), can be used as plausible pathological markers of EZs. Because the intracranial EEG recording consumes huge storage space, recording an 80-channel intracranial EEG at a sampling rate of 2,000 Hz for 24 h may generate a data volume of about 50 GB. It is time-consuming for surgeons to extract sparse interictal pathological activities from the long-term SEEG. Currently, the interictal data cannot be fully and effectively traversed by surgeons and thus is usually deleted. The value of the interictal data is mostly underestimated. Therefore, there is an urgent need to detect abnormal activities in interictal SEEG data to extract pathological information and reduce the workload of clinicians. Both HFO activities (Navarrete et al., <xref rid="B26" ref-type="bibr">2016</xref>) and spike detection algorithms (Barkmeier et al., <xref rid="B4" ref-type="bibr">2012</xref>) have been developed based on waveform morphology, but indexation methods that efficiently extract interictal epileptic discharge events are yet to be developed. In addition, the performance of current interictal event detection methods heavily depends on the manual selection of the parameters (Remakanthakurup Sindhu et al., <xref rid="B29" ref-type="bibr">2020</xref>). Our interictal data analysis module is designed to minimize manual interference by implementing an automatic HFO detection method and retaining only necessary parameter settings such as filter ranges and channel selections.</p>
    <p>After electrode localization and data analysis, cortical surface reconstruction is an essential step for better visualization. Several previous studies have developed the reconstruction procedure (Dale et al., <xref rid="B11" ref-type="bibr">1999</xref>; Fischl, <xref rid="B15" ref-type="bibr">2012</xref>; Henschel et al., <xref rid="B18" ref-type="bibr">2020</xref>; Zöllei et al., <xref rid="B41" ref-type="bibr">2020</xref>). FreeSurfer group releases tools and pipelines publicly (Fischl, <xref rid="B15" ref-type="bibr">2012</xref>). They built a reconstruction pipeline, “recon-all,” covering from primary operations such as motion correction and skull-stripping, to final steps such as segmentation and cortical parcellation. Several subsequent studies have also proposed advanced reconstruction tools such as specifically, “infant-FreeSurfer” (Zöllei et al., <xref rid="B41" ref-type="bibr">2020</xref>) for covering all ages of subjects and “FastSurfer” deep learning pipeline (Henschel et al., <xref rid="B18" ref-type="bibr">2020</xref>) for solving the time-consuming problem. However, FreeSurfer software and its advanced tools can only be executed on Linux-based operating systems (OS). Virtual machine configuration and the usage of terminal lines can be troublesome for some Windows users. Moreover, there is often a lack of local computing power for rapid surface reconstruction in the clinical setting.</p>
    <p>In this study, we present BrainQuake, an open-source Python software, providing epilepsy surgeons with tools and integrated pipelines of surface reconstruction, electrode contact localization, and ictal and interictal SEEG analysis for presurgical evaluations. The integration aims at automatically executing the whole workflow with fewer input files and fewer pause points. BrainQuake is designed as an end-to-end, highly automated, time-saving software, free to be downloaded and compatible with both Linux and Windows OS. With a comprehensive data processing platform established, surgeons can take the most advantage of neurodata and make reliable presurgical evaluations for those epilepsy patients. We hope this software can be helpful to clinical practice and human neuroscience studies using SEEG.</p>
  </sec>
  <sec id="s2">
    <title>Materials and Requirements</title>
    <sec>
      <title>Software Overview</title>
      <p>BrainQuake is an open-source Python software for image and SEEG data processing of refractory epilepsy patients. BrainQuake consists of four modules, namely, surface module, electrode module, ictal module, and interictal modules (<xref rid="F1" ref-type="fig">Figure 1</xref>). The surface module is used for surface reconstruction of the MRI T1 image of the patient. We incorporated a GUI, a client-server communication mode, a public server with powerful graphics processing units (GPUs), and a data curation system, to ensure that users share a time-saving, private, and stable data preprocessing pipeline. The electrode module consists of a pipeline to locate and anatomically label the SEEG electrode contacts using both preoperative T1 image and postoperative CT image. The ictal module and interictal module analyzed the recorded SEEG data and then pinpoint the suspicious seizure onset zones (SOZs) using EI and High-Frequency Events Index (HI), respectively. Finally, BrainQuake provides a comprehensive visualization result of the 3D brain surface of an individualized patient, with SEEG contacts and SOZ predictions projected on it. We developed GUIs for all these modules (<xref rid="F2" ref-type="fig">Figure 2</xref>), and tutorials can be found along with installation packages.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p>General overview of BrainQuake structure. BrainQuake is designed to analyze the SEEG data (ictal and interictal), CT images, and MRI T1 images. Ictal and interictal modules are used to predict suspect contacts within seizure onset zones (SOZs). The electrode module exploits the graphic information from a CT image to locate the stereoelectroencephalography (SEEG) electrodes and contacts, as well as project them onto the brain surface, which is reconstructed by the surface module. The locations of suspect contacts are marked (blue) on the 3D plot of the surface and electrodes, giving a brief overview of the presurgical evaluation results.</p>
        </caption>
        <graphic xlink:href="fninf-15-773890-g0001" position="float"/>
      </fig>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>The graphical user interfaces (GUIs) of the main window of BrainQuake and the four functional submodules. <bold>(A)</bold> BrainQuake main window; <bold>(B)</bold> Surface module; <bold>(C)</bold> Electrode module; <bold>(D)</bold> Interictal module; <bold>(E)</bold> Ictal module.</p>
        </caption>
        <graphic xlink:href="fninf-15-773890-g0002" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Data</title>
      <sec>
        <title>Subjects</title>
        <p>The SEEG electrodes, or intracranial depth electrodes, were used in human subjects undergoing epilepsy surgical treatment. We analyzed the data from five patients temporarily implanted with SEEG electrodes (8–16 contacts per electrode, 2 mm diameter, and 3.5-mm center-to-center spacing). Intracranial EEG was continuously recorded for 2 weeks on average, and MRI and CT images were, respectively, acquired before and after the implantation operation. The surgeries were conducted in the Department of Neurosurgery and Epilepsy Center, Tsinghua Yuquan Hospital. Data collection and scientific workup were approved by its Institutional Review Board.</p>
      </sec>
      <sec>
        <title>Example Data</title>
        <p>We provided eight sets of sample data so that potential users can follow the data format and file structure and go through the procedures in BrainQuake. Sample data are available at <ext-link xlink:href="https://doi.org/10.5281/zenodo.5675459" ext-link-type="uri">https://doi.org/10.5281/zenodo.5675459</ext-link>, such as MRI T1 image, CT image in NIfTI-1 type, and recordings of ictal and interictal EEG data <bold>(</bold>up to 2 h per patient) for each sample. The file structure is shown in <xref rid="F3" ref-type="fig">Figure 3</xref>. FreeSurfer “recon-all” results are also included since we used some of their intermediate files (mri/orig.mgz, brainmask.mgz; surf/lh.pial, rh.pial) in our modules. Two separate directories, namely, BrainQuake dataset and FreeSurfer dataset, will be configured during the initialization of the software.</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p>File structures of two datasets implemented in BrainQuake. Temporary and final results are saved under the folders of each subject.</p>
          </caption>
          <graphic xlink:href="fninf-15-773890-g0003" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>Operating Requirements</title>
        <p>The codes are divided into the client part and the server part. Computers running either Linux, Mac OS X, or Windows should run the client Python GUI code. For the server part, it should be running on Linux or Mac OS X, since FreeSurfer works only on Linux. We recommended users install the client GUI code and communicate with a public server we provided and leave all the time-consuming works (e.g., surface reconstruction, CT and MRI image registration) to it. Essential processed data for functional modules in BrainQuake can be downloaded from the server. If facilitated with a Linux-based server at local, one can still download and install the server codes and run the whole pipeline within their own workspace. On the remote server side, FreeSurfer (version 6 or higher) should be properly installed as well as the packages mentioned previously. Full installation tutorials can be found on <ext-link xlink:href="https://github.com/HongLabTHU/Brainquake" ext-link-type="uri">https://github.com/HongLabTHU/Brainquake</ext-link>. Detailed operating requirements are listed as follows:</p>
        <list list-type="order">
          <list-item>
            <p>Computers running on Linux, Mac OS X, and Windows should run the client codes (i.e., Python scripts outside the “Server_codes” folder on the GitHub of BrainQuake).</p>
          </list-item>
          <list-item>
            <p>Server codes should be run on a Linux-based server, with FreeSurfer (version 6 or higher) installed.</p>
          </list-item>
          <list-item>
            <p>Processor speed: 2.0 GHz or higher recommended.</p>
          </list-item>
          <list-item>
            <p>RAM: 8 GB or higher recommended.</p>
          </list-item>
          <list-item>
            <p>Python version: 3.6 or higher.</p>
          </list-item>
          <list-item>
            <p>Third-party dependencies: numpy, nibabel, matplotlib, scikit-learn, scipy, mne, vtk, and mayavi.</p>
          </list-item>
        </list>
        <p>The public server [Ubuntu 18.04, 40 central processing units (CPUs), 2.10 GHz] we provided assigns eight cores to each “recon-all” task for parallel computing and can hold up to three tasks running simultaneously. Each “recon-all” task lasts 3 h on average. Server codes are also provided on the GitHub of BrainQuake so that one can facilitate their own server for reference. The output package of a surface reconstruction task from the server pipeline of BrainQuake includes a typical reconstruction result folder (produced by FreeSurfer), an “orig.nii.gz” file (produced by FreeSurfer command “mri_convert”), a “mask.mgz” file (produced by FreeSurfer command “mri_binarize”), and a registered “ &lt;name&gt;_CT_Reg.nii.gz” file (produced by FSL command “flirt” with “orig.nii.gz” as its reference image). Producing all of these files and folders requires FreeSurfer installed in the operating environment, so if a potential user prefers not to apply the client-server mode, one can always import their own “recon-all” folders with all these Supplementary Files prepared.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec>
      <title>Image Processing Modules</title>
      <sec>
        <title>Surface Module</title>
        <p>FreeSurfer provides a complete pipeline, “recon-all,” for surface reconstruction, which is compiled with abundant tools such as skull-stripping, image registration, cortical reconstruction, and segmentation. More time-saving or specific pipelines such as “FastSurfer” (Henschel et al., <xref rid="B18" ref-type="bibr">2020</xref>) and “infant-FreeSurfer” (Zöllei et al., <xref rid="B41" ref-type="bibr">2020</xref>) have been released in recent years. We integrated all those pipelines in the provided server and also provided processing options in the surface module GUI so that users no longer need to deal with the terminal when using “recon-all” or wait too long for a reconstruction result since the server is facilitated with GPUs and the average processing time is 3.5 h for “recon-all” and only 30 min for “FastSurfer” and “infant-FreeSurfer.” Windows users need not configure a virtual machine for installing FreeSurfer locally since our server can undertake all the preprocessing works.</p>
      </sec>
      <sec>
        <title>Electrode Module</title>
        <p>Either processed manually or semiautomatically, the main idea of electrode contact segmentation is to identify the brightest voxels in a CT image as contact positions along each depth electrode. To conduct an autonomous pipeline of contact segmentation, we should make the best use of the image properties. The electrode module of BrainQuake requires the input data of only a postsurgical CT NIfTI image and a result package of surface reconstruction. The pipeline in the module includes three parts, namely, image preprocessing, electrode clustering, and contact recognition (<xref rid="F4" ref-type="fig">Figure 4</xref>).</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p>The pipeline of electrode localization and contact segmentation procedures in the electrode module. <bold>(A)</bold> The preprocessing step includes image registration from the raw CT of a subject to MRI (orig.mgz after surface reconstruction), skull-stripping of registered CT (using brainmask.mgz after surface reconstruction), and thresholding of electrodes in the CT data. <bold>(B)</bold> The coordinates of electrode voxels in the CT image after thresholding can be extracted and plotted, viewing as a mix of point clouds. <bold>(C)</bold> After applying a Hough Transform and Gaussian Mixture Model algorithm, the electrodes are clustered and labeled by different colors. <bold>(D)</bold> Contact segmentation step: contact positions are recognized one by one by converging to the center-of-mass based on voxel values. Contact positions are marked as red asterisks. <bold>(E)</bold> The results of the contact segmentation pipeline are projected onto the 3D surface space.</p>
          </caption>
          <graphic xlink:href="fninf-15-773890-g0004" position="float"/>
        </fig>
        <sec>
          <title>Preprocessing</title>
          <p>Before we could autonomously identify an electrode or contact, we must ensure that the image contains only the intracranial area of a brain since the skulls, teeth, or some electrode supports outside the brain are hard to be distinguished from the electrodes based on the voxel value difference of a CT image. In the preprocessing step, we registered the CT with the standardized MR image generated in the surface module. This registration step uses FSL “flirt” (Jenkinson et al., <xref rid="B21" ref-type="bibr">2012</xref>) after surface reconstruction in the surface module. Then, the registered CT can be masked with a skull-stripped MR image in the surface data package to remove the extracranial part of the CT data since they are now in the same coordinate. At this time, the CT image contains only the information about the intracranial brain and the electrodes, the two of which show a significant difference in their voxel value ranges. Electrode voxels are much brighter in the image, so they can be extracted simply by thresholding (<xref rid="F4" ref-type="fig">Figure 4A</xref>).</p>
        </sec>
        <sec>
          <title>Hough Transform and Gaussian Mixture Model</title>
          <p>After extracting the electrode voxels into point clouds (<xref rid="F4" ref-type="fig">Figure 4B</xref>), we need to identify the number and axes of electrodes and label each voxel into different electrode clusters. This step is completed in most of the previous works by clustering algorithm with manual adjustment. In BrainQuake, we developed a method of combining 3D Hough Transform, a pattern recognition algorithm, and Gaussian Mixture Model, a clustering algorithm, to label voxels into different electrode clusters (<xref rid="F5" ref-type="fig">Figure 5</xref>).</p>
          <fig position="float" id="F5">
            <label>Figure 5</label>
            <caption>
              <p>Three examples of electrode point clouds have been 3D Hough-transformed and then clustered using the Gaussian Mixture Model. <bold>(A)</bold> The initial point clouds of electrodes are extracted from the CT intracranial image of an individual after several preprocessing steps. <bold>(B)</bold> The centroids and directions (showing by the red arrows) of SEEG electrodes are detected by the Hough Transform algorithm of a line in 3D coordinates. <bold>(C)</bold> The clustered electrodes are marked using different colors, after applying the Gaussian Mixture Model and the prior knowledge of the centroids and directions of clusters generated from <bold>(B)</bold>.</p>
            </caption>
            <graphic xlink:href="fninf-15-773890-g0005" position="float"/>
          </fig>
          <p>Normal clustering algorithms randomly pick some centroids in CT images, classify the voxels into clusters, and calculate the new centroid of each cluster. After multiple iterations, theoretically, voxels belonging to the same electrode can be assigned to the same cluster. However, the clustering algorithm is strongly dependent on the initial selection of centroids. With an improper initialization of the random centroids, the true distribution of electrode clusters can be difficult to estimate. There is a high probability that we would get a locally optimal clustering result, definitely requiring a manual intervention here to fix it, for example, to merge some of the clusters to form a real electrode or to split two or more electrodes in the same cluster.</p>
          <p>Our method fixes this issue by adding a Hough Transform before clustering. Hough Transform is a common method used in computer vision or digital image processing (Illingworth and Kittler, <xref rid="B19" ref-type="bibr">1988</xref>). It can be used to detect a certain class of shapes in an image automatically. The main idea of Hough Transform is that for a specific shape, we have chosen a set of parameters and created a parameter space. For example, the parameter we usually used to describe circles can be center and diameter, while the parameter of 2D lines can be slope and intercept. Suppose we have a raw image with a mixture of dots on it. Each dot will vote in the parameter space for every possible parameter set they can contribute. Positions in the space with the highest votes are recognized as the parameter sets describing the most obvious shape in the raw image. In our case, SEEG electrodes in a CT image are a combination of line-shaped objects in 3D space. The parameter space is established to represent the line direction (horizontal orientation and altitude) and the distance between the coordinate origin and the line.</p>
          <p>First, we transformed those voxels into point clouds (<xref rid="F5" ref-type="fig">Figure 5A</xref>). Then, we applied a 3D line Hough Transform to detect line-shaped trajectories (Jeltsch et al., <xref rid="B20" ref-type="bibr">2016</xref>; Dalitz et al., <xref rid="B12" ref-type="bibr">2017</xref>) in the point clouds, returning centroid and axis direction of each electrode cluster. At this stage, we got a set of approximate but not precise results representing the position of each cluster (<xref rid="F5" ref-type="fig">Figure 5B</xref>), which can be a good set of prior knowledge to start clustering. After that, we used the Gaussian Mixture Model (Reynolds, <xref rid="B30" ref-type="bibr">2009</xref>; Pedregosa et al., <xref rid="B27" ref-type="bibr">2011</xref>) to assign each point to the electrode cluster it belongs, since the point clouds can be viewed as a mixture of different line-shaped 3D Gaussian kernels (<xref rid="F5" ref-type="fig">Figure 5C</xref>). After a successful clustering, the axes directions of electrodes can be regressed (Pedregosa et al., <xref rid="B27" ref-type="bibr">2011</xref>). This combinatory method makes use of both electrode geometric prior and voxel distribution in a CT image, which shows excellent accuracy and robustness in our experiments.</p>
        </sec>
        <sec>
          <title>Contact Segmentation</title>
          <p>In the SEEG contact segmentation step, our general goal was to automatically recognize the relatively brightest voxels, which are viewed as contact positions, along each electrode shaft. We mainly divided the process into four sub-steps, namely, locating the head voxel, locating the target contact, stepping toward the next contact, and locating the rest contacts along the shaft.</p>
          <p>First, we applied a linear regression (Pedregosa et al., <xref rid="B27" ref-type="bibr">2011</xref>) to each electrode cluster of voxels to get the direction parameter (coefficients between x-y/y-z/z-x axes) of the electrode shaft track in the 3D space coordinate. We then used the direction to locate two voxels, respectively, to be the head and tail of the cluster. As a general assumption that the head voxel is always closer to the center of the brain (i.e., the center of the image space), we can locate the position of the head voxel, which is much close to the target contact.</p>
          <p>Second, we applied a “center-of-mass” convergence algorithm (Arnulfo et al., <xref rid="B2" ref-type="bibr">2015</xref>) to locate the target contact. We viewed each voxel value as the “mass” of a single voxel or “weight” of this point. In this way, the center-of-mass is defined as the “heaviest” point within a small region of voxels. After finding out the head voxel, we calculated the center-of-mass of its surrounding region (a geometry-restricted cubic volume with respect to the actual contact size, 2 × 2 × 2 mm cube in our case). We then again calculated the next center-of-mass within the surroundings of the newly found center-of-mass. After 1–2 iterations of this procedure, the calculated center-of-mass eventually converges to the brightest voxel around the head of the electrode (i.e., the real target contact position).</p>
          <p>Third, as we already knew the electrode track direction and the target contact, stepping out a specific distance along the direction from the target contact can give us a position close to the next contact. The step size should equal the real distance between two adjacent contacts (3.5 mm in our case). In this case, we made sure that the position found was close enough to the next contact, which was ready for another center-of-mass convergence procedure.</p>
          <p>Finally, using the same center-of-mass convergence and the stepping strategy, the rest contacts can be recognized one by one. In this iterative process, we also set a geometrical restriction to ensure that the directed positions are always settled within the cluster by doubling the weights of the voxels in the cluster (<xref rid="F4" ref-type="fig">Figure 4D</xref>).</p>
        </sec>
        <sec>
          <title>Validation Method of Electrode Localization</title>
          <p>We used two methods to validate the results of the electrode module, namely, visual inspection of the electrode positions and quantitative measurements of the electrode contact distribution. The recognized contacts were projected onto the 2D slice of the fusion of MR and CT images. Then, we scanned through all these slices and visually checked if the electrodes and the highlighted electrode shaft on CT slices were overlapped.</p>
          <p>To quantitatively estimate the accuracy of contact localization, we must define a gold standard of contact positions and then estimate the contact deviation error one by one. Usually, a group of clinical experts should be invited to view through all those image slices and mark the contact positions manually. However, due to the artifacts of each contact in the CT images, one may find it tough to segment those contacts since the adjacent contact pairs are usually merged. Thus, we could not trust the manual segmentation results as a gold standard. In this study, we estimated two indirect metrics, namely, axis-contact distance (i.e., distances between contacts and their estimated shaft axis) and adjacent contact distance of each adjacent contact pair (Arnulfo et al., <xref rid="B2" ref-type="bibr">2015</xref>; Narizzano et al., <xref rid="B25" ref-type="bibr">2017</xref>). Both of the metrics are based on the geometric properties of the SEEG electrodes. Contacts along the same electrode shaft are line-shaped regressed, and the axis-contact distance ideally can be close to 0 mm. The axis-contact distance is defined as the distance between the contact position and the regression line of the electrode shaft. It reveals how straight the contacts are located. The electrodes we used have a fixed spacing distance of 3.5 mm between neighboring contacts, so the adjacent contact distance we estimated should be distributed similarly to a Gaussian with a mean of 3.5 mm and a trivial variance as much as possible. However, it is often the case that the electrode shaft bends slightly and the contacts deviate from the line after the implantation surgery, which in some way causes these two distributions to be not so ideal (refer to the “Discussion” section).</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>SEEG Data Analysis Modules</title>
      <sec>
        <title>Ictal Module</title>
        <p>For ictal data, clinicians tend to mark the areas where the pathological activity occurs earlier as the potential SOZs. Based on this consensus, an EI method is commonly used to predict the SOZs (Bartolomei et al., <xref rid="B5" ref-type="bibr">2008</xref>). In this study, we implemented a simplified EI measurement in BrainQuake, predicting the SOZs by quantifying the combined effect of the timing order and the strength of high-gamma energy change in each channel during the onset process of the seizure (Zhao et al., <xref rid="B40" ref-type="bibr">2019</xref>).</p>
        <p>Before we did any automatic computation, we first filtered the raw signals into high-gamma frequency bands (60–140 Hz, power noise at 50 Hz) using a second-order IIR notch digital filter and a fifth-order Butterworth IIR filter (Virtanen et al., <xref rid="B35" ref-type="bibr">2020</xref>). We then manually selected a segment of the baseline (BL) data, as well as a segment of the target data containing the initial onset process of seizure. The BL data should be located before the seizure onset, and a range of around 60 s should be enough for it. The target data should cover the seizure onset process, that is, to start somewhere before the onset and end within the seizure. The length of the target data is not limited as long as it covers the seizure onset process.</p>
        <p>After the manual selection, we calculated an EI for each channel. First, the band-passed signals are transformed into a high-frequency energy spectrum by amplitude squaring and window smoothing (500-ms window length, 1 sample point per step). Second, we calculated the average value of the high-frequency energy of the BL data, which is used to normalize the high-frequency energy by division. In this way, we obtained the normalized high-frequency energy (NHFE) (<xref rid="F6" ref-type="fig">Figure 6A</xref>). Third, a threshold of onset time was calculated for each channel <italic>i</italic>, which is 10 times the standard deviation (SD) of baseline (BL) NHFE above its maximum value as follows:</p>
        <disp-formula id="E1">
          <mml:math id="M1" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>t</mml:mi>
                  <mml:mi>h</mml:mi>
                  <mml:mi>r</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo class="qopname">max</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mi>H</mml:mi>
                      <mml:mi>F</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>B</mml:mi>
                          <mml:mi>L</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mtext> </mml:mtext>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>10</mml:mn>
                  <mml:mi>σ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mi>H</mml:mi>
                      <mml:mi>F</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>B</mml:mi>
                          <mml:mi>L</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mtext> </mml:mtext>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p>Methods of ictal and interictal SEEG data analysis. <bold>(A)</bold> Onset timing order and energy strength during the initial stage of seizures are sorted to calculate the Epileptogenicity Index (EI). <bold>(B)</bold> Numbers of over-threshold high-frequency events are counted as High-Frequency Events Index (HI).</p>
          </caption>
          <graphic xlink:href="fninf-15-773890-g0006" position="float"/>
        </fig>
        <p>For each channel, once the normalized energy in the target data exceeds its corresponding threshold, we decided this moment as the onset time of its abnormal activity. Fourth, we sorted the channels by their onset time and defined the time coefficient (TC) as the reciprocal of the order of each channel (i.e., 1, 1/2, and 1/3). Also, we calculated the average energy of each channel in a 250-ms period right after the earliest onset time as energy coefficient (EC) using the NHFE. Finally, the EI of each channel <italic>i</italic> is obtained by the following:</p>
        <disp-formula id="E2">
          <mml:math id="M2" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>E</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>×</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>As we can notice, EI, combining the effect of timing and energy strength, can be used to quantify the degree of epileptogenicity of each electrode channel (<xref rid="F6" ref-type="fig">Figure 6A</xref>).</p>
      </sec>
      <sec>
        <title>Interictal Module</title>
        <p>A previous study on the SEEG interictal data found that both HFOs and spikes are the reliable biomarkers of SOZ, while HFO has better specificity for SOZ than spikes (Wang et al., <xref rid="B36" ref-type="bibr">2017</xref>; Roehri and Bartolomei, <xref rid="B31" ref-type="bibr">2019</xref>). The HFO subcategory, 80–250 Hz ripple component, is relatively more common than a higher frequency component (Wang et al., <xref rid="B37" ref-type="bibr">2013</xref>). This frequency band can also take into account the spike activity, which is similar to a full-band signal (Roehri et al., <xref rid="B32" ref-type="bibr">2017</xref>; Cai et al., <xref rid="B8" ref-type="bibr">2021</xref>). Therefore, for the interictal data, we extracted the pathological activity by detecting the short-term abnormal energy enhancement in the 80–250 Hz band, providing an efficient indexation method through unified energy detection. Specifically, we used the Hilbert transform to extract the energy envelope in the 80–250 Hz band of the signal (i.e., users can adjust the frequency range for their own cases). The filter setting applied is a second-order IIR notch digital filter with a quality factor set to be 30, followed by a five-order Butterworth band-pass filter (Virtanen et al., <xref rid="B35" ref-type="bibr">2020</xref>). We calculated the median value of the whole envelope (global, <italic>S</italic><sub><italic>global</italic></sub>) and the median value of each contact (local, <italic>S</italic><sub><italic>i</italic></sub>). Considering both of them, we set a synergistic threshold for each contact as follows:</p>
        <disp-formula id="E3">
          <mml:math id="M3" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>t</mml:mi>
                  <mml:mi>h</mml:mi>
                  <mml:mi>r</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo>×</mml:mo>
                  <mml:mo class="qopname">max</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>d</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>S</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mtext> </mml:mtext>
                      <mml:mi>m</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>d</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>S</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                              <mml:mi>l</mml:mi>
                              <mml:mi>o</mml:mi>
                              <mml:mi>b</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The time range where the envelop exceeds the threshold is marked as abnormal activity (<xref rid="F6" ref-type="fig">Figure 6B</xref>). When the interval between two adjacent abnormal activities is too small (&lt;20 ms), they are considered to belong to the same event and merged, and the abnormal activities of the very short duration (&lt;50 ms) are excluded. Finally, the number of abnormal activities (HI) calculated for each channel is used as an index to measure the relative likelihood of each contact of being in the SOZ.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>Results and Validation</title>
    <p>We processed all four functional modules using the MRI/CT images and the SEEG data acquired from 8 epilepsy patients. The time required for surface reconstruction was either around 0.5 h using FastSurfer or 3.5 h using FreeSurfer recon-all on the public server (40 cores, 2.1 GHz, 64 GB RAM). The preprocessing step in the electrode module for each subject is around 15 min, mostly spent on the image registrations of MRI and CT using the FSL “flirt” command. Contact localization consumes only 30 s for each subject on average. A 70-s interictal SEEG costs around 40 s for EI calculation, and the 2-h interictal data costs around 20 min for HI calculation.</p>
    <sec>
      <title>Electrode Module Validation</title>
      <p>We processed 74 electrodes with 743 contacts implanted in eight patients in total. During visual inspection, all 74 electrodes were perfectly matched with the highlighted electrode shaft artifacts on CT images (<xref rid="F7" ref-type="fig">Figures 7A,B</xref>). For quantitative validation, we estimated two metrics, namely, axis-contact distance and adjacent contact distance error, to measure whether the distributions of recognized contacts obey the geometric rules of the SEEG electrode. In statistics, 95% of the contacts were &lt;0.1 mm, deviating from their estimated axes (<xref rid="F7" ref-type="fig">Figure 7C</xref>). By the subtraction of 3.5 mm (real adjacent contact distance) mean, the adjacent contact distance error was distributed around 0 mm with a Gaussian-like distribution. Notably, 95% of the contact distance fell in the range of 3.5 ± 1 mm, and 50% of the contact distance fell in the range of 3.5 ± 0.3 mm (<xref rid="F7" ref-type="fig">Figure 7D</xref>). These two estimates show comparable results with the Contact Position Estimator (CPE) Module of 3D Slicer (Narizzano et al., <xref rid="B25" ref-type="bibr">2017</xref>).</p>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p>Validation of electrode localization accuracy. Visual checking of the electrodes and contacts of an example subject projected onto the CT image of an individual. The raw CT brain <bold>(A)</bold> shows electrode positions as highlighted line-shaped voxels. Our recognized electrodes (red spheres) are plotted on <bold>(B)</bold>, showing that they are overlapped with each other. Contact positions are quantitatively estimated by two metrics, namely, axis-contact distance and adjacent contact distance error. <bold>(C)</bold> Axis-contact distance estimates the distribution of deviation distance between each contact and its regressed electrode shaft line. Of note, 95% of the contacts were less than 0.1 mm, deviating from their estimated shaft line. <bold>(D)</bold> Adjacent inter-contact distance error estimates the distribution of the distance between each pair of adjacent contacts. The actual adjacent contact distance size, 3.5 mm, is subtracted from the estimated distances, so here we have shown the distribution of the adjacent contact distance error. Notably, 95% of the contact distance fell in the range of 0 ± 1 mm, and 50% of the contact distance fell in the range of 0 ± 0.3 mm, i.e., the adjacent contact distance distribution is 3.5 ± 1 mm (95%) and 3.5 ± 0.3 mm (50%).</p>
        </caption>
        <graphic xlink:href="fninf-15-773890-g0007" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>SEEG Analysis Validation</title>
      <p>To evaluate the accuracy of predicting SOZ using EI and HI methods, the selection of the clinician of the SOZ electrode contacts of patients was used as the ground truth. The receiver operator curve (ROC) and the corresponding area under the curve (AUC) were further used to evaluate the consistency between the index-based prediction and the clinical diagnosis. The average AUC of EI and HI on five patients are 0.83 and 0.80, respectively (with EI of S2 excluded) (<xref rid="F8" ref-type="fig">Figures 8A,B</xref>). We could observe that on patient S1, both EI and HI have achieved excellent SOZ prediction results, which suggests a valid estimation of SOZs using both methods. The AUC value of S2 based on EI is close to 0.5 and has no predictive effect, due to the fact that the ictal data of S2 displays similar seizure onset activities within every single channel, and the EI method cannot tell the difference from either their timing orders or energy strengths. In contrast, the AUC of S2 based on interictal HI reaches 0.83, which is highly consistent with the clinically annotated SOZs. The case of S2 suggests that when the ictal data cannot provide sufficient diagnostic information, the interictal data can be used to provide extra information for SOZ location, showing the essential value of the interictal SEEG data analysis. In addition, the AUC value of S3 based on HI is 0.49, while its AUC based on HI reaches 0.99. The HI results of S3 performed poorly because those false-positive channels recorded plentiful high-frequency noises. The cases of S2 and S3 suggested the cross-reference value of EI and HI. Finally, we displayed SOZ predictions on reconstructed cortical volume for clinicians to verify the results with imaging evidence (<xref rid="F8" ref-type="fig">Figure 8C</xref>). For the case of S2, we marked the clinically annotated contacts as larger spheres and the HI-based SOZs as red spheres, which shows consistency between these two groups. Moreover, we tried a similar EI module in a software, AnyWave (Colombet et al., <xref rid="B9" ref-type="bibr">2015</xref>), to our ictal dataset, and it shows that the EI predictions of BrainQuake have higher ROCs in most cases (<xref rid="F9" ref-type="fig">Figures 9A,B</xref>). The comparisons also show that the AUC of BrainQuake EI and HI both is significantly higher than that of AnyWave EI (<italic>p</italic> = 0.0078 and <italic>p</italic> = 0.0391, respectively, two-sided Wilcoxon signed-rank test, <xref rid="F9" ref-type="fig">Figure 9C</xref>).</p>
      <fig position="float" id="F8">
        <label>Figure 8</label>
        <caption>
          <p>Validations of the SOZ prediction results of BrainQuake comparing with clinically annotated SOZs. <bold>(A)</bold> The receiver operator curve (ROC) and area under the curve (AUC) results of SOZ prediction, based on EI. Case S2 shows a low AUC of 0.51 (low predictive effect), while HI-guided prediction of S2 is 0.83, which is highly consistent with the clinically annotated SOZs. That is because the ictal data of S2 displays similar seizure onset activities within each channel, and the EI method cannot tell the difference from either their timing orders or their energy strengths. The case of S2 suggests that when the ictal data cannot provide sufficient diagnostic information, the interictal data can be used to provide extra information for SOZ location, showing the essential value of interictal SEEG data analysis. <bold>(B)</bold> The ROC and AUC results of SOZ prediction, based on HI. Case S3 shows a low AUC of 0.49 based on HI but a high AUC of 0.99 based on EI. The HI results of S3 performed poorly because those false positive channels recorded plentiful high-frequency noises. EI and HI methods provide prediction results from different perspectives of views, so we recommended surgeons take a comprehensive consideration on both of them. <bold>(C)</bold> The HI results of S2 (marked with larger scales of contacts) and cortical reconstruction are displayed at the same time with clinically annotated SOZs (marked with red color).</p>
        </caption>
        <graphic xlink:href="fninf-15-773890-g0008" position="float"/>
      </fig>
      <fig position="float" id="F9">
        <label>Figure 9</label>
        <caption>
          <p>Comparisons between AnyWave EI method and the EI and HI of BrainQuake. <bold>(A)</bold> The ROC and AUC results of SOZ predictions, based on BrainQuake EI. <bold>(B)</bold> The ROC and AUC results of SOZ prediction, based on AnyWave EI. In most cases, BrainQuake EI shows a greater prediction effect than AnyWave EI. <bold>(C)</bold> Comparisons of AUC values between AnyWave EI and BrainQuake EI and HI. A Wilcoxon signed-rank test was performed between the prediction results of AnyWave and BrainQuake. The AUC of BrainQuake EI and HI are both significantly higher than that of AnyWave EI (<italic>p</italic> = 0.0078 and <italic>p</italic> = 0.0391, respectively, two-sided Wilcoxon signed-rank test, *<italic>p</italic> &lt; 0.05, **<italic>p</italic> &lt; 0.01).</p>
        </caption>
        <graphic xlink:href="fninf-15-773890-g0009" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="s5">
    <title>Discussion and Conclusion</title>
    <p>The intracranial SEEG data provide abundant electrophysiological information from the human brain for surgical planning and brain research. With the prevalence of SEEG recording in recent years, a large number of neurodata have been generated while researchers are exploring a way to make the best use of it. The challenge lies in both the fusion of multimodal neurodata and intensive computation during the SEEG analysis. In this study, we have introduced a self-sustained Python toolbox, i.e., BrainQuake, integrating multiple approaches to form a complete solution. For the structural data, the electrode module and the surface module provide fast and automated pipelines for surface reconstruction and electrode localization, with only raw MRI T1 and CT images needed for processing. For the functional data, both ictal and interictal modules exploit the long range of SEEG data and provide a presurgical estimation of SOZs. Blending structural and functional results, we provided neurosurgeons with a comprehensive tool for surgical planning. Neuroscientists who are using SEEG to study human brains will also be benefited from our toolbox.</p>
    <p>The electrode localization approach implemented in BrainQuake divides the problem into two parts, namely, a global level of electrode clustering and a local level of contact segmentation. BrainQuake innovates in the level of automatic electrode voxel clustering. The semiautonomous methods require either additional input messages or a graphical user interface (GUI) to complete this process, i.e., the efficiency and user experience of which highly depends on the quality of images and preprocessing steps. Our algorithm, which is the combination of 3D Hough Transform and Gaussian Mixture Model, managed to take advantage of both geometric prior and graphical information embedded in CT images. The Hough Transform helps to detect the geometric characteristic of the objects in the image. Whatever the image resolution is high or low, electrode shafts are always straight and highlighted from the background. From this perspective, a pattern recognition algorithm can, in fact, be used to exploit the image instead of scanning it slice by slice. To our knowledge, this valid and useful geometric property has never been utilized in any other SEEG electrode localization method before. The Hough Transform makes electrode shafts be recognized automatically, although it may not return us a precise result. The recognized directions may deviate slightly from the shaft, or a recognized centroid may not be in the exact center of the actual electrode. However, the result can be much close to the true state, which is a good starting point for initializing the clustering algorithm. Thus, we removed the complicated manual intervention, that is, to replace the procedure of telling a software where the electrodes locate with automatic splicing of algorithms, and the pipeline consumes much less time than previous tools.</p>
    <p>As for the subsequent step of contact segmentation for every single electrode, the algorithm of the center-of-mass convergence (Arnulfo et al., <xref rid="B2" ref-type="bibr">2015</xref>) has shown interpretable principles and valid results. In our pipeline, we applied this algorithm to each electrode one by one after electrode clustering and acquire the final contact coordinates. We used axis-contact distance and adjacent contact distance error to estimate the geometric characteristics of the segmentation results. However, those two parameters are, in fact, the indirect ways of validating whether the contacts are properly located. Several factors may influence the error distributions. An electrode can bend slightly in the brain, in which case there is a possibility that fluctuations occur in the distributions of both parameters. It can generate some outliers in the distribution of axis-contact distance since the contacts are no longer scattered along a straight line and the deviations of contacts from the regressed line, in fact, exist. Moreover, due to the bending, the adjacent contact distance may shrink slightly as the contacts bear the force to be compressed to each other. Reflecting on <xref rid="F7" ref-type="fig">Figure 7D</xref>, there are more distance errors lying in the negative half range than in the positive half range. In other cases, failures do exist due to the quality of the raw CT images. There are possibilities that the algorithm cannot find a local center-of-mass in a region and keep looking for highlights along the direction and finally converge to the next contact. This can explain the positive outliers in <xref rid="F7" ref-type="fig">Figure 7D</xref>. We encountered a worse situation that the two regions of highlights were too close to each other and so the converging point just kept jumping from one optimal to another. We fixed this problem by implementing a counting index of convergence in the algorithm setting a forcing scheme to stop the infinite loop and choosing a voxel with higher voxel values just in case. We could notice that the design of the center-of-mass convergence algorithm does have its deficits and may not give us highly precise results. The recommended redeeming method is still visual checking. As for the essentiality of precise contact locations and then the locations of potential SOZs, one must not skip the procedure of manual checking. By projecting the contact results onto the registered CT image on a NIfTI image reading software such as “Freeview” (<xref rid="F7" ref-type="fig">Figure 7B</xref>), we could go through the slices to check if the contacts recognized are matched with the highlighted voxels in the image. If an error is detected, surely one can erase a misplaced contact and add a new one by hand.</p>
    <p>The automatic SOZ prediction methods usually use the onset order of high-frequency activity at each contact during the seizure or the specific distribution of abnormal activity during the interictal period as pathological features (Bartolomei et al., <xref rid="B5" ref-type="bibr">2008</xref>; Barkmeier et al., <xref rid="B4" ref-type="bibr">2012</xref>; Navarrete et al., <xref rid="B26" ref-type="bibr">2016</xref>) These methods have already been integrated into some software independently (Tadel et al., <xref rid="B34" ref-type="bibr">2011</xref>; Colombet et al., <xref rid="B9" ref-type="bibr">2015</xref>). We tried a similar EI module in a software, AnyWave (Colombet et al., <xref rid="B9" ref-type="bibr">2015</xref>), to our ictal dataset, and the comparison results show that the EI predictions of BrainQuake have higher ROCs in most of the cases (<xref rid="F9" ref-type="fig">Figures 9A,B</xref>). Although the seizure data are considered to be more relevant to SOZ prediction, it may be difficult to capture or it may not provide enough information for the diagnosis, resulting in a relatively low AUC. Meanwhile, a large amount of interictal SEEG has not been fully utilized. The pathological information extracted from the long-term data may also have good predictive power on SOZ and is more immune to noises than the ictal data. As shown in our results (<xref rid="F9" ref-type="fig">Figure 9C</xref>), HI derived from the interictal data is a good supplement to the EI method, and clinicians can compare the consistency between them. BrainQuake may serve as a platform for exploring the causal relationships between these two kinds of predictions and ultimately lead to better clinical diagnoses.</p>
    <p>The processing of the long-term interictal data also gives rise to the challenge of computing power. The progress in deep learning has led to the development of high-performance parallel computing, and meanwhile, the acceleration capability of GPUs may be a solution to massive SEEG data and its high-load computing. At present, the mechanisms of seizures and interictal discharges are still unclear, and they may reflect different aspects of the epileptic network (Jiruska et al., <xref rid="B22" ref-type="bibr">2017</xref>; Grinenko et al., <xref rid="B16" ref-type="bibr">2018</xref>). In the future, we plan to implement a GPU module for the long-term interictal SEEG analysis in BrainQuake, and the prediction methods from the perspective of epileptic networks are to be explored.</p>
    <p>BrainQuake is designed to be an auxiliary tool for epilepsy neurosurgeons and technicians, trying to convey a presurgical evaluation solution with blended functional and structural neurodata. Most current software or toolboxes focus on one or a few steps, developing splendid algorithms or techniques for data processing, but in clinical practice, it is a cumbersome task to merge all kinds of results into one system or coordinate. Also, several steps consume a lot of time and effort to do repeated work, resulting in an inefficient working procedure. BrainQuake commits to freeing surgeons and technicians from tedious and time-consuming work, allowing them to concentrate on the steps that rely more on common sense and medical expertise short in machine algorithms. In the upcoming era of big neurodata, this kind of human-computer synergy is an efficient approach to data utilization, and we believe that it will eventually promote the fields of both neurology and neuroscience.</p>
  </sec>
  <sec sec-type="data-availability" id="s6">
    <title>Data Availability Statement</title>
    <p>The example dataset presented in this study can be found in <ext-link xlink:href="https://doi.org/10.5281/zenodo.5675459" ext-link-type="uri">https://doi.org/10.5281/zenodo.5675459</ext-link>. The codes can be found on Github (<ext-link xlink:href="https://github.com/HongLabTHU/Brainquake" ext-link-type="uri">https://github.com/HongLabTHU/Brainquake</ext-link>).</p>
  </sec>
  <sec id="s7">
    <title>Ethics Statement</title>
    <p>The studies involving human participants were reviewed and approved by Ethics Committee of Tsinghua Yuquan Hospital. Written informed consent to participate in this study was provided by the participants' legal guardian/next of kin.</p>
  </sec>
  <sec id="s8">
    <title>Author Contributions</title>
    <p>BH, FC, and KW conceived the work, contributed to drafting, and revising the article. FC and KW designed the software. FC developed the surface module and the electrode module. KW and TZ developed the ictal module. KW developed the interictal module. HW and WZ collected the experimental data. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec sec-type="funding-information" id="s9">
    <title>Funding</title>
    <p>This study was financially supported by the National Key R&amp;D Program of China (2017YFA0205904 to BH).</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s10">
    <title>Publisher's Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Yanqin Lei, Zhao Wang, Bingqing Zhang, Jianjun Bai, Siyu Wang, Yiou Liu, and Jie Shi for their assistance and suggestions in data analysis and software designing, as well as Yuxiang Yan and Wenzheng Li for the comments on the manuscript. We also thank the reviewers/editors for the critical reading of the manuscript. We appreciate the time and dedication of the patients and staff at the Epilepsy Center, Yuquan Hospital, Tsinghua University, Beijing, China.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akkol</surname><given-names>S.</given-names></name><name><surname>Kucyi</surname><given-names>A.</given-names></name><name><surname>Hu</surname><given-names>W.</given-names></name><name><surname>Zhao</surname><given-names>B.</given-names></name><name><surname>Zhang</surname><given-names>C.</given-names></name><name><surname>Sava-Segal</surname><given-names>C.</given-names></name><etal/></person-group>. (<year>2021</year>). <article-title>Intracranial electroencephalography reveals selective responses to cognitive stimuli in the periventricular heterotopias</article-title>. <source>J. Neurosci.</source><volume>41</volume>, <fpage>3870</fpage>–<lpage>3878</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2785-20.2021</pub-id><?supplied-pmid 33727335?><pub-id pub-id-type="pmid">33727335</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnulfo</surname><given-names>G.</given-names></name><name><surname>Narizzano</surname><given-names>M.</given-names></name><name><surname>Cardinale</surname><given-names>F.</given-names></name><name><surname>Fato</surname><given-names>M. M.</given-names></name><name><surname>Palva</surname><given-names>J. M.</given-names></name></person-group> (<year>2015</year>). <article-title>Automatic segmentation of deep intracerebral electrodes in computed tomography scans</article-title>. <source>BMC Bioinformat.</source>
<volume>16</volume>, <fpage>1</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.1186/s12859-015-0511-6</pub-id><?supplied-pmid 25887573?><pub-id pub-id-type="pmid">25887573</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bancaud</surname><given-names>J.</given-names></name><name><surname>Talairach</surname><given-names>J.</given-names></name><name><surname>Bonis</surname><given-names>A.</given-names></name><name><surname>Schaub</surname><given-names>C.</given-names></name><name><surname>Szikla</surname><given-names>G.</given-names></name><name><surname>Morel</surname><given-names>P.</given-names></name><etal/></person-group>. (<year>1965</year>). <source>La stéreoencephalographie dans l'épilepsie</source>. <publisher-loc>Paris</publisher-loc>: <publisher-name>Mattson</publisher-name>, <fpage>113</fpage>–<lpage>146</lpage>.<?supplied-pmid 31638580?></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barkmeier</surname><given-names>D. T.</given-names></name><name><surname>Shah</surname><given-names>A. K.</given-names></name><name><surname>Flanagan</surname><given-names>D.</given-names></name><name><surname>Atkinson</surname><given-names>M. D.</given-names></name><name><surname>Agarwal</surname><given-names>R.</given-names></name><name><surname>Fuerst</surname><given-names>D. R.</given-names></name><etal/></person-group>. (<year>2012</year>). <article-title>High inter-reviewer variability of spike detection on intracranial eeg addressed by an automated multi-channel algorithm</article-title>. <source>Clin. Neurophysiol.</source><volume>123</volume>, <fpage>1088</fpage>–<lpage>1095</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2011.09.023</pub-id><?supplied-pmid 22033028?><pub-id pub-id-type="pmid">22033028</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartolomei</surname><given-names>F.</given-names></name><name><surname>Chauvel</surname><given-names>P.</given-names></name><name><surname>Wendling</surname><given-names>F.</given-names></name></person-group> (<year>2008</year>). <article-title>Epileptogenicity of brain structures in human temporal lobe epilepsy: a quantified study from intracerebral eeg</article-title>. <source>Brain</source>
<volume>131</volume>, <fpage>1818</fpage>–<lpage>1830</lpage>. <pub-id pub-id-type="doi">10.1093/brain/awn111</pub-id><?supplied-pmid 18556663?><pub-id pub-id-type="pmid">18556663</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname><given-names>E.</given-names></name><name><surname>Zentner</surname><given-names>J.</given-names></name><name><surname>Van Roost</surname><given-names>D.</given-names></name><name><surname>Hufnagel</surname><given-names>A.</given-names></name><name><surname>Elger</surname><given-names>C. E.</given-names></name><name><surname>Schramm</surname><given-names>J.</given-names></name></person-group> (<year>1994</year>). <article-title>Subdural and depth electrodes in the presurgical evaluation of epilepsy</article-title>. <source>Acta Neurochirurg.</source>
<volume>128</volume>, <fpage>84</fpage>–<lpage>87</lpage>. <pub-id pub-id-type="doi">10.1007/BF01400656</pub-id><?supplied-pmid 7847148?><pub-id pub-id-type="pmid">7847148</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blenkmann</surname><given-names>A. O.</given-names></name><name><surname>Phillips</surname><given-names>H. N.</given-names></name><name><surname>Princich</surname><given-names>J. P.</given-names></name><name><surname>Rowe</surname><given-names>J. B.</given-names></name><name><surname>Bekinschtein</surname><given-names>T. A.</given-names></name><name><surname>Muravchik</surname><given-names>C. H.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>ielectrodes: a comprehensive open-source toolbox for depth and subdural grid electrode localization</article-title>. <source>Front. Neuroinformat.</source><volume>11</volume>:<fpage>14</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2017.00014</pub-id><?supplied-pmid 28303098?><pub-id pub-id-type="pmid">28303098</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>Z.</given-names></name><name><surname>Sohrabpour</surname><given-names>A.</given-names></name><name><surname>Jiang</surname><given-names>H.</given-names></name><name><surname>Ye</surname><given-names>S.</given-names></name><name><surname>Joseph</surname><given-names>B.</given-names></name><name><surname>Brinkmann</surname><given-names>B. H.</given-names></name><etal/></person-group>. (<year>2021</year>). <article-title>Noninvasive high-frequency oscillations riding spikes delineates epileptogenic sources</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A.</source><volume>2021</volume>:<fpage>118</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.2011130118</pub-id><?supplied-pmid 33875582?><pub-id pub-id-type="pmid">33875582</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colombet</surname><given-names>B.</given-names></name><name><surname>Woodman</surname><given-names>M.</given-names></name><name><surname>Badier</surname><given-names>J.</given-names></name><name><surname>Bénar</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>). <article-title>Anywave: a cross-platform and modular software for visualizing and processing electrophysiological signals</article-title>. <source>J. Neurosci. Method.</source>
<volume>242</volume>, <fpage>118</fpage>–<lpage>126</lpage>. <pub-id pub-id-type="doi">10.1016/j.jneumeth.2015.01.017</pub-id><?supplied-pmid 25614386?><pub-id pub-id-type="pmid">25614386</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cossu</surname><given-names>M.</given-names></name><name><surname>Fuschillo</surname><given-names>D.</given-names></name><name><surname>Casaceli</surname><given-names>G.</given-names></name><name><surname>Pelliccia</surname><given-names>V.</given-names></name><name><surname>Castana</surname><given-names>L.</given-names></name><name><surname>Mai</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Stereoelectroencephalography-guided radiofrequency thermocoagulation in the epileptogenic zone: a retrospective study on 89 cases</article-title>. <source>J. Neurosurg.</source><volume>123</volume>, <fpage>1358</fpage>–<lpage>1367</lpage>. <pub-id pub-id-type="doi">10.3171/2014.12.JNS141968</pub-id><?supplied-pmid 26090841?><pub-id pub-id-type="pmid">26090841</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dale</surname><given-names>A. M.</given-names></name><name><surname>Fischl</surname><given-names>B.</given-names></name><name><surname>Sereno</surname><given-names>M. I.</given-names></name></person-group> (<year>1999</year>). <article-title>Cortical surface-based analysis: I. Segmentation and surface reconstruction</article-title>. <source>Neuroimage</source>
<volume>9</volume>, <fpage>179</fpage>–<lpage>194</lpage>. <pub-id pub-id-type="doi">10.1006/nimg.1998.0395</pub-id><?supplied-pmid 9931268?><pub-id pub-id-type="pmid">9931268</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalitz</surname><given-names>C.</given-names></name><name><surname>Schramke</surname><given-names>T.</given-names></name><name><surname>Jeltsch</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>). <article-title>Iterative hough transform for line detection in 3d point clouds</article-title>. <source>Image Proces.</source>
<volume>7</volume>, <fpage>184</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.5201/ipol.2017.208</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darcey</surname><given-names>T. M.</given-names></name><name><surname>Roberts</surname><given-names>D. W.</given-names></name></person-group> (<year>2010</year>). <article-title>Technique for the localization of intracranially implanted electrodes</article-title>. <source>J. Neurosurg.</source>
<volume>113</volume>, <fpage>1182</fpage>–<lpage>1185</lpage>. <pub-id pub-id-type="doi">10.3171/2009.12.JNS091678</pub-id><?supplied-pmid 20113163?><pub-id pub-id-type="pmid">20113163</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dykstra</surname><given-names>A. R.</given-names></name><name><surname>Chan</surname><given-names>A. M.</given-names></name><name><surname>Quinn</surname><given-names>B. T.</given-names></name><name><surname>Zepeda</surname><given-names>R.</given-names></name><name><surname>Keller</surname><given-names>C. J.</given-names></name><name><surname>Cormier</surname><given-names>J.</given-names></name><etal/></person-group>. (<year>2012</year>). <article-title>Individualized localization and cortical surface-based registration of intracranial electrodes</article-title>. <source>Neuroimage</source><volume>59</volume>, <fpage>3563</fpage>–<lpage>3570</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.11.046</pub-id><?supplied-pmid 22155045?><pub-id pub-id-type="pmid">22155045</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischl</surname><given-names>B.</given-names></name></person-group> (<year>2012</year>). <article-title>Freesurfer</article-title>. <source>Neuroimage</source>
<volume>62</volume>, <fpage>774</fpage>–<lpage>781</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.01.021</pub-id><?supplied-pmid 22248573?><pub-id pub-id-type="pmid">22248573</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grinenko</surname><given-names>O.</given-names></name><name><surname>Li</surname><given-names>J.</given-names></name><name><surname>Mosher</surname><given-names>J. C.</given-names></name><name><surname>Wang</surname><given-names>I. Z.</given-names></name><name><surname>Bulacio</surname><given-names>J. C.</given-names></name><name><surname>Gonzalez-Martinez</surname><given-names>J.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>A fingerprint of the epileptogenic zone in human epilepsies</article-title>. <source>Brain</source><volume>141</volume>, <fpage>117</fpage>–<lpage>131</lpage>. <pub-id pub-id-type="doi">10.1093/brain/awx306</pub-id><?supplied-pmid 29253102?><pub-id pub-id-type="pmid">29253102</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname><given-names>L. S.</given-names></name><name><surname>Chang</surname><given-names>D. L.</given-names></name><name><surname>Lee</surname><given-names>M. B.</given-names></name><name><surname>Chang</surname><given-names>E. F.</given-names></name></person-group> (<year>2017</year>). <article-title>Semi-automated anatomical labeling and inter-subject warping of high-density intracranial recording electrodes in electrocorticography</article-title>. <source>Front. Neuroinformat.</source>
<volume>11</volume>:<fpage>62</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2017.00062</pub-id><?supplied-pmid 29163118?><pub-id pub-id-type="pmid">29163118</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henschel</surname><given-names>L.</given-names></name><name><surname>Conjeti</surname><given-names>S.</given-names></name><name><surname>Estrada</surname><given-names>S.</given-names></name><name><surname>Diers</surname><given-names>K.</given-names></name><name><surname>Fischl</surname><given-names>B.</given-names></name><name><surname>Reuter</surname><given-names>M.</given-names></name></person-group> (<year>2020</year>). <article-title>Fastsurfer-a fast and accurate deep learning based neuroimaging pipeline</article-title>. <source>NeuroImage</source>
<volume>219</volume>:<fpage>117012</fpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.117012</pub-id><?supplied-pmid 32526386?><pub-id pub-id-type="pmid">32526386</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Illingworth</surname><given-names>J.</given-names></name><name><surname>Kittler</surname><given-names>J.</given-names></name></person-group> (<year>1988</year>). <article-title>A survey of the hough transform</article-title>. <source>Comput. Vis. Graph. Image Proces.</source>
<volume>44</volume>, <fpage>87</fpage>–<lpage>116</lpage>. <pub-id pub-id-type="doi">10.1016/S0734-189X(88)80033-1</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jeltsch</surname><given-names>M.</given-names></name><name><surname>Dalitz</surname><given-names>C.</given-names></name><name><surname>Pohle-Fröhlich</surname><given-names>R.</given-names></name></person-group> (<year>2016</year>). <article-title>Hough parameter space regularisation for line detection in 3d,</article-title> in <source>VISIGRAPP (4: VISAPP)</source> (<publisher-loc>Rome</publisher-loc>: <publisher-name>SciTePress</publisher-name>), <fpage>345</fpage>–<lpage>352</lpage>. <pub-id pub-id-type="doi">10.5220/0005679003450352</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkinson</surname><given-names>M.</given-names></name><name><surname>Beckmann</surname><given-names>C. F.</given-names></name><name><surname>Behrens</surname><given-names>T. E.</given-names></name><name><surname>Woolrich</surname><given-names>M. W.</given-names></name><name><surname>Smith</surname><given-names>S. M.</given-names></name></person-group> (<year>2012</year>). <article-title>Fsl</article-title>. <source>Neuroimage</source>
<volume>62</volume>, <fpage>782</fpage>–<lpage>790</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.09.015</pub-id><?supplied-pmid 21979382?><pub-id pub-id-type="pmid">21979382</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiruska</surname><given-names>P.</given-names></name><name><surname>Alvarado-Rojas</surname><given-names>C.</given-names></name><name><surname>Schevon</surname><given-names>C. A.</given-names></name><name><surname>Staba</surname><given-names>R.</given-names></name><name><surname>Stacey</surname><given-names>W.</given-names></name><name><surname>Wendling</surname><given-names>F.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Update on the mechanisms and roles of high-frequency oscillations in seizures and epileptic disorders</article-title>. <source>Epilepsia</source><volume>58</volume>, <fpage>1330</fpage>–<lpage>1339</lpage>. <pub-id pub-id-type="doi">10.1111/epi.13830</pub-id><?supplied-pmid 28681378?><pub-id pub-id-type="pmid">28681378</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwan</surname><given-names>P.</given-names></name><name><surname>Brodie</surname><given-names>M. J.</given-names></name></person-group> (<year>2000</year>). <article-title>Early identification of refractory epilepsy</article-title>. <source>N. Engl. J. Med.</source>
<volume>342</volume>, <fpage>314</fpage>–<lpage>319</lpage>. <pub-id pub-id-type="doi">10.1056/NEJM200002033420503</pub-id><?supplied-pmid 10660394?><pub-id pub-id-type="pmid">10660394</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G.</given-names></name><name><surname>Jiang</surname><given-names>S.</given-names></name><name><surname>Chen</surname><given-names>C.</given-names></name><name><surname>Brunner</surname><given-names>P.</given-names></name><name><surname>Wu</surname><given-names>Z.</given-names></name><name><surname>Schalk</surname><given-names>G.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>ieegview: an open-source multifunction gui-based matlab toolbox for localization and visualization of human intracranial electrodes</article-title>. <source>J. Neural Eng.</source><volume>17</volume>:<fpage>016016</fpage>. <pub-id pub-id-type="doi">10.1088/1741-2552/ab51a5</pub-id><?supplied-pmid 31658449?><pub-id pub-id-type="pmid">31658449</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narizzano</surname><given-names>M.</given-names></name><name><surname>Arnulfo</surname><given-names>G.</given-names></name><name><surname>Ricci</surname><given-names>S.</given-names></name><name><surname>Toselli</surname><given-names>B.</given-names></name><name><surname>Tisdall</surname><given-names>M.</given-names></name><name><surname>Canessa</surname><given-names>A.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Seeg assistant: a 3dslicer extension to support epilepsy surgery</article-title>. <source>BMC Bioinformat.</source><volume>18</volume>, <fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1186/s12859-017-1545-8</pub-id><?supplied-pmid 28231759?><pub-id pub-id-type="pmid">28231759</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navarrete</surname><given-names>M.</given-names></name><name><surname>Alvarado-Rojas</surname><given-names>C.</given-names></name><name><surname>Le Van Quyen</surname><given-names>M.</given-names></name><name><surname>Valderrama</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>). <article-title>Ripplelab: a comprehensive application for the detection, analysis and classification of high frequency oscillations in electroencephalographic signals</article-title>. <source>PLoS ONE</source>
<volume>11</volume>:<fpage>e0158276</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0158276</pub-id><?supplied-pmid 27341033?><pub-id pub-id-type="pmid">27341033</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F.</given-names></name><name><surname>Varoquaux</surname><given-names>G.</given-names></name><name><surname>Gramfort</surname><given-names>A.</given-names></name><name><surname>Michel</surname><given-names>V.</given-names></name><name><surname>Thirion</surname><given-names>B.</given-names></name><name><surname>Grisel</surname><given-names>O.</given-names></name><etal/></person-group>. (<year>2011</year>). <article-title>Scikit-learn: machine learning in python</article-title>. <source>J. Machine Learn. Res.</source><volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>C.</given-names></name><name><surname>Tan</surname><given-names>Z.</given-names></name><name><surname>Pan</surname><given-names>Y.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Ren</surname><given-names>L.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Automatic and precise localization and cortical labeling of subdural and depth intracranial electrodes</article-title>. <source>Front. Neuroinformat.</source><volume>11</volume>:<fpage>10</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2017.00010</pub-id><?supplied-pmid 28261083?><pub-id pub-id-type="pmid">28261083</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remakanthakurup Sindhu</surname><given-names>K.</given-names></name><name><surname>Staba</surname><given-names>R.</given-names></name><name><surname>Lopour</surname><given-names>B. A.</given-names></name></person-group> (<year>2020</year>). <article-title>Trends in the use of automated algorithms for the detection of high-frequency oscillations associated with human epilepsy</article-title>. <source>Epilepsia</source>
<volume>61</volume>, <fpage>1553</fpage>–<lpage>1569</lpage>. <pub-id pub-id-type="doi">10.1111/epi.16622</pub-id><?supplied-pmid 32729943?><pub-id pub-id-type="pmid">32729943</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>D. A.</given-names></name></person-group> (<year>2009</year>). <article-title>Gaussian mixture models</article-title>. <source>Encycl. Biometr.</source>
<volume>741</volume>, <fpage>659</fpage>–<lpage>663</lpage>. <pub-id pub-id-type="doi">10.1007/978-0-387-73003-5_196</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roehri</surname><given-names>N.</given-names></name><name><surname>Bartolomei</surname><given-names>F.</given-names></name></person-group> (<year>2019</year>). <article-title>Are high-frequency oscillations better biomarkers of the epileptogenic zone than spikes?</article-title>
<source>Curr. Opin. Neurol.</source>
<volume>32</volume>, <fpage>213</fpage>–<lpage>219</lpage>. <pub-id pub-id-type="doi">10.1097/WCO.0000000000000663</pub-id><?supplied-pmid 30694920?><pub-id pub-id-type="pmid">30694920</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roehri</surname><given-names>N.</given-names></name><name><surname>Pizzo</surname><given-names>F.</given-names></name><name><surname>Bartolomei</surname><given-names>F.</given-names></name><name><surname>Wendling</surname><given-names>F.</given-names></name><name><surname>Bénar</surname><given-names>C.-G.</given-names></name></person-group> (<year>2017</year>). <article-title>What are the assets and weaknesses of hfo detectors? a benchmark framework based on realistic simulations</article-title>. <source>PLoS ONE</source>
<volume>12</volume>:<fpage>e0174702</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0174702</pub-id><?supplied-pmid 28406919?><pub-id pub-id-type="pmid">28406919</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenow</surname><given-names>F.</given-names></name><name><surname>Lüders</surname><given-names>H.</given-names></name></person-group> (<year>2001</year>). <article-title>Presurgical evaluation of epilepsy</article-title>. <source>Brain</source>
<volume>124</volume>, <fpage>1683</fpage>–<lpage>1700</lpage>. <pub-id pub-id-type="doi">10.1093/brain/124.9.1683</pub-id><?supplied-pmid 11522572?><pub-id pub-id-type="pmid">11522572</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tadel</surname><given-names>F.</given-names></name><name><surname>Baillet</surname><given-names>S.</given-names></name><name><surname>Mosher</surname><given-names>J. C.</given-names></name><name><surname>Pantazis</surname><given-names>D.</given-names></name><name><surname>Leahy</surname><given-names>R. M.</given-names></name></person-group> (<year>2011</year>). <article-title>Brainstorm: a user-friendly application for meg/eeg analysis</article-title>. <source>Comput. Intell. Neurosci.</source>
<volume>2011</volume>:<fpage>879716</fpage>. <pub-id pub-id-type="doi">10.1155/2011/879716</pub-id><?supplied-pmid 21584256?><pub-id pub-id-type="pmid">21584256</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P.</given-names></name><name><surname>Gommers</surname><given-names>R.</given-names></name><name><surname>Oliphant</surname><given-names>T. E.</given-names></name><name><surname>Haberland</surname><given-names>M.</given-names></name><name><surname>Reddy</surname><given-names>T.</given-names></name><name><surname>Cournapeau</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>Scipy 1.0: fundamental algorithms for scientific computing in python</article-title>. <source>Nat. Method.</source><volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-020-0772-5</pub-id><?supplied-pmid 32094914?><pub-id pub-id-type="pmid">32094914</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S.</given-names></name><name><surname>So</surname><given-names>N. K.</given-names></name><name><surname>Jin</surname><given-names>B.</given-names></name><name><surname>Wang</surname><given-names>I. Z.</given-names></name><name><surname>Bulacio</surname><given-names>J. C.</given-names></name><name><surname>Enatsu</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Interictal ripples nested in epileptiform discharge help to identify the epileptogenic zone in neocortical epilepsy</article-title>. <source>Clin. Neurophysiol.</source><volume>128</volume>, <fpage>945</fpage>–<lpage>951</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2017.03.033</pub-id><?supplied-pmid 28412559?><pub-id pub-id-type="pmid">28412559</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S.</given-names></name><name><surname>Wang</surname><given-names>I. Z.</given-names></name><name><surname>Bulacio</surname><given-names>J. C.</given-names></name><name><surname>Mosher</surname><given-names>J. C.</given-names></name><name><surname>Gonzalez-Martinez</surname><given-names>J.</given-names></name><name><surname>Alexopoulos</surname><given-names>A. V.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>Ripple classification helps to localize the seizure-onset zone in neocortical epilepsy</article-title>. <source>Epilepsia</source><volume>54</volume>, <fpage>370</fpage>–<lpage>376</lpage>. <pub-id pub-id-type="doi">10.1111/j.1528-1167.2012.03721.x</pub-id><?supplied-pmid 23106394?><pub-id pub-id-type="pmid">23106394</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S.</given-names></name><name><surname>Zhao</surname><given-names>M.</given-names></name><name><surname>Li</surname><given-names>T.</given-names></name><name><surname>Zhang</surname><given-names>C.</given-names></name><name><surname>Zhou</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>Stereotactic radiofrequency thermocoagulation and resective surgery for patients with hypothalamic hamartoma</article-title>. <source>J. Neurosurg.</source><volume>134</volume>, <fpage>1019</fpage>–<lpage>1026</lpage>. <pub-id pub-id-type="doi">10.3171/2020.2.JNS193423</pub-id><?supplied-pmid 32302977?><pub-id pub-id-type="pmid">32302977</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Zhou</surname><given-names>W.</given-names></name><name><surname>Wang</surname><given-names>S.</given-names></name><name><surname>Zhou</surname><given-names>Q.</given-names></name><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Zhang</surname><given-names>B.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>The roles of subdivisions of human insula in emotion perception and auditory processing</article-title>. <source>Cerebr. Cortex</source><volume>29</volume>, <fpage>517</fpage>–<lpage>528</lpage>. <pub-id pub-id-type="doi">10.1093/cercor/bhx334</pub-id><?supplied-pmid 29342237?><pub-id pub-id-type="pmid">29342237</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>T.</given-names></name><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Wang</surname><given-names>K.</given-names></name><name><surname>Yang</surname><given-names>X.</given-names></name><name><surname>Zhou</surname><given-names>W.</given-names></name><name><surname>Hong</surname><given-names>B.</given-names></name></person-group> (<year>2019</year>). <article-title>Cross-modal consistency of epileptogenic network in seeg and resting-state fmri,</article-title> in <source>2019 9th International IEEE/EMBS Conference on Neural Engineering (NER)</source> (<publisher-loc>San Francisco, CA</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>953</fpage>–<lpage>956</lpage>. <pub-id pub-id-type="doi">10.1109/NER.2019.8716989</pub-id><?supplied-pmid 27295638?></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zöllei</surname><given-names>L.</given-names></name><name><surname>Iglesias</surname><given-names>J. E.</given-names></name><name><surname>Ou</surname><given-names>Y.</given-names></name><name><surname>Grant</surname><given-names>P. E.</given-names></name><name><surname>Fischl</surname><given-names>B.</given-names></name></person-group> (<year>2020</year>). <article-title>Infant freesurfer: an automated segmentation and surface extraction pipeline for t1-weighted neuroimaging data of infants 0–2 years</article-title>. <source>Neuroimage</source>
<volume>218</volume>:<fpage>116946</fpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116946</pub-id><?supplied-pmid 32442637?><pub-id pub-id-type="pmid">32442637</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
