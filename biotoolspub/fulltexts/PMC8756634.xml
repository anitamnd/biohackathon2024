<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8756634</article-id>
    <article-id pub-id-type="publisher-id">4507</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04507-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>baredSC: Bayesian approach to retrieve expression distribution of single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1964-4960</contrib-id>
        <name>
          <surname>Lopez-Delisle</surname>
          <given-names>Lucille</given-names>
        </name>
        <address>
          <email>lucille.delisle@epfl.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5844-9888</contrib-id>
        <name>
          <surname>Delisle</surname>
          <given-names>Jean-Baptiste</given-names>
        </name>
        <address>
          <email>jean-baptiste.delisle@unige.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5333.6</institution-id><institution-id institution-id-type="ISNI">0000000121839049</institution-id><institution>EPFL SV ISREC UPDUB, </institution></institution-wrap>1015 Lausanne, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.8591.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2322 4988</institution-id><institution>Département d’astronomie, </institution><institution>Université de Genève, </institution></institution-wrap>Chemin Pegasi 51, 1290 Versoix, Geneva, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>36</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The number of studies using single-cell RNA sequencing (scRNA-seq) is constantly growing. This powerful technique provides a sampling of the whole transcriptome of a cell. However, sparsity of the data can be a major hurdle when studying the distribution of the expression of a specific gene or the correlation between the expressions of two genes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We show that the main technical noise associated with these scRNA-seq experiments is due to the sampling, i.e., Poisson noise. We present a new tool named baredSC, for Bayesian Approach to Retrieve Expression Distribution of Single-Cell data, which infers the intrinsic expression distribution in scRNA-seq data using a Gaussian mixture model. baredSC can be used to obtain the distribution in one dimension for individual genes and in two dimensions for pairs of genes, in particular to estimate the correlation in the two genes’ expressions. We apply baredSC to simulated scRNA-seq data and show that the algorithm is able to uncover the expression distribution used to simulate the data, even in multi-modal cases with very sparse data. We also apply baredSC to two real biological data sets. First, we use it to measure the anti-correlation between <italic>Hoxd13</italic> and <italic>Hoxa11</italic>, two genes with known genetic interaction in embryonic limb. Then, we study the expression of <italic>Pitx1</italic> in embryonic hindlimb, for which a trimodal distribution has been identified through flow cytometry. While other methods to analyze scRNA-seq are too sensitive to sampling noise, baredSC reveals this trimodal distribution.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">baredSC is a powerful tool which aims at retrieving the expression distribution of few genes of interest from scRNA-seq data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04507-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>scRNA-seq</kwd>
      <kwd>Bayesian</kwd>
      <kwd>MCMC</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>SNSF</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>588029</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EPFL</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">The single-cell RNA sequencing (scRNA-seq) method allows to assess the transcriptome of individual cells [<xref ref-type="bibr" rid="CR1">1</xref>]. Thanks to the decreasing cost and to the simplification of the protocols, this technique is more and more popular. One can distinguish two classes of methods: the plate-based methods and the droplet-based methods (also called microfluidic-based methods). The first ones often provide a better estimation of genes expression for individual cells, as the number of reads per cell is usually higher. However, the experimental procedure is more complicated and these methods typically generate data for hundreds of cells. The second ones are more widely used and provide usually sparser information (less reads per cell) but for a larger number of cells (typically 50 times more) [<xref ref-type="bibr" rid="CR2">2</xref>]. As a consequence, droplet-based methods are often preferred when complex tissues are studied. Indeed, they allow to identify more precisely pools of cells with close cellular identity (clusters) [<xref ref-type="bibr" rid="CR3">3</xref>]. Gene expression within clusters are then studied in more details which is not possible when the number of cells is too low. However, with droplet-based methods, the number of reads for a given cell is very low compared to the complexity of the transcriptome. Therefore, lowly expressed genes are not always detected, and if detected, their expression level is poorly constrained. The fact that a gene for a given cell is not detected while it is actually expressed is sometimes called ‘dropout’ [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. The origin and modeling of the ‘dropout’ phenomenon, and more generally of the observed variance in scRNA-seq is debated, as reflected by the number of different models used in tools dedicated to differential expression analysis [<xref ref-type="bibr" rid="CR8">8</xref>]. Here, we show that Poisson noise due to sampling explains very well the observed variance (dropout included) in droplet-based scRNA-seq. We find no evidence of more complex noise sources, such as additional dropouts, negative binomial distribution, etc.</p>
    <p id="Par5">For most common applications of scRNA-seq (clustering and identification of gene markers, projection like tSNE or UMAP) the sparsity of the data does not have a strong impact [<xref ref-type="bibr" rid="CR9">9</xref>]. However, the expression distribution of a given gene in a population of cells is difficult to estimate and its representation by a kernel density estimation (KDE) plot, like in the violin plot of Seurat [<xref ref-type="bibr" rid="CR10">10</xref>] or Scanpy [<xref ref-type="bibr" rid="CR11">11</xref>], can be misleading. Indeed, the sampling noise strongly spread the signal, and the cells with no count appear as an artificial homogeneous sub-population, mixing cells with low and no expression.</p>
    <p id="Par6">Gene correlation has been extensively studied in bulk RNA-seq in order to build regulatory networks [<xref ref-type="bibr" rid="CR12">12</xref>]. A recent study using scRNA-seq discovered gene covariations involving microRNA [<xref ref-type="bibr" rid="CR13">13</xref>]. miRNA are small RNAs which regulate gene expression by post-transcriptional processes [<xref ref-type="bibr" rid="CR14">14</xref>]. Such results would be difficult to obtain with bulk RNA-seq, showing the power of this type of study in homogenous scRNA-seq. However, this study has been conducted with a plate-based method on a very homogeneous population (mouse embryonic stem cells). When using droplet-based data, the sparsity of the data is a major barrier to this type of analysis restricting it to genes with high expression.</p>
    <p id="Par7">Recently, [<xref ref-type="bibr" rid="CR15">15</xref>] proposed a Bayesian normalization procedure called Sanity (SAmpling-Noise-corrected Inference of Transcription activitY). This method aims at correcting the counts of each cell from the sampling noise. The procedure is fast and can be applied before clustering and projection algorithms to improve their performance. It also prevents spurious correlation between pairs of genes. However, in order to efficiently perform these corrections, Sanity uses simplifying assumptions in the modeling of the genes’ expression distributions. Here, we also propose a Bayesian approach to disentangle the intrinsic variability in gene expressions from the sampling noise. However, instead of focusing on correcting the expression level of each cell, we aim at retrieving accurately the underlying expression distribution of the population of cells. Our tool, named baredSC (Bayesian Approach to Retrieve Expression Distribution of Single-Cell data), approximates the expression distribution of a gene by a Gaussian mixture model (GMM). This tool is dedicated to studies where the distribution of few genes needs to be estimated precisely. It can be used to retrieve the expression distribution of a single gene, but also to infer the joint distribution of two genes in order to study genetic interactions even when the gene expression level is low and thus the frequency of non-detection is high.</p>
    <p id="Par8">Using simulated data we show that it largely outperforms the classical density/violin representation and in most cases very accurately reproduces the original distribution, both in the one-dimensional and two-dimensional cases. We also show that when multi-modal distributions are simulated it gives more accurate results than Sanity. We also use real biological datasets to illustrate the power of baredSC to assess the correlation between genes or to reveal the multi-modality of a lowly expressed gene.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Poisson distribution is a good approximation for droplet-based single-cell RNA-seq data</title>
      <p id="Par9">We focus our analysis on droplet-based scRNA-seq as this is where the sparsity of the data is a major issue. We first evaluate the variability coming from the technique itself, including all steps of the protocol from RNA to the gene count matrix. Indeed, the source of variability in droplet-based scRNA-seq is still debated. The most obvious source of noise comes from the sampling, i.e. the fact that only a subset of the whole transcriptome is sequenced. This sampling noise is especially strong for lowly expressed genes and when the total number of reads per cell is low. In addition to the sampling noise, some specific steps of the technique, like the capture of mRNA or the amplification steps, could possibly introduce variability and/or biases [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p id="Par10">The most visible consequence of the noise is the so-called ‘dropout’ effect. [<xref ref-type="bibr" rid="CR2">2</xref>] studied this phenomenon and concluded that the fraction of cells with no count was fully compatible with a noise following a negative binomial distribution. However, this analysis was mostly conducted ignoring the variability in the total number of counts per cell which has a non-negligible effect on the variability of the number of counts for a given gene. Nevertheless, in the Additional file 1: Fig. S1 of [<xref ref-type="bibr" rid="CR2">2</xref>], the use of scaled data suggests that the simpler Poisson distribution could be sufficient to explain the number of dropouts.</p>
      <p id="Par11">Here, we reanalyze the same datasets as [<xref ref-type="bibr" rid="CR2">2</xref>], to evaluate all the noise contributions (dropouts and more generally the variability), using scaled data. Following [<xref ref-type="bibr" rid="CR2">2</xref>], we take advantage of published control datasets [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>] as well as two real biological datasets provided by 10X genomics with cells from a mouse cell line (NIH3T3) and from a human one (HEK293T). In the control datasets, a homogeneous solution of RNA was used as input instead of a solution of single-cells. This allows to study the technical noise without any influence of the cell to cell variability. Indeed, in these datasets, each pseudo single-cell was a droplet of the same RNA solution. On the contrary, the 10X genomics cell lines are real biological datasets where we expect to find both technical variations and biological variations.</p>
      <p id="Par12">When studying gene expression, the quantity of interest is the number of transcripts coding for a given gene <italic>g</italic> in cell <italic>i</italic>. Unfortunately, this quantification is very difficult to obtain and one often focus instead on the proportion of transcripts coding of a given gene <italic>g</italic> out of all transcripts in the cell <italic>i</italic>. We denote by <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq1.gif"/></alternatives></inline-formula> this fraction. An obvious estimator of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq2.gif"/></alternatives></inline-formula> is<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{i,g} = \frac{k_{i,g}}{N_i}, \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq3.gif"/></alternatives></inline-formula> is the number of counts for the gene <italic>g</italic> in the cell <italic>i</italic> and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq4.gif"/></alternatives></inline-formula> is the total number of counts identified in the cell <italic>i</italic>. However, since <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq5.gif"/></alternatives></inline-formula> is always much smaller than the total number of transcripts in the cell, <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq6.gif"/></alternatives></inline-formula> is strongly affected by sampling noise. Rigorously speaking, in the absence of other sources of noise, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq7.gif"/></alternatives></inline-formula> follows a binomial distribution with parameters <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq9.gif"/></alternatives></inline-formula>. This distribution can actually be approximated by a Poisson distribution with parameter <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i \lambda _{i,g}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq10.gif"/></alternatives></inline-formula> for sufficiently small <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq11.gif"/></alternatives></inline-formula> and large <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq12.gif"/></alternatives></inline-formula>. We thus have<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(X_{i,g}) = \frac{{{\,\mathrm{{\mathbb {E}}}\,}}(k_{i,g})}{N_{i}} = \lambda _{i,g}, \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{{\mathbb {E}}}\,}}(X)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq13.gif"/></alternatives></inline-formula> is the expectation of <italic>X</italic>, and<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{var}\,}}(X_{i,g}) = \frac{{{\,\mathrm{var}\,}}(k_{i,g})}{N_{i}^2} = \frac{\lambda _{i,g}}{N_{i}} = \frac{{{\,\mathrm{{\mathbb {E}}}\,}}(X_{i,g})}{N_{i}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{var}\,}}(X)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq14.gif"/></alternatives></inline-formula> is the variance of <italic>X</italic>. If additional sources of noise affect the experiment, one would expect an increase in variance. For instance, [<xref ref-type="bibr" rid="CR2">2</xref>] compared the Poisson distribution with the negative binomial distribution with the same expectation and a variance following<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{var}\,}}(k_{i,g}) = N_i \lambda _{i,g} + \Phi \left( N_i\lambda _{i,g}\right) ^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq15.gif"/></alternatives></inline-formula> is a new parameter which allows to account for an additional variance with respect to the Poisson distribution. In particular, the Poisson distribution is recovered for <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi =0$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq16.gif"/></alternatives></inline-formula>. In terms of <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,g}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq17.gif"/></alternatives></inline-formula>, the expectation still follows Eq. (<xref rid="Equ2" ref-type="">2</xref>), and the variance is now written as<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{var}\,}}(X_{i,g}) = \frac{\lambda _{i,g}}{N_{i}} + \Phi \lambda ^2_{i,g}. \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>For a given experiment, one only obtains a single realization of <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,g}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq18.gif"/></alternatives></inline-formula>, so the expectation and variance of <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,g}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq19.gif"/></alternatives></inline-formula> cannot be measured in order to compare the Poisson and negative binomial distributions. However, in the case of control experiments, each pseudo single cell is sampled from the same RNA solution, so the fraction <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq20.gif"/></alternatives></inline-formula> is the same in each cell. We denote by <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _g$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq21.gif"/></alternatives></inline-formula> this common value. By combining the reads in all pseudo cells, one can determine a very precise estimate of <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _g$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq22.gif"/></alternatives></inline-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} M_g = \frac{\sum _{i=1}^n k_{i,g}}{\sum _{i=1}^n N_i} = \frac{\sum _{i=1}^n N_i X_{i,g}}{\sum _{i=1}^n N_i}, \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>which by construction verifies<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(M_g) = \lambda _g, \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>for both the Poisson and negative binomial distributions. We additionally introduce the variance estimator<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_g = \frac{\sum _{i=1}^n N_i (X_{i,g} - M_g)^2}{\sum _{i=1}^n N_i}, \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>which provides a measure of the spread (variance) of the <inline-formula id="IEq23"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,g}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq23.gif"/></alternatives></inline-formula> values among the cells for a given gene <italic>g</italic>. The expected value of <inline-formula id="IEq24"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_g$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>V</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq24.gif"/></alternatives></inline-formula> is<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(V_g) = \frac{n-1}{\sum _{i=1}^n N_i}\left( \lambda _g + \Phi \lambda _g^2 \frac{(\sum _{i=1}^n N_i)^2 - \sum _{i=1}^n N_i^2}{(n-1)\sum _{i=1}^n N_i}\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>We define the normalized variance estimator<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{V}}_g = \frac{\sum _{i=1}^n N_i}{n-1} V_g \end{aligned}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>such that<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}({\tilde{V}}_g) = \lambda _g + \Phi \lambda _g^2 \frac{(\sum _{i=1}^n N_i)^2 - \sum _{i=1}^n N_i^2}{(n-1)\sum _{i=1}^n N_i}. \end{aligned}$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>In particular, in the case of the Poisson distribution (<inline-formula id="IEq25"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi =0$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq25.gif"/></alternatives></inline-formula>), we have <inline-formula id="IEq26"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{{\mathbb {E}}}\,}}({\tilde{V}}_g) = \lambda _g = {{\,\mathrm{{\mathbb {E}}}\,}}(M_g)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq26.gif"/></alternatives></inline-formula>, while for <inline-formula id="IEq27"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi &gt; 0$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq27.gif"/></alternatives></inline-formula> (excess of variance) we obtain <inline-formula id="IEq28"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{{\mathbb {E}}}\,}}({\tilde{V}}_g) &gt; {{\,\mathrm{{\mathbb {E}}}\,}}(M_g)$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq28.gif"/></alternatives></inline-formula>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Poisson is a good approximation to explain variance in droplet-based single-cell RNA-seq. In each dataset, control dataset (<bold>A</bold>) or real single-cell experiment (<bold>B</bold>), the normalized variance estimator is plotted in function of the estimated mean expression. Each dot is a gene. A Gaussian kernel smoother was applied to evaluate the tendency of the data (red line) and the error around the Gaussian kernel smoothing was estimated (yellow area). The expected variance in the Poisson approximation is a straight line (blue) whereas the expected variance in the negative binomial approximation is a quadratic curve (green). Both axes are in log scale</p></caption><graphic xlink:href="12859_2021_4507_Fig1_HTML" id="MO12"/></fig></p>
      <p id="Par13">To estimate which law is more adequate to explain the data we plot <inline-formula id="IEq29"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{V}}_g$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq29.gif"/></alternatives></inline-formula> against <inline-formula id="IEq30"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_g$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq30.gif"/></alternatives></inline-formula> for each gene <italic>g</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). If the data follow the Poisson distribution, we expect the points to align on the <inline-formula id="IEq31"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=x$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq31.gif"/></alternatives></inline-formula> line, while if the data present an additional noise (<inline-formula id="IEq32"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi &gt;0$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq32.gif"/></alternatives></inline-formula>), the points should end-up above this line. We noticed that the genes corresponding to ERCC (External RNA Control Consortium) spike-in had a behaviour different from what was observed for real genes, especially in the dataset from [<xref ref-type="bibr" rid="CR18">18</xref>] where the variance is highly increased (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1Ab). Thus, we decided to exclude these genes from the analysis. The results with ERCC spike-in information excluded are presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Overall, we find a very good agreement of the data with the Poisson distribution in the control datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). In datasets from [<xref ref-type="bibr" rid="CR20">20</xref>] (1) and (2) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Aa and b), the data perfectly follow the Poisson law for all expression levels. In the two other control datasets (from [<xref ref-type="bibr" rid="CR17">17</xref>] and [<xref ref-type="bibr" rid="CR18">18</xref>] Fig. <xref rid="Fig1" ref-type="fig">1</xref>Ac and d), both models perform equally well until a relatively high level of expression (about 1‰). Above 1‰, the variance slightly deviates from the Poisson prediction. However, in both cases, the deviation is very small and the results at high expression levels suffer from low number statistics. In addition, in the control experiment from [<xref ref-type="bibr" rid="CR17">17</xref>], such expression corresponds to the top 0.5% highly expressed genes like ribosomal protein or cytoskeleton proteins. Therefore, we conclude that the Poisson law very well explains the variance observed in the control datasets.</p>
      <p id="Par14">On the contrary, when considering real experiments, even with a homogeneous single-cell population (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B), we find that the variance strongly deviates from the Poisson prediction. Moreover, the deviation increases with the expression level and the negative binomial law captures this behaviour very well. This result clearly demonstrates the inter cellular heterogeneity in so-called homogeneous cell populations.</p>
      <p id="Par15">In [<xref ref-type="bibr" rid="CR2">2</xref>], the author finds that the negative binomial distribution better matches the data than the Poisson law, even for control datasets. This seems to contradict our results. However, the analysis of [<xref ref-type="bibr" rid="CR2">2</xref>] was performed on the raw number of counts <inline-formula id="IEq33"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq33.gif"/></alternatives></inline-formula>, without scaling it by the total number of counts <inline-formula id="IEq34"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq34.gif"/></alternatives></inline-formula>. The author uses the following estimators for the mean and variance of <inline-formula id="IEq35"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq35.gif"/></alternatives></inline-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m_g&amp;= \frac{1}{n} \sum _{i=1}^n k_{i,g},\nonumber \\ v_g&amp;= \frac{1}{n-1} \sum _{i=1}^n (k_{i,g}-m_g)^2. \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>If we assume <inline-formula id="IEq36"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq36.gif"/></alternatives></inline-formula> to follow a Poisson distribution with parameter <inline-formula id="IEq37"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i \lambda _g$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq37.gif"/></alternatives></inline-formula>, the expectation of <inline-formula id="IEq38"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_g$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq38.gif"/></alternatives></inline-formula> and <inline-formula id="IEq39"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_g$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq39.gif"/></alternatives></inline-formula> are written as<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(m_g)&amp;= {\bar{N}} \lambda _g ,\nonumber \\ {{\,\mathrm{{\mathbb {E}}}\,}}(v_g)&amp;= {\bar{N}} \lambda _g + {{\,\mathrm{var}\,}}(N)\lambda _g^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq40"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{N}}$$\end{document}</tex-math><mml:math id="M106"><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq40.gif"/></alternatives></inline-formula> is the average of the <inline-formula id="IEq41"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq41.gif"/></alternatives></inline-formula> values, and <inline-formula id="IEq42"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{var}\,}}(N)$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq42.gif"/></alternatives></inline-formula> their variance<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\bar{N}}&amp;= \frac{1}{n} \sum _{i=1}^n N_i,\nonumber \\ {{\,\mathrm{var}\,}}(N)&amp;= \frac{1}{n-1} \sum _{i=1}^n \left( N_i-{\bar{N}}\right) ^2. \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>The variations of <inline-formula id="IEq43"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq43.gif"/></alternatives></inline-formula> were neglected by [<xref ref-type="bibr" rid="CR2">2</xref>], which would correspond to assuming <inline-formula id="IEq44"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i = {\bar{N}}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{var}\,}}(N) = 0$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq45.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ13" ref-type="">13</xref>). In this case, one would thus expect to find <inline-formula id="IEq46"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{{\mathbb {E}}}\,}}(m_g) = {{\,\mathrm{{\mathbb {E}}}\,}}(v_g) = {\bar{N}}\lambda _g$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq46.gif"/></alternatives></inline-formula>, if <inline-formula id="IEq47"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq47.gif"/></alternatives></inline-formula> follows a Poisson distribution. Svensson [<xref ref-type="bibr" rid="CR2">2</xref>] found the data to be better described by a negative binomial distribution for <inline-formula id="IEq48"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq48.gif"/></alternatives></inline-formula> with a free parameters <inline-formula id="IEq49"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M126"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq49.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(m_g)&amp;= {\bar{N}} \lambda _g ,\nonumber \\ {{\,\mathrm{{\mathbb {E}}}\,}}(v_g)&amp;= {\bar{N}} \lambda _g + \phi \left( {\bar{N}}\lambda _g\right) ^2. \end{aligned}$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>This expression can actually match the formula we obtain assuming a Poisson distribution but accounting for the variability of <inline-formula id="IEq50"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq50.gif"/></alternatives></inline-formula> (see Eq. (<xref rid="Equ13" ref-type="">13</xref>)), if we take<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi = \phi _\mathrm {Poisson} = \frac{{{\,\mathrm{var}\,}}(N)}{{\bar{N}}^2}. \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">Poisson</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>In Table <xref rid="Tab1" ref-type="table">1</xref>, we compare the values of the parameter <inline-formula id="IEq51"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M134"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq51.gif"/></alternatives></inline-formula> fitted by [<xref ref-type="bibr" rid="CR2">2</xref>] with the values <inline-formula id="IEq52"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _\mathrm {Poisson}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">Poisson</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq52.gif"/></alternatives></inline-formula> computed with Eq. (<xref rid="Equ16" ref-type="">16</xref>), for the control datasets including the spike-in ERCC. We find a very good agreement between these values for all the considered experiments. This shows that the variations in the number of counts per cell is the main source of the excess noise found by [<xref ref-type="bibr" rid="CR2">2</xref>]. This also confirms that the Poisson distribution very well explains the observed variations, as already noticed with the experiment of Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This is also confirmed by a reanalysis of these control datasets with the same strategy as in [<xref ref-type="bibr" rid="CR2">2</xref>] but selecting cells with relatively close total number of counts per cell so decreasing the variations in the number of counts per cell [<xref ref-type="bibr" rid="CR21">21</xref>]. The authors find values of <inline-formula id="IEq53"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M138"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq53.gif"/></alternatives></inline-formula> close to 0.01. Another reanalysis of these datasets comparing their behaviours with simulated datasets following negative binomial of known dispersion conclude that they are not similar to simulated datasets with Poisson model but were consistent with <inline-formula id="IEq54"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M140"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq54.gif"/></alternatives></inline-formula> values around 0.01 which makes the Poisson model sufficient in practice [<xref ref-type="bibr" rid="CR22">22</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of the values <inline-formula id="IEq55"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _\mathrm {fit}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">fit</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq55.gif"/></alternatives></inline-formula> of the parameter <inline-formula id="IEq56"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M144"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq56.gif"/></alternatives></inline-formula> found by [<xref ref-type="bibr" rid="CR2">2</xref>] with the values <inline-formula id="IEq57"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _\mathrm {Poisson}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">Poisson</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq57.gif"/></alternatives></inline-formula> expected from the Poisson law when taking into account the variability in the total number of counts per cell (see Eq. (<xref rid="Equ16" ref-type="">16</xref>))</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Experiment</th><th align="left"><inline-formula id="IEq58"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _\mathrm {fit}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">fit</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq58.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq59"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _\mathrm {Poisson}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi mathvariant="normal">Poisson</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq59.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">Klein</td><td align="left">0.0428</td><td align="left">0.0451</td></tr><tr><td align="left">Macosko</td><td align="left">0.116</td><td align="left">0.115</td></tr><tr><td align="left">Zheng</td><td align="left">0.0416</td><td align="left">0.0426</td></tr><tr><td align="left">Svensson1</td><td align="left">0.0940</td><td align="left">0.0969</td></tr><tr><td align="left">Svensson2</td><td align="left">0.369</td><td align="left">0.379</td></tr></tbody></table></table-wrap></p>
      <p id="Par16">Overall, the tests performed in this section show that the variability in droplet-based scRNA-seq is dominated by sampling noise and follows a Poisson distribution. However, it should be noted that we cannot exclude the introduction of biases at specific steps of the technique like increased or decreased reverse transcription or amplification of specific transcripts [<xref ref-type="bibr" rid="CR16">16</xref>]. Indeed such bias would lead to a global increased or decreased presence of these genes and consequently to an overall overestimation or underestimation of each expression value. However, the variance on these genes would still follow a Poisson law.</p>
    </sec>
    <sec id="Sec4">
      <title>Estimating the distribution of expression values of a gene</title>
      <p id="Par17">We are interested here in estimating the intrinsic variability in the expression values of a given gene in a population of cells. As shown above, the output of a droplet-based scRNA-seq experiment presents not only this intrinsic variability but also an additional variability due to sampling noise, following a Poisson distribution. For lowly expressed genes and when the number of counts per cell is low, the sampling noise can actually dominate and hide the intrinsic population variability (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2).</p>
      <p id="Par18">To disentangle these two contributions, we introduce a parametric model of the intrinsic expression variability. In order to describe both high expression levels and low expression levels, the relative level of a gene is often represented in log scale or using a log transformation with a pseudo count (see Methods: <xref rid="Sec19" ref-type="sec">GMM of the PDF</xref> for more details). While the choice of the transformation influences the result, the same strategy can be used in any transformation. We assume that the probability density function (PDF) of the transformation of the relative expression level of a gene in the population of cells can be approximated by a GMM. The number of components <italic>m</italic> in the mixture, as well as the Gaussians’ amplitudes <italic>A</italic>, means <inline-formula id="IEq60"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M152"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq60.gif"/></alternatives></inline-formula>, and widths <inline-formula id="IEq61"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M154"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq61.gif"/></alternatives></inline-formula>, are free parameters that need to be adjusted to best reproduce the observed number of counts of the considered gene in each cell. We denote by <inline-formula id="IEq62"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {G}}(\lambda | m, A, \mu , \sigma )$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq62.gif"/></alternatives></inline-formula> this PDF (see Methods: <xref rid="Sec20" ref-type="sec">Estimation of likelihood</xref> for more details). Then, for a cell <italic>i</italic> whose expression level for gene <italic>g</italic> is <inline-formula id="IEq63"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq63.gif"/></alternatives></inline-formula>, the probability to get <inline-formula id="IEq64"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq64.gif"/></alternatives></inline-formula> out of <inline-formula id="IEq65"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq65.gif"/></alternatives></inline-formula> counts follows the Poisson distribution <inline-formula id="IEq66"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}(k_{i,g} | N_i \lambda _{i,g})$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq66.gif"/></alternatives></inline-formula>. Therefore, the likelihood <inline-formula id="IEq67"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {L}}$$\end{document}</tex-math><mml:math id="M166"><mml:mi mathvariant="script">L</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq67.gif"/></alternatives></inline-formula> of a given set of parameters <inline-formula id="IEq68"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(m,A,\mu ,\sigma )$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq68.gif"/></alternatives></inline-formula> is written as<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}(m,A,\mu ,\sigma )&amp;= \prod _{i=1}^n p(k_{i,g}|N_i,m,A,\mu ,\sigma )\nonumber \\&amp;= \prod _{i=1}^n \int {\mathcal {P}}(k_{i,g}| N_i\lambda ) {\mathcal {G}}(\lambda | m,A, \mu , \sigma ) \mathrm {d}\lambda . \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>∫</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>λ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>We estimate this integral numerically as described in Methods: <xref rid="Sec19" ref-type="sec">GMM of the PDF</xref>. While the set of parameters <inline-formula id="IEq69"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m,A,\mu ,\sigma$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq69.gif"/></alternatives></inline-formula> could be determined by maximizing the likelihood, we advocate here for a Bayesian approach which prevents an overfit of the data and allows to better estimate confidence intervals on the parameters and on the corresponding PDF <inline-formula id="IEq70"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {G}}$$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq70.gif"/></alternatives></inline-formula>, which is the quantity of interest in this study. We thus use a Markov chain Monte Carlo (MCMC) algorithm to explore the parameters <italic>A</italic>, <inline-formula id="IEq71"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M176"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq71.gif"/></alternatives></inline-formula>, <inline-formula id="IEq72"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M178"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq72.gif"/></alternatives></inline-formula> for a given number of components <italic>m</italic>. Then we combine the results obtained for different <italic>m</italic> by evaluating the evidence of each model using an importance sampling algorithm. These Bayesian approaches (MCMC and importance sampling algorithms) require to define priors on the model parameters. We provide more details on the algorithms and priors in Methods: <xref rid="Sec21" ref-type="sec">Priors on parameters</xref> and <xref rid="Sec22" ref-type="sec">MCMC algorithm</xref>. We call this algorithm baredSC for Bayesian Approach to Retrieve Expression Distribution of Single-Cell data.</p>
      <p id="Par19">In order to test the efficiency of the algorithm to retrieve the intrinsic distribution, we simulated data using 300, 500, 1561 cells or all (2361 cells) with <inline-formula id="IEq73"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq73.gif"/></alternatives></inline-formula> values taken from a real 10X dataset (see Methods: <xref rid="Sec26" ref-type="sec">Simulation of data</xref>). We generated random values for the expression in each cell (<inline-formula id="IEq74"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq74.gif"/></alternatives></inline-formula>) according to various intrinsic distributions on the <inline-formula id="IEq75"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1 + 10^4 \lambda _g)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq75.gif"/></alternatives></inline-formula> scale: single Gaussian (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A), uniform distribution (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), two or three Gaussians (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C), or a sub-population of zeros (cells not expressing the gene) and a Gaussian (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). We varied the mean and the width of each of these distributions to cover a wide range of potential biological cases. Then, we simulated a scRNA-seq by randomly sampling the <inline-formula id="IEq76"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq76.gif"/></alternatives></inline-formula> values from a Poisson law using the determined <inline-formula id="IEq77"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq78.gif"/></alternatives></inline-formula> values. Finally, these simulated counts were analyzed using baredSC with the same log transformation (<inline-formula id="IEq79"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1 + 10^4 \lambda _g)$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq79.gif"/></alternatives></inline-formula>) with up to four Gaussians in the mixture.<fig id="Fig2"><label>Fig. 2</label><caption><p>MCMC allows a good estimation of the distribution. In each simulation, the simulated distribution is plotted in blue and its characteristics are written above (N for normal, U for uniform followed by loc and scale values as in the scipy package as well as the proportion of cells with no expression in <bold>D</bold>). The values obtained after Poisson simulation are summarized by the red curve (Density from data). The mean PDF obtained by baredSC is depicted in green and the green area shows the quantile 16–84%. In <bold>A</bold>, distribution is only composed of one normal distribution, in <bold>B</bold>, only one uniform distribution, in <bold>C</bold> two or three Gaussians were used and in <bold>D</bold> a normal distribution for part of the cells and no expression for other</p></caption><graphic xlink:href="12859_2021_4507_Fig2_HTML" id="MO19"/></fig></p>
      <p id="Par20">In the single Gaussian cases, the algorithm very efficiently approximates the intrinsic distribution, even with only 300 cells (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). We plot in Fig. <xref rid="Fig2" ref-type="fig">2</xref>B the case of uniform distributions. While the exact shape of the original distribution cannot be exactly reproduced using a GMM, it is still reasonably well approximated. In particular, when the scale is large enough, the model uses multiple Gaussians to better reproduce a flat distribution. Such a distribution is unlikely to exists in biology, but it illustrates well the versatility of the GMM. When multi-modal distributions were simulated, baredSC could in most cases accurately identify the different modes (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). The algorithm sometimes slightly deviates from the simulated distribution in the range of low expression when the number of cells is relatively low. This phenomenon is highly linked to the sparsity of the data and to the model’s degeneracy between very low expression levels. Using a higher number of cells allows to break this degeneracy. Finally, in the case of zeros plus a Gaussian, baredSC approximates the distribution with two Gaussians (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). One of the Gaussians corresponds to the simulated Gaussian. The other is truncated and narrowed close to zero, such that it approximates the sub-population non-expressing cells. However, baredSC tends to predict a lower proportion of expressing cells with a higher mean expression. Again, this phenomenon is linked to the sparsity of the data and to the model’s degeneracy between very low expression and no expression. It disappears when we simulate a higher mean expression for the expressing cells (right column of Fig. <xref rid="Fig2" ref-type="fig">2</xref>D).</p>
      <p id="Par21">Overall, the algorithm performs very well and largely improves the estimation of the intrinsic expression distribution compared to a classical density plot (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Comparison to Sanity</title>
      <p id="Par22">Sanity is a normalization tool aimed at correcting scRNA-seq outputs from sampling noise [<xref ref-type="bibr" rid="CR15">15</xref>]. The Sanity model shares similar features with baredSC, as both tools use a Bayesian approach to correct from the sampling noise, which is assumed in both cases to follow a Poisson law. However, there are two main differences in the baredSC and Sanity approaches (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3 for more details). First, while baredSC uses a GMM (using any transformation of <inline-formula id="IEq80"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _g$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq80.gif"/></alternatives></inline-formula>) to model the intrinsic expression distribution, Sanity uses a single Gaussian model expressed in <inline-formula id="IEq81"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(\lambda _g)$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq81.gif"/></alternatives></inline-formula>. We observe that baredSC’s results are similar to the ones obtained with Sanity if we restrict baredSC to use a single Gaussian in log scale (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). The Sanity model is thus simpler, which allows for the use of faster algorithms. However, it is also less flexible and precise, especially in cases where the expression distribution is multi-modal. Second, Sanity aims at correcting the counts of each cell from the Poisson noise, while baredSC focuses on uncovering the underlying intrinsic expression distribution (PDF) of a gene. Of note, while the estimation of corrected counts is not the goal of baredSC, this information can be easily computed from the inferred PDF (see Methods:<xref rid="Sec23" ref-type="sec"> Posterior per cell</xref>). The expression PDF can be estimated from Sanity’s outputs by either using the single Gaussian used to model the intrinsic expression distribution, or computing a KDE of the corrected counts, or by computing the posterior distribution from these counts and their error bars (see Additional file 1: S3.7 and Fig. S23 of [<xref ref-type="bibr" rid="CR15">15</xref>]). However, the two last methods are less accurate than the PDF infered by baredSC when multiple Gaussians are used and can degrade the resolution of the PDF (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
      <p id="Par23">In order to compare baredSC and Sanity, we generated data using 2361 cells with the same <inline-formula id="IEq82"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq82.gif"/></alternatives></inline-formula> values as for Fig. <xref rid="Fig2" ref-type="fig">2</xref>. We generated <inline-formula id="IEq83"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i,g}$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq83.gif"/></alternatives></inline-formula> values using a single Gaussian, two Gaussians, a single Gaussian in combination with a proportion of cells with no expression, or three Gaussians. In order to more easily compare the results from Sanity and baredSC, the Gaussians were defined in log scale (<inline-formula id="IEq84"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(\lambda _g)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq84.gif"/></alternatives></inline-formula>) and we run baredSC using the same log scale. The results are displayed in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. For the representation of the normalized counts, the expression of cells with no expression was artificially put to the minimal value. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>A where a single Gaussian was simulated, baredSC and the posterior distribution from Sanity overlay with the distribution used to simulate the data. The density from Sanity underestimates the low values and overestimates the mean values. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, we used a bimodal distribution closed to the one used in the Fig. S23 of [<xref ref-type="bibr" rid="CR15">15</xref>]. In this case, the posterior distribution from Sanity shows a bi-modal shape, however, while the second Gaussian’s characteristics are well estimated, the first one has a larger scale than expected. Conversely, baredSC finds the characteristics of both Gaussians. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, where a proportion of cells with no expression was added, baredSC identifies the two sub-populations and gives an inferred PDF very close to the generated one. The posterior distribution from Sanity is composed of a single broad Gaussian missing the bimodality (Gaussian and non-expressing cells). In Fig. <xref rid="Fig3" ref-type="fig">3</xref>D, where two Gaussians were used with averages smaller than -7.5, the posterior distribution from Sanity is close to a single Gaussian while baredSC results is close to the expected PDF. Finally, in the last simulation (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E) where three Gaussians were used, the posterior distribution from Sanity is very close to the line obtained with normalized counts (Density from data) except that it corrects for cases where there was no detection. This is much less accurate that the PDF provided by baredSC. Overall, in these simulations, baredSC better estimates the distribution compared to Sanity when the distribution is produced by more than a single Gaussian. This can be explained by two factors. First, the simplified single-Gaussian model used by Sanity favors unimodal outputs. Second, for each cell, the posterior distribution of Sanity is approximated by a Gaussian, while this distribution is actually the product of the Poisson distribution with the assumed intrinsic distribution. Even for a Gaussian intrinsic distribution, as assumed in the Sanity model, this product might significantly depart from a Gaussian distribution (asymmetry and/or bimodality). Together, these two approximations might explain why the posterior distribution from Sanity is less accurate than baredSC results in multi-modal distributions.<fig id="Fig3"><label>Fig. 3</label><caption><p>baredSC better estimates the PDF compared to Sanity when the distribution is multi-modal. In each simulation, the simulated distribution is plotted in blue and its characteristics are written above (N for normal followed by mean and scale values in log as well as the proportion of cells with no expression). The values obtained after Poisson simulation are summarized by the red curve (Density from data). The mean PDF obtained using baredSC is depicted in green and the green area shows the quantiles at 16–84%. The values obtained using Sanity are summarized by the purple (Density from Sanity) and pink (Posterior distribution from Sanity) curves</p></caption><graphic xlink:href="12859_2021_4507_Fig3_HTML" id="MO20"/></fig></p>
      <p id="Par24">These results demonstrate that while Sanity offers a fast solution to correct scRNA-seq outputs from sampling noise, baredSC provides much more accurate results, at the cost of computing time. Both approaches are complementary and have different scopes. The efficiency of the Sanity algorithm allows to apply it massively on all genes. This is especially useful to correct scRNA-seq from sampling noise before applying a clustering and/or a projection algorithm. Such an application would be very intensive in computer time for baredSC, which is dedicated to more in-depth studies of specific genes.</p>
    </sec>
    <sec id="Sec6">
      <title>Benchmark of baredSC computational needs</title>
      <p id="Par25">As baredSC uses a MCMC algorithm to assess the probability distribution of the parameters of the model, the computational cost of the algorithm is non-negligible. At each step of the MCMC, the cost is driven by the evaluation of the likelihood which is proportional of the number of cells <italic>n</italic> (see more details in Methods: <xref rid="Sec19" ref-type="sec">GMM of the PDF</xref>). By default baredSC runs 100,000 MCMC steps, which requires to evaluate the likelihood 100,000 times. If the MCMC did not converge, we automatically rerun baredSC with 10 times more steps until the convergence is reached (see Methods). In order to get an evaluation of the time and memory needed to run baredSC as function of the number of cell, we simulated some distributions used in Fig. <xref rid="Fig2" ref-type="fig">2</xref> for 1000, 5000, 25,000, 125,000, 625,000, and 3,125,000 cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>baredSC computational needs. For each run of baredSC, the computational time (<bold>A</bold>) and the memory used (<bold>B</bold>) is plotted as function of the number of cells in the input. On top panel are presented the results of run where baredSC has been run with only one value of <italic>m</italic> (number of Gaussians) corresponding to the expected result until convergence. On the bottom panel are presented the results of run where baredSC has been run in parallel for 1, 2, 3 and 4 Gaussians followed by a scripts which combine all 4 intermediate results</p></caption><graphic xlink:href="12859_2021_4507_Fig4_HTML" id="MO21"/></fig></p>
      <p id="Par26">We first ran baredSC using the number of Gaussians (<italic>m</italic>) corresponding to the simulated data, i.e. one Gaussian for the first simulation, two Gaussians for the two next simulations and three Gaussians for the last simulation. We ran baredSC on the high performence computing server of EPFL using either one core or four cores as baredSC uses numpy which can use multiple cores. baredSC was run three times with three different seeds to take into account the variability of the node performance and the MCMC convergence. The results for the computation time is presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>A top panel and the memory is presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>B top panel. Only conditions where the convergence could be achieved in the three different seeds within 30 h are displayed. In all cases except one, the MCMC converged with 100,000 steps (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). We can see that the computation time is indeed linear as function of the number of cells (dotted line) except in the last simulated distribution where the linearity is broken with three million cells due to convergence issues. The use of four cores is interesting as soon as the number of cells is above 25,000. For this number of cells, it takes between 2 and 4 min independently of the complexity of the distribution with one core and around 1 min and 30 s with four cores. BaredSC requires relatively low memory, around 0.3GB for 25,000 cells.</p>
      <p id="Par27">However, in the case of real datasets, the number of Gaussians (<italic>m</italic>) is unknown and is a parameter of the model so we need to run baredSC with any possible number of Gaussians. We decided to use one to four Gaussians which enable to cover a large variety of distributions. Then, a script uses the four intermediate results and importance sampling to give the final result. To optimize the computational run time, we ran baredSC in parallel on one to four Gaussians with four cores per task. This strategy is the one which has been used for all the figures of the paper. While with the first performance tests, the MCMC was nearly always converging at 100,000 steps, when different number of Gaussians are used, the convergence may require 1,000,000 steps or even 10,000,000 steps for a number of Gaussians which does not correspond to the simulated number of Gaussians (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). This strongly impacts the computational time (Fig <xref rid="Fig4" ref-type="fig">4</xref>A bottom panel). On average, the full baredSC with one to four Gaussians requires 28 min for 25,000 cells and 1.5 GB.</p>
      <p id="Par28">These computational times are not compatible with a usage of baredSC for hundreds or thousands of genes. However, it stays reasonable when the PDF needs to be precisely known for few genes in a whole dataset or in specific clusters.</p>
    </sec>
    <sec id="Sec7">
      <title>Estimating the joint distribution of two genes</title>
      <p id="Par29">As shown above, the baredSC approach is able to efficiently recover the expression distribution of a single gene. The same approach can actually be applied to two genes simultaneously to infer the expression distribution in two dimensions (2D). This is of great interest since the study of pairwise correlations between genes can help to better understand gene regulatory networks. Similarly to the case of a single gene, we assume that the distribution can be approximated by a GMM. In the 2D case, each Gaussian in the GMM depends on six parameters: the amplitude, the mean of x and y, the scale of x and y and the correlation. The detailed equations for the 2D application of baredSC can be found in Methods: <xref rid="Sec24" ref-type="sec">baredSC in 2D</xref>. The same Bayesian approach (MCMC and importance sampling) as in the 1D case is used to explore the parameters. In addition to the parameters and the corresponding expression distribution in 2D, one can deduce from the MCMC posteriors a confidence interval for the Pearson correlation between the expression of the two genes, as well as a one-sided <italic>p</italic> value (see Methods:<xref rid="Sec25" ref-type="sec"> Estimation of the p value for the correlation</xref>).</p>
      <p id="Par30">We simulated data to test the accuracy of baredSC in 2D. We used the same number of cells and the same <inline-formula id="IEq85"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq85.gif"/></alternatives></inline-formula> values as in the 1D case. We generated random values for the expression of both genes x and y in each cell (<inline-formula id="IEq86"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i, g1}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq86.gif"/></alternatives></inline-formula> and <inline-formula id="IEq87"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i, g2}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq87.gif"/></alternatives></inline-formula>) using various distributions on the <inline-formula id="IEq88"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1 + 10^4\lambda _g)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq88.gif"/></alternatives></inline-formula> scale described below. Then, we sampled <inline-formula id="IEq89"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i, g1}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq89.gif"/></alternatives></inline-formula> and <inline-formula id="IEq90"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i, g2}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq90.gif"/></alternatives></inline-formula> using Poisson law with parameters <inline-formula id="IEq91"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i, g1}N_i$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq91.gif"/></alternatives></inline-formula> and <inline-formula id="IEq92"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{i, g2}N_i$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq92.gif"/></alternatives></inline-formula> respectively. These simulated counts were analyzed using baredSC with the same log transformation (<inline-formula id="IEq93"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1 + 10^4 \lambda _g)$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq93.gif"/></alternatives></inline-formula>) with one to four Gaussians. The results obtained using all cells are presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, while the results obtained on smaller subgroups are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5. For each generated dataset, we plot in Fig. <xref rid="Fig5" ref-type="fig">5</xref> the distribution used to generate the intrinsic expression values (original distribution), the distribution of normalized simulated raw counts (<inline-formula id="IEq94"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}/N_i$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq94.gif"/></alternatives></inline-formula>, simulated scRNA-seq normalized counts), and the distribution inferred with our approach (baredSC).<fig id="Fig5"><label>Fig. 5</label><caption><p>baredSC allows a good estimation of 2D expression distributions. In each simulation, the PDF of the original distribution is plotted in the top panel. The values obtained after Poisson simulation are plotted in the middle panel. The mean PDF obtained by baredSC is plotted in the bottom. In the top left corner is written the Pearson’s correlation coefficient and for baredSC its confidence interval. For baredSC, an estimation of the one-sided <italic>p</italic> value is displayed. In <bold>A</bold>, distribution is only composed of one truncated normal distribution, in <bold>B</bold>, 2 normal distributions are used, and in <bold>C</bold> each gene is expressed with a Gaussian distribution in half of the cells</p></caption><graphic xlink:href="12859_2021_4507_Fig5_HTML" id="MO22"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>baredSC retrieves the anti-correlation between <italic>Hoxa11</italic> and <italic>Hoxd13</italic> in embryonic distal limb scRNA-seq. Heatmaps showing the PDF of normalized expression of <italic>Hoxa11</italic> and <italic>Hoxd13</italic>. Top panels provide the PDF from input data while bottom panels show the result of baredSC. In the top left corner is written the Pearson’s correlation coefficient and for baredSC its confidence interval. For baredSC, an estimation of the one-sided <italic>p</italic> value is displayed</p></caption><graphic xlink:href="12859_2021_4507_Fig6_HTML" id="MO23"/></fig></p>
      <p id="Par31">We first generated the data using distributions composed of a single truncated 2D Gaussian (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). In the three first columns, the mean of <italic>g</italic>1 and <italic>g</italic>2 and the scale of <italic>g</italic>1 and <italic>g</italic>2 are all equal to 0.25. The correlation is set to 0.5 (weakly correlated), − 0.5 (weakly anti-correlated) and 0 (independent). We can see that the PDF of the normalized data (simulated scRNA-seq normalized counts) is very noisy and a lot of signal goes on the axes (i.e., one or both genes are not detected). The corresponding Pearson’s correlation coefficient (top left of plot) is close to 0 in the three cases while one would expect values around <inline-formula id="IEq95"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm \,0.3$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mo>±</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq95.gif"/></alternatives></inline-formula> for the weakly (anti-)correlated cases, in the absence of sampling noise (generated expression). The mean PDF recovered by baredSC (bottom row) is very similar to the original PDF (top row) in these three cases. The Pearson’s correlation coefficient estimated from the MCMC posteriors (top left of each plot in bottom row) is compatible with the value computed from the original PDF (within confidence interval). Moreover, the estimation of the one-sided <italic>p</italic> value is significant only in cases where the correlation of the original distribution was non-zero, as expected.</p>
      <p id="Par32">In the three last columns of Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, the simulated Gaussians are identical to the first three except that the scale of the gene <italic>g</italic>1 is 0.15 instead of 0.25. Despite the fact that the smaller scale increases the number of drop-out events, baredSC results are still very close to the input PDF.</p>
      <p id="Par33">In Fig. <xref rid="Fig5" ref-type="fig">5</xref>B, we split the cells in two equally sized populations. Each population expresses both genes following a 2D Gaussian without correlation. The means of both 2D Gaussians were chosen in order to introduce a correlation (first column of Fig. <xref rid="Fig5" ref-type="fig">5</xref>B) or an anti-correlation (second column). The correlation or anti-correlation is already perceptible in the PDF of the normalized counts (simulated scRNA-seq normalized counts). However, the presence of two populations is totally hidden by the sampling noise. The results of baredSC (bottom row) highlight the two distinct populations. The correlation coefficient is very well approximated, especially when compared to the one evaluated on the raw data.</p>
      <p id="Par34">Finally, we generated three different distributions where each of the two genes is expressed in only half of the cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). In the first column (each gene expressed in half independent), the cells which do not express the gene <italic>g</italic>1 or the gene <italic>g</italic>2 were chosen independently. In the second column, the two genes are partially anti-correlated. Both genes are expressed in 10% of the cells, neither is expressed in 10%, and gene <italic>g</italic>1 (resp. <italic>g</italic>2) is expressed while gene <italic>g</italic>2 (resp. <italic>g</italic>1) is not in 40%. In the third column, each cell is expressing either <italic>g</italic>1 or <italic>g</italic>2 (each gene expressed in half fully anti-correlated). The estimated correlation coefficients are compatible with the ones obtained on the simulated PDF (generated expression). The shape of the PDF also resembles what was expected. We can however notice that, similarly to what was observed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d for the 1D case, the means of the expressed populations of cells are slightly over estimated. Once again, this can be explained by the sparsity of the data and by the model’s degeneracy.</p>
      <p id="Par35">While it is visually very difficult to interpret the 2D PDF of normalized counts (simulated scRNA-seq normalized counts) for lowly expressed genes, baredSC provides a good approximation of the shape of the original PDF. Similarly to what has been observed in one dimension, when baredSC is compared to Sanity, we observe that except in the single Gaussian without any correlation, baredSC outperform Sanity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6).</p>
    </sec>
    <sec id="Sec8">
      <title>Applications to real datasets</title>
      <p id="Par36">In order to illustrate the power of baredSC and its potential use, we apply it to two datasets.</p>
      <sec id="Sec9">
        <title><italic>Hoxd13</italic>-<italic>Hoxa11</italic> anti-correlation in embryonic distal limb</title>
        <p id="Par37">HoxA and HoxD genes are key transcription factors involved in limb patterning [<xref ref-type="bibr" rid="CR23">23</xref>]. Their expression domain is tightly regulated in space and time. When the limb grows, <italic>Hoxa11</italic> expression has been described as restricted to the proximal domain which will become the arm while <italic>Hoxd13</italic> is expressed in the distal domain which will become the digits. [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>] showed that <italic>Hoxd13</italic> represses the transcription of <italic>Hoxa11</italic> in the embryonic distal limb leading to two distinct domains of expression. We use the scRNA-seq from [<xref ref-type="bibr" rid="CR27">27</xref>] which has been generated from embryonic forelimbs. A clustering analysis revealed 17 clusters. Using <italic>Hoxd13</italic> as a marker, 4 clusters (3, 4, 5, 9) were attributed to the distal part of the limb (see [<xref ref-type="bibr" rid="CR27">27</xref>]). Unexpectedly, <italic>Hoxa11</italic> was not totally absent from these clusters. We run baredSC on each of these 4 clusters allowing one to four Gaussians for <italic>Hoxd13</italic> and <italic>Hoxa11</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). In all four clusters, we clearly see a depletion of cells with simultaneous high expression of both genes. As a consequence, the correlation coefficient is significantly negative in all four clusters. These results are thus in agreement with the literature.</p>
      </sec>
      <sec id="Sec10">
        <title>Multi-modal expression of <italic>Pitx1</italic> in embryonic hindlimb</title>
        <p id="Par38">The gene <italic>Pitx1</italic> encodes for a transcription factor expressed in the embryonic hindlimb. It is responsible for the leg patterning. This gene is not expressed in the forelimb and a gain of expression in this domain induces an arm-to-leg phenotype [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Its expression is controlled by many enhancers, one of them is <italic>Pen</italic> which accounts for 30–50% of the expression [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. Rouco et al. [<xref ref-type="bibr" rid="CR30">30</xref>] used scRNA-seq and flow cytometry to investigate whether <italic>Pitx1</italic> was homogeneously expressed across hindlimb cells. They also studied the changes induced by the deletion of the <italic>Pen</italic> enhancer. While scRNA-seq directly measures the level of expression of <italic>Pitx1</italic>, the flow cytometry data measures the level of fluorescence thanks to a GFP-sensor introduced in close proximity to the <italic>Pitx1</italic> promoter. The measure of fluorescence of each cell by flow cytometry should be highly correlated to the level of mRNA of <italic>Pitx1</italic>. However, the exact relationship between the mRNA level and the fluorescence is not known.</p>
        <p id="Par39">In this study, there are three conditions, the forelimb (FL) wild-type (<italic>Pitx1</italic><inline-formula id="IEq96"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{+/+}}}$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mrow/><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq96.gif"/></alternatives></inline-formula>) which has no expression of <italic>Pitx1</italic>, the hindlimb (HL) wild-type which is considered as a tissue expressing <italic>Pitx1</italic> and the HL mutant where the <italic>Pen</italic> enhancer has been deleted (<italic>Pitx1</italic><inline-formula id="IEq97"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{Pen-/Pen-}}}$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">Pen</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="italic">Pen</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq97.gif"/></alternatives></inline-formula>). Both flow cytometry and scRNA-seq data experiments were produced for these 3 samples. We propose a reanalysis of these data. The flow cytometry data are usually represented in log scale (Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). It shows the presence of high level of background in absence of expression. Indeed, in the FL <italic>Pitx1</italic><inline-formula id="IEq98"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{+/+}}}$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mrow/><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq98.gif"/></alternatives></inline-formula> sample in black, the fluorescence level has a relatively wide scale. Rouco et al. [<xref ref-type="bibr" rid="CR30">30</xref>] show that the expression of <italic>Pitx1</italic> in the HL wild-type (red curve) is trimodal (Figs. 7A and 3A of [<xref ref-type="bibr" rid="CR30">30</xref>]). The first mode is included in the range of the FL <italic>Pitx1</italic><inline-formula id="IEq99"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{+/+}}}$$\end{document}</tex-math><mml:math id="M232"><mml:msup><mml:mrow/><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq99.gif"/></alternatives></inline-formula> so it corresponds to cells which do not express <italic>Pitx1</italic>. Expressing cells can be divided into highly-expressing cells and lowly-expressing cells. The sample HL <italic>Pitx1</italic><inline-formula id="IEq100"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{Pen-/Pen-}}}$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">Pen</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="italic">Pen</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq100.gif"/></alternatives></inline-formula> (blue curve) also exhibits a trimodal distribution but the average expression in low expressing and high expressing cells is decreased compared to the wild-type condition and there is an increased proportion of non expressing cells. These data are consistent with the expected decrease of expression by 30-50%. In order to compare more easily the flow cytometry data with the scRNA-seq expressed in <inline-formula id="IEq101"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log (1 + 10^4 X_i)$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq101.gif"/></alternatives></inline-formula>, we transformed the fluorescence in <inline-formula id="IEq102"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log (1 + 0.01 F_i)$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>0.01</mml:mn><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq102.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B). This transformation still highlights the trimodal expression of the HL <italic>Pitx1</italic><inline-formula id="IEq103"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{+/+}}}$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mrow/><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq103.gif"/></alternatives></inline-formula>. When the scRNA-seq results are displayed as density plots (Fig. 7C or Fig. 4A of [<xref ref-type="bibr" rid="CR30">30</xref>]), one cannot distinguish the three modes in the HL <italic>Pitx1</italic><inline-formula id="IEq104"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm {\textit{+/+}}}$$\end{document}</tex-math><mml:math id="M242"><mml:msup><mml:mrow/><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq104.gif"/></alternatives></inline-formula>. However, classical density plots are very sensitive to sampling noise, and do not allow a precise determination of the expression distribution. Applying baredSC on this dataset enables to a better characterization of the shape of the expression distribution (Fig. <xref rid="Fig7" ref-type="fig">7</xref>D). The three modes are uncovered: a first one with non-expressing cells approximated by a truncated Gaussian along the y axis, a second one with a mean value around 1, and a third one with a mean value around 2. Because of the background in flow cytometry and the degeneracy of scRNA-seq at very low expression, the comparison of the PDFs from flow cytometry (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B) and scRNA-seq (Fig. <xref rid="Fig7" ref-type="fig">7</xref>D) on the left part of the plots is difficult. However, at higher expression levels (right part), the PDF are very similar. We also run baredSC in regular log scale (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7) and confirm this high similarity with the flow cytometry PDF. These results show that the trimodal expression identified by flow cytometry is indeed present in the scRNA-seq. It also demonstrates how baredSC can improve our description of expression variability within a scRNA-seq from a complex tissue.<fig id="Fig7"><label>Fig. 7</label><caption><p>baredSC retrieves the trimodal expression of <italic>Pitx1</italic> in embryonic limb scRNA-seq. <bold>A</bold> Distribution of fluorescence intensity obtained by flow cytometry in regular log scale. <bold>B</bold> Distribution of fluorescence intensity on log scale with pseudo count to be closer to the Seurat scale. <bold>C</bold> Distribution of normalized expression from scRNA-seq as provided by the Seurat package. <bold>D</bold> Distribution of normalized expression from scRNA-seq as provided by baredSC</p></caption><graphic xlink:href="12859_2021_4507_Fig7_HTML" id="MO24"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion</title>
    <sec id="Sec12">
      <title>Poisson distribution is sufficient to model droplet-based scRNA-seq</title>
      <p id="Par40">In this study, we show that most of the technical variability is well approximated by the Poisson distribution. While other papers have justified the use of the Poisson distribution only on a theoretical ground [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR31">31</xref>], we base our conclusions on the analysis of control scRNA-seq. We compare estimators of the mean and variance of the scaled expression of each gene in each control dataset, and show that for most genes the two estimators (mean and normalized variance) are close to each other, which is a characteristic of the Poisson distribution. Using the same datasets but with non-scaled data, [<xref ref-type="bibr" rid="CR2">2</xref>] concluded that the negative binomial, which models an additional variability compared to Poisson, was the best fitting law. However, we show that this excess of variance is simply due to the variability in the total number of reads per cell, and confirm that the Poisson law is well suited to model droplet-based scRNA-seq. Our conclusions are in line with recently published reanalyses of these control datasets [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>].</p>
      <p id="Par41">We note that our demonstration is limited to droplet-based scRNA-seq as we only found control datasets available for these techniques. Similar control datasets for other scRNA-seq techniques would be very valuable to assess their technical variability and build well justified mathematical models.</p>
    </sec>
    <sec id="Sec13">
      <title>baredSC performances</title>
      <p id="Par42">The distribution of expression of a gene from scRNA-seq data is often represented using density/violin plots. This representation mixes biological variation and variation coming from the technique (mainly sampling). baredSC is designed to disentangle these two effects, and retrieve the biological distribution of expression. Using simulated data we show that baredSC indeed outperforms classical representations. It allows to retrieve precisely multi-modal expression distribution even when they are not distinguishable in the input data due to sampling noise. In these cases, baredSC results are also more accurate than the posterior distribution from Sanity, another recently published tool which aims at denoising scRNA-seq data. The 2D version of baredSC also allows a better evaluation of the correlation between genes than classical methods and Sanity, and provides an accurate PDF even for lowly expressed genes.</p>
      <p id="Par43">However, we observed some conditions where the inferred distribution deviates from the generated distribution. First, while we have demonstrated the versatility of the GMM to approximate different types of distributions (e.g. uniform distribution), the fit cannot be perfect for distributions that are not Gaussian mixtures. We note that the baredSC approach could easily be adapted to use another family of distributions, but the GMM seems a reasonable approximation for real applications. Second, when the population of cells is split into a group that does not express the considered gene and a group that expresses it at low level, the inferred distribution tends to overestimate the non-expressing group and overestimate the mean expression level in the expressing group. This phenomenon is highly linked with the degeneracy of the model. In 2D, as the model is more complex, the number of cells can be a limitation to accurately estimate the PDF when the expression level is low.</p>
      <p id="Par44">As baredSC uses a MCMC algorithm to infer the model parameters, the computational cost of the algorithm is non-negligible. It takes typically 10 min with four times four cores to run one to four Gaussians, for each gene of the examples of Fig. <xref rid="Fig2" ref-type="fig">2</xref> using all 2361 cells. A quicker alternative would be the frequentist approach which maximizes the likelihood. In this particular case, this method is error prone as there is a risk of overfit and a risk to find parameters which corresponds to a local maximum of likelihood which does not represent the global maximum. Indeed, the high degeneracy of the problem is a big challenge with this approach. In addition, the evaluation of error bars is much more difficult with a frequentist approach than with a MCMC approach. This is why we use a MCMC algorithm to get a confidence interval on the inferred PDF.</p>
    </sec>
    <sec id="Sec14">
      <title>baredSC applications</title>
      <p id="Par45">In the single gene use case, baredSC could replace the widely used violin plots to describe the expression of few genes of high interest across different conditions or clusters. Indeed, baredSC allows to retrieve very precisely the expression distribution of genes, even in multi-modal cases and with strong sampling noise. This accuracy comes at the cost of computation time. Moreover, baredSC requires some manual checks, such as the convergence of the MCMC, and the fact that the range of considered expression levels were correctly chosen. For these reasons, this tool is more appropriate to in-depth analysis of specific genes than large-scale applications. As shown in the examples, it can be used both on a whole single-cell dataset or on cells belonging to specific clusters. Potential applications for a single gene are modality description or estimation of proportion of cells expressing a given gene, as well as comparisons between samples or clusters.</p>
      <p id="Par46">We apply it to a real biological scRNA-seq dataset to study the modality of the expression of <italic>Pitx1</italic>. We demonstrate that the fluorescence measurement of the GFP sensor, integrated in close proximity of <italic>Pitx1</italic> promoter, is highly correlated with the mRNA level of the gene. The inference of PDF in 2D is of great interest for the study of genes’ interactions or its comparison between clusters of cells. We apply it to confirm the anti-correlation between <italic>Hoxa11</italic> and <italic>Hoxd13</italic> in the developing limb.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par47">scRNA-seq data usually present a high level of sparsity. The use of normalized counts to describe variability among a cell population mixes intrinsic variability and variability coming from the sampling noise. baredSC allows to retrieve the intrinsic variability providing the inferred expression distribution either for a single gene or for two genes simultaneously. As such, baredSC represents a valuable tool to perform in-depth analysis on few genes of interest.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p id="Par48">
      <def-list>
        <def-item>
          <term>Project name:</term>
          <def>
            <p id="Par49">baredSC</p>
          </def>
        </def-item>
        <def-item>
          <term>Project home page:</term>
          <def>
            <p id="Par50">
              <ext-link ext-link-type="uri" xlink:href="https://github.com/lldelisle/baredSC">https://github.com/lldelisle/baredSC</ext-link>
            </p>
          </def>
        </def-item>
        <def-item>
          <term>Operating system(s):</term>
          <def>
            <p id="Par51">Linux and MacOS (both as python package and standalone scripts), Windows (only as python package)</p>
          </def>
        </def-item>
        <def-item>
          <term>Programming language:</term>
          <def>
            <p id="Par52">python</p>
          </def>
        </def-item>
        <def-item>
          <term>Other requirements:</term>
          <def>
            <p id="Par53">python <inline-formula id="IEq105"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M244"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq105.gif"/></alternatives></inline-formula> 3.7, numpy, matplotlib, pandas, scipy, samsam</p>
          </def>
        </def-item>
        <def-item>
          <term>License:</term>
          <def>
            <p id="Par54">GNU General Public License v3.0</p>
          </def>
        </def-item>
      </def-list>
    </p>
  </sec>
  <sec id="Sec17">
    <title>Methods</title>
    <sec id="Sec18">
      <title>Comparison between the Negative Binomial and the Poisson distribution</title>
      <p id="Par55">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the coefficient of the Negative Binomial was fitted using the nls (Nonlinear Least Squares) function of R on the formula: <inline-formula id="IEq106"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log({\tilde{V}}_g) \sim log(M_g + a M_g^2)$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq106.gif"/></alternatives></inline-formula> starting with <inline-formula id="IEq107"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=0$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq107.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec19">
      <title>GMM of the PDF</title>
      <p id="Par56">In the scRNA-seq field, the most popular analysis packages (Seurat and Scanpy) uses a log transformation of the normalized counts to be able to see both highly expressing cells and lowly expressing cells. To handle the numerous cases where the gene was not detected, they use a transformation of type <inline-formula id="IEq108"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1 + N_{t} X_{i,g})$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq108.gif"/></alternatives></inline-formula> where <inline-formula id="IEq109"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{t}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq109.gif"/></alternatives></inline-formula> is the targeted number of counts used to normalize <inline-formula id="IEq110"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,g}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq110.gif"/></alternatives></inline-formula> values. In the Seurat package <inline-formula id="IEq111"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{t}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq111.gif"/></alternatives></inline-formula> is fixed to <inline-formula id="IEq112"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^4$$\end{document}</tex-math><mml:math id="M258"><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq112.gif"/></alternatives></inline-formula> while in Scanpy it is set by default to the median of <inline-formula id="IEq113"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq113.gif"/></alternatives></inline-formula> or it can be user defined. However, the pseudo-count in log may introduce a distortion and users may prefer to work in regular log scale. In baredSC, both scales have been implemented, and the PDF is modeled by a fixed number of Gaussians in the chosen scale. We define<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_g = \log (1 + N_t\lambda _{g}), \end{aligned}$$\end{document}</tex-math><mml:math id="M262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>in the case of the Seurat/Scanpy scale or<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_g = \log (\lambda _{g}), \end{aligned}$$\end{document}</tex-math><mml:math id="M264" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>in the regular log scale case. We denote by <italic>l</italic> the mapping between <italic>x</italic> and <inline-formula id="IEq114"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M266"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq114.gif"/></alternatives></inline-formula>: <inline-formula id="IEq115"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = l(\lambda )$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq115.gif"/></alternatives></inline-formula> and <inline-formula id="IEq116"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = l^{-1}(x)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq116.gif"/></alternatives></inline-formula>. In practice, we work on a finite interval <inline-formula id="IEq117"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\lambda _\mathrm {min},\lambda _\mathrm {max}]$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq117.gif"/></alternatives></inline-formula> of expression levels, corresponding to <inline-formula id="IEq118"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[x_\mathrm {min},x_\mathrm {max}]$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq118.gif"/></alternatives></inline-formula> for the transformed expression <italic>x</italic>, and model the PDF using a mixture of truncated Gaussians.</p>
      <p id="Par57">The likelihood is:<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}(\theta )&amp;= \prod _{i=1}^n p(k_{i,g}|N_i,\theta ) \end{aligned}$$\end{document}</tex-math><mml:math id="M276" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{\mathcal {L}}(\theta )&amp;= \prod _{i=1}^n \int _{\lambda _\mathrm {min}}^{\lambda _\mathrm {max}} {\mathcal {P}}(k_{i,g}| N_i\lambda ) {\mathcal {G}}(\lambda | \theta ) \mathrm {d}\lambda \nonumber \\&amp;= \prod _{i=1}^n \int _{x_\mathrm {min}}^{x_\mathrm {max}} {\mathcal {P}}(k_{i,g}| N_i l^{-1}(x)) G(x | \theta ) \mathrm {d}x , \end{aligned}$$\end{document}</tex-math><mml:math id="M278" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq119"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta = (m,A,\mu ,\sigma )$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq119.gif"/></alternatives></inline-formula> is the set of model parameters, and<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x | \theta )&amp;= \sum _{j=1}^m a_{j} \exp \left( -\frac{(x-\mu _j) ^2}{2\sigma _j^2}\right) ,\nonumber \\ a_j&amp;= A_j \left( \int _{x_\mathrm {min}}^{x_\mathrm {max}} \exp \left( -\frac{(x-\mu _j) ^2}{2\sigma _j^2}\right) \mathrm {d}x\right) ^{-1},\nonumber \\ {\mathcal {G}}(\lambda | \theta )&amp;= G(l(\lambda ) | \theta ) l'(\lambda ). \end{aligned}$$\end{document}</tex-math><mml:math id="M282" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec20">
      <title>Estimation of likelihood</title>
      <p id="Par58">Unfortunately, the integral in Eq. (<xref rid="Equ21" ref-type="">21</xref>) cannot be computed analytically, and we thus evaluate it numerically using a Riemann sum<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_i(\theta )&amp;= \int _{x_\mathrm {min}}^{x_\mathrm {max}} {\mathcal {P}}(k_{i,g}| N_i l^{-1}(x)) G(x | \theta ) \mathrm {d}x\nonumber \\&amp;\approx \sum _{q=1}^{n_x} {\mathcal {P}}(k_{i,g}| N_i l^{-1}(x_q)) G(x_q | \theta ) \delta x, \end{aligned}$$\end{document}</tex-math><mml:math id="M284" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:munderover><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq120"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_q$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq120.gif"/></alternatives></inline-formula> are the centers of the <inline-formula id="IEq121"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_x$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq121.gif"/></alternatives></inline-formula> equally sized bins, and <inline-formula id="IEq122"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta x = (x_\mathrm {max}-x_\mathrm {min})/n_x$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq122.gif"/></alternatives></inline-formula> is the width of each bin. In this integral, the Poisson part (<inline-formula id="IEq123"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}(k_{i,g}| N_i l^{-1}(x))$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq123.gif"/></alternatives></inline-formula>) does not depend on the model parameters. It can thus be pre-computed on a given grid of <italic>x</italic> values for each cell, and stored in a <inline-formula id="IEq124"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times n_x$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq124.gif"/></alternatives></inline-formula> matrix <italic>P</italic>. On the contrary, the GMM part (<inline-formula id="IEq125"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(x | \theta )$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq125.gif"/></alternatives></inline-formula>) depends on the model parameters but is the same for all cells. Therefore, for a given set of parameters, it must be computed on the grid of <italic>x</italic> only once for all cells, and stored in a vector <inline-formula id="IEq126"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma (\theta )$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq126.gif"/></alternatives></inline-formula> of size <inline-formula id="IEq127"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_x$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq127.gif"/></alternatives></inline-formula>. We thus obtain the vector <italic>L</italic> as the dot product<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L(\theta ) \approx P \gamma (\theta ). \end{aligned}$$\end{document}</tex-math><mml:math id="M302" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mi>P</mml:mi><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>Then the likelihood is simply given by<disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}(\theta ) = \prod _{i=1}^n L_i(\theta ). \end{aligned}$$\end{document}</tex-math><mml:math id="M304" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>The computational cost of this method is dominated by the dot product of Eq. (<xref rid="Equ24" ref-type="">24</xref>). Indeed, the matrix <italic>P</italic> can be pre-computed so its cost is negligible, the cost of computing the vector <inline-formula id="IEq128"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M306"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq128.gif"/></alternatives></inline-formula> scales as <inline-formula id="IEq129"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}\left( n_x\right)$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq129.gif"/></alternatives></inline-formula>, while the cost of the dot product scales as <inline-formula id="IEq130"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}\left( n n_x\right)$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq130.gif"/></alternatives></inline-formula>. Therefore, a trade-off between resolution and cost must be found to choose the number of bins <inline-formula id="IEq131"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_x$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq131.gif"/></alternatives></inline-formula>.</p>
      <p id="Par59">However, since the cost of computing <italic>P</italic> and <inline-formula id="IEq132"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M314"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq132.gif"/></alternatives></inline-formula> is much lower than the cost of the dot product, <italic>P</italic> and <inline-formula id="IEq133"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M316"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq133.gif"/></alternatives></inline-formula> can actually be computed on a finer grid to improve precision. We thus subdivide each of the <inline-formula id="IEq134"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_x$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq134.gif"/></alternatives></inline-formula> original bins into <inline-formula id="IEq135"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_s$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq135.gif"/></alternatives></inline-formula> sub-bins and compute the average value of <inline-formula id="IEq136"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}$$\end{document}</tex-math><mml:math id="M322"><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq136.gif"/></alternatives></inline-formula> over these sub-bins. Similarly, each of the <inline-formula id="IEq137"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_x$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq137.gif"/></alternatives></inline-formula> original bins were divided into <inline-formula id="IEq138"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_r$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq138.gif"/></alternatives></inline-formula> sub-bins and compute the average value of <italic>G</italic> over these sub-bins.<disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P_{i,q}&amp;= \frac{1}{n_s}\sum _{s=1}^{n_s} {\mathcal {P}}(k_{i,g}| N_i l^{-1}(x_{q,s})),\nonumber \\ \gamma _{q}(\theta )&amp;= \frac{1}{n_r}\sum _{r=1}^{n_r} G(x_{q,r}|\theta ). \end{aligned}$$\end{document}</tex-math><mml:math id="M328" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:munderover><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:munderover><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec21">
      <title>Priors on parameters</title>
      <p id="Par60">We chose the priors on the GMM parameters as follows<list list-type="bullet"><list-item><p id="Par61">Number of Gaussians <italic>m</italic>: uniform distribution over <inline-formula id="IEq139"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\![1, m_\mathrm {max}]\!]$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mspace width="-0.166667em"/><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mspace width="-0.166667em"/><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq139.gif"/></alternatives></inline-formula> (with <inline-formula id="IEq140"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_\mathrm {max}=4$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq140.gif"/></alternatives></inline-formula> in this article);</p></list-item><list-item><p id="Par62">Amplitudes <inline-formula id="IEq141"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_j$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq141.gif"/></alternatives></inline-formula>: uniform distribution over [0, 1], with the additional condition <inline-formula id="IEq142"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{j=1}^m A_j = 1$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq142.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par63">Means <inline-formula id="IEq143"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _j$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq143.gif"/></alternatives></inline-formula>: uniform distribution over <inline-formula id="IEq144"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[x_\mathrm {min}-3\sigma _j, x_\mathrm {max} + 3\sigma _j]$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq144.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par64">Scales <inline-formula id="IEq145"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _j$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq145.gif"/></alternatives></inline-formula>: log-uniform distribution over <inline-formula id="IEq146"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\sigma _\mathrm {min}, x_\mathrm {max}-x_\mathrm {min}]$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq146.gif"/></alternatives></inline-formula> (with <inline-formula id="IEq147"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _\mathrm {min}=0.1$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq147.gif"/></alternatives></inline-formula> in this article).</p></list-item></list>This model is symmetric in the sense that two Gaussians can be arbitrarily swapped without changing the results. This degeneracy can deteriorate the convergence of the MCMC algorithm. We thus prevent any swapping to ensure the uniqueness of the solution.</p>
    </sec>
    <sec id="Sec22">
      <title>MCMC algorithm</title>
      <p id="Par65">We use the samsam python package (<ext-link ext-link-type="uri" xlink:href="https://gitlab.unige.ch/Jean-Baptiste.Delisle/samsam">https://gitlab.unige.ch/Jean-Baptiste.Delisle/samsam</ext-link>) which is a scaled adaptive Metropolis algorithm [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. We first apply a burning phase with simulated annealing in order to prevent the MCMC from being trapped in local minima. After this burning phase, the proper MCMC is run to sample the posterior distribution. The convergence can be evaluated using the auto-correlation function of the parameters. One can extract from this measure, the effective number of samples.</p>
    </sec>
    <sec id="Sec23">
      <title>Posterior per cell</title>
      <p id="Par66">Once the MCMC has converged, we evaluate the PDF <inline-formula id="IEq148"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^*(x)$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq148.gif"/></alternatives></inline-formula> as the average of all PDF obtained at each sample of the MCMC. This PDF can be used to retrieve the posterior distribution of expression for each cell:<disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p(x|k_i,N_i) = \frac{{\mathcal {P}}(k_{i,g}| N_i l^{-1}(x)) G^*(x)}{\int _{x_\mathrm {min}}^{x_\mathrm {max}} {\mathcal {P}}(k_{i,g}| N_i l^{-1}(x)) G^*(x) dx} \end{aligned}$$\end{document}</tex-math><mml:math id="M350" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>Using this we can get the expected value of <inline-formula id="IEq149"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq149.gif"/></alternatives></inline-formula>:<disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(x_i) = \int _{x_\mathrm {min}}^{x_\mathrm {max}} p(x|k_i,N_i) x \mathrm {d}x \end{aligned}$$\end{document}</tex-math><mml:math id="M354" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula>That we can evaluate numerically using a Riemann sum. Similarly we can get the variance:<disp-formula id="Equ29"><label>29</label><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{var}\,}}(x_i)&amp;= {{\,\mathrm{{\mathbb {E}}}\,}}(x_i^2) - ({{\,\mathrm{{\mathbb {E}}}\,}}(x_i))^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M356" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ30"><label>30</label><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{var}\,}}(x_i)&amp;= \int _{x_\mathrm {min}}^{x_\mathrm {max}} p(x|k_i,N_i) x^2 \mathrm {d}x - \left( \int _{x_\mathrm {min}}^{x_\mathrm {max}} p(x|k_i,N_i) x \mathrm {d}x\right) ^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M358" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub></mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec24">
      <title>baredSC in 2D</title>
      <p id="Par67">The extension of baredSC to the 2D case is very similar to the 1D case. We use either the “Seurat” scale (Eq. (<xref rid="Equ18" ref-type="">18</xref>)) or the regular log scale (Eq. (<xref rid="Equ19" ref-type="">19</xref>)) and define <inline-formula id="IEq150"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1 = l(\lambda _{g_1})$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq150.gif"/></alternatives></inline-formula>, <inline-formula id="IEq151"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2 = l(\lambda _{g_2})$$\end{document}</tex-math><mml:math id="M362"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq151.gif"/></alternatives></inline-formula> for two genes <inline-formula id="IEq152"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_1$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_2$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq153.gif"/></alternatives></inline-formula>, where <italic>l</italic> is the chosen scale mapping. Each Gaussian of the GMM is defined by 6 parameters: the amplitude (<inline-formula id="IEq154"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_j$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq154.gif"/></alternatives></inline-formula>), the means of <inline-formula id="IEq155"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq156.gif"/></alternatives></inline-formula> (<inline-formula id="IEq157"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{1,j}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq157.gif"/></alternatives></inline-formula> and <inline-formula id="IEq158"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{2,j}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq158.gif"/></alternatives></inline-formula>), their scales (<inline-formula id="IEq159"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{1,j}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq159.gif"/></alternatives></inline-formula> and <inline-formula id="IEq160"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{2,j}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq160.gif"/></alternatives></inline-formula>), and the correlation (<inline-formula id="IEq161"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _j$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq161.gif"/></alternatives></inline-formula>). The likelihood is written as<disp-formula id="Equ31"><label>31</label><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}(\Theta )&amp;= \prod _{i=1}^n p(k_{i,g}|N_i,\Theta )\nonumber \\&amp;= \prod _{i=1}^n \int _{x_{2,\mathrm {min}}}^{x_{2,\mathrm {max}}} \int _{x_{1,\mathrm {min}}}^{x_{1,\mathrm {max}}} {\mathcal {P}}(k_{i,g_1}| N_i l^{-1}(x_1)) {\mathcal {P}}(k_{i,g_2}| N_i l^{-1}(x_2)) G(x|\Theta ) \mathrm {d}x , \end{aligned}$$\end{document}</tex-math><mml:math id="M384" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>l</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq162"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta = (m,A,\mu _1,\mu _2,\sigma _1,\sigma _2,\rho )$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq162.gif"/></alternatives></inline-formula> is the set of model parameters, and<disp-formula id="Equ32"><label>32</label><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(x | \Theta )&amp;= \sum _{j=1}^m a_{j}\exp \left( -\frac{1}{2} (x-\mu _{.,j})^\mathrm {T} C_j^{-1} (x-\mu _{.,j})\right) ,\nonumber \\ a_j&amp;= A_j \left( \int _{x_{2,\mathrm {min}}}^{x_{2,\mathrm {max}}} \int _{x_{1,\mathrm {min}}}^{x_{1,\mathrm {max}}} \exp \left( -\frac{1}{2} (x-\mu _{.,j})^\mathrm {T} C_j^{-1} (x-\mu _{.,j})\right) \mathrm {d}x\right) ^{-1}, \end{aligned}$$\end{document}</tex-math><mml:math id="M388" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:msubsup><mml:mi>C</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:msubsup><mml:mi>C</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equ33"><label>33</label><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_j = \begin{pmatrix} \sigma _{1,j}^2 &amp; \sigma _{1,j} \sigma _{2,j} \rho _j\\ \sigma _{1,j} \sigma _{2,j} \rho _j &amp; \sigma _{2,j}^2\\ \end{pmatrix}. \end{aligned}$$\end{document}</tex-math><mml:math id="M390" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ33.gif" position="anchor"/></alternatives></disp-formula>The double integral in Eq. (<xref rid="Equ31" ref-type="">31</xref>) is computed numerically in a very similar manner as in the 1D case, but this time by defining bins on a 2D grid. The priors are the same as in the 1D case, and we take a prior for the correlation <inline-formula id="IEq163"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _j$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq163.gif"/></alternatives></inline-formula> with a normal distribution of mean 0 and scale 0.3 truncated over <inline-formula id="IEq164"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[-0.95,0.95]$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mn>0.95</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq164.gif"/></alternatives></inline-formula> in order to limit the false positive (anti-)correlation detection.</p>
    </sec>
    <sec id="Sec25">
      <title>Estimation of the <italic>p</italic> value for the correlation</title>
      <p id="Par68">If the correlation between the expression of two genes is suspected to be of a given sign <italic>s</italic>, we define the one-sided <italic>p</italic> value <inline-formula id="IEq165"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M396"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq165.gif"/></alternatives></inline-formula> as the probability for the correlation to actually be of the opposite sign <inline-formula id="IEq166"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-s$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq166.gif"/></alternatives></inline-formula>. To estimate this <italic>p</italic> value, we first compute the Pearson’s correlation coefficient from the 2D PDF for each sample of the MCMC. We thus obtain samples from the posterior distribution of the correlation coefficient. Let’s denote by <italic>k</italic> the number of independent samples for which the correlation is of sign <inline-formula id="IEq167"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-s$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq167.gif"/></alternatives></inline-formula> and <italic>n</italic> the total number of independent samples. We have (Bayes formula)<disp-formula id="Equ34"><label>34</label><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p(\alpha |k) = \frac{p(k|\alpha )p(\alpha )}{p(k)}, \end{aligned}$$\end{document}</tex-math><mml:math id="M402" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ34.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq168"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(k|\alpha )$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq168.gif"/></alternatives></inline-formula> can be approximated by a Poisson distribution of parameter <inline-formula id="IEq169"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\alpha$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq169.gif"/></alternatives></inline-formula> (in the limit of low <inline-formula id="IEq170"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M408"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq170.gif"/></alternatives></inline-formula> and high <italic>n</italic>)<disp-formula id="Equ35"><label>35</label><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p(k|\alpha ) = \frac{(n\alpha )^k}{k!}e^{-n\alpha }. \end{aligned}$$\end{document}</tex-math><mml:math id="M410" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ35.gif" position="anchor"/></alternatives></disp-formula>We additionally assume a uniform prior for <inline-formula id="IEq171"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M412"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq171.gif"/></alternatives></inline-formula>. The conditional expectation of <inline-formula id="IEq172"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M414"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq172.gif"/></alternatives></inline-formula> knowing <italic>k</italic> is thus<disp-formula id="Equ36"><label>36</label><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(\alpha |k) = \int _0^1 \alpha p(\alpha |k) \mathrm {d}\alpha = \frac{k+1}{n}\frac{I_{k+1}}{I_k}, \end{aligned}$$\end{document}</tex-math><mml:math id="M416" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mi>α</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ36.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equ37"><label>37</label><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_k = \int _0^1 \frac{(n\alpha )^k e^{-n\alpha }}{k!} \mathrm {d}\alpha = \frac{1}{n}\left( 1-e^{-n}\sum _{j=0}^{k}\frac{n^j}{j!}\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M418" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mfrac><mml:msup><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mrow><mml:mi>j</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ37.gif" position="anchor"/></alternatives></disp-formula>For <italic>n</italic> sufficiently large, we have<disp-formula id="Equ38"><label>38</label><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_k \approx \frac{1}{n}, \end{aligned}$$\end{document}</tex-math><mml:math id="M420" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ38.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ39"><label>39</label><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\,\mathrm{{\mathbb {E}}}\,}}(\alpha |k) \approx \frac{k+1}{n}. \end{aligned}$$\end{document}</tex-math><mml:math id="M422" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4507_Article_Equ39.gif" position="anchor"/></alternatives></disp-formula>Similarly one can show that the variance is <inline-formula id="IEq173"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\mathrm{var}\,}}(\alpha |k)\approx \frac{k+1}{n^2}$$\end{document}</tex-math><mml:math id="M424"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq173.gif"/></alternatives></inline-formula>. The <italic>p</italic> value provided on Figs. <xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref> of the article and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S4 and S5 is the 1-<inline-formula id="IEq174"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M426"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq174.gif"/></alternatives></inline-formula> upper limit <inline-formula id="IEq175"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &lt; {{\,\mathrm{{\mathbb {E}}}\,}}(\alpha |k) + \sqrt{{{\,\mathrm{var}\,}}(\alpha |k)} = \frac{k+1+\sqrt{k+1}}{n}$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">var</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq175.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec26">
      <title>Simulation of data</title>
      <p id="Par69">In order to get realistic values for <inline-formula id="IEq176"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M430"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq176.gif"/></alternatives></inline-formula>, we extracted the <inline-formula id="IEq177"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{i}$$\end{document}</tex-math><mml:math id="M432"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq177.gif"/></alternatives></inline-formula> from the cells which were attributed to NIH3T3 in the dataset provided by 10X with the same criteria used by [<xref ref-type="bibr" rid="CR2">2</xref>]. Then, 300 cells were randomly attributed to a first group, 500 cells to another one and the others to a third one. The expressions were then generated by python scripts available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lldelisle/scriptsForLopezDelisleEtAl2021">https://github.com/lldelisle/scriptsForLopezDelisleEtAl2021</ext-link>.</p>
    </sec>
    <sec id="Sec27">
      <title>baredSC analysis</title>
      <p id="Par70">bared v1.0.0 was run with default parameters. The number of samples, starting at 100,000 was increased by 10 times until reaching a number of effective samples above 200 (parameter --minNeff 200). However, Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S3, S6 and S7 were generated using the --scale log option to use a regular log scale.</p>
    </sec>
    <sec id="Sec28">
      <title>Data representation</title>
      <p id="Par71">All the figures were made in R (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>) with ggplot2 [<xref ref-type="bibr" rid="CR35">35</xref>] and ggpubr (<ext-link ext-link-type="uri" xlink:href="https://rpkgs.datanovia.com/ggpubr/">https://rpkgs.datanovia.com/ggpubr/</ext-link>).</p>
      <sec id="Sec29">
        <title>Single gene PDF</title>
        <p id="Par72">In Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> , where simulations were run for a single gene, the blue curve displays the PDF of the distribution that has been used to simulate the data (Original distribution). The red curve displays an estimation of the PDF of the normalized expression values obtained after simulation (<inline-formula id="IEq178"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g}/N_i$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq178.gif"/></alternatives></inline-formula>). It was obtained by using the R function ‘density’ which is widely used by R users, in particular in the Seurat violin plots. This function performs a kernel density estimation but the kernel width is automatically adjusted. The green line and area are obtained from baredSC. At each step of the MCMC, a PDF can be evaluated on a range of values (<inline-formula id="IEq179"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1+10^4\lambda _g)$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq179.gif"/></alternatives></inline-formula> or <inline-formula id="IEq180"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(\lambda _g)$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq180.gif"/></alternatives></inline-formula>) using the values of the parameters at this step. For each value of the range of <inline-formula id="IEq181"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1+10^4\lambda _g)$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq181.gif"/></alternatives></inline-formula> or <inline-formula id="IEq182"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(\lambda _g)$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq182.gif"/></alternatives></inline-formula>, the mean across all steps was calculated and plotted as a green line. Similarly, for each value the range, the 16 and 84 percentile over all MCMC steps were evaluated and plotted as a green area. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the purple and pink lines were obtained from Sanity. The purple curve was obtained by using the R function ‘density’ on the inferred log transcription quotients (LTQs). The pink curve was obtained by computing the average of the posterior distribution of each cell which was approximated by a Normal distribution whose parameters are the inferred LTQs and the error value on the LTQ.</p>
      </sec>
      <sec id="Sec30">
        <title>Two-dimension PDF</title>
        <p id="Par73">For each sample of the MCMC obtained by baredSC, the 2D PDF was computed using the parameter values on a grid of x and y (x and y corresponding to <inline-formula id="IEq183"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(1+10^4\lambda _g)$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq183.gif"/></alternatives></inline-formula> or <inline-formula id="IEq184"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$log(\lambda _g)$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq184.gif"/></alternatives></inline-formula>). For each bin, the average of all PDF was computed and is displayed on the last row of Fig. <xref rid="Fig5" ref-type="fig">5</xref> labelled ‘expression inferred by baredSC’. The PDF of the distribution used to simulate data was computed on the same grid and is plotted on the first row labeled ‘original distribution’. In order to represent the simulated data, each cell was assigned to a bin using the normalized expression (<inline-formula id="IEq185"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g1}/N_i$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq185.gif"/></alternatives></inline-formula> and <inline-formula id="IEq186"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{i,g2}/N_i$$\end{document}</tex-math><mml:math id="M450"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4507_Article_IEq186.gif"/></alternatives></inline-formula>), similarly to a 2D histogram. The counts of cells were then normalized to take into account the bin size. The correlation coefficient displayed on the Fig. <xref rid="Fig5" ref-type="fig">5</xref> is obtained from the binned PDF.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4507_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary text and figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank all members of the D. Duboule and G. Andrey laboratories for their inputs. We acknowledge particularly C.C. Bolt for providing the scRNA-seq data for the <italic>Hoxd13</italic>-<italic>Hoxa11</italic> application and R. Rouco and O. Bompadre for sharing the flow cytometry and the scRNA-seq data for the <italic>Pitx1</italic> application. The calculations have been performed using the facilities of the Scientific IT and Application Support Center of EPFL.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LL-D. wrapped the software to implement different options, simulated data and ran the software, wrote the manuscript. J-BD. coded the core of the software, brought his expertise in statistics, wrote the manuscript. Both authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>L. L.-D. was supported by a grant from the European Research Council (RegulHox, #588029, to Denis Duboule) and by EPFL. J.-B. D. was supported by the Swiss National Science Foundation (SNSF). This work has, in part, been carried out within the framework of the National Centre for Competence in Research PlanetS supported by SNSF. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed in Fig. <xref rid="Fig1" ref-type="fig">1</xref> are reanalysis of [<xref ref-type="bibr" rid="CR2">2</xref>] and available at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/Zero_inflation_in_negative_control_data/61292">https://figshare.com/projects/Zero_inflation_in_negative_control_data/61292</ext-link>. The scRNA-seq datasets analysed in Fig. <xref rid="Fig6" ref-type="fig">6</xref> and Fig. <xref rid="Fig7" ref-type="fig">7</xref> are available on GEO with accessible numbers GSE165495 and GSE168632 respectively. baredSC is a python open-source package hosted on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/lldelisle/baredSC">https://github.com/lldelisle/baredSC</ext-link> and can be installed by pip via PyPI or by conda via bioconda. For this paper, version 1.0.0 (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.4897182">http://doi.org/10.5281/zenodo.4897182</ext-link>) was used. All the scripts needed to reproduce all the figures of the paper are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lldelisle/scriptsForLopezDelisleEtAl2021">https://github.com/lldelisle/scriptsForLopezDelisleEtAl2021</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par74">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par75">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par76">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Droplet scRNA-seq is not zero-inflated</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>147</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0379-5</pub-id>
        <pub-id pub-id-type="pmid">31937974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <issue>7637</issue>
        <fpage>331</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1038/nature21350</pub-id>
        <pub-id pub-id-type="pmid">28102262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0927-y</pub-id>
        <?supplied-pmid 27052890?>
        <pub-id pub-id-type="pmid">27052890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>565</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id>
        <pub-id pub-id-type="pmid">28504683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lönnberg</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>
        <source>Genome Med</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id>
        <?supplied-pmid 28821273?>
        <pub-id pub-id-type="pmid">28821273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayak</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hasija</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A hitchhiker’s guide to single-cell transcriptomics and data analysis pipelines</article-title>
        <source>Genomics</source>
        <year>2021</year>
        <volume>113</volume>
        <issue>2</issue>
        <fpage>606</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2021.01.007</pub-id>
        <pub-id pub-id-type="pmid">33485955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Nabavi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>40</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2599-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollen</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Leyrat</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Lui</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>10</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id>
        <pub-id pub-id-type="pmid">25086649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 5802054?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shapira</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Module networks: identifying regulatory modules and their condition-specific regulators from gene expression data</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>34</volume>
        <issue>2</issue>
        <fpage>166</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1165</pub-id>
        <pub-id pub-id-type="pmid">12740579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarbier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mackowiak</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Frade</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Catuara-Solarz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Biryukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gelali</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nuclear gene proximity and protein interactions shape transcript covariations in mammalian single cells</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>5445</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19011-5</pub-id>
        <pub-id pub-id-type="pmid">33116115</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Metazoan MicroRNAs</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <issue>1</issue>
        <fpage>20</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.006</pub-id>
        <pub-id pub-id-type="pmid">29570994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breda</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of gene expression states from single-cell RNA-seq data</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>1008</fpage>
        <lpage>1016</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00875-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Emergence of bias during the synthesis and amplification of cDNA for scRNA-seq</article-title>
        <source>Adv Exp Med Biol</source>
        <year>2018</year>
        <volume>1068</volume>
        <fpage>149</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1007/978-981-13-0502-3_12</pub-id>
        <pub-id pub-id-type="pmid">29943302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Ly</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Miragaia</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Labalette</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Macaulay</surname>
            <given-names>IC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>387</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4220</pub-id>
        <pub-id pub-id-type="pmid">28263961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Ahlmann-Eltze C, Huber W (2021) Transformation and preprocessing of single-cell RNA-Seq data. bioRxiv. 2021; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2021/08/25/2021.06.24.449781">https://www.biorxiv.org/content/early/2021/08/25/2021.06.24.449781</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lause</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berens</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kobak</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Analytic Pearson residuals for normalization of single-cell RNA-seq UMI data</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>258</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02451-7</pub-id>
        <?supplied-pmid 34488842?>
        <pub-id pub-id-type="pmid">34488842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zakany</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Duboule</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The role of Hox genes during vertebrate limb development</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>359</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2007.05.011</pub-id>
        <pub-id pub-id-type="pmid">17644373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheth</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bastida</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Kmita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ros</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>“Self-regulation,” a new facet of Hox genes’ function</article-title>
        <source>Dev Dyn</source>
        <year>2014</year>
        <volume>243</volume>
        <issue>1</issue>
        <fpage>182</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1002/dvdy.24019</pub-id>
        <pub-id pub-id-type="pmid">23913823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beccari</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yakushiji-Kaminatsui</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Woltering</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Necsulea</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lonfat</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rodríguez-Carballo</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A role for HOX13 proteins in the regulatory switch between TADs at the HoxD locus</article-title>
        <source>Genes Dev</source>
        <year>2016</year>
        <volume>30</volume>
        <issue>10</issue>
        <fpage>1172</fpage>
        <lpage>1186</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.281055.116</pub-id>
        <pub-id pub-id-type="pmid">27198226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kherdjemil</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lalonde</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Sheth</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dumouchel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Martino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pineault</surname>
            <given-names>KM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution of Hoxa11 regulation in vertebrates is linked to the pentadactyl state</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>539</volume>
        <issue>7627</issue>
        <fpage>89</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19813</pub-id>
        <pub-id pub-id-type="pmid">27706137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolt</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Lopez-Delisle</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mascrez</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Duboule</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Mesomelic dysplasias associated with the HOXD locus are caused by regulatory reallocations</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5013</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25330-y</pub-id>
        <pub-id pub-id-type="pmid">34408147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeLaurier</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Logan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pitx1 determines the morphology of muscle, tendon, and bones of the hindlimb</article-title>
        <source>Dev Biol</source>
        <year>2006</year>
        <volume>299</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ydbio.2006.06.055</pub-id>
        <pub-id pub-id-type="pmid">16989801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kragesteen</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paliou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Heinrich</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schöpflin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Esposito</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic 3D chromatin architecture contributes to enhancer specificity and limb morphogenesis</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>10</issue>
        <fpage>1463</fpage>
        <lpage>1473</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0221-x</pub-id>
        <pub-id pub-id-type="pmid">30262816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Rouco R, Bompadre O, Rauseo A, Fazio O, Thorel F, Peraldi R et al (2021) Cell-specific alterations in Pitx1 regulatory landscape activation caused by the loss of a single enhancer. bioRxiv. 2021 Mar;p. 2021.03.10.434611. Publisher: Cold Spring Harbor Laboratory Section: New Results. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.03.10.434611v1">https://www.biorxiv.org/content/10.1101/2021.03.10.434611v1</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Separating measurement and expression models clarifies confusion in single-cell RNA sequencing analysis</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>770</fpage>
        <lpage>777</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00873-4</pub-id>
        <pub-id pub-id-type="pmid">34031584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haario</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saksman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tamminen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An adaptive metropolis algorithm</article-title>
        <source>Bernoulli</source>
        <year>2001</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>223</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.2307/3318737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrieu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thoms</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on adaptive MCMC</article-title>
        <source>Stat Comput</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>343</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1007/s11222-008-9110-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delisle</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Ségransan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dumusque</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Bouchy</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lovis</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The HARPS search for southern extra-solar planets. XLIII. A compact system of four super-Earth planets orbiting HD 215152</article-title>
        <source>A&amp;A</source>
        <year>2018</year>
        <volume>614</volume>
        <fpage>A133</fpage>
        <pub-id pub-id-type="doi">10.1051/0004-6361/201732529</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: elegant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
