<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8128449</article-id>
    <article-id pub-id-type="pmid">32761065</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa700</article-id>
    <article-id pub-id-type="publisher-id">btaa700</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FastBMD: an online tool for rapid benchmark dose–response analysis of transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7555-736X</contrib-id>
        <name>
          <surname>Ewald</surname>
          <given-names>Jessica</given-names>
        </name>
        <aff><institution>Department of Natural Resource Sciences, McGill University</institution>, Montreal, QC H9X 3V9, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soufan</surname>
          <given-names>Othman</given-names>
        </name>
        <aff><institution>Institute of Parasitology, McGill University</institution>, Montreal, QC H9X 3V9, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2040-2624</contrib-id>
        <name>
          <surname>Xia</surname>
          <given-names>Jianguo</given-names>
        </name>
        <xref rid="btaa700-cor1" ref-type="corresp"/>
        <aff><institution>Institute of Parasitology, McGill University</institution>, Montreal, QC H9X 3V9, <country country="CA">Canada</country></aff>
        <!--jeff.xia@mcgill.ca-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Basu</surname>
          <given-names>Niladri</given-names>
        </name>
        <xref rid="btaa700-cor1" ref-type="corresp"/>
        <aff><institution>Department of Natural Resource Sciences, McGill University</institution>, Montreal, QC H9X 3V9, <country country="CA">Canada</country></aff>
        <!--niladri.basu@mcgill.ca-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa700-cor1">To whom correspondence should be addressed. <email>jeff.xia@mcgill.ca</email> or <email>niladri.basu@mcgill.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-06">
      <day>06</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>7</issue>
    <fpage>1035</fpage>
    <lpage>1036</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>25</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits 
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa700.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Transcriptomics dose–response analysis is a promising new approach method for toxicity testing. While international regulatory agencies have spent substantial effort establishing a standardized statistical approach, existing software that follows this approach is computationally inefficient and must be locally installed.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>FastBMD is a web-based tool that implements standardized methods for transcriptomics benchmark dose–response analysis in R. It is &gt;60 times faster than the current leading software, supports transcriptomics data from 13 species, and offers a comprehensive analytical pipeline that goes from processing and normalization of raw gene expression values to interactive exploration of pathway-level benchmark dose results.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>FastBMD is freely available at <ext-link xlink:href="http://www.fastbmd.ca" ext-link-type="uri">www.fastbmd.ca</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Canada’s Natural Sciences and Engineering Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Canada Graduate Scholarship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Canada Research Chairs Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EcoToxChip project</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Dose–response analysis (DRA) is a classic method in toxicology used to identify the dose of a chemical that causes a predetermined change in a physiological response; traditionally, this would be an apical outcome such as mortality. This identified dose, called the benchmark dose (BMD), is a key component for developing regulatory standards that aim to protect human and ecological health from adverse effects associated with exposure to chemicals.</p>
    <p>BMDs derived from transcriptomics data from short-term exposures are similar to BMDs derived from apical outcomes from long-term exposures (<xref rid="btaa700-B7" ref-type="bibr">Thomas <italic toggle="yes">et al.</italic>, 2013</xref>). Thus, there has recently been a concerted effort by regulatory agencies, including the U.S. National Toxicology Program (NTP) and Health Canada, to develop standardized methods for DRA with transcriptomics data (<xref rid="btaa700-B1" ref-type="bibr">Farmahin <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The leading tool, BMDExpress, is a Java-based software that follows these standardized transcriptomics DRA methods (<xref rid="btaa700-B4" ref-type="bibr">Phillips <italic toggle="yes">et al.</italic>, 2019</xref>). However, it is computationally intensive, requires local installation, and is not easily integrated with the wealth of bioinformatics resources available in R.</p>
    <p>Here, we present FastBMD, a computationally efficient implementation of the NTP’s approach to transcriptomics DRA (<xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>). FastBMD is a freely available web-based software (<ext-link xlink:href="http://www.fastbmd.ca" ext-link-type="uri">www.fastbmd.ca</ext-link>) that supports BMD analysis at the gene, pathway, and transcriptomic levels. FastBMD currently supports microarray and RNA-sequencing transcriptomics data from 13 species (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), and also includes an annotation-free pipeline for gene and transcriptomic-level BMD analysis for non-model organisms.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>Previous work demonstrated that core non-linear curve fitting algorithms can be efficiently implemented in R (<xref rid="btaa700-B2" ref-type="bibr">Larras <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa700-B6" ref-type="bibr">Ritz <italic toggle="yes">et al.</italic>, 2015</xref>). This provided the foundation for FastBMD as an R-based DRA software that follows the NTP approach (<xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>).</p>
    <p>Prior to curve fitting, a matrix of expression values is annotated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), summarized at the gene level, filtered according to abundance and variance thresholds, and normalized. Genes are filtered according to fold-change and <italic toggle="yes">P</italic>-value thresholds to eliminate those that are unlikely to have dose-dependent behaviour prior to the computationally intensive curve fitting step. For DRA, model parameters are found for up to 10 statistical models using base R non-linear search functions (<xref rid="btaa700-B2" ref-type="bibr">Larras <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa700-B6" ref-type="bibr">Ritz <italic toggle="yes">et al.</italic>, 2015</xref>), and filtered with a lack-of-fit <italic toggle="yes">P</italic>-value threshold (<xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>). The best-fit model is selected for each gene. The gene-level BMD (geneBMD) and its upper and lower 95% confidence intervals are calculated using the likelihood-profiling method based on the mean and standard deviation of control expression values (<xref rid="btaa700-B6" ref-type="bibr">Ritz <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>). GeneBMDs are filtered to remove any that occur above the highest measured dose, or that have a wide confidence interval (<xref rid="btaa700-B5" ref-type="bibr">US NTP, 2018</xref>). The transcriptomic-level (omicBMD) is calculated using the distribution of geneBMDs (<xref rid="btaa700-B3" ref-type="bibr">Pagé-Larivière <italic toggle="yes">et al.</italic>, 2019</xref>). Pathway-level BMDs are calculated as the bootstrapped median of geneBMDs within each pathway. Finally, the gene, pathway, and transcriptomic-level results are integrated with interactive plots and tables (<xref rid="btaa700-F1" ref-type="fig">Fig. 1A</xref>). Detailed explanations of each component of the analysis can be found in the ‘FAQ’ and ‘Resources’ tabs on <ext-link xlink:href="http://www.fastbmd.ca" ext-link-type="uri">www.fastbmd.ca</ext-link>.
</p>
    <fig position="float" id="btaa700-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>FastBMD performance. (<bold>A</bold>) Snapshot of interactive gene, pathway and transcriptomic BMD visualization in FastBMD for the TRBZ (13 weeks) dataset. (<bold>B</bold>) Comparison of elapsed time during curve-fitting between FastBMD (yellow) and BMDExpress (grey) for 24 datasets. (<bold>C</bold>) OmicBMDs from FastBMD and BMDExpress for 24 datasets.</p>
      </caption>
      <graphic xlink:href="btaa700f1" position="float"/>
    </fig>
    <p>FastBMD was implemented based on the PrimeFaces (v8.0) component library (<ext-link xlink:href="http://primefaces.org/" ext-link-type="uri">http://primefaces.org/</ext-link>) and R (version 3.6.2). The interactive features were developed using Plotly.js (<ext-link xlink:href="https://plot.ly" ext-link-type="uri">https://plot.ly</ext-link>). The system is hosted on a Google Cloud instance (12 virtual CPUs, 70 GB RAM), except for curve fitting which is computed in parallel through a microservice hosted on a dedicated server (24 cores, 128 GB RAM) using SpringBoot.</p>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <p>The performance of FastBMD was compared to that of BMDExpress 2 with microarray data measured in adult rats from 24 separate dose–response experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) (<xref rid="btaa700-B7" ref-type="bibr">Thomas <italic toggle="yes">et al.</italic>, 2013</xref>). Data were quantile normalized in R, and then analysed using both FastBMD and BMDExpress on a Macbook Pro with 4 cores and 8 GB RAM. Genes that did not have a fold change of at least two for any dose group compared to the control were filtered out. All statistical models other than 3° and 4° polynomials were fit to the expression of each remaining gene. More methodological details are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
  </sec>
  <sec>
    <title>4 Results and discussion</title>
    <p>FastBMD was over 60 times faster than BMDExpress, taking 0.18 h to compute geneBMDs for all 24 experiments compared to 11.03 h for BMDExpress (<xref rid="btaa700-F1" ref-type="fig">Fig. 1B</xref>). The omicBMD<sup>mode</sup> from each experiment were extremely similar with an even distribution around the 1:1 line and an <italic toggle="yes">R</italic><sup>2</sup> of 0.997 (<xref rid="btaa700-F1" ref-type="fig">Fig. 1C</xref>). Sources of variation in the results between the two softwares are discussed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>. The increased efficiency can be mainly explained by the curve fitting algorithm. In FastBMD, parameters are roughly estimated using the input data, and then fed into a modern non-linear parameter search algorithm that quickly either converges or fails. In contrast, BMDExpress searches the parameter space until either a solution is found, or the user-specified timeout period is surpassed.</p>
    <p>FastBMD is designed to be a flexible tool that can accommodate diverse transcriptomics data. It addresses reproducibility by allowing users to download results after each analytical step and generate summary reports. Since it is implemented in R, FastBMD is uniquely positioned to leverage existing statistical packages to rapidly implement future updates as the regulatory and scientific communities continue to refine the recommended approach. In the future, we plan to incorporate knowledgebases of environmental chemical concentrations, expanded gene-set libraries and baseline gene expression levels in common target tissues to provide additional context for the BMD results.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Canada’s Natural Sciences and Engineering Research Council (Discovery Grants to J.X. and N.B.; Canada Graduate Scholarship to J.E.), and the Canada Research Chairs Program (to J.X. and N.B.). The authors also thank Jason O’Brien, Florence Pagé-Larivière, Doug Crump, and other members of the EcoToxChip project (funded by Genome Canada) for their advice.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa700_Supplementary_Data</label>
      <media xlink:href="btaa700_supplementary_data.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa700-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farmahin</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Recommended approaches in the application of toxicogenomics to derive points of departure for chemical risk assessment</article-title>. <source>Arch. Toxicol</source>., <volume>91</volume>, <fpage>2045</fpage>–<lpage>2065</lpage>.<pub-id pub-id-type="pmid">27928627</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larras</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>DRomics: a Turnkey Tool to support the use of the dose–response framework for omics data in ecological risk assessment</article-title>. <source>Environ. Sci. Technol</source>., <volume>52</volume>, <fpage>14461</fpage>–<lpage>14468</lpage>.<pub-id pub-id-type="pmid">30444611</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagé-Larivière</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Transcriptomic points-of-departure from short-term exposure studies are protective of chronic effects for fish exposed to estrogenic chemicals</article-title>. <source>Toxicol. Appl. Pharmacol</source>., <volume>378</volume>, <fpage>114634</fpage>.<pub-id pub-id-type="pmid">31226361</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Phillips</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>BMDExpress 2: enhanced transcriptomic dose–response analysis workflow</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>1780</fpage>–<lpage>1782</lpage>.<pub-id pub-id-type="pmid">30329029</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritz</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Dose–response analysis using R</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0146021</fpage>.<pub-id pub-id-type="pmid">26717316</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thomas</surname><given-names>R.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Temporal concordance between apical and transcriptional points of departure for chemical risk assessment</article-title>. <source>Toxicol. Sci</source>., <volume>134</volume>, <fpage>180</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">23596260</pub-id></mixed-citation>
    </ref>
    <ref id="btaa700-B7">
      <mixed-citation publication-type="other">US NTP. (<year>2018</year>) NTP research report on National Toxicology Program Approach to genomic dose–response modeling. <italic toggle="yes">Research Report 5</italic>.</mixed-citation>
    </ref>
  </ref-list>
</back>
