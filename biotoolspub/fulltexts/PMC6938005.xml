<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Inform Decis Mak</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Inform Decis Mak</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Informatics and Decision Making</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1472-6947</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6938005</article-id>
    <article-id pub-id-type="publisher-id">1013</article-id>
    <article-id pub-id-type="doi">10.1186/s12911-019-1013-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AliClu - Temporal sequence alignment for clustering longitudinal clinical data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rama</surname>
          <given-names>Kishan</given-names>
        </name>
        <address>
          <email>kishan.rama@tecnico.ulisboa.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Canhão</surname>
          <given-names>Helena</given-names>
        </name>
        <address>
          <email>helena.canhao@nms.unl.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carvalho</surname>
          <given-names>Alexandra M.</given-names>
        </name>
        <address>
          <email>alexandra.carvalho@tecnico.ulisboa.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1954-5487</contrib-id>
        <name>
          <surname>Vinga</surname>
          <given-names>Susana</given-names>
        </name>
        <address>
          <email>susanavinga@tecnico.ulisboa.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id><institution-id institution-id-type="GRID">grid.9983.b</institution-id><institution>Instituto de Telecomunicações, Instituto Superior Técnico, Universidade de Lisboa, </institution></institution-wrap>Avenida Rovisco Pais, 1 - Torre Norte Piso 10., Lisboa, 1049-001 Portugal </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121511713</institution-id><institution-id institution-id-type="GRID">grid.10772.33</institution-id><institution>CEDOC, EpiDoC Unit, NOVA Medical School, National School of Public Health, Universidade NOVA de Lisboa, </institution></institution-wrap>Rua do Instituto Bacteriológico, n∘ 5 Lab 2.9., Lisboa, 1150-082 Portugal </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id><institution-id institution-id-type="GRID">grid.9983.b</institution-id><institution>INESC-ID, Instituto Superior Técnico, Universidade de Lisboa, </institution></institution-wrap>Rua Alves Redol 9, Lisboa, 1000-029 Portugal </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>289</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Patient stratification is a critical task in clinical decision making since it can allow physicians to choose treatments in a personalized way. Given the increasing availability of electronic medical records (EMRs) with longitudinal data, one crucial problem is how to efficiently cluster the patients based on the temporal information from medical appointments. In this work, we propose applying the Temporal Needleman-Wunsch (TNW) algorithm to align discrete sequences with the transition time information between symbols. These symbols may correspond to a patient’s current therapy, their overall health status, or any other discrete state. The transition time information represents the duration of each of those states. The obtained TNW pairwise scores are then used to perform hierarchical clustering. To find the best number of clusters and assess their stability, a resampling technique is applied.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose the AliClu, a novel tool for clustering temporal clinical data based on the TNW algorithm coupled with clustering validity assessments through bootstrapping. The AliClu was applied for the analysis of the rheumatoid arthritis EMRs obtained from the Portuguese database of rheumatologic patient visits (Reuma.pt). In particular, the AliClu was used for the analysis of therapy switches, which were coded as letters corresponding to biologic drugs and included their durations before each change occurred. The obtained optimized clusters allow one to stratify the patients based on their temporal therapy profiles and to support the identification of common features for those groups.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The AliClu is a promising computational strategy to analyse longitudinal patient data by providing validated clusters and by unravelling the patterns that exist in clinical outcomes. Patient stratification is performed in an automatic or semi-automatic way, allowing one to tune the alignment, clustering, and validation parameters. The AliClu is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sysbiomed/AliClu">https://github.com/sysbiomed/AliClu</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Temporal sequence alignment</kwd>
      <kwd>Clustering</kwd>
      <kwd>Bootstrap</kwd>
      <kwd>clustering indices</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The increasing availability of clinical data and the increased investments in healthcare are driving research on building better clinical decision support systems for the effective personalization of treatments. In this context, machine learning and data mining techniques are becoming ubiquitous, helping to provide high-quality care systems and improve the long-term health of patients.</p>
    <p>Patients’ health records are being stored in electronic medical records (EMRs) and consist of a variety of data, such as demographics, medical history, laboratory test results, medications, and allergies. These EMR systems are designed to store patients’ data across time, thereby providing large longitudinal cohorts. Exploring the disease heterogeneity and patterns in these datasets is a challenging task. Several issues contribute to this difficulty of this task: the exponential number of all possible combinations in patients’ trajectories, the variability in their temporal scales, and the complexity of their representations.</p>
    <p>We address the problem of learning temporal patterns in EMR data by using a combined approach of (temporal) alignment and hierarchical clustering. More specifically, we use the Temporal Needleman-Wunsch (TNW) algorithm [<xref ref-type="bibr" rid="CR1">1</xref>] to align discrete sequences with the time information between symbols and, subsequently, perform hierarchical clustering using the obtained pairwise scores. The TNW algorithm is an extension of the traditional Needleman-Wunsch (NW) [<xref ref-type="bibr" rid="CR2">2</xref>] for global sequence alignment. The TNW takes into account the matches between symbols, as in the NW algorithm, and also adds a penalization term for the differences in the time values between two sequences. Other temporal alignment methods, such as dynamic time warping, are not adequate for dealing with these type of data, and they just provide general trends for matching continuous-time signals [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>The TNW is particularly interesting when utilizing data representing given events or states (coded as symbols) and their corresponding durations. Treatment switching provides us with an excellent example of this type of temporal sequence data. Starting at instant 0 with Treatment A, its failure after <italic>t</italic><sub><italic>A</italic></sub> may lead to switching to Treatment B with a duration of <italic>t</italic><sub><italic>B</italic></sub>, and then switching again to Treatment <italic>F</italic>, which is still ongoing (<italic>t</italic><sub><italic>F</italic></sub> represents that duration). In this case, we would have a patient profile given by the sequence
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0.A,t_{A}.B,t_{B}.F,t_{F}.Z,$$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>0</mml:mn><mml:mi>.A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi>.B</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>.F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mi>.Z</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12911_2019_1013_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> which includes symbols and numeric values and where <italic>Z</italic> is a special symbol representing that the last therapy has not yet failed. It is worth noting that the discrete states (<italic>A</italic>, <italic>B</italic> and <italic>F</italic> in this example) can also be obtained through the discretization of the continuous features. Additionally, the times representing the durations of the states are completely general with the only restriction being that they are measured at the same scale for all patients.</p>
    <p>State-of-the-art alignment approaches usually involve multiple sequence alignment techniques that use the progressive alignment heuristic: they are fast, scalable and widely used. The most popular methods include Clustal Omega [<xref ref-type="bibr" rid="CR7">7</xref>], MAFFT [<xref ref-type="bibr" rid="CR8">8</xref>], and MUSCLE [<xref ref-type="bibr" rid="CR9">9</xref>]. These methods were essentially developed for aligning DNA or protein sequences, which are time-invariant sequences composed by letters.</p>
    <p>In this work, we focus specifically on using the temporal information present in clinical data for pairwise sequence alignment. In this regard, the literature includes mostly alignment algorithms for continuous time series data [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. A very well known approach is Dynamic Time Warping (DTW) [<xref ref-type="bibr" rid="CR3">3</xref>], which warps the time axis of the sequences to achieve alignment. It is also based on dynamic programming, such as the NW algorithm [<xref ref-type="bibr" rid="CR2">2</xref>], but it does not incorporate a gap penalty. Pairwise alignment using Hidden Markov Models (HMMs) also constitutes an alternative [<xref ref-type="bibr" rid="CR10">10</xref>]; however, it is not trivial to directly include temporal data.</p>
    <p>Motivated by the need for a sequence alignment method that can assess the similarity between two sequences in the same way as the NW or HMM does while also accounting for the time that elapses between events, Syed and Das developed the TNW algorithm [<xref ref-type="bibr" rid="CR1">1</xref>] that can be applied to healthcare data to find similar patients based on medical histories.</p>
    <p>An alternative approach could be simply applying traditional sequence alignments such as the NW to sequences after some pre-processing step. This step would account for the temporal information between events by repeating an event several times to create the sequences to be aligned. For example, the temporal sequence "0.A,5.B" could be transformed to "AAAAAB", where the five As in the latter sequence represent the five units of time that elapsed from "A" to "B". Then, the NW algorithm can be applied. Several drawbacks exist in this approach; namely, the need to divide the time intervals between events in windows and the longer sequences that are created, thus increasing the computational time of the alignments. The TNW algorithm overcomes these issues and does not require any additional transformation of the original data. The absence of related works in the literature on this algorithm motivated us to test it on the Reuma.pt dataset [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>The main goal of this work is to obtain clusters of patients by analysing longitudinal medical data specifically, clinical data. Clustering patients with similar treatment profiles would allow for identifying the common features of those groups and delineate strategies to improve treatment outcomes.</p>
    <p>In the literature, several studies are found that try to achieve the same objective. In [<xref ref-type="bibr" rid="CR12">12</xref>], Docampo et al. present a cluster analysis of clinical data to identify fibromyalgia subgroups. Their approach is a two-step clustering process. In the first step, the clinical variables are clustered by using partitioning around medoids. The number of clusters is found by using silhouette plots and Calinski’s index. In the second step, synthetic patient indices are calculated for each sample and dimension in order to find the patient subgroups.</p>
    <p>In another work [<xref ref-type="bibr" rid="CR13">13</xref>], Garg et al. proposed two techniques based on survival trees to cluster patients into clinically meaningful groups according to their expected lengths of stay. Their techniques are more applicable to survival analysis using survival data.</p>
    <p>In [<xref ref-type="bibr" rid="CR14">14</xref>], the authors investigated if subgroups of patients with non-specific lower back pain could be identified by applying hierarchical cluster analysis to a dataset that contained 6-month clinical courses of patients with measurements of bothersomeness. An initial step was required before using the clustering algorithm, which consisted of condensing the courses of each patient based on four parameters. These parameters were obtained by fitting a regression line in the courses and computing the slopes and intersections. After the parameters were defined for each patient, hierarchical clustering utilizing Ward’s method was applied. In order to determine the optimal number of clusters, they analysed the resulting dendrograms with Calinski’s criterion, which was also used in [<xref ref-type="bibr" rid="CR12">12</xref>]. Regarding the results, four clusters were found with distinct clinical courses, which showed that it is possible to find clinical meaningful clusters based on the temporal evolution of the variable under study. Note that, in this work, the temporal information between measurements is not directly used, but we estimate the parameters of a line that is fit for the clinical courses.</p>
    <p>In addition to the clustering approaches discussed before, a model-based clustering method was proposed for clustering individuals based on measurements taken over time [<xref ref-type="bibr" rid="CR15">15</xref>]. The authors apply their method to data from pregnant women to identify hormone trajectories. One important aspect of this approach is that the method requires the specification of the number of clusters to be fit to the model. In their work, it was known that data were divided into two groups; hence, they knew the number of clusters to select.</p>
    <p>However, this number was also confirmed by the Bayesian information criterion that they used to choose the number of clusters.</p>
    <p>To the best of our knowledge, the AliClu is a novel approach for addressing this type of mixed, longitudinal data that takes into account both the sequence of states and their durations. The TNW algorithm allows one to align similar medical histories by considering the temporal information and also penalising missing events by inserting gaps. Furthermore, the AliClu provides clustering validation using bootstrapping, which allows one to tune the input parameters to find the best number of clusters and to identify the most homogeneous patient strata. The AliClu is fully implemented and freely available for further applications.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The pipeline of the proposed method, which is named the AliClu, is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the first step, the complete raw data are pre-processed to obtain the temporal sequences. Then, in the second step, pairwise temporal sequence alignment is performed, and a similarity matrix is obtained. The third step consists of converting the similarity matrix into distances. Agglomerative clustering is then performed by using this distance matrix, and finally, the clustering results are validated via a bootstrapping approach. The obtained patient stratification can be graphically represented to ease the clinical interpretation. Each step of this pipeline is detailed as follows.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The proposed AliClu approach. First, raw data is pre-processed to obtain PE sequences. Then, pairwise sequence alignment is performed and a similarity matrix <italic>S</italic> is obtained. Next, <italic>S</italic> is converted into a distance matrix <italic>D</italic>. Agglomerative clustering is then performed with this distance matrix <italic>D</italic>. Validation of the clustering results is accomplished via a bootstrapping approach. In the end, retrieved clusters are analysed by the clinicians</p></caption><graphic xlink:href="12911_2019_1013_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Data pre-processing</title>
      <p>This pre-processing step creates temporal sequences for each patient from EMRs. Patients’ records are typically available in <italic>panel data</italic> format, in which each patient is spread in different lines, one for each medical appointment, and the columns contain the features of interest measured over time. In this work, we consider that each patient experiences a sequence of events over time. Let A and B be the events of interest for a given patient with the time-distance <italic>t</italic> between them, and a <italic>prefix-encoded</italic> (PE) sequence for that patient is defined as 0.<italic>A,t</italic>.<italic>B</italic>.</p>
      <p>In this pre-processing phase, the PE sequences are built for each patient, requiring information about the patient’s ID, the event under study, and the time between two consecutive events. These features must be taken from the panel data. In the data set, the time may be formatted as a date or just a number in any time unit (e.g., seconds, minutes, or days). Depending on the time format, two types of pre-processing steps are implemented. We refer the interested reader to the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for further details.</p>
    </sec>
    <sec id="Sec4">
      <title>Temporal sequence alignment</title>
      <p>After building the prefix-encoded (PE) sequences, it is possible to align all patient pairs using the TNW algorithm [<xref ref-type="bibr" rid="CR1">1</xref>]. The TNW guarantees convergence to the optimal alignment for a given scoring scheme, gap penalty <italic>g</italic>, and temporal penalty <italic>T</italic><sub><italic>p</italic></sub>. Notwithstanding, alignments can drastically change depending on the choice of these parameters, and this is the reason why they should be carefully chosen.</p>
      <p>The information of the retrieved alignments is summarized into an <italic>N</italic>×<italic>N</italic> similarity matrix <italic>S</italic>, where <italic>N</italic> is the number of patients in the data. In this matrix, the entry value (<italic>i,j</italic>) gives the alignment score of the <italic>i</italic>-th and <italic>j</italic>-th patients. Due to symmetry, only <italic>N</italic>×(<italic>N</italic>−1)/2 entries need to be computed.</p>
    </sec>
    <sec id="Sec5">
      <title>Distance matrix</title>
      <p>Before using the agglomerative clustering algorithm, we need to convert the similarity matrix <italic>S</italic>, which was obtained in the previous step, into a distance matrix <italic>D</italic>. To this end, we take the symmetric value of each score and then we shift it by adding the maximum similarity score in matrix <italic>S</italic>. This shift is made in order to make all scores greater than or equal to zero. In summary, the distance matrix is computed as follows: <italic>a</italic>= max<italic>i</italic>&lt;<italic>jS</italic><sub><italic>ij</italic></sub> with <italic>i,j</italic>=1,…,<italic>N</italic> and <italic>D</italic>=−<italic>S</italic>+<italic>a</italic>(<bold>1</bold>·<bold>1</bold><sup><italic>T</italic></sup>) with <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {1} = \left (\begin {smallmatrix} 1 \\ \vphantom {\int \limits ^{x}}\smash {\vdots } \\ 1 \end {smallmatrix}\right) \in \mathbf {R}^{N}$\end{document}</tex-math><mml:math id="M4"><mml:mn mathvariant="bold">1</mml:mn><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq1.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec6">
      <title>Clustering of temporal sequence alignments</title>
      <p>The dissimilarity matrix obtained is then used to perform agglomerative clustering [<xref ref-type="bibr" rid="CR16">16</xref>]. The resulting groups can be depicted in a dendrogram, a tree showing the order and distances of the merges performed during the clustering procedure. Five different linkage functions are used, namely, single, complete, average, centroid, and Ward’s method. Since hierarchical clustering methods do not explicitly set the number of clusters, the AliClu additionally provides an automatic bootstrapping-based validation technique proposed by Mucha [<xref ref-type="bibr" rid="CR17">17</xref>] that selects the best number according to several clustering indices. These indices include <italic>Rand</italic> [<xref ref-type="bibr" rid="CR18">18</xref>], the <italic>adjusted Rand</italic> (AR) [<xref ref-type="bibr" rid="CR19">19</xref>], <italic>Fowlkes and Mallows</italic> (FM) [<xref ref-type="bibr" rid="CR20">20</xref>], <italic>Jaccard</italic>, and the <italic>adjusted Wallace</italic> (AW) [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
      <p>The pseudo-code of the cluster and validation procedure is given in Algorithm 1. The inputs of the algorithm are the distance matrix <italic>D</italic> for the agglomerative clustering algorithm, the number of bootstrap samples <italic>M</italic>, the linkage criterion <italic>L</italic>, and the minimum <italic>K</italic><sub>min</sub> and the maximum <italic>K</italic><sub>max</sub> numbers of clusters to be analysed. The output is the statistics of all the clustering indices described above, namely, the medians, means, and variances for all the bootstrap samples, which are calculated for each analysed number of clusters (between <italic>K</italic><sub>min</sub> and <italic>K</italic><sub>max</sub>).</p>
      <p>
        <graphic position="anchor" xlink:href="12911_2019_1013_Figa_HTML" id="MO8"/>
      </p>
      <p>The algorithm begins by performing agglomerative clustering on distance matrix <italic>D</italic> in Step 1. Then, an outer loop starts in Step 2, corresponding to a bootstrapping procedure. From Steps 3 to 5, a bootstrapped sample is generated, and agglomerative clustering is performed on it. Then, an inner loop computes the clustering indices between the clustering of the original patients and the clustering of the bootstrapped sample (Steps 6-10). In Step 8, the obtained dendrograms <italic>Z</italic> and <italic>Z</italic><sup>′</sup> are cut to retrieve <italic>q</italic> clusters (in each), where <italic>K</italic><sub>min</sub>≤<italic>q</italic>≤<italic>K</italic><sub>max</sub>. After running the outer loop <italic>M</italic> times, the statistics of the clustering indices are computed (Step 11).</p>
      <p>The output of Algorithm 1 helps to select the best number of clusters in the data, herein <italic>k</italic>. The right candidate is the one that yields the higher number of maximum average values over the clustering indices. To corroborate the previous guess, the standard deviation of the clustering indices for each <italic>k</italic> can be taken into account. The choice of <italic>k</italic> can be automatic or semi-automatic. In this latter case, the results composed by dendrograms, the averages and the standard deviations of the obtained clustering indices are given to the user for manual inspection and further selection.</p>
      <p>After obtaining the best number of clusters <italic>k</italic> according to these criteria, the stability of each individual cluster is then assessed in Algorithm 2, again via the bootstrapping approach [<xref ref-type="bibr" rid="CR17">17</xref>]. The inputs of this algorithm are the number of clusters <italic>k</italic>, the clusters themselves {<italic>A</italic><sub>1</sub>,…,<italic>A</italic><sub><italic>k</italic></sub>}, the linkage criterion <italic>L</italic>, and the number of bootstrapped samples <italic>M</italic>. The output is the stability measures of the obtained clusters, which are assessed by the criteria described as follows.</p>
      <p>
        <graphic position="anchor" xlink:href="12911_2019_1013_Figb_HTML" id="MO6"/>
      </p>
      <p>The algorithm starts with resampling. For each bootstrapped sample, a dendrogram <italic>Z</italic><sup>′</sup> is obtained by performing agglomerative clustering on the sample (Steps 2-4). Then, a collection of <italic>k</italic> clusters {<italic>B</italic><sub>1</sub>,…,<italic>B</italic><sub><italic>k</italic></sub>} is obtained by cutting the dendrogram <italic>Z</italic><sup>′</sup> (Step 5). From Steps 6 to 11, as proposed by Mucha [<xref ref-type="bibr" rid="CR17">17</xref>], three different measures are computed for each cluster <italic>A</italic><sub><italic>j</italic></sub>,1≤<italic>j</italic>≤<italic>k</italic>, namely, <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tau _{j}^{\ast }$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq2.gif"/></alternatives></inline-formula> (the Jaccard index), <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{j}^{\ast }$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq3.gif"/></alternatives></inline-formula> (the recovery rate) and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{j}^{\ast }$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq4.gif"/></alternatives></inline-formula> (the Dice coefficient). These indices provide a measure of the similarity between cluster <italic>A</italic><sub><italic>j</italic></sub> and its most similar cluster in {<italic>B</italic><sub>1</sub>,…,<italic>B</italic><sub><italic>k</italic></sub>}. Finally, in Step 12, the stability of the retrieved clusters is assessed by computing the average values of <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tau _{j}^{\ast }, \gamma _{j}^{\ast }$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{j}^{\ast }$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq6.gif"/></alternatives></inline-formula>, and by analysing the corresponding standard deviations.</p>
      <p>As discussed in [<xref ref-type="bibr" rid="CR17">17</xref>], it is difficult to set an appropriate threshold that denotes that a cluster is stable. Therefore, we followed the rule of thumb and considered stable clusters as the ones that yield high average values (close to one) and low standard deviations for <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tau _{j}^{\ast }, \gamma _{j}^{\ast }$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{j}^{\ast }$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq8.gif"/></alternatives></inline-formula>.</p>
      <p>Algorithm 3 presents the overall proposed method for obtaining clusters from PE sequences. Its inputs are the raw data, the scoring system <italic>SS</italic>, the temporal penalty <italic>T</italic><sub><italic>p</italic></sub>, and the gap related parameters (<italic>g</italic><sub>min</sub>,<italic>g</italic><sub>max</sub> and <italic>g</italic><sub><italic>istep</italic></sub>) required by the TNW; the number of bootstrapped samples <italic>M</italic>, for Algorithm 1 and Algorithm 2; the linkage criterion <italic>L</italic>; and the minimum <italic>K</italic><sub>min</sub> and the maximum <italic>K</italic><sub>max</sub> numbers of clusters.</p>
      <p>
        <graphic position="anchor" xlink:href="12911_2019_1013_Figc_HTML" id="MO7"/>
      </p>
      <p>The initial step of the algorithm pre-processes the raw data to produce PE sequences (Step 1). The gap penalty of the TNW algorithm is then set to range from <italic>g</italic><sub>min</sub> to <italic>g</italic><sub>max</sub> at incremental steps of <italic>g</italic><sub><italic>istep</italic></sub> (Step 2 and Step 7). For each value of the gap penalty <italic>g</italic>, pairwise temporal alignment using the TNW is performed, which outputs a similarity matrix <italic>S</italic> (Step 4). Then, <italic>S</italic> is converted into a distance matrix <italic>D</italic> (Step 5). Clustering is then performed by running Algorithm 1 (Step 6).</p>
      <p>When the cycle from Steps 3 to 7 ends, there are several results to explore: one for each of the number of clusters (<italic>K</italic><sub>min</sub>,…, <italic>K</italic><sub>max</sub>) and gap penalties (<italic>g</italic><sub>min</sub> to <italic>g</italic><sub>max</sub> with <italic>g</italic><sub><italic>istep</italic></sub>). In Step 8, the final number of clusters <italic>k</italic> is obtained from these results. As stated before, if an automatic procedure is chosen, the final number of clusters <italic>k</italic> retrieved in this step is that which results in the most frequent higher average values for the clustering indices. In this case, the chosen gap penalty <italic>g</italic> is the one that yields the best average values for the clustering indices for the final number of clusters. In the semi-automatic option, the full results for different <italic>k</italic> and <italic>g</italic> – including the dendrograms, averages and standard deviations of the clustering indices – are provided to the user, which then determines the final number of clusters <italic>k</italic> and gap parameter <italic>g</italic> to be further used. In Step 9, the stability of the retrieved clusters is assessed by running Algorithm 2.</p>
      <p>The run-time complexity of the TNW is <italic>O</italic>(<italic>n</italic><sup>2</sup>), and that of agglomerative clustering is <italic>O</italic>(<italic>N</italic><sup>3</sup>), where <italic>n</italic> is the length of the PE sequences and <italic>N</italic> is the number of patients in the data. Moreover, computing the cluster stability in Algorithm 2 for Steps 6–11 takes <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O(K_{\max }^{2}\times N)$\end{document}</tex-math><mml:math id="M20"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq9.gif"/></alternatives></inline-formula>. Therefore, the AliClu algorithm takes
<disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$O(\Delta G\times n^{2} + \Delta G\times M\times \Delta K\times N^{3} + M\times K_{\max}^{2} \times N)$$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>ΔG</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ΔG</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>ΔK</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12911_2019_1013_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> time, where <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta G=\left \lceil \frac { g_{\max }-g_{\min }+1}{g_{istep}}\right \rceil $\end{document}</tex-math><mml:math id="M24"><mml:mi>ΔG</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">istep</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12911_2019_1013_Article_IEq10.gif"/></alternatives></inline-formula> is the number of gaps analysed (<italic>g</italic><sub>min</sub> to <italic>g</italic><sub>max</sub> with <italic>g</italic><sub><italic>istep</italic></sub>), <italic>M</italic> is the number of bootstrapped samples, and <italic>Δ</italic><italic>K</italic>=<italic>K</italic><sub>max</sub>−<italic>K</italic><sub>min</sub>+1 is the number of clusters considered (from <italic>K</italic><sub>min</sub> to <italic>K</italic><sub>max</sub>).</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="results">
    <title>Results</title>
    <sec id="Sec8">
      <title>Synthetic datasets</title>
      <p>We first evaluate the AliClu using synthetic datasets, which provides a proof of concept in a controlled scenario where the true cluster labels are known a priori and makes it easy to determine the merits of the method. The synthetic datasets consisted of temporal sequences generated by <italic>continuous-time Markov chains</italic> in a variety of parameter settings.</p>
      <p>We concluded that the AliClu successfully found the correct clusters in more than 80<italic>%</italic> of the cases for datasets containing two well-separated clusters. Moreover, the linkage method that produced the best results for the agglomerative clustering was Ward’s method; thus, it was adopted in the remaining experiments. The complete study of the AliClu behaviour on each of the synthetic problems is available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>, along with all the details regarding the sequence generation and clustering evaluation.</p>
    </sec>
    <sec id="Sec9">
      <title>The Reuma.pt database</title>
      <p>We then applied the AliClu to biologic therapy switching for <italic>rheumatoid arthritis</italic> (RA) patients in a real-life longitudinal cohort – the Reuma.pt database [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p>Reuma.pt [<xref ref-type="bibr" rid="CR11">11</xref>] is a Portuguese nationwide database developed by the Portuguese Society of Rheumatology. It stores the EMRs of rheumatoid patients as structured and narrative data with the goal of monitoring the disease’s progression and assuring treatment effectiveness and safety. In this study, we focus on patients with <italic>rheumatoid arthritis</italic> (RA) being treated with biologic therapies at one centre. The retrieved data include 426 patients diagnosed with RA who followed-up regularly more or less every three to six months, which resulted in a total of 9305 medical appointments.</p>
      <p>The RA is an immunomediated inflammatory rheumatic disease that causes pain and swelling in the wrists and small joints of the hands and feet. RA treatments can mitigate these symptoms, prevent joint damage, and provide a better quality of life to the patients. Traditional therapies consist of using conventional <italic>disease-modifying antirheumatic drugs</italic> (DMARDs), which are used as a monotherapy or in combinations. When patients fail to respond to conventional DMARDs, modern biologic therapies are tried. Unlike conventional DMARDs, biologic ones are made using biotechnology. Biologics are genetically engineered to act as natural proteins in the human immune system.</p>
      <p>The goal of RA treatment is to induce the disease’s remission by controlling the inflammation. This approach would relieve the symptoms, prevent joint and organ damage, improve physical functioning and overall well-being, and reduce long-term complications. It is crucial to identify the most effective RA treatments early in the disease’s progression. In this regard, we used the AliClu to analyse biologic therapy switching, where PE sequences are built by interspersing biologic drugs that are coded as letters and include their durations. The optimized clusters allow for the stratification of RA patients based on their temporal therapy profiles and identification of common features of these groups. Patients starting new biologic therapies can then benefit from these insights.</p>
    </sec>
    <sec id="Sec10">
      <title>Clustering of biologic therapy switches</title>
      <p>Data of the 426 RA patients concerning biologic therapy switches from the Reuma.pt database were preprocessed to build the PE sequences. Figure <xref rid="Fig2" ref-type="fig">2</xref> presents the statistics regarding the number of biologic drugs taken by patients. Almost 60% of the patients had only one biologic drug recorded (no switches). Patients who have taken five or more drugs are rare: three patients have taken five, two have taken six, and two have taken seven different treatments. We stress that when switching therapies, a patient never goes back to taking the previous biologic drug.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Percentage of biologic drugs taken by Rheumatoid Arthritis (RA) patients. Almost 60% of the patients only had one biologic drug. Patients that have taken more than five biologic drugs are rare; three patients have taken five, two patients have taken six, and other two seven biologic drugs</p></caption><graphic xlink:href="12911_2019_1013_Fig2_HTML" id="MO2"/></fig></p>
      <p>For this particular dataset, the following drugs were as follows: A – etanercept, B – infliximab, C – rituximab, D – adalimumab, E – anacinra, F – abatacept, G – tocilizumab, and H – golimumab. These drugs correspond to distinct active therapeutic principles and are prescribed in different stages of the disease.</p>
      <p>Having the PE sequences, Algorithm 3 is run with <italic>K</italic><sub>max</sub>=30, and all other input parameters are set to their default values. The scoring system is 1 for a match and −1.1 for a mismatch of the drug representation, the temporal penalty is <italic>T</italic><sub><italic>p</italic></sub>=0.25, and the number of bootstrapped samples is <italic>M</italic>=1000. Moreover, in this experiment, the AliClu is used in a semi-automatic manner (Step 12 of Algorithm 1 and Step 8 of Algorithm 3 are subject to user input).</p>
      <p>We concluded that Ward’s linkage leads to superior results in terms of the clustering indices and clinical information, and a gap penalty of <italic>g</italic>=0.7 and a temporal penalty of <italic>T</italic><sub><italic>p</italic></sub>=0.25 correspond to balanced choices with respect to the other input parameters. It is noteworthy that these choices are data dependent and provide a proof-of-concept of the principle since a full analysis and optimization of the clustering parameters would be out of the scope of the present work.</p>
      <p>The running time recorded for this final setting was approximately 1 hour by using a machine with a 2.6 GHz Intel Core i7 processor and 16 GB of 2400 MHz DDR4 memory. This time corresponds to approximately 3.8 seconds for each gap and replicate analysed for the full range of cluster numbers.</p>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the dendrogram obtained when using this parameter set, i.e., <italic>g</italic>=0.7 and a temporal penalty of <italic>T</italic><sub><italic>p</italic></sub>=0.25. The averages of the five clustering indices obtained with Algorithm 1 are presented in Table <xref rid="Tab1" ref-type="table">1</xref>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Dendrogram of the agglomerative hierarchical clustering of Rheumatoid Arthritis (RA) patients. Dendrogram of Ward’s method hierarchical clustering with gap penalty <italic>g</italic>=0.7 and temporal penalty <italic>T</italic><sub><italic>p</italic></sub>=0.25. Twenty five clusters were selected based on the analysis of the clustering indices and clinical interpretation</p></caption><graphic xlink:href="12911_2019_1013_Fig3_HTML" id="MO3"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Average values of five clustering indices for the dendrogram of Fig. <xref rid="Fig3" ref-type="fig">3</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><italic>k</italic></th><th align="left">Rand</th><th align="left">AR</th><th align="left">FM</th><th align="left">Jaccard</th><th align="left">AW</th></tr></thead><tbody><tr><td align="left">2</td><td align="left">0.876</td><td align="left">0.744</td><td align="left">0.897</td><td align="left">0.827</td><td align="left">0.704</td></tr><tr><td align="left">3</td><td align="left">0.852</td><td align="left">0.675</td><td align="left">0.789</td><td align="left">0.658</td><td align="left">0.661</td></tr><tr><td align="left">4</td><td align="left">0.872</td><td align="left">0.689</td><td align="left">0.780</td><td align="left">0.644</td><td align="left">0.644</td></tr><tr><td align="left">5</td><td align="left">0.897</td><td align="left">0.705</td><td align="left">0.773</td><td align="left">0.632</td><td align="left">0.759</td></tr><tr><td align="left">6</td><td align="left">0.920</td><td align="left">0.751</td><td align="left">0.802</td><td align="left">0.672</td><td align="left">0.768</td></tr><tr><td align="left">7</td><td align="left">0.935</td><td align="left">0.780</td><td align="left">0.820</td><td align="left">0.699</td><td align="left">0.771</td></tr><tr><td align="left">8</td><td align="left">0.931</td><td align="left">0.753</td><td align="left">0.796</td><td align="left">0.662</td><td align="left">0.700</td></tr><tr><td align="left">9</td><td align="left">0.950</td><td align="left">0.801</td><td align="left">0.830</td><td align="left">0.712</td><td align="left">0.782</td></tr><tr><td align="left">10</td><td align="left">0.966</td><td align="left">0.855</td><td align="left">0.875</td><td align="left">0.779</td><td align="left">0.861</td></tr><tr><td align="left">11</td><td align="left">0.969</td><td align="left">0.863</td><td align="left">0.881</td><td align="left">0.789</td><td align="left">0.857</td></tr><tr><td align="left">12</td><td align="left">0.973</td><td align="left">0.876</td><td align="left">0.892</td><td align="left">0.805</td><td align="left">0.878</td></tr><tr><td align="left">13</td><td align="left">0.975</td><td align="left">0.883</td><td align="left">0.897</td><td align="left">0.814</td><td align="left">0.883</td></tr><tr><td align="left">14</td><td align="left">0.979</td><td align="left">0.897</td><td align="left">0.909</td><td align="left">0.833</td><td align="left">0.914</td></tr><tr><td align="left">15</td><td align="left">0.982</td><td align="left">0.910</td><td align="left">0.920</td><td align="left">0.852</td><td align="left">0.917</td></tr><tr><td align="left">16</td><td align="left">0.985</td><td align="left">0.925</td><td align="left">0.933</td><td align="left">0.875</td><td align="left">0.931</td></tr><tr><td align="left">17</td><td align="left">0.987</td><td align="left">0.932</td><td align="left">0.940</td><td align="left">0.887</td><td align="left">0.937</td></tr><tr><td align="left">18</td><td align="left">0.988</td><td align="left">0.936</td><td align="left">0.943</td><td align="left">0.893</td><td align="left">0.939</td></tr><tr><td align="left">19</td><td align="left">0.989</td><td align="left">0.940</td><td align="left">0.946</td><td align="left">0.899</td><td align="left">0.944</td></tr><tr><td align="left">20</td><td align="left">0.988</td><td align="left">0.937</td><td align="left">0.943</td><td align="left">0.893</td><td align="left">0.933</td></tr><tr><td align="left">21</td><td align="left">0.989</td><td align="left">0.938</td><td align="left">0.945</td><td align="left">0.895</td><td align="left">0.939</td></tr><tr><td align="left">22</td><td align="left">0.990</td><td align="left">0.942</td><td align="left">0.948</td><td align="left">0.901</td><td align="left">0.940</td></tr><tr><td align="left">23</td><td align="left">0.991</td><td align="left">0.946</td><td align="left">0.951</td><td align="left">0.907</td><td align="left">0.961</td></tr><tr><td align="left">24</td><td align="left">0.992</td><td align="left">0.953</td><td align="left">0.958</td><td align="left">0.919</td><td align="left">0.965</td></tr><tr><td align="left">25</td><td align="left"><bold>0.993</bold></td><td align="left">0.958</td><td align="left">0.962</td><td align="left">0.926</td><td align="left"><bold>0.966</bold></td></tr><tr><td align="left">26</td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.959</bold></td><td align="left"><bold>0.963</bold></td><td align="left"><bold>0.929</bold></td><td align="left">0.964</td></tr><tr><td align="left">27</td><td align="left"><bold>0.993</bold></td><td align="left">0.958</td><td align="left">0.962</td><td align="left">0.928</td><td align="left">0.960</td></tr><tr><td align="left">28</td><td align="left">0.992</td><td align="left">0.955</td><td align="left">0.959</td><td align="left">0.923</td><td align="left">0.952</td></tr><tr><td align="left">29</td><td align="left">0.992</td><td align="left">0.952</td><td align="left">0.957</td><td align="left">0.920</td><td align="left">0.945</td></tr><tr><td align="left">30</td><td align="left">0.991</td><td align="left">0.940</td><td align="left">0.947</td><td align="left">0.903</td><td align="left">0.924</td></tr></tbody></table></table-wrap></p>
      <p>Three of the measures, namely, the AR, FM, and Jaccard, indicate the existence of 26 clusters; the AW indicates that <italic>k</italic>=25, and the AR indicates that <italic>k</italic>=25, 26 and 27. In this case, not all averages point to the same number of clusters <italic>k</italic>; therefore, a more careful and refined analysis is required.</p>
      <p>We complemented this analysis with the standard deviation of the AR, which is presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The minimum standard deviation of the AR is achieved for <italic>k</italic>=25, which, combined with the information provided in Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig4" ref-type="fig">4</xref>, leads to the selection of 25 clusters.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Standard deviation of Adjusted Rand (AR) versus the number of clusters. Standard deviation of AR versus number of clusters for dendrogram in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. There is a downward trend of the standard deviation when increasing the number of clusters. The minimum value is attained with 25 clusters</p></caption><graphic xlink:href="12911_2019_1013_Fig4_HTML" id="MO4"/></fig></p>
      <p>The stability of the 25 clusters was then assessed through the medians, averages and standard deviations of <italic>η</italic><sup>∗</sup>,<italic>τ</italic><sup>∗</sup> and <italic>γ</italic><sup>∗</sup> (Table <xref rid="Tab2" ref-type="table">2</xref>). As expected, the three statistic values of <italic>η</italic><sup>∗</sup> are always smaller than those of <italic>τ</italic><sup>∗</sup> and <italic>γ</italic><sup>∗</sup>. For some clusters, the medians and averages of the three measures are not as high as is desirable to consider the clusters stable. Moreover, the medians and averages of <italic>τ</italic><sup>∗</sup> and <italic>γ</italic><sup>∗</sup> are not the same in all clusters. Notwithstanding, in clusters 20,21,22,23,24, and 25 (also those with more observations), those values are the same, and they are high enough to be considered stable.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Stability of the 25 clusters for Ward’s method, <italic>g</italic>=0.7, and <italic>T</italic><sub><italic>p</italic></sub>=0.25</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster Nb.</th><th align="left"><italic>τ</italic><sup>∗</sup></th><th align="left"><italic>η</italic><sup>∗</sup></th><th align="left"><italic>γ</italic><sup>∗</sup></th><th align="left"><italic>τ</italic><sup>∗</sup></th><th align="left"><italic>η</italic><sup>∗</sup></th><th align="left"><italic>γ</italic><sup>∗</sup></th><th align="left"><italic>τ</italic><sup>∗</sup></th><th align="left"><italic>η</italic><sup>∗</sup></th><th align="left"><italic>γ</italic><sup>∗</sup></th></tr><tr><th align="left">(# patients)</th><th align="left">median</th><th align="left">median</th><th align="left">median</th><th align="left">average</th><th align="left">average</th><th align="left">average</th><th align="left">std</th><th align="left">std</th><th align="left">std</th></tr></thead><tbody><tr><td align="left">1 (4)</td><td align="left">0.475</td><td align="left">0.298</td><td align="left">0.625</td><td align="left">0.475</td><td align="left">0.298</td><td align="left">0.625</td><td align="left">0.389</td><td align="left">0.185</td><td align="left">0.177</td></tr><tr><td align="left">2 (4)</td><td align="left">0.750</td><td align="left">0.429</td><td align="left">0.750</td><td align="left">0.750</td><td align="left">0.429</td><td align="left">0.750</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.000</td></tr><tr><td align="left">3 (5)</td><td align="left">0.083</td><td align="left">0.077</td><td align="left">0.200</td><td align="left">0.083</td><td align="left">0.077</td><td align="left">0.200</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.000</td></tr><tr><td align="left">4 (5)</td><td align="left">0.400</td><td align="left">0.271</td><td align="left">0.600</td><td align="left">0.400</td><td align="left">0.271</td><td align="left">0.600</td><td align="left">0.283</td><td align="left">0.147</td><td align="left">0.000</td></tr><tr><td align="left">5 (5)</td><td align="left">0.275</td><td align="left">0.215</td><td align="left">0.500</td><td align="left">0.275</td><td align="left">0.215</td><td align="left">0.500</td><td align="left">0.035</td><td align="left">0.022</td><td align="left">0.141</td></tr><tr><td align="left">6 (6)</td><td align="left">0.833</td><td align="left">0.455</td><td align="left">0.833</td><td align="left">0.833</td><td align="left">0.455</td><td align="left">0.833</td><td align="left">0.000</td><td align="left">0.000</td><td align="left">0.000</td></tr><tr><td align="left">7 (7)</td><td align="left">0.741</td><td align="left">0.423</td><td align="left">0.786</td><td align="left">0.741</td><td align="left">0.423</td><td align="left">0.786</td><td align="left">0.164</td><td align="left">0.054</td><td align="left">0.101</td></tr><tr><td align="left">8 (7)</td><td align="left">0.307</td><td align="left">0.233</td><td align="left">0.500</td><td align="left">0.307</td><td align="left">0.233</td><td align="left">0.500</td><td align="left">0.080</td><td align="left">0.047</td><td align="left">0.101</td></tr><tr><td align="left">9 (7)</td><td align="left">0.643</td><td align="left">0.390</td><td align="left">0.643</td><td align="left">0.643</td><td align="left">0.390</td><td align="left">0.643</td><td align="left">0.101</td><td align="left">0.037</td><td align="left">0.101</td></tr><tr><td align="left">10 (8)</td><td align="left">0.688</td><td align="left">0.407</td><td align="left">0.688</td><td align="left">0.688</td><td align="left">0.407</td><td align="left">0.688</td><td align="left">0.088</td><td align="left">0.031</td><td align="left">0.088</td></tr><tr><td align="left">11 (9)</td><td align="left">0.542</td><td align="left">0.347</td><td align="left">0.611</td><td align="left">0.542</td><td align="left">0.347</td><td align="left">0.611</td><td align="left">0.177</td><td align="left">0.075</td><td align="left">0.079</td></tr><tr><td align="left">12 (9)</td><td align="left">0.389</td><td align="left">0.269</td><td align="left">0.444</td><td align="left">0.389</td><td align="left">0.269</td><td align="left">0.444</td><td align="left">0.236</td><td align="left">0.124</td><td align="left">0.157</td></tr><tr><td align="left">13 (10)</td><td align="left">0.352</td><td align="left">0.256</td><td align="left">0.400</td><td align="left">0.352</td><td align="left">0.256</td><td align="left">0.400</td><td align="left">0.145</td><td align="left">0.080</td><td align="left">0.141</td></tr><tr><td align="left">14 (10)</td><td align="left">0.489</td><td align="left">0.311</td><td align="left">0.550</td><td align="left">0.489</td><td align="left">0.311</td><td align="left">0.550</td><td align="left">0.337</td><td align="left">0.156</td><td align="left">0.354</td></tr><tr><td align="left">15 (13)</td><td align="left">0.513</td><td align="left">0.330</td><td align="left">0.577</td><td align="left">0.513</td><td align="left">0.330</td><td align="left">0.577</td><td align="left">0.254</td><td align="left">0.112</td><td align="left">0.163</td></tr><tr><td align="left">16 (13)</td><td align="left">0.472</td><td align="left">0.321</td><td align="left">0.577</td><td align="left">0.472</td><td align="left">0.321</td><td align="left">0.577</td><td align="left">0.039</td><td align="left">0.018</td><td align="left">0.054</td></tr><tr><td align="left">17 (14)</td><td align="left">0.571</td><td align="left">0.358</td><td align="left">0.571</td><td align="left">0.571</td><td align="left">0.358</td><td align="left">0.571</td><td align="left">0.202</td><td align="left">0.082</td><td align="left">0.202</td></tr><tr><td align="left">18 (16)</td><td align="left">0.719</td><td align="left">0.416</td><td align="left">0.719</td><td align="left">0.719</td><td align="left">0.416</td><td align="left">0.719</td><td align="left">0.133</td><td align="left">0.045</td><td align="left">0.133</td></tr><tr><td align="left">19 (17)</td><td align="left">0.309</td><td align="left">0.235</td><td align="left">0.353</td><td align="left">0.309</td><td align="left">0.235</td><td align="left">0.353</td><td align="left">0.084</td><td align="left">0.049</td><td align="left">0.083</td></tr><tr><td align="left">20 (19)</td><td align="left">0.716</td><td align="left">0.416</td><td align="left">0.737</td><td align="left">0.716</td><td align="left">0.416</td><td align="left">0.737</td><td align="left">0.119</td><td align="left">0.041</td><td align="left">0.149</td></tr><tr><td align="left">21 (20)</td><td align="left">0.791</td><td align="left">0.440</td><td align="left">0.825</td><td align="left">0.791</td><td align="left">0.440</td><td align="left">0.825</td><td align="left">0.154</td><td align="left">0.048</td><td align="left">0.106</td></tr><tr><td align="left">22 (32)</td><td align="left">0.696</td><td align="left">0.410</td><td align="left">0.719</td><td align="left">0.696</td><td align="left">0.410</td><td align="left">0.719</td><td align="left">0.056</td><td align="left">0.019</td><td align="left">0.088</td></tr><tr><td align="left">23 (37)</td><td align="left">0.791</td><td align="left">0.441</td><td align="left">0.811</td><td align="left">0.791</td><td align="left">0.441</td><td align="left">0.811</td><td align="left">0.104</td><td align="left">0.032</td><td align="left">0.076</td></tr><tr><td align="left">24 (46)</td><td align="left">0.728</td><td align="left">0.420</td><td align="left">0.728</td><td align="left">0.728</td><td align="left">0.420</td><td align="left">0.728</td><td align="left">0.108</td><td align="left">0.036</td><td align="left">0.108</td></tr><tr><td align="left">25 (101)</td><td align="left">0.777</td><td align="left">0.437</td><td align="left">0.777</td><td align="left">0.777</td><td align="left">0.437</td><td align="left">0.777</td><td align="left">0.007</td><td align="left">0.002</td><td align="left">0.007</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>Clusters visualization</title>
      <p>Visualization is an essential task in any clustering process since it provides an intuitive way to validate clusters. Due to the characteristics of the clustered PE sequences, we propose a graph representation that summarizes the information regarding the sequences that belong to a given cluster. Therein, each node represents a biologic drug symbol (“A” to “H”, and “Z” described above), and each edge represents a therapy switch (from one biologic drug to another). A special symbol “Z” marks the end of the sequence, signalling that from that point on there is no information regarding the therapy’s success or failure. The value on an edge is the median of the times between the corresponding drug switches in that cluster.</p>
      <p>The colour of an edge represents the transition probability from one biologic drug to another. This probability is computed by counting the number of times a switch occurs divided by the total number of transitions in that cluster. A grey scale is used for the edges in this regard. A darker edge means that the switches between the linked biologic drugs frequently occurred in that cluster.</p>
      <p>The clusters with higher stability correspond to easily interpretable therapy profiles, including monotherapies (no switches). For example, these include clusters with only etanercept (A; Cluster 25 – 101 patients), only infliximab (B; Cluster 24 – 46 patients), or minor or no switches for the majority of the patients in that group. For example, cluster with adalimumab (D; Cluster 23 – 37 patients) where some patients switch to golimumab (H), and vice-versa (Cluster 20 – 19 These clusters are represented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Less stable clusters may also provide relevant clinical information regarding the longitudinal profile of the therapy. For example, Cluster 14 (with 10 patients), defines a more elaborate structure of therapy switches, which corresponds to a more complex medical interpretation. Patients started with a TNF inhibitor agent (etanercept, A). If the patient’s therapy failed (secondary failure) after some time, then the patient can be switched to a new TNF inhibitor (adalimumab, D). After two TNF inhibitor agents failed, the patients were switched to another class of drugs. The next drug can be either a B cell antibody (rituximab, C) or an IL-6 inhibitor (tocilizumab, G). Sometimes, patients do not respond at all to the first TNF inhibitor agent (primary failure) or they can develop severe adverse reactions. In those cases, the rheumatologist can decide to go directly from etanercept (A) to tocilizumab (G) and switch the drug class earlier. This example shows a direct meaningful interpretation of the obtained clusters from a medical point of view and highlights the advantages of patient stratification using longitudinal data.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Cluster Visualization. Graph representation of selected clusters based on stability measures and clinical interpretation. Drug codes: A - Etanercept; B - Infliximab; C - Rituximab; D - Adalimumab; E - Anacinra; F - Abatacept; G - Tocilizumab; H - Golimumab. Z - Follow-up/end</p></caption><graphic xlink:href="12911_2019_1013_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We propose the AliClu, a method that combines temporal sequence alignment and agglomerative hierarchical clustering to find groups in longitudinal data containing sequences of symbols and numeric values. The AliClu includes a clustering validation strategy based on bootstrapping and uses several clustering indices, such as the (adjusted) Rand, Fowlkes–Mallows, Jaccard, and adjusted Wallace, to choose the best number of groups to consider for each particular dataset. The stability of the obtained clusters is then assessed through resampling and by using the Jaccard index, the recovery rate, and the Dice indices coefficient. The AliClu can either be run entirely automatically or in a semi-automatic way, which requires user input regarding the chosen parameters. The final clusters are depicted in graphs where each node represents a symbol, each edge (a state switch) has one number corresponding to the median time, and the weight represents the estimated conditional probability of switching.</p>
    <p>The AliClu was tested using synthetic data generated with continuous-time Markov chain models, which makes it possible to separate the sequences generated with different parameters. The AliClu was run using the Portuguese Rheumatic Diseases Register (Reuma.pt), the national database for all the rheumatic patients treated with biologic agents. In particular, the rheumatoid arthritis (RA) patients’ therapy information, including the sequence of drugs taken and their durations, was used as the input. The procedure allowed us to stratify RA patients in a clinically relevant way by creating groups of similar treatment profiles. The clusters obtained depict the treatment switches between different drugs, their median duration times and their probabilities.</p>
    <p>The AliClu provides a strategy setting, validation, and visualization procedure for the automatic clustering of temporal sequence data, and it has promising applications for patient stratification using electronic medical record (EMR) data.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: AliClu</p>
    <p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/sysbiomed/AliClu">https://github.com/sysbiomed/AliClu</ext-link></p>
    <p><bold>Operating system(s)</bold>: Platform independent</p>
    <p><bold>Programming language</bold>: Python</p>
    <p><bold>Other requirements</bold>: Python3 (in Linux or Windows) and Anaconda (in Mac OS)</p>
    <p><bold>License</bold>: Free</p>
    <p><bold>Any restrictions to use by non-academics</bold>: None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12911_2019_1013_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AR</term>
        <def>
          <p>adjusted Rand</p>
        </def>
      </def-item>
      <def-item>
        <term>AW</term>
        <def>
          <p>adjusted Wallace</p>
        </def>
      </def-item>
      <def-item>
        <term>DMARD</term>
        <def>
          <p>disease-modifying antirheumatic drugs EMR: Electronic Medical Records</p>
        </def>
      </def-item>
      <def-item>
        <term>FM</term>
        <def>
          <p>Fowlkes and Mallows</p>
        </def>
      </def-item>
      <def-item>
        <term>PE</term>
        <def>
          <p>prefix-encoded</p>
        </def>
      </def-item>
      <def-item>
        <term>RA</term>
        <def>
          <p>rheumatoid arthritis</p>
        </def>
      </def-item>
      <def-item>
        <term>TNW</term>
        <def>
          <p>Temporal Needleman-Wunsch</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12911-019-1013-7.</p>
  </sec>
  <ack>
    <p>We acknowledge all Reuma.pt contributors.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KR implemented the algorithms, performed the computational experiments and wrote the first draft of the manuscript (all authors made the required updates). HC provided the data, clinical insights and interpretation. AMC and SV conceived the study, supervised the research, generated the final results and manuscript. All authors contributed to the final draft, read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The authors acknowledge funding the Portuguese Foundation for Science and Technology (Fundação para a Ciência e a Tecnologia - FCT) under contracts INESC-ID (UID/CEC/50021/2019) and IT (UID/EEA/50008/2019), projects PREDICT (PTDC/CCI-CIF/29877/2017), PERSEIDS (PTDC/EMS-SIS/0642/2014) and NEUROCLINOMICS2 (PTDC/EEI-SII/1937/2014). The funders had no role in the design of the study, collection, analysis and interpretation of data, or writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and material</title>
    <p>AliClu is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sysbiomed/AliClu">https://github.com/sysbiomed/AliClu</ext-link>. Data from Reuma.pt are not publicly available. Synthetic data is provided along with AliClu to ease its use.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Reuma.pt was approved by the National Data Protection Board (Comissão Nacional de Proteção de Dados – CNPD, Portugal) and by the Ethics Committee of Centro Hospitalar Lisboa Norte (CHLN) - Hospital de Santa Maria (HSM), Lisbon, Portugal. Patients signed Reuma.pt’s informed and written consent.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>SV is member of the Editorial Board of BMC Bioinformatics. KR, HC, and AMC declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <mixed-citation publication-type="other">Syed H, Das AK. Temporal Needleman-Wunsch. In: 2015 IEEE International Conference on Data Science and Advanced Analytics (DSAA). IEEE: 2015. 10.1109/dsaa.2015.7344785.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A General Method Applicable to the Search for Similarities in the Amino Acid Sequence of Two Proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakoe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chiba</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>
        <source>IEEE Trans Acoust Speech Sig Process</source>
        <year>1978</year>
        <volume>26</volume>
        <fpage>43</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1109/TASSP.1978.1163055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>la Torre</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>Canonical time warping for alignment of human behavior</article-title>
        <source>Advances in Neural Information Processing Systems 22: 23rd Annual Conference on Neural Information Processing Systems 2009</source>
        <year>2009</year>
        <publisher-loc>Vancouver</publisher-loc>
        <publisher-name>Curran Associates, Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulkarni</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Evangelidis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cech</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Horaud</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Continuous action recognition based on sequence alignment</article-title>
        <source>Int J Comput Vis</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>1</issue>
        <fpage>90</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1007/s11263-014-0758-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Buhmann</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Time-series alignment by non-negative multiple generalized canonical correlation analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>10</issue>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-S10-S4</pub-id>
        <pub-id pub-id-type="pmid">17207271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McWilliam</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Remmert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</article-title>
        <source>Mol Syst Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>539</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Mafft multiple sequence alignment software version 7: Improvements in performance and usability</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Muscle: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>1792</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models,</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>755</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id>
        <pub-id pub-id-type="pmid">9918945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canhão</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Faustino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martins</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reuma.pt - The Rheumatic Diseases Portuguese Register</article-title>
        <source>Acta Reumatologica Portuguesa</source>
        <year>2011</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>56</lpage>
        <?supplied-pmid 21483280?>
        <pub-id pub-id-type="pmid">21483280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Docampo</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Collado</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Escaramís</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Carbonell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rivera</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vidal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alegre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rabionet</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Estivill</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis of clinical data identifies fibromyalgia subgroups</article-title>
        <source>PLOS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>9</issue>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0074873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>McClean</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meenan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Phase-type survival trees and mixed distribution survival trees for clustering patients’ hospital length of stay</article-title>
        <source>Informatica</source>
        <year>2011</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>72</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Axén</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bodin</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Halasz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lövgren</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Rosenbaum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leboeuf-Yde</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Clustering patients on the basis of their individual course of low back pain over a six month period</article-title>
        <source>BMC Musculoskelet Disord</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2474-12-99</pub-id>
        <pub-id pub-id-type="pmid">21586117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De la Cruz-Mesía</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quintana</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering for longitudinal data</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2008</year>
        <volume>52</volume>
        <issue>3</issue>
        <fpage>1441</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2007.04.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saxena</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bharill</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>OP</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Er</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-T</given-names>
          </name>
        </person-group>
        <article-title>A review of clustering techniques and developments</article-title>
        <source>Neurocomputing</source>
        <year>2017</year>
        <volume>267</volume>
        <fpage>664</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neucom.2017.06.053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Mucha H-J. Advances in Data Analysis In: Decker R, Lenz H-J, editors. Berlin, Heidelberg: Springer: 2007. p. 115–122.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>M. Rand</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Objective criteria for the evaluation of clustering methods</article-title>
        <source>J Am Stat Assoc</source>
        <year>1971</year>
        <volume>66</volume>
        <fpage>846</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>B. Fowlkes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mallows</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A method for comparing two hierachical clusterings</article-title>
        <source>J Am Stat Assoc</source>
        <year>1983</year>
        <volume>78</volume>
        <fpage>553</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1983.10478008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>A method for comparing two hierachical clusterings: Comment</article-title>
        <source>J Am Stat Assoc</source>
        <year>1983</year>
        <volume>78</volume>
        <fpage>569</fpage>
        <lpage>76</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
