<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10320146</article-id>
    <article-id pub-id-type="pmid">37216609</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkad428</article-id>
    <article-id pub-id-type="publisher-id">gkad428</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Human AGEs: an interactive spatio-temporal visualization and database of human archeogenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ciecierski</surname>
          <given-names>Lukasz</given-names>
        </name>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stolarek</surname>
          <given-names>Ireneusz</given-names>
        </name>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6392-0192</contrib-id>
        <name>
          <surname>Figlerowicz</surname>
          <given-names>Marek</given-names>
        </name>
        <!--marek.figlerowicz@ibch.poznan.pl-->
        <xref rid="COR1" ref-type="corresp"/>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +48 61 852 89 19; Email: <email>marek.figlerowicz@ibch.poznan.pl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>05</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-22">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>51</volume>
    <issue>W1</issue>
    <fpage>W269</fpage>
    <lpage>W273</lpage>
    <history>
      <date date-type="accepted">
        <day>12</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkad428.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Archeogenomics is a rapidly growing interdisciplinary research field driven by the development of techniques that enable the acquisition and analysis of ancient DNA (aDNA). Recent advances in aDNA studies have contributed significantly to increasing our understanding of the natural history of humans. One of the most significant challenges facing archeogenomics is the integration of highly heterogeneous genomic, archeological, and anthropological data and their comprehensive analysis, considering changes that occur in time and space. Only this complex approach can explain the relationship between past populations in the context of migration or cultural development. To address these challenges, we developed a Human AGEs web server. It focuses on creating comprehensive spatiotemporal visualizations of genomic, archeogenomic, and archeological information, which can be provided by the user or loaded from a graph database. The interactive map application at the center of Human AGEs can display multiple layers of data in various forms, such as bubble charts, pie charts, heatmaps, or tag clouds. These visualizations can be modified using various clustering, filtering, and styling options, and the map state can be exported to a high-resolution image or saved as a session file for later use. Human AGEs, along with their tutorial, are accessible at <ext-link xlink:href="https://archeogenomics.eu/" ext-link-type="uri">https://archeogenomics.eu/</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <graphic xlink:href="gkad428figgra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Polish National Science Center</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2014/12/W/NZ2/00466</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>During the last decade, ancient DNA (aDNA) research has significantly improved our understanding of the biological history of humans. Archeogenomics sheds light on a range of issues related to the origins and dispersal of modern humans across the globe, as well as to the genetic diversity and adaptations of extinct hominin species. With the development of next-generation sequencing technologies, the amount of aDNA data has increased exponentially, opening new avenues of research and leading to significant discoveries.</p>
    <p>The rapid expansion of data has shifted the character of aDNA studies from human genetics, mainly using fragments of mitochondrial DNA, to population genomics fueled by thousands of genome-wide datasets, nearly complete mitochondrial genome assemblies, and detailed descriptions of Y-chromosome lineages (<xref rid="B2" ref-type="bibr">2–6</xref>). Furthermore, it is becoming increasingly clear that the archeological context of the studied human remains is also of high importance in the field.</p>
    <p>Collectively, these results make the human archeogenomic data extremely complex. Their transdisciplinary character means that they should be accessible to representatives of both life sciences and humanists. However, despite the immense growth of the aDNA field and the huge interest in society, there is no web server that provides a convenient spatiotemporal analysis of archeogenomic data.</p>
    <p>Because of this unsatisfied demand, we present the Human <underline>A</underline>rcheo<underline>GE</underline>nomic<underline>s</underline> (Human AGEs) web server for archeogenomic data visualization and interactive analysis.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Web server</title>
      <p>Human AGEs is hosted on a Linux-based Nginx HTTP server. We used Nodejs web application server for back-end development and the Pug.js template engine, SASS stylesheet, and JavaScript programming languages for front-end development. To create the main visualization features, we applied OpenLayers geographic and Plotly charting libraries. Human AGEs loading time was reduced using static content hosting Content Delivery Network (CDN) services. Moreover, we applied Webpack module bundler to optimize the website files and increase compatibility with older browsers. More information regarding the software is provided in the Supplementary Data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Data sources</title>
      <p>The Human AGEs web server hosts several publicly available genomic and archeogenomic datasets. These include the Allen Ancient DNA Resource (AADR) v54.1 (<ext-link xlink:href="https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data" ext-link-type="uri">https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data"</ext-link>, version 54.1.p1) and EMPOP v4/R13 dataset (<xref rid="B1" ref-type="bibr">1</xref>) (<ext-link xlink:href="https://empop.online/" ext-link-type="uri">https://empop.online/</ext-link>, version 4). AADR data consists of genome-wide data across 1.2M single-nucleotide polymorphism (SNP) positions, Y-chromosome, and mitochondrial genome haplogroup assignments. The EMPOP dataset consists of the present-day mitochondrial genome haplogroup assignments.</p>
      <p>Additionally, to showcase Human AGEs visualization capabilities, we hosted precomputed PCA and UMAP embeddings of AADR samples as well as the proportions of admixture components calculated from <italic toggle="yes">k</italic> = 2 to <italic toggle="yes">k</italic> = 13 (Supplementary Methods). We also provide a source of archeological data in the form of manually-curated archeological culture regions (<italic toggle="yes">N</italic> = 109), which are available for visualization on the interactive map.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Graph database</title>
      <p>Published genomic data sources were incorporated into our graph database powered by Neo4j. The database was populated using Neo4j import methods and custom-made scripts. To facilitate a connection between the web application and graph database, we used Apollo server. To enable graph query calls and graph data exchange between the client and the Human AGEs server, we used GraphQL API.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>General description of the human AGEs server</title>
      <p>Human AGEs is a web server dedicated to the interactive visualization of archeogenomic data. Its two main features are (i) an interactive spatio-temporal map and (ii) a graph database. The Human AGEs server is publicly available and free to use. It does not depend on cookie files and does not block any content by requiring user login credentials. The web server was tested on Firefox v. 110.0 and Chrome v. 110.0 browsers on Windows and Linux systems.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Input and output data</title>
      <p>To load present-day genomic or archeogenomic data for visualization, users can either upload their own input files (Figure <xref rid="F1" ref-type="fig">1F</xref>) or use one of the data sources stored in our graph database (Figure <xref rid="F1" ref-type="fig">1G</xref>). In the first case, the user can upload an input file in CSV or JSON format. In addition to mandatory sample ID and coordinates, it is possible to use one of the available data types to include information regarding the Y chromosome (Y-)DNA and mitochondrial (mt)DNA haplogroup assignments, results of admixture analysis, UMAP or PCA embeddings, and custom data attributes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
      <p>In the second case, users can load either a present-day genomic or archeogenomic dataset by choosing one of the data sources available in the Human AGEs graph database. Its content can be limited by the multiple filters defined in our query builder (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). The data source names and filters together produce a JSON query call, which is a unique identifier of the dataset and can be safely used as a reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>).</p>
      <p>All loaded datasets can be downloaded using the download button of the dataset (Figure <xref rid="F1" ref-type="fig">1H</xref>). With the map toolbox (Figure <xref rid="F1" ref-type="fig">1A</xref>), the current map view can be saved as an image in one of the following formats: JPG, PNG and PDF.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Interactive map application interface. (<bold>A</bold>) The toolkit menu contains map appearance options and an export-to-image feature. (<bold>B</bold>) Samples cluster map marker. (<bold>C</bold>) The timeline filter and range sliders are used to navigate through data in the dimension of time. (<bold>D</bold>) Dynamic legend shows currently visible map layers and style applied to data attributes. (<bold>E</bold>) Section containing map state import and export options. There is also an option to load example sessions. (<bold>F</bold>) Section providing options to load user dataset. (<bold>G</bold>) Section providing graph database query builder, a text box containing the query JSON string, and an option to call the database. (<bold>H</bold>) Section listing loaded datasets together with their download and sampling options. The datasets can be removed by drag-and-drop interaction. (<bold>I</bold>) Section consisting of spatial clustering and attributes grouping features. (<bold>J</bold>) Section with options of time, attribute and region filters. (<bold>K</bold>) List of created map layers. It is possible to create new layers, clone existing ones, or remove them.</p>
        </caption>
        <graphic xlink:href="gkad428fig1" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>Session file</title>
      <p>Session is a powerful utility that can be treated as both the input and output of the Human AGEs web server. This enables users to save their entire interactive map state to a human-readable JSON session file (Figure <xref rid="F1" ref-type="fig">1E</xref>). This file contains the map state and all previously set configurations (that is, data filters and attribute colors), which can later be shared and restored.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Interactive map</title>
      <p>The interactive map application is the main feature of the Human AGEs server. Samples are represented on the map as markers that can be hovered, selected, or dragged (Figure <xref rid="F1" ref-type="fig">1B</xref>). Double-clicking a marker will open its details window listing all selected samples and their attributes (that is, admixture proportions, haplogroup assignments, visualization on UMAP or PCA plot). The map is supported by an interactive timeline, dynamic legend, and other useful features, such as zoom control, map scale and title. The timeline consists of two draggable intervals (Figure <xref rid="F1" ref-type="fig">1C</xref>). The first is the time filter, which controls the data sample visibility owing to their dating. The second is the time range, which sets a lower and upper bound for the filter values.</p>
      <p>The legend displays the style of the visible map layers, data attributes and archeological cultures (Figure <xref rid="F1" ref-type="fig">1D</xref>). The style is represented by a symbol on the left of a name, and it can be modified in the menu by clicking. The legend is dynamic; it updates with changes made to the data or map, for example, by limiting lists of attributes and regions to only those visible in a current map view. Finally, the map appearance can be changed using options in the map toolbox. Available modifications include basemap type and style, map feature visibility, and appearance.</p>
    </sec>
    <sec id="SEC3-5">
      <title>Data clustering</title>
      <p>The aim of the clustering feature is to generalize the visualization by reducing data resolution. This can be achieved in two ways: with spatial clustering aggregating samples by their position, or with attribute clustering, which allows the creation of groups of attribute values (Figure <xref rid="F1" ref-type="fig">1I</xref>).</p>
      <p>Spatial clustering operates in two distinct modes that can be combined. First, it can group samples based on their absolute (kilometers) or relative (pixels) distance to another randomly chosen sample serving as a central point. Second, it assigns samples to the same cluster if they lie within the same region. For this, we provide different regional sets of geographical, political, and archeological types. The latter includes archeological cultures and, unlike the others, the territory of these regions changes dynamically with a time filter.</p>
      <p>Attribute clustering can be performed manually or automatically. Manual clustering requires the user to select the attribute values from a dedicated browser, and add them to a new or existing group by providing its name. Automatic clustering options are available only for tree-based attributes such as haplogroups. They allow the creation of a group of ancestor or descendant haplogroups in relation to a given haplogroup, group more specific haplogroups to their ancestors at a given cutoff tree level, and assign haplogroups to a group named after their root words of a given length. All the created attribute groups can be modified, expanded, removed, or filtered at later stages through attribute filtering options.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Data filtering</title>
      <p>Filtering aims to simplify the visualization by narrowing its scope. This can be achieved by filtering objects by time, attribute values or region names (Figure <xref rid="F1" ref-type="fig">1J</xref>).</p>
      <p>Time filtering is mostly facilitated by the map timeline; however, exact filter interval numbers can be input manually for better precision. In addition, this filter is supported by options concerning performance optimization and the object visibility fading function to enhance visualization customization.</p>
      <p>Attribute filtering can be simultaneously applied to multiple attributes at the same time. Its main feature is filtering samples by the attribute's value name or presence. Moreover, some attribute types have unique sets of options. Tree-based attribute values (that is, haplogroup assignment) can be filtered by their distance from the root of the tree. Admixture attribute filters can discard samples based on the proportions of particular admixture components.</p>
      <p>The last is region filtering, which can exclude already visible regions and their clustered samples according to the name of a region.</p>
    </sec>
    <sec id="SEC3-7">
      <title>Data styling</title>
      <p>Dataset samples can be visualized using four types of map layers: (i–ii) the points and heatmap types are suitable for general presentation of the distribution of the samples; (iii–iv) the piecharts and tag clouds allow additional visualization of the content and frequencies of the given attribute's values present in the samples (Figure 1K; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>).</p>
      <p>Map layers have a wide range of sample cluster styling options, including cluster position offset and rotation; cluster size, which is dependent on sample count; filtering out low-frequency or missing values; and layer-specific options concerning piechart labels or tag clouds’ word spacing. Map layers and attributes are uniquely indicated by a single adjustable color, or in the case of heatmaps, the color gradient. Additionally, archeological cultures can be styled using colored patterns.</p>
    </sec>
    <sec id="SEC3-8">
      <title>Example use case</title>
      <p>Out of Africa is one of the most recognized hypotheses regarding human genesis and dispersal. Although the introduction of the latest DNA evidence caused some disagreements concerning the exact time, migration paths, and potential interactions with archaic hominins, the main aspects of the hypothesis remain valid: approximately 70 000 years ago, East African hunter-gatherers spread through the Arabian Peninsula, populating the rest of the globe. It was proposed that the African origin of modern humans can be inferred from the genetic mtDNA diversity of the present-day population. To verify this, we visualized contemporary mt haplogroup distribution using EMPOP samples clustered in continent regions. Sample mtDNA haplogroups were assigned to one of the ancestral groups in sequence: L3, L4, L6, L2, L5, L1 and L0 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). Additional examples are available at: <ext-link xlink:href="https://archeogenomics.eu/en/examples" ext-link-type="uri">https://archeogenomics.eu/en/examples</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>The explosion of archeogenomic studies is of significant interest in the biological history of humans and has resulted in numerous difficulties with presenting and analyzing the data due to their size, complexity, and interdisciplinary character.</p>
    <p>To the best of our knowledge, there is no web server dedicated to customizable archeogenomic visualizations that addresses uniparental haplogroups and genome-wide data in anthropological and archeological contexts. The most similar tools include AmtDB (<xref rid="B7" ref-type="bibr">7</xref>), EMPOP and AncientGenomes (<ext-link xlink:href="https://ancientgenomes.com/" ext-link-type="uri">https://ancientgenomes.com/</ext-link>). The first one is dedicated to aDNA data; however, it focuses only on mtDNA, and features are limited to simple data filtering and visualizing sample locations on a basic map, which cannot be customized. However, the database has the option of downloading selected entities. It also allows for time filtering and provides a wide range of sample metadata that serve as the attributes to be filtered.</p>
    <p>The EMPOP database has a large suite of analysis tools, phylogenetic trees, and network construction. A useful feature also includes the visualization of the selected mtDNA haplogroup frequency in the form of a heatmap. However, it is also dedicated only to mtDNA and only to present-day samples.</p>
    <p>The AncientGenomes is another web application dedicated to spatio-temporal aDNA data presentation. It contains both mtDNA and Y-DNA haplogroups for ancient samples as well as spatial distribution of archeological cultures and ancient language families. It also dynamically presents information about major historical events, which is a valuable educational asset. The application, however, is mainly presentational, as it does not provide any attribute filtering options, the samples can only be presented as points and there are no options regarding their customization apart from possibility to toggle event, cultural or linguistic layers on and off.</p>
    <p>Additional resources to study aDNA have been created by the scientific community members but yet unpublished. The features of Human AGEs webserver and other similar web applications were compared in more detail in Supplementary Data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>).</p>
    <p>Therefore, Human AGEs is the first comprehensive web server dedicated to aDNA. It provides a wide range of interactive tools to filter and analyze various types of data with respect to their spatial or temporal distribution.</p>
    <sec id="SEC4-1">
      <title>Limitations and perspectives</title>
      <p>On the Human AGEs web server, all of the interactive map computations occur on the client side; thus, the visualization performance is strongly dependent on the user's hardware. Moreover, Human AGEs focus solely on the visualization of endpoint genomic and archeogenomic results. In addition, it does not provide the possibility of running sophisticated bioinformatic analyses of genomic data. We also emphasize that, currently, our graph database lacks any downloadable nucleotide sequence data. However, Human AGEs were built using powerful open-source software to ensure the ease of introducing new features and expanding the graph database content.</p>
      <p>First, we plan to expand the range of data presentation methods, including more layer types (histograms and phylogenetic trees) and data styling options (marking map layers with symbols and attributes with colored patterns). Moreover, we intend to introduce a feature for creating custom clustering regions using polygon-drawing tools or by providing an input GeoJSON file. The map utility for placing user-defined shapes, bitmaps, and text boxes together to serve as visualization annotation is also considered. Lastly, we aim to develop a feature for creating GIF animations showing the distribution of samples and their genomic traits changing over time.</p>
      <p>Regarding the graph database, we plan to keep it up-to-date with new versions of already integrated data sources. We also plan to incorporate the kinship information determined for archaic samples, develop a separate tabular data browser for more traditional exploration, and extend the capabilities of our query builder.</p>
    </sec>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>Human AGEs is freely available at <ext-link xlink:href="https://archeogenomics.eu/" ext-link-type="uri">https://archeogenomics.eu/</ext-link>. Instructions on how to use the web server were provided in the guide accessible at <ext-link xlink:href="https://archeogenomics.eu/en/map" ext-link-type="uri">https://archeogenomics.eu/en/map</ext-link>. Web server source code is available at: <ext-link xlink:href="https://github.com/wooksh/Human_AGEs" ext-link-type="uri">https://github.com/wooksh/Human_AGEs</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkad428_Supplemental_File</label>
      <media xlink:href="gkad428_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkad428#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Polish National Science Center [2014/12/W/NZ2/00466]. Funding for open access charge: Institute of Bioorganic Chemistry, Polish Academy of Sciences.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parson</surname><given-names>W.</given-names></string-name>, <string-name><surname>Dür</surname><given-names>A.</given-names></string-name></person-group><article-title>EMPOP–a forensic mtDNA database</article-title>. <source>Forensic Sci. Int. Genet.</source><year>2007</year>; <volume>1</volume>:<fpage>88</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">19083735</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stolarek</surname><given-names>I.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Handschuh</surname><given-names>L.</given-names></string-name>, <string-name><surname>Marcinkowska-Swojak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Philips</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zenczak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dębski</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kóčka-Krenz</surname><given-names>H.</given-names></string-name>, <string-name><surname>Piontek</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kozlowski</surname><given-names>P.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A mosaic genetic structure of the human population living in the South Baltic region during the Iron Age</article-title>. <source>Sci. Rep.</source><year>2018</year>; <volume>8</volume>:<fpage>2455</fpage>.<pub-id pub-id-type="pmid">29410482</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stolarek</surname><given-names>I.</given-names></string-name>, <string-name><surname>Handschuh</surname><given-names>L.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Nowaczewska</surname><given-names>W.</given-names></string-name>, <string-name><surname>Kóčka-Krenz</surname><given-names>H.</given-names></string-name>, <string-name><surname>Michalowski</surname><given-names>A.</given-names></string-name>, <string-name><surname>Piontek</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kozlowski</surname><given-names>P.</given-names></string-name>, <string-name><surname>Figlerowicz</surname><given-names>M.</given-names></string-name></person-group><article-title>Goth migration induced changes in the matrilineal genetic structure of the central-east European population</article-title>. <source>Sci. Rep.</source><year>2019</year>; <volume>9</volume>:<fpage>6737</fpage>.<pub-id pub-id-type="pmid">31043639</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gretzinger</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sayer</surname><given-names>D.</given-names></string-name>, <string-name><surname>Justeau</surname><given-names>P.</given-names></string-name>, <string-name><surname>Altena</surname><given-names>E.</given-names></string-name>, <string-name><surname>Pala</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dulias</surname><given-names>K.</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>C.J.</given-names></string-name>, <string-name><surname>Jodoin</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lacher</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sabin</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The Anglo-Saxon migration and the formation of the early English gene pool</article-title>. <source>Nature</source>. <year>2022</year>; <volume>610</volume>:<fpage>112</fpage>–<lpage>119</lpage>.<pub-id pub-id-type="pmid">36131019</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Posth</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hajdinjak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Petr</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mallick</surname><given-names>S.</given-names></string-name>, <string-name><surname>Fernandes</surname><given-names>D.</given-names></string-name>, <string-name><surname>Furtwängler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Haak</surname><given-names>W.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mittnik</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The genetic history of Ice Age Europe</article-title>. <source>Nature</source>. <year>2016</year>; <volume>534</volume>:<fpage>200</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">27135931</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haak</surname><given-names>W.</given-names></string-name>, <string-name><surname>Lazaridis</surname><given-names>I.</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>N.</given-names></string-name>, <string-name><surname>Rohland</surname><given-names>N.</given-names></string-name>, <string-name><surname>Mallick</surname><given-names>S.</given-names></string-name>, <string-name><surname>Llamas</surname><given-names>B.</given-names></string-name>, <string-name><surname>Brandt</surname><given-names>G.</given-names></string-name>, <string-name><surname>Nordenfelt</surname><given-names>S.</given-names></string-name>, <string-name><surname>Harney</surname><given-names>E.</given-names></string-name>, <string-name><surname>Stewardson</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Massive migration from the steppe was a source for Indo-European languages in Europe</article-title>. <source>Nature</source>. <year>2015</year>; <volume>522</volume>:<fpage>207</fpage>–<lpage>211</lpage>.<pub-id pub-id-type="pmid">25731166</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ehler</surname><given-names>E.</given-names></string-name>, <string-name><surname>Novotný</surname><given-names>J.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Chyleński</surname><given-names>M.</given-names></string-name>, <string-name><surname>Moravčík</surname><given-names>O.</given-names></string-name>, <string-name><surname>Pačes</surname><given-names>J.</given-names></string-name></person-group><article-title>AmtDB: a database of ancient human mitochondrial genomes</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>D29</fpage>–<lpage>D32</lpage>.<pub-id pub-id-type="pmid">30247677</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10320146</article-id>
    <article-id pub-id-type="pmid">37216609</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkad428</article-id>
    <article-id pub-id-type="publisher-id">gkad428</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Human AGEs: an interactive spatio-temporal visualization and database of human archeogenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ciecierski</surname>
          <given-names>Lukasz</given-names>
        </name>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stolarek</surname>
          <given-names>Ireneusz</given-names>
        </name>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6392-0192</contrib-id>
        <name>
          <surname>Figlerowicz</surname>
          <given-names>Marek</given-names>
        </name>
        <!--marek.figlerowicz@ibch.poznan.pl-->
        <xref rid="COR1" ref-type="corresp"/>
        <aff><institution>Institute of Bioorganic Chemistry, Polish Academy of Sciences</institution>, <addr-line>Poznan</addr-line>, <country country="PL">Poland</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +48 61 852 89 19; Email: <email>marek.figlerowicz@ibch.poznan.pl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>05</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-22">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>51</volume>
    <issue>W1</issue>
    <fpage>W269</fpage>
    <lpage>W273</lpage>
    <history>
      <date date-type="accepted">
        <day>12</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkad428.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Archeogenomics is a rapidly growing interdisciplinary research field driven by the development of techniques that enable the acquisition and analysis of ancient DNA (aDNA). Recent advances in aDNA studies have contributed significantly to increasing our understanding of the natural history of humans. One of the most significant challenges facing archeogenomics is the integration of highly heterogeneous genomic, archeological, and anthropological data and their comprehensive analysis, considering changes that occur in time and space. Only this complex approach can explain the relationship between past populations in the context of migration or cultural development. To address these challenges, we developed a Human AGEs web server. It focuses on creating comprehensive spatiotemporal visualizations of genomic, archeogenomic, and archeological information, which can be provided by the user or loaded from a graph database. The interactive map application at the center of Human AGEs can display multiple layers of data in various forms, such as bubble charts, pie charts, heatmaps, or tag clouds. These visualizations can be modified using various clustering, filtering, and styling options, and the map state can be exported to a high-resolution image or saved as a session file for later use. Human AGEs, along with their tutorial, are accessible at <ext-link xlink:href="https://archeogenomics.eu/" ext-link-type="uri">https://archeogenomics.eu/</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <graphic xlink:href="gkad428figgra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Polish National Science Center</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2014/12/W/NZ2/00466</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>During the last decade, ancient DNA (aDNA) research has significantly improved our understanding of the biological history of humans. Archeogenomics sheds light on a range of issues related to the origins and dispersal of modern humans across the globe, as well as to the genetic diversity and adaptations of extinct hominin species. With the development of next-generation sequencing technologies, the amount of aDNA data has increased exponentially, opening new avenues of research and leading to significant discoveries.</p>
    <p>The rapid expansion of data has shifted the character of aDNA studies from human genetics, mainly using fragments of mitochondrial DNA, to population genomics fueled by thousands of genome-wide datasets, nearly complete mitochondrial genome assemblies, and detailed descriptions of Y-chromosome lineages (<xref rid="B2" ref-type="bibr">2–6</xref>). Furthermore, it is becoming increasingly clear that the archeological context of the studied human remains is also of high importance in the field.</p>
    <p>Collectively, these results make the human archeogenomic data extremely complex. Their transdisciplinary character means that they should be accessible to representatives of both life sciences and humanists. However, despite the immense growth of the aDNA field and the huge interest in society, there is no web server that provides a convenient spatiotemporal analysis of archeogenomic data.</p>
    <p>Because of this unsatisfied demand, we present the Human <underline>A</underline>rcheo<underline>GE</underline>nomic<underline>s</underline> (Human AGEs) web server for archeogenomic data visualization and interactive analysis.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Web server</title>
      <p>Human AGEs is hosted on a Linux-based Nginx HTTP server. We used Nodejs web application server for back-end development and the Pug.js template engine, SASS stylesheet, and JavaScript programming languages for front-end development. To create the main visualization features, we applied OpenLayers geographic and Plotly charting libraries. Human AGEs loading time was reduced using static content hosting Content Delivery Network (CDN) services. Moreover, we applied Webpack module bundler to optimize the website files and increase compatibility with older browsers. More information regarding the software is provided in the Supplementary Data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Data sources</title>
      <p>The Human AGEs web server hosts several publicly available genomic and archeogenomic datasets. These include the Allen Ancient DNA Resource (AADR) v54.1 (<ext-link xlink:href="https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data" ext-link-type="uri">https://reich.hms.harvard.edu/allen-ancient-dna-resource-aadr-downloadable-genotypes-present-day-and-ancient-dna-data"</ext-link>, version 54.1.p1) and EMPOP v4/R13 dataset (<xref rid="B1" ref-type="bibr">1</xref>) (<ext-link xlink:href="https://empop.online/" ext-link-type="uri">https://empop.online/</ext-link>, version 4). AADR data consists of genome-wide data across 1.2M single-nucleotide polymorphism (SNP) positions, Y-chromosome, and mitochondrial genome haplogroup assignments. The EMPOP dataset consists of the present-day mitochondrial genome haplogroup assignments.</p>
      <p>Additionally, to showcase Human AGEs visualization capabilities, we hosted precomputed PCA and UMAP embeddings of AADR samples as well as the proportions of admixture components calculated from <italic toggle="yes">k</italic> = 2 to <italic toggle="yes">k</italic> = 13 (Supplementary Methods). We also provide a source of archeological data in the form of manually-curated archeological culture regions (<italic toggle="yes">N</italic> = 109), which are available for visualization on the interactive map.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Graph database</title>
      <p>Published genomic data sources were incorporated into our graph database powered by Neo4j. The database was populated using Neo4j import methods and custom-made scripts. To facilitate a connection between the web application and graph database, we used Apollo server. To enable graph query calls and graph data exchange between the client and the Human AGEs server, we used GraphQL API.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>General description of the human AGEs server</title>
      <p>Human AGEs is a web server dedicated to the interactive visualization of archeogenomic data. Its two main features are (i) an interactive spatio-temporal map and (ii) a graph database. The Human AGEs server is publicly available and free to use. It does not depend on cookie files and does not block any content by requiring user login credentials. The web server was tested on Firefox v. 110.0 and Chrome v. 110.0 browsers on Windows and Linux systems.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Input and output data</title>
      <p>To load present-day genomic or archeogenomic data for visualization, users can either upload their own input files (Figure <xref rid="F1" ref-type="fig">1F</xref>) or use one of the data sources stored in our graph database (Figure <xref rid="F1" ref-type="fig">1G</xref>). In the first case, the user can upload an input file in CSV or JSON format. In addition to mandatory sample ID and coordinates, it is possible to use one of the available data types to include information regarding the Y chromosome (Y-)DNA and mitochondrial (mt)DNA haplogroup assignments, results of admixture analysis, UMAP or PCA embeddings, and custom data attributes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
      <p>In the second case, users can load either a present-day genomic or archeogenomic dataset by choosing one of the data sources available in the Human AGEs graph database. Its content can be limited by the multiple filters defined in our query builder (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). The data source names and filters together produce a JSON query call, which is a unique identifier of the dataset and can be safely used as a reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>).</p>
      <p>All loaded datasets can be downloaded using the download button of the dataset (Figure <xref rid="F1" ref-type="fig">1H</xref>). With the map toolbox (Figure <xref rid="F1" ref-type="fig">1A</xref>), the current map view can be saved as an image in one of the following formats: JPG, PNG and PDF.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Interactive map application interface. (<bold>A</bold>) The toolkit menu contains map appearance options and an export-to-image feature. (<bold>B</bold>) Samples cluster map marker. (<bold>C</bold>) The timeline filter and range sliders are used to navigate through data in the dimension of time. (<bold>D</bold>) Dynamic legend shows currently visible map layers and style applied to data attributes. (<bold>E</bold>) Section containing map state import and export options. There is also an option to load example sessions. (<bold>F</bold>) Section providing options to load user dataset. (<bold>G</bold>) Section providing graph database query builder, a text box containing the query JSON string, and an option to call the database. (<bold>H</bold>) Section listing loaded datasets together with their download and sampling options. The datasets can be removed by drag-and-drop interaction. (<bold>I</bold>) Section consisting of spatial clustering and attributes grouping features. (<bold>J</bold>) Section with options of time, attribute and region filters. (<bold>K</bold>) List of created map layers. It is possible to create new layers, clone existing ones, or remove them.</p>
        </caption>
        <graphic xlink:href="gkad428fig1" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>Session file</title>
      <p>Session is a powerful utility that can be treated as both the input and output of the Human AGEs web server. This enables users to save their entire interactive map state to a human-readable JSON session file (Figure <xref rid="F1" ref-type="fig">1E</xref>). This file contains the map state and all previously set configurations (that is, data filters and attribute colors), which can later be shared and restored.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Interactive map</title>
      <p>The interactive map application is the main feature of the Human AGEs server. Samples are represented on the map as markers that can be hovered, selected, or dragged (Figure <xref rid="F1" ref-type="fig">1B</xref>). Double-clicking a marker will open its details window listing all selected samples and their attributes (that is, admixture proportions, haplogroup assignments, visualization on UMAP or PCA plot). The map is supported by an interactive timeline, dynamic legend, and other useful features, such as zoom control, map scale and title. The timeline consists of two draggable intervals (Figure <xref rid="F1" ref-type="fig">1C</xref>). The first is the time filter, which controls the data sample visibility owing to their dating. The second is the time range, which sets a lower and upper bound for the filter values.</p>
      <p>The legend displays the style of the visible map layers, data attributes and archeological cultures (Figure <xref rid="F1" ref-type="fig">1D</xref>). The style is represented by a symbol on the left of a name, and it can be modified in the menu by clicking. The legend is dynamic; it updates with changes made to the data or map, for example, by limiting lists of attributes and regions to only those visible in a current map view. Finally, the map appearance can be changed using options in the map toolbox. Available modifications include basemap type and style, map feature visibility, and appearance.</p>
    </sec>
    <sec id="SEC3-5">
      <title>Data clustering</title>
      <p>The aim of the clustering feature is to generalize the visualization by reducing data resolution. This can be achieved in two ways: with spatial clustering aggregating samples by their position, or with attribute clustering, which allows the creation of groups of attribute values (Figure <xref rid="F1" ref-type="fig">1I</xref>).</p>
      <p>Spatial clustering operates in two distinct modes that can be combined. First, it can group samples based on their absolute (kilometers) or relative (pixels) distance to another randomly chosen sample serving as a central point. Second, it assigns samples to the same cluster if they lie within the same region. For this, we provide different regional sets of geographical, political, and archeological types. The latter includes archeological cultures and, unlike the others, the territory of these regions changes dynamically with a time filter.</p>
      <p>Attribute clustering can be performed manually or automatically. Manual clustering requires the user to select the attribute values from a dedicated browser, and add them to a new or existing group by providing its name. Automatic clustering options are available only for tree-based attributes such as haplogroups. They allow the creation of a group of ancestor or descendant haplogroups in relation to a given haplogroup, group more specific haplogroups to their ancestors at a given cutoff tree level, and assign haplogroups to a group named after their root words of a given length. All the created attribute groups can be modified, expanded, removed, or filtered at later stages through attribute filtering options.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Data filtering</title>
      <p>Filtering aims to simplify the visualization by narrowing its scope. This can be achieved by filtering objects by time, attribute values or region names (Figure <xref rid="F1" ref-type="fig">1J</xref>).</p>
      <p>Time filtering is mostly facilitated by the map timeline; however, exact filter interval numbers can be input manually for better precision. In addition, this filter is supported by options concerning performance optimization and the object visibility fading function to enhance visualization customization.</p>
      <p>Attribute filtering can be simultaneously applied to multiple attributes at the same time. Its main feature is filtering samples by the attribute's value name or presence. Moreover, some attribute types have unique sets of options. Tree-based attribute values (that is, haplogroup assignment) can be filtered by their distance from the root of the tree. Admixture attribute filters can discard samples based on the proportions of particular admixture components.</p>
      <p>The last is region filtering, which can exclude already visible regions and their clustered samples according to the name of a region.</p>
    </sec>
    <sec id="SEC3-7">
      <title>Data styling</title>
      <p>Dataset samples can be visualized using four types of map layers: (i–ii) the points and heatmap types are suitable for general presentation of the distribution of the samples; (iii–iv) the piecharts and tag clouds allow additional visualization of the content and frequencies of the given attribute's values present in the samples (Figure 1K; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>).</p>
      <p>Map layers have a wide range of sample cluster styling options, including cluster position offset and rotation; cluster size, which is dependent on sample count; filtering out low-frequency or missing values; and layer-specific options concerning piechart labels or tag clouds’ word spacing. Map layers and attributes are uniquely indicated by a single adjustable color, or in the case of heatmaps, the color gradient. Additionally, archeological cultures can be styled using colored patterns.</p>
    </sec>
    <sec id="SEC3-8">
      <title>Example use case</title>
      <p>Out of Africa is one of the most recognized hypotheses regarding human genesis and dispersal. Although the introduction of the latest DNA evidence caused some disagreements concerning the exact time, migration paths, and potential interactions with archaic hominins, the main aspects of the hypothesis remain valid: approximately 70 000 years ago, East African hunter-gatherers spread through the Arabian Peninsula, populating the rest of the globe. It was proposed that the African origin of modern humans can be inferred from the genetic mtDNA diversity of the present-day population. To verify this, we visualized contemporary mt haplogroup distribution using EMPOP samples clustered in continent regions. Sample mtDNA haplogroups were assigned to one of the ancestral groups in sequence: L3, L4, L6, L2, L5, L1 and L0 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). Additional examples are available at: <ext-link xlink:href="https://archeogenomics.eu/en/examples" ext-link-type="uri">https://archeogenomics.eu/en/examples</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>The explosion of archeogenomic studies is of significant interest in the biological history of humans and has resulted in numerous difficulties with presenting and analyzing the data due to their size, complexity, and interdisciplinary character.</p>
    <p>To the best of our knowledge, there is no web server dedicated to customizable archeogenomic visualizations that addresses uniparental haplogroups and genome-wide data in anthropological and archeological contexts. The most similar tools include AmtDB (<xref rid="B7" ref-type="bibr">7</xref>), EMPOP and AncientGenomes (<ext-link xlink:href="https://ancientgenomes.com/" ext-link-type="uri">https://ancientgenomes.com/</ext-link>). The first one is dedicated to aDNA data; however, it focuses only on mtDNA, and features are limited to simple data filtering and visualizing sample locations on a basic map, which cannot be customized. However, the database has the option of downloading selected entities. It also allows for time filtering and provides a wide range of sample metadata that serve as the attributes to be filtered.</p>
    <p>The EMPOP database has a large suite of analysis tools, phylogenetic trees, and network construction. A useful feature also includes the visualization of the selected mtDNA haplogroup frequency in the form of a heatmap. However, it is also dedicated only to mtDNA and only to present-day samples.</p>
    <p>The AncientGenomes is another web application dedicated to spatio-temporal aDNA data presentation. It contains both mtDNA and Y-DNA haplogroups for ancient samples as well as spatial distribution of archeological cultures and ancient language families. It also dynamically presents information about major historical events, which is a valuable educational asset. The application, however, is mainly presentational, as it does not provide any attribute filtering options, the samples can only be presented as points and there are no options regarding their customization apart from possibility to toggle event, cultural or linguistic layers on and off.</p>
    <p>Additional resources to study aDNA have been created by the scientific community members but yet unpublished. The features of Human AGEs webserver and other similar web applications were compared in more detail in Supplementary Data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>).</p>
    <p>Therefore, Human AGEs is the first comprehensive web server dedicated to aDNA. It provides a wide range of interactive tools to filter and analyze various types of data with respect to their spatial or temporal distribution.</p>
    <sec id="SEC4-1">
      <title>Limitations and perspectives</title>
      <p>On the Human AGEs web server, all of the interactive map computations occur on the client side; thus, the visualization performance is strongly dependent on the user's hardware. Moreover, Human AGEs focus solely on the visualization of endpoint genomic and archeogenomic results. In addition, it does not provide the possibility of running sophisticated bioinformatic analyses of genomic data. We also emphasize that, currently, our graph database lacks any downloadable nucleotide sequence data. However, Human AGEs were built using powerful open-source software to ensure the ease of introducing new features and expanding the graph database content.</p>
      <p>First, we plan to expand the range of data presentation methods, including more layer types (histograms and phylogenetic trees) and data styling options (marking map layers with symbols and attributes with colored patterns). Moreover, we intend to introduce a feature for creating custom clustering regions using polygon-drawing tools or by providing an input GeoJSON file. The map utility for placing user-defined shapes, bitmaps, and text boxes together to serve as visualization annotation is also considered. Lastly, we aim to develop a feature for creating GIF animations showing the distribution of samples and their genomic traits changing over time.</p>
      <p>Regarding the graph database, we plan to keep it up-to-date with new versions of already integrated data sources. We also plan to incorporate the kinship information determined for archaic samples, develop a separate tabular data browser for more traditional exploration, and extend the capabilities of our query builder.</p>
    </sec>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>Human AGEs is freely available at <ext-link xlink:href="https://archeogenomics.eu/" ext-link-type="uri">https://archeogenomics.eu/</ext-link>. Instructions on how to use the web server were provided in the guide accessible at <ext-link xlink:href="https://archeogenomics.eu/en/map" ext-link-type="uri">https://archeogenomics.eu/en/map</ext-link>. Web server source code is available at: <ext-link xlink:href="https://github.com/wooksh/Human_AGEs" ext-link-type="uri">https://github.com/wooksh/Human_AGEs</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkad428_Supplemental_File</label>
      <media xlink:href="gkad428_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkad428#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Polish National Science Center [2014/12/W/NZ2/00466]. Funding for open access charge: Institute of Bioorganic Chemistry, Polish Academy of Sciences.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parson</surname><given-names>W.</given-names></string-name>, <string-name><surname>Dür</surname><given-names>A.</given-names></string-name></person-group><article-title>EMPOP–a forensic mtDNA database</article-title>. <source>Forensic Sci. Int. Genet.</source><year>2007</year>; <volume>1</volume>:<fpage>88</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">19083735</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stolarek</surname><given-names>I.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Handschuh</surname><given-names>L.</given-names></string-name>, <string-name><surname>Marcinkowska-Swojak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Philips</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zenczak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dębski</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kóčka-Krenz</surname><given-names>H.</given-names></string-name>, <string-name><surname>Piontek</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kozlowski</surname><given-names>P.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A mosaic genetic structure of the human population living in the South Baltic region during the Iron Age</article-title>. <source>Sci. Rep.</source><year>2018</year>; <volume>8</volume>:<fpage>2455</fpage>.<pub-id pub-id-type="pmid">29410482</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stolarek</surname><given-names>I.</given-names></string-name>, <string-name><surname>Handschuh</surname><given-names>L.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Nowaczewska</surname><given-names>W.</given-names></string-name>, <string-name><surname>Kóčka-Krenz</surname><given-names>H.</given-names></string-name>, <string-name><surname>Michalowski</surname><given-names>A.</given-names></string-name>, <string-name><surname>Piontek</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kozlowski</surname><given-names>P.</given-names></string-name>, <string-name><surname>Figlerowicz</surname><given-names>M.</given-names></string-name></person-group><article-title>Goth migration induced changes in the matrilineal genetic structure of the central-east European population</article-title>. <source>Sci. Rep.</source><year>2019</year>; <volume>9</volume>:<fpage>6737</fpage>.<pub-id pub-id-type="pmid">31043639</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gretzinger</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sayer</surname><given-names>D.</given-names></string-name>, <string-name><surname>Justeau</surname><given-names>P.</given-names></string-name>, <string-name><surname>Altena</surname><given-names>E.</given-names></string-name>, <string-name><surname>Pala</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dulias</surname><given-names>K.</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>C.J.</given-names></string-name>, <string-name><surname>Jodoin</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lacher</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sabin</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The Anglo-Saxon migration and the formation of the early English gene pool</article-title>. <source>Nature</source>. <year>2022</year>; <volume>610</volume>:<fpage>112</fpage>–<lpage>119</lpage>.<pub-id pub-id-type="pmid">36131019</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Posth</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hajdinjak</surname><given-names>M.</given-names></string-name>, <string-name><surname>Petr</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mallick</surname><given-names>S.</given-names></string-name>, <string-name><surname>Fernandes</surname><given-names>D.</given-names></string-name>, <string-name><surname>Furtwängler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Haak</surname><given-names>W.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mittnik</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The genetic history of Ice Age Europe</article-title>. <source>Nature</source>. <year>2016</year>; <volume>534</volume>:<fpage>200</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">27135931</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haak</surname><given-names>W.</given-names></string-name>, <string-name><surname>Lazaridis</surname><given-names>I.</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>N.</given-names></string-name>, <string-name><surname>Rohland</surname><given-names>N.</given-names></string-name>, <string-name><surname>Mallick</surname><given-names>S.</given-names></string-name>, <string-name><surname>Llamas</surname><given-names>B.</given-names></string-name>, <string-name><surname>Brandt</surname><given-names>G.</given-names></string-name>, <string-name><surname>Nordenfelt</surname><given-names>S.</given-names></string-name>, <string-name><surname>Harney</surname><given-names>E.</given-names></string-name>, <string-name><surname>Stewardson</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Massive migration from the steppe was a source for Indo-European languages in Europe</article-title>. <source>Nature</source>. <year>2015</year>; <volume>522</volume>:<fpage>207</fpage>–<lpage>211</lpage>.<pub-id pub-id-type="pmid">25731166</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ehler</surname><given-names>E.</given-names></string-name>, <string-name><surname>Novotný</surname><given-names>J.</given-names></string-name>, <string-name><surname>Juras</surname><given-names>A.</given-names></string-name>, <string-name><surname>Chyleński</surname><given-names>M.</given-names></string-name>, <string-name><surname>Moravčík</surname><given-names>O.</given-names></string-name>, <string-name><surname>Pačes</surname><given-names>J.</given-names></string-name></person-group><article-title>AmtDB: a database of ancient human mitochondrial genomes</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>D29</fpage>–<lpage>D32</lpage>.<pub-id pub-id-type="pmid">30247677</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
