<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6880518</article-id>
    <article-id pub-id-type="publisher-id">3092</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3092-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Potential based, spatial simulation of dynamically nested particles</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Köster</surname>
          <given-names>Till</given-names>
        </name>
        <address>
          <email>till.koester@uni-rostock.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Henning</surname>
          <given-names>Philipp</given-names>
        </name>
        <address>
          <email>philipp.henning@uni-rostock.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Uhrmacher</surname>
          <given-names>Adelinde M.</given-names>
        </name>
        <address>
          <email>adelinde.uhrmacher@uni-rostock.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000000121858338</institution-id><institution-id institution-id-type="GRID">grid.10493.3f</institution-id><institution>Institute of Computer Science, University of Rostock, </institution></institution-wrap>Albert-Einstein-Straße 22, Rostock, 18059 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>607</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">To study cell biological phenomena which depend on diffusion, active transport processes, or the locations of species, modeling and simulation studies need to take space into account. To describe the system as a collection of discrete objects moving and interacting in continuous space, various particle-based reaction diffusion simulators for cell-biological system have been developed. So far the focus has been on particles as solid spheres or points. However, spatial dynamics might happen at different organizational levels, such as proteins, vesicles or cells with interrelated dynamics which requires spatial approaches that take this multi-levelness of cell biological systems into account.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Based on the perception of particles forming hollow spheres, ML-Force contributes to the family of particle-based simulation approaches: in addition to excluded volumes and forces, it also supports compartmental dynamics and relating dynamics between different organizational levels explicitly. Thereby, compartmental dynamics, e.g., particles entering and leaving other particles, and bimolecular reactions are modeled using pair-wise potentials (forces) and the Langevin equation. In addition, forces that act independently of other particles can be applied to direct the movement of particles. Attributes and the possibility to define arbitrary functions on particles, their attributes and content, to determine the results and kinetics of reactions add to the expressiveness of ML-Force. Its implementation comprises a rudimentary rule-based embedded domain-specific modeling language for specifying models and a simulator for executing models continuously. Applications inspired by cell biological models from literature, such as vesicle transport or yeast growth, show the value of the realized features. They facilitate capturing more complex spatial dynamics, such as the fission of compartments or the directed movement of particles, and enable the integration of non-spatial intra-compartmental dynamics as stochastic events.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">By handling all dynamics based on potentials (forces) and the Langevin equation, compartmental dynamics, such as dynamic nesting, fusion and fission of compartmental structures are handled continuously and are seamlessly integrated with traditional particle-based reaction-diffusion dynamics within the cell. Thereby, attributes and arbitrary functions allow to flexibly describe diverse spatial phenomena, and relate dynamics across organizational levels. Also they prove crucial in modeling intra-cellular or intra-compartmental dynamics in a non-spatial manner, and, thus, to abstract from spatial dynamics, on demand which increases the range of multi-compartmental processes that can be captured.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Space</kwd>
      <kwd>Simulation</kwd>
      <kwd>Nesting</kwd>
      <kwd>Force</kwd>
      <kwd>Multi-level</kwd>
      <kwd>Modeling</kwd>
      <kwd>Attributed</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UH-66/13</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UH-66/13</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SFB 1270</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Space plays an important role in cell biological dynamics, such as cell signalling [<xref ref-type="bibr" rid="CR1">1</xref>]. To study cell biological phenomena which depend on diffusion, active transport processes, or the locations of species, modeling and simulation studies need to take space into account. Over the last decade, a variety of spatial modeling and simulation methods and tools has been developed to support these simulation studies. They offer different approaches how to describe a spatial model, e.g., reaction-based, rule-based, or graphically, and they differ referring to what kind of spatial dynamics can be described, e.g., whether concentrations, populations, or individual particles are considered, whether a deterministic or stochastic approach is pursued, and whether movement takes place in discretized or continuous space [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. The kind of spatial dynamics that are supported by tools largely determines the results and questions that can be answered by a simulation study [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>] and has been subject to different categorizations to structure the portfolio of spatial simulation methods from which the user can select.</p>
    <p><sc>TAKAHASHI</sc> et al. [<xref ref-type="bibr" rid="CR7">7</xref>] distinguished spatial simulation approaches according to the representation of space. We adopt this structuring and slightly adapt it for the purpose of this paper as presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. We distinguish between:
<list list-type="order"><list-item><p>Stochastic non-spatial dynamics: To take the stochasticity of the modelled system into account, the propensity of reactions are sampled from exponential distributions and determine which reaction will occur at which time [<xref ref-type="bibr" rid="CR9">9</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Representations of space which is based on and slightly adapts Figure 1 of [<xref ref-type="bibr" rid="CR7">7</xref>]. We distinguish between (<bold>a</bold>) stochastic non spatial dynamics, (<bold>b</bold>) compartmental dynamics, (<bold>c</bold>) individual particles moving in continuous space, (<bold>d</bold>) partial differential equations, and (<italic>e</italic>) spatial stochastic dynamics. Type (<italic>c</italic>) individual particles moving in continuous space is further described by four levels, according to <sc>SCHöNEBERG</sc> et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Each level builds upon the capabilities of the underlying ones, thus the representation as a pyramid. For example a method that provides excluded volumes should conceptually also be able to provide free diffusion and confined diffusion. ML-Force is characterized by a-b-c(4)</p></caption><graphic xlink:href="12859_2019_3092_Fig1_HTML" id="MO1"/></fig>
</p></list-item><list-item><p>Compartmental dynamics: Many tools allow to constrain the dynamics of species to specific compartments. However also, compartments themselves can be subject to dynamics. For example, compartments can fuse and divide [<xref ref-type="bibr" rid="CR10">10</xref>].</p></list-item><list-item><p>Individual particles moving in continuous space: Particles can be identified by their unique position in space, bimolecular reactions are triggered by collisions of particles, and typically particles diffuse by Brownian motion [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p></list-item><list-item><p>Partial differential equations: Spatial gradients of concentrations are calculated deterministically [<xref ref-type="bibr" rid="CR13">13</xref>].</p></list-item><list-item><p>Spatial stochastic dynamics: Multiple particles can occupy a position within a lattice space, and diffuse between neighboring positions [<xref ref-type="bibr" rid="CR14">14</xref>].</p></list-item></list></p>
    <p>Particle-based approaches (in the above categorization <italic>c)</italic>) are the subject of a further categorization suggested by <sc>SCHöNEBERG</sc> et al. [<xref ref-type="bibr" rid="CR8">8</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, right lower corner). Spatial particle-based simulation tools are categorized into those that support
<list list-type="bullet"><list-item><p><italic>level 1 – free diffusion</italic>: basic 3D diffusion of point particles and reactions between them are considered,</p></list-item><list-item><p><italic>level 2 – confined diffusion</italic>: diffusion can be constrained to compartments,</p></list-item><list-item><p><italic>level 3 – excluded volume</italic>: point particles are replaced by volumetric entities, and</p></list-item><list-item><p><italic>level 4 – potentials for particle-particle interaction</italic>: instead of a simple rejection of movements assuming rigid cells, potentials are used to determine the interaction of particles in terms of exclusion of movement or reactions.</p></list-item></list></p>
    <p>According to this categorization [<xref ref-type="bibr" rid="CR8">8</xref>], Smoldyn is characterised as <italic>level 2</italic> particle-based approach: point particles which do not hamper each others movement are equipped with binding and unbinding radii, they can be constrained to compartments. A more recent version includes collision strategies to reach <italic>level 3</italic> [<xref ref-type="bibr" rid="CR15">15</xref>]. SpringSaLaD [<xref ref-type="bibr" rid="CR16">16</xref>], ReaDDy [<xref ref-type="bibr" rid="CR17">17</xref>], and SRSim [<xref ref-type="bibr" rid="CR18">18</xref>] are based on forces to model the particle-particle interactions (<italic>level 4</italic>). Still, the levels introduced do not imply that a tool that supports <italic>level 3</italic> provides all interesting features that a tool working at <italic>level 2</italic> offers to study the system of interest. E.g., <sc>DONOVAN</sc> [<xref ref-type="bibr" rid="CR19">19</xref>], whose spatial simulation works at <italic>level 2</italic>, supports arbitrarily complex 3D mesh geometries, whereas in ML-Space [<xref ref-type="bibr" rid="CR20">20</xref>] (<italic>level 3</italic>) only rigid spheres are considered.</p>
    <p>Merging both characterizations, approaches that combine different spatial representations can be characterized. The Two-Regime method [<xref ref-type="bibr" rid="CR21">21</xref>] and <sc>KLANN</sc> et al. [<xref ref-type="bibr" rid="CR22">22</xref>] allow to combine particle and RDME dynamics within one model: <italic>c(3)-e</italic>. Similarly in [<xref ref-type="bibr" rid="CR23">23</xref>], particles and partial differential equations are combined to focus on the spatial region of interest: <italic>c(3)-d</italic>. [<xref ref-type="bibr" rid="CR24">24</xref>] couples a partial differential equations solver and Smoldyn <italic>c(2)-d</italic>. ML-Space combines particles at <italic>level 3</italic> (as excluded volumes are considered), compartmental dynamics, and spatial, stochastic simulation (RDME): <italic>b-c(3)-e</italic> [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>In addition, simulation environments offer the possibility to select different spatial semantics for one model specification. For example, in VCELL [<xref ref-type="bibr" rid="CR13">13</xref>], rule-based models can be interpreted by a particle-based simulator (i.e., Smoldyn) or a partial differential equation solver, both confined to realistically geometrical compartmental structures (<italic>c(2)</italic>, <italic>d</italic>). This list is far from being complete, and the characterization of the simulation tools may only depict a specific state in their development.</p>
    <p>Against this background, we propose a new spatial particle-based modeling and simulation approach for cell biological systems, i.e., <italic>ML-Force</italic> (Fig <xref rid="Fig1" ref-type="fig">1</xref>). It combines:
<list list-type="bullet"><list-item><p><italic>Potential-based particle dynamics</italic>: The excluded volumes that are represented by the large amount of macro-molecules within the cell affect the physico-chemical kinetics of various intracellular processes [<xref ref-type="bibr" rid="CR25">25</xref>]. To capture the effects of molecular crowding, space exclusions need to be considered. In addition, interactions based on potentials are an effective means to study the formation of clusters [<xref ref-type="bibr" rid="CR18">18</xref>]. Additionally, potentials allow us to capture directed movements, such as the transport of vesicles [<xref ref-type="bibr" rid="CR26">26</xref>] (see “<xref rid="Sec16" ref-type="sec">Results</xref>” section). Similar to ReaDDy [<xref ref-type="bibr" rid="CR17">17</xref>], SRSim [<xref ref-type="bibr" rid="CR18">18</xref>], or SpringSaLaD [<xref ref-type="bibr" rid="CR16">16</xref>], ML-Force will use potentials for particle-particle interaction: <italic>c(4)</italic>.</p></list-item><list-item><p><italic>Compartmental dynamics</italic>: Intra-cellular space is further structured by compartments and vesicles, most of which are subject to frequent changes in terms of numbers, content, and inter-connectivity. A prominent example is the endosomal system. Vesicles form at the membrane. Here they acquire their cargo and engulf protein receptor complexes. Those are transported towards the inner cell, where part is degraded and part is recycled. The vesicles themselves move through stages of early sorting, recycling to late endosomes, closely interacting with each other – processes which include frequent fission and fusion [<xref ref-type="bibr" rid="CR26">26</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). ML-Force uses the same force-based approach that it uses for the interaction of particles and global force functions, to model the compartmental dynamics. Similar to ML-Space, ML-Force supports both: compartmental and particle dynamics. However, unlike ML-Space it uses potentials <italic>b-c(4)</italic>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustration (combined from [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]) of a receptor-ligand binding kinetics, which includes receptor protein coupling, internalization, and recycling, whose components can be interpreted as nested arrangements of objects within objects that interact at intersection points, can be approximated to spherical particles of various sizes, move in continuous space and undergo processes of creation, degradation, internalization, externalization, fusion, and fission. <bold>a</bold> Biological view, <bold>b</bold> Hollow spheres view</p></caption><graphic xlink:href="12859_2019_3092_Fig2_HTML" id="MO2"/></fig>
</p></list-item><list-item><p><italic>Rule-based approach with arbitrary attributes and functions</italic>: As other spatial simulators, ML-Force supports rule-based modeling [<xref ref-type="bibr" rid="CR29">29</xref>]. However in ML-Force, attributes are not constrained to a finite set of values. Similarly, as in ML-Rules [<xref ref-type="bibr" rid="CR30">30</xref>], attributes are of arbitrary type and arbitrary functions are supported to determine the result and kinetics of reactions. The possibility to define attributed species and arbitrary functions increases significantly the expressiveness of a modeling formalism [<xref ref-type="bibr" rid="CR31">31</xref>]. It allows to express spatial stochastic models (RDME) on a lattice (<italic>e</italic>) within a modeling approach that relies on a standard stochastic simulation algorithm for execution (<italic>a</italic>). By attributing species with indices that locate them in a specific point in the lattice (which represent a subvolume), e.g., <italic>A</italic>(<italic>x</italic>,<italic>y</italic>),<italic>B</italic>(<italic>x</italic>,<italic>y</italic>), reactions can be constrained to species within one subvolume, e.g., <italic>A</italic>(<italic>x</italic><sub><italic>a</italic></sub>,<italic>y</italic><sub><italic>a</italic></sub>)+<italic>B</italic>(<italic>x</italic><sub><italic>b</italic></sub>,<italic>y</italic><sub><italic>b</italic></sub>)→2 <italic>B</italic>(<italic>x</italic><sub><italic>b</italic></sub>,<italic>y</italic><sub><italic>b</italic></sub>)<italic>@</italic> if <italic>x</italic><sub><italic>a</italic></sub>=<italic>x</italic><sub><italic>b</italic></sub>∧<italic>y</italic><sub><italic>a</italic></sub>=<italic>y</italic><sub><italic>b</italic></sub> then <italic>k</italic> else 0. Furthermore diffusion between neighboring subvolumes can be defined, e.g., <italic>B</italic>(<italic>x</italic><sub><italic>b</italic></sub>,<italic>y</italic><sub><italic>b</italic></sub>)→<italic>B</italic>(oneOf((<italic>x</italic>+1,<italic>y</italic>),(<italic>h</italic>−1,<italic>y</italic>),(<italic>x</italic>,<italic>y</italic>+1),(<italic>x</italic>,<italic>y</italic>−1)))<italic>@</italic><italic>k</italic><sub><italic>d</italic></sub>. Thus, attributed species and arbitrary functions can be used to add space to otherwise non-spatial approaches. This is an observation also made in colored <sc>Petri</sc>-Nets [<xref ref-type="bibr" rid="CR32">32</xref>] and in expressive rule-based modeling languages such as ML-Rules [<xref ref-type="bibr" rid="CR30">30</xref>].</p><p>In ML-Force, equipping particles with attributes and arbitrary functions allows e.g. to describe some part of the cellular dynamics in a non-spatial manner. For example, the reaction <italic>B</italic>+<italic>C</italic>→<italic>D</italic>
<italic>@</italic>
<italic>k</italic> which takes place in particle A can be transformed into a non-spatial stochastic first order reaction (<italic>a</italic>). Therefore, the particle <italic>A</italic> is equipped with the corresponding attributes and a reaction is defined <italic>A</italic>(<italic>b</italic>,<italic>c</italic>)→<italic>A</italic>(<italic>d</italic>) <italic>@</italic>
<italic>b</italic>·<italic>c</italic>·<italic>k</italic>. The function <italic>b</italic>·<italic>c</italic>·<italic>k</italic> calculates the propensity of the reaction to take place. The possibility to constrain reactions based on arbitrary functions defined on the attributes, allows us to include non-spatial stochastic dynamics (<italic>a</italic>) which brings ML-Force up to <italic>a-b-c(4)</italic> (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p>ML-Force adopts a rule-based approach to specify the spatial biochemical dynamics. Firstly the mathematical concepts and abstractions are presented. This is followed by a short description of its implementation and embedded domain-specific modeling language.</p>
    <sec id="Sec3">
      <title>Mathematical concepts and abstractions</title>
      <p>As the name suggests, forces are central in ML-Force: they govern the interactions between and most of the activity of particles in a continuous manner. This is in contrast to the discrete event view chosen by simulators such as ML-Space or other agent-based approaches which interpret compartmental dynamics such as the proliferation of cells as discrete events [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <sec id="Sec4">
        <title>Representation of particles</title>
        <p>ML-Force is a particle-based approach. Particles represent <italic>hollow spheres</italic>. As particles can contain other particles, they can be used to model cellular compartments. Particles are spherically symmetric and deformable, their size, properties and nested content may vary. Particles <italic>p</italic><sub><italic>m</italic></sub> are categorized into classes called <italic>species</italic>: <italic>p</italic><sub><italic>m</italic></sub>∈<italic>S</italic><sub><italic>i</italic></sub>. Species are characterized by a set of arbitrary attributes, <italic>S</italic>(<italic>a</italic><sub>1</sub>,…<italic>a</italic><sub><italic>n</italic></sub>), e.g., radius, phosphorylation sites, or phases. In our implementation of ML-Force we require particles to have at least the attributes radius <italic>r</italic> (non-zero) and density <italic>ρ</italic>. The information about its radius together with information about the system’s temperature and the viscosity of its environment allows to derive the diffusion coefficient of a particle. In combination with the density, this information is used to determine the actual velocity (see “<xref rid="Sec5" ref-type="sec">Spatial propagation</xref>” section). Particles may contain other particles, <italic>p</italic><sub><italic>m</italic></sub>(<italic>v</italic><sub>1</sub>,…<italic>v</italic><sub><italic>n</italic></sub>)[<italic>p</italic><sub><italic>j</italic></sub>+…+<italic>p</italic><sub><italic>k</italic></sub>]. All particles belonging to one class share the same attributes and attribute-types. Attribute values and content of particles may vary among particles of the same species. The interactions between and the activity of particles is governed by rules of behavior that operate on the particles, their attributes and their content. They rely on arbitrary functions for accessing and updating attributes and content of particles. Particles belonging to the same species share the same behavioral patterns.</p>
      </sec>
      <sec id="Sec5">
        <title>Spatial propagation</title>
        <p>For particles to interact they need to be in close proximity. In ML-Force, we base our model of propagation on the <sc>LANGEVIN</sc> equation [<xref ref-type="bibr" rid="CR34">34</xref>]
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ m_{i}\boldsymbol{\ddot{x}}_{\boldsymbol{i}}(t) = -\gamma {\boldsymbol{\dot{x}}}_{\boldsymbol{i}}(t) + \boldsymbol{f}(t) + \boldsymbol{F}_{\text{ext}}(\boldsymbol{x}_{i},t)\,{,}  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¨</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>with the dot denoting time derivative and boldness indicating vectors. A Langevin equation is an ordinary differential equation with a random term added. This equation can be intuitively understood as an extension to <sc>NEWTON</sc>’s <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {F}(\boldsymbol {x},t)=m\boldsymbol {\ddot {x}}(t)$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¨</mml:mo></mml:mover></mml:mstyle><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq1.gif"/></alternatives></inline-formula> by adding both friction (friction coefficient <italic>γ</italic>) which is linear to the velocity and a random force <bold><italic>f</italic></bold> which describes the accumulated effect of the system interaction with the individual particle. This interaction between the particles and the system results in the diffusion of the particles. In particular <bold><italic>f</italic></bold> is commonly sampled from a Gaussian distribution to model the aggregate system behavior.</p>
        <p>Values for the constants involved can generally be found using known equations like <sc>STOKES-EINSTEIN</sc> relation (<inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ D_{i} =\frac {k_{B}T}{\gamma _{i}} =\frac {k_{B}T}{6\pi \eta r_{i}}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mi>πη</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq2.gif"/></alternatives></inline-formula>), as well as system properties like viscosity <italic>η</italic>.</p>
        <p>The <bold><italic>F</italic></bold><sub>ext</sub>(<bold><italic>x</italic></bold>,<italic>t</italic>) expression is the sum of all external forces on a particle. Two types of external forces are distinguished:
<list list-type="bullet"><list-item><p>global forces are those, that act on one particle, independent of other particles. Global forces functions may be specified as arbitrary functions of the individual particle state (most importantly its position) and the global state of the simulator. This may be used to model, for example, some global current in a blood stream or some other directed cellular motion (as is done in “<xref rid="Sec18" ref-type="sec">A model of vesicular transport</xref>” section below).</p></list-item><list-item><p>pair-wise forces are those, that originate in the interaction of two particles like the non-reaction force (Eq. <xref rid="Equ2" ref-type="">2</xref>), reaction force (Eq. <xref rid="Equ8" ref-type="">7</xref>) or a division force (Eq. <xref rid="Equ7" ref-type="">6</xref>).</p></list-item></list></p>
      </sec>
      <sec id="Sec6">
        <title>Non-reactive force</title>
        <p>In order to model excluded volumes, we introduce a soft sphere potential between two non-reacting particles. This is a common and natural way to model excluded volumes in force-based approaches. In addition, a hard-sphere potential would imply more efforts numerically, as it would lead to a discontinuous force. An established choice for the modeling of elastic (soft-sphere) collision is the <sc>HERTZ</sc> collision theory [<xref ref-type="bibr" rid="CR35">35</xref>]:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  F_{non-react}(d)=\frac{4}{3}E^{*}\sqrt{r\cdot d^{3}}  $$ \end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">non</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">react</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msqrt><mml:mrow><mml:mi>r</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>d</italic> is the overlap of the particles, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E^{*} = \left (\frac {1-\nu _{1}^{2}}{E_{1}}+\frac {1-\nu _{2}^{2}}{E_{2}}\right)^{-1}$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq3.gif"/></alternatives></inline-formula> results from the <sc>YOUNG’S</sc> modulus <italic>E</italic> and <sc>POISSON’S</sc> ratio <italic>ν</italic> and <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r =\left (\frac {1}{r_{1}}+\frac {1}{r_{2}}\right)^{-1}$\end{document}</tex-math><mml:math id="M12"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq4.gif"/></alternatives></inline-formula> from their radii. However, for many sparse applications, any kind of polynomial would suffice, as the exact dynamics of the elastic collision do not matter, when the mean time between collisions is sufficiently large.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Reactions in mL-Force</title>
      <p>Reactions between particles in ML-Force include zero, first and second order reactions. ML-Force supports a rule-based description of models. Whereas lower order reactions are sampled from an exponential distribution, second order reactions are calculated, similarly as the movement of particles, based on forces.</p>
      <sec id="Sec8">
        <title>Lower order reactions</title>
        <p>Simulation of zeroth and first order reaction, e.g., ⊥→<italic>p</italic><sub><italic>j</italic></sub>, or <italic>p</italic><sub><italic>i</italic></sub>→<italic>p</italic><italic>i</italic>′, or <italic>p</italic><sub><italic>i</italic></sub>→<italic>p</italic><sub><italic>j</italic></sub>+<italic>p</italic><sub><italic>k</italic></sub> is a well understood problem (e.g., in SpringSaLaT [<xref ref-type="bibr" rid="CR16">16</xref>]). The most basic approach is to sample the rate every (sufficiently small) time-step and check it against a random number.</p>
        <p>In ML-Force, rates can be defined by arbitrary functions that access the attributes and contents of the particles involved in a reaction, e.g., for a first order reaction:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{}{\begin{aligned} p_{i}(v_{1},\ldots v_{n})[p_{1} + \ldots + p_{m}] \rightarrow \ldots @ \lambda (k, v_{1},\ldots v_{n},[p_{1},\ldots,p_{m}]) \enspace. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>→</mml:mo><mml:mo>…</mml:mo><mml:mi>@λ</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>here <italic>λ</italic> denotes a function defined by the user, <italic>k</italic> a parameter, which might refer to the system globally, e.g., in terms of temperature and viscosity, or to a kinetic constant. The result of the function <italic>λ</italic> serves as the parameter for the exponential random distribution, that describes the probability density of the time until the reaction occurs. Thus in ML-Force, zero and first order reactions are treated semantically the same as in stochastic simulation algorithms [<xref ref-type="bibr" rid="CR9">9</xref>]. In stochastic, non-spatial and spatial, simulation approaches (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and e) exponentially distributed stochastic events form the basis of all, including second order, reactions.</p>
        <p>In ML-Force the rate is sampled every time step. Instead of propagating the simulation until the exact time point a reaction occurs, we check (stochastically), if the reaction occurs in the current time step. Sampling the rate every time step is useful if the information (<italic>v</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>,[<italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>m</italic></sub>]), on which the rates depend, frequently changes. If this information remains largely constant over time, a scheduling approach may be more efficient computationally, as events do not have to be rescheduled frequently [<xref ref-type="bibr" rid="CR36">36</xref>]. In executing ML-Force models so far, zeroth and first order reactions have only been responsible for a small fraction of the required computing-time.</p>
        <p>In addition to computational considerations, the error introduced by this procedure needs to be considered. Due to the discretization of time (explicit time steps) no-more than one reaction per particle may take place per time step. This is important to keep in mind for future models. In the application domain the mean time between reactions tend to be large compared to the very small time steps that result from the fast diffusion of particles. As long as this is the case, the error is negligible. With resonable technical effort, this problem could also be avoided by allowing multiple reactions per time step.</p>
        <p>One kind of lower order reaction is the changing of particle size, in terms of a particle’s radius <italic>r</italic>. In ML-Force arbitrary functions can be applied. The new value of the radius <italic>r</italic>, i.e., <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v^{\prime }_{1}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq5.gif"/></alternatives></inline-formula>, of a particle <italic>p</italic><sub><italic>i</italic></sub>∈<italic>S</italic><sub><italic>j</italic></sub>(<italic>r</italic>,…) is calculated in dependence of some global parameters <italic>k</italic>, and the current state of the particle in terms of its attribute values <italic>v</italic><sub>1</sub>,…<italic>v</italic><sub><italic>n</italic></sub>, and its content <italic>p</italic><sub>1</sub>…<italic>p</italic><sub><italic>m</italic></sub>, such that
<disp-formula id="Equ4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{\begin{aligned} &amp;p_{i}(v_{1},\ldots v_{n})[p_{1} + \ldots + p_{m}] \\ &amp;\rightarrow p_{i}(\lambda (k,v_{1},\ldots v_{n},[p_{1},\ldots,p_{m}]), v_{2} \ldots,v_{n}) [p_{1} + \ldots + p_{m}] \ldots @ \lambda (\ldots) \enspace. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>…</mml:mo><mml:mi>@λ</mml:mi><mml:mo>(</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>By default, whenever a particle is created, it is first put into the system as a very small particle and then quickly grows continuously to its desired size. This continuous change of particle radii is also used, whenever the radius of a particle is changed in the model by any kind of reaction. Carrying the changes out suddenly (so not slowly over multiple integration steps) would potentially lead to integration errors, especially in systems with nesting. A sudden change in size could for example lead to a high particle overlap, which in turn would create a high unrealistic potential energy leading to a strong force and thus a disturbance in the system, e.g., numerical heating. Slow changes in size, allow for each artificial change in energy to slowly dissipate e.g., in friction due to the numerically very stable Langevin model. Naturally, it is also possible to create a particle within or at the surface of another particle. Those new positions are chosen randomly. At the surface this means that the new particle’s shell barely touches the old particle’s shell.</p>
      </sec>
      <sec id="Sec9">
        <title>Compartment division</title>
        <p>An interesting kind of first order reaction is that of a cellular compartment (or specifically a cell) dividing.
<disp-formula id="Equ5"><label>4</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{}{\begin{aligned} p_{i}(v_{1},\ldots v_{n})[p_{1} + \ldots + p_{m}] \rightarrow p_{i1}\left(\lambda_{11} (y), \ldots,\lambda_{n1} (y)\right)\left[\lambda_{c1} (y)\right] \\ + p_{i2}\left(\lambda_{12} (y), \ldots, \lambda_{n2} (y)\right)\left[\lambda_{c2} (y)\right] \qquad @ \lambda (\ldots), \{ a \} \, {,} \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mspace width="2em"/><mml:mi>@λ</mml:mi><mml:mo>(</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>}</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>with <italic>y</italic>=<italic>k</italic>,<italic>v</italic><sub>1</sub>,…<italic>v</italic><sub><italic>n</italic></sub>,[<italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>m</italic></sub>] or in shorthand, omitting attributes and contained particles
<disp-formula id="Equ6"><label>5</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  p_{i} \to p_{i1}+p_{i2} @ \lambda (\ldots), \{ a \} \enspace.  $$ \end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>@λ</mml:mi><mml:mo>(</mml:mo><mml:mo>…</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>}</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>In ML-Force this is realized in a continuous and nesting compatible manner. As a first order reaction, the event that the division starts is sampled from an exponential distribution. The simulator temporarily introduces an “ignoring” relation between particles. This can be best explained using an example: Imagine a particle <italic>p</italic><sub><italic>i</italic></sub> containing many particles <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{1} \ldots \hat {p}_{m}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq6.gif"/></alternatives></inline-formula>. If now the reaction for <italic>p</italic><sub><italic>i</italic></sub> to split into <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> triggers, a few things happen. First of all, each particle <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{1} \ldots \hat {p}_{m}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq7.gif"/></alternatives></inline-formula> gets assigned to remain in either <italic>p</italic><sub><italic>i</italic>1</sub> or <italic>p</italic><sub><italic>i</italic>2</sub>. By default, this assignment happens randomly. If required by the model, a specific splitting function may be specified by the user. Therefore, two arbitrary functions, i.e., <italic>λ</italic><sub><italic>c</italic>1</sub>,<italic>λ</italic><sub><italic>c</italic>2</sub> are applied. The results of these applications form the new content of the newly generated particles, i.e., <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> respectively. The functions <italic>λ</italic><sub><italic>i</italic>1</sub> to <italic>λ</italic><sub><italic>n</italic>1</sub>, respectively <italic>λ</italic><sub><italic>i</italic>2</sub> to <italic>λ</italic><sub><italic>n</italic>2</sub> determine the new attribute values of the particles. If attribute values remain the same, simply the old values <italic>v</italic><sub><italic>i</italic></sub> can be used.</p>
        <p>Each <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{i}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq8.gif"/></alternatives></inline-formula> that will remain in <italic>p</italic><sub><italic>i</italic>1</sub> is set to ignore the particle <italic>p</italic><sub><italic>i</italic>2</sub> and vice versa. Also <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> are set to ignore one another. Now an external force is applied to push <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> apart
<disp-formula id="Equ7"><label>6</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  F_{\text{divison}} = m_{i}\cdot a_{\text{division}} \enspace.  $$ \end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext>divison</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mtext>division</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The force is calculated based on the acceleration <italic>a</italic> that is part of this particular reaction type (Eq.: <xref rid="Equ5" ref-type="">4</xref>, <xref rid="Equ6" ref-type="">5</xref>) in ML-Force and the mass of the involved particles (which again depend on the respective radii and their density <italic>ρ</italic>). This is chosen, instead of a uniform force, to create a uniform motion of all particles. In principle however, any force expression suitable to the model could be used here, like a half sine wave for example. Once <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> are fully outside one another, all the newly introduced ignore relations are removed and regular propagation proceeds.</p>
        <p>The principle of continuous change in particle size also applies here. At the beginning both particles have the same size. If <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> are to change their size throughout the division (see example in “<xref rid="Sec19" ref-type="sec">The yeast model</xref>” section), this change is carried out throughout the division process. Initially, both <italic>p</italic><sub><italic>i</italic>1</sub> and <italic>p</italic><sub><italic>i</italic>2</sub> share position and radius. The further they move out, the closer their radii become to the desired ones. The fusion of compartments could be added in an identical (if reversed) fashion. However so far, it has not been implemented yet.</p>
      </sec>
      <sec id="Sec10">
        <title>Bimolecular reactions</title>
        <p>Handling bimolecular reactions in particle-based approaches is rather challenging. Whilst solutions exist when not considering excluded volumes (e.g. Smoldyn [<xref ref-type="bibr" rid="CR12">12</xref>]), there has not yet been agreement among the community on the best way to approach this problem. This is evident from the many different approaches of recent tools [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Two processes contribute to the macroscopic rate,
<list list-type="bullet"><list-item><p>the <italic>diffusion process</italic> describes how likely it is that two particle actually move into the vicinity of each other. This upper bound to the reaction rate is well described by the <sc>Smoluchowski</sc>-Theory [<xref ref-type="bibr" rid="CR38">38</xref>] (elaborated in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>)</p></list-item><list-item><p>the <italic>microscopic activation process</italic> describes how likely it is for two particle to react once they are close to each other [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>].</p></list-item></list></p>
        <p>The rate is considered to be diffusion limited if every interaction results in a reaction, all other cases are considered to be activation limited. We propose to use forces for both processes. This means also the microscopic activation process is based on forces. In case a reaction can occur between two particles, the non-reactive force (Eq.: <xref rid="Equ2" ref-type="">2</xref>) has to be replaced by a reactive force. We used a rather simple approach which is calculated based on a degree of overlapping required <italic>d</italic><sup>∗</sup> and the work to cross the energy barrier between the two particles. Both, the degree of overlapping and the energy barrier, are specific for the reaction to occur and have to be defined by the modeler.
<disp-formula id="Equ8"><label>7</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  F_{react}=\frac{W}{d^{*}}  $$ \end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">react</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_3092_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>d</italic><sup>∗</sup> denotes the required overlap of the particles and <italic>W</italic> the work required to cross the energy barrier. It should be noted due to the modular design (see “<xref rid="Sec11" ref-type="sec">Simulator and implementation</xref>” section) within the simulator these functions can easily be changed. Suppose we were to look at the reaction <italic>p</italic><sub><italic>i</italic></sub>+<italic>p</italic><sub><italic>j</italic></sub>→<italic>p</italic><sub><italic>k</italic></sub>{<italic>d</italic><sup>∗</sup>,<italic>W</italic>}. Whenever <italic>p</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>j</italic></sub> overlap, they start to repel each other with the force <italic>F</italic><sub><italic>react</italic></sub>. Once they overlap more than <italic>d</italic><sup>∗</sup>, we consider the reaction to be triggered. Thus, the energy barrier and the required overlap of the microscopic interaction potential determines the likelihood of the reaction to take place. The higher the energy barrier, the less likely the particles will overlap sufficiently. If the energy barrier <italic>W</italic> is negligible, the diffusion is the only limit to the macroscopic reaction rate in the reaction process, it is <italic>diffusion limited</italic>.</p>
        <p>This type of bimolecular reaction handling with forces, allows also for self-consistent handling of dynamic nesting (and “unnesting”) reactions, i.e., one particle shuttles into (or out of) another particle. In principle the same concepts apply as for the regular bimolecular reaction. Looking at the reaction <italic>p</italic><sub><italic>i</italic></sub>+<italic>p</italic><sub><italic>j</italic></sub>→<italic>p</italic><sub><italic>i</italic></sub>[<italic>p</italic><sub><italic>j</italic></sub>]{<italic>d</italic><sup>∗</sup>,<italic>W</italic>} (and the same for <italic>p</italic><sub><italic>i</italic></sub>[<italic>p</italic><sub><italic>j</italic></sub>]→<italic>p</italic><sub><italic>i</italic></sub>+<italic>p</italic><sub><italic>j</italic></sub>{<italic>d</italic><sup>∗</sup>,<italic>W</italic>}), first the particles need to diffuse into proximity of one another. Once particles overlap, they repel each other. If <italic>p</italic><sub><italic>i</italic></sub>’s diameter has fully passed over <italic>p</italic><sub><italic>j</italic></sub>’s outline, the nesting reaction is triggered. However at this point <italic>p</italic><sub><italic>j</italic></sub> is already fully contained in <italic>p</italic><sub><italic>i</italic></sub> so there is no jerkiness in the simulation. For example, if there is no unnesting reaction defined for these particles, the only thing, that changes, is that, if <italic>p</italic><sub><italic>j</italic></sub> were to move towards again touching <italic>p</italic><sub><italic>i</italic></sub>, it would perceive the force <italic>F</italic><sub><italic>n</italic><italic>o</italic><italic>n</italic>−<italic>r</italic><italic>e</italic><italic>a</italic><italic>c</italic><italic>t</italic></sub> (pulling inwards). This ensures a soft-sphere-style excluded volume. Similar as for the regular <italic>p</italic><sub><italic>i</italic></sub>+<italic>p</italic><sub><italic>j</italic></sub>→<italic>p</italic><sub><italic>k</italic></sub> type bimolecular reaction, a high energy barrier makes for a less, and a low for a more likely reaction.</p>
        <p>The advantage of this force-based approach, is the smooth integration of the nesting process. On the other hand, it does require a very small timestep, compared to other methods. Furthermore, in the current situation, the parameterization of bimolecular reactions is not optimal. Ideally, the modeler would specify the macroscopic rate, instead of the microscopic barrier. In the future we plan on investigating this further and, using principles from thermodynamics, provide an automatic conversion method. This would mean, by modeling the system as a thermodynamic ensemble we could determine the statistical likelihood of a particle surpassing a certain energy threshold during interaction and put this into explicit mathematical relation to the reaction rate.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Simulator and implementation</title>
      <p>The simulator has been implemented using C++14 and has been tested on both Windows and Linux (using CMake-build system) and is available at <ext-link ext-link-type="uri" xlink:href="https://git.informatik.uni-rostock.de/mosi/ml-force-publication">https://git.informatik.uni-rostock.de/mosi/ml-force-publication</ext-link>.</p>
      <p>The user-interface is built around a rudimentary embedded domain specific language (DSL). An example and explanation can be found in the provided code snippet below. In the long run, it would be advantageous to create an external DSL using techniques like transpiling, to still have the performance benefits of a compiling language. A more in-depth comparison and discussion of DSLs can be found in the literature [<xref ref-type="bibr" rid="CR41">41</xref>]. The developed embedded DSL bears some similarities with the <italic>ℓ</italic>-language [<xref ref-type="bibr" rid="CR42">42</xref>] which also supports an imperative rather than a declarative approach towards modeling.</p>
      <p>As can be seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the software pursues a component-based design with a clear separation of concern [<xref ref-type="bibr" rid="CR43">43</xref>]. Its components are arranged around the main <italic>simulation engine</italic>. The simulation engine itself is very basic and designed to make as little assumptions about the underlying semantics as possible. This simulation engine interacts with the components via a well defined, small interface. Each of the key ingredients of the simulation is separated into exchangeable components, namely the integrator, collision detection engine, and the visualizer, as well as the overarching modeling layer which provides the interface between the simulation engine and DSL. They are invoked by the simulator and implement the functionality introduced in the previous section. The simulator is responsible for executing the lower and higher order reactions by calling the specified functions of the model. First it is checked whether lower order reactions trigger in this step. If so, those are executed. Based on the forces a numerical integrator calculates the new positions of the particles. To identify the particles that interact, a collision detection engines is invoked. Afterward the simulator calculates the bimolecular forces and executes the biomolecular reactions accordingly. The calculated state can be subject to visualizations or other reporting mechanisms.
<fig id="Fig3"><label>Fig. 3</label><caption><p>The different components of the software and their respective tasks, as called upon by the main simulator in an UML sequence diagram. The different components of the software are interchangeable and only interact via their interface to the main <italic>Simulator</italic>-component. This simulator also provides the layer between the model (as specified using the DSL).The software implementation is described on in “<xref rid="Sec11" ref-type="sec">Simulator and implementation</xref>” section. The second integration of the particles is optional. For example the current integrator advances the velocity in the second integration step</p></caption><graphic xlink:href="12859_2019_3092_Fig3_HTML" id="MO3"/></fig>
</p>
      <p><bold>Integrator</bold> Currently integration is carried out using a two-step kick-drift-kick integrator [<xref ref-type="bibr" rid="CR44">44</xref>] of the stochastic <sc>LANGEVIN</sc> equation. This integration includes velocity, and is thus fairly costly numerically. However as an alternative, one could select an integrator with immediate dissipation of momentum, that would allow for a considerably larger timestep. The choice for the more complex integrator was made as ML-Force makes heavy use of various forces and carrying out the more complex integration, helps in terms of correctness. In the current implementation the time step is chosen adaptively based on the smallest particle and the fastest velocity currently in the system, as <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta t = \frac {r_{\text {min}}}{v_{\text {max}}\,g}$\end{document}</tex-math><mml:math id="M34"><mml:mi>Δt</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq9.gif"/></alternatives></inline-formula> with <italic>g</italic> as the parameter of <italic>granularity</italic>, that describes the precision of the integration.</p>
      <p><bold>Collision detection engine</bold> Finding possible interactions of particles using the collision detection engine is one of the key drivers of runtime in the current implementation. Several collision detection engines have been implemented, using different algorithms and parallelization. For example, for highly nested particles, the collision-detection problem lends itself to be solved by a specifically tailored algorithm and a massively parallel execution on the GPU [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p><bold>Visualizer</bold> Currently 3 basic visualizers have been created. One to just create an output text file, and two based on CImg [<xref ref-type="bibr" rid="CR45">45</xref>], one for live viewing and one for generating movie files. The visualizers are encapsulated in a separate thread to minimize overhead. One more advanced visualization has been implemented that maps the simulation to 3D space using OpenGL [<xref ref-type="bibr" rid="CR46">46</xref>]. It offers some useful features for the case studies (see “<xref rid="Sec16" ref-type="sec">Results</xref>” section), such as tracking individual particles in space.</p>
      <p><bold>Modeling layer</bold> The modeling layer makes heavy use of <italic>λ</italic>-functions in order to encapsulate model specific behavior into single function calls for the simulator. <italic>λ</italic>-functions here are a C++11 feature that allows to define anonymous functions, that can be used as parameters in a functional-like programming style. This is facilitated by various templates that have been defined in the DSL. For example, after each reaction, the simulator invokes the <italic>post reaction function</italic> (see e.g. afterFuncA in listing 2). In the modeling layer this function is specified by the user and denotes the results of applying a rule, such as particles changing state, being degraded or created.</p>
      <p>This simplifies the implementation of the simulator and gives a unified and lean interface for implementing further features. The simulator also provides a set of units (via the units:: namespace) to the modeler, allowing for consistent parameterization. For simplicity the reactants in the DSL are always denoted as <italic>A</italic> and <italic>B</italic>. The particular type of <italic>A</italic> and <italic>B</italic> is then specified via the <italic>as_A</italic> etc. functions. In general the DSL is very expressive, as all rates and reactions are described as <italic>λ</italic>-functions. These can be of arbitrary complexity. However, it should be noted that the current DSL presents only a proof of concept rather than a language that allows a succinct description of ML-Force models. Therefore, further efforts will be dedicated to improving the design of the language. <graphic position="anchor" xlink:href="12859_2019_3092_Figa_HTML" id="MO12"/></p>
    </sec>
  </sec>
  <sec id="Sec16" sec-type="results">
    <title>Results</title>
    <p>In order to test the ML-Force simulator and its implementation, we conduct a few case studies. These include simple test cases to investigate correctness and more complex models. The latter are inspired by realistic cell biological models, make use of the features in ML-Force, and, thus, demonstrate their usefulness. Both, the basic test models and the more realistic ones, can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <sec id="Sec17">
      <title>Testing correctness</title>
      <p>As other particle-based simulation approaches [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR47">47</xref>] we test the correctness of our simulator, based on a set of simple reactions which we simulate to compare the achieved results to theory. To those tests belong the creation of a particle with a constant rate as a 0 order reaction (<inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\emptyset \xrightarrow {\text {k}} A$\end{document}</tex-math><mml:math id="M36"><mml:mi>∅</mml:mi><mml:munderover><mml:mo>→</mml:mo><mml:mrow/><mml:mrow><mml:mtext>k</mml:mtext></mml:mrow></mml:munderover><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq10.gif"/></alternatives></inline-formula>), the decay with a rate <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A \xrightarrow {\text {k}} \emptyset $\end{document}</tex-math><mml:math id="M38"><mml:mi>A</mml:mi><mml:munderover><mml:mo>→</mml:mo><mml:mrow/><mml:mrow><mml:mtext>k</mml:mtext></mml:mrow></mml:munderover><mml:mi>∅</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq11.gif"/></alternatives></inline-formula> as first order reaction, and irreversible and reversible second order reactions <italic>A</italic>+<italic>B</italic>⇔<italic>C</italic> in the diffusion limited (intrinsic rate <italic>k</italic><sub><italic>int</italic></sub>=<italic>∞</italic>) case. A comparison of simulation results and theory shows overall a good agreement with the theory (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). However, those tests also reveal the decisive role of selected parameters to determine forces (“<xref rid="Sec10" ref-type="sec">Bimolecular reactions</xref>” section) and time steps. For their selection, suitable computational support should be provided. As a form of pre-processing step, energy barriers respectively accelerations for individual reactions could be generated by automatically fitting simulation results to theory. A similar strategy can help selecting suitable time steps, so that the diffusion of particles is correctly simulated (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec18">
      <title>A model of vesicular transport</title>
      <p><sc>HEINRICH</sc> and <sc>RAPOPORT</sc> proposed a model of vesicular transport [<xref ref-type="bibr" rid="CR48">48</xref>]. Although the model describes a spatial process, it was formalized by means of differential equations.</p>
      <p>The vesicular transport model refers to two cellular compartments which exchange membrane-bound soluble N-ethyl-maleimide–sensitive factor attachment protein receptors (SNAREs) and cargo proteins with the help of differently coated vesicles. These are budding from the compartments and move, driven by motor-proteins, to the other compartment where they are fused. Thereby the coat of vesicles defines, which type of SNAREs (X or Y), cargo proteins and motor-proteins are bound to them. Since different types of motor-proteins move in different direction, SNARE X and Y accumulate in different compartments.</p>
      <p>By modeling this process in a spatial regime, the problem starts, as in each particle-based approach, with the description of the species. Each species needs a radius and a diffusion coefficient. The ML-Force simulator determines the diffusion based on the temperature, solvent viscosity and particle radius according to the <sc>STOKES-EINSTEIN</sc> equation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The cell, compartments and the vesicles are represented as particles while the SNAREs are attributes of particles, which change during the budding and fusion processes. As <sc>KLANN</sc> et al. [<xref ref-type="bibr" rid="CR2">2</xref>] has already shown through the translation of the original ODE model into a spatial agent-based model, this transport relies on a directed movement of vesicles. Therefore Klann et al. added a cytoskeleton structure to the cell on which the motor-proteins moved along. In ML-Force the direction is determined by forces which take the type of particles and their attributes into account. An external force field is introduced which is shaped like a dipole field with the compartments as poles. Based on the coat of the vesicles a force along this field is added to their movement, which lead them to one of the compartments. To test the sorting mechanism of this simple vesicular transport model we study a system with 2 types of SNAREs (X and Y) with the same amount. As in [<xref ref-type="bibr" rid="CR48">48</xref>], we initialize the model: the first compartment is nine times bigger (<italic>V</italic><sub>1</sub>≈ 0.118 <italic>μ</italic><italic>m</italic><sup>3</sup>) than the second one (<italic>V</italic><sub>2</sub>≈ 0.013 <italic>μ</italic><italic>m</italic><sup>3</sup>) and contains 90% of the SNAREs (X and Y) (<inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{1}^{X/Y}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>/</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq12.gif"/></alternatives></inline-formula> = 90000 and <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{2}^{X/Y}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>/</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq13.gif"/></alternatives></inline-formula> = 10000). Since the budding process of the vesicles depends on the volume of the compartments, they should reach an equal size and the SNAREs should be sorted.</p>
      <p>As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> both compartments reach an equal volume and SNARE X accumulates in compartment 1 while SNARE Y accumulates in compartment 2 (not shown).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Volume and amount of SNARE <sub><italic>X</italic></sub> over time and Snapshot from the vesicle transport model. In the case of a directed movement the volume of the compartments become equal and SNARE <sub><italic>X</italic></sub> accumulate in compartment 1 as shown on the left. The right side shows a screenshot from the simulation where you can see the movement along the external force field. The blue sphere is the cell with a radius of 2.5 <italic>μ</italic><italic>m</italic></p></caption><graphic xlink:href="12859_2019_3092_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>To show that the directed motion is essential for the sorting, as a control we run the simulation without the external force field and with compartments with equal initial size (<italic>V</italic><sub>1/2</sub>≈ 0.065 <italic>μ</italic><italic>m</italic><sup>3</sup>) and equally initially distributed SNAREs (<inline-formula id="IEq14"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{1/2}^{X/Y}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>/</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3092_Article_IEq14.gif"/></alternatives></inline-formula> = 50000). In a purely Brownian model, i.e., a model where all particles perform Brownian motion, no sorting takes place and both compartments are just shrinking as shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. It can also be seen that the vesicle’s slowly diffusion around the compartments and there behavior is independent of their coating. In contrast the vesicles in the model with a directed movement either re-fuse with the compartment of origin or move to the other compartment based on their coating. As a result vesicles in this model fuse with a specific compartment after a short time and by this they are sorting the SNAREs. This simplified model illustrates how external forces can simulate the directed motion in a biological system.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Volume and amount of SNARE <sub><italic>X</italic></sub> over time and snapshot from the vesicle transport model. In the case of pure brownian motion the volume of the compartments decreases and no sorting of SNAREs takes place as shown on the left. The right side shows a screenshot from the simulation where you can see the random movement of the vesicles. The blue sphere is the cell with a radius of 2.5 <italic>μ</italic><italic>m</italic></p></caption><graphic xlink:href="12859_2019_3092_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec19">
      <title>The yeast model</title>
      <p>A more complex model that showcases more of ML-Force’s abilities is based on an illustrative yeast model [<xref ref-type="bibr" rid="CR30">30</xref>], which in turn uses the model of the cell cycle proposed by <sc>TYSON</sc> [<xref ref-type="bibr" rid="CR49">49</xref>]. In the original model each yeast cell can grow and contains five different proteins whose amounts oscillate periodically and trigger the fission of a yeast cell. Each cell has a mating type (P or M) which can change during the cell fission. Depending on the type the yeast releases pheromones (M-factor and P-factor, respectively) to inhibit the cell cycle of cells with opposite mating type. In addition, the type M cells secrete a protease called Sxa2 which inactivates the P-factor pheromone that stems from the type P cells.</p>
      <p>With the ML-Force model, we want to check whether cells of identical mating types accumulate in some areas and inhibit the cell cycle of cells with opposite mating type in this area. In ML-Force, each species of the system can be modeled as a particle, as shown in the upper part of Fig. <xref rid="Fig6" ref-type="fig">6</xref>. The problem of this approach are the different time scales of the dynamics. The cell cycle lasts about 120 min, while the diffusion of the proteins needs a time step in the sub nanosecond regime. In addition, for our question, a spatial simulation of the intra-cellular dynamics is not required. Therefore, we represent the pheromones and the cells as particles and the proteins involved in the cell cycle (as well as the cell cycle) as attributes of the cells, as shown in the lower part of Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Whereas cells only move during the fission process in the <italic>x</italic>-<italic>y</italic> plane, pheromones and Sxa2 diffuse in the extracellular medium and disappear when they reach the borders of the test volume.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Sketch of the spatial/non-spatial cell cycle. Cell cycle of a yeast cell with five/six different proteins. The upper cell shows the cell cycle modeled with particles. As the proteins interaction within the cell occurs on a vastly different timescale than the behavior of the cell this is not a feasible approach. Instead the internal dynamics are modeled by a non-spatial approach as shown at the bottom</p></caption><graphic xlink:href="12859_2019_3092_Fig6_HTML" id="MO6"/></fig>
</p>
      <p>As shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> after 900 min there are twice as many P-type cells as M-type cells. Furthermore some of the M-type cells are old (large) and have a highly inhibited cell cycle, which makes it likely that these cell will enter apoptosis before they can divide.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Spread of yeast cells. Distribution of yeast cells after 900 min. The numbers in the cells indicate how many pheromones are bound to them. For example the M-type cell on the left site has a highly inhibited cell cycle with 568 bounded pheromones. It is very likely that this cell will enter apoptosis, before it divides</p></caption><graphic xlink:href="12859_2019_3092_Fig7_HTML" id="MO7"/></fig>
</p>
      <p>Attributed particles and arbitrary functions allow to model the intra-cellular dynamics non-spatially as first order reaction. <graphic position="anchor" xlink:href="12859_2019_3092_Figb_HTML" id="MO9"/></p>
      <p>Nevertheless these non-spatial dynamic can influence the particle, here by triggering the division of a cell. <graphic position="anchor" xlink:href="12859_2019_3092_Figc_HTML" id="MO10"/></p>
      <p>It is also possible for a particle to influence the attributes (non-spatial) of particle.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2019_3092_Figd_HTML" id="MO11"/>
      </p>
      <p>For example this is the case in the yeast model when a pheromone reacts with a cell (both particles) and inhibits the cell cycle of the cell. This combination of spatial and non-spatial behaviors enables the simulation of systems which include processes on different temporal scales.</p>
    </sec>
    <sec id="Sec20">
      <title>Lipid rafts model</title>
      <p>The role of lipid rafts in inducing and promoting receptor accumulation within the cell membrane and the recruitment and binding of proteins from the cytosol has been subject to several computational studies [<xref ref-type="bibr" rid="CR50">50</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. A small model of receptor lipid raft interaction which is inspired by a sub-model of Wnt signaling [<xref ref-type="bibr" rid="CR52">52</xref>] shall illustrate the ability of ML-Force to support dynamic nesting. The model consists of two proteins (LRP 5/6 and CK1- <italic>γ</italic>) which diffuse in the membrane and may enter or leave lipid rafts. In the model, the mobility of proteins is reduced in lipid rafts by a 10 times larger viscosity in the rafts compared to the rest of the membrane. Both proteins have different affinities to enter the lipid raft which is modeled by different energy barriers in the nesting reactions. LRP 5/6 has to pass a barrier of 12·10<sup>−21</sup> J which was estimated from the distribution of the kinetic energy for demonstration purposes. It shows how the energy barrier at a bimolecular reaction can be used to slow down the reaction. CK1- <italic>γ</italic> can enter the lipid raft freely (<italic>E</italic><sub><italic>barrier</italic></sub> = 0 J). By choosing a larger energy barrier for LRP 5/6 while they are entering the lipid raft we model their lower affinity to the lipid raft and can show how the energy barrier at a bimolecular reaction can be used to slow down the reaction. To show how these functions influence the accumulation of the proteins in the lipid raft we run a 2D simulation. In this simple experiment, our model contains a single lipid raft which covers 25% of the surface. The 10 times larger viscosity of the lipid raft causes a 10 times lower diffusion coefficient in the raft compared to the rest of the membrane. The simulation starts with 200 LRP 5/6 and 200 CK1- <italic>γ</italic> particles outside the lipid raft. To enter the lipid raft, the particles need to overcome the energy barriers described above. After a particle entered a lipid raft they can leave it again without any energy barrier.</p>
      <p>As expected, Fig. <xref rid="Fig8" ref-type="fig">8</xref> shows that due to the slower diffusion in the lipid raft CK1- <italic>γ</italic> accumulates in the lipid raft. The amount of LRP 5/6 which accumulates in the lipid raft is lower due to the energy barrier which hampers receptors to enter the lipid raft.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Accumulation of proteins in lipid rafts. Amount of LPR 5/6 and CK1- <italic>γ</italic> inside the lipid raft. Due to the lower affinity of LRP 5/6 to the lipid raft (realized by an energy barrier) their concentration is lower then the one of CK1- <italic>γ</italic></p></caption><graphic xlink:href="12859_2019_3092_Fig8_HTML" id="MO8"/></fig>
</p>
      <p>The model shows how the repulsive force during a bimolecular reaction can lower the reaction rate. Also the dynamic nesting of particles can change their behavior (here the diffusion of the nested particle) during simulation. It is also possible to restrict reactions to only occur if particles are nested inside a specific type of particle, such as the phosphorylation of LRP 5/6 which is constrained to lipid rafts.</p>
    </sec>
  </sec>
  <sec id="Sec21" sec-type="discussion">
    <title>Discussion</title>
    <p>The benchmark models which range from the multicellular yeast model to the subcellular lipid raft model have shown the usefulness of the realized features. ML-Force expands upon the state of the art. The combination of compartmental dynamics and particle simulation based on forces is a unique feature of ML-Force. This feature has been used in the lipid raft model (“<xref rid="Sec20" ref-type="sec">Lipid rafts model</xref>” section). ML-Force provides a consistent force-based semantics for spatially resolved dynamic nesting with excluded volumes. Arbitrary functions and attributes have proven a necessity for a concise and computationally feasible realization of the yeast model in ML-Force (“<xref rid="Sec19" ref-type="sec">The yeast model</xref>” section) where they are used for the non-spatial stochastic simulation of the cell cycle. In ML-Force, intra-particle dynamics can be simulated either spatially resolved by nested particles or in a non-spatial stochastic manner. Applying lower and higher spatial resolutions on demand facilitates modeling and simulating complex spatial models. The vesicle transport model (“<xref rid="Sec18" ref-type="sec">A model of vesicular transport</xref>” section) relied on the possibility to let particles grow and to define global force functions that apply to all particles independently of other particles to simulate the directed movement of vesicles. The global force functions provide an additional means for the modeler for abstraction (in this case from the cytoskeleton structure on which the motor-proteins move). Along all other dynamics this is seamlessly integrated into the force-based semantics of ML-Force.</p>
  </sec>
  <sec id="Sec22" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The particle-based modeling and simulation approach ML-Force combines excluded volumes and forces with support for dynamic nesting (compartmental dynamics) and the ability of constraining cellular dynamics by arbitrary attributes and functions. Whereas other simulation approaches have treated compartmental dynamics, such as particles entering or leaving a compartment, or compartmental fission or fusion, discretely, in ML-Force those are simulated in a smooth, continuous manner. Thereby, structural dynamics are seamlessly integrated into the particle-based simulation governed by the <sc>LANGEVIN</sc> equation. However, this adds to the requirements the integrator has to face and consequently the induced calculation efforts.</p>
    <p>ML-Force utilizes a rule-based modeling approach. In combination with attributed species of arbitrary types and arbitrary functions that work on particles, their attributes and content, this contributes to the expressiveness and flexibility of ML-Force. In particular, part of a spatial model can be executed in a non-spatial stochastic manner. Abstracting from spatial details on demand reduces the complexity of the model and the induced calculation effort and allows applying ML-Force to a wider range of cell biological systems. The possibility to define force functions that act on all particles independently of others provides another valuable means for abstraction in ML-Force.</p>
    <p>Currently, ML-Force is being used in a combined in-vitro and in-silico study to analyze the impact of external electrical fields on cellular membranes. Future work will be aimed at enhancing the readability of ML-Force models by a more declarative expression of rules. In addition, user support for selecting time steps and suitable parameters for force calculation needs to be provided. Also advanced numerical integration schemes that are exploited by other particle-based simulators and their impact on compartmental dynamics shall be analyzed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3092_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> The additional file contains tests of of basic functions and the code of the models from the case study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CK1- <italic>γ</italic></term>
        <def>
          <p>casein kinase 1- <italic>γ</italic></p>
        </def>
      </def-item>
      <def-item>
        <term>DSL</term>
        <def>
          <p>domain specific language</p>
        </def>
      </def-item>
      <def-item>
        <term>LRP5/6</term>
        <def>
          <p>low-density lipoprotein receptor-related protein 5/6</p>
        </def>
      </def-item>
      <def-item>
        <term>ML</term>
        <def>
          <p>multi-level</p>
        </def>
      </def-item>
      <def-item>
        <term>RDME</term>
        <def>
          <p>reaction diffusion master equation</p>
        </def>
      </def-item>
      <def-item>
        <term>SNARE</term>
        <def>
          <p>soluble N-ethyl-maleimide–sensitive factor attachment protein receptors</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3092-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Felix Hauptmann implemented the OpenGL visualizer.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TK conceived the method. TK designed and implemented the Software. PH carried out the Case study. TK, PH and AMU wrote the manuscript. AMU supervised the project. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Financial support (design of the study, analysis, and interpretation of simulations and in writing the manuscript) was provided by the Deutsche Forschungsgemeinschaft (DFG) research grant ’ESCeMMo’ (UH-66/13) and the DFG collaborative research centre ’ELAINE’ (CRC 1270). We acknowledge financial support by Deutsche Forschungsgemeinschaft (DFG) and Universität Rostock within the funding programme Open Access Publishing.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets used and/or analysed during the current study are available from the corresponding author on reasonable request.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>J. D.</given-names>
          </name>
          <name>
            <surname>Pawson</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Cell Signaling in Space and Time: Where Proteins Come Together and When They’re Apart</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5957</issue>
        <fpage>1220</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">19965465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koeppl</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Spatial Simulations in Systems Biology: From Molecules to Cells</article-title>
        <source>Int J Mol Sci</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>7798</fpage>
        <lpage>827</lpage>
        <pub-id pub-id-type="pmid">22837728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <mixed-citation publication-type="other">Bittig AT, Uhrmacher AM. Spatial modeling in cell biology at multiple levels. In: Proceedings of the 2010 Winter Simulation Conference. Baltimore: 2010. p. 608–19. 10.1109/WSC.2010.5679125.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridgway</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Broderick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ellison</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Accommodating space, time and randomness in network simulation</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2006</year>
        <volume>17</volume>
        <issue>5</issue>
        <fpage>493</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">16962764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tănase-Nicola</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wolde</surname>
            <given-names>PRt</given-names>
          </name>
        </person-group>
        <article-title>Spatio-temporal correlations can drastically change the response of a MAPK pathway</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>6</issue>
        <fpage>2473</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">20133748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cowan</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Moraru</surname>
            <given-names>II</given-names>
          </name>
          <name>
            <surname>Schaff</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Slepchenko</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Loew</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Asthagiri</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Chapter 8 - Spatial Modeling of Cell Signaling Networks</article-title>
        <source>Methods in Cell Biology, Computational Methods in Cell Biology, vol. 110, pp. 192-221</source>
        <year>2012</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Arjunan</surname>
            <given-names>SNV</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Space in systems biology of signaling pathways - towards intracellular molecular crowding in silico</article-title>
        <source>FEBS Lett</source>
        <year>2005</year>
        <volume>579</volume>
        <issue>8</issue>
        <fpage>1783</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">15763552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schöneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ullrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Noé</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Simulation tools for particle-based reaction-diffusion dynamics in continuous space</article-title>
        <source>BMC Biophysics</source>
        <year>2014</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>11</fpage>
        <pub-id pub-id-type="pmid">25737778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillespie</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Stochastic Simulation of Chemical Kinetics</article-title>
        <source>Annu Rev Phys Chem</source>
        <year>2007</year>
        <volume>58</volume>
        <issue>1</issue>
        <fpage>35</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="pmid">17037977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Panina</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cardelli</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>BioAmbients: an abstraction for biological compartments</article-title>
        <source>Theor Comput Sci</source>
        <year>2004</year>
        <volume>325</volume>
        <issue>1</issue>
        <fpage>141</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bartol</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kaminsky</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dittrich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>J-CJ</given-names>
          </name>
          <name>
            <surname>Baden</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Sejnowski</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Stiles</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Fast Monte Carlo Simulation Methods For BIOLOGICAL Reaction-Diffusion Systems In Solution And On Surfaces</article-title>
        <source>SIAM J Sci Comput Publ Soc Ind Appl Math</source>
        <year>2008</year>
        <volume>30</volume>
        <issue>6</issue>
        <fpage>3126</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Andrews SS, Addy NJ, Brent R, Arkin AP. Detailed Simulations of Cell Biology with Smoldyn 2.1. PLoS Comput Biol. 2010; 6(3). 10.1371/journal.pcbi.1000705.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blinov</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Schaff</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Vasilescu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Moraru</surname>
            <given-names>II</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Loew</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Compartmental and Spatial Rule-Based Modeling with Virtual Cell</article-title>
        <source>Biophys J</source>
        <year>2017</year>
        <volume>113</volume>
        <issue>7</issue>
        <fpage>1365</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">28978431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hattne</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fange</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Elf</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Stochastic reaction-diffusion simulation with MesoRD</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>12</issue>
        <fpage>2923</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">15817692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Smoldyn: particle-based simulation with rule-based modeling, improved molecular interaction and a library interface</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>710</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">28365760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michalski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Loew</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SpringSaLaD: A Spatial, Particle-Based Biochemical Simulation Platform with Excluded Volume</article-title>
        <source>Biophys J</source>
        <year>2016</year>
        <volume>110</volume>
        <issue>3</issue>
        <fpage>523</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">26840718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schöneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Noé</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>ReaDDy - A Software for Particle-Based Reaction-Diffusion Dynamics in Crowded Cellular Environments</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>9</issue>
        <fpage>74261</fpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruenert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lenser</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lohel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hinze</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dittrich</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Rule-based spatial modeling with diffusing, geometrically constrained molecules</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>307</fpage>
        <pub-id pub-id-type="pmid">20529264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donovan</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Tapia</surname>
            <given-names>J-J</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Dittrich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zuckerman</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Unbiased Rare Event Sampling in Spatial Stochastic Systems Biology Models Using a Weighted Ensemble of Trajectories</article-title>
        <source>PLOS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>1004611</fpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bittig</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>ML-Space: Hybrid Spatial Gillespie and Particle Simulation of Multi-level Rule-based Models in Cell Biology</article-title>
        <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
        <year>2016</year>
        <volume>PP</volume>
        <issue>99</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flegg</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Erban</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The two-regime method for optimizing stochastic reaction-diffusion simulations</article-title>
        <source>J R Soc Interf</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>70</issue>
        <fpage>859</fpage>
        <lpage>68</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ganguly</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koeppl</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Hybrid spatial Gillespie and particle tracking simulation</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>18</issue>
        <fpage>549</fpage>
        <lpage>55</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stolarska</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Othmer</surname>
            <given-names>HG</given-names>
          </name>
        </person-group>
        <article-title>A hybrid model for tumor spheroid growth in vitro i: theoretical development and early results</article-title>
        <source>Mathematical Models and Methods in Applied Sciences</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>supp01</issue>
        <fpage>1773</fpage>
        <lpage>98</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaff</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Slepchenko</surname>
            <given-names>BM</given-names>
          </name>
        </person-group>
        <article-title>Numerical Approach to Spatial Deterministic-Stochastic Models Arising in Cell Biology</article-title>
        <source>PLOS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>12</issue>
        <fpage>1005236</fpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Minton</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Macromolecular crowding: qualitative and semiquantitative successes, quantitative challenges</article-title>
        <source>Biochim Biophys Acta (BBA) - Protein Proteomics</source>
        <year>2003</year>
        <volume>1649</volume>
        <issue>2</issue>
        <fpage>127</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neefjes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jongsma</surname>
            <given-names>MML</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Stop or Go? Endosome Positioning in the Establishment of Compartment Architecture, Dynamics, and Function</article-title>
        <source>Trends Cell Biol</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>580</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="pmid">28363667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warnke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Haack</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Reusing simulation experiment specifications to support developing models by successive extension</article-title>
        <source>Simul Model Pract Theory</source>
        <year>2016</year>
        <volume>68</volume>
        <fpage>33</fpage>
        <lpage>53</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Perumalla</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Efficient Simulation of Nested Hollow Sphere Intersections: For Dynamically Nested Compartmental Models in Cell Biology</article-title>
        <source>Proceedings of the 2017 ACM SIGSIM Conference on Principles of Advanced Discrete Simulation SIGSIM-PADS ’17, pp. 173–183</source>
        <year>2017</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>ACM</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Faeder</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Hlavacek</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Rule-Based Modeling of Biochemical Systems with BioNetGen</article-title>
        <source>Maly, IV, (ed.) Systems Biology. Methods in Molecular Biology pp. 113-167</source>
        <year>2009</year>
        <publisher-loc>Totowa</publisher-loc>
        <publisher-name>Humana Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maus</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rybacki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Rule-based multi-level modeling of cell biological systems</article-title>
        <source>BMC Syst Biol</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>166</fpage>
        <pub-id pub-id-type="pmid">22005019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>John</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lhoussaine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Niehren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The Attributed Pi-Calculus with Priorities</article-title>
        <source>Transactions on Computational Systems Biology XII. Lecture Notes in Computer Science, pp. 13?76</source>
        <year>2010</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pârvu</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Heiner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Spatial-Temporal Modelling and Analysis of Bacterial Colonies with Phase Variable Genes</article-title>
        <source>ACM Trans Model Comput Simul</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>2</issue>
        <fpage>13</fpage>
        <lpage>11325</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Butner</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Kerketta</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cristini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Deisboeck</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Simulating Cancer Growth with Multiscale Agent-Based Modeling</article-title>
        <source>Semin Cancer Biol</source>
        <year>2015</year>
        <volume>30</volume>
        <fpage>70</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">24793698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Coffey</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Kalmykov</surname>
            <given-names>YP</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <source>The Langevin Equation: With Applications to Stochastic Problems in Physics, Chemistry and Electrical Engineering</source>
        <year>2004</year>
        <publisher-loc>Singapore; River Edge, NJ</publisher-loc>
        <publisher-name>World Scientific Pub Co Inc</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hertz</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Über die Berührung fester elastischer Körper</article-title>
        <source>Journal für die reine und angewandte Mathematik (Crelle’s Journal)</source>
        <year>1882</year>
        <volume>92</volume>
        <fpage>156</fpage>
        <lpage>71</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jeschke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ewald</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Large-Scale Design Space Exploration of SSA</article-title>
        <source>Computational Methods in Systems Biology, Lecture Notes in Computer Science, pp. 211-230</source>
        <year>2008</year>
        <publisher-loc>Rostock</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hummer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Free-Propagator Reweighting Integrator for Single-Particle Dynamics in Reaction-Diffusion Models of Heterogeneous Protein-Protein Interaction Systems</article-title>
        <source>Phys Rev X</source>
        <year>2014</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>031037</fpage>
        <pub-id pub-id-type="pmid">26005592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Smoluchowski</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Versuch einer mathematischen Theorie der Koagulationskinetik kolloider Lösungen</article-title>
        <source>Z für Phys Chem</source>
        <year>1917</year>
        <volume>92</volume>
        <fpage>129</fpage>
        <lpage>68</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Kimball</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Diffusion-controlled reaction rates</article-title>
        <source>J Colloid Sci</source>
        <year>1949</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>425</fpage>
        <lpage>37</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noyes</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Effects of diffusion rates on chemical kinetics</article-title>
        <source>Prog React Kinet</source>
        <year>1961</year>
        <volume>1</volume>
        <fpage>129</fpage>
        <lpage>60</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Deursen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klint</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Domain-specific languages: An annotated bibliography</article-title>
        <source>SIGPLAN Not</source>
        <year>2000</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>26</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zunino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Priami</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kahramanogulları</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schiavinotto</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>l: An Imperative DSL to Stochastically Simulate Biological Systems</article-title>
        <source>Bodei, C, Ferrari, G, Priami, C, (eds.) Programming Languages with Applications to Biology and Security: Essays Dedicated to Pierpaolo Degano on the Occasion Of His 65th Birthday, pp. 354-357</source>
        <year>2015</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">Himmelspach J, Uhrmacher AM. Plug’n Simulate. In: Simulation Symposium, 2007. ANSS ’07. 40th Annual: 2007. p. 137–43. 10.1109/ANSS.2007.34.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <mixed-citation publication-type="other">Mannella R. Numerical Stochastic Integration for Quasi-Symplectic Flows. SIAM J Sci Comput. 2006. 10.1137/040620965.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <mixed-citation publication-type="other">The CImg Library - C++ Template Image Processing Toolkit. <ext-link ext-link-type="uri" xlink:href="http://cimg.eu/">http://cimg.eu/</ext-link>. Accessed 11 Feb 2019.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <mixed-citation publication-type="other">OpenGL - The Industry Standard for High Performance Graphics. <ext-link ext-link-type="uri" xlink:href="https://www.opengl.org/">https://www.opengl.org/</ext-link>. Accessed 11 Feb 2019.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yogurtcu</surname>
            <given-names>O. N.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>M. E.</given-names>
          </name>
        </person-group>
        <article-title>Theory of bi-molecular association dynamics in 2d for accurate model and experimental parameterization of binding rates</article-title>
        <source>J Chem Phys</source>
        <year>2015</year>
        <volume>143</volume>
        <issue>8</issue>
        <fpage>084117</fpage>
        <pub-id pub-id-type="pmid">26328828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinrich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rapoport</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Generation of nonidentical compartments in vesicular transport systems</article-title>
        <source>J Cell Biol</source>
        <year>2005</year>
        <volume>168</volume>
        <issue>2</issue>
        <fpage>271</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="pmid">15657397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Modeling the cell division cycle: cdc2 and cyclin interactions</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1991</year>
        <volume>88</volume>
        <issue>16</issue>
        <fpage>7328</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">1831270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolau</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Burrage</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Parton</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Hancock</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Identifying Optimal Lipid Raft Characteristics Required To Promote Nanoscale Protein-Protein Interactions on the Plasma Membrane</article-title>
        <source>Mol Cell Biol</source>
        <year>2006</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>313</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">16354701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haack</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Burrage</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Redmer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Studying the Role of Lipid Rafts on Protein Receptor Bindings with Cellular Automata</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinformatics</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>760</fpage>
        <lpage>70</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haack</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lemcke</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ewald</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rharass</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Uhrmacher</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Spatio-temporal Model of Endogenous ROS and Raft-Dependent WNT/Beta-Catenin Signaling Driving Cell Fate Commitment in Human Neural Progenitor Cells</article-title>
        <source>PLOS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>1004106</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
