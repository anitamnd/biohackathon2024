<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5342223</article-id>
    <article-id pub-id-type="pmid">28273164</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-16-40688</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0173249</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Species Interactions</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Theoretical Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Theoretical Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Thermodynamics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Numerical Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Development</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Development</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MI-Sim: A MATLAB package for the numerical analysis of microbial ecological interactions</article-title>
      <alt-title alt-title-type="running-head">Numerical analysis software for microbial interactions</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9824-7121</contrib-id>
        <name>
          <surname>Wade</surname>
          <given-names>Matthew J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oakley</surname>
          <given-names>Jordan</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harbisher</surname>
          <given-names>Sophie</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Parker</surname>
          <given-names>Nicholas G.</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dolfing</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Civil Engineering and Geosciences, Newcastle University, Newcastle-upon-Tyne NE1 7RU, United Kingdom</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>School of Mathematics and Statistics, Newcastle University, Newcastle-upon-Tyne NE1 7RU, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bourdon</surname>
          <given-names>Jérémie</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universite de Nantes, FRANCE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>
          <list list-type="simple">
            <list-item>
              <p><bold>Conceptualization:</bold> MJW NP JD.</p>
            </list-item>
            <list-item>
              <p><bold>Data curation:</bold> MJW.</p>
            </list-item>
            <list-item>
              <p><bold>Formal analysis:</bold> MJW JO SH.</p>
            </list-item>
            <list-item>
              <p><bold>Funding acquisition:</bold> MJW JD.</p>
            </list-item>
            <list-item>
              <p><bold>Investigation:</bold> MJW.</p>
            </list-item>
            <list-item>
              <p><bold>Methodology:</bold> MJW.</p>
            </list-item>
            <list-item>
              <p><bold>Project administration:</bold> MJW JD.</p>
            </list-item>
            <list-item>
              <p><bold>Resources:</bold> MJW JD.</p>
            </list-item>
            <list-item>
              <p><bold>Software:</bold> MJW JO SH.</p>
            </list-item>
            <list-item>
              <p><bold>Supervision:</bold> MJW NP JD.</p>
            </list-item>
            <list-item>
              <p><bold>Validation:</bold> MJW JO SH.</p>
            </list-item>
            <list-item>
              <p><bold>Visualization:</bold> MJW.</p>
            </list-item>
            <list-item>
              <p><bold>Writing – original draft:</bold> MJW NP.</p>
            </list-item>
            <list-item>
              <p><bold>Writing – review &amp; editing:</bold> MJW NP JD.</p>
            </list-item>
          </list>
        </p>
      </fn>
      <corresp id="cor001">* E-mail: <email>matthew.wade@ncl.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>3</issue>
    <elocation-id>e0173249</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>2</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Wade et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Wade et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0173249.pdf"/>
    <abstract>
      <p>Food-webs and other classes of ecological network motifs, are a means of describing feeding relationships between consumers and producers in an ecosystem. They have application across scales where they differ only in the underlying characteristics of the organisms and substrates describing the system. Mathematical modelling, using mechanistic approaches to describe the dynamic behaviour and properties of the system through sets of ordinary differential equations, has been used extensively in ecology. Models allow simulation of the dynamics of the various motifs and their numerical analysis provides a greater understanding of the interplay between the system components and their intrinsic properties. We have developed the <monospace>MI-Sim</monospace> software for use with <monospace>MATLAB</monospace> to allow a rigorous and rapid numerical analysis of several common ecological motifs. <monospace>MI-Sim</monospace> contains a series of the most commonly used motifs such as cooperation, competition and predation. It does not require detailed knowledge of mathematical analytical techniques and is offered as a single graphical user interface containing all input and output options. The tools available in the current version of <monospace>MI-Sim</monospace> include model simulation, steady-state existence and stability analysis, and basin of attraction analysis. The software includes seven ecological interaction motifs and seven growth function models. Unlike other system analysis tools, <monospace>MI-Sim</monospace> is designed as a simple and user-friendly tool specific to ecological population type models, allowing for rapid assessment of their dynamical and behavioural properties.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/K003240/2</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9824-7121</contrib-id>
          <name>
            <surname>Wade</surname>
            <given-names>Matthew John</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000774</institution-id>
            <institution>Newcastle University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Institute of Sustainability - Responsive Mode</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9824-7121</contrib-id>
          <name>
            <surname>Wade</surname>
            <given-names>Matthew John</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>MJW and JD acknowledge the Biotechnology and Biological Sciences Research Council UK (BB/K003240/2 Engineering synthetic microbial communities for biomethane production) for funding the project (<ext-link ext-link-type="uri" xlink:href="http://www.bbsrc.ac.uk/">www.bbsrc.ac.uk/</ext-link>). MJW, JO and SH developed the software with funding provided by the Institute of Sustainability, Newcastle University (<ext-link ext-link-type="uri" xlink:href="http://www.ncl.ac.uk/sustainability/">http://www.ncl.ac.uk/sustainability/</ext-link>).</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="5"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All Matlab package scripts are available at the Github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/MI-SIM/MI_SIM_final">https://github.com/MI-SIM/MI_SIM_final</ext-link>). The MI-SIM software is also available directly at the Mathworks File Exchange (<ext-link ext-link-type="uri" xlink:href="http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim-mi-sim-final">http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim-mi-sim-final</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All Matlab package scripts are available at the Github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/MI-SIM/MI_SIM_final">https://github.com/MI-SIM/MI_SIM_final</ext-link>). The MI-SIM software is also available directly at the Mathworks File Exchange (<ext-link ext-link-type="uri" xlink:href="http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim-mi-sim-final">http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim-mi-sim-final</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Network motifs provide an approach to understand and characterise the behaviour of living systems at genomic, metabolic and ecological scales [<xref rid="pone.0173249.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0173249.ref003" ref-type="bibr">3</xref>]. Food-webs, defined as a subset or module of larger, more complex networks, are used to analyse ecological interactions at the community or population level, as first described by mathematicians such as Lotka and Volterra, and have been widely used to explore phenomena observed at both macro- and micro-scales [<xref rid="pone.0173249.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0173249.ref006" ref-type="bibr">6</xref>].</p>
    <p>Mathematical modelling of ecological interactions is affected by the model objective (e.g., observation, prediction, control), the availability of existing knowledge and data, and the structural complexity necessary to adequately describe the motif. For clarity, we define <italic>motif</italic> here to be analogous to interaction <italic>modules</italic> described by population ecologists, and the specific forms of these motifs are described widely in the literature (e.g. [<xref rid="pone.0173249.ref007" ref-type="bibr">7</xref>]).</p>
    <p>The software presented here focuses on a mechanistic understanding of microbial interactions and, specifically, their analysis and simulation for two or three microbial species and associated substrates and products. The motif models are developed as systems of Ordinary Differential Equations (ODEs) used to describe the dynamics of and interactions between the individual organisms and their various components.</p>
    <p>Mathematical analysis of such model structures is commonplace in fields such as chemostat theory [<xref rid="pone.0173249.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0173249.ref011" ref-type="bibr">11</xref>], predator-prey system analysis [<xref rid="pone.0173249.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0173249.ref013" ref-type="bibr">13</xref>], theoretical microbial ecology [<xref rid="pone.0173249.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0173249.ref015" ref-type="bibr">15</xref>], and more recently in application to synthetic microbiology [<xref rid="pone.0173249.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0173249.ref017" ref-type="bibr">17</xref>]. Methods that include steady-state analysis and basin of attraction characterisation are necessary to understand the stability, resilience and persistence of the modelled microbial populations. However, performing these analyses robustly requires a relatively high degree of competency with mathematical theory of dynamical systems. There are several tools available for the numerical analysis of dynamical ODEs (See <xref rid="pone.0173249.t001" ref-type="table">Table 1</xref> for details). Whilst often versatile, these tools are difficult for non-specialists to work with and are generally focused on users with some grounding in the mathematics of dynamical systems analysis. Furthermore, for use in systems with more than four ODEs, bifurcation and stability analysis is often problematic as finding exact solutions for higher-dimensional systems is non-trivial and often intractable.</p>
    <table-wrap id="pone.0173249.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0173249.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Some available software tools for mathematical analysis of ODE based dynamical models.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0173249.t001g" xlink:href="pone.0173249.t001"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="1" colspan="1">Software</th>
              <th align="center" rowspan="1" colspan="1">Notes</th>
              <th align="center" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <monospace>COCO</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Matlab-based software platform for numerical continuation of constrained solutions to nonlinear equations. Focused more specifically on boundary value problems. Integrated with <monospace>GRIND</monospace> for 1D and 2D bifurcation analysis in <monospace>MATLAB</monospace></td>
              <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0173249.ref018" ref-type="bibr">18</xref>] [<xref rid="pone.0173249.ref019" ref-type="bibr">19</xref>]</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <monospace>MATCONT</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">A flexible <monospace>MATLAB</monospace> toolbox for continuation and bifurcation analysis of ODEs</td>
              <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0173249.ref020" ref-type="bibr">20</xref>]</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <monospace>MATDS</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Graphical <monospace>MATLAB</monospace> package for the interactive numerical study of ODE-based dynamical systems. Last modified in 2004 and still in beta version</td>
              <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0173249.ref021" ref-type="bibr">21</xref>]</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <monospace>PyDSTool</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1"><monospace>Python</monospace>-based environement for integrated simulation and analysis of dynamical models of physical systems. Although versatile, requires <monospace>Python</monospace> scripting to develop models and routines</td>
              <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0173249.ref022" ref-type="bibr">22</xref>]</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <monospace>XPPAUT</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Coupled solver for a range of equation types (<monospace>XPP</monospace>) with the widely-used bifurcation tool <monospace>AUTO</monospace>. It features a GUI but does require some coding of the system equations and parameters by the user</td>
              <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0173249.ref023" ref-type="bibr">23</xref>]</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>We present here a mathematical analysis software, <monospace>MI-Sim</monospace>, specifically for use with mechanistically described microbial interactions described in terms of reactions, substrates/reactants and products. It provides a user-friendly environment in which microbiologists, microbial ecologists and biological mathematicians can rapidly and robustly characterise the dynamics of ecological motifs of up to three microbial species, without the requirement to develop their own code, programme models or rely on a detailed knowledge of the mathematics of dynamical systems analysis. <monospace>MI-Sim</monospace> has been developed using the proprietary software <monospace>MATLAB</monospace> (The Mathworks, Natick, USA).</p>
  </sec>
  <sec id="sec002">
    <title>Mathematical analysis of ecological motifs</title>
    <sec id="sec003">
      <title>Description of motifs</title>
      <p>Foremost, we aimed to develop a tool that enables users to model and analyse their own species interactions by making the software as generic as possible. Here, we have taken six common ecological motifs describing interactions between two distinct species, plus one extended motif that consists of three interacting species. The seven motifs, described in <xref rid="pone.0173249.t002" ref-type="table">Table 2</xref>, are simple ‘food-web’ type networks that provide a theoretical basis by which scientists can test hypotheses in suitably sized community networks [<xref rid="pone.0173249.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0173249.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0173249.ref024" ref-type="bibr">24</xref>, <xref rid="pone.0173249.ref025" ref-type="bibr">25</xref>]. Whilst the interactions between microbial species are fixed by their motif, the substrates, products and reactions are not. The user may define these by changing the values ascribed to the parameters dictating the particular reaction kinetics of the system under investigation.</p>
      <table-wrap id="pone.0173249.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Description of ecological motifs available in the software.</title>
          <p>A negative interaction indicates a cost to the species, a positive interaction signifies the species gains a benefit and 0 is a neutral interaction.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0173249.t002g" xlink:href="pone.0173249.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Motif name</th>
                <th align="left" rowspan="1" colspan="1">Ecological term</th>
                <th align="center" rowspan="1" colspan="1">Interaction</th>
                <th align="center" rowspan="1" colspan="1">No. species</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Syntrophy</td>
                <td align="left" rowspan="1" colspan="1">Cooperation</td>
                <td align="center" rowspan="1" colspan="1">+/+</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Food chain</td>
                <td align="left" rowspan="1" colspan="1">Commensalism</td>
                <td align="center" rowspan="1" colspan="1">0/+</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dilution Food chain with waste product inhibition</td>
                <td align="left" rowspan="1" colspan="1">Predation</td>
                <td align="center" rowspan="1" colspan="1">−/+</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">No common metabolites</td>
                <td align="left" rowspan="1" colspan="1">No interaction</td>
                <td align="center" rowspan="1" colspan="1">0/0</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Waste product inhibition</td>
                <td align="left" rowspan="1" colspan="1">Amensalism</td>
                <td align="center" rowspan="1" colspan="1">0/−</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Substrate competition</td>
                <td align="left" rowspan="1" colspan="1">Competition</td>
                <td align="center" rowspan="1" colspan="1">−/−</td>
                <td align="center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Three species food-web</td>
                <td align="left" rowspan="1" colspan="1">Competition/Cooperation</td>
                <td align="center" rowspan="1" colspan="1">(+/−)/+/(−/+)</td>
                <td align="center" rowspan="1" colspan="1">3</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>Development of the models</title>
      <p><monospace>MI-Sim</monospace> uses a deterministic rather than phenomenological approach for modelling and simulation of microbial species interactions. The described motifs are expressed as a series of ODEs, which describe the microbial growth, catabolic conversion processes, and species interactions within the system. The equations are developed using a standard mass-balance approach coupled with stoichiometric information describing the chemical transformation between reactants and products in the system. Whilst analytical approaches providing exact solutions are typically restricted to one or two species, numerical analysis allows extension to higher-dimensional models, albeit generating local rather than global solutions.</p>
      <p>The models currently available in <monospace>MI-Sim</monospace> take the following generalised form (shown here for one biomass and substrate pairing):
<disp-formula id="pone.0173249.e001"><alternatives><graphic xlink:href="pone.0173249.e001.jpg" id="pone.0173249.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>in</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pone.0173249.e002"><alternatives><graphic xlink:href="pone.0173249.e002.jpg" id="pone.0173249.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>t</italic> is time, <italic>X</italic> = <italic>X</italic>(<italic>t</italic>) is the biomass concentration, <italic>S</italic> = <italic>S</italic>(<italic>t</italic>) is the substrate concentration, <italic>S</italic><sub>in</sub> is the influent substrate concentration, <italic>μ</italic>(<italic>S</italic>) is the substrate dependent growth rate of the biomass and <italic>α</italic> is the flow of substrate in the system. In chemostat theory, for example, <italic>α</italic> typically represents the dilution rate or nutrient exchange, which is the inflow of substrate divided by the bioreactor volume.</p>
      <p>The seven motifs included in this version of the software have been developed according to this form. Users may manipulate the structure and behaviour of the different models by selecting appropriate parameter values. For example, all models contain a biomass decay rate term <italic>k</italic><sub>dec</sub>, which may be removed by setting its value equal to zero. Bespoke models of <italic>n</italic> coupled ODEs (<italic>n</italic> being theoretically unlimited, although increasingly complex and larger systems may be restricted by CPU capacity), can be created by altering the code describing the default models, but this option is only recommended for users with some knowledge of <monospace>MATLAB</monospace>. Future versions of the software will include a <italic>Model Builder</italic> option to make this process more transparent.</p>
    </sec>
    <sec id="sec005">
      <title>Units</title>
      <p>Molarity (M or mol/L) is the most commonly used unit for describing solution concentration in microbial systems. Kinetic studies of microorganism growth conventionally calculate parameters based on this unit for stoichiometric simplicity. However, in certain processes where solutes have an impact on the carbon oxidation state of the environment (e.g., wastewater treatment systems), solute strength is generally expressed in terms of Chemical Oxygen Demand (COD) for relevant components (i.e., those having a COD; <italic>M</italic> is used for those with no COD [<xref rid="pone.0173249.ref026" ref-type="bibr">26</xref>]). Accordingly, <monospace>MI-SIM</monospace> allows for the selection of units to be used by the model.</p>
    </sec>
  </sec>
  <sec id="sec006">
    <title>Description of the software</title>
    <sec id="sec007">
      <title>User interface</title>
      <p>The software is presented as a Graphical User Interface (GUI), thus removing any requirement for the user to be fluent with <monospace>MATLAB</monospace> coding. The user-friendly environment can be easily navigated using toolbar options for selection of motif and mathematical analysis routine, as well as visualisation and reporting options.</p>
      <p>A number of panels on the GUI enable the user to configure and parameterise the model and the simulation properties. The <italic>Growth Function</italic> panel is used to select the growth model (<italic>f</italic><sub><italic>n</italic></sub>) in the model (default: Monod). Parameterisation of the model is done using the <italic>Parameter Values</italic> panel. For dynamical analysis of the model the <italic>Initial Conditions</italic> panel provides an interface to select the starting concentrations of the model variables (substrate, <italic>S</italic><sub><italic>n</italic></sub> and biomass, <italic>X</italic><sub><italic>n</italic></sub>, where <italic>n</italic> is the index of the substrate/species). The <italic>Solver Options</italic> panel provides the user with a selection of in-built <monospace>MATLAB</monospace> ODE solver methods (default: <italic>ode23s</italic> for stiff systems) and absolute and relative tolerance values. These tolerances act to control the error estimation of the algorithm for the given solver method (e.g., Rosenbrock formula of order two for <italic>ode23s</italic>). It is not necessary for the user to understand the mechanics of the ODE solvers but, for non-trivial solutions, it may be necessary to adjust the tolerance values sacrificing speed for accuracy. A checkbox option <italic>Jacobian</italic> may reduce the stiff solver run-time by supplying a sparse Jacobian matrix to the solver. This avoids costly calls to the rate of change function. The <italic>Simulation Options</italic> panel is used to select parameters or variables and their value ranges for routines that analyse the models in a multiple-point simulation space (i.e., <italic>Multiple-point</italic>, <italic>Basin of attraction</italic>, and <italic>Phase portrait</italic>).</p>
      <p>The remaining panels are used to display and visualise the various outputs from the mathematical analysis of the motifs. The <italic>Equations</italic> panel displays the set of differential equations for the selected motif. Running the <italic>multiple-point analysis</italic> generates a heatmap as the algorithm calculates the Jacobian matrix for each parameter pair, and after completion a table showing the stability of each steady-state will be displayed. The <italic>Progress</italic> panel displays information on percent completion, which is useful for monitoring routines requiring multiple iterations, together with some text on the task status. The <italic>Fixed Points &amp; Stability</italic> panel displays the calculated fixed-point solutions and their stability for each variable. The output of this panel depends on the stability analysis selected in the <italic>Stability Check</italic> panel and is only available for single-point analysis. Two plot windows are available to display graphically the numerical outputs.</p>
    </sec>
    <sec id="sec008">
      <title>Analysis tools</title>
      <p><monospace>MI-Sim</monospace> comprises four numerical analysis tools used to fully characterise the motifs. They are presented here as pseudocode.</p>
      <sec id="sec009">
        <title>Single-point analysis</title>
        <p>This routine is used for analysing the dynamics and steady-state stability of the motif at a single point in the model parameter space, Θ. The algorithm is summarised in Algorithm 1. Briefly, the system of ODEs, <inline-formula id="pone.0173249.e003"><alternatives><graphic xlink:href="pone.0173249.e003.jpg" id="pone.0173249.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, are solved algebraically to find the fixed-point solutions, <inline-formula id="pone.0173249.e004"><alternatives><graphic xlink:href="pone.0173249.e004.jpg" id="pone.0173249.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, where <italic>g</italic> represents the number of fixed-points found. <inline-formula id="pone.0173249.e005"><alternatives><graphic xlink:href="pone.0173249.e005.jpg" id="pone.0173249.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the vector of variables (<italic>X</italic> and <italic>S</italic>) associated with the motifs. Two methods are available for analysis of the stability of the fixed-points; linear stability analysis and the Routh-Hurwitz criterion. In the former, <italic>ϵ</italic> defines the tolerance threshold for stability.</p>
        <p><bold>Algorithm 1:</bold> Single-point numerical analysis</p>
        <p specific-use="line"> <bold>Input:</bold> Θ, <italic>t</italic>, <inline-formula id="pone.0173249.e006"><alternatives><graphic xlink:href="pone.0173249.e006.jpg" id="pone.0173249.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>q</italic>, <italic>ϵ</italic></p>
        <p specific-use="line"> <bold>Output:</bold>
<inline-formula id="pone.0173249.e007"><alternatives><graphic xlink:href="pone.0173249.e007.jpg" id="pone.0173249.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>g</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">1 Substitute numerical parameters Θ into system of symbolic ODEs <inline-formula id="pone.0173249.e008"><alternatives><graphic xlink:href="pone.0173249.e008.jpg" id="pone.0173249.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">2 Solve <inline-formula id="pone.0173249.e009"><alternatives><graphic xlink:href="pone.0173249.e009.jpg" id="pone.0173249.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> numerically and plot solutions <inline-formula id="pone.0173249.e010"><alternatives><graphic xlink:href="pone.0173249.e010.jpg" id="pone.0173249.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">3 Assume <inline-formula id="pone.0173249.e011"><alternatives><graphic xlink:href="pone.0173249.e011.jpg" id="pone.0173249.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and solve algebraically for <inline-formula id="pone.0173249.e012"><alternatives><graphic xlink:href="pone.0173249.e012.jpg" id="pone.0173249.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> to give fixed-point solutions, <inline-formula id="pone.0173249.e013"><alternatives><graphic xlink:href="pone.0173249.e013.jpg" id="pone.0173249.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">4 Compute the Jacobian matrix <bold>J</bold></p>
        <p specific-use="line">5 Check stability of each fixed-point, <italic>x</italic><sup><italic>γ</italic>,</sup>*, for <italic>γ</italic> = 1, …, <italic>g</italic>:</p>
        <p specific-use="line">  <bold>Method:</bold> Linear Stability Analysis</p>
        <p specific-use="line">  1: Set <italic>x</italic>(0)′ = <italic>x</italic><sup><italic>γ</italic>,</sup>* + <italic>q</italic></p>
        <p specific-use="line">  2: Solve <italic>F</italic>(<italic>x</italic>(<italic>t</italic>)′)</p>
        <p specific-use="line">  3: Calculate <italic>u</italic> = <italic>x</italic>(<italic>t</italic>) − <italic>x</italic><sup><italic>γ</italic>,</sup>*</p>
        <p specific-use="line">    <bold>if</bold> ∥<italic>u</italic>∥ &lt; <italic>ϵ</italic>
<bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is stable</p>
        <p specific-use="line">    <bold>else</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is unstable</p>
        <p specific-use="line">    <bold>end</bold></p>
        <p specific-use="line">  <bold>Method:</bold> Routh-Hurwitz Criterion</p>
        <p specific-use="line">  1: Calculate characteristic polynomial of <bold>J</bold>: <inline-formula id="pone.0173249.e014"><alternatives><graphic xlink:href="pone.0173249.e014.jpg" id="pone.0173249.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="bold">J</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">det</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">  2: Calculate the eigenvalues <inline-formula id="pone.0173249.e015"><alternatives><graphic xlink:href="pone.0173249.e015.jpg" id="pone.0173249.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by finding the roots of <inline-formula id="pone.0173249.e016"><alternatives><graphic xlink:href="pone.0173249.e016.jpg" id="pone.0173249.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="bold">J</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">    <bold>if</bold>
<inline-formula id="pone.0173249.e017"><alternatives><graphic xlink:href="pone.0173249.e017.jpg" id="pone.0173249.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mo>∀</mml:mo><mml:mo>.</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is a stable node</p>
        <p specific-use="line">    <bold>else if</bold>
<inline-formula id="pone.0173249.e018"><alternatives><graphic xlink:href="pone.0173249.e018.jpg" id="pone.0173249.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mo>∀</mml:mo><mml:mo>.</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is an unstable node</p>
        <p specific-use="line">    <bold>else if</bold>
<inline-formula id="pone.0173249.e019"><alternatives><graphic xlink:href="pone.0173249.e019.jpg" id="pone.0173249.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mo>{</mml:mo><mml:mo>∃</mml:mo><mml:mo>.</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>∃</mml:mo><mml:mo>.</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is an unstable saddle point</p>
        <p specific-use="line">    <bold>else if</bold> ∀.<italic>λ</italic> ∈ ℜ(<italic>λ</italic> &lt; 0) <bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is a stable spiral</p>
        <p specific-use="line">    <bold>else if</bold> ∀.<italic>λ</italic> ∈ ℜ(<italic>λ</italic> &gt; 0) <bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is an unstable spiral</p>
        <p specific-use="line">    <bold>else if</bold> ∀.<italic>λ</italic> ∈ ℜ(<italic>λ</italic> = 0) <bold>then</bold></p>
        <p specific-use="line">    <italic>x</italic><sup><italic>γ</italic>,</sup>* is a circle</p>
        <p specific-use="line">    <bold>end</bold></p>
      </sec>
      <sec id="sec010">
        <title>Multiple-point analysis</title>
        <p>This algorithm is an extension of the single-point routine in which the stability analysis is performed for a range of user-specified values (<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>), with step-size <italic>s</italic><sub><italic>i</italic></sub>, for any given parameter pair, <italic>θ</italic><sub><italic>i</italic></sub> for <italic>i</italic> = 1, 2. The resulting steady-state regions and their stability are visualised as a two-dimensional bifurcation phase plane for (<italic>θ</italic><sub>1</sub>, <italic>θ</italic><sub>2</sub>). This is a powerful method for understanding the relationship between model parameters and the existence and stability of the system steady-states. In biological terms, the chosen parameters may represent operational properties of the system (e.g., dilution rate <italic>D</italic>, substrate input concentration <italic>S</italic><sub>in</sub>) or of the organisms themselves (e.g., growth rates, substrate yields), and thus can be used to test the effect of these parameters on the behaviour of the system itself. The method is described in Algorithm 2.</p>
        <p><bold>Algorithm 2:</bold> Multiple-point numerical analysis</p>
        <p specific-use="line"> <bold>Input:</bold> Θ′, <inline-formula id="pone.0173249.e020"><alternatives><graphic xlink:href="pone.0173249.e020.jpg" id="pone.0173249.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>i</italic></sub></p>
        <p specific-use="line"> <bold>Output:</bold>
<inline-formula id="pone.0173249.e021"><alternatives><graphic xlink:href="pone.0173249.e021.jpg" id="pone.0173249.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>g</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">1 Assume <inline-formula id="pone.0173249.e022"><alternatives><graphic xlink:href="pone.0173249.e022.jpg" id="pone.0173249.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and solve algebraically for <inline-formula id="pone.0173249.e023"><alternatives><graphic xlink:href="pone.0173249.e023.jpg" id="pone.0173249.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> to give fixed-point solutions, <inline-formula id="pone.0173249.e024"><alternatives><graphic xlink:href="pone.0173249.e024.jpg" id="pone.0173249.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">2 Define the Jacobian matrix <bold>J</bold> symbolically</p>
        <p specific-use="line">3 <bold>for</bold>
<italic>θ</italic><sub>1</sub> ≔ <italic>a</italic><sub>1</sub>
<bold>to</bold>
<italic>b</italic><sub>1</sub>
<bold>step</bold>
<italic>s</italic><sub>1</sub>
<bold>do</bold></p>
        <p specific-use="line">4   <bold>for</bold>
<italic>θ</italic><sub>2</sub> ≔ <italic>a</italic><sub>2</sub>
<bold>to</bold>
<italic>b</italic><sub>2</sub>
<bold>step</bold>
<italic>s</italic><sub>2</sub>
<bold>do</bold></p>
        <p specific-use="line">5    Calculate <inline-formula id="pone.0173249.e025"><alternatives><graphic xlink:href="pone.0173249.e025.jpg" id="pone.0173249.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0173249.e026"><alternatives><graphic xlink:href="pone.0173249.e026.jpg" id="pone.0173249.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mi mathvariant="bold">J</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">6    Calculate characteristic polynomial of <inline-formula id="pone.0173249.e027"><alternatives><graphic xlink:href="pone.0173249.e027.jpg" id="pone.0173249.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:mtext>J</mml:mtext><mml:mo>:</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="bold">J</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">det</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">J</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">7    Calculate the eigenvalues <inline-formula id="pone.0173249.e028"><alternatives><graphic xlink:href="pone.0173249.e028.jpg" id="pone.0173249.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by finding the roots of <inline-formula id="pone.0173249.e029"><alternatives><graphic xlink:href="pone.0173249.e029.jpg" id="pone.0173249.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="bold">J</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and determine stability <inline-formula id="pone.0173249.e030"><alternatives><graphic xlink:href="pone.0173249.e030.jpg" id="pone.0173249.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mi mathvariant="script">T</mml:mi></mml:math></alternatives></inline-formula> by:</p>
        <p specific-use="line">8    <bold>if</bold>
<inline-formula id="pone.0173249.e031"><alternatives><graphic xlink:href="pone.0173249.e031.jpg" id="pone.0173249.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:mo>∀</mml:mo><mml:mo>.</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold></p>
        <p specific-use="line">9     <inline-formula id="pone.0173249.e032"><alternatives><graphic xlink:href="pone.0173249.e032.jpg" id="pone.0173249.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is stable</p>
        <p specific-use="line">10    <bold>else</bold></p>
        <p specific-use="line">11     <inline-formula id="pone.0173249.e033"><alternatives><graphic xlink:href="pone.0173249.e033.jpg" id="pone.0173249.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is unstable</p>
        <p specific-use="line">12    <bold>end</bold></p>
        <p specific-use="line">13    Determine steady-state, <inline-formula id="pone.0173249.e034"><alternatives><graphic xlink:href="pone.0173249.e034.jpg" id="pone.0173249.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtext mathvariant="script">SS</mml:mtext></mml:math></alternatives></inline-formula>, from <inline-formula id="pone.0173249.e035"><alternatives><graphic xlink:href="pone.0173249.e035.jpg" id="pone.0173249.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">14    Assign steady-state stability region as <inline-formula id="pone.0173249.e036"><alternatives><graphic xlink:href="pone.0173249.e036.jpg" id="pone.0173249.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="script">SS</mml:mtext><mml:mo>∩</mml:mo><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
        <p specific-use="line">15   <bold>end</bold></p>
        <p specific-use="line">16 <bold>end</bold></p>
        <p specific-use="line">17 Plot <inline-formula id="pone.0173249.e037"><alternatives><graphic xlink:href="pone.0173249.e037.jpg" id="pone.0173249.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
      </sec>
      <sec id="sec011">
        <title>Basin of attraction analysis</title>
        <p>This algorithm (Algorithm 3) is used to determine the basin of attraction for any pair of variables within <inline-formula id="pone.0173249.e038"><alternatives><graphic xlink:href="pone.0173249.e038.jpg" id="pone.0173249.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, by assessing the influence of their initial conditions on the steady-state. Ecological systems can exhibit multiple stable states within the same parameter space. In other words, depending on the initial conditions, a system may tend towards different equilibrium points representing distinct biological behaviour. For example, the concept of resilience extends the purpose of investigating ecological systems beyond the goal of maintaining equilibrium (stability) to one in which system behaviour is reliant on the nature and character of the basins of attraction and its interaction with external factors [<xref rid="pone.0173249.ref027" ref-type="bibr">27</xref>]. In this way, it is informative to determine the effect that the initial conditions have in driving the system to alternate stable states. This allows for practical interpretation of operating and control strategies to ensure a system remains in the desired basin of attraction [<xref rid="pone.0173249.ref028" ref-type="bibr">28</xref>].</p>
      </sec>
      <sec id="sec012">
        <title>Phase portrait</title>
        <p>The phase portrait algorithm (Algorithm 4) is an alternative approach for visualising the location of state attractors. Unlike the basin of attraction analysis, this routine shows the trajectories of the solutions for the system of ODEs. Critically, it can provide important information on the dynamics of the system in two or three dimensions.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Thermodynamics module</title>
      <p>Mathematical modelling of microbial growth is typically tethered to empirical observations; kinetic models that are derived from experiments with parameters that may have no biological meaning (e.g., the half-saturation constant <italic>K</italic><sub><italic>S</italic></sub> is merely an estimated <italic>shaping factor</italic> that is highly sensitive to both biological and physical characteristics of the process being modelled [<xref rid="pone.0173249.ref029" ref-type="bibr">29</xref>]). Metabolic thermodynamics have been proposed to resolve the weaknesses in purely kinetics based modelling, especially in systems with organisms growing under moderately exergonic conditions where a trade-off between kinetic and thermodynamically favourable conditions become apparent (e.g., anaerobic digestion [<xref rid="pone.0173249.ref030" ref-type="bibr">30</xref>]). Whilst kinetic models are restricted by their underlying mechanics, which govern the rate of change in reaction components, thermodynamics is immutable and describes the stability and direction of the same reaction. In this sense, for energy constrained systems, it defines the feasible <italic>free-energy</italic> conditions under which a species may grow. A number of models propose a framework by which single- and multiple-reactant thermodynamics may be integrated with classical growth kinetics [<xref rid="pone.0173249.ref031" ref-type="bibr">31</xref>–<xref rid="pone.0173249.ref033" ref-type="bibr">33</xref>].</p>
      <p><bold>Algorithm 3:</bold> Basin of attraction analysis</p>
      <p specific-use="line"> <bold>Input:</bold> Θ, <inline-formula id="pone.0173249.e039"><alternatives><graphic xlink:href="pone.0173249.e039.jpg" id="pone.0173249.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic>a</italic><sub><italic>n</italic></sub>, <italic>b</italic><sub><italic>n</italic></sub>, <italic>s</italic><sub><italic>n</italic></sub>, <italic>ϵ</italic></p>
      <p specific-use="line"> <bold>Output:</bold>
<inline-formula id="pone.0173249.e040"><alternatives><graphic xlink:href="pone.0173249.e040.jpg" id="pone.0173249.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>g</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">1 Substitute numerical parameters Θ into system of symbolic ODEs <inline-formula id="pone.0173249.e041"><alternatives><graphic xlink:href="pone.0173249.e041.jpg" id="pone.0173249.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">2 Assume <inline-formula id="pone.0173249.e042"><alternatives><graphic xlink:href="pone.0173249.e042.jpg" id="pone.0173249.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and solve algebraically for <inline-formula id="pone.0173249.e043"><alternatives><graphic xlink:href="pone.0173249.e043.jpg" id="pone.0173249.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> to give fixed-point solutions, <inline-formula id="pone.0173249.e044"><alternatives><graphic xlink:href="pone.0173249.e044.jpg" id="pone.0173249.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">3 Select two variable initial conditions to sweep, <italic>x</italic><sub>(1,2)</sub>(0)′, and fix the initial conditions of the other variables, <inline-formula id="pone.0173249.e045"><alternatives><graphic xlink:href="pone.0173249.e045.jpg" id="pone.0173249.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>\<italic>x</italic><sub>(1,2)</sub>(0)</p>
      <p specific-use="line">4 <bold>for</bold>
<italic>x</italic><sub>1</sub>(0) ≔ <italic>a</italic><sub>1</sub>
<bold>to</bold>
<italic>b</italic><sub>1</sub>
<bold>step</bold>
<italic>s</italic><sub>1</sub>
<bold>do</bold></p>
      <p specific-use="line">5   <bold>for</bold>
<italic>x</italic><sub>2</sub>(0) ≔ <italic>a</italic><sub>2</sub>
<bold>to</bold>
<italic>b</italic><sub>2</sub>
<bold>step</bold>
<italic>s</italic><sub>2</sub>
<bold>do</bold></p>
      <p specific-use="line">6    Solve <inline-formula id="pone.0173249.e046"><alternatives><graphic xlink:href="pone.0173249.e046.jpg" id="pone.0173249.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">7    <bold>for</bold>
<italic>ii</italic> ≔ 1 <bold>to</bold>
<italic>g</italic>
<bold>do</bold></p>
      <p specific-use="line">8     Calculate <inline-formula id="pone.0173249.e047"><alternatives><graphic xlink:href="pone.0173249.e047.jpg" id="pone.0173249.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">9     <bold>if</bold>
<inline-formula id="pone.0173249.e048"><alternatives><graphic xlink:href="pone.0173249.e048.jpg" id="pone.0173249.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold></p>
      <p specific-use="line">10      Fixed-point attractor is <inline-formula id="pone.0173249.e049"><alternatives><graphic xlink:href="pone.0173249.e049.jpg" id="pone.0173249.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">11     <bold>else</bold></p>
      <p specific-use="line">12      Fixed-point attractor ∄</p>
      <p specific-use="line">13     <bold>end</bold></p>
      <p specific-use="line">14     Determine steady-state, <inline-formula id="pone.0173249.e050"><alternatives><graphic xlink:href="pone.0173249.e050.jpg" id="pone.0173249.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mtext mathvariant="script">SS</mml:mtext></mml:math></alternatives></inline-formula>, from <inline-formula id="pone.0173249.e051"><alternatives><graphic xlink:href="pone.0173249.e051.jpg" id="pone.0173249.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">15    <bold>end</bold></p>
      <p specific-use="line">16   <bold>end</bold></p>
      <p specific-use="line">17 <bold>end</bold></p>
      <p specific-use="line">18 Plot <inline-formula id="pone.0173249.e052"><alternatives><graphic xlink:href="pone.0173249.e052.jpg" id="pone.0173249.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mrow><mml:mtext mathvariant="script">SS</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p><bold>Algorithm 4:</bold> Calculation of Phase Portrait</p>
      <p specific-use="line"> <bold>Input:</bold> Θ, <inline-formula id="pone.0173249.e053"><alternatives><graphic xlink:href="pone.0173249.e053.jpg" id="pone.0173249.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic>a</italic><sub><italic>n</italic></sub>, <italic>b</italic><sub><italic>n</italic></sub>, <italic>s</italic><sub><italic>n</italic></sub></p>
      <p specific-use="line"> <bold>Output:</bold>
<inline-formula id="pone.0173249.e054"><alternatives><graphic xlink:href="pone.0173249.e054.jpg" id="pone.0173249.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">1 Solve <inline-formula id="pone.0173249.e055"><alternatives><graphic xlink:href="pone.0173249.e055.jpg" id="pone.0173249.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>for</bold>
<inline-formula id="pone.0173249.e056"><alternatives><graphic xlink:href="pone.0173249.e056.jpg" id="pone.0173249.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
<bold>step</bold>
<italic>s</italic><sub><italic>n</italic></sub></p>
      <p specific-use="line">2 Plot <inline-formula id="pone.0173249.e057"><alternatives><graphic xlink:href="pone.0173249.e057.jpg" id="pone.0173249.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p>We have implemented the simplest approach to incorporating thermodynamics, which only considers replacement of a kinetic inhibition function with one describing the effect of available energy on microbial growth. The function does not describe the thermodynamic energy required for anabolism, i.e. cellular maintenance or biomass production, and is only necessary when considering cases in which the free energy is limiting. We feel that this is an adequate method for implementing thermodynamics in models that describe an average behaviour of a microbial community, rather than individual based models where spatial diversity may also be considered [<xref rid="pone.0173249.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0173249.ref034" ref-type="bibr">34</xref>]. Furthermore, more complex thermodynamic models, although useful in general microbial ecology modelling, may make the analyses provided here intractable. Extension of the thermodynamics is, therefore, not included here. The general form of the growth function using this inhibition term is given by:
<disp-formula id="pone.0173249.e058"><alternatives><graphic xlink:href="pone.0173249.e058.jpg" id="pone.0173249.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic>k</italic><sub><italic>m</italic>,<italic>i</italic></sub> is the maximum specific growth rate of species <italic>i</italic> and:
<disp-formula id="pone.0173249.e059"><alternatives><graphic xlink:href="pone.0173249.e059.jpg" id="pone.0173249.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msup></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where the Gibbs free energy change in the reaction is given by the standard equation:
<disp-formula id="pone.0173249.e060"><alternatives><graphic xlink:href="pone.0173249.e060.jpg" id="pone.0173249.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo form="prefix">ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mo>∏</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>π</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∏</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ν</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where Δ<italic>G</italic><sup>0</sup>′ is the Gibbs free energy of all unmixed chemical species in the reaction (adjusted for temperature using Van’t Hoff’s equation), <italic>S</italic><sub><italic>π</italic></sub> are the reaction products, <italic>S</italic><sub><italic>ν</italic></sub> are the reactants/substrates, <italic>R</italic> is the universal gas constant, and <italic>T</italic> is the temperature.</p>
      <p>This module is available upon selection of the <italic>thermodynamics</italic> option from the <monospace>MI-SIM</monospace> interface. The growth model functions, <italic>f</italic><sub><italic>n</italic></sub>, default to Monod form in all cases.</p>
      <p>The thermodynamic calculator comprises three steps:</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>System specification</bold>: The user should enter the operating temperature (K), reaction Δ<italic>G</italic><sup>0</sup> (kJ/mol), and the index of reactants (<italic>r</italic>) and products (<italic>p</italic>) in the reaction. Δ<italic>G</italic><sup>0</sup> can be set to zero if the user wishes to automatically calculate the Δ<italic>G</italic> value for each component of the reaction from the drop-down menus. For compounds not available in these menus, the cumulative Δ<italic>G</italic> values must be entered in the Δ<italic>G</italic><sup>0</sup> box provided. Although <italic>r</italic> and <italic>p</italic> are set to one in all cases, it is necessary here to specify the actual reaction stoichiometry to properly define its thermodynamics. Hence, there may be more reactants or products involved that are not explicitly modelled by <monospace>MI-SIM</monospace>. A simple text display of the reaction is provided to indicate the substrates, <inline-formula id="pone.0173249.e061"><alternatives><graphic xlink:href="pone.0173249.e061.jpg" id="pone.0173249.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and biomass <italic>X</italic><sub><italic>n</italic></sub> involved in the conversion.</p>
        </list-item>
        <list-item>
          <p><bold>Compound specification</bold>: In the central block of the calculator, the user may input stoichiometric information for each reactant and product featured in the reaction. This includes the number of moles of substrate and product, the molar mass of each compound (g/mol) and, if required, the option to calculate the Gibbs free energy for each compound. For the latter, the user must specify the compound using drop-down menus to choose the chemical system where it is found, and its state (e.g., solid, liquid, aqueous, gas). For the product compounds, the user must specify their stoichiometric coefficient, <italic>γ</italic><sub><italic>p</italic></sub>. It should be noted that the molar mass is only required if the selected system units are mass of COD, whereby an additional conversion term (molarity to units COD, using the molar mass value) is required to calculate the Δ<italic>G</italic><sub><italic>rxn</italic></sub>.</p>
        </list-item>
        <list-item>
          <p><bold>Calculation</bold>: The calculation of the thermodynamic inhibition function is executed by pressing the <italic>Calculate</italic> button. The values for the compound specific <inline-formula id="pone.0173249.e062"><alternatives><graphic xlink:href="pone.0173249.e062.jpg" id="pone.0173249.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> at temperature <italic>T</italic> are taken from the Δ<italic>G</italic><sup>0</sup> tables [<xref rid="pone.0173249.ref035" ref-type="bibr">35</xref>]. Polynomial curve fitting of order 2 is used to determine the Δ<italic>G</italic><sup>0</sup> values for the user-specified temperature, based on the temperature dependent curves developed from the values in the cited tables.</p>
        </list-item>
      </list>
      <p>The <italic>Add Sn to ODE</italic> function automatically defines equations for the additional substrates and products (<italic>S</italic><sub><italic>ν</italic>,<italic>new</italic></sub> and <italic>S</italic><sub><italic>π</italic>,<italic>new</italic></sub>) not currently included in the selected motif. In the case additional reactants (<italic>S</italic><sub><italic>ν</italic>,<italic>new</italic></sub>) are included, a reconfiguration of the growth function (<italic>f</italic><sub><italic>new</italic></sub>) for biomass <italic>X</italic><sub><italic>n</italic></sub> is required to account for its growth on these additional substrate (<italic>μ</italic><sub><italic>new</italic></sub>). The generic form of the additional equations are as follows:
<disp-formula id="pone.0173249.e063"><alternatives><graphic xlink:href="pone.0173249.e063.jpg" id="pone.0173249.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pone.0173249.e064"><alternatives><graphic xlink:href="pone.0173249.e064.jpg" id="pone.0173249.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula>
<disp-formula id="pone.0173249.e065"><alternatives><graphic xlink:href="pone.0173249.e065.jpg" id="pone.0173249.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pone.0173249.e066"><alternatives><graphic xlink:href="pone.0173249.e066.jpg" id="pone.0173249.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(9)</label></disp-formula></p>
      <p>The <italic>Finish</italic> button closes the thermodynamic calculator module and returns the user to the main GUI interface.</p>
    </sec>
    <sec id="sec014">
      <title>Example: A three-tiered food-web</title>
      <p>To demonstrate the functionality of <monospace>MI-Sim</monospace>, we analysed a three-tiered microbial food-web with competitive and syntrophic interactions, as shown in <xref ref-type="fig" rid="pone.0173249.g001">Fig 1</xref>, and described by Eqs (<xref ref-type="disp-formula" rid="pone.0173249.e067">10</xref>)–(<xref ref-type="disp-formula" rid="pone.0173249.e076">19</xref>), with units expressed in COD. To parameterise the model, we took the values given in a previous analysis performed independently of <monospace>MI-Sim</monospace> [<xref rid="pone.0173249.ref015" ref-type="bibr">15</xref>], with a revised and more realistic value for the substrate affinity constant, <italic>K</italic><sub><italic>S</italic>,1</sub>, shown in <xref rid="pone.0173249.t003" ref-type="table">Table 3</xref>. The model is described by the six ODEs:
<disp-formula id="pone.0173249.e067"><alternatives><graphic xlink:href="pone.0173249.e067.jpg" id="pone.0173249.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>in</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(10)</label></disp-formula>
<disp-formula id="pone.0173249.e068"><alternatives><graphic xlink:href="pone.0173249.e068.jpg" id="pone.0173249.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>dec</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(11)</label></disp-formula>
<disp-formula id="pone.0173249.e069"><alternatives><graphic xlink:href="pone.0173249.e069.jpg" id="pone.0173249.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>in</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(12)</label></disp-formula>
<disp-formula id="pone.0173249.e070"><alternatives><graphic xlink:href="pone.0173249.e070.jpg" id="pone.0173249.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>dec</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(13)</label></disp-formula>
<disp-formula id="pone.0173249.e071"><alternatives><graphic xlink:href="pone.0173249.e071.jpg" id="pone.0173249.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mtext>in</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(14)</label></disp-formula>
<disp-formula id="pone.0173249.e072"><alternatives><graphic xlink:href="pone.0173249.e072.jpg" id="pone.0173249.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>dec</mml:mtext><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(15)</label></disp-formula>
where:
<disp-formula id="pone.0173249.e073"><alternatives><graphic xlink:href="pone.0173249.e073.jpg" id="pone.0173249.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(16)</label></disp-formula>
<disp-formula id="pone.0173249.e074"><alternatives><graphic xlink:href="pone.0173249.e074.jpg" id="pone.0173249.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(17)</label></disp-formula>
<disp-formula id="pone.0173249.e075"><alternatives><graphic xlink:href="pone.0173249.e075.jpg" id="pone.0173249.e075g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M75"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(18)</label></disp-formula>
<disp-formula id="pone.0173249.e076"><alternatives><graphic xlink:href="pone.0173249.e076.jpg" id="pone.0173249.e076g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(19)</label></disp-formula>
We selected values of two operating parameters as dilution rate, <italic>D</italic> = 0.01 d<sup>−1</sup>, such that <italic>D</italic> &lt; max(<italic>k</italic><sub><italic>m</italic>,<italic>n</italic></sub><italic>Y</italic><sub><italic>m</italic>,<italic>n</italic></sub>), and substrate input concentration, <italic>S</italic><sub>1,in</sub> = 5 kgCOD/m<sup>3</sup>. Arbitrarily setting the initial conditions for the six variables to 0.1 and selecting the stiff ODE solver <italic>odes23s</italic> with default tolerances, we ran the single-point analysis for 100 days and observed that steady-state was reached after approximately 70 days, as shown in <xref ref-type="fig" rid="pone.0173249.g002">Fig 2a</xref>. A trajectory plot showing the dynamical relationship between species <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>3</sub> is shown in <xref ref-type="fig" rid="pone.0173249.g002">Fig 2b</xref>. These plots can be compared to the results of the fixed-point analysis, which are displayed in the GUI window, and presented here in <xref rid="pone.0173249.t004" ref-type="table">Table 4</xref>. The results show that four fixed points (FP), <inline-formula id="pone.0173249.e077"><alternatives><graphic xlink:href="pone.0173249.e077.jpg" id="pone.0173249.e077g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M77"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, are possible for the given parameters: i) complete washout of the three species (FP1), ii) washout of species <italic>X</italic><sub>3</sub> (FP2/FP3), and iii) maintenance of all three species (FP4). Given the initial conditions (ICs), the steady-state reached is case iii), which is verified by examining both of the figures.</p>
      <fig id="pone.0173249.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A three species food-web with competitive and syntrophic interactions.</title>
          <p>The black arrows represent substrate/nutrient flow through the system and the orange arrow is the non-competitive inhibition of X2 by the substrate S3.</p>
        </caption>
        <graphic xlink:href="pone.0173249.g001"/>
      </fig>
      <table-wrap id="pone.0173249.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Model parameters for the three-tiered food-web example.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0173249.t003g" xlink:href="pone.0173249.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Parameter</th>
                <th align="left" rowspan="1" colspan="1">Value</th>
                <th align="left" rowspan="1" colspan="1">Units</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub><italic>m</italic>,1</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">29.12</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>S</italic></sub>/kgCOD<sub><italic>X</italic></sub>/d</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>K</italic>
                  <sub><italic>S</italic>,1</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">5.2×10<sup>−5</sup></td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Y</italic>
                  <sub>1</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.019</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>X</italic></sub>/kgCOD<sub><italic>S</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub>dec,1</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
                <td align="left" rowspan="1" colspan="1">days<sup>−1</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub><italic>m</italic>,2</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">26</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>S</italic></sub>/kgCOD<sub><italic>X</italic></sub>/d</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>K</italic>
                  <sub><italic>S</italic>,2</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.302</td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Y</italic>
                  <sub>2</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.04</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>X</italic></sub>/kgCOD<sub><italic>S</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub>dec,2</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
                <td align="left" rowspan="1" colspan="1">days<sup>−1</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub><italic>m</italic>,3</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">35</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>S</italic></sub>/kgCOD<sub><italic>X</italic></sub>/d</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>K</italic>
                  <sub><italic>S</italic>,3</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">2.5×10<sup>−5</sup></td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Y</italic>
                  <sub>3</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.06</td>
                <td align="left" rowspan="1" colspan="1">kgCOD<sub><italic>X</italic></sub>/kgCOD<sub><italic>S</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>k</italic>
                  <sub>dec,3</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
                <td align="left" rowspan="1" colspan="1">days<sup>−1</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>K</italic>
                  <sub><italic>i</italic>,3</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">3.5×10<sup>−6</sup></td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>γ</italic>
                  <sub>0</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">1.0769</td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>γ</italic>
                  <sub>1</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.1429</td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>γ</italic>
                  <sub>2</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0.0769</td>
                <td align="left" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>2,in</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>3,in</sub>
                </td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">kgCOD/m<sup>3</sup></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <fig id="pone.0173249.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Single-point analysis results showing (a) the three-tiered motif dynamics and (b) a phase portrait of the fixed-point attractors for X1 against X3, with X1(0) = 0.06 and X3(0) = 0.02 kgCOD/m<sup>3</sup>.</title>
        </caption>
        <graphic xlink:href="pone.0173249.g002"/>
      </fig>
      <table-wrap id="pone.0173249.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Fixed-point and stability analysis results for the example considered.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0173249.t004g" xlink:href="pone.0173249.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Fixed-point</th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>1</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>X</italic>
                  <sub>1</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>2</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>X</italic>
                  <sub>2</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>3</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>X</italic>
                  <sub>3</sub>
                </th>
                <th align="center" rowspan="1" colspan="1">Stability</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">FP1</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">Stable spiral</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">FP2</td>
                <td align="center" rowspan="1" colspan="1">4.91</td>
                <td align="center" rowspan="1" colspan="1">1.37 × 10<sup>−3</sup></td>
                <td align="center" rowspan="1" colspan="1">0.04</td>
                <td align="center" rowspan="1" colspan="1">1.62 × 10<sup>−3</sup></td>
                <td align="center" rowspan="1" colspan="1">2.77 × 10<sup>−7</sup></td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">Unstable</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">FP3</td>
                <td align="center" rowspan="1" colspan="1">1.51 × 10<sup>−5</sup></td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">2.48</td>
                <td align="center" rowspan="1" colspan="1">0.09</td>
                <td align="center" rowspan="1" colspan="1">2.35 × 10<sup>−5</sup></td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">Unstable</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">FP4</td>
                <td align="center" rowspan="1" colspan="1">2.93 × 10<sup>−5</sup></td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">0.06</td>
                <td align="center" rowspan="1" colspan="1">0.17</td>
                <td align="center" rowspan="1" colspan="1">1.52 × 10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">0.02</td>
                <td align="center" rowspan="1" colspan="1">Stable node</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Additionally, stability analysis indicates that the system is bistable (FP1 and FP4) for the selected operating parameters, and the <italic>basin of attraction</italic> routine is subsequently used to determine which attractor (fixed-point) the system will converge to, given a range of ICs. This is shown in <xref ref-type="fig" rid="pone.0173249.g003">Fig 3a</xref>, in which the influence of changing the ICs for <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>3</sub> is observed. The result indicates that there is a critical ratio for the two initial biomass concentrations (<italic>r</italic><sub>1,3</sub> = <italic>X</italic><sub>1</sub>(0)/<italic>X</italic><sub>3</sub>(0)) defining a boundary between FP1 and FP4. If <italic>r</italic><sub>1,3</sub> ≥ 0.707 and <inline-formula id="pone.0173249.e078"><alternatives><graphic xlink:href="pone.0173249.e078.jpg" id="pone.0173249.e078g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M78"><mml:mrow><mml:mo>{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, then <inline-formula id="pone.0173249.e079"><alternatives><graphic xlink:href="pone.0173249.e079.jpg" id="pone.0173249.e079g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M79"><mml:mrow><mml:mtext mathvariant="script">SS</mml:mtext><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (steady-state 3 ≡ FP4) is assured. It should be noted that steady-states may comprise of one or two fixed-points in this example.</p>
      <fig id="pone.0173249.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Output from multiple-point algorithms showing (a) basin of attraction analysis varying the initial conditions for X1 and X3, and (b) multiple-point steady-state existence and stability of the three-tiered motif.</title>
        </caption>
        <graphic xlink:href="pone.0173249.g003"/>
      </fig>
      <p>We also performed the analysis for multiple operating points (<italic>D</italic>, <italic>S</italic><sub>1,in</sub>). This enables the user to visualise the transitions (bifurcations) between steady-state regions and their stability. It can be used to show the theoretical operating space necessary to attain a desired objective, such as community stability. In this example, three regions are identified corresponding to the fixed-points FP1–FP4. These regions also indicate the stability of the system at each point in the two-dimensional operating space and, together, we denote these regions as <inline-formula id="pone.0173249.e080"><alternatives><graphic xlink:href="pone.0173249.e080.jpg" id="pone.0173249.e080g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M80"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0173249.e081"><alternatives><graphic xlink:href="pone.0173249.e081.jpg" id="pone.0173249.e081g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M81"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0173249.e082"><alternatives><graphic xlink:href="pone.0173249.e082.jpg" id="pone.0173249.e082g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M82"><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, as shown in <xref ref-type="fig" rid="pone.0173249.g003">Fig 3b</xref> and <xref rid="pone.0173249.t005" ref-type="table">Table 5</xref>. It is observed that <inline-formula id="pone.0173249.e083"><alternatives><graphic xlink:href="pone.0173249.e083.jpg" id="pone.0173249.e083g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M83"><mml:mrow><mml:mtext mathvariant="script">SS</mml:mtext><mml:mn>1</mml:mn><mml:mo>≡</mml:mo><mml:mtext>FP</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> is always stable, whilst <inline-formula id="pone.0173249.e084"><alternatives><graphic xlink:href="pone.0173249.e084.jpg" id="pone.0173249.e084g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M84"><mml:mrow><mml:mtext mathvariant="script">SS</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> is associated with two fixed points (FP2, FP3) where it exists, one of which is always unstable.</p>
      <table-wrap id="pone.0173249.t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0173249.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Multiple-point stability analysis.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0173249.t005g" xlink:href="pone.0173249.t005"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Region</th>
                <th align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e085">
                    <alternatives>
                      <graphic id="pone.0173249.e085g" xlink:href="pone.0173249.e085"/>
                      <mml:math id="M85">
                        <mml:mrow>
                          <mml:mtext mathvariant="script">SS</mml:mtext>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e086">
                    <alternatives>
                      <graphic id="pone.0173249.e086g" xlink:href="pone.0173249.e086"/>
                      <mml:math id="M86">
                        <mml:mrow>
                          <mml:mtext mathvariant="script">SS</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e087">
                    <alternatives>
                      <graphic id="pone.0173249.e087g" xlink:href="pone.0173249.e087"/>
                      <mml:math id="M87">
                        <mml:mrow>
                          <mml:mtext mathvariant="script">SS</mml:mtext>
                          <mml:mn>3</mml:mn>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e088">
                    <alternatives>
                      <graphic id="pone.0173249.e088g" xlink:href="pone.0173249.e088"/>
                      <mml:math id="M88">
                        <mml:msub>
                          <mml:mi mathvariant="script">J</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="center" rowspan="1" colspan="1">Stable</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e089">
                    <alternatives>
                      <graphic id="pone.0173249.e089g" xlink:href="pone.0173249.e089"/>
                      <mml:math id="M89">
                        <mml:msub>
                          <mml:mi mathvariant="script">J</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="center" rowspan="1" colspan="1">Stable</td>
                <td align="center" rowspan="1" colspan="1">Unstable/Stable</td>
                <td align="center" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <inline-formula id="pone.0173249.e090">
                    <alternatives>
                      <graphic id="pone.0173249.e090g" xlink:href="pone.0173249.e090"/>
                      <mml:math id="M90">
                        <mml:msub>
                          <mml:mi mathvariant="script">J</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="center" rowspan="1" colspan="1">Stable</td>
                <td align="center" rowspan="1" colspan="1">Unstable/Unstable</td>
                <td align="center" rowspan="1" colspan="1">Stable</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec015">
      <title>Limitations and future work</title>
      <sec id="sec016">
        <title>Access</title>
        <p>Whilst the software is currently only available for use with <monospace>MATLAB</monospace>, which is proprietary and may thus limit its accessibility, much of the functionality, such as access to analytical solvers, and integrated high-quality visualisation, provides an advantage over alternative open-source languages such as <monospace>Octave</monospace>. Development of a similar tool using <monospace>C++</monospace> or <monospace>Python</monospace> may be plausible but limited, whilst <monospace>MATLAB</monospace> provides the opportunity for rapid development in a stable and multi-functional software. Furthermore, as <xref rid="pone.0173249.t001" ref-type="table">Table 1</xref> indicates, many of the available dynamical system analysis software are provided as <monospace>MATLAB</monospace> toolboxes, have versions available in <monospace>MATLAB</monospace>, or allow for downstream analysis with <monospace>MATLAB</monospace> compatible files. One drawback of the current version of is the inability of the user to define their own systems of equations. Taking <monospace>MATCONT</monospace> as an example [<xref rid="pone.0173249.ref020" ref-type="bibr">20</xref>], further development of the software will introduce a <italic>Model Builder</italic> functionality for bespoke systems of ODEs.</p>
      </sec>
      <sec id="sec017">
        <title>Computational performance</title>
        <p><monospace>MI-Sim</monospace> employs a number of algorithms that may be computationally expensive. This can be an issue in <monospace>MATLAB</monospace>, especially when nested loops are used. We have attempted to overcome performance concerns by using vectorisation instead of loops wherever possible and by making use of <monospace>MATLAB</monospace> specific commands such as <italic>matlabFunction</italic> for handling symbolic manipulation. In the case where loops are unavoidable, increasing the resolution of the output by specifying larger numbers of calculation points will significantly impact performance. This is most relevant for higher-dimensional models, such as the three-tiered motif we include in the software. This is a challenging system to solve using <monospace>MATLAB</monospace>, so we employ <monospace>MuPad</monospace>, which has a powerful symbolic engine that can solve complex systems of ODEs to generate all possible solutions. In <monospace>MATLAB</monospace>, the solutions may be incomplete and overriding the constraints for such systems results in failure. The <monospace>MuPad</monospace> option is computationally costly, but once solutions are found, subsequent analysis can be parallelised to significantly improve performance.</p>
      </sec>
      <sec id="sec018">
        <title>Dimensionality</title>
        <p>The current version of <monospace>MI-Sim</monospace> allows for the analysis of seven motifs comprised of two or three species, described by up to six ODEs. Theoretically, <monospace>MATLAB</monospace> can solve higher-dimensional systems of ODEs numerically, but this is dependent on the memory available to the CPU. For stiff problems, ODE solvers allocate memory for solution vectors of length <italic>n</italic> and a Jacobian matrix of size <italic>n</italic> × <italic>n</italic>. It is recommended to use the <italic>Jacobian</italic> solver option for these cases. The restriction to systems of six ODEs or less is necessary to ensure that the software will run on most standard CPUs, however experienced modellers may wish to test the algorithms with larger models. Future development of the software will aim to allow users to enter their equations manually via the interface and automatically configure the parameter, variable and solver options accordingly. Further, greater access to solver options and dimension reduction techniques may overcome some of the memory limitations of <monospace>MI-Sim</monospace>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec019">
    <title>Software implementation</title>
    <p><monospace>MI-Sim</monospace> has been developed in <monospace>MATLAB</monospace> (R2015a, version 8.5.0) and tested on both R2016a and R2016b. In order to facilitate the use of the software and to motivate its further development, the <monospace>MI-Sim</monospace> package and documentation have been released at <ext-link ext-link-type="uri" xlink:href="http://mi-sim.github.io">http://mi-sim.github.io</ext-link>. The software is also available for direct download on the Mathworks File Exchange at <ext-link ext-link-type="uri" xlink:href="http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim">http://uk.mathworks.com/matlabcentral/fileexchange/55492-mi-sim</ext-link>.</p>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Conclusion</title>
    <p>We have developed the <monospace>MATLAB</monospace> based software tool <monospace>MI-Sim</monospace> for numerical analysis of ecological interactions. The tool is built on a system of ODEs encompassing three to six dimensions. <monospace>MI-Sim</monospace> allows for the rigorous analysis of a range of standard two species interaction motifs as well as an extended motif of three species. As well as profiling of the motif dynamics for a user-defined set of parameters, <monospace>MI-Sim</monospace> also provides the capability to analyse the system in a two- or three-dimensional parameter space to enable investigation of system properties such as existence and stability of steady-states and bifurcation trajectories. In cases where the motif contains multi-stable regions, the basin of attraction tool is useful in understanding the role of the initial conditions on the ultimate equilibrium condition. Future releases of <monospace>MI-Sim</monospace> will include the possibility of including user-defined motifs for analysis, as well as a sensitivity analysis tool to explore the effect of parameter uncertainty on the behaviour and properties of the system.</p>
    <p><monospace>MI-Sim</monospace> is a easy to use tool that does not require an in-depth understanding of the mathematics behind dynamical systems theory and can be used for determining the behaviour of interacting species under a desired operational parameter set. In this sense, as well as theoretical simulations, it may be useful for synthetic biologists and microbial ecologists wishing to understand the conditions or microbial properties that give rise to significant changes (performance, ecology) in simple multiple species systems.</p>
  </sec>
</body>
<back>
  <ack>
    <p>This work was funded by the Biotechnology and Biological Sciences Research Council UK (BB/K003240/2 Engineering synthetic microbial communities for biomethane production) and by the Institute of Sustainability, Newcastle University. The authors would like to thank George Stagg at Newcastle University for his help in setting-up the github repository.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0173249.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Milo</surname><given-names>R</given-names></name>, <name><surname>Shen-Orr</surname><given-names>S</given-names></name>, <name><surname>Itzkovitz</surname><given-names>S</given-names></name>, <name><surname>Kashtan</surname><given-names>N</given-names></name>, <name><surname>Chklovskii</surname><given-names>D</given-names></name>, <name><surname>Alon</surname><given-names>U</given-names></name>. <article-title>Network Motifs: Simple Building Blocks of Complex Networks</article-title>. <source>Science</source>. <year>2002</year>;<volume>298</volume>(<issue>5594</issue>):<fpage>824</fpage>–<lpage>827</lpage>. <pub-id pub-id-type="doi">10.1126/science.298.5594.824</pub-id><?supplied-pmid 12399590?><pub-id pub-id-type="pmid">12399590</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Bascompte</surname><given-names>J</given-names></name>, <name><surname>Melián</surname><given-names>CJ</given-names></name>. <article-title>Simple trophic modules for complex food webs</article-title>. <source>Ecology</source>. <year>2005</year>;<volume>86</volume>(<issue>11</issue>):<fpage>2868</fpage>–<lpage>2873</lpage>. <pub-id pub-id-type="doi">10.1890/05-0101</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Levy</surname><given-names>R</given-names></name>, <name><surname>Carr</surname><given-names>R</given-names></name>, <name><surname>Kreimer</surname><given-names>A</given-names></name>, <name><surname>Freilich</surname><given-names>S</given-names></name>, <name><surname>Borenstein</surname><given-names>E</given-names></name>. <article-title>NetCooperate: a network-based tool for inferring host-microbe and microbe-microbe cooperation</article-title>. <source>BMC Bioinformatics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>164</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0588-y</pub-id><?supplied-pmid 25980407?><pub-id pub-id-type="pmid">25980407</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Bungay</surname><given-names>HR</given-names></name>, <name><surname>Bungay</surname><given-names>ML</given-names></name>. <article-title>Microbial interactions in continuous culture</article-title>. <source>Adv Appl Microbial</source>. <year>1968</year>;<volume>10</volume>:<fpage>269</fpage>–<lpage>312</lpage>. <pub-id pub-id-type="doi">10.1016/S0065-2164(08)70194-1</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Butler</surname><given-names>GJ</given-names></name>, <name><surname>Hsu</surname><given-names>SB</given-names></name>, <name><surname>Waltman</surname><given-names>P</given-names></name>. <article-title>Coexistence of competing predators in a chemostat</article-title>. <source>J Math Biol</source>. <year>1983</year>;<volume>17</volume>:<fpage>133</fpage>–<lpage>151</lpage>. <pub-id pub-id-type="doi">10.1007/BF00305755</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Lauwerier</surname><given-names>HA</given-names></name>, <name><surname>Metz</surname><given-names>JAJ</given-names></name>. <article-title>Hopf bifurcation in host-parasitoid models</article-title>. <source>Inst Math Appl J Math Appl Med Biol</source>. <year>1986</year>;<volume>3</volume>:<fpage>191</fpage>–<lpage>210</lpage>. <pub-id pub-id-type="doi">10.1093/imammb/3.3.191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Großkopf</surname><given-names>T</given-names></name>, <name><surname>Soyer</surname><given-names>O</given-names></name>. <article-title>Synthetic microbial communities</article-title>. <source>Current Opinion in Microbiology</source>. <year>2014</year>;<volume>18</volume>:<fpage>72</fpage>–<lpage>77</lpage>. <pub-id pub-id-type="doi">10.1016/j.mib.2014.02.002</pub-id><?supplied-pmid 24632350?><pub-id pub-id-type="pmid">24632350</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Aris</surname><given-names>R</given-names></name>, <name><surname>Humphrey</surname><given-names>AE</given-names></name>. <article-title>Dynamics of a chemostat in which two organisms compete for a common substrate</article-title>. <source>Biotechnol Bioeng</source>. <year>1977</year>;<volume>19</volume>:<fpage>1357</fpage>–<lpage>1386</lpage>. <pub-id pub-id-type="doi">10.1002/bit.260190910</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kreikenbohm</surname><given-names>R</given-names></name>, <name><surname>Bohl</surname><given-names>E</given-names></name>. <article-title>A mathematical model of syntrophic cocultures in the chemostat</article-title>. <source>FEMS Microbiol Ecol</source>. <year>1986</year>;<volume>38</volume>:<fpage>131</fpage>–<lpage>140</lpage>. <pub-id pub-id-type="doi">10.1016/0378-1097(86)90044-3</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">Sivaprakash B, Karunanithi T, Jayalakshmi S. Modeling of microbial interactions using software and simulation of stable operating conditions in a chemostat. In: Proc. of the International Conference on Technology Systems and Management (ICTSM), 2011. vol. 3. Int. J. Comp. Appl.; 2011. p. 15–22.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Weedermann</surname><given-names>M</given-names></name>, <name><surname>Wolkowicz</surname><given-names>G</given-names></name>, <name><surname>Seo</surname><given-names>G</given-names></name>. <article-title>Mathematical Model of Anaerobic digestion in a chemostat: Effects of syntrophy and inhibition</article-title>. <source>J Biol Dyn</source>. <year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>85</lpage>. <pub-id pub-id-type="doi">10.1080/17513758.2012.755573</pub-id><?supplied-pmid 23336708?><pub-id pub-id-type="pmid">23336708</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Fussmann</surname><given-names>GF</given-names></name>, <name><surname>Ellner</surname><given-names>SP</given-names></name>, <name><surname>Shertzer</surname><given-names>KW</given-names></name>, <name><surname>Hairston</surname><given-names>NG</given-names><suffix>Jr</suffix></name>. <article-title>Crossing the Hopf bifurcation in a live predator-prey system</article-title>. <source>Science</source>. <year>2000</year>;<volume>290</volume>:<fpage>1358</fpage>–<lpage>1360</lpage>,. <pub-id pub-id-type="doi">10.1126/science.290.5495.1358</pub-id><?supplied-pmid 11082063?><pub-id pub-id-type="pmid">11082063</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Gilpin</surname><given-names>ME</given-names></name>. <article-title>Enriched predator-prey systems: theoretical stability</article-title>. <source>Science</source>. <year>1972</year>;<volume>177</volume>:<fpage>902</fpage>–<lpage>904</lpage>. <pub-id pub-id-type="doi">10.1126/science.177.4052.902</pub-id><?supplied-pmid 17780992?><pub-id pub-id-type="pmid">17780992</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>A</given-names></name>, <name><surname>Dolfing</surname><given-names>J</given-names></name>, <name><surname>Curtis</surname><given-names>TP</given-names></name>, <name><surname>Montague</surname><given-names>G</given-names></name>, <name><surname>Martin</surname><given-names>E</given-names></name>. <article-title>Maintenance affects the stability of a two-tiered microbial ‘food chain’?</article-title><source>J Theor Biol</source>. <year>2011</year>;<volume>276</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>41</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2011.01.026</pub-id><?supplied-pmid 21291895?><pub-id pub-id-type="pmid">21291895</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Wade</surname><given-names>MJ</given-names></name>, <name><surname>Pattinson</surname><given-names>RW</given-names></name>, <name><surname>Parker</surname><given-names>NG</given-names></name>, <name><surname>Dolfing</surname><given-names>J</given-names></name>. <article-title>Emergent behaviour in a chlorophenol-mineralising three-tiered microbial ‘food web’</article-title>. <source>J Theor Biol</source>. <year>2016</year>;<volume>389</volume>:<fpage>171</fpage>–<lpage>186</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2015.10.032</pub-id><?supplied-pmid 26551153?><pub-id pub-id-type="pmid">26551153</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Escalante</surname><given-names>AE</given-names></name>, <name><surname>Rebolleda-Gómez</surname><given-names>M</given-names></name>, <name><surname>Benítez</surname><given-names>M</given-names></name>, <name><surname>Travisano</surname><given-names>M</given-names></name>. <article-title>Ecological Perspectives on Synthetic Biology: Insights from Microbial Population Biology</article-title>. <source>Frontiers in Microbiology</source>. <year>2015</year>;<volume>6</volume>(<issue>143</issue>). <pub-id pub-id-type="doi">10.3389/fmicb.2015.00143</pub-id><?supplied-pmid 25767468?><pub-id pub-id-type="pmid">25767468</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Zomorrodi</surname><given-names>AR</given-names></name>, <name><surname>Segrè</surname><given-names>D</given-names></name>. <article-title>Synthetic Ecology of Microbes: Mathematical Models and Applications</article-title>. <source>J Mol Biol</source>. <year>2016</year>; <pub-id pub-id-type="doi">10.1016/j.jmb.2015.10.019</pub-id><?supplied-pmid 26522937?><pub-id pub-id-type="pmid">26522937</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Dankowicz</surname><given-names>H</given-names></name>, <name><surname>Schilder</surname><given-names>F</given-names></name>. <source>Recipes for Continuation</source>. <publisher-loc>Philadelphia</publisher-loc>: <publisher-name>SIAM</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Van Nes E. GRIND for Matlab; 2017. <ext-link ext-link-type="uri" xlink:href="http://www.sparcs-center.org/grind">http://www.sparcs-center.org/grind</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Dhooge</surname><given-names>A</given-names></name>, <name><surname>Govaerts</surname><given-names>W</given-names></name>, <name><surname>Kuznetsov</surname><given-names>YA</given-names></name>. <article-title>matcont: A matlab package for numerical bifurcation analysis of ODEs</article-title>. <source>ACM TOMS</source>. <year>2003</year>;<volume>29</volume>:<fpage>141</fpage>–<lpage>164</lpage>. <pub-id pub-id-type="doi">10.1145/779359.779362</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref021">
      <label>21</label>
      <mixed-citation publication-type="other">Govorukhin VN. MATLAB-based version of DESIR; 2004. <ext-link ext-link-type="uri" xlink:href="http://www.math.rsu.ru/mexmat/kvm/matds">http://www.math.rsu.ru/mexmat/kvm/matds</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">Clewley RH, Sherwood WE, LaMar MD, Guckenheimer JM. PyDSTool, a software environment for dynamical systems modeling; 2007. <ext-link ext-link-type="uri" xlink:href="http://pydstool.sourceforge.net">http://pydstool.sourceforge.net</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Ermentrout B. Simulating, Analyzing, and Animating Dynamical Systems: A Guide to XPPAUT for Researchers and Students. Software, Environments and Tools. SIAM; 2002.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Faust</surname><given-names>K</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>. <article-title>Microbial interactions: From networks to models</article-title>. <source>Nat Rev Micriobiol</source>. <year>2012</year>;<volume>10</volume>:<fpage>538</fpage>–<lpage>550</lpage>. <pub-id pub-id-type="doi">10.1038/nrmicro2832</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>H</given-names></name>, <name><surname>Cannon</surname><given-names>WR</given-names></name>, <name><surname>Beliaev</surname><given-names>AS</given-names></name>, <name><surname>Konopka</surname><given-names>A</given-names></name>. <article-title>Mathematical modeling of microbial community dynamics: A methodological review</article-title>. <source>Processes</source>. <year>2014</year>;<volume>2</volume>:<fpage>711</fpage>–<lpage>752</lpage>. <pub-id pub-id-type="doi">10.3390/pr2040711</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Batstone</surname><given-names>DJ</given-names></name>, <name><surname>Keller</surname><given-names>J</given-names></name>, <name><surname>Angelidaki</surname><given-names>I</given-names></name>, <name><surname>Kalyuzhnyi</surname><given-names>SV</given-names></name>, <name><surname>Pavlostathis</surname><given-names>SG</given-names></name>, <name><surname>Rozzi</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>The IWA Anaerobic Digestion Model No. 1 (ADM1)</article-title>. <source>Wat Sci Technol</source>. <year>2002</year>;<volume>45</volume>(<issue>10</issue>):<fpage>65</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0173249.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Holling</surname><given-names>CS</given-names></name>. <article-title>Resilience and stability of ecological systems</article-title>. <source>Annu Rev Ecol Syst</source>. <year>1973</year>;<volume>4</volume>:<fpage>1</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.es.04.110173.000245</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Fassoni</surname><given-names>AC</given-names></name>, <name><surname>Takahashi</surname><given-names>LT</given-names></name>, <name><surname>dos Santos</surname><given-names>LJ</given-names></name>. <article-title>Basins of attraction of the classic model of competition between two populations</article-title>. <source>Ecol Complexity</source>. <year>2014</year>;<volume>18</volume>:<fpage>39</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1016/j.ecocom.2013.12.004</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Arnaldos</surname><given-names>M</given-names></name>, <name><surname>Amerlinck</surname><given-names>Y</given-names></name>, <name><surname>Rehman</surname><given-names>U</given-names></name>, <name><surname>Maere</surname><given-names>T</given-names></name>, <name><surname>Van Hoey</surname><given-names>S</given-names></name>, <name><surname>Naessens</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>From the affinity constant to the half-saturation index: understanding conventional modeling concepts in novel wastewater treatment processes</article-title>. <source>Wat Res</source>. <year>2015</year>;<volume>70</volume>:<fpage>458</fpage>–<lpage>470</lpage>. <pub-id pub-id-type="doi">10.1016/j.watres.2014.11.046</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Großkopf</surname><given-names>T</given-names></name>, <name><surname>Soyer</surname><given-names>O</given-names></name>. <article-title>Microbial diversity arising from thermodynamic constraints</article-title>. <source>ISME J</source>. <year>2016</year>;<volume>10</volume>(<issue>11</issue>):<fpage>2725</fpage>–<lpage>2733</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2016.49</pub-id><?supplied-pmid 27035705?><pub-id pub-id-type="pmid">27035705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Rodríguez</surname><given-names>J</given-names></name>, <name><surname>Lema</surname><given-names>JM</given-names></name>, <name><surname>Kleerebezem</surname><given-names>R</given-names></name>. <article-title>Energy-based models for environmental biotechnology</article-title>. <source>Trends Biotechnol</source>. <year>2008</year>;<volume>26</volume>(<issue>7</issue>):<fpage>366</fpage>–<lpage>374</lpage>. <pub-id pub-id-type="doi">10.1016/j.tibtech.2008.04.003</pub-id><?supplied-pmid 18513813?><pub-id pub-id-type="pmid">18513813</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>González-Cabaleiro</surname><given-names>R</given-names></name>, <name><surname>Lema</surname><given-names>JM</given-names></name>, <name><surname>Rodríguez</surname><given-names>J</given-names></name>, <name><surname>Kleerebezem</surname><given-names>R</given-names></name>. <article-title>Linking thermodynamics and kinetics to assess pathway reversibility in anaerobic bioprocesses</article-title>. <source>Energy Environ Sci</source>. <year>2013</year>;<volume>6</volume>:<fpage>3780</fpage><pub-id pub-id-type="doi">10.1039/c3ee42754d</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Flamholz</surname><given-names>A</given-names></name>, <name><surname>Noor</surname><given-names>E</given-names></name>, <name><surname>Bar-Even</surname><given-names>A</given-names></name>, <name><surname>Liebermeister</surname><given-names>W</given-names></name>, <name><surname>Milo</surname><given-names>R</given-names></name>. <article-title>Glycolytic strategy as a tradeoff between energy yield and protein cost</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2013</year>;<volume>110</volume>(<issue>24</issue>):<fpage>10039</fpage>–<lpage>10044</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1215283110</pub-id><?supplied-pmid 23630264?><pub-id pub-id-type="pmid">23630264</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Hellweger</surname><given-names>FL</given-names></name>, <name><surname>Clegg</surname><given-names>RJ</given-names></name>, <name><surname>Clark</surname><given-names>JR</given-names></name>, <name><surname>Plugge</surname><given-names>CM</given-names></name>, <name><surname>Kreft</surname><given-names>JU</given-names></name>. <article-title>Advancing microbial sciences by individual-based modelling</article-title>. <source>Nat Rev Microbiol</source>. <year>2016</year>;<volume>14</volume>(<issue>7</issue>):<fpage>461</fpage>–<lpage>471</lpage>. <pub-id pub-id-type="doi">10.1038/nrmicro.2016.62</pub-id><?supplied-pmid 27265769?><pub-id pub-id-type="pmid">27265769</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0173249.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Amend</surname><given-names>JP</given-names></name>, <name><surname>Shock</surname><given-names>EL</given-names></name>. <article-title>Energetics of overall metabolic reactions of thermophilic and hyperthermophilic Archaea and bacteria</article-title>. <source>FEMS Microbiol Ecol</source>. <year>2001</year>;<volume>25</volume>(<issue>2</issue>):<fpage>175</fpage>–<lpage>243</lpage>. <pub-id pub-id-type="doi">10.1111/j.1574-6976.2001.tb00576.x</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
