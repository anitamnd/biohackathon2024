<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8467241</article-id>
    <article-id pub-id-type="publisher-id">7934</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-021-07934-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CAMPAREE: a robust and configurable RNA expression simulator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Lahens</surname>
          <given-names>Nicholas F.</given-names>
        </name>
        <address>
          <email>nif@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Brooks</surname>
          <given-names>Thomas G.</given-names>
        </name>
        <address>
          <email>thobr@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sarantopoulou</surname>
          <given-names>Dimitra</given-names>
        </name>
        <address>
          <email>dimitra.sarantopoulou@nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nayak</surname>
          <given-names>Soumyashant</given-names>
        </name>
        <address>
          <email>soumyashant@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawrence</surname>
          <given-names>Cris</given-names>
        </name>
        <address>
          <email>criswlawrence@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mrčela</surname>
          <given-names>Antonijo</given-names>
        </name>
        <address>
          <email>mrcela@math.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Srinivasan</surname>
          <given-names>Anand</given-names>
        </name>
        <address>
          <email>anand.srinivasan@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schug</surname>
          <given-names>Jonathan</given-names>
        </name>
        <address>
          <email>jschug@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hogenesch</surname>
          <given-names>John B.</given-names>
        </name>
        <address>
          <email>john.hogenesch@cchmc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barash</surname>
          <given-names>Yoseph</given-names>
        </name>
        <address>
          <email>yosephb@seas.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Grant</surname>
          <given-names>Gregory R.</given-names>
        </name>
        <address>
          <email>ggrant@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution>The Institute for Translational Medicine and Therapeutics, Perelman School of Medicine, </institution><institution>University of Pennsylvania, </institution></institution-wrap>Philadelphia, Pennsylvania USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.94365.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 5165</institution-id><institution>Present address: National Institute on Aging, </institution><institution>National Institutes of Health, </institution></institution-wrap>Baltimore, Maryland USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.39953.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2157 0617</institution-id><institution>Statistics and Mathematics Unit, </institution><institution>Indian Statistical Institute, </institution></institution-wrap>Bengaluru, Karnataka India </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution>Perelman School of Medicine, </institution><institution>Enterprise Research Applications and High Performance Computing, Penn Medicine Academic Computing Services, University of Pennsylvania, </institution></institution-wrap>Philadelphia, Pennsylvania USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution>The Institute for Diabetes, Obesity and Metabolism, The Department of Genetics, Perelman School of Medicine, </institution><institution>University of Pennsylvania, </institution></institution-wrap>Philadelphia, Pennsylvania USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.239573.9</institution-id><institution-id institution-id-type="ISNI">0000 0000 9025 8099</institution-id><institution>Division of Human Genetics, Department of Pediatrics, Center for Chronobiology, </institution><institution>Cincinnati Children’s Hospital Medical Center, </institution></institution-wrap>Cincinnati, Ohio USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution>The Department of Genetics, Perelman School of Medicine, </institution><institution>University of Pennsylvania, </institution></institution-wrap>Philadelphia, Pennsylvania USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>692</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The accurate interpretation of RNA-Seq data presents a moving target as scientists continue to introduce new experimental techniques and analysis algorithms. Simulated datasets are an invaluable tool to accurately assess the performance of RNA-Seq analysis methods. However, existing RNA-Seq simulators focus on modeling the technical biases and artifacts of sequencing, rather than on simulating the original RNA samples. A first step in simulating RNA-Seq is to simulate RNA.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To fill this need, we developed the <underline>C</underline>onfigurable <underline>A</underline>nd <underline>M</underline>odular <underline>P</underline>rogram <underline>A</underline>llowing <underline>R</underline>NA <underline>E</underline>xpression <underline>E</underline>mulation (CAMPAREE), a simulator using empirical data to simulate diploid RNA samples at the level of individual molecules. We demonstrated CAMPAREE’s use for generating idealized coverage plots from real data, and for adding the ability to generate allele-specific data to existing RNA-Seq simulators that do not natively support this feature.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Separating input sample modeling from library preparation/sequencing offers added flexibility for both users and developers to mix-and-match different sample and sequencing simulators to suit their specific needs. Furthermore, the ability to maintain sample and sequencing simulators independently provides greater agility to incorporate new biological findings about transcriptomics and new developments in sequencing technologies. Additionally, by simulating at the level of individual molecules, CAMPAREE has the potential to model molecules transcribed from the same genes as a heterogeneous population of transcripts with different states of degradation and processing (splicing, editing, etc.). CAMPAREE was developed in Python, is open source, and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/itmat/CAMPAREE">https://github.com/itmat/CAMPAREE</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12864-021-07934-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Simulation</kwd>
      <kwd>Benchmarking</kwd>
      <kwd>RNA-Seq</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Library of Medicine (US)</institution>
        </funding-source>
        <award-id>R21-LM012763-01A1</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006108</institution-id>
            <institution>National Center for Advancing Translational Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5UL1TR000003</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">High-throughput sequencing of RNA (RNA-Seq) has quickly become the standard method for assaying the population of transcripts in a given tissue or cell. As this technology continues to mature and evolve, many researchers have developed software tools to analyze sequencing data accurately and efficiently. Large-scale benchmarking studies to assess the relative performance of these programs across various stages in the RNA-Seq analysis pipeline help researchers navigate this fluid landscape of analysis tools [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. While we would ideally perform benchmarking studies on real datasets where we know the true abundance of each transcript, it is not possible with current technologies to characterize the full transcriptome of any real sample with sufficient accuracy to achieve all critical goals of the benchmarking community. For this reason, simulated data provide an invaluable tool for the benchmarker’s arsenal.</p>
    <p id="Par10">Despite the strong demand for simulated data, there are only a few RNA-Seq simulators which generate data at the read-level. These include the FLUX simulator [<xref ref-type="bibr" rid="CR6">6</xref>], BEERS [<xref ref-type="bibr" rid="CR7">7</xref>], RSEM [<xref ref-type="bibr" rid="CR8">8</xref>], and Polyester [<xref ref-type="bibr" rid="CR9">9</xref>]. The FLUX simulator models some of the biases introduced during RNA-Seq library preparation but does not model polymorphisms such as indels and substitutions. BEERS simulates variants, errors, variable intron signal, and non-uniform sequence coverage, and despite being originally designed to benchmark aligners has since been adapted for use with transcript reconstruction and alternative splicing analyses [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The simulator included with RSEM develops an empirical model of gene expression by quantifying real RNA-Seq datasets and using the expression parameters as the basis for simulation. Polyester, in addition to simulating coverage biases present in real data, is designed to generate full experiments with multiple biological replicates. It has also been adapted to include a model of GC-bias in coverage and for use with single-cell RNA-Seq data [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. While these simulators have been used in various benchmarking studies to great effect, they are primarily focused on capturing the biases introduced during RNA-Seq library preparation and sequencing. To date there has been little focus placed on realistic simulation of an RNA sample; the milieu of RNA molecules, often transcribed from a diploid genome, that serves as input for the molecular biology of library preparation and sequencing.</p>
    <p id="Par11">There are several advantages a molecule-level simulation of input RNA samples has over traditional generative models that are integrated directly into RNA-Seq simulators. First, it provides a more natural parallel to real RNA-Seq experiments, where purified RNA serves as input for the various molecular biology steps required to prepare and sequence the sample. Second, working at the level of individual molecules, rather than gene models, allows us to simulate the heterogeneous populations of RNA we expect to see in real samples. These include molecules produced from the same gene that are in different states of transcription, editing, splicing, and degradation [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. Additionally, many RNA samples are collections of transcripts from heterogeneous sources like multiple cancer cell populations, unstable viral genomes, or contamination from microorganisms [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. As we develop a greater appreciation for the clinical significance of these biological processes and develop new methods to search for them, it is critical that we also have simulated data that reflect these phenomena. Third, we gain greater fidelity in our ability to diagnose where and how analysis algorithms yield inaccurate results. If a particular set of reads fails to align, or incorrectly drives normalization and differential expression, we can trace the paths these reads took through the RNA-Seq protocol back to their precursor molecules and intermediates to look for common features. On the whole, molecule-level simulations will give us much tighter control over the parameters we use to develop and test analysis software and are likely to yield more realistic data.</p>
    <p id="Par12">Here we present the <underline>C</underline>onfigurable <underline>A</underline>nd <underline>M</underline>odular <underline>P</underline>rogram <underline>A</underline>llowing <underline>R</underline>NA <underline>E</underline>xpression <underline>E</underline>mulation (CAMPAREE), a simulator designed to generate realistic RNA samples at the molecular level from diploid genomes. CAMPAREE works by calculating empirical distributions for gene, isoform, intronic, and allelic expression from real data, and producing a collection of full-length transcripts. These distributions are based on a given transcript annotation that must have both gene- and isoform-level information. The output of CAMPAREE is intended primarily to prime other RNA-Seq simulators, which will then model the biases introduced by library preparation and sequencing. Additionally, the model underlying this simulation makes CAMPAREE output useful for creating idealized representations of coverage plots, separating out signals across different isoforms and alleles. CAMPAREE is an open source program written in Python3 and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/itmat/CAMPAREE">https://github.com/itmat/CAMPAREE</ext-link>. Since CAMPAREE bases its gene expression on given annotations, it can simulate any form of RNA (short, long, etc.) that is reflected in the input annotation.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>CAMPAREE configuration and input</title>
      <p id="Par13">The CAMPAREE pipeline uses a configuration file to give users detailed control over the inputs, outputs, and execution of the simulation. This includes two important options: the ability to specify the job scheduler if running in a cluster environment, and a seed value for random number generation. CAMPAREE currently supports Load Sharing Facility (LSF) and Sun Grid Engine (SGE) cluster environments, as well as serial execution on a single machine. The seed value is critical for reproducibility, as two CAMPAREE runs initiated with the same seed value and input files will yield identical results (even if they are run serially or using a different job scheduler). If a user does not specify a seed value when running the pipeline, CAMPAREE will report a seed value that can be used to duplicate its results. We recommend that users include these seed values when reporting any CAMPAREE results.</p>
      <p id="Par14">In order to run successfully, CAMPAREE requires an organism’s genome sequence in FASTA format, a gene/transcript annotation in GTF format, and a file indicating the ploidy of chromosomes for each gender of the organism (if the user wants to generate diploid data). Using these files, CAMPAREE will generate a genome index with STAR v2.5.2a [<xref ref-type="bibr" rid="CR22">22</xref>], although the user can provide a pre-built index as long as it is compatible with the same version of STAR. For individual simulation runs, CAMPAREE accepts a pair of files per simulated sample containing raw, unnormalized and unaligned paired-end RNA-Seq reads in FASTQ or FASTA format. Typically, these will consist of a related set of samples (e.g. two sets of samples from different experimental conditions). The current version of CAMPAREE requires raw input data (FASTQ, and optional BAM files) from paired-end, strand-specific sequencing experiments. Also, in order to simulate diploid data, CAMPAREE currently requires that each input sample is generated from a single, individual organism rather than a pool. CAMPAREE begins by using STAR to align these FASTQ files to the reference genome index. Users may also provide their own genome-aligned BAM files to skip this step, as long as the alignments in the BAM file are sorted in chromosome coordinate order. See Additional file <xref rid="MOESM1" ref-type="media">1</xref> for a table listing the inputs and outputs for each step in the CAMPAREE pipeline.</p>
    </sec>
    <sec id="Sec4">
      <title>Variant finding and phasing</title>
      <p id="Par15">In order to simulate diploid genomes for each of the input samples, CAMPAREE identifies genetic variants represented in the input data. The variant finder step takes the indexed BAM file generated by the genome alignment step and parses all the alignments to identify loci that differ from the reference by single-nucleotide variants (SNVs), insertions, or deletions. For variant calling, reads are discarded if they map to multiple locations in the reference. Additionally, if multiple reads have identical alignments, they are treated like PCR duplicates and collapsed down to a single alignment for counting purposes. Insertions and deletions in a given alignment are identified from ‘I’ and ‘D’ entries in the CIGAR string, respectively. SNVs are identified as single bases that differ from the reference base. For a variant to be retained, it must be represented in at least 3 % of the distinct, uniquely-aligned reads overlapping the locus. Lastly, no variant is retained if it is present in only a single alignment. Once CAMPAREE compiles the list of variants for each sample, it uses BEAGLE v5.0 [<xref ref-type="bibr" rid="CR23">23</xref>] to perform haplotype phasing (i.e. determine which variants are on the same parental chromosome together). Note that BEAGLE requires at least two samples to perform this phasing operation, so users that wish to simulate data from diploid genomes must provide at least two input samples, or their own phased VCF file.</p>
    </sec>
    <sec id="Sec5">
      <title>Generating parental genomes and transcript annotations</title>
      <p id="Par16">Through the combination of variant finding and phasing, CAMPAREE generates two lists of variants for each sample that correspond to the two parental copies of each autosome. For each sample, the pipeline applies these variants to the reference sequence to create two full parental genome sequences. Insertions and deletions that are introduced into the parental genomes will change the number of nucleotides and shift the chromosomal coordinate systems relative to the reference genome. To account for these changes, CAMPAREE adjusts the coordinates in the input gene annotations to account for insertions and deletions, which creates separate reference annotations for each parent.</p>
    </sec>
    <sec id="Sec6">
      <title>Estimating intron, gene, transcript PSI, and allelic distributions</title>
      <p id="Par17">To ultimately determine the composition of simulated molecules in the final output, CAMPAREE estimates several empirical distributions from each sample. The pipeline determines the intronic distribution by first identifying all regions that are exclusively intronic (mintrons; intronic regions with no overlapping exonic regions from other genes or isoforms from the same strand). Next, for each mintron, CAMPAREE counts the number of uniquely-aligned reads/fragments from the genome-aligned data that overlap each mintron and normalizes these counts by mintron length in kilobases. This procedure is repeated for the antisense signal in each mintron, as well as the intergenic regions between genes. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for a flowchart depicting this procedure. For the gene abundance and transcript percent splicing included (PSI) distributions (Additional file <xref rid="MOESM3" ref-type="media">3</xref>), CAMPAREE uses kallisto v0.45.0 [<xref ref-type="bibr" rid="CR24">24</xref>] to map the raw input reads to the first parental transcriptome. Since allele-specific quantification is handled in a separate step and the two parental genomes are relatively similar, the pseudo-alignment results from the first parental transcriptome are sufficient to determine the transcript distribution. The kallisto results yield transcript-level estimated read counts (‘est_counts’ column in kallisto output), which CAMPAREE normalizes by the effective length of each transcript (‘eff_length’ column in kallisto output). Next, CAMPAREE uses these length-normalized transcript-level read counts to generate the gene-level distribution by summing the read counts across all transcripts associated with a given gene. This is a common approach for getting gene-level data from pseudo-aligners, which previous work has shown is more accurate than calculating gene-level read counts directly from genome-aligned reads [<xref ref-type="bibr" rid="CR25">25</xref>]. For the transcript PSI distribution, CAMPAREE again identifies which transcripts are associated with a given gene and then divides each transcript-level read count by the gene-level read counts. The PSI values for the transcripts associated with a given gene will sum to one and represent the relative abundances of each isoform. Lastly, to generate the gene-level allelic distribution (Additional file <xref rid="MOESM4" ref-type="media">4</xref>), CAMPAREE uses Bowtie2 v2.3.4.3 [<xref ref-type="bibr" rid="CR26">26</xref>] to align the raw input reads to each of the parental transcriptomes. For each read in the input, the pipeline compares the alignments to both parental transcriptomes and increments a gene-level read count for each parent depending upon the alignment results. If the read aligns to only one of the parental transcriptomes, the read count for the corresponding parental allele is incremented by one. If the read aligns to both parental transcriptomes, the read count for the parental allele with the smallest alignment edit distance is incremented. If the read aligns equally well to both parental transcriptomes, the read counts for both parental alleles are incremented by 0.5. After parsing the read alignments, CAMPAREE calculates the allelic imbalance for each gene and parental allele as the fraction of read counts for that allele over the total read count for both parental alleles. These two fractions for a given gene will sum to one and represent the relative abundances of transcripts originating from either parental allele. Once again, users may provide their own distributions instead of estimating them from the input data.</p>
    </sec>
    <sec id="Sec7">
      <title>Generating simulated molecules</title>
      <p id="Par18">For the final stage in the pipeline, CAMPAREE uses these empirical distributions together in a hierarchy to generate the molecules in the simulated sample. The pipeline repeats the following process until it generates the desired number of simulated molecules: 1) Randomly select a gene from the gene distribution. 2) Randomly select a parental allele from the allelic distribution for this gene. 3) Randomly select an isoform for this gene from the transcript PSI distribution. 4) Randomly determine whether to generate an unspliced version of the transcript (i.e. pre-mRNA containing all introns) by calculating the likelihood of pre-mRNA as the ratio of intronic read counts per base (from the intron distribution) to the gene-level read counts per base. By using average read counts per base, this accounts for differences in length between a gene’s introns and exons. 5) Having selected which transcript to generate, retrieve the full nucleotide sequence for the transcript and generate CIGAR strings mapping the transcripts back to the appropriate parental genome and the original reference genome. 6) Add a polyA tail to the 3ʹ end of the sequence and corresponding entries for soft-clipped bases (denoted by ‘S’) to the appropriate ends of each CIGAR string. Lastly, CAMPAREE saves this list of simulated molecules in either FASTA format, listing the full sequence and identifier for each molecule, or in a tab-delimited “molecule file” that lists the molecule sequence along with other metadata, including the reference and parental CIGAR strings.</p>
    </sec>
    <sec id="Sec8">
      <title>Datasets used in this manuscript and packaged with CAMPAREE</title>
      <p id="Par19">All CAMPAREE data presented in this manuscript were primed with two real mouse liver RNA-Seq samples, 9576 and 9577, from a previous study [<xref ref-type="bibr" rid="CR27">27</xref>]. The FASTQ files for these samples are available from the Gene Expression Omnibus (9576 – GSM2599715; 9577 – GSM2599721). CAMPAREE was run with default parameters (seed value = 100) in an LSF environment using the genome sequence from the Ensembl GRCm38 build of the mouse genome and gene/transcript models from the Ensembl release 102 annotation [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p id="Par20">For testing and diagnostic purposes, CAMPAREE is packaged with a reduced genome sequence and annotation collectively called the “baby genome.” The baby genome sequence is a subset of the Ensembl GRCm38 build of the mouse genome covering the following chromosome spans: chr1:57,943,156–58,943,156, chr2:26,644,480–27,644,480, chr3:88,196,078–89,196,078, chrM:1-16299, chrX:73,654,661–74,654,661, and chrY:663,558–1,744,052. Similarly, the baby genome annotation is a subset of gene/transcript models from the Ensemble release 93 [<xref ref-type="bibr" rid="CR29">29</xref>] annotation that come from the same coordinate spans as the baby genome sequence. CAMPAREE also includes two test samples that are subsets of the full 9576 and 9577 samples described above. Reads were sampled from the original FASTQ files such that ~ 82 % of the read will map to the baby genome and the remaining ~ 18 % will not.</p>
    </sec>
    <sec id="Sec9">
      <title>Generating simulated data with BEERS, Polyester, and RSEM from CAMPAREE output</title>
      <p id="Par21">CAMPAREE was run on the full 9576 and 9577 samples as described above. The molecule file generated from sample 9576 was prepared for use by BEERS [<xref ref-type="bibr" rid="CR7">7</xref>], Polyester [<xref ref-type="bibr" rid="CR9">9</xref>], and RSEM [<xref ref-type="bibr" rid="CR8">8</xref>] by the molecule_file_to_fasta_and_count_table.py script, packaged with CAMPAREE. This script accepts a molecule file as input and generates a FASTA file of unique transcript sequences contained in the molecule file, and a count matrix listing the number of occurrences for each sequence. This script was run with the ‘-s’ and ‘-t’ command line parameters to generate separate output files for each parental genome and to trim polyA tails from the transcript sequences and CIGAR strings, respectively.</p>
      <p id="Par22">To simulate reads with BEERS, separate sets of config files were generated from each of the parental genomes and annotations created by CAMPAREE. Briefly, the geneinfo, genenseq, and intronseq config files were created from the parental genome FASTA and the annotation using the standard set of scripts included with BEERS. The featurequantification config file was created from the matrix of sequence counts using the standard scripts included with BEERS. Next, BEERS was run separately for each parental genome using the two sets of config files. These reads were generated without any indels, errors, or intron retention, using the following command-line parameters: -strandspecific -error 0 -subfreq 0 -indelfreq 0 -intronfreq 0 -palt 0.</p>
      <p id="Par23">To simulate reads with Polyester v1.26.0, the simulate_experiment_countmat(seed = 100, strand_specific = TRUE) command was run in R v4.0.3. This command was given the FASTA file of transcript sequences and the matrix of counts, generating simulated reads from both parental alleles in a single run. Polyester was run using its default sequencing error model, so its simulated reads contain errors and indels, while the BEERS reads do not.</p>
      <p id="Par24">To simulate reads with RSEM v1.3.3, the FASTA file of transcript sequences was used to create an RSEM transcriptome index, where each transcript from each allele was treated as a separate gene. The rsem-prepare-reference command was run with the --bowtie2 and --bowtie2-path options, the latter of which pointed to the bowtie2 binary packaged with CAMPAREE. In order to simulate reads, RSEM requires a ‘sample_name.model’ file which defines empirical models for RNA-Seq read length, fragment length, sequencing errors, and quality scores. To generate this model file, the rsem-calculate-expression command was used to quantify the input FASTQ files (sample 9576) with the RSEM transcriptome index prepared above. The command was run with the following options: --paired-end --strandedness reverse --bowtie2 --bowtie2-path, the last of which pointed to the bowtie2 binary packaged with CAMPAREE. The count matrix and parental genome annotations produced by CAMPAREE were used to prepare an rsem genes.results file, where the expression of transcripts from each allele was represented in units of TPM (Transcripts per million). Lastly, simulated RNA-Seq reads were generated by running the rsem-simulate-reads command with the transcriptome annotation, model file, and genes.results file prepared above. The simulation command was run with the theta parameter set to 0, and with the ‘--seed 42’ parameter, for reproducibility. These simulated reads also contained sequencing errors and indels, as RSEM used a model file prepared from real data.</p>
      <p id="Par25">The FASTA/FASTQ files of simulated reads produced by all simulators were aligned to the Ensembl GRCm38 build of the mouse genome using STAR v2.5.2a. Coverage plots (in bedgraph format) were built from the resulting SAM files using the sam2cov tool v0.0.5.4-beta, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/khayer/sam2cov">https://github.com/khayer/sam2cov</ext-link>. STAR was run with the “--outSAMunmapped Within KeepPairs”, which is required by the sam2cov tool. Coverage plots for CAMPAREE output were generated by CAMPAREE itself, using the molecules_to_cov.py script in the BEERS_UTILS package (one of CAMPAREE’s requirements). Bedgraph files were visualized in the UCSC genome browser [<xref ref-type="bibr" rid="CR30">30</xref>] and the STAR alignments were visualized directly in the IGV v2.5.2 [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results and discussion</title>
    <sec id="Sec11">
      <title>The CAMPAREE workflow</title>
      <p id="Par26">The CAMPAREE pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is based on estimating genetic variants and empirical distributions for gene, transcript, intron, and allele-specific expression from real RNA-Seq data (see <xref rid="Sec2" ref-type="sec">Implementation</xref> section for full details). For this reason, CAMPAREE accepts raw FASTQ files from real RNA-Seq samples as input. Briefly, CAMPAREE begins by using STAR [<xref ref-type="bibr" rid="CR22">22</xref>] to align raw reads from each sample to the appropriate reference genome, and then identifying the variants contained in those alignments that differ from the reference. These genome alignments also provide estimates for intron-level expression. Note that while CAMPAREE is configured by default to estimate variants and distributions directly from the raw FASTQ data, users may fully specify these distributions themselves, using their preferred tools for variant calling or some distributions of interest. After filtering the variants for likely sequencing errors, CAMPAREE combines the variants across samples and uses BEAGLE [<xref ref-type="bibr" rid="CR23">23</xref>] to infer haplotype phasing. The pipeline uses the phasing information, along with the given reference sequence and annotation, to generate two parental genomes and transcriptomes for each sample. Next, for each input sample the pipeline realigns the raw FASTQ reads to both parental transcriptomes using kallisto [<xref ref-type="bibr" rid="CR24">24</xref>] and Bowtie2 [<xref ref-type="bibr" rid="CR26">26</xref>]. The kallisto data are used to estimate both the gene-level expression distribution, as well as the relative abundance of each isoform for a given gene. While kallisto can rapidly assign reads to their appropriate transcripts, it is a pseudo-aligner and therefore does not return complete, nucleotide-level alignments. Since most differences between the two parental transcriptomes are sequence-level features like single-nucleotide variants (SNVs) and indels, CAMPAREE uses the Bowtie2 alignments to assess which of the two parental alleles each read is most likely to originate from. Lastly, the pipeline simulates full-length RNA molecules according to the empirically-derived distributions (see Additional file <xref rid="MOESM5" ref-type="media">5</xref> for the distributions estimated from two real samples). Given the total number of molecules to generate, as specified by the user, CAMPAREE uses the gene- and transcript-level distributions to determine the relative ratios of each RNA molecule, the allelic distribution to determine which parental genome each molecule originates from, and the intron distribution to determine what proportion of unspliced RNA molecules to generate. Each molecule generated by CAMPAREE lists its full sequence (including polyA tail, if added), transcript ID, parent of origin, chromosome, reference genome start coordinate, and parental genome start coordinate, as well as CIGAR strings mapping the molecule back to both the parental genome and the original reference genome. These two CIGAR strings are intended to facilitate the rapid mapping of molecules back to their source locations (common practice when assessing read/sequence alignment). CAMPAREE is capable of outputting each simulated RNA sample in a ‘molecule_file’ format, intended for use with future molecule-based RNA-Seq simulators, or in FASTA format, allowing for use with current RNA-Seq toolsets and simulators.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Flow chart of the CAMPAREE pipeline. Diagram of flow through the CAMPAREE pipeline from FASTQ file input (top) to molecule file or FASTA output (bottom). Names for each step listed on the left side. File types for intermediates between each of the steps listed on the right side</p></caption><graphic xlink:href="12864_2021_7934_Fig1_HTML" id="d32e759"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Idealized coverage</title>
      <p id="Par27">RNA-Seq coverage plots are one of the most ubiquitous methods for visualizing the results of an RNA-Seq experiment. These coverage plots, often viewed with the UCSC genome browser [<xref ref-type="bibr" rid="CR30">30</xref>] or IGV [<xref ref-type="bibr" rid="CR31">31</xref>], display characteristic non-uniform patterns of peaks and valleys over the length of a gene [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Furthermore, the expressed regions displayed in a coverage plot only represent the ends of the underlying RNA fragments. Since typical RNA-Seq experiments are only reading the terminal 100–150 bp of fragments that are often more than twice this length, coverage plots for a paired-end experiment often have dead spaces in coverage between the forward and reverse reads. Technical artifacts, like these, combine to obscure the true expression patterns, making it difficult to discern which transcript regions are expressed. This is particularly true for loci that contain multiple, overlapping transcripts because the coverage represents a combination of the individual isoforms/alleles. CAMPAREE provides a solution to this problem. Since CAMPAREE estimates its abundance parameters from real data, the simulated molecules it generates have the side effect of providing an idealized view of RNA-Seq coverage. In other words, a user starts with an RNA-Seq FASTQ file and ends up with a clean representation of the signal meted out to individual isoforms and alleles. With this information, users can represent the data with idealized coverage plots that display only full-length isoforms and perfect signal, separated by isoform and allele (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). To facilitate this feature and to provide another means of examining simulated data for benchmarking studies, CAMPAREE includes utilities to generate coverage plots from its output molecules.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Idealized coverage plots from CAMPAREE output. Representative coverage plots of real, STAR-aligned input data (pink, top) and CAMPAREE (idealized) output primed from the input data (black, bottom). Transcript models for the gene <italic>Derl2</italic> displayed below coverage plots in dark blue. Image captured from the UCSC genome browser. Input and CAMPAREE data were generated from a mouse liver sample (9576; GSM2599715)</p></caption><graphic xlink:href="12864_2021_7934_Fig2_HTML" id="d32e792"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Enhancing existing RNA-Seq simulators</title>
      <p id="Par28">The goal behind the CAMPAREE simulator is to provide a realistic collection of simulated RNA molecules that represent the starting material for creating an RNA-Seq library. To demonstrate the utility of this approach, we used output from the CAMPAREE simulator to prime three existing simulators, BEERS [<xref ref-type="bibr" rid="CR7">7</xref>], Polyester [<xref ref-type="bibr" rid="CR9">9</xref>], and RSEM [<xref ref-type="bibr" rid="CR8">8</xref>], to generate <italic>diploid</italic> simulated data. Neither BEERS nor Polyester simulate diploid data natively. While RSEM can be configured to simulate allele-specific RNA-Seq data, it requires an existing set of allele-specific transcript sequences as input and does not infer this information itself. To support RNA-Seq simulators which are not designed to take single-molecule input, CAMPAREE can output a FASTA file containing all the unique transcript sequences in a simulated sample, along with a count table listing the number of copies for each sequence. Polyester accepts both of these files directly as input for generating simulated RNA-Seq reads. For BEERS, we used the parental genomes and annotations generated by CAMPAREE, in combination with the transcript count table to prime the simulator. To prepare RSEM simulations, we used the parental annotations generated by CAMPAREE, along with the transcript count table and transcriptome FASTA. To simulate RNA-Seq data, RSEM also requires a model file which defines models for sequencing errors, quality scores, read lengths, and RNA fragment lengths estimated from real data. We generated this file by using RSEM to quantify the original FASTQ files used to run CAMPAREE, against the transcriptome containing sequences from both parental alleles. The transcript sequences output by CAMPAREE track the parental genome from which they originated. As a result, even though neither BEERS nor Polyester were originally designed to support allele-specific simulations from diploid genomes, priming them with CAMPAREE output confers this functionality (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, Additional file <xref rid="MOESM7" ref-type="media">6</xref>). Looking broadly at read counts simulated by each tool (Additional file <xref rid="MOESM6" ref-type="media">6</xref>), both BEERS and RSEM show slight departures from the quantified transcript counts they were primed with, while Polyester almost exactly recapitulates the input quantities. This is reflective of the different approaches the simulators take to generating data. Polyester has an option allowing users to specify exact expression values for each transcript. Both BEERS and RSEM use the given quantification values to create probability distributions of transcript expression. They then sample from these distributions repeatedly when choosing which transcripts to simulate. This distinction between these simulators may be important depending upon the level of control users require for their specific needs. Comparing representative coverage plots of <italic>Polr2j</italic> from the CAMPAREE output to the BEERS, Polyester, and RSEM output, we see that all RNA-Seq simulators layered the coverage artifacts and edge effects we expect from real data on top of the CAMPAREE output. Additionally, we see representation of the same alternative splice forms across all simulators and a decrease in the overall depth of coverage for the second parental allele, which reflects the allele-specific expression pattern of this gene. Also, since CAMPAREE includes unspliced pre-mRNA transcripts in its output (indicated by the lines of coverage in the CAMPAREE plots that extend through the entire intronic regions), all three simulators include a low level of intronic expression. While BEERS can already introduce intronic expression into its gene models, this feature is not natively supported by Polyester or RSEM. If we zoom in on the terminal exons of <italic>Polr2j</italic> to alignment resolution, we can see the variants distinguishing the two parental alleles represented in reads generated by all three simulators (Polyester and BEERS - Fig. <xref rid="Fig4" ref-type="fig">4</xref>; RSEM - Additional file <xref rid="MOESM7" ref-type="media">7</xref>). Despite being developed as the basis for molecule-based RNA-Seq simulations, CAMPAREE is capable of introducing additional functionality and control to three existing RNA-Seq simulators.
<fig id="Fig3"><label>Fig. 3</label><caption><p>CAMPAREE adds allele-specific expression support to BEERS, Polyester, and RSEM. Representative coverage plots of simulated RNA-Seq data created by Polyester (red), BEERS (blue), and RSEM (orange) from CAMPAREE output (black). Separate coverage plots for signal from each parental allele are displayed on the left and right. Transcript models for the gene <italic>Polr2j</italic> displayed below coverage plots in dark blue. Note, Polyester, BEERS, and RSEM depth of coverage appears lower than CAMPAREE because they are displaying coverage from short reads, rather than full length transcripts. Image captured from the UCSC genome browser</p></caption><graphic xlink:href="12864_2021_7934_Fig3_HTML" id="d32e844"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Variants introduced by CAMPAREE are maintained in BEERS and Polyester output. Coverage plots and alignments for reads simulated by BEERS and Polyester from the two terminal exons of <italic>Polr2j</italic>. Black rectangles highlight variants specific to each parental allele. Red lines on left indicate a ‘T’ substitution present in all alignments from parent 2 allele. Orange lines on the right indicate a ‘G’ substitution present in all alignments from parent 2 allele. Similar results for RSEM are displayed in Additional file <xref rid="MOESM7" ref-type="media">7</xref></p></caption><graphic xlink:href="12864_2021_7934_Fig4_HTML" id="d32e858"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="conclusion">
    <title>Conclusions</title>
    <p id="Par29">Arguably one of the most difficult aspects of simulating RNA-Seq data is generating a realistic RNA population to serve as the basis for the input sample. However, this problem has been largely overlooked by the community, where efforts tend to focus on simulating the biases introduced by library preparation and sequencing. To this end, we developed the CAMPAREE simulator to generate realistic RNA samples following empirical distributions derived from real RNA-Seq datasets. While this functionality may be useful to most users, we have also included the ability to explicitly specify the genetic variants and expression distributions (gene, transcript, intron, allelic) CAMPAREE uses to generate allele-specific data. CAMPAREE was developed in Python3, is open source, and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/itmat/CAMPAREE">https://github.com/itmat/CAMPAREE</ext-link>.</p>
    <p id="Par30">The gene-gene interaction networks and dependency structures underlying expression data present another challenge for simulations. These networks are highly complex, and can change drastically depending upon stimuli or cell states of the system of interest [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. Additionally, these interactions are often more complex than pairwise gene-gene interactions, involving input from many genes, which makes them difficult to both accurately detect and model at scale [<xref ref-type="bibr" rid="CR35">35</xref>]. To make the analysis and simulation of expression data more tractable, many studies have modeled expression across multiple genes as an independent, identically distributed (iid) process [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. This is particularly problematic for benchmarking studies if the simulated data were generated using the same iid model and distributions as the analysis tools being tested. To avoid these potential confounds, CAMPAREE, as well as other recent benchmarking studies, including those using the RSEM simulator, have taken an empirical approach [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. By estimating gene expression values from real samples and then using these estimates as the ground truth in simulations, we can retain much of the complexity of real data, while also maintaining full knowledge of and control over the simulated molecules and transcript expression levels. While we hold the position that mimicking real data is an effective means to achieve more realistic simulated data, we also believe that effective benchmarking studies should involve both real and simulated data.</p>
    <p id="Par31">Most previous RNA-Seq simulators, including the ones developed by our group, focused on accurately modeling the molecular biology and biases of the library preparation and sequencing reactions. These simulators operate by using some underlying distribution (either statistically- or empirically-derived) to select a transcript to express. They then extract the full sequence for the transcript from a given annotation and apply some approximation of library preparation (i.e. fragmentation, size selection, PCR bias) to ultimately get the simulated read derived from that transcript. Here we focus on accurately modeling the input sample separately from library preparation, which we feel offers greater overall flexibility. By divorcing input sample simulation from library preparation/sequencing simulation, future simulators that operate on a given population of simulated molecules will be agnostic to genome sequence, annotations, and composition of the simulated input sample. For example, if researchers have access to multiple simulators, each modeling a different library prep technique (e.g. TruSeq, Smart-Seq2) or sequencing technology (e.g. Illumina, PacBio), they could use the same simulated sample as input across all programs. Furthermore, by priming different RNA-Seq simulators with the same input sample, we can compare their outputs to assess their performance and bias models. Perhaps most importantly, this division of the process into a separate sample simulation part and sequencing simulation part allows both to develop and evolve independently of each other. Developers can upgrade and develop new library preparation/sequencing simulators to match the current state of sequencing technology, all while still being able to use the same model of input sample. Similarly, as technology improves and we can measure the truth underlying RNA samples with increased fidelity, we can simulate different species of RNA in the input sample, like small RNAs, tRNAs, and circular RNAs, without extensive modification to the sequencing simulation.</p>
    <p id="Par32">The CAMPAREE simulator represents an import first step toward molecule-level simulation. We plan to add further features to improve the simulator and the breadth of biological conditions it can mimic. These include the ability to introduce allele-specific splicing, heterogeneous degradation, editing, and processing of the RNA molecules, use separate parameters to represent nuclear and cytoplasmic RNA fractions, and simulate single-cell samples in addition to bulk RNA. This last option is currently possible as multiple, low expression CAMPAREE runs could each represent the transcriptomes of individual cells before labeling and pooling together. It is our hope that the open source, modular nature of CAMPAREE will allow the community to adapt it to meet their current and future needs. In this way, CAMPAREE can evolve in parallel with our understanding of transcriptional biology.</p>
    <sec id="Sec15">
      <title>Availability and requirements</title>
      <p id="Par33"><bold>Project name:</bold> CAMPAREE.</p>
      <p id="Par34"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/itmat/CAMPAREE">https://github.com/itmat/CAMPAREE</ext-link>.</p>
      <p id="Par35"><bold>Operating system:</bold> Tested on GNU/Linux operating systems.</p>
      <p id="Par36"><bold>Programming language:</bold> Python.</p>
      <p id="Par37"><bold>Other requirements:</bold> git, Python 3.6 or higher, Java 1.8.</p>
      <p id="Par38"><bold>License:</bold> GNU General Public License v3.0.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2021_7934_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Input and output files for each CAMPAREE step. A table listing each step in the CAMPAREE pipeline, along with the input and output files for each. Output files marked with a ‘*’ can be provided by the user to skip the associated step(s).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2021_7934_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figure S1.</bold> Flowchart for estimating intronic and intergenic empirical distributions. A flowchart describing how CAMPAREE uses a genome-aligned BAM file and gene annotation to estimate distributions for intron inclusion (sense and antisense) and intergenic expression. This procedure is repeated for each input sample in a CAMPAREE run. Note, a “mintron” is defined as the smallest possible genomic span that does not overlap any exon, intergenic region, or the 1500 bp regions (by default) flanking any transcript’s start and stop coordinates.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12864_2021_7934_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3: Figure S2.</bold> Flowchart for estimating transcript, gene, and PSI distributions. A flowchart describing how CAMPAREE estimates distributions for gene-level abundances, transcript-level abundances, and transcript PSI (percent splicing included) values from a FASTA file of transcript sequences and a gene model, both generated from one parental genome, as well as FASTQ files of unaligned input reads. This procedure is repeated for each input sample in a CAMPAREE run.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12864_2021_7934_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Figure S3.</bold> Flowchart for estimating the distribution of allelic imbalances. A flowchart describing how CAMPAREE estimates the distribution of allelic imbalances (i.e., the percentage of molecules for each gene transcribed from each parental allele). This process uses FASTA files of transcript sequences and gene models generated from both parental genomes, as well as FASTQ files of unaligned reads, and a BAM file containing alignments of reads to the original, source genome. This procedure is repeated for each input sample in a CAMPAREE run.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12864_2021_7934_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Figure S4.</bold> Empirical distributions estimated by CAMPAREE from real data. (A) Estimated distributions for transcript abundances overlapping intronic regions in the sense orientation (left panel), intronic regions in the antisense orientation (middle panel), and intergenic regions (right panel). (B) Estimated distributions for transcript- and gene-level abundances. Gene-level abundances are calculated by summing the abundances of all transcripts belonging to each gene. (C) Estimated distributions for per-transcript PSI (percent splicing included) values. Data in this figure are for transcripts from genes estimated to express at least one splice form. (D) Estimated distributions for allelic imbalance, represented as the ratio of molecules transcribed from the parent 1 allele and the parent 2 allele. The Y-axes for all plots display the Gaussian kernel density estimates calculated by the density() function in R. The X-axes in panels (A) and (B) display the log10-transformed abundance estimates for each genomic feature in FPK (fragments per kilobase length), a length-normalized measure of transcript abundance. For display purposes, a pseudocount of 0.001 was added to each FPK value, so that features with an FPK of 0 are still displayed in log10 space at the position log10(0 + 0.001) = -3. CAMPAREE estimated these distributions from two real mouse liver RNA-Seq samples (9575 - GSM2599715; 9577 - GSM2599721).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12864_2021_7934_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6: Figure S5.</bold> Transcript abundances simulated by BEERS, Polyester, and RSEM after being primed with CAMPAREE output. Scatterplots of transcript abundances simulated by BEERS (left panels), Polyester (middle panels), and RSEM (right panels), compared to CAMPAREE abundances used to prime each RNA-Seq simulator. Data are displayed separately for genes from each parental allele (top and bottom panels). The line of unexpressed transcripts at the bottom of the BEERS panels are from transcripts which BEERS removed from the annotation because they possess genomic features which interfere with BEERS’s underlying simulation (e.g., length &lt; 200 bp, introns &lt; 10 bp). Similarly, the unexpressed transcripts from the bottom of the RSEM panels are from short transcripts. RSEM reads transcript abundances as TPM (transcripts per million) values. The TPM calculation involves calculating a transcript’s “effective length,” by subtracting the estimated RNA-Seq read/fragment length from the transcript’s length. This can result in an effective length &lt; 0 for short transcripts. In the RSEM model, transcripts with effective lengths &lt; 0 have no expression. The X- and Y-axes display the transcript abundances simulated by each RNA-Seq simulator and by CAMPAREE, respectively. For display purposes, a pseudocount of 0.1 was added to each abundance value, so unexpressed transcripts are still displayed in log10 space at the position log10(0 + 0.1) = -1.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12864_2021_7934_MOESM7_ESM.pdf">
            <caption>
              <p><bold>Additional file 7: Figure S6.</bold> Variants introduced by CAMPAREE are maintained in RSEM output. Coverage plots and alignments for reads simulated by RSEM from the two terminal exons of <italic>Polr2j</italic>. Black rectangles highlight variants specific to each parental allele. Red lines on left indicate a ‘T’ substitution present in all alignments from parent 2 allele. Orange lines on the right indicate a ‘G’ substitution present in all alignments from parent 2 allele. Similar results for Polyester and BEERS are displayed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>RNA-Seq</term>
        <def>
          <p id="Par4">High-throughput sequencing of RNA</p>
        </def>
      </def-item>
      <def-item>
        <term>CAMPAREE</term>
        <def>
          <p id="Par5"><underline>C</underline>onfigurable <underline>A</underline>nd <underline>M</underline>odular <underline>P</underline>rogram <underline>A</underline>llowing <underline>R</underline>NA <underline>E</underline>xpression <underline>E</underline>mulation</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par6">Single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>PSI</term>
        <def>
          <p id="Par7">Percent splicing included</p>
        </def>
      </def-item>
      <def-item>
        <term>iid</term>
        <def>
          <p id="Par8">Independently and identically distributed</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Nicholas F. Lahens and Thomas G. Brooks contributed equally.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Gary Schroth and Dan Gheba of Illumina for their insight into and helpful conversations about sequencing biases. We also thank members of the Barash lab for helpful conversations and High Performance Computing at Penn Medicine (PMACS HPC), funded by 1S10OD012312-NIH, for cluster computing support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>GG, YB, NL, and TB conceived of the research and designed the system. NL, TB, DS, SN, and CL wrote the CAMPAREE codebase. AS contributed computational expertise, particularly with PMACS and AWS compute clusters, and expertise regarding distribution and maintenance. JS provided expertise on sequencing technology. JS and JH provided expertise on RNA biology. GG, NL, and TB wrote the paper. All authors read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is supported by R21-LM012763-01A1: “The Next Generation of RNA-Seq Simulators for Benchmarking Analyses” (PI: GR. Grant) and by the National Center for Advancing Translational Sciences Grant (5UL1TR000003).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All CAMPAREE data presented in this manuscript were primed with two real RNA-Seq samples, 9576 and 9577, from a previous study [<xref ref-type="bibr" rid="CR27">27</xref>]. The FASTQ files for these samples are available from the Gene Expression Omnibus (9576 – GSM2599715; 9577 – GSM2599721).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p id="Par39">Not applicable.</p>
    </notes>
    <notes id="FPar7">
      <title>Consent for publication</title>
      <p id="Par40">Not applicable.</p>
    </notes>
    <notes id="FPar8" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par41">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engström</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Steijger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sipos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Kahles</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Consortium</surname>
            <given-names>RGASP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic evaluation of spliced alignment programs for RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1185</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2722</pub-id>
        <pub-id pub-id-type="pmid">24185836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delorenzi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for differential expression analysis of RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>91</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-91</pub-id>
        <pub-id pub-id-type="pmid">23497356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Baruzzo G, Hayer KE, Kim EJ, Di Camillo B, FitzGerald GA, Grant GR. Simulation-based comprehensive benchmarking of RNA-seq aligners. Nat Methods. 2017;14:135–9.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Djebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A benchmark for RNA-seq quantification pipelines</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0940-1</pub-id>
        <pub-id pub-id-type="pmid">27107712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Golovnina</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z-X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Negron</surname>
            <given-names>YLS</given-names>
          </name>
          <name>
            <surname>Sultana</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of normalization and differential expression analyses using RNA-Seq data from 726 individual Drosophila melanogaster</article-title>
        <source>BMC Genom</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-2353-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griebel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ribeca</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>10073</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks666</pub-id>
        <pub-id pub-id-type="pmid">22962361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Farkas</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Pizarro</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Schug</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brunk</surname>
            <given-names>BP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative analysis of RNA-Seq alignment algorithms and the RNA-Seq unified mapper (RUM)</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2518</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>
        <pub-id pub-id-type="pmid">21816040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2778</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id>
        <pub-id pub-id-type="pmid">25926345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Hayer KE, Pizarro A, Lahens NF, Hogenesch JB, Grant GR. Benchmark analysis of algorithms for determining and quantifying full-length mRNA splice forms from RNA-seq data. Bioinforma Oxf Engl. 2015;31:3938–45.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Vaquero-Garcia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Barash</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Outlier detection for improved differential splicing quantification from RNA-Seq experiments with replicates</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>1488</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Modeling of RNA-seq fragment sequence bias reduces systematic errors in transcript abundance estimation</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1287</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3682</pub-id>
        <pub-id pub-id-type="pmid">27669167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westoby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Ferguson-Smith</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Simulation-based benchmarking of isoform quantification in single-cell RNA-sEq</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1571-5</pub-id>
        <pub-id pub-id-type="pmid">30404663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolić-Nørrelykke</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Engh</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Landick</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gelles</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Diversity in the Rates of Transcript Elongation by Single RNA Polymerase Molecules</article-title>
        <source>J Biol Chem</source>
        <year>2004</year>
        <volume>279</volume>
        <fpage>3292</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M310290200</pub-id>
        <pub-id pub-id-type="pmid">14604986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsiao</surname>
            <given-names>Y-HE</given-names>
          </name>
          <name>
            <surname>Bahn</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>E-W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA editing in nascent RNA affects pre-mRNA splicing</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>812</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.231209.117</pub-id>
        <pub-id pub-id-type="pmid">29724793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tollervey</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The many pathways of RNA degradation</article-title>
        <source>Cell</source>
        <year>2009</year>
        <volume>136</volume>
        <fpage>763</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2009.01.019</pub-id>
        <pub-id pub-id-type="pmid">19239894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weskamp</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barmada</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>RNA degradation in neurodegenerative disease</article-title>
        <source>Adv Neurobiol</source>
        <year>2018</year>
        <volume>20</volume>
        <fpage>103</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-89689-2_5</pub-id>
        <pub-id pub-id-type="pmid">29916018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levitin</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of tumor heterogeneity</article-title>
        <source>Trends Cancer</source>
        <year>2018</year>
        <volume>4</volume>
        <fpage>264</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trecan.2018.02.003</pub-id>
        <pub-id pub-id-type="pmid">29606308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharytonchyk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Monti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smaldino</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Van</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bolden</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional start site heterogeneity modulates the structure and function of the HIV-1 genome</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>13378</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1616627113</pub-id>
        <pub-id pub-id-type="pmid">27834211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olarerin-George</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Assessing the prevalence of mycoplasma contamination in cell culture via a survey of NCBI’s RNA-seq archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>2535</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv136</pub-id>
        <pub-id pub-id-type="pmid">25712092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mangul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>HT</given-names>
          </name>
          <name>
            <surname>Strauli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gruhl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Porath</surname>
            <given-names>HT</given-names>
          </name>
          <name>
            <surname>Hsieh</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ROP: dumpster diving in RNA-sequencing to find the source of 1 trillion reads across diverse adult human tissues</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1403-7</pub-id>
        <pub-id pub-id-type="pmid">29548336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>1084</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1086/521987</pub-id>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>525</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences</article-title>
        <source>F1000Research</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>1521</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.7563.2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Ricciotti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smirnova</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Toorens</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of Illumina and Ion Torrent sequencing platforms in the context of differential gene expression</article-title>
        <source>BMC Genom</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>602</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4011-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Yates AD, Achuthan P, Akanni W, Allen J, Allen J, Alvarez-Jarreta J, et al. Ensembl 2020. Nucleic Acids Res. 2020;48:D682–8.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Achuthan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Akanni</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2018</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D754</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1098</pub-id>
        <pub-id pub-id-type="pmid">29155950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title>
        <source>Brief Bioinform</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>178</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs017</pub-id>
        <pub-id pub-id-type="pmid">22517427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Kavakli</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hayer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Black</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IVT-seq reveals extreme bias in RNA sequencing</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R86</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-6-r86</pub-id>
        <pub-id pub-id-type="pmid">24981968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>K-C</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide coexpression dynamics: theory and application</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>16875</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.252466999</pub-id>
        <pub-id pub-id-type="pmid">12486219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mackay</surname>
            <given-names>TFC</given-names>
          </name>
        </person-group>
        <article-title>Epistasis and quantitative traits: using model organisms to study gene–gene interactions</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>22</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3627</pub-id>
        <pub-id pub-id-type="pmid">24296533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Ehrenreich</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>Higher-order genetic interactions and their contribution to complex traits</article-title>
        <source>Trends Genet TIG</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>34</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2014.09.001</pub-id>
        <pub-id pub-id-type="pmid">25284288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jänes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lewin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Turro</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A comparative study of RNA-seq analysis strategies</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>932</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbv007</pub-id>
        <pub-id pub-id-type="pmid">25788326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinn</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Crowley</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking differential expression analysis tools for RNA-Seq: normalization-based vs. log-ratio transformation-based methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>274</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2261-8</pub-id>
        <pub-id pub-id-type="pmid">30021534</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
