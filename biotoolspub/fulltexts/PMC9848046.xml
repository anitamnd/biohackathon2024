<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9848046</article-id>
    <article-id pub-id-type="pmid">36534832</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac811</article-id>
    <article-id pub-id-type="publisher-id">btac811</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mOWL: Python library for machine learning with biomedical ontologies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0710-2259</contrib-id>
        <name>
          <surname>Zhapa-Camacho</surname>
          <given-names>Fernando</given-names>
        </name>
        <aff><institution>Computer, Electrical and Mathematical Sciences &amp; Engineering Division (CEMSE), Computational Bioscience Research Center (CBRC), King Abdullah University of Science and Technology</institution>, Thuwal 23955, <country country="SA">Saudi Arabia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1710-1820</contrib-id>
        <name>
          <surname>Kulmanov</surname>
          <given-names>Maxat</given-names>
        </name>
        <aff><institution>Computer, Electrical and Mathematical Sciences &amp; Engineering Division (CEMSE), Computational Bioscience Research Center (CBRC), King Abdullah University of Science and Technology</institution>, Thuwal 23955, <country country="SA">Saudi Arabia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8149-5890</contrib-id>
        <name>
          <surname>Hoehndorf</surname>
          <given-names>Robert</given-names>
        </name>
        <xref rid="btac811-cor1" ref-type="corresp"/>
        <!--robert.hoehndorf@kaust.edu.sa-->
        <aff><institution>Computer, Electrical and Mathematical Sciences &amp; Engineering Division (CEMSE), Computational Bioscience Research Center (CBRC), King Abdullah University of Science and Technology</institution>, Thuwal 23955, <country country="SA">Saudi Arabia</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac811-cor1">To whom correspondence should be addressed. <email>robert.hoehndorf@kaust.edu.sa</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-19">
      <day>19</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac811</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac811.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Ontologies contain formal and structured information about a domain and are widely used in bioinformatics for annotation and integration of data. Several methods use ontologies to provide background knowledge in machine learning tasks, which is of particular importance in bioinformatics. These methods rely on a set of common primitives that are not readily available in a software library; a library providing these primitives would facilitate the use of current machine learning methods with ontologies and the development of novel methods for other ontology-based biomedical applications.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed mOWL, a Python library for machine learning with ontologies formalized in the Web Ontology Language (OWL). mOWL implements ontology embedding methods that map information contained in formal knowledge bases and ontologies into vector spaces while preserving some of the properties and relations in ontologies, as well as methods to use these embeddings for similarity computation, deductive inference and zero-shot learning. We demonstrate mOWL on the knowledge-based prediction of protein–protein interactions using the gene ontology and gene–disease associations using phenotype ontologies.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>mOWL is freely available on <ext-link xlink:href="https://github.com/bio-ontology-research-group/mowl" ext-link-type="uri">https://github.com/bio-ontology-research-group/mowl</ext-link> and as a Python package in PyPi.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The use of machine learning in bioinformatics has been rapidly increasing, and computational power and data availability enabled substantial advances in many areas of bioinformatics through machine learning (<xref rid="btac811-B9" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2019</xref>). A crucial aspect of the success of machine learning methods was the development of software tools and machine learning libraries such as TensorFlow (<xref rid="btac811-B1" ref-type="bibr">Abadi <italic toggle="yes">et al.</italic>, 2016</xref>) and PyTorch (<xref rid="btac811-B11" ref-type="bibr">Paszke <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Ontologies include rich and structured knowledge about a domain of discourse. They are widely used in biology and biomedicine with more than 1000 ontologies available in BioPortal (<xref rid="btac811-B13" ref-type="bibr">Whetzel <italic toggle="yes">et al.</italic>, 2011</xref>). Ontologies are used to facilitate tasks such as data integration across databases, annotation of biological entities, data access and analysis, and providing background knowledge of a domain (<xref rid="btac811-B5" ref-type="bibr">Hoehndorf <italic toggle="yes">et al.</italic>, 2015</xref>). Background knowledge is provided by ontologies through machine-readable axioms. For example, the gene ontology (GO) (<xref rid="btac811-B3" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic>, 2000</xref>) contains around 50 000 classes and over 100 000 logical axioms.</p>
    <p>Some recent machine learning methods can utilize logical axioms to improve domain-specific tasks by utilizing background knowledge, in particular through ontology embeddings. An ontology embedding is a function that maps ontology entities (classes, instances and relations) to the <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> while preserving some of the knowledge in the logical axioms of the ontology. Ontology embedding methods can be divided into graph-based methods (i.e. projecting logical axioms onto a graph), syntactic methods (utilizing the axioms directly) and semantic methods (generating semantic interpretations from the axioms) (<xref rid="btac811-B8" ref-type="bibr">Kulmanov <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Ontology embeddings have shown to be useful across different problems, and in particular in biological and biomedical problems that rely on data represented through ontologies. Ontology embeddings can be used directly to predict associations between entities annotated with ontologies, such as gene–disease associations (GDAs) based on the relations between their phenotype annotations (<xref rid="btac811-B12" ref-type="bibr">Smaili <italic toggle="yes">et al.</italic>, 2019</xref>), they can be used to provide features for larger machine learning models (<xref rid="btac811-B4" ref-type="bibr">Hinnerichs and Hoehndorf, 2021</xref>), or they can enable zero-shot predictions (<xref rid="btac811-B7" ref-type="bibr">Kulmanov and Hoehndorf, 2022</xref>).</p>
    <p>We developed mOWL, a Python library for machine learning with Web Ontology Language (OWL) ontologies. The purpose of mOWL is to serve as a reference implementation for ontology embeddings and to enable the implementation of new ontology embedding methods. For this purpose, mOWL provides functionality to access information in ontologies and to reason over ontologies, and it provides methods to access biomedical databases that rely on ontologies for annotation.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>mOWL has been designed to handle input in OWL format and generate embeddings that can be used to classify entities or predict new axioms. mOWL consists of components for (i) ontology management, normalization and reasoning, interfacing with the OWL API (<xref rid="btac811-B6" ref-type="bibr">Horridge and Bechhofer, 2011</xref>) and automated reasoners; (ii) ontology transformation, including methods for projecting ontologies into graphs, text corpora or other formats used as precursor to machine learning; (iii) embedding generation by interfacing with the knowledge graph embedding library PyKEEN (<xref rid="btac811-B2" ref-type="bibr">Ali <italic toggle="yes">et al.</italic>, 2021</xref>) and other approaches implemented in Python; and (iv) embedding post-processing, including axiom inference, node classification, evaluation and visualization. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> provides an overview of the components (i)–(iv).</p>
    <p>mOWL has been developed to be used as a Python package. However, mOWL interfaces with the OWL API to enable ontology processing and automated reasoning. The OWL API is implemented in Java, and we use JPype (<xref rid="btac811-B10" ref-type="bibr">Nelson and Scherer, 2020</xref>) to bind Python and the Java Virtual Machine, enabling access to Java classes and methods from Python. mOWL therefore provides access to the entire OWL API through a Python interface.</p>
  </sec>
  <sec>
    <title>3 Use cases</title>
    <p>mOWL can be used to implement at least two types of models. The first relies on generating ontology embeddings to induce background knowledge in machine learning methods. Examples of these methods can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S3</xref> where we tested the methods implemented in mOWL on the tasks of predicting protein–protein interactions and GDAs. For both tasks, we used three types of methods: graph-based, syntactic and semantic. In most evaluation metrics and across both tasks, we find that graph-based ontology embedding methods perform better than other methods.</p>
    <p>The second type of model for which mOWL can be used consists of using the background knowledge in ontologies to constrain the learning objective and imposing a structure on representations generated by a machine learning method. In these applications, it becomes possible to perform some kind of logical operations on representations of machine learning methods, and use these, for example, for zero-shot predictions. An example of such a method can be found in mOWL where we provide an implementation of DeepGOZero (<xref rid="btac811-B7" ref-type="bibr">Kulmanov and Hoehndorf, 2022</xref>), a model that performs zero-shot predictions of protein functions.</p>
    <p>In addition to the use cases enabled by mOWL, through the direct interfacing with the OWL API and JPype, mOWL is also very fast in comparison to some other implementations of ontology embedding methods. We provide a comparison in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>mOWL is a library intended to generate ontology embeddings. Ontology embeddings are broadly applicable to incorporating background knowledge in biological machine learning methods due to the large number of biomedical ontologies used in bioinformatics. mOWL provides implementation of state-of-the-art methods, datasets, OWL API integration and functionalities to manage ontologies. mOWL also provides functionalities for the implementation of novel methods.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac811_Supplementary_Data</label>
      <media xlink:href="btac811_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We acknowledge support from the KAUST Supercomputing Laboratory.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by funding from King Abdullah University of Science and Technology (KAUST) Office of Sponsored Research (OSR) [URF/1/4355-01-01, URF/1/4675-01-01 and FCC/1/1976-34-01].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Our outcome is a software package. We provide some benchmark datasets that we used to generate our results and are accessible from the package itself. However, the data can also be accessed from this link: <ext-link xlink:href="https://bio2vec.cbrc.kaust.edu.sa/data/mowl/" ext-link-type="uri">https://bio2vec.cbrc.kaust.edu.sa/data/mowl/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac811-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) Tensorflow: a system for large-scale machine learning. In: <italic toggle="yes">12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16), Savannah, GA, USA November 2–4, 2016.</italic> pp. <fpage>265</fpage>–<lpage>283</lpage>. <ext-link xlink:href="https://www.usenix.org/sites/default/files/osdi16_full_proceedings.pdf" ext-link-type="uri">https://www.usenix.org/sites/default/files/osdi16_full_proceedings.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac811-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ali</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>PyKEEN 1.0: a python library for training and evaluating knowledge graph embeddings</article-title>. <source>J. Mach. Learn. Res</source>., <volume>22</volume>, <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="btac811-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat. Genet</source>., <volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinnerichs</surname><given-names>T.</given-names></string-name>, <string-name><surname>Hoehndorf</surname><given-names>R.</given-names></string-name></person-group> (<year>2021</year>) <article-title>DTI-Voodoo: machine learning over interaction networks and ontology-based background knowledge predicts drug-target interactions</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>4835</fpage>–<lpage>4843</lpage>.<pub-id pub-id-type="pmid">34320178</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoehndorf</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>The role of ontologies in biological and biomedical research: a functional perspective</article-title>. <source>Brief. Bioinformatics</source>, <volume>16</volume>, <fpage>1069</fpage>–<lpage>1080</lpage>.<pub-id pub-id-type="pmid">25863278</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Horridge</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bechhofer</surname><given-names>S.</given-names></string-name></person-group> (<year>2011</year>) <article-title>The OWL API: a java API for OWL ontologies</article-title>. <source>Semant. Web</source>, <volume>2</volume>, <fpage>11</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="btac811-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kulmanov</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hoehndorf</surname><given-names>R.</given-names></string-name></person-group> (<year>2022</year>) <article-title>DeepGOZero: improving protein function prediction from sequence and zero-shot learning based on ontology axioms</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>i238</fpage>–<lpage>i245</lpage>.<pub-id pub-id-type="pmid">35758802</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kulmanov</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Semantic similarity and machine learning with ontologies</article-title>. <source>Brief. Bioinformatics</source>, <volume>22</volume>, <fpage>bbaa199</fpage>.<pub-id pub-id-type="pmid">33049044</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Deep learning in bioinformatics: introduction, application, and perspective in the big data era</article-title>. <source>Methods</source>, <volume>166</volume>, <fpage>4</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">31022451</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nelson</surname><given-names>K.E.</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>M.K.</given-names></string-name></person-group>; <collab>Administration, U. N. N. S</collab>. (<year>2020</year>) <italic toggle="yes">Jpype</italic>. <ext-link xlink:href="https://jpype.readthedocs.io/en/latest/" ext-link-type="uri">https://jpype.readthedocs.io/en/latest/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac811-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Paszke</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <part-title>Pytorch: an imperative style, high-performance deep learning library</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Wallach</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (eds) <source>Advances in Neural Information Processing Systems</source>, Vol. <volume>32</volume>. <publisher-name>Curran Associates, Inc., Red Hook, NY, USA, pp. 8026–8037</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btac811-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smaili</surname><given-names>F.Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>OPA2Vec: combining formal and informal content of biomedical ontologies to improve similarity-based prediction</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2133</fpage>–<lpage>2140</lpage>.<pub-id pub-id-type="pmid">30407490</pub-id></mixed-citation>
    </ref>
    <ref id="btac811-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whetzel</surname><given-names>P.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Bioportal: enhanced functionality via new web services from the national center for biomedical ontology to access and use ontologies in software applications</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>W541</fpage>–<lpage>W545</lpage>.<pub-id pub-id-type="pmid">21672956</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
