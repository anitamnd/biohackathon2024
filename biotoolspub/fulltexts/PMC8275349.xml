<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8275349</article-id>
    <article-id pub-id-type="pmid">34252969</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab292</article-id>
    <article-id pub-id-type="publisher-id">btab292</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genome Privacy and Security</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Expected 10-anonymity of HyperLogLog sketches for federated queries of clinical data repositories</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tao</surname>
          <given-names>Ziye</given-names>
        </name>
        <aff><institution>Department of Mathematics, University of Toronto</institution>, Toronto, ON M5S 1A1, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weber</surname>
          <given-names>Griffin M</given-names>
        </name>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School</institution>, Boston, MA 02115, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Yun William</given-names>
        </name>
        <aff><institution>Department of Mathematics, University of Toronto</institution>, Toronto, ON M5S 1A1, <country country="CA">Canada</country></aff>
        <aff><institution>Computer and Mathematical Sciences, University of Toronto at Scarborough</institution>, Scarborough, ON M1C 1A4, <country country="CA">Canada</country></aff>
        <xref rid="btab292-cor1" ref-type="corresp"/>
        <!--ywyu@math.toronto.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab292-cor1">To whom correspondence should be addressed. <email>ywyu@math.toronto.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-12">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2021 Proceedings</issue-title>
    <fpage>i151</fpage>
    <lpage>i160</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab292.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The rapid growth in of electronic medical records provide immense potential to researchers, but are often silo-ed at separate hospitals. As a result, federated networks have arisen, which allow simultaneously querying medical databases at a group of connected institutions. The most basic such query is the aggregate count—e.g. How many patients have diabetes? However, depending on the protocol used to estimate that total, there is always a tradeoff in the accuracy of the estimate against the risk of leaking confidential data. Prior work has shown that it is possible to empirically control that tradeoff by using the HyperLogLog (HLL) probabilistic sketch.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In this article, we prove complementary theoretical bounds on the <italic toggle="yes">k</italic>-anonymity privacy risk of using HLL sketches, as well as exhibit code to efficiently compute those bounds.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/tzyRachel/K-anonymity-Expectation" ext-link-type="uri">https://github.com/tzyRachel/K-anonymity-Expectation</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Toronto Department of Computer and Mathematical Sciences</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Clinical data containing patients’ personal medical records are important resources for biomedical research. Fully centralizing that data may permit the widest array of potential analyses, this is often not feasible due to privacy and confidentiality requirements (<xref rid="btab292-B4" ref-type="bibr">Benitez and Malin, 2010</xref>; <xref rid="btab292-B15" ref-type="bibr">Emam <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab292-B20" ref-type="bibr">Heatherly <italic toggle="yes">et al.</italic>, 2013</xref>). During times of pressing need, such as during a global pandemic, these privacy requirements may be justifiably relaxed (<xref rid="btab292-B19" ref-type="bibr">Haendel <italic toggle="yes">et al.</italic>, 2020</xref>)—such as using trusted third party vendors such as Datavant (<xref rid="btab292-B23" ref-type="bibr">Kho and Goel, 2019</xref>)—but even then, it is important to keep in mind the various privacy-utility tradeoffs (<xref rid="btab292-B3" ref-type="bibr">Bengio <italic toggle="yes">et al.</italic>, 2021</xref>, <xref rid="btab292-B2" ref-type="bibr">2020</xref>). A more privacy-friendly alternative is to use a federated network instead, which give hospitals control over their local databases; then, a distributed query tool enables researchers to send queries to the network, such as ‘how many patients across the network have diabetes’ (<xref rid="btab292-B6" ref-type="bibr">Brat <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab292-B30" ref-type="bibr">Weber, 2015</xref>). A number of these hospital networks have emerged, including the Shared Health Research Information Network for Harvard affiliated hospitals (<xref rid="btab292-B31" ref-type="bibr">Weber <italic toggle="yes">et al.</italic>, 2009</xref>), the Federated Aggregate Cohort Estimator developed through a collaboration of five universities and institutions (<xref rid="btab292-B32" ref-type="bibr">Wyatt <italic toggle="yes">et al.</italic>, 2014</xref>), the open-source PopMedNet (<xref rid="btab292-B9" ref-type="bibr">Davies <italic toggle="yes">et al.</italic>, 2016</xref>) and the Patient Centered Outcomes Research Institute launched PCORnet as a network of networks (<xref rid="btab292-B18" ref-type="bibr">Fleurence <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    <p>However, patients often receive medical care from multiple hospitals, so medical records at different hospitals may be duplicated or incomplete. Depending on the aggregation method used to combine results from the network, this can produce errors. For example, consider using a simple summation of aggregate counts: if a patient with hypertension receives medical care from both Hospital A and Hospital B, then it is possible that the sum will double count that patient, which results in the overestimation of the number of patients with hypertension (<xref rid="btab292-B29" ref-type="bibr">Weber, 2013</xref>).</p>
    <p>Of course, this problem can be mostly alleviated by sending a hashed identifier of patients matching each hospital’s queries to a trusted third party, but that again raises privacy concerns (<xref rid="btab292-B25" ref-type="bibr">Oechslin, 2003</xref>). There is some natural tradeoff between the privacy guaranteed to individual patients and the accuracy of the aggregate query, and hashed identifiers and simple summation fall at opposite ends of the spectrum. Several of the authors of this article recently proposed using the HyperLogLog (HLL) ‘probabilistic sketch’ (<xref rid="btab292-B11" ref-type="bibr">Durand and Flajolet, 2003</xref>; <xref rid="btab292-B16" ref-type="bibr">Flajolet and Martin, 1985</xref>; <xref rid="btab292-B17" ref-type="bibr">Flajolet <italic toggle="yes">et al.</italic>, 2007</xref>) to access intermediate tradeoffs of privacy versus accuracy (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). Probabilistic counting was introduced to the computer literature decades ago, and has found use in analyzing large streaming data in a variety of settings, ranging from internet routers (<xref rid="btab292-B8" ref-type="bibr">Cai <italic toggle="yes">et al.</italic>, 2005</xref>) to text corpora comparisons (<xref rid="btab292-B7" ref-type="bibr">Broder, 1997</xref>) to genomic sequences (<xref rid="btab292-B1" ref-type="bibr">Baker and Langmead, 2019</xref>; <xref rid="btab292-B26" ref-type="bibr">Ondov <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab292-B27" ref-type="bibr">Solomon and Kingsford, 2018</xref>). Instead of sharing a single aggregate count, or sharing the full list of matching patient IDs (<xref rid="btab292-B29" ref-type="bibr">Weber, 2013</xref>), each hospital instead shares a smaller ‘summary sketch’ built from taking the logarithm of a coordinated random sample of <italic toggle="yes">m</italic> matching patient hashed IDs (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). Because only <italic toggle="yes">m</italic> patient IDs are used, and those are obfuscated through taking a logarithm, these HLL sketches are significantly more private than sending a full list of matching IDs. Due to the way the estimators work, HLL sketches have an error of about <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.04</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, which can be much less than expected from simple summation.</p>
    <p>But when any data are shared by a hospital to a third party, there is risk of accidental leakage. Advances in homomorphic encryption and secure multi-party computation (<xref rid="btab292-B24" ref-type="bibr">Lindell, 2005</xref>) may eventually solve this problem by not allowing the third party any unencrypted data, but these are currently still impractical for deployment due to both computational and communication complexity. For example, consider the case where a hospital finds that there is only one patient satisfying the criterion for a query. If this hospital returns the aggregate count as one, then this unique patient’s personal information is linked and can potentially be re-identified through a linkage attack (<xref rid="btab292-B14" ref-type="bibr">Emam and Dankar, 2008</xref>; <xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). To properly compare the privacy of various methods of data aggregation, we turn to the concept of <italic toggle="yes">k</italic>-anonymity. The basic idea behind <italic toggle="yes">k</italic>-anonymity is that if a method or dataset is <italic toggle="yes">k</italic>-anonymous, then each patient is similar to at least <italic toggle="yes">k</italic> − 1 other patients with respect to potentially identifying variables, so that it is hard to determine the identity of a single patient in the dataset (<xref rid="btab292-B14" ref-type="bibr">Emam and Dankar, 2008</xref>; <xref rid="btab292-B28" ref-type="bibr">Sweeney, 2002</xref>). Although other mathematical formalisms like differential privacy (<xref rid="btab292-B13" ref-type="bibr">Dwork, 2008</xref>) are much stronger, they are harder to work with, as they require injecting deliberate noise, and are not currently widely in use by clinical databases. Furthermore, it is provably impossible for composable cardinality estimators (such as HLL) to be differentially private, because the ability to deduplicate runs counter to the base assumptions of differential privacy (<xref rid="btab292-B10" ref-type="bibr">Desfontaines <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>In this article, we will assume that hospitals in a federated network implement the HLL algorithm for queries. We will then prove bounds on the expected <italic toggle="yes">k</italic>-anonymity of the shared sketches, as well as provide fast algorithms for computing that expected <italic toggle="yes">k</italic>-anonymity. This study is an extension of previous work (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>), which operated under the same setting and assumptions, but only provided empirical results and no proofs on the levels of privacy achieved. Here, we provide rigorous theoretical justification for those empirical claims.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Setting and summary</title>
      <p>In this article, we adopt the HLL sketch federated clinical network setting given in prior work (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). For completeness, we duplicate the salient points below.</p>
      <p>Assume that every patient has a single invariant ID that is used across hospitals. Prototypically, one might consider using social security numbers in the USA for that purpose. Even without a single unique identifier, it is possible to generate an ID based off a combination of other possibly non-unique IDs, such as first and last name, zip code, address, birthdate, etc. Unfortunately, there may be errors in these records due to character recognition errors (e.g. S and 8), phonetic errors (e.g. ph and f) and typographic errors including insertion, transposition and substitutions. Luckily, there is a lot of existing literature on this problem, and methods such as BIN-DET and BIN-PROB (<xref rid="btab292-B12" ref-type="bibr">Durham <italic toggle="yes">et al.</italic>, 2010</xref>) have been proposed to deal with the issue. Thus, in this article, we will treat this problem as out-of-scope and assume for simplicity that every patient has a unique stable ID known to all institutions.</p>
      <p>Further assume that there is a federated network of hospitals (or other institutions) responding to clinical queries, along with a central party that manages and relays messages. When hospitals receive a query, they generate a list of the IDs of patients who match the query. Each hospital will use a publicly known hash function to first pseudorandomly partition the patients into <italic toggle="yes">m</italic> buckets and then assign a uniform pseudorandom number between 0 and 1 to each patient. We also assume that the hash function is known by the attacker, because the attacker may have compromised one of the other hospitals or the central party. The hospital then stores the order of magnitude of the smallest number within each bucket, and sends these <italic toggle="yes">m</italic> smallest bucket values to the central party. By applying the HLL estimator, the central party is then able to compute the aggregate count for the query with a relative error of around <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1.04</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> (<xref rid="btab292-B17" ref-type="bibr">Flajolet <italic toggle="yes">et al.</italic>, 2007</xref>).</p>
      <p>Here, we focus on an individual hospital and want to determine the expected exposure to accidentally disclosing private information if the central party is compromised. As the HLL sketch aggregates information within each of the <italic toggle="yes">m</italic> buckets, our goal is to compute the expected number of buckets which are not <italic toggle="yes">k</italic>-anonymized. In line with common practice, we set <italic toggle="yes">k </italic>=<italic toggle="yes"> </italic>10 for most of our results, though the algorithms and proofs hold for other <italic toggle="yes">k</italic>. Below, we provide two approximation formulas for the expected value and in the Section 4 construct a table for the user to determine which approximation should be chosen based on the number of distinct patients and other relevant parameters.</p>
    </sec>
    <sec>
      <title>2.2 <italic toggle="yes">k</italic>-Anonymity and HLL</title>
      <sec>
        <title>2.2.1 High-level overview</title>
        <p>The HLL (<xref rid="btab292-B17" ref-type="bibr">Flajolet <italic toggle="yes">et al.</italic>, 2007</xref>) probabilistic sketching algorithm is widely used to estimate the cardinality (number of different elements) of a set. Assume we have a database of electronic medical records; we can estimate the number of distinct patients by applying the HLL algorithm. The basic idea behind HLL is that the minimum value of a collection of random numbers between 0 and 1 is inversely proportional to the size of the collection. Therefore, we can estimate the cardinality of a set by first applying a hash function which maps all the elements uniformly onto <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and considering the minimum value. For the purposes of this article, we will operate in the random oracle model, where we assume that the hash function actually maps to a random number; in practice, a standard hash function like SHA-256 would probably be employed. In order to increase the accuracy of estimation, we randomly divide the set into <italic toggle="yes">m</italic> partitions and then estimate the cardinality of the original set by the harmonic mean from <italic toggle="yes">m</italic> partitions. Furthermore, the HLL algorithm only needs to store the position of the first 1 bit in the 64-bit hash value, rather than the full patient ID hash, providing partial privacy protection. As the expected error in the final estimate is around <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.04</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, increasing <italic toggle="yes">m</italic> can reduce the error of HLL query but increases the risk of privacy leaks.</p>
        <p>In our setting, when a hospital is sent a query, there are two relevant sets to consider: (i) the background population (often, the set of all patients at the hospital) and (ii) the set of patients matching the query. The reason for considering the background population is that they can ‘hide’ patients who match the query by providing plausible deniability. The hospital will return a HLL sketch, which contains <italic toggle="yes">m</italic> values—the maximum position of the first 1 bit within each bucket. We define a HLL bucket with value <italic toggle="yes">x</italic> to be ‘<italic toggle="yes">k</italic>-anonymous’ if at least <italic toggle="yes">k</italic> − 1 patients in the background population have hash value <italic toggle="yes">x</italic>; we will call these corresponding hash values in the background population hash <italic toggle="yes">collisions</italic> (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). This means that if an attacker gets access to the sketch and can narrow down the set of potential patients to the background population, they cannot determine with certainty which of the <italic toggle="yes">k</italic> patients with that hash value was in the set of patients matching the query. Our goal is to determine the expected number of buckets that are not at least 10-anonymous (<xref rid="btab292-F1" ref-type="fig">Fig. 1</xref>).</p>
        <fig position="float" id="btab292-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>Illustration of HyperLogLog <italic toggle="yes">k</italic>-anonymity. A hospital has an identified set <italic toggle="yes">B</italic> contained within the background population <italic toggle="yes">A</italic>. Binary hashes are taken of all patient identifiers. Those hashes are first used to partition the patients into four buckets. Within each bucket of <italic toggle="yes">B</italic>, the smallest value is chosen as the representative. Then the <italic toggle="yes">k</italic>-anonymity of that bucket is the number of hashes in the corresponding bucket of the background population that share the same position of the leading 1 bit</p>
          </caption>
          <graphic xlink:href="btab292f1" position="float"/>
        </fig>
        <p>We wish to note that in this article, we deliberately use the much weaker notion of privacy provided by <italic toggle="yes">k</italic>-anonymity (<xref rid="btab292-B14" ref-type="bibr">Emam and Dankar, 2008</xref>), rather than stronger alternatives like differential privacy (<xref rid="btab292-B13" ref-type="bibr">Dwork, 2008</xref>), which have provable protection against inference attacks. Unfortunately, differential privacy (and similar alternatives) are provably incompatible with any composable cardinality estimation (<xref rid="btab292-B10" ref-type="bibr">Desfontaines <italic toggle="yes">et al.</italic>, 2019</xref>). In practice, hospital IRBs admit the use of 10-anonymity for query set patients as a useful metric, despite known issues with vulnerability of <italic toggle="yes">k</italic>-anonymity to inference attacks. Our article thus focuses on analyzing probabilistic sketches as a more private alternative to the standard practice of sending full hashed IDs.</p>
      </sec>
      <sec>
        <title>2.2.2 Formal description</title>
        <p>Let us recast the textual description above a bit more rigorously as the following mathematical problem:</p>
        <p>Let <italic toggle="yes">A</italic> be a set and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⊆</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> is a non-empty subset of <italic toggle="yes">A</italic>. <italic toggle="yes">A</italic> represents the background population and <italic toggle="yes">B</italic> represents patients satisfying the query. We define <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> as the ratio of number of patients satisfying the query to background population (also sometimes known as concept prevalence).</p>
        <p>Let <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>:</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> be a one-way hash function. In theory, we assume that we have a shared oracle available to both parties. In practice, a cryptographic hash function such as SHA-1, SHA-224 or SHA-256 (<xref rid="btab292-B21" ref-type="bibr">Johnson, 2020</xref>) is generally used. <italic toggle="yes">σ</italic> uniformly maps each element in <italic toggle="yes">A</italic> to a random real number in the interval <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Let <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo>:</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be defined by <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This function returns the number of 0 bits before the first 1 bit in <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> under a base 2 expansion.</p>
        <p>Let <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>:</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be a map that randomly partitions patients into <italic toggle="yes">m</italic> buckets. In practice, this map can also be derived from a cryptographic hash function. From the partition function <italic toggle="yes">p</italic>, we define <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which, respectively, represent the <italic toggle="yes">i</italic>th bucket in whole database and sample.</p>
        <p>Let <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>{</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be the maximum number of zeros before the first one among all hash values represented in base 2 in the <italic toggle="yes">i</italic>th bucket of B which is <italic toggle="yes">B<sub>i</sub></italic>.</p>
        <p>Let <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be the set of elements in the <italic toggle="yes">i</italic>th bucket of <italic toggle="yes">A</italic> which collide with the elements in <italic toggle="yes">B<sub>i</sub></italic>.</p>
        <p>We want to compute the <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the expected number of non-<italic toggle="yes">k</italic>-anonymous buckets.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Probability of &lt;<italic toggle="yes">k</italic>-anonymity without partition function</title>
      <p>As described above, we need to consider the collisions against all <italic toggle="yes">m</italic> buckets. Here, however, we first show a simple analysis with no partition function (i.e. the case where <italic toggle="yes">m </italic>=<italic toggle="yes"> </italic>1) and compute the probability of each possible number of collisions so that in the later sections we can use this result to compute the desired expected value of ‘non-<italic toggle="yes">k</italic>-anonymous’ buckets.</p>
      <p>Since there is only one bucket, there are only two sets <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> which represent the set of all patients and the set of patients matching the query, respectively. We denote <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>{</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, the maximum number of zeros before the first one among all hash values in base 2 in <italic toggle="yes">B</italic>, and <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, the set of collisions. We want to compute the probability that the number of collisions is less or equal to <italic toggle="yes">k</italic>, which is <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Each element in <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be thought of as an i.i.d. random variable with distribution <italic toggle="yes">Unif</italic> (0, 1). Therefore, <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> if and only if <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Then we get <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Thus, <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.<statement id="mthst1"><label>Lemma 2.1.</label><p><italic toggle="yes">Given sets</italic> <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⊂</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula><italic toggle="yes">, the probability of exactly</italic> <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">collisions is:</italic>
 <disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>∞</mml:mo></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>Proof. Since the sets A and B are fixed, we use <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to represent <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for notational simplicity here.</p><p>By the law of total probability, we know that <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>∞</mml:mo></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mi>P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>First we consider the case where we have <italic toggle="yes">k</italic> collisions in <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Next we consider the case where we have <italic toggle="yes">k</italic> collisions in <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>∩</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>σ</mml:mi><mml:mo>−</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Thus,
<disp-formula id="E4"><label>(1)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>∞</mml:mo></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>and <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> □</p></statement></p>
    </sec>
    <sec>
      <title>2.4 Expected number of buckets with less than <italic toggle="yes">k</italic> collisions</title>
      <p>Recall that <italic toggle="yes">A</italic> is the background population and <italic toggle="yes">B</italic> the set of patients satisfying the query criteria. We denote the buckets of <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> under our partition function by <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">e<sub>i</sub></italic> is the sets of collisions in the ith bucket. Thus, the expected value of the number of buckets with no more than <italic toggle="yes">k</italic> collision is <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>Note that <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. Therefore, we know for a single bucket, say <italic toggle="yes">A</italic><sub>1</sub>, its cardinality follows a binomial distribution that is <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p>
      <p>With a given <italic toggle="yes">A<sub>i</sub></italic>, <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Hypergeometric</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus,
<disp-formula id="E5"><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>.<statement id="mthst2"><label>Theorem 2.2.</label><p><italic toggle="yes">The expected number of buckets which have at least 1 collision but no more than k collisions is:</italic>
 <disp-formula id="E6"><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p><italic toggle="yes">where</italic> <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Proof.
<disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mtext>by</mml:mtext><mml:mo> </mml:mo><mml:mtext>the</mml:mtext><mml:mo> </mml:mo><mml:mtext>law</mml:mtext><mml:mo> </mml:mo><mml:mtext>of</mml:mtext><mml:mo> </mml:mo><mml:mtext>total</mml:mtext><mml:mo> </mml:mo><mml:mtext>expectation</mml:mtext><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mtext>by</mml:mtext><mml:mo> </mml:mo><mml:mtext>the</mml:mtext><mml:mo> </mml:mo><mml:mtext>independence</mml:mtext><mml:mo> </mml:mo><mml:mtext>of</mml:mtext><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mtext>by</mml:mtext><mml:mo> </mml:mo><mml:mtext>separating</mml:mtext><mml:mo> </mml:mo><mml:mtext>the</mml:mtext><mml:mo> </mml:mo><mml:mtext>summation</mml:mtext><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mtext>by</mml:mtext><mml:mo> </mml:mo><mml:mtext>law</mml:mtext><mml:mo> </mml:mo><mml:mtext>of</mml:mtext><mml:mo> </mml:mo><mml:mtext>total</mml:mtext><mml:mo> </mml:mo><mml:mtext>probability</mml:mtext><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>In order to compute <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we have to consider the range of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> which is <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.
<disp-formula id="E8"><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>In contrast to the simple case in Section 2.3, here <italic toggle="yes">B</italic><sub>1</sub> is not necessarily a proper subset of <italic toggle="yes">A</italic><sub>1</sub> because <italic toggle="yes">A</italic><sub>1</sub> can be the empty set and thus <italic toggle="yes">B</italic><sub>1</sub> is also an empty set in this case. The collision number is zero if and only if <italic toggle="yes">A</italic><sub>1</sub> is an empty sets. Therefore, we will expand the formula in Lemma 2.1 to compute <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Furthermore, if we want rule out the case of zero collisions—because when the bucket is empty, there is not a patient ID for which we need to guarantee <italic toggle="yes">k</italic>-anonymity—we should set the range of <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, respectively.
<disp-formula id="E9"><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>equation</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≠</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Therefore, we will get:
<disp-formula id="E10"><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. □</p></statement></p>
    </sec>
  </sec>
  <sec>
    <title>3 Algorithms</title>
    <sec>
      <title>3.1 Time complexity of evaluating expectation</title>
      <p>Again, recall that <italic toggle="yes">A</italic> is the background population, <italic toggle="yes">B</italic> is the set of patients satisfying the query criteria and <italic toggle="yes">e</italic> is the set of collisions. In Section 2.4, we gave an explicit formula for computing <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. However, the time complexity of carrying out that computation is troublesome
<disp-formula id="E11"><mml:math id="M11" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>∞</mml:mo></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mi>f</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>Usually, <italic toggle="yes">k</italic> is smaller than <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and the infinity in the second sum will be replaced by 64 (or some other constant &lt;100) because it represents the maximum number of zeros before the first one among all hash values in base 2. As there are only 7 billion people on Earth, 64 bits is sufficient for the original hash function to have low probability of collisions. Therefore, the time complexity is <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for at most k collisions.</p>
      <p>We consider the time complexity of computing the desired expectation. Theoretically, the range of <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and the range of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Therefore, the computation time is:
<disp-formula id="E12"><mml:math id="M12" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mtext>where</mml:mtext><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>and the time complexity is <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which is quadratic in the size of population for at most <italic toggle="yes">k</italic> collisions. In practice, for large set sizes, it is computationally infeasible to use this theoretical formula to compute the desired expectation; thus, in the remainder of this article we analyze fast approximations.</p>
    </sec>
    <sec>
      <title>3.2 Approximation A1: concentration inequalities</title>
      <p>When <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is large, it is impossible to sum over whole range of <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. Therefore, we will use concentration inequalities to restrict <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> to a smaller range. Because there is only an exponentially small probability that <italic toggle="yes">A</italic><sub>1</sub> and <italic toggle="yes">B</italic><sub>1</sub> will fall outside these restricted windows, this will have minimal effect on the final answer while reducing the computation time from quadratic to linear in the size of <italic toggle="yes">A</italic>.</p>
      <p>Recall that <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. In order to reduce the time complexity, we will restrict <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in our computations to the interval <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Recall that <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Hypergeometric</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for a given <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">Var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. However, we define <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> which is greater than <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and restrict <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in the interval <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in order to compute the error bound more easily below in Section 3.2.1. After concentration, we can make sure that <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≲</mml:mo><mml:mn>9.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>≲</mml:mo><mml:mn>9.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> which is shown below in detail in Section 3.2.1. As an aside, while these two intervals of <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> have been chosen for analyzing the error bound and time complexity analytically, in the computing code we can directly use built-in functions to compute the relevant confidence intervals for <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>By the concentration inequalities on <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, the desired expectation will be approximated by:
<disp-formula id="E13"><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The computation time after concentration is:
<disp-formula id="E14"><mml:math id="M14" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>0</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>0</mml:mn><mml:msqrt><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mn>100</mml:mn><mml:msqrt><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:msqrt><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>So, the time complexity after concentration is <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which is linear in <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. After concentration, the expected value <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is smaller than the actual <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, but we can bound the error.</p>
      <sec>
        <title>3.2.1 Error bounds</title>
        <p>Recall that <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. We concentrate <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in the interval <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We define <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the cumulative density function of <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>First, we consider the concentration on <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. We will apply the higher moments inequality on <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref rid="btab292-B5" ref-type="bibr">Blum <italic toggle="yes">et al.</italic>, 2020</xref>):
<disp-formula id="E15"><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mtext>any</mml:mtext><mml:mo> </mml:mo><mml:mtext>positive</mml:mtext><mml:mo> </mml:mo><mml:mtext>even</mml:mtext><mml:mo> </mml:mo><mml:mtext>integer</mml:mtext><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>If we choose <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>6 then, we will get:
<disp-formula id="E16"><mml:math id="M16" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>30</mml:mn><mml:mo>δ</mml:mo><mml:mo>+</mml:mo><mml:mn>120</mml:mn><mml:msup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>25</mml:mn><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>δ</mml:mo><mml:mo>−</mml:mo><mml:mn>130</mml:mn><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>15</mml:mn><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mn>15</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>9.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p>
        <p>Then we consider the <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> for a given <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. For a given <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, we know <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∼</mml:mo></mml:mrow></mml:math></inline-formula> Hypergeometric <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We concentrate <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in the interval <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We define <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the cumulative density function of <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> for a given <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Note that for <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we can get <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. The expected value is equal to <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the variance is equal to <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> which is bigger than the variance of <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> for this given <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. This explains that the hypergeometric distribution is more concentrated about the mean than the binomial distribution (<xref rid="btab292-B22" ref-type="bibr">Kalbfleisch, 1985</xref>). Therefore, we will use this binomial distribution to bound the tail of our hypergeometric distribution:
<disp-formula id="E17"><mml:math id="M17" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi mathvariant="italic">XorX</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mn>5</mml:mn><mml:msqrt><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>≲</mml:mo><mml:mn>9.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p><disp-formula id="E18"><mml:math id="M18" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mi>m</mml:mi><mml:mn>1.92</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>But the in the computing code, we can use the built-in function to find the interval (<italic toggle="yes">L<sub>a</sub></italic>, <italic toggle="yes">U<sub>a</sub></italic>) and (<italic toggle="yes">L<sub>b</sub></italic>, <italic toggle="yes">U<sub>b</sub></italic>) such that <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:math></inline-formula>. This will not affect the time complexity and can ensure that the absolute error between the estimated expected value and the actual expected value is &lt;1 by choosing a proper <italic toggle="yes">α</italic>. It is obvious the smaller <italic toggle="yes">α</italic> is, the smaller the error will be, but the intervals (<italic toggle="yes">L<sub>a</sub></italic>, <italic toggle="yes">U<sub>a</sub></italic>) and (<italic toggle="yes">L<sub>b</sub></italic>, <italic toggle="yes">U<sub>b</sub></italic>) will be bigger which means a longer computing time. Therefore, there is a tradeoff between accuracy and speed (see <xref rid="btab292-T2" ref-type="table">Table 2</xref> for real computing time). Fortunately, in all cases we explore, the <italic toggle="yes">L<sub>a</sub></italic> and <italic toggle="yes">U<sub>a</sub></italic> given above can ensure that <inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.
<disp-formula id="E19"><mml:math id="M19" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>α</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>3.2.2 Approximation A2: mean-field approximation</title>
        <p>Although the time complexity after concentration is linear in <inline-formula id="IE137"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, for large <inline-formula id="IE138"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">m</italic> small, this speedup is often still not enough. We can further approximate <inline-formula id="IE139"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by <inline-formula id="IE140"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and get the following approximation of the expectation:
<disp-formula id="E20"><mml:math id="M20" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>This is a ‘mean-field’ approximation based on Approximation A1. The basic idea behind this approximation is to use the probability at the mean value which is <inline-formula id="IE141"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to represent all the probabilities <inline-formula id="IE142"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> when <inline-formula id="IE143"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> because <inline-formula id="IE144"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is monotonic increasing in <inline-formula id="IE145"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and the interval (<italic toggle="yes">L<sub>b</sub></italic>, <italic toggle="yes">U<sub>b</sub></italic>) is small enough compared with the theoretical range <inline-formula id="IE146"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>The range of <inline-formula id="IE147"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is still <inline-formula id="IE148"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Therefore, the computation time of <italic toggle="yes">E</italic><sub>2</sub> is:
<disp-formula id="E21"><mml:math id="M21" display="block" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the time complexity is <inline-formula id="IE149"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The real computing time will be discussed in the Section 4. Unfortunately, we do not have a strong provable guarantee with this approximation, but it seems empirically to work well in practice.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>In order to assess the accuracy–speed tradeoffs of our two approximations, we ran simulations measuring the ground truth empirical <italic toggle="yes">k</italic>-anonymity of patients in several different regimes using HLL sketches. Those simulations serve as the ground truth since they have the same distribution as hashing real patient identifiers with a random seed, without needing to use real patient data for this article. Then, we compared those empirical values against the approximations described in this article. In the large cardinality regimes, it is computationally infeasible to run full simulations, so we only compare the run-times of the two approximation methods. In <xref rid="btab292-T2" ref-type="table">Table 2</xref>, we provide full tables of these results. In <xref rid="btab292-T1" ref-type="table">Table 1</xref>, we provide a high-level summary giving a practitioner guidance on which method is appropriate under those particular parameter choices. All computations were run in single-thread mode on an AMD Ryzen Threadripper 3970X 32-core CPU machine running Ubuntu 18.04.5 LTS (bionic) with 256 GiB of RAM. It is worth mentioning that steps in computations are trivially parallelizable, but for benchmarking purposes all our results are of single-threaded performance. Additionally, instead of using actual hash functions (e.g. SHA-256), we generate uniform random numbers as the hashed values, which has the same probability distribution. Code is available on Github and relies on using the numpy, scipy.stat and decimal packages for simulation of patient hashes and explicit computation of probability distributions: <ext-link xlink:href="https://github.com/tzyRachel/K-anonymity-Expectation" ext-link-type="uri">https://github.com/tzyRachel/K-anonymity-Expectation</ext-link></p>
    <table-wrap position="float" id="btab292-T1">
      <label>Table 1.</label>
      <caption>
        <p>Choice table for approximation method</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.1<hr/></th>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.08<hr/></th>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.05<hr/></th>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.01<hr/></th>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.005<hr/></th>
            <th colspan="2" rowspan="1"><italic toggle="yes">r</italic> = 0.001<hr/></th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE150">
                <mml:math id="IM149" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mo>|</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mo>/</mml:mo>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">|A|</th>
            <th rowspan="1" colspan="1">m</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A2</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">10<sup>4</sup></td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE151">
                <mml:math id="IM150" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE152">
                <mml:math id="IM151" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE153">
                <mml:math id="IM152" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE154">
                <mml:math id="IM153" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE155">
                <mml:math id="IM154" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE156">
                <mml:math id="IM155" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">10<sup>4</sup></td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE157">
                <mml:math id="IM156" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE158">
                <mml:math id="IM157" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE159">
                <mml:math id="IM158" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE160">
                <mml:math id="IM159" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE161">
                <mml:math id="IM160" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE162">
                <mml:math id="IM161" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">10<sup>4</sup></td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE163">
                <mml:math id="IM162" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE164">
                <mml:math id="IM163" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE165">
                <mml:math id="IM164" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE166">
                <mml:math id="IM165" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE167">
                <mml:math id="IM166" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE168">
                <mml:math id="IM167" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE169">
                <mml:math id="IM168" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE170">
                <mml:math id="IM169" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE171">
                <mml:math id="IM170" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE172">
                <mml:math id="IM171" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE173">
                <mml:math id="IM172" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE174">
                <mml:math id="IM173" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE175">
                <mml:math id="IM174" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE176">
                <mml:math id="IM175" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE177">
                <mml:math id="IM176" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE178">
                <mml:math id="IM177" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE179">
                <mml:math id="IM178" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE180">
                <mml:math id="IM179" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE181">
                <mml:math id="IM180" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE182">
                <mml:math id="IM181" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE183">
                <mml:math id="IM182" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE184">
                <mml:math id="IM183" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE185">
                <mml:math id="IM184" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE186">
                <mml:math id="IM185" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE187">
                <mml:math id="IM186" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE188">
                <mml:math id="IM187" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE189">
                <mml:math id="IM188" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE190">
                <mml:math id="IM189" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE191">
                <mml:math id="IM190" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE192">
                <mml:math id="IM191" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE193">
                <mml:math id="IM192" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE194">
                <mml:math id="IM193" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE195">
                <mml:math id="IM194" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE196">
                <mml:math id="IM195" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE197">
                <mml:math id="IM196" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE198">
                <mml:math id="IM197" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">10<sup>5</sup></td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE199">
                <mml:math id="IM198" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE200">
                <mml:math id="IM199" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE201">
                <mml:math id="IM200" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE202">
                <mml:math id="IM201" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE203">
                <mml:math id="IM202" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE204">
                <mml:math id="IM203" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE205">
                <mml:math id="IM204" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE206">
                <mml:math id="IM205" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE207">
                <mml:math id="IM206" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE208">
                <mml:math id="IM207" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE209">
                <mml:math id="IM208" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE210">
                <mml:math id="IM209" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE211">
                <mml:math id="IM210" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE212">
                <mml:math id="IM211" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE213">
                <mml:math id="IM212" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE214">
                <mml:math id="IM213" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE215">
                <mml:math id="IM214" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE216">
                <mml:math id="IM215" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1500</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">666</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE217">
                <mml:math id="IM216" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE218">
                <mml:math id="IM217" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE219">
                <mml:math id="IM218" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE220">
                <mml:math id="IM219" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE221">
                <mml:math id="IM220" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE222">
                <mml:math id="IM221" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE223">
                <mml:math id="IM222" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE224">
                <mml:math id="IM223" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE225">
                <mml:math id="IM224" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE226">
                <mml:math id="IM225" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE227">
                <mml:math id="IM226" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE228">
                <mml:math id="IM227" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE229">
                <mml:math id="IM228" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE230">
                <mml:math id="IM229" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE231">
                <mml:math id="IM230" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE232">
                <mml:math id="IM231" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE233">
                <mml:math id="IM232" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE234">
                <mml:math id="IM233" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE235">
                <mml:math id="IM234" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE236">
                <mml:math id="IM235" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE237">
                <mml:math id="IM236" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE238">
                <mml:math id="IM237" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE239">
                <mml:math id="IM238" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE240">
                <mml:math id="IM239" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE241">
                <mml:math id="IM240" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE242">
                <mml:math id="IM241" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE243">
                <mml:math id="IM242" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE244">
                <mml:math id="IM243" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE245">
                <mml:math id="IM244" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE246">
                <mml:math id="IM245" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">20 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE247">
                <mml:math id="IM246" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE248">
                <mml:math id="IM247" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE249">
                <mml:math id="IM248" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE250">
                <mml:math id="IM249" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE251">
                <mml:math id="IM250" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE252">
                <mml:math id="IM251" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">10<sup>6</sup></td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE253">
                <mml:math id="IM252" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE254">
                <mml:math id="IM253" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE255">
                <mml:math id="IM254" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE256">
                <mml:math id="IM255" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE257">
                <mml:math id="IM256" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE258">
                <mml:math id="IM257" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE259">
                <mml:math id="IM258" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE260">
                <mml:math id="IM259" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE261">
                <mml:math id="IM260" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE262">
                <mml:math id="IM261" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE263">
                <mml:math id="IM262" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE264">
                <mml:math id="IM263" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20 000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE265">
                <mml:math id="IM264" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE266">
                <mml:math id="IM265" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE267">
                <mml:math id="IM266" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE268">
                <mml:math id="IM267" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE269">
                <mml:math id="IM268" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE270">
                <mml:math id="IM269" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE271">
                <mml:math id="IM270" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE272">
                <mml:math id="IM271" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE273">
                <mml:math id="IM272" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE274">
                <mml:math id="IM273" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE275">
                <mml:math id="IM274" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE276">
                <mml:math id="IM275" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE277">
                <mml:math id="IM276" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE278">
                <mml:math id="IM277" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE279">
                <mml:math id="IM278" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE280">
                <mml:math id="IM279" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE281">
                <mml:math id="IM280" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE282">
                <mml:math id="IM281" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3333</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">3000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE283">
                <mml:math id="IM282" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE284">
                <mml:math id="IM283" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE285">
                <mml:math id="IM284" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE286">
                <mml:math id="IM285" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE287">
                <mml:math id="IM286" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE288">
                <mml:math id="IM287" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE289">
                <mml:math id="IM288" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE290">
                <mml:math id="IM289" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE291">
                <mml:math id="IM290" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE292">
                <mml:math id="IM291" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE293">
                <mml:math id="IM292" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE294">
                <mml:math id="IM293" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1500</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">6666</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE295">
                <mml:math id="IM294" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE296">
                <mml:math id="IM295" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE297">
                <mml:math id="IM296" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE298">
                <mml:math id="IM297" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE299">
                <mml:math id="IM298" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE300">
                <mml:math id="IM299" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE301">
                <mml:math id="IM300" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE302">
                <mml:math id="IM301" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE303">
                <mml:math id="IM302" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE304">
                <mml:math id="IM303" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE305">
                <mml:math id="IM304" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE306">
                <mml:math id="IM305" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">20 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE307">
                <mml:math id="IM306" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE308">
                <mml:math id="IM307" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE309">
                <mml:math id="IM308" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE310">
                <mml:math id="IM309" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE311">
                <mml:math id="IM310" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE312">
                <mml:math id="IM311" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">10<sup>7</sup></td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE313">
                <mml:math id="IM312" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE314">
                <mml:math id="IM313" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE315">
                <mml:math id="IM314" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE316">
                <mml:math id="IM315" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE317">
                <mml:math id="IM316" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE318">
                <mml:math id="IM317" display="inline" overflow="scroll">
                  <mml:mo>√</mml:mo>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1"/>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><italic toggle="yes">Note</italic>: <italic toggle="yes">A</italic> is the total size of the hospital background population, <italic toggle="yes">m</italic> is the number of buckets used in the HyperLogLog sketch and <italic toggle="yes">r</italic> is the fraction of the background population that matches the query criteria. ‘A1’ and ‘A2’, respectively, denote approximations 1 and 2. For every one of the parameter regimes, we used simulations to determine which of the approximation methods is more suitable for the practitioner.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="btab292-T2">
      <label>Table 2</label>
      <caption>
        <p>Expected number of non-10-anonymous buckets from Approximations A1 and A2 compared against ground truth simulations</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">|<italic toggle="yes">A</italic>|/<italic toggle="yes">m</italic></th>
            <th rowspan="1" colspan="1">|<italic toggle="yes">A</italic>|</th>
            <th rowspan="1" colspan="1">
              <italic toggle="yes">m</italic>
            </th>
            <th rowspan="1" colspan="1">
              <italic toggle="yes">r</italic>
            </th>
            <th rowspan="1" colspan="1">Simulation average</th>
            <th rowspan="1" colspan="1">Simulation replicates</th>
            <th rowspan="1" colspan="1">A1</th>
            <th rowspan="1" colspan="1">A1 time (s)</th>
            <th rowspan="1" colspan="1">A2</th>
            <th rowspan="1" colspan="1">A2 time (s)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.60</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">70.28</td>
            <td rowspan="1" colspan="1">14.75</td>
            <td rowspan="1" colspan="1">72.76</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">141.14</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">141.12</td>
            <td rowspan="1" colspan="1">6.61</td>
            <td rowspan="1" colspan="1">149.85</td>
            <td rowspan="1" colspan="1">1.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">354.38</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">353.74</td>
            <td rowspan="1" colspan="1">2.60</td>
            <td rowspan="1" colspan="1">414.61</td>
            <td rowspan="1" colspan="1">0.20</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">300</td>
            <td rowspan="1" colspan="1">30 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.68</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">70.60</td>
            <td rowspan="1" colspan="1">62.26</td>
            <td rowspan="1" colspan="1">71.60</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">150</td>
            <td rowspan="1" colspan="1">30 000</td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">141.79</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">141.59</td>
            <td rowspan="1" colspan="1">26.66</td>
            <td rowspan="1" colspan="1">144.55</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">60</td>
            <td rowspan="1" colspan="1">30 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">354.90</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">354.65</td>
            <td rowspan="1" colspan="1">9.88</td>
            <td rowspan="1" colspan="1">372.67</td>
            <td rowspan="1" colspan="1">1.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">30</td>
            <td rowspan="1" colspan="1">30 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">712.22</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">709.73</td>
            <td rowspan="1" colspan="1">4.12</td>
            <td rowspan="1" colspan="1">783.81</td>
            <td rowspan="1" colspan="1">0.40</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.87</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">70.71</td>
            <td rowspan="1" colspan="1">84.74</td>
            <td rowspan="1" colspan="1">71.44</td>
            <td rowspan="1" colspan="1">4.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">250</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">142.94</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">141.76</td>
            <td rowspan="1" colspan="1">47.65</td>
            <td rowspan="1" colspan="1">143.68</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">352.96</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">353.20</td>
            <td rowspan="1" colspan="1">19.70</td>
            <td rowspan="1" colspan="1">363.80</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">707.75</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">706.99</td>
            <td rowspan="1" colspan="1">8.19</td>
            <td rowspan="1" colspan="1">749.25</td>
            <td rowspan="1" colspan="1">0.70</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">800</td>
            <td rowspan="1" colspan="1">80 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.57</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">70.40</td>
            <td rowspan="1" colspan="1">136.09</td>
            <td rowspan="1" colspan="1">70.98</td>
            <td rowspan="1" colspan="1">4.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">400</td>
            <td rowspan="1" colspan="1">80 000</td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">142.29</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">140.90</td>
            <td rowspan="1" colspan="1">77.41</td>
            <td rowspan="1" colspan="1">142.45</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">160</td>
            <td rowspan="1" colspan="1">80 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">354.54</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">353.85</td>
            <td rowspan="1" colspan="1">34.99</td>
            <td rowspan="1" colspan="1">360.40</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">80</td>
            <td rowspan="1" colspan="1">80 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">704.88</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">707.91</td>
            <td rowspan="1" colspan="1">16.47</td>
            <td rowspan="1" colspan="1">734.01</td>
            <td rowspan="1" colspan="1">1.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.13</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">70.69</td>
            <td rowspan="1" colspan="1">252.00</td>
            <td rowspan="1" colspan="1">71.24</td>
            <td rowspan="1" colspan="1">4.60</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">142.77</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">141.76</td>
            <td rowspan="1" colspan="1">134.00</td>
            <td rowspan="1" colspan="1">142.87</td>
            <td rowspan="1" colspan="1">3.18</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">354.27</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">353.37</td>
            <td rowspan="1" colspan="1">40.57</td>
            <td rowspan="1" colspan="1">358.63</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">705.02</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">706.95</td>
            <td rowspan="1" colspan="1">22.16</td>
            <td rowspan="1" colspan="1">727.60</td>
            <td rowspan="1" colspan="1">1.30</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">1416.61</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">1414.37</td>
            <td rowspan="1" colspan="1">9.95</td>
            <td rowspan="1" colspan="1">1498.50</td>
            <td rowspan="1" colspan="1">0.70</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">100 000</td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">3536.27</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">3539.54</td>
            <td rowspan="1" colspan="1">3.37</td>
            <td rowspan="1" colspan="1">4146.33</td>
            <td rowspan="1" colspan="1">0.20</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3000</td>
            <td rowspan="1" colspan="1">300 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.47</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.76</td>
            <td rowspan="1" colspan="1">8.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">300</td>
            <td rowspan="1" colspan="1">300 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">709.57</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">709.02</td>
            <td rowspan="1" colspan="1">90.00</td>
            <td rowspan="1" colspan="1">715.96</td>
            <td rowspan="1" colspan="1">2.40</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">500 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.13</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.91</td>
            <td rowspan="1" colspan="1">10.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">500 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">708.77</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">710.08</td>
            <td rowspan="1" colspan="1">155.00</td>
            <td rowspan="1" colspan="1">714.36</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">8000</td>
            <td rowspan="1" colspan="1">800 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.92</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">71.06</td>
            <td rowspan="1" colspan="1">14.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">800</td>
            <td rowspan="1" colspan="1">800 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">708.00</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">707.00</td>
            <td rowspan="1" colspan="1">25.00</td>
            <td rowspan="1" colspan="1">709.76</td>
            <td rowspan="1" colspan="1">4.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.58</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.89</td>
            <td rowspan="1" colspan="1">16.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">356.33</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">354.85</td>
            <td rowspan="1" colspan="1">607.00</td>
            <td rowspan="1" colspan="1">355.69</td>
            <td rowspan="1" colspan="1">7.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">707.66</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">710.06</td>
            <td rowspan="1" colspan="1">316.00</td>
            <td rowspan="1" colspan="1">712.36</td>
            <td rowspan="1" colspan="1">5.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">1419.32</td>
            <td rowspan="1" colspan="1">60</td>
            <td rowspan="1" colspan="1">1420.47</td>
            <td rowspan="1" colspan="1">150.00</td>
            <td rowspan="1" colspan="1">1428.72</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">3534.64</td>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">3536.36</td>
            <td rowspan="1" colspan="1">65.00</td>
            <td rowspan="1" colspan="1">3586.25</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">7068.96</td>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">7073.09</td>
            <td rowspan="1" colspan="1">30.00</td>
            <td rowspan="1" colspan="1">7275.97</td>
            <td rowspan="1" colspan="1">1.30</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">20 000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">14 146.62</td>
            <td rowspan="1" colspan="1">12.00</td>
            <td rowspan="1" colspan="1">14 985.00</td>
            <td rowspan="1" colspan="1">0.70</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">1 000 000</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">35 396.39</td>
            <td rowspan="1" colspan="1">4.00</td>
            <td rowspan="1" colspan="1">41 463.50</td>
            <td rowspan="1" colspan="1">0.20</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">30 000</td>
            <td rowspan="1" colspan="1">3 000 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.01</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.98</td>
            <td rowspan="1" colspan="1">30.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3000</td>
            <td rowspan="1" colspan="1">3 000 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">703.79</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">707.55</td>
            <td rowspan="1" colspan="1">8.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50 000</td>
            <td rowspan="1" colspan="1">5 000 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.54</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.71</td>
            <td rowspan="1" colspan="1">40.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">5 000 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">708.32</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">709.07</td>
            <td rowspan="1" colspan="1">12.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">80 000</td>
            <td rowspan="1" colspan="1">8 000 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">71.01</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.87</td>
            <td rowspan="1" colspan="1">50.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">8000</td>
            <td rowspan="1" colspan="1">8000 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">707.81</td>
            <td rowspan="1" colspan="1">70</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">710.63</td>
            <td rowspan="1" colspan="1">15.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1 00 000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">70.48</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">70.71</td>
            <td rowspan="1" colspan="1">55.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">20 000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">354.08</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">354.39</td>
            <td rowspan="1" colspan="1">30.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">711.81</td>
            <td rowspan="1" colspan="1">70</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">708.87</td>
            <td rowspan="1" colspan="1">16.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1418.13</td>
            <td rowspan="1" colspan="1">11.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">3551.59</td>
            <td rowspan="1" colspan="1">726.00</td>
            <td rowspan="1" colspan="1">3556.85</td>
            <td rowspan="1" colspan="1">7.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1500.15</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">6666</td>
            <td colspan="2" rowspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">4711.94</td>
            <td rowspan="1" colspan="1">547.00</td>
            <td rowspan="1" colspan="1">4720.90</td>
            <td rowspan="1" colspan="1">5.70</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">1000</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">10 000</td>
            <td colspan="2" rowspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">7103.56</td>
            <td rowspan="1" colspan="1">366.86</td>
            <td rowspan="1" colspan="1">7123.63</td>
            <td rowspan="1" colspan="1">4.60</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">666.7</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">15 000</td>
            <td colspan="2" rowspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10 614.93</td>
            <td rowspan="1" colspan="1">250.00</td>
            <td rowspan="1" colspan="1">10 659.18</td>
            <td rowspan="1" colspan="1">3.70</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">500</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">20 000</td>
            <td colspan="2" rowspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">14 207.49</td>
            <td rowspan="1" colspan="1">192.00</td>
            <td rowspan="1" colspan="1">14 287.16</td>
            <td rowspan="1" colspan="1">3.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">200</td>
            <td rowspan="1" colspan="1">10 000 000</td>
            <td rowspan="1" colspan="1">50 000</td>
            <td colspan="2" rowspan="1">0.1</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">35 366.18</td>
            <td rowspan="1" colspan="1">79.00</td>
            <td rowspan="1" colspan="1">35 862.54</td>
            <td rowspan="1" colspan="1">2.00</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn2">
          <p><italic toggle="yes">Note</italic>: Some entries are empty because the computation time was infeasibly long. We have highlighted (in yellow or green) the more accurate approximation finished within 10 min. Full simulation and computation results for <italic toggle="yes">r</italic> <inline-formula id="IE136"><mml:math id="IM318" display="inline" overflow="scroll"><mml:mrow><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.08</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.005</mml:mn><mml:mo>,</mml:mo><mml:mn>0.001</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> are available on Github in machine-readable format.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Recall that <italic toggle="yes">A</italic> represents the number of all patients, <italic toggle="yes">B</italic> represents the number of patients who meet some query criteria and <italic toggle="yes">m</italic> is the number of buckets in the HLL process. We introduce <inline-formula id="IE319"><mml:math id="IM319" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> to represent the ratio of <inline-formula id="IE320"><mml:math id="IM320" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE321"><mml:math id="IM321" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, because as we will see, this ratio controls to a large extent the number of collisions. Intuitively, <italic toggle="yes">r</italic> represents the number of background population persons who could be used to provide plausible deniability to each patient in the query set.</p>
    <p>Our simulations sweep over the different combinations of the parameters <italic toggle="yes">A</italic>, <italic toggle="yes">r</italic> and <italic toggle="yes">m</italic> to construct a table to fit Approximations A1 and A2. In all simulations, we restrict <inline-formula id="IE322"><mml:math id="IM322" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in the interval <inline-formula id="IE323"><mml:math id="IM323" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">m</italic> in the interval <inline-formula id="IE324"><mml:math id="IM324" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. In this article, the total number of different patients in a hospital is assumed to be over 10<sup>4</sup>; not only are approximation methods unnecessary for <inline-formula id="IE325"><mml:math id="IM325" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> because exact computations are feasible, but there is not a sufficiently large background population to hide the query set when <inline-formula id="IE326"><mml:math id="IM326" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is small, and the privacy characteristics then become equivalent to sending hashed IDs (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>). Since the simulations are run under the condition of ‘10-anonymity’, we make sure that <inline-formula id="IE327"><mml:math id="IM327" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> which is the mean value of the single bucket size. Also, <italic toggle="yes">r</italic> is restricted in the interval <inline-formula id="IE328"><mml:math id="IM328" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.001</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and we choose six different values of <italic toggle="yes">r</italic> which are <inline-formula id="IE329"><mml:math id="IM329" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.08</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.005</mml:mn><mml:mo>,</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> to run the simulations and compare the simulation results with computing results.</p>
    <p>As we discussed in the Section 2, we can estimate the desired expected value by both Approximations A1 and A2. The final choice of Approximation A1 or Approximation A2 seems to be dependent primarily on <inline-formula id="IE330"><mml:math id="IM330" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. In most cases, when <inline-formula id="IE331"><mml:math id="IM331" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:math></inline-formula>, Approximation A2 is good enough and the computing time is no longer than 3 min. When <inline-formula id="IE332"><mml:math id="IM332" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:math></inline-formula>, Approximation A2 will be not accurate enough and we have to choose Approximation A1. The computing time of Approximation A1 is proportional to <inline-formula id="IE333"><mml:math id="IM333" display="inline" overflow="scroll"><mml:mrow><mml:msqrt><mml:mi>r</mml:mi></mml:msqrt><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, which is sometimes a concern. When <inline-formula id="IE334"><mml:math id="IM334" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:math></inline-formula>, the computing time is usually no longer than 8 min. But there are several special cases, such as when <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.1 and <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.08, that the computing time at <inline-formula id="IE335"><mml:math id="IM335" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>6666</mml:mn></mml:mrow></mml:math></inline-formula> is ∼10 min which might be acceptable but is really not ideal. Furthermore, in extreme cases, the approximate expected <italic toggle="yes">k</italic>-anonymity return by Approximations 1 and 2 differ by ∼10 (<xref rid="btab292-T2" ref-type="table">Table 2</xref>).</p>
    <p>To make things easier for the end-practitioner, we provide a summary ‘choice’ table (<xref rid="btab292-T1" ref-type="table">Table 1</xref>) guiding them on which approximation is suggested, based on different numbers of patients, numbers of buckets and ratios of number of patients matching query to all patients. Choosing between approximations A1 and A2 is an accuracy/running time tradeoff. A1 is usually both more accurate and expensive than A2. For the purpose of the choice table, to give a concrete recommendation, we aim to have single-threaded running times below 10 min; many modern multi-core machines can run over a dozen threads at once, and given that the approximation algorithms are trivially parallelizable, this amounts implicitly to a goal of real wall-clock time of less than a minute. The choice table is filled out by selecting the approximation method with the least error given that time constraint. In most cases, we choose A1 if the running time is below 10 min. Sometimes, computation results from A1 and A2 are almost the same, so the faster method can be chosen. Based on this rule, we compare gold-standard simulation results against the approximations in <xref rid="btab292-T2" ref-type="table">Table 2</xref> to construct the ‘choice’ table. Note that our choice of 10 min single-threaded run-time was arbitrary; given extra computational resources, the ideal switch-off point between approximations will vary.</p>
    <p><xref rid="btab292-F2" ref-type="fig">Figure 2</xref> shows the errors between the approximation results (based on the choice <xref rid="btab292-T1" ref-type="table">Table 1</xref>) and simulation results (<xref rid="btab292-T2" ref-type="table">Table 2</xref>) when number of distinct patients is 10<sup>7</sup> and number of buckets are 100 and 1000, respectively. The absolute values of all the errors are no more than 4.</p>
    <fig position="float" id="btab292-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Errors between Approximation (based on choice table) and simulation of 100 random trials with number of buckets = 100 (top) and 1000 (bottom)</p>
      </caption>
      <graphic xlink:href="btab292f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>We first note that all of the approximations we have provided finish on the order of minutes. As they are analytical approximations, there is also no need to run them multiple times. Although we have not shown explicit simulation run-times in the tables above, the larger simulations take upwards of hours; furthermore, we did not perform simulations for the largest parameter ranges because we expected those to take significantly longer. Our approximations speed up determining the expected privacy loss from distributing HLL sketches.</p>
    <p>We are also able to form some general conclusions about the expected privacy of HLL sketches. As mentioned above the prevalence ratio <inline-formula id="IE336"><mml:math id="IM336" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> are, respectively, the background population and query population can be interpreted as the ratio of patients matching a query (e.g. ‘How many patients have been diagnosed with diabetes?’). Based on HLL, <italic toggle="yes">m</italic> is the number of buckets and <italic toggle="yes">A<sub>i</sub></italic> and <italic toggle="yes">B<sub>i</sub></italic> are the <italic toggle="yes">i</italic>th bucket in <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>. <xref rid="btab292-F3" ref-type="fig">Figure 3</xref> plots the number of buckets and prevalence rate against the estimated expected number of non-‘<italic toggle="yes">k</italic>-anonymized’ buckets and the number of buckets versus the percentage of the non-‘<italic toggle="yes">k</italic>-anonymous’ buckets. The two top plots are simply the number of non-<italic toggle="yes">k</italic>-anonymous buckets against the number of buckets and varying the other parameters, but this turns out to not be the right set of variables to control.</p>
    <fig position="float" id="btab292-F3">
      <label>Fig. 3.</label>
      <caption>
        <p>Expected number of non-10-anonymous buckets under different combinations of number of buckets (<italic toggle="yes">m</italic>) and prevalence rate (<italic toggle="yes">r</italic>) when total number of patients is 10<sup>7</sup>. (Top) Number of non-10-anonymous buckets under different combinations of <italic toggle="yes">m</italic> (number of buckets) and <italic toggle="yes">r</italic> (prevalence rate) when total number of patients is 10<sup>7</sup>. (Left bottom) However, the fraction of non-10-anonymous buckets remains constant as the number of buckets increase when the other variables are held fixed. (Right bottom) It is the relationship to prevalence rate that is more complicated and nonlinear, as shown by focusing on the behavior for 100 and 500 buckets</p>
      </caption>
      <graphic xlink:href="btab292f3" position="float"/>
    </fig>
    <p>Instead, as evidenced by the lower-left plot (<xref rid="btab292-F3" ref-type="fig">Fig. 3</xref>), a roughly constant fraction of the buckets are not <italic toggle="yes">k</italic>-anonymized when <italic toggle="yes">r</italic> is constant. This is unsurprising because as mentioned earlier, <italic toggle="yes">r</italic> is intuitively the number of background population members that could be used to hide each patient. Of course, random chance also plays a large role. More precisely, this constant is close to <inline-formula id="IE337"><mml:math id="IM337" display="inline" overflow="scroll"><mml:mrow><mml:mn>100</mml:mn><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE338"><mml:math id="IM338" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability of that the number of collisions is &gt;0 and &lt;10 when the bucket size is at the mean value <inline-formula id="IE339"><mml:math id="IM339" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. It is not quite equal for two reasons. The first reason is the obvious one, that we are using the approximations that form the subject of this article. The second reason is that the single bucket size <inline-formula id="IE340"><mml:math id="IM340" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> follows a Binomial distribution with mean <inline-formula id="IE341"><mml:math id="IM341" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE342"><mml:math id="IM342" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. When <inline-formula id="IE343"><mml:math id="IM343" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE344"><mml:math id="IM344" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> are big enough, we can get <inline-formula id="IE345"><mml:math id="IM345" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> by concentrating <inline-formula id="IE346"><mml:math id="IM346" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in an interval centered at the means, which is similar to what we did in Approximation A2, but simpler. However, when <inline-formula id="IE347"><mml:math id="IM347" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is not that big, for example, <inline-formula id="IE348"><mml:math id="IM348" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, then <inline-formula id="IE349"><mml:math id="IM349" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE350"><mml:math id="IM350" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will differ a lot for different value of <inline-formula id="IE351"><mml:math id="IM351" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE352"><mml:math id="IM352" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    <p>Now that it is clear that <italic toggle="yes">r</italic> is the value of primary importance, we see in the lower-right plot of <xref rid="btab292-F3" ref-type="fig">Figure 3</xref> that as prevalence rate (<italic toggle="yes">r</italic>) increases, more buckets are non-‘<italic toggle="yes">k</italic>-anonymized’. This is because bigger <italic toggle="yes">r</italic> means more overlap between sets <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> and also each pair of buckets <italic toggle="yes">A<sub>i</sub></italic> and <italic toggle="yes">B<sub>i</sub></italic>. Thus, the maximum number of zeros before the first one among all hash values in <italic toggle="yes">B<sub>i</sub></italic> is more likely equal to that in <italic toggle="yes">A<sub>i</sub></italic>. Thus, a hospital IRB or clinical query system seeking to understand the 10-anonymity of a particular query can use a first-order approximation based only on <italic toggle="yes">r</italic>, without even needing to run our code. Indeed, they need only consult our lower-right plot in <xref rid="btab292-F3" ref-type="fig">Figure 3</xref> and scale to the size of their background population to determine that first-order approximation. This can be done without any code. When a more precise result is needed, however, our two Approximations can provide that answer in only a few minutes. Of course, if even that is insufficient, the practitioner may choose to directly measure the <italic toggle="yes">k</italic>-anonymity of a particular HLL sketch; this is not in the scope of this article, but was empirically done in prior work (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>).</p>
  </sec>
  <sec>
    <title>6 Conclusion</title>
    <p>In this article, we have developed a method to quickly compute the expected number of non-‘<italic toggle="yes">k</italic>-anonymous’ buckets in the HLL sketch. Because of the number of patients (denoted as <inline-formula id="IE353"><mml:math id="IM353" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> in our model) is too big to compute the precise expected value, we introduced two approximations based on concentration inequalities. In general, Approximation A1 is suitable for the case when the expected value of single bucket size which is <inline-formula id="IE354"><mml:math id="IM354" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is ‘small’, for example, total number of patients (<inline-formula id="IE355"><mml:math id="IM355" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>) is 10<sup>5</sup> and number of buckets (<italic toggle="yes">m</italic>) is 100 or total number of patients (<inline-formula id="IE356"><mml:math id="IM356" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>) is 10<sup>7</sup> and number of buckets (<italic toggle="yes">m</italic>) is 10<sup>5</sup>. Approximation A2 is suitable for the case when <inline-formula id="IE357"><mml:math id="IM357" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is ‘big’, for example, total number of patients (<inline-formula id="IE358"><mml:math id="IM358" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>) is 10<sup>7</sup> and number of buckets (<italic toggle="yes">m</italic>) is 100 (see choice table in Section 4).</p>
    <p>By an appropriate choice of approximation method, we can control the computing time to under 300 s in almost all the cases. In other words, when an individual hospital is asked a query to return the aggregate counts based on sharing HLL sketches, we can compute the expected number of buckets which match fewer than 10 patients in the background population. If this number is too high, that is a signal to the clinical query system that the particular query is unsafe to release using HLL sketches. It is then up to the clinical query system to decide whether to fall back on another aggregation method, or if they should simply not respond to the query.</p>
    <p>Our results further give some guidance into the parameter ranges in which HLL sketches are likely to be safe to release. HLL sketches are especially useful for rare diseases, where the prevalence ratio in the population is low. Note that this is in marked contrast to sending raw counts, where rare diseases are precisely the least <italic toggle="yes">k</italic>-anonymous. Thus, HLL sketches fill a complementary role. Indeed, at the heart of the problem is the tradeoff between the utility/accuracy of HLL sketches and privacy, which increase or decrease, respectively, with the number of buckets. The average <italic toggle="yes">k</italic>-anonymity of a bucket is roughly inversely proportional to the square of the estimation error; our work computes instead the number of buckets that are not at least 10-anonymous. For more guidance on this tradeoff, we refer the reader to prior work, where we graphed this tradeoff empirically (<xref rid="btab292-B33" ref-type="bibr">Yu and Weber, 2020</xref>).</p>
    <p>Ultimately, our work is primarily useful in contexts where federated clinical query systems are used in biomedical research. The past year has seen increasing amounts of data centralization to combat the Covid-19 pandemic. The cost to privacy has been accepted because of the urgent clear and present need. However, in the future post-pandemic era as the pendulum swings the other direction, privacy may again take center stage. We hope that our work will be useful in analyzing the privacy consequences of distributed query systems and help inform policy-makers and institutional IRBs about the privacy-utility tradeoffs at hand.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>All of the data and code used to generate benchmarks is available on the Github: https://github.com/tzyRachel/K-anonymity-Expectation</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>We acknowledge startup funding from the University of Toronto Department of Computer and Mathematical Sciences for support.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab292-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baker</surname><given-names>D.N.</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Dashing: fast and accurate genomic distances with HyperLogLog</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>265</fpage>.<pub-id pub-id-type="pmid">31801633</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bengio</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>The need for privacy with public digital contact tracing during the COVID-19 pandemic</article-title>. <source>Lancet Digit. Health</source>, <volume>2</volume>, <fpage>e342</fpage>–<lpage>e344</lpage>.<pub-id pub-id-type="pmid">32835192</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bengio</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Inherent privacy limitations of decentralized contact tracing apps</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>28</volume>, <fpage>193</fpage>–<lpage>195</lpage>.<pub-id pub-id-type="pmid">32584990</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benitez</surname><given-names>K.</given-names></string-name>, <string-name><surname>Malin</surname><given-names>B.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Evaluating re-identification risks with respect to the HIPAA privacy rule</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>17</volume>, <fpage>169</fpage>–<lpage>177</lpage>.<pub-id pub-id-type="pmid">20190059</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Blum</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <source>Foundations of Data Science</source>. <publisher-name>Cambridge University Press, Cambridge</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btab292-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brat</surname><given-names>G.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>International electronic health record-derived COVID-19 clinical course profiles: the 4CE consortium</article-title>. <source>NPJ Digit. Med</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31934645</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Broder</surname><given-names>A.Z.</given-names></string-name></person-group> (<year>1997</year>) On the resemblance and containment of documents. In: <italic toggle="yes">Proceedings Compression and Complexity of SEQUENCES 1997 (Cat. No. 97TB100171)</italic>, IEEE, pp. <fpage>21</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cai</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) Fast and accurate traffic matrix measurement using adaptive cardinality counting. In: <italic toggle="yes">Proceeding of the 2005 ACM SIGCOMM Workshop on Mining Network Data - MineNet ’05</italic>, pp. <fpage>205</fpage>–<lpage>206</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Software-enabled distributed network governance: the PopMedNet experience</article-title>. <source>eGEMs</source>, <volume>4</volume>, <fpage>5</fpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Desfontaines</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Cardinality estimators do not preserve privacy</article-title>. <source>Proc. Priv. Enh. Technol</source>., <volume>2019</volume>, <fpage>26</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Durand</surname><given-names>M.</given-names></string-name>, <string-name><surname>Flajolet</surname><given-names>P.</given-names></string-name></person-group> (<year>2003</year>) Loglog counting of large cardinalities. In: <italic toggle="yes">Algorithms - ESA 2003 Lecture Notes in Computer Science</italic>, pp. <fpage>605</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durham</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Private medical record linkage with approximate matching</article-title>. <source>AMIA Annu. Symp. Proc</source>., <volume>2010</volume>, <fpage>182</fpage>–<lpage>186</lpage>.<pub-id pub-id-type="pmid">21346965</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Dwork</surname><given-names>C.</given-names></string-name></person-group> (<year>2008</year>) Differential privacy: a survey of results. In: International Conference on Theory and Applications of Models of Computation, Springer, pp. <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emam</surname><given-names>K.E.</given-names></string-name>, <string-name><surname>Dankar</surname><given-names>F.K.</given-names></string-name></person-group> (<year>2008</year>) <article-title>Protecting privacy using k-anonymity</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>15</volume>, <fpage>627</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">18579830</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emam</surname><given-names>K.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Evaluating the risk of re-identification of patients from hospital prescription records</article-title>. <source>Can. J. Hosp. Pharm</source>., <volume>62</volume>, <fpage>307</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">22478909</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Flajolet</surname><given-names>P.</given-names></string-name>, <string-name><surname>Martin</surname><given-names>G.N.</given-names></string-name></person-group> (<year>1985</year>) <article-title>Probabilistic counting algorithms for data base applications</article-title>. <source>J. Comput. Syst. Sci</source>., <volume>31</volume>, <fpage>182</fpage>–<lpage>209</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Flajolet</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) <part-title>HyperLogLog: the analysis of a near-optimal cardinality estimation algorithm</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Jacquet</surname><given-names>P.</given-names></string-name></person-group> (ed.) <source>Discrete Mathematics and Theoretical Computer Science 2007 Jun 17 (pp. 137-156). Discrete Mathematics and Theoretical Computer Science</source>, <publisher-loc>Juan les pins, France</publisher-loc>, pp. <fpage>127</fpage>–<lpage>146</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fleurence</surname><given-names>R.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Launching PCORnet, a national patient-centered clinical research network</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>21</volume>, <fpage>578</fpage>–<lpage>582</lpage>.<pub-id pub-id-type="pmid">24821743</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haendel</surname><given-names>M.A.</given-names></string-name></person-group>  <etal>et al</etal>; the N3C Consortium (<year>2021</year>) <article-title>The National COVID Cohort Collaborative (n3c): rationale, design, infrastructure, and deployment</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>28</volume>, <fpage>427</fpage>–<lpage>443</lpage>.<pub-id pub-id-type="pmid">32805036</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heatherly</surname><given-names>R.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Enabling genomic-phenomic association discovery without sacrificing anonymity</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e53875</fpage>.<pub-id pub-id-type="pmid">23405076</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B21">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>L.</given-names></string-name></person-group> (<year>2020</year>) <source>Security Controls Evaluation, Testing, and Assessment Handbook</source>. <publisher-name>Academic Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btab292-B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kalbfleisch</surname><given-names>J.G.</given-names></string-name></person-group> (<year>1985</year>) <source>Probability and Statistical Inference</source>. <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btab292-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kho</surname><given-names>A.N.</given-names></string-name>, <string-name><surname>Goel</surname><given-names>S.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Systems and methods for enabling data de-identification and anonymous data linkage</article-title>. <source>US Patent</source>, <volume>10</volume>, <fpage>454</fpage>–<lpage>901</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lindell</surname><given-names>Y.</given-names></string-name></person-group> (<year>2005</year>) Secure multiparty computation for privacy preserving data mining. In Encyclopedia of Data Warehousing and Mining, IGI global, pp. <fpage>1005</fpage>–<lpage>1009</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Oechslin</surname><given-names>P.</given-names></string-name></person-group> (<year>2003</year>) <part-title>Making a faster cryptanalytic time-memory trade-off</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Boneh</surname><given-names>D.</given-names></string-name></person-group> (ed.) <source>Advances in Cryptology - CRYPTO 2003</source>. <publisher-name>Springer Berlin Heidelberg</publisher-name>, <publisher-loc>Berlin, Heidelberg</publisher-loc>, pp. <fpage>617</fpage>–<lpage>630</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ondov</surname><given-names>B.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>132</fpage>.<pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Solomon</surname><given-names>B.</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Improved search of large transcriptomic sequencing databases using split sequence bloom trees</article-title>. <source>J. Comput. Biol</source>., <volume>25</volume>, <fpage>755</fpage>–<lpage>765</lpage>.<pub-id pub-id-type="pmid">29641248</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sweeney</surname><given-names>L.</given-names></string-name></person-group> (<year>2002</year>) <article-title>k-Anonymity: a model for protecting privacy</article-title>. <source>Int. J. Uncertain. Fuzziness Knowl. Based Syst</source>., <volume>10</volume>, <fpage>557</fpage>–<lpage>570</lpage>.</mixed-citation>
    </ref>
    <ref id="btab292-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weber</surname><given-names>G.M.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Federated queries of clinical data repositories: the sum of the parts does not equal the whole</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>20</volume>, <fpage>e155</fpage>–<lpage>e161</lpage>.<pub-id pub-id-type="pmid">23349080</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weber</surname><given-names>G.M.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Federated queries of clinical data repositories: scaling to a national network</article-title>. <source>J. Biomed. Inform</source>., <volume>55</volume>, <fpage>231</fpage>–<lpage>236</lpage>.<pub-id pub-id-type="pmid">25957825</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weber</surname><given-names>G.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>The Shared Health Research Information Network (SHRINE): a prototype federated query tool for clinical data repositories</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>16</volume>, <fpage>624</fpage>–<lpage>630</lpage>.<pub-id pub-id-type="pmid">19567788</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wyatt</surname><given-names>M.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Federated Aggregate Cohort Estimator (FACE): an easy to deploy, vendor neutral, multi-institutional cohort query architecture</article-title>. <source>J. Biomed. Inform</source>., <volume>52</volume>, <fpage>65</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">24316052</pub-id></mixed-citation>
    </ref>
    <ref id="btab292-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>Y.W.</given-names></string-name>, <string-name><surname>Weber</surname><given-names>G.M.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Balancing accuracy and privacy in federated queries of clinical data repositories: algorithm development and validation</article-title>. <source>J. Med. Int. Res</source>., <volume>22</volume>, <fpage>e18735</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
