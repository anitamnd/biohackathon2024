<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName nihms2pmcx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin ukpmcpa?>
<?ManuscriptPrefix new?>
<?iso-abbr Nat Methods?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 0?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?domain wtpa?>
<?pmc-id-preallocated 7610627?>
<?properties manuscript?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7610627</article-id>
    <article-id pub-id-type="manuscript">ems118366</article-id>
    <article-id pub-id-type="pmid">33046896</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-020-0960-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepC: predicting 3D genome folding using megabase-scale transfer learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schwessinger</surname>
          <given-names>Ron</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gosden</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Downes</surname>
          <given-names>Damien</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Richard C</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oudelaar</surname>
          <given-names>A. Marieke</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Telenius</surname>
          <given-names>Jelena</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teh</surname>
          <given-names>Yee Whye</given-names>
        </name>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lunter</surname>
          <given-names>Gerton</given-names>
        </name>
        <xref ref-type="corresp" rid="CR1">*</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hughes</surname>
          <given-names>Jim R.</given-names>
        </name>
        <xref ref-type="corresp" rid="CR1">*</xref>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>MRC Molecular Haematology Unit &amp; MRC WIMM Centre for Computational Biology</aff>
    <aff id="A2"><label>2</label>MRC Weatherall Institute of Molecular Medicine, University of Oxford, Oxford, UK</aff>
    <aff id="A3"><label>3</label>Wellcome Centre for Human Genetics, University of Oxford, Oxford, UK</aff>
    <aff id="A4"><label>4</label>Department of Statistics, University of Oxford, Oxford, UK</aff>
    <author-notes>
      <corresp id="CR1"><label>*</label>Corresponding Authors are Gerton Lunter <email>gerton.lunter@well.ox.ac.uk</email> and Jim R. Hughes <email>jim.hughes@imm.ox.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>04</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>11</issue>
    <fpage>1118</fpage>
    <lpage>1124</lpage>
    <permissions>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://www.nature.com/authors/editorial_policies/license.html#terms</ali:license_ref>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Predicting the impact of non-coding genetic variation requires interpreting it in the context of 3D genome architecture. We have developed deepC, a transfer learning based deep neural network that accurately predicts genome folding from megabase-scale DNA sequence. DeepC predicts domain boundaries at high-resolution, learns the sequence determinants of genome folding and predicts the impact of both large-scale structural and single base pair variations.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Most genetic variants associated with common diseases affect gene regulatory regions distal to target genes<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref></sup>. Genome 3D structure is central to mediating these functional interactions, but its intricately convoluted and large-scale nature renders it challenging to understand and predict. Proposed machine learning and polymer modelling approaches to predict 3D genome structure have produced promising results, but none effectively integrates across resolutions. Methods that use information at the base pair level focus on window-to-window-based predictions<sup><xref rid="R3" ref-type="bibr">3</xref>–<xref rid="R5" ref-type="bibr">5</xref></sup>, while methods that incorporate a large genomic context do so by coarse segregation into genomic features<sup><xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R8" ref-type="bibr">8</xref></sup> or polymer beads<sup><xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R10" ref-type="bibr">10</xref></sup>, thus compromising their ability to predict the impact of variation at base pair resolution.</p>
    <p id="P3">We propose that to accurately predict topologically associated domains (TADs) a model needs to capture sequence patterns across large genomic distances. Regulatory elements can interact over megabase distances and boundary elements lying in between may alter chromatin contacts significantly. A chromatin interaction model should thus integrate information at the megabase-scale. However, to predict the impact of genetic variation the model must also learn to interpret DNA sequence at base pair resolution. Since 3D genome interactions are determined by genomic regulatory elements such as CTCF bound domain boundaries<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, a model that has learned the grammar of regulatory elements could help guide the prediction of 3D genome structure.</p>
    <p id="P4">Based on these ideas, we developed deepC, a deep neural network that bridges the gap from base pairs to TADs. DeepC uses a transfer learning approach and tissue-specific Hi-C data to train models that predict genome folding from megabase (Mb) windows of DNA sequence (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). The trained models can then be used to predict chromatin domain boundaries at high resolution and to identify the sequence determinants of genome folding. Importantly, they allow us to predict the impact of genetic variants from large structural variations down to single-nucleotide polymorphisms.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>A deep learning model for predicting chromatin interactions from megabase-scale DNA</title>
      <p id="P5">We encode Hi-C data as a vector of pairwise interaction values between 5 kilobase (kb) genomic bins at distances of up to ~1 Mb (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). DeepC learns to predict these contact frequencies taking as input the underlying ~1 Mb window of DNA sequence. The deepC network architecture is constructed from a convolutional module with max-pooling that has proven powerful for predicting chromatin features from DNA sequence<sup><xref rid="R12" ref-type="bibr">12</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup>. This is followed by a dilated convolutional module that excels at incorporating large-scale context while maintaining resolution<sup><xref rid="R14" ref-type="bibr">14</xref>–<xref rid="R16" ref-type="bibr">16</xref></sup>. Finally, a fully connected layer integrates the detected patterns over a megabase of DNA sequence to predict chromatin folding.</p>
      <p id="P6">We found two factors to be crucial for deepC’s effective learning and generalization. First, we percentile-normalize the raw contact frequency signal in Hi-C data by genomic distance (<xref ref-type="fig" rid="F4">Extended Data Figure 1</xref>, <xref ref-type="sec" rid="S8">Methods</xref>), termed the “skeleton”. This normalization reveals informative longer-range interactions and enhances the contrast at domain boundaries. Second, we employ transfer learning<sup><xref rid="R17" ref-type="bibr">17</xref></sup> (<xref ref-type="fig" rid="F1">Fig. 1a</xref>, <xref ref-type="fig" rid="F5">Extended Data Figure 2</xref>), a concept that has proven powerful in deep learning applications for image analysis and natural language processing. In a first phase of training the initial convolutional module learns to predict a compendium of chromatin features such as open chromatin regions and CTCF binding sites across cell types<sup><xref rid="R12" ref-type="bibr">12</xref>,<xref rid="R18" ref-type="bibr">18</xref>,<xref rid="R19" ref-type="bibr">19</xref></sup>. Next, the convolutional module is stripped of the fully connected layer responsible for interpretation. Only the learned sequence patterns are transferred to the second training phase where they are refined, and the dilated module and fully connected layer are trained <italic>ab initio</italic> to predict chromatin interactions. The same weights pre-trained on a chromatin feature compendium across cell types are used for transfer learning irrespective of the cell type of the Hi-C data source.</p>
      <p id="P7">We trained deepC models on seven <underline>human<sup><xref ref-type="bibr" rid="R20">20</xref></sup> and one mouse<sup><xref ref-type="bibr" rid="R21">21</xref></sup> Hi-C data</underline> sets with different sequencing depths and at different resolutions (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 1</xref> – <xref ref-type="supplementary-material" rid="SD4">4</xref>). We focused our analysis on the primary GM12878 (~3.6 B reads) and K562 (~1.3 B reads) data, training models at 5 kb resolution. DeepC yields smooth but detailed predictions that resolve the hierarchical nature of TADs and insulated domains (<xref ref-type="fig" rid="F1">Fig. 1c</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 1</xref>). In a cross-validation scheme across all chromosomes in GM12878 (<xref ref-type="fig" rid="F1">Fig. 1d</xref>), deepC achieves an average, distance-stratified Pearson correlation between predictions and Hi-C skeleton of ~0.36 on raw skeleton data and ~0.57 when applying a small smoothing filter to the discrete and noisy skeleton (~0.28 and ~0.51 in K562, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 5</xref>). We compared deepC to a recently proposed random-forest-based method HiC-Reg<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, that predicts chromatin interactions up to 1 Mb distance using chromatin features of the interacting windows and the window in between rather than using DNA sequence as input. We observed that deepC generalizes better in predicting the domain structure of unseen chromosomes (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 6</xref> and <xref ref-type="supplementary-material" rid="SD4">7</xref>).</p>
      <p id="P8">Although we focused our main analysis on the deeply sequenced Hi-C data from Rao et al.<sup><xref rid="R20" ref-type="bibr">20</xref></sup> we hypothesized that deepC is able to predict chromatin interactions after training on data with significantly lower sequencing depth. To this end we trained GM12878 models with Hi-C data downsampled from originally ~26 B to 1 B, 100 M and 10 M valid Hi-C contacts respectively (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 8</xref>). The 1 B and 100 M contact models still learned to predict chromatin structure, with a mean Pearson correlation of 0.46 and 0.4 between the 1 B and 100 M model on hold out chromosomes 16 and 17 respectively. In contrast the 10 M model failed to learn chromatin structure. While deepC can predict chromatin interactions from less deeply sequenced samples, we do note that dedicated methods have been proposed for increasing the resolution of Hi-C maps that take as input low resolution maps directly<sup><xref rid="R22" ref-type="bibr">22</xref>,<xref rid="R23" ref-type="bibr">23</xref></sup> rather than predicting from DNA sequence.</p>
      <p id="P9">We train separate models for each Hi-C data set derived from a different cell type. These distinct models learn tissue-specific chromatin interactions (<xref ref-type="fig" rid="F6">Extended Data Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 9</xref>). We also trained a deepC model to predict chromatin interactions in multiple cell types jointly, but we found that the jointly trained network captured the tissue-specific Hi-C patterns less well compared to the individually trained models (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 10</xref>).</p>
    </sec>
    <sec id="S4">
      <title>Validating deepC with high sensitivity chromosome confirmation capture</title>
      <p id="P10">We next sought to validate deepC predictions with an independent set of chromatin interactions. To this end, we utilized NG Capture-C<sup><xref rid="R24" ref-type="bibr">24</xref></sup> (<xref ref-type="sec" rid="S8">Methods</xref>), which generates high-resolution interaction data from targeted viewpoints and identifies chromatin interactions at higher sensitivity than Hi-C. We captured the interactions of 220 viewpoints in two cell types (GM12878 and K562) covering 81 CTCF sites and 139 sites lying within insulated domains, not overlapping with regulatory elements to capture the domain structure. We observed good agreement between the predicted domain structure and interaction peaks in the NG Capture-C tracks (<xref ref-type="fig" rid="F7">Extended Data Figure 4</xref>), showing deepC is capable of predicting true biophysical boundaries that are evident in these sensitive 3C assays but poorly captured by the original Hi-C, especially at lower sequencing depth.</p>
      <p id="P11">Although deepC effectively captures the positions of boundary elements some aspects of interactions are not captured fully by the model. When comparing the virtual 4C track from the Hi-C skeleton, the predictions and distance-normalized NG Capture-C tracks from CTCF viewpoints (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 11</xref>) we saw that the NG Capture-C correlated better with the Hi-C skeleton than with the predictions (<xref ref-type="fig" rid="F2">Fig. 2a</xref>, Pearson correlation in GM12878: 0.59 vs 0.30; K562: 0.55 vs 0.37). This was due to the tendency of deepC predictions to de-emphasize the characteristic punctate nature of signal at the apex of interacting CTCF elements. This may be explained by an inability of deepC to model detailed characteristics of the loop extrusion mechanism such as cohesin processivity, which may not be encoded in the local DNA sequence and more dependent on factors such as nuclear concentration of extruding factors<sup><xref rid="R25" ref-type="bibr">25</xref></sup>. In contrast, for intra domain viewpoints deepC correlates equally well with NG Capture-C data as NG Capture-C correlates with the Hi-C skeleton (<xref ref-type="fig" rid="F2">Fig. 2a</xref>, GM12878: 0.30 vs 0.36; K562: 0.46 vs 0.42). Therefore, even though deepC is predicting interactions from sequence in these instances it performs as well as comparing two different experimental sources of 3C data.</p>
      <p id="P12">Taken together, these analyses suggested that deepC is capable of modelling the DNA encoded signals that determine the activity and position of boundary elements. To test this, we called boundaries within 1 Mb from the NG Capture-C viewpoints using the Hi-C data, the skeleton and the deepC predictions respectively (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 12</xref> and <xref ref-type="supplementary-material" rid="SD4">13</xref>) using the established insulation-score-based approach<sup><xref rid="R26" ref-type="bibr">26</xref></sup> with parameters for high-resolution calling (<xref ref-type="sec" rid="S8">Methods</xref>). We then compared the called boundaries from these three sources with the high-sensitivity NG Capture-C 3C data to quantify the enrichment of chromatin interactions (<xref ref-type="fig" rid="F2">Fig. 2b</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 14</xref>). <underline>We observed clear enrichment over the deepC predicted boundaries indicating that they on average represent biophysical barriers to genome interactions. In contrast, the boundaries called directly from the Hi-C data and from the Hi-C skeleton showed less pronounced enrichment suggesting that calling directly from the data, on average, captures boundaries less effectively at the available sequencing depths</underline>. We confirmed these results with boundaries called using TopDom<sup><xref rid="R27" ref-type="bibr">27</xref></sup> (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 15</xref>), a TAD caller that showed best overall robustness in a recent bench marking study<sup><xref rid="R28" ref-type="bibr">28</xref></sup>.</p>
      <p id="P13">To visualize the coherence of the deepC predictions and called boundaries across specific loci at a sensitivity higher than the available Hi-C data, we utilized Tiled-C<sup><xref rid="R29" ref-type="bibr">29</xref></sup> (<xref ref-type="sec" rid="S8">Methods</xref>), which generates Hi-C like data for specific loci at high sensitivity and resolution. We performed Tiled-C for a selection of loci where deepC predicted fine-grained boundaries (<xref ref-type="fig" rid="F2">Fig. 2c</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 16</xref>) or cell-type-specific patterns (<xref ref-type="fig" rid="F6">Extended Data Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 9</xref>). In line with the enrichment analysis, we confirmed that when called at high resolution, deepC boundaries are evident and align well with the boundaries in this highly sensitive 3C data. The added benefit for boundary calling is particularly striking in the comparatively lower-coverage K562 Hi-C data (~1.3 B reads) (<xref ref-type="fig" rid="F2">Fig, 2c</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 16</xref>).</p>
      <p id="P14">When comparing the overall structure of deepC predictions to the Hi-C and Tiled-C data we observed that deepC tends to predict inter domain interactions in the form of stripes and dots more pronounced, some of which are only faintly detectable in Hi-C and Tiled-C data and some appear novel (<xref ref-type="fig" rid="F1">Fig. 1c</xref>, <xref ref-type="fig" rid="F2">2c</xref>, <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 9</xref>). This suggests that deepC tends to underestimate the insulation between domains. Future refinements to the model architecture might be able to better capture the inter domain insulation. The effect appears amplified when comparing skeleton transformed to raw data as necessary for Tiled-C.</p>
    </sec>
    <sec id="S5">
      <title>Dissecting the sequence determinants of genome folding</title>
      <p id="P15">DeepC allows us to dissect the sequence determinants of genome folding at base pair resolution. To estimate the relative importance of every base pair for predicting chromatin interactions we employed the saliency score as a computationally efficient method adapted from image analysis<sup><xref rid="R30" ref-type="bibr">30</xref></sup>. The saliency score estimates how much the interaction prediction depends on each single base pair by calculating the gradient of the model output with respect to the sequence input (<xref ref-type="sec" rid="S8">Methods</xref>). The saliency score predicts important regions and highlights transcription factor motifs within them (<xref ref-type="fig" rid="F8">Extended Data Figure 5</xref>).</p>
      <p id="P16">Genome-wide we identify sharp saliency peaks at CTCF sites and broader saliency peaks at active promoters (<xref ref-type="fig" rid="F3">Fig. 3a</xref>). As bases with high saliency scores mark positions predicted to be important for chromatin architecture, we hypothesized that mutations within these regions would be enriched for those affecting gene expression. To test this, we retrieved 6607 GM12878 cell-type-specific eQTLs (GTEx v7) that are located in open chromatin (DNase-seq) or CTCF sites (CTCF ChIP-seq, ENCODE) and are thus likely to lie in regulatory elements. We found that these eQTLs have significantly higher saliency scores than SNPs randomly re-sampled from the same regions (p-value &lt; 1e-85 using a two-sample Kolmogorov-Smirnow test) (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 17</xref>). This suggests that the deepC saliency score can be used to fine map eQTLs when expression changes are mediated through an impact on chromatin architecture.</p>
      <p id="P17">A long-standing question has been which functional elements within the genome underlie the patterns of genome folding. To investigate this, we performed an <italic>in silico</italic> deletion screen of all active elements genome-wide and used deepC to assess their importance for chromatin interactions (<xref ref-type="fig" rid="F3">Fig. 3b</xref>). As expected, we find that deleting CTCF sites as well as enhancers and promoters with proximal CTCF binding has the strongest average predicted impact. We also find promoter and enhancers without proximal CTCF binding sites to be important, with deletions of promoters on average having a stronger effect. In addition, deletions of promoters and enhancers with strong activity-associated histone marks have a higher predicted impact than those without such marks.</p>
      <p id="P18">Our analysis suggests that in addition to known factors such as CTCF binding and orientation, active regulatory elements, in particular promoters, are critical elements for effectively predicting genome interactions. Furthermore, deepC predicts boundaries not associated with CTCF sites. Taken together this indicates that deepC has learned aspects of a complex grammar of genome folding beyond CTCF motifs and their relative orientation and suggests a causal role for regulatory elements in defining and stabilizing 3D genome structure.</p>
    </sec>
    <sec id="S6">
      <title>Predicting the impact of sequence variation on genome folding</title>
      <p id="P19">To test deepC’s ability to predict the impact of sequence variation on genome folding we utilized two well-characterized examples from the literature. Hnisz et al. showed that a ~30 kb CRISPR-mediated deletion in HEK293T cells, encompassing four CTCF sites at the <italic>LMO2</italic> locus, leads to a local rearrangement of the chromatin structure as confirmed by 5C<sup><xref rid="R31" ref-type="bibr">31</xref></sup>. Computationally reproducing this deletion in GM12878 (<xref ref-type="fig" rid="F3">Fig. 3c</xref>) and K562 cells (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 18</xref>) recapitulates the domain fusion observed by Hnisz and colleagues. Furthermore, using deepC we computationally deleted the CTCF sites individually, predicting that no single deletion alone is sufficient for causing the rearrangement (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 19</xref>), suggesting multiple redundant boundaries at this region.</p>
      <p id="P20">Crucially, our sequence-based model can predict the impact of single base pair variants. To demonstrate this, we tested two asthma-risk associated SNPs<sup><xref rid="R32" ref-type="bibr">32</xref></sup> shown to impact <italic>ORMDL3</italic> expression in immune cells. Schmiedel et al. demonstrated that the SNPs impact CTCF binding sites, disrupting enhancer-promoter interactions of <italic>ORMDL3</italic> in CD4-positive T-cells. DeepC predictions recapitulate the loss of a boundary element, insulating <italic>ORMDL3</italic> from downstream interactions (<xref ref-type="fig" rid="F3">Fig. 3d</xref>). When testing the individual SNPs <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 20 a</xref> and <xref ref-type="supplementary-material" rid="SD4">b</xref>), deepC predicts the rs12936231 risk allele to have a strong effect on genome folding (mean absolute interaction difference 0.176). In contrast, although the rs4065275 risk-allele suggests a boundary creating effect, the predicted strength is weak (0.006). To put these predicted SNP effects into context, we compared them to the <italic>in silico</italic> deletion screen effects (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 20c</xref>). The effect of rs12936231 lies above the 25<sup>th</sup> percentile of the 500 bp, weak CTCF site deletions. In addition, we sampled 1000 SNPs from CTCF sites (<xref ref-type="fig" rid="F3">Fig. 3d</xref>) as well as from promoters, enhancers and background sequences (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 20d</xref>). In comparison to sampled 1000 CTCF SNPs, rs4065275 lies within the top 11 % and rs12936231 within the top 1 %. Taken together, deepC prioritizes rs12936231 as the likely causal variant. Interestingly, deepC predicts this effect in GM12878 (immortalized B-cells) but not in K562 (myeloid leukemia cell line with erythroid characteristics) or IMR90 (human embryonic lung fibroblasts), pointing to a potential lymphoid specific effect (<xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 21</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S7">
    <title>Discussion</title>
    <p id="P21">Mammalian chromatin architecture folds at the megabase and sub-megabase scale constraining distal regulatory interactions within TADs and smaller insulated domains<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R33" ref-type="bibr">33</xref>,<xref rid="R34" ref-type="bibr">34</xref></sup>. Ultimately, chromatin interactions are encoded in the DNA sequence through an intricate interplay of protein binding sites and other sequence determinants. Understanding the link between individual sequences and large-scale chromatin interactions at base pair resolution is a key challenge for understanding chromatin architecture and its role in gene regulation<sup><xref rid="R35" ref-type="bibr">35</xref>,<xref rid="R36" ref-type="bibr">36</xref></sup>. We developed deepC to traverse the gap between base pair sequences and megabase structures. DeepC is the first sequence-based deep learning model that predicts chromatin interactions from DNA sequence while integrating a context of megabase scale. This scale of analysis is necessary for accurate prediction of chromatin interactions, which in turn allowed for the determination of the elements driving these interactions and assessment of mutations disrupting them.</p>
    <p id="P22">We found deepC models to yield substantially better predictions when we pre-seeded the model with hidden layers optimized to predict a compendium of chromatin features. This allows deepC to predict intricate chromatin interactions even when trained on low depth, low resolution Hi-C data. By validating the results with NG Capture-C and Tiled-C, each 3C methods capable of extreme depth and sensitivity, we showed that the deepC approach effectively increases the resolution of Hi-C data. We demonstrated that deepC can be used to fine-map the sequence determinants of chromatin architecture at base pair resolution and link these with effects on gene expression. Additionally, our genome wide deletion screen of potential regulatory elements shed light on the mechanics of chromatin interactions. It confirmed that CTCF binding site deletions are most likely to cause strong chromatin interaction changes. Importantly, deepC also indicates that both promoters and enhancers contribute to genome folding, in addition to CTCF. Generally, promoter deletions have a higher predicted effect on genome organization than enhancer deletions, and we find that deletions of enhancer and promoters associated with active chromatin marks have a higher predicted impact than those without such marks. Our observations are in line with findings from orthologous methods, that find CTCF binding, open chromatin, active histone marks and RNA-seq to be most predictive<sup><xref rid="R4" ref-type="bibr">4</xref>–<xref rid="R8" ref-type="bibr">8</xref>,<xref rid="R10" ref-type="bibr">10</xref></sup>. The finding that identifying active promoters and enhancers, in addition to CTCF binding sites, is required to accurately predict 3D genome structures suggests that these elements play an important role in establishing these structures, possibly via recruitment of its components and by actively stabilizing certain loops.</p>
    <p id="P23">We believe deep learning-based genome folding predictions will facilitate chromatin architecture research. In a parallel study, Fudenberg et al.<sup><xref rid="R37" ref-type="bibr">37</xref></sup> have developed an alternative model (Akita) to accurately predict interaction in megabase scale loci. DeepC and Akita have a similar convolutional module as network base but vary significantly in the remaining network structure as well as the data encoding and training scheme. We believe that future comparative study and consolidation between these advances will bring further insights into genome function.</p>
    <p id="P24">Here we present deepC as a valuable tool for dissecting the functional elements that shape chromatin architecture and for predicting the impact of sequence changes from single base pair to structural variants. Furthermore, deepC represents a step towards predictive models of gene regulation that integrate the intricate and long-ranged chromatin landscape of mammalian genomes.</p>
  </sec>
  <sec sec-type="methods" id="S8" specific-use="web-only">
    <title>Online Methods</title>
    <sec id="S9">
      <title>Chromatin feature data</title>
      <p id="P25">As human chromatin feature compendium the ENCODE<sup><xref rid="R18" ref-type="bibr">18</xref></sup> and Roadmap<sup><xref rid="R19" ref-type="bibr">19</xref></sup> chromatin data utilized in DeepSEA<sup><xref rid="R12" ref-type="bibr">12</xref></sup> were used. Narrow peak calls (hg19) for 918 experiments were downloaded. The data was supplemented with additional erythroid linage data. Five sets of ATAC-seq data from Corces et al.<sup><xref rid="R38" ref-type="bibr">38</xref></sup>, two DNase-seq experiments<sup><xref rid="R39" ref-type="bibr">39</xref></sup> and ten ATAC-seq and one CTCF ChIP-seq experiment from Downes et al. and in house erythroid differentiation<sup><xref rid="R40" ref-type="bibr">40</xref></sup> were used. All data used are listed in <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 1</xref>. All additional data was aligned to hg19 using the NGseqBasic pipeline<sup><xref rid="R41" ref-type="bibr">41</xref></sup>. Peaks were called with macs2<sup><xref rid="R42" ref-type="bibr">42</xref></sup> (default parameters, -q 0.01). The peak signals were aggregated following the procedure described in Zhou et al.<sup><xref rid="R12" ref-type="bibr">12</xref></sup>. In brief, the genome was split into 200 bp bins. All peak calls were intersected with these bins. If a bin overlaps a peak call to at least 50 % (100 bp), the bin was labelled as belonging to that dataset class. All genomic bins that do not intersect with at least one peak call were discarded. Only autosomes were used for all analysis.</p>
      <p id="P26">
        <underline>Mouse chromatin data were retrieved from ENCODE<sup><xref ref-type="bibr" rid="R18">18</xref></sup>. Histone modification peak calls were downloaded from the ENCODE data portal. For DNase-seq, ATAC-seq and transcription factor ChIP-seq data the aligned bam files were downloaded and peak called with macs2<sup><xref ref-type="bibr" rid="R42">42</xref></sup> as described above. Replicates were collapsed into unions. All mouse data used are listed in <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 1</xref>.</underline>
      </p>
    </sec>
    <sec id="S10">
      <title>Hi-C data</title>
      <p id="P27">Publicly available, deeply sequenced Hi-C data from Rao et al.<sup><xref rid="R20" ref-type="bibr">20</xref></sup> was used. The available 5 and 10 kb resolution intra chromosomal contacts maps of 7 cell lines (and 1kb data from GM12878) were downloaded and normalized using the provided KRnorm factors. <underline>Four replicates of mouse ES cell data<sup><xref ref-type="bibr" rid="R21">21</xref></sup> were retrieved as raw fastqs from (GSE96107)</underline>.</p>
    </sec>
    <sec id="S11">
      <title>Hi-C encoding for deep learning</title>
      <p id="P28">The genome was divided into bins matching the bin size of the respective Hi-C data resolution used for training (1 kb, 5 kb, 10kb). For every stretch of DNA of size 1 Mb + bin size bps (e.g. 1005000 for 5kb bins), the chromatin interactions associated with the window were assigned as squares in a vertical, zig-zag pole over the centre of the sequence window (see <xref ref-type="fig" rid="F1">Fig. 1b</xref>). Every square encodes the Hi-C interactions observed between two bin sized windows of increasing distance (up to 1 Mb away). By sliding the large DNA stretch over a chromosome with a bin sized increment, this encoding recovers the chromosome wide Hi-C map up to an interaction distance of 1 Mb. Regions with a median interaction count along this pole of 0 where excluded from training. The Hi-C data was percentile normalized across individual chromosomes for every interaction distance in bin sizes. It is of particular interest to resolve high levels of Hi-C interactions at high resolution and only a low percentage of chromatin interactions is expected to yield strong interactions at larger distances for example the corners of TAD triangular structures. Thus, the percentile normalization was designed to better resolve these high interaction levels at larger distances by using uneven percentiles in a pyramid like scheme (from low to high: 2 x 20 %, 4 x 10 %, 4 x 5 %, see <xref ref-type="fig" rid="F4">Extended Data Figure 1</xref>). The identifier of the respective pyramid percentile (1 – 10) was stored. The chromatin interaction network was then trained to predict the percentile identifier as a regression problem (see below).</p>
    </sec>
    <sec id="S12">
      <title>Deep neural network architectures and training</title>
      <p id="P29">A two-step training process with transfer learning (<xref ref-type="fig" rid="F5">Extended Data Figure 2</xref>) was used. First a convolutional neural network was trained to predict chromatin features from 1 kb of DNA sequence, using the compendium of 936 datasets described above. The principle network architecture was adapted from DeepSEA<sup><xref rid="R12" ref-type="bibr">12</xref></sup>. Five convolutional layers (hidden units: 300, 600, 600, 900, 900; filter widths: 8, 8, 8, 4, 4, 4) with ReLU activation, max pooling (widths: 4, 5, 5, 5, 2) and dropout (rate: 0.2) were used followed by a fully connected layer with sigmoid activation to output individual probabilities for each chromatin feature class (multi-label classification). The network parameters were trained by minimizing the sum of the binary cross entropies using the ADAM optimizer (epsilon 0.1) in batches of 100. Batch size, dropout rate, learning rate and filter size were optimized by grid search.</p>
      <p id="P30">Second, a chromatin interaction network was trained to predict Hi-C interaction from DNA sequence. The chromatin interaction network takes as input 1 Mb + 1x Hi-C bin size [bp], (e.g. 1005000 for a 5 kb bin network). The first module consists of five convolutional layers, with ReLU, max pooling and dropout with the dimensions and hyperparameters matching the chromatin feature network. The hidden weights were initialized by seeding with the weights of the trained chromatin feature network from step one. All chromatin features were used for pre-training and the same weights were used for seeding the chromatin interaction network training independent of the Hi-C data cell type.</p>
      <p id="P31">The second module is a series of ten dilated, gated 1D convolutional layers with residuals<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. Gated convolutional layers require training double the amount of filter parameters but have the potential of modelling more complex functions through their multiplicative units. The residual units allow information to propagate more easily through the network without having to necessarily pass through convolutions<sup><xref rid="R43" ref-type="bibr">43</xref></sup>. 100 hidden units were used, and dilation rates were increased exponentially to reach the full sequence context in the last layer (1, 2, 4, 8, 16, 32, 64, 128, 256, 1). The dilated layers were followed by a fully connected layer. Output are the predicted interaction strengths (in units matching the percentile normalization). The model was trained with ADAM (epsilon 0.1) to minimize the mean square error between the outputs and the true percentiles. GPU memory limited us to using a batch size of 1. Hidden units (for dilated layers), dropout rate, learning and ADAM epsilon were optimized using grid search.</p>
    </sec>
    <sec id="S13">
      <title>Network training, computational resources and limitations</title>
      <p id="P32">For both training procedures the data were split into training, validation and test set based on chromosomes. For the chromatin feature network chr11 and 12 were used for validation and chr15, 16 and 17 for testing. For the chromatin interaction network, to increase the number of training examples the same validation chromosomes were used but only chr16 and 17 were used as test chromosomes.</p>
      <p id="P33">All models were trained on NVIDIA Titan V cards with 12 GB of video memory. Training on smaller cards is possible but slower. The final models have ~ 60 M parameters. Scaling the models to larger DNA inputs will likely benefit from network pruning or a refined architecture.</p>
      <p id="P34">Fully training the chromatin feature network required 14 epochs with about 8 hours per epoch. The training set order was reshuffled after every epoch. To minimize the amount of times large chunks of DNA sequence had to be loaded into memory the network was trained on one chromosome at a time. Within a chromosome, the order in which training batches were drawn was random. Interestingly, we observed that the chromatin interaction network, when seeded with the pre-trained weights in the first convolutional filters, converged quickly, after training on ~ 3 - 6 chromosomes and only marginally improved after training for an entire epoch or longer. Models were trained for one full epoch as we have not observed significant improvement after training for longer and the limited batch size as well as the network complexity make training slow. For cross-validation, we trained multiple iterations holding out different chromosomes from training.</p>
      <p id="P35">While training networks is only feasible with GPU support, predictions with trained models can be run on CPU only. For example, predicting the impact of a variant requires ~ 5 min with GPU and ~ 2h with only CPU support.</p>
    </sec>
    <sec id="S14">
      <title>Predicting changes in chromatin interactions</title>
      <p id="P36">For calculating differences in chromatin interactions, the interactions over the reference sequence were predicted for every position that is within 1 Mb (plus 1x Hi-C bin size) of the sequence variant. This matches the respective models spatial reach. The reference sequence was then modified to match the sequence variant of interest. After predicting the chromatin interactions over the variant sequence, the difference was quantified by calculating the absolute difference between reference and variant prediction at each interaction bin and summarized as the mean absolute difference over all covered interactions.</p>
    </sec>
    <sec id="S15">
      <title>Distance-stratified correlation</title>
      <p id="P37">The Pearson correlation coefficient was calculated between the Hi-C skeleton and the deepC predicted regression score. Note that the skeleton percentiles are discrete (percentile tag 1 – 10), while the regression score is continuous. The Hi-C skeleton is noisy even at very deep sequencing depths (e.g. GM12878). Therefore, a small mean filter was employed using a 5x5 window to smooth the skeleton and the distance-stratified correlation was calculated between the prediction and the raw or the smoothed skeleton respectively.</p>
    </sec>
    <sec id="S16">
      <title>Comparison against HiC-Reg<sup><xref rid="R8" ref-type="bibr">8</xref></sup>
</title>
      <p id="P38">The available CrossChrom predictions, trained on chr14 and predicted on chr17, were downloaded from the supplementary material. HiC-Reg predictions were distance-normalized as described above.</p>
    </sec>
    <sec id="S17">
      <title>Re-aligning and downsampling Hi-C data</title>
      <p id="P39">The primary GM12878 replicate was realigned from raw fastqs using HiCPro<sup><xref rid="R44" ref-type="bibr">44</xref></sup>. The valid Hi-C interactions were downsampled to achieve 1 billion, 100 million and 10 million valid interactions, respectively. Mouse ES cell Hi-C data were aligned and processed from raw fastq data using HiCPro<sup><xref rid="R44" ref-type="bibr">44</xref></sup>.</p>
    </sec>
    <sec id="S18">
      <title>Selection of validation capture probes</title>
      <p id="P40">A total of 220 viewpoints were selected for validating the deepC predictions, specifically selecting genomic locations where the Hi-C data and deepC predictions differed in detail or where the deepC predicted structures were only very faintly noticeable in the Hi-C data. Two sets were designed, one targeting 81 CTCF sites and one targeting 139 intra domain viewpoints that lie within a distinct Hi-C/deepC domain but are not intersecting with any potential functional elements. Capture probes were designed using CapSequm (<ext-link ext-link-type="uri" xlink:href="http://apps.molbiol.ox.ac.uk/CaptureC/cgi-bin/CapSequm.cgi">http://apps.molbiol.ox.ac.uk/CaptureC/cgi-bin/CapSequm.cgi</ext-link>), filtering out repetitive probe regions as described in the online documentation. For the final probe design see <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 2</xref>.</p>
    </sec>
    <sec id="S19">
      <title>Cell culture and fixation</title>
      <p id="P41">Human GM12878 lymphocyte cell line, were obtained from the NIGMS Human Genetic Cell Repository at the Coriell Institute for Medical Research and cultured in RPMI 1640 supplemented with 15% FBS, 2mM L-Glutamine and 100U/ml Pen-Strep at 37 °C in a 5% CO2 incubator. K562 cells were supplied by the WIMM transgenics facility. Cells were maintained in RPMI 1640 media supplemented with 10 % FCS at 37 °C in a 5% CO2 incubator. Both cell types were fixed and processed using the same protocol. Cells were resuspended at 1x10<sup><xref rid="R6" ref-type="bibr">6</xref></sup> cells per ml and fixed at room temperature with 2% v/v formaldehyde for 10 minutes. Fixation was quenched with 120 mM glycine. Cells were washed with ice cold PBS. Cells resuspended in cold lysis buffer (10 mM Tris, 10 mM NaCl, 0.2% Igepal CA-630 and complete proteinase inhibitor (Roche)) and snap frozen to −80 °C. See Life Science Reporting Summary for additional details.</p>
    </sec>
    <sec id="S20">
      <title>3C library preparation</title>
      <p id="P42">3C libraries were prepared as described previously<sup><xref rid="R24" ref-type="bibr">24</xref></sup> with the following modifications: Centrifugation’s were performed at 500 rcf, thermomixer incubations were set to 500 rpm, and following ligation chromatin was pelleted by centrifugation (15 min, 4°C, 500 rcf) and the supernatant discarded. To increase sequencing depth and minimize PCR duplicates experiments were performed in technical triplicates and four unique adapters were used per replicate.</p>
    </sec>
    <sec id="S21">
      <title>NG Capture-C</title>
      <p id="P43">Double capture was performed as described previously<sup><xref rid="R24" ref-type="bibr">24</xref></sup> with biotinylated oligonucleotides (IDT xGen Lockdown Probes) in two pools (<xref ref-type="supplementary-material" rid="SD5">Supplementary Table 2</xref>) with 3 pg of each oligonucleotide per 3C library. The generated NG Capture-C libraries were sequenced using Illumina sequencing platforms (V2 chemistry; 150-bp paired-end reads) and data collected using the NextSeq System Suite (v2). To resolve even subtle changes in chromatin interaction domains at high resolution, the libraries were deeply sequenced (GM12878 CTCF - 128 M; GM12878 intra domain -118 M reads; K562 CTCF – 302 M; K562 intra domain – 289 M reads). All technical replicates were merged for the analysis.</p>
    </sec>
    <sec id="S22">
      <title>Tiled-C</title>
      <p id="P44">Tiled-C generates Hi-C like data focused on loci of interest at greater depth by using an oligonucleotide capture enriching a 3C library for viewpoints tiled over the regions of interest. Tiled oligonucleotides were designed using the design approach and tool described in Oudelaar and Beagrie <italic>et al.</italic>
<sup><xref rid="R29" ref-type="bibr">29</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://oligo.readthedocs.io/en/latest/">https://oligo.readthedocs.io/en/latest/</ext-link>). A panel of double-stranded capture oligonucleotides from Twist Bioscience (Custom probes for NGS target enrichment) was used. The Tiled-C procedure was performed as described in Oudelaar and Beagrie <italic>et al</italic>. using the 3C libraries from GM12878 and K562 cells. All biological and technical replicates were merged for the analysis. For a summary of the regions of interest and designed probes see <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref>.</p>
    </sec>
    <sec id="S23">
      <title>NG Capture-C analysis</title>
      <p id="P45">NG Capture-C data were mapped, quality controlled and visualized using CcseqBasicS<sup><xref rid="R45" ref-type="bibr">45</xref></sup> following the procedure described previously<sup><xref rid="R24" ref-type="bibr">24</xref></sup>.</p>
    </sec>
    <sec id="S24">
      <title>Tiled-C analysis</title>
      <p id="P46">Tiled-C data were mapped and quality controlled using the tiled mode of CcseqBasicS described above. Each region was ICE normalized using the ICE implementation of HiCPro with default parameters.</p>
    </sec>
    <sec id="S25">
      <title>Distance-normalize NG Capture-C tracks</title>
      <p id="P47">To compare them to the Hi-C skeleton, NG Capture-C tracks were normalized for distance dependence per viewpoint. The number of interactions with each restriction enzyme fragment was extracted and the distance to the viewpoint recorded. The interactions were then normalized for the total number of <italic>cis</italic> interactions for the respective viewpoint. Pooling this information across all viewpoints we observed that the distance decay approximately follows a log – log linear trend when we split the data into three distance bins (close, intermediate and far). The distance thresholds for these bins were empirically optimized for every NG Capture-C set (see <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 4</xref>), excluding all interactions closer than 2.5 kb to the respective viewpoint. The distance decay is then approximated by three linear regression fits, one for each distance bin. The distance-normalized interactions were calculated per viewpoint by dividing the observed <italic>cis</italic> normalized interactions with the expected interactions from the linear fit at the respective distance.</p>
    </sec>
    <sec id="S26">
      <title>Insulation score boundary calling</title>
      <p id="P48">Interaction domain boundaries were called using the Hi-C data, the Hi-C skeleton and the deepC predicted interactions using an insulation score-based approach that was adapted from Crane et al.<sup><xref rid="R26" ref-type="bibr">26</xref></sup>. Using the 5 kb bin sized data, the mean insulation score profile was calculated based on a 25 kb window to allow for a more intricate boundary call. The first derivative, or delta vector, of the insulation score profile was approximated using a 1D Sobel operator. Zero crossings in this delta vector represent local minima and maxima of the insulation score. Maxima were discarded. The remaining boundaries were further filtered by calculating the approximation of the second derivative of the insulation profile using the same procedure described above. The height of this delta2 vector reflects the change in delta, with sharper boundaries having a higher delta2 score. Boundaries with a delta2 score smaller than 0.1 were removed and the remaining boundaries were stratified based on their delta2 score.</p>
    </sec>
    <sec id="S27">
      <title>TopDom</title>
      <p id="P49">TopDom was retrieved from the gitHub implementation (<ext-link ext-link-type="uri" xlink:href="https://github.com/HenrikBengtsson/TopDom">https://github.com/HenrikBengtsson/TopDom</ext-link>). Boundaries were called using the window parameters 5, 10 and 20. Boundaries between all types of called domains were used.</p>
    </sec>
    <sec id="S28">
      <title>Distance-normalized NG Capture-C signal over boundaries</title>
      <p id="P50">The mean, distance-normalized NG Capture-C signals over boundaries were calculated. In NG Capture-C tracks from single viewpoints, domain boundaries can be subtle and get harder to detect the further away from the viewpoint they are located. Therefore, boundaries further then 1 Mb away from a viewpoint were excluded. The mean normalized Capture-C signal over boundaries relative to their centre was calculated.</p>
    </sec>
    <sec id="S29">
      <title>Virtual4C from Hi-C skeleton and deepC maps</title>
      <p id="P51">By extracting all interacting windows with a viewpoint of interest, Hi-C data can be transformed into virtual 4C profiles. For this work, virtual 4C profiles were derived from the Hi-C skeleton and the deepC predictions yielding distance-normalized profiles. Virtual 4C profiles from the Hi-C skeleton and deepC predictions were compared to distance-normalized NG Capture-C tracks by calculating the respective Pearson correlation of all interactions within 1 Mb from a given viewpoint. Because the skeleton percentiles are discrete and punctuate, a running mean smoothing window of 25 kb was applied. In contrast, the deepC predictions are smooth and therefore no additional smoothing was applied.</p>
    </sec>
    <sec id="S30">
      <title>Chromatin segmentation</title>
      <p id="P52">GM12878 and K562 chromatin data were downloaded from the ENCODE data portal (see <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 5</xref>). Filtered alignments to hg19 were downloaded and replicates were merged. Peaks were called using macs2<sup><xref rid="R42" ref-type="bibr">42</xref></sup> with default settings and -q 0.01. Deeptools<sup><xref rid="R46" ref-type="bibr">46</xref></sup> was used to create bigwig coverage tracks. DNase-seq and CTCF ChIP-seq peaks were merged to a union set merging peaks within 10 bp of each other using bedtools<sup><xref rid="R47" ref-type="bibr">47</xref></sup> (bedtools merge -d 10). Union peaks were formatted to 600 bp elements centred on the peaks. Deeptools was then used to extract the read coverage for each chromatin dataset over each peak union element. For this, elements were extended to 1000 bps to better capture flanking histone modifications. Using the derived count matrix, chromatin classes were segmented using GenoSTAN<sup><xref rid="R48" ref-type="bibr">48</xref></sup> running on the elements rather than entire chromosome stretches. The HMM model was trained using the Poisson log-normal distributions. Twelve classes were fitted and merged into eleven classes based on similarity of the chromatin signatures. The classes were manually curated and classified into promoter, enhancer and CTCF sites with varying activity levels based on H3K27ac coverage.</p>
    </sec>
    <sec id="S31">
      <title>Saliency score</title>
      <p id="P53">Adapted from image analysis<sup><xref rid="R30" ref-type="bibr">30</xref></sup> the saliency score serves as a proxy for the importance of every base pair to the interaction predictions. Explicitly, the saliency score was calculated as the dot product of the gradient of the model output with respect to the sequence input and the one-hot encoded DNA sequence input. This effectively masks the impact of non-present bases. For a given window the saliency score relates to the interaction pole on the center. To visualize saliency tracks, the sequence window was moved in bin sized steps and the saliency per base pair was averaged over all sequence windows (sized 1 Mb + bin size) that include the respective base pair. To simplify visualization and interpretation the absolute value of the saliency score was used. Metaplots were computed with deepTools.</p>
    </sec>
    <sec id="S32">
      <title>eQTL data analysis</title>
      <p id="P54">EBV transformed lymphocyte specific eQTLs were retrieved from GTEx (v7 accessed from the GTEx portal 01/03/2019). A union of DNase-seq and CTCF ChIP-seq peaks was created using bedtools merge. The eQTL SNPs were filtered for intersection with the union of GM12878 open chromatin and CTCF peaks. Indels were removed. A background SNP set was constructed by shuffling the eQTL SNPs on the respective same chromosome and forcing them to stem from within the union peaks (bedtools shuffle -chrom -incl). Absolute saliency scores of the SNP bases derived from the 5 kb resolution GM12878 model were extracted. Empirical cumulative distributions were derived and tested for significance using a two sample Kolmogorov-Smirnov test (R, ks.test, reshuffled SNP saliency (n = 6607) vs. eQTL set (n = 6607) saliency, alternative hypothesis: “less”).</p>
    </sec>
    <sec id="S33">
      <title>Deletion screen</title>
      <p id="P55">Separately, GM12878 DNase-seq and CTCF ChIP-seq peaks were merged if multiple peaks were found within 1.5 kb of each other (bedtools merge -d 1500). Peaks were extended to at least 300 bp. All DNase peaks that overlapped with CTCF peaks were removed. For every remaining CTCF (n=45635) and DNase (n=47320) site the impact on chromatin interactions upon deleting the respective site was predicted the 5 kb GM12878 model. Chromatin classes were assigned based on overlap with the GenoSTAN chromatin segmentation described above. In addition, n = 3850 background sites were selected by shuffling all CTCF and open chromatin sites on chr16 forcing no overlap (bedtools shuffle -chrom -noOverlapping).</p>
    </sec>
    <sec id="S34">
      <title>5C data</title>
      <p id="P56">Processed 5C data from Hnisz et al.<sup><xref rid="R31" ref-type="bibr">31</xref></sup> were downloaded, binned into 5kb bins and visualized.</p>
    </sec>
    <sec id="S35">
      <title>SNP sampling</title>
      <p id="P57">1000 random SNPs each were sampled from strong CTCF sites, strong promoters and strong enhancers as classified by the chromatin segmentation procedure described above. For a background set, 1000 SNPs were sampled from the 400 bp regions flanking these regulatory elements while avoiding any overlap with other elements. SNPs positions were sampled using bedtools shuffle and variant bases were randomly selected from the three bases not present in hg19 at the respective position.</p>
    </sec>
    <sec id="S36">
      <title>Statistics and Replication</title>
      <p id="P58">Statistical analysis war performed in R. Statistical tests are described in the relevant subsection of the <xref ref-type="sec" rid="S8">Online Methods</xref>. NG Capture-C and Tiled-C experiments were performed once, technical replicates were pooled for maximum read depth (see Life Science Reporting Summary for additional details).</p>
    </sec>
    <sec id="S37">
      <title>Additional software and packages</title>
      <p id="P59">All neural networks were implemented in python (v3.5) and tensorflow<sup><xref rid="R49" ref-type="bibr">49</xref></sup> (developed under 1.8.0).</p>
      <p id="P60">
        <italic>Additional Tools</italic>
        <list list-type="bullet" id="L1">
          <list-item>
            <p id="P61">samtools<sup><xref rid="R50" ref-type="bibr">50</xref></sup> (v1.3)</p>
          </list-item>
          <list-item>
            <p id="P62">FastQC (v0.11.4) (<ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>)</p>
          </list-item>
          <list-item>
            <p id="P63">Bowtie<sup><xref rid="R51" ref-type="bibr">51</xref></sup> (v1.1.2)</p>
          </list-item>
        </list>
      </p>
      <p id="P64">
        <italic>Additional R packages</italic>
        <list list-type="bullet" id="L2">
          <list-item>
            <p id="P65">cowplot (v0.6.2, <ext-link ext-link-type="uri" xlink:href="https://github.com/wilkelab/cowplot">https://github.com/wilkelab/cowplot</ext-link>)</p>
          </list-item>
          <list-item>
            <p id="P66">GenomicRanges<sup><xref rid="R52" ref-type="bibr">52</xref></sup> – (v1.30.3)</p>
          </list-item>
          <list-item>
            <p id="P67">ggplot2<sup><xref rid="R53" ref-type="bibr">53</xref></sup> (v3.1.0)</p>
          </list-item>
          <list-item>
            <p id="P68">RcolorBrewer (v1.1.1-2, <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">https://cran.r-project.org/web/packages/RColorBrewer/index.html</ext-link>)</p>
          </list-item>
          <list-item>
            <p id="P69">rtracklayer<sup><xref rid="R54" ref-type="bibr">54</xref></sup> (v1.30.4)</p>
          </list-item>
          <list-item>
            <p id="P70">tidyverse (v1.3.0) (<ext-link ext-link-type="uri" xlink:href="https://www.tidyverse.org">https://www.tidyverse.org</ext-link>)</p>
          </list-item>
          <list-item>
            <p id="P71">zoo<sup><xref rid="R55" ref-type="bibr">55</xref></sup> (v1.8.1)</p>
          </list-item>
        </list>
      </p>
      <p id="P72">
        <italic>Additional Python libraries</italic>
        <list list-type="bullet" id="L3">
          <list-item>
            <p id="P73">numpy<sup><xref rid="R56" ref-type="bibr">56</xref></sup> (1.16.4)</p>
          </list-item>
          <list-item>
            <p id="P74">h5py (v2.9.0, <ext-link ext-link-type="uri" xlink:href="http://www.h5py.org">http://www.h5py.org</ext-link>)</p>
          </list-item>
          <list-item>
            <p id="P75">pysam (0.15.2, <ext-link ext-link-type="uri" xlink:href="https://github.com/pysam-developers/pysam">https://github.com/pysam-developers/pysam</ext-link>)</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="extended-data" id="S38">
    <title>Extended Data</title>
    <fig id="F4" orientation="portrait" position="anchor">
      <label>Extended Data Fig. 1</label>
      <caption>
        <title>Percentile normalizing Hi-C data for deep learning.</title>
        <p id="P76">The Hi-C interactions are percentile-binned in a distance-stratified manner. For every genomic distance, in steps equal to the bin size, the Hi-C signal is split into unequal percentiles ranging from 20 % bottom to 5 % top. The percentiles are attributed the values 1 to 10 yielding the Hi-C skeleton. The unequal percentile sizes ensure a finer distinction of the differences at the high Hi-C interaction value range, while minor differences in the low interaction value range are squished. Effectively, this procedure reduces the proximity signal and enhances domains and domain boundaries.</p>
      </caption>
      <graphic xlink:href="EMS118366-f004"/>
    </fig>
    <fig id="F5" orientation="portrait" position="anchor">
      <label>Extended Data Fig. 2</label>
      <caption>
        <title>Comparison of deepC training with and without transfer learning.</title>
        <p id="P77">Training a deepC model with the same architecture but without pre-seeding the lower convolutional layers with the chromatin feature model weights results in the emergence of triangular structures. Their positioning however does not match with the Hi-C structures. In contrast, with pre-seeding the predicted domains overlap well with the Hi-C skeleton.</p>
      </caption>
      <graphic xlink:href="EMS118366-f005"/>
    </fig>
    <fig id="F6" orientation="portrait" position="anchor">
      <label>Extended Data Fig. 3</label>
      <caption>
        <title>Tissue-specific deepC predictions.</title>
        <p id="P78">Shown is a region on chromosome 2 around the <italic>MEIS1</italic> locus. DeepC predicts a small domain with insulation to the upstream regions (black arrow) in a tissue specific manner. The domain is only visible in K562 Hi-C data and matches with tissue-specific CTCF binding. Tiled-C confirms the tissue-specific domain. For contrast, Tiled-C data were bounded between the 5 and 95 percentiles.</p>
      </caption>
      <graphic xlink:href="EMS118366-f006"/>
    </fig>
    <fig id="F7" orientation="portrait" position="anchor">
      <label>Extended Data Fig. 4</label>
      <caption>
        <title>NG Capture-C validation of deepC predictions.</title>
        <p id="P79">a) Example region with overlap of GM12878: Hi-C, skeleton and deepC prediction; NG Capture-C tracks, distance-normalized NG Capture-C tracks and CTCF ChIP-seq track (red). Shown is a CTCF viewpoint (purple triangle) and an intra domain viewpoint (blue triangle) not overlapping with any active elements. Dashed lines in the distance-normalized NG Capture-C tracks indicate the expected interaction value. Dotted black lines highlight deepC prediction details that correspond to boundaries in the NG Capture-C tracks. b) K562 data of the same region.</p>
      </caption>
      <graphic xlink:href="EMS118366-f007"/>
    </fig>
    <fig id="F8" orientation="portrait" position="anchor">
      <label>Extended Data Fig. 5</label>
      <caption>
        <title>Mapping important features for genome folding.</title>
        <p id="P80">Shown are GM12878 deepC predictions over the <italic>IKZF2</italic> locus (a) on chromosome 2 and focused on the <italic>IKZF2</italic> promoter (b). Aligned are DHS as well as ChIP-seq tracks for CTCF and histone modifications. Shown in green is the saliency score which is a proxy for the importance every base has in predicting the chromatin interactions of that region. The saliency score shows sharp peaks overlapping CTCF binding sites and broader peaks overlapping active gene promoters. Resolving the saliency score at base pair resolution (b) highlights CTCF and general transcription factor binding motifs.</p>
      </caption>
      <graphic xlink:href="EMS118366-f008"/>
    </fig>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>Source Data Fig 2</label>
      <media xlink:href="EMS118366-supplement-Source_Data_Fig_2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" orientation="portrait" id="d40e1158" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>Source Data Fig 3</label>
      <media xlink:href="EMS118366-supplement-Source_Data_Fig_3.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" orientation="portrait" id="d40e1162" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>Source data for Figure 1 d</label>
      <media xlink:href="EMS118366-supplement-Source_data_for_Figure_1_d.txt" mimetype="text" mime-subtype="plain; charset=utf-8" orientation="portrait" id="d40e1166" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>Supplementary Figures and Tables</label>
      <media xlink:href="EMS118366-supplement-Supplementary_Figures_and_Tables.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" id="d40e1170" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD5">
      <label>Supplementary Tables 1, 2</label>
      <media xlink:href="EMS118366-supplement-Supplementary_Tables_1__2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" orientation="portrait" id="d40e1174" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S39">
    <title>Acknowledgments</title>
    <p>The authors would like to thank Dr. Robert Beagrie for help in refining the manuscript. This work was supported by the MRC (MC_UU_12009/14 to J.R.H.) and the Wellcome Trust via Strategic Award (106130/Z/14/Z to J.R.H.) and Institutional Strategic Support Fund (reference 105605/Z/14/Z to J.R.H.). The Wellcome Trust Genomic Medicine and Statistics PhD Programme (203728/Z/16/Z to R.S. &amp; 203141/Z/16/Z to R.B.). The Stevenson Junior Research Fellowship at University College, Oxford (to A.M.O). G.L. is supported by the Wellcome Trust supporting award (090532/Z/09/Z to G.L.). Y.W.T. is supported by the European Research Council under the European Union’s Seventh Framework Programme (FP7/2007-2013 to Y.W.T.) ERC grant agreement no. 617071.</p>
    <p>The Genotype-Tissue Expression (GTEx) Project was supported by the Common Fund of the Office of the Director of the National Institutes of Health, and by NCI, NHGRI, NHLBI, NIDA, NIMH, and NINDS.</p>
  </ack>
  <fn-group>
    <fn id="FN1" fn-type="con">
      <p id="P83">
        <bold>Author contributions</bold>
      </p>
      <p id="P84">R.S., G.L. and J.R.H. conceived the project. R.S, R.B., Y.W.T. and G.L designed the neural network architectures. R.S. optimized and trained the neural networks and performed downstream analysis. R.S. M.G. D.D. A.M.O. and J.R.H. designed and evaluated the validation strategy. M.G. performed NG Capture-C experiments. D.D. performed Tiled-C experiments. R.S., A.M.O. and J.T. performed bioinformatic analysis of NG Capture-C and Tiled-C. R.S. performed integrative analysis and prepared the figures. R.S., G.L and J.R.H. wrote the manuscript with inputs from all authors.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P85">
        <bold>Competing financial interests</bold>
      </p>
      <p id="P86">The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <sec id="S40" sec-type="data-availability">
    <title>Data availability</title>
    <p id="P81">Hi-C data from Rao et al. is available under GSE63525. Chromatin feature data from ENCODE, Roadmap and other publicly available data are listed in detail with accession numbers in <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 1</xref>. Additional ENCODE data used for chromatin segmentation and visualization are listed with accession numbers in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 5</xref>. Tiled-C and NG Capture-C validation data are available under the GEO super series GSE137437.</p>
  </sec>
  <sec id="S41" sec-type="data-availability">
    <title>Code availability</title>
    <p id="P82">All code for training and employing deepC networks as well as trained models are available under: <ext-link ext-link-type="uri" xlink:href="https://github.com/rschwess/deepC">https://github.com/rschwess/deepC</ext-link>; All code for training and employing chromatin feature networks is available under: <ext-link ext-link-type="uri" xlink:href="https://github.com/rschwess/deepHaem">https://github.com/rschwess/deepHaem</ext-link>
</p>
  </sec>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hindorff</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>9362</fpage>
        <lpage>9367</lpage>
        <pub-id pub-id-type="pmid">19474294</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maurano</surname>
            <given-names>MT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic localization of common disease-associated variation in regulatory DNA</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>337</volume>
        <fpage>1190</fpage>
        <lpage>1195</lpage>
        <pub-id pub-id-type="pmid">22955828</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schreiber</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Libbrecht</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <source>Nucleotide sequence and DNaseI sensitivity are predictive of 3D chromatin architecture</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.1101/103614v5</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whalen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Truty</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Enhancer–promoter interactions are encoded by complex genomic signatures on looping chromatin</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>488</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="pmid">27064255</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>DeepTACT: predicting 3D chromatin contacts via bootstrapping deep learning</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <elocation-id>e60</elocation-id>
        <pub-id pub-id-type="pmid">30869141</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Predicting three-dimensional genome organization with chromatin states</article-title>
        <source>PLOS Comput Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <elocation-id>e1007024</elocation-id>
        <pub-id pub-id-type="pmid">31181064</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belokopytova</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Nuriddinov</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Mozheiko</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Quantitative prediction of enhancer–promoter interactions</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>72</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="pmid">31804952</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chasman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knaack</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>In silico prediction of high-resolution Hi-C interaction matrices</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5449</fpage>
        <pub-id pub-id-type="pmid">31811132</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brackley</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marenduzzo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Polymer Simulations of Heteromorphic Chromatin Predict the 3D Folding of Complex Genomic Loci</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>72</volume>
        <fpage>786</fpage>
        <lpage>797</lpage>
        <elocation-id>e11</elocation-id>
        <pub-id pub-id-type="pmid">30344096</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bianco</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Polymer physics predicts the effects of structural variants on chromatin architecture</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>662</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="pmid">29662163</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hnisz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Insulated Neighborhoods: Structural and Functional Units of Mammalian Gene Control</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1188</fpage>
        <lpage>1200</lpage>
        <pub-id pub-id-type="pmid">27863240</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Troyanskaya</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>Predicting effects of noncoding variants with deep learning–based sequence model</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>931</fpage>
        <lpage>934</lpage>
        <pub-id pub-id-type="pmid">26301843</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Snoek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>990</fpage>
        <lpage>999</lpage>
        <pub-id pub-id-type="pmid">27197224</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequential regulatory activity prediction across chromosomes with convolutional neural networks</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>739</fpage>
        <lpage>750</lpage>
        <pub-id pub-id-type="pmid">29588361</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Koltun</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Multi-Scale Context Aggregation by Dilated Convolutions</source>
        <year>2015</year>
        <comment>Preprint at: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1511.07122">http://arxiv.org/abs/1511.07122</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Oord</surname>
          </name>
          <name>
            <surname>van den</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WaveNet: A Generative Model for Raw Audio</article-title>
        <conf-name>2009 IEEE Int Conf Acoust Speech Signal Process</conf-name>
        <year>2016</year>
        <fpage>3437</fpage>
        <lpage>3440</lpage>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yosinski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clune</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lipson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>How transferable are features in deep neural networks?</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>3320</fpage>
        <lpage>3328</lpage>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of 111 reference human epigenomes</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <fpage>317</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="pmid">25693563</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D Map of the Human Genome at Kilobase Resolution Reveals Principles of Chromatin Looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3D Genome Rewiring during Mouse Neural Development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572.e24</lpage>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <comment>750</comment>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>hicGAN infers super resolution Hi-C data with generative adversarial networks</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>i99</fpage>
        <lpage>i107</lpage>
        <pub-id pub-id-type="pmid">31510693</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>JOJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed analysis of chromosome conformation at vastly improved sensitivity</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>74</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="pmid">26595209</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Formation of Chromosomal Domains by Loop Extrusion</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2038</fpage>
        <lpage>2049</lpage>
        <pub-id pub-id-type="pmid">27210764</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Condensin-driven remodelling of X chromosome topology during dosage compensation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>240</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">26030525</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopDom: An efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>44</volume>
        <elocation-id>e70</elocation-id>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zufferey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tavernari</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Oricchio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ciriello</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Comparison of computational methods for the identification of topologically associating domains</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>217</fpage>
        <pub-id pub-id-type="pmid">30526631</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oudelaar</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Dissection of the 4D chromatin structure of the α-globin locus through in vivo erythroid differentiation with extreme spatial and temporal resolution</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/763763v2</pub-id>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Simonyan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vedaldi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zisserman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deep Inside Convolutional Networks: Visualising Image Classification Models and Saliency Maps</article-title>
        <conf-name>2nd Int Conf Learn Represent ICLR 2014 - Work Track Proc</conf-name>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hnisz</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Activation of proto-oncogenes by disruption of chromosome neighborhoods</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>351</volume>
        <fpage>1454</fpage>
        <lpage>1458</lpage>
        <pub-id pub-id-type="pmid">26940867</pub-id>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiedel</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>17q21 asthma-risk variants switch CTCF binding and regulate IL-2 production by T cells</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <elocation-id>13426</elocation-id>
        <pub-id pub-id-type="pmid">27848966</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robson</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Ringel</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Regulatory Landscaping: How Enhancer-Promoter Communication Is Sculpted in 3D</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>74</volume>
        <fpage>1110</fpage>
        <lpage>1122</lpage>
        <pub-id pub-id-type="pmid">31226276</pub-id>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Gorkin</surname>
            <given-names>DU</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Chromatin Domains: The Unit of Chromosome Organization</article-title>
        <source>Mol Cell</source>
        <year>2016</year>
        <volume>62</volume>
        <fpage>668</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="pmid">27259200</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marti-Renom</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges and guidelines toward 4D nucleome data and model standards</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1352</fpage>
        <lpage>1358</lpage>
        <pub-id pub-id-type="pmid">30262815</pub-id>
      </element-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lupiáñez</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Structural variation in the 3D genome</article-title>
        <source>Nat Rev Genet</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>453</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="pmid">29692413</pub-id>
      </element-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <source>Predicting 3D genome folding from DNA sequence</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/800060v1</pub-id>
      </element-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>1193</fpage>
        <lpage>1203</lpage>
        <pub-id pub-id-type="pmid">27526324</pub-id>
      </element-citation>
    </ref>
    <ref id="R39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwessinger</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sasquatch: predicting the impact of regulatory SNPs on transcription factor binding from cell- and tissue-specific DNase footprints</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1730</fpage>
        <lpage>1742</lpage>
        <pub-id pub-id-type="pmid">28904015</pub-id>
      </element-citation>
    </ref>
    <ref id="R40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Downes</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <source>An integrated platform to systematically identify causal variants and genes for polygenic human traits</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/813618v1</pub-id>
      </element-citation>
    </ref>
    <ref id="R41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Telenius</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Consortium</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <source>NGseqBasic - a single-command UNIX tool for ATAC-seq, DNaseI-seq, Cut-and-Run, and ChIP-seq data mapping, high-resolution visualisation, and quality control</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1101/393413v1</pub-id>
      </element-citation>
    </ref>
    <ref id="R42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <elocation-id>R137</elocation-id>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="R43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Deep Residual Learning for Image Recognition</article-title>
        <source>Multimed Tools Appl</source>
        <year>2015</year>
        <volume>77</volume>
        <fpage>10437</fpage>
        <lpage>10453</lpage>
      </element-citation>
    </ref>
    <ref id="R44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>259</fpage>
        <pub-id pub-id-type="pmid">26619908</pub-id>
      </element-citation>
    </ref>
    <ref id="R45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Telenius</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <source>CaptureCompendium: a comprehensive toolkit for 3C analysis</source>
        <year>2020</year>
        <comment>Preprint at: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2020/02/18/2020.02.17.952572">http://biorxiv.org/content/early/2020/02/18/2020.02.17.952572</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dündar</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Diehl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Manke</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>deepTools: a flexible platform for exploring deep-sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>W187</fpage>
        <lpage>W191</lpage>
        <pub-id pub-id-type="pmid">24799436</pub-id>
      </element-citation>
    </ref>
    <ref id="R47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="R48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate Promoter and Enhancer Identification in 127 ENCODE and Roadmap Epigenomics Cell Types and Tissues by GenoSTAN</article-title>
        <source>PLoS One</source>
        <year>2017</year>
        <volume>12</volume>
        <elocation-id>e0169249</elocation-id>
        <pub-id pub-id-type="pmid">28056037</pub-id>
      </element-citation>
    </ref>
    <ref id="R49">
      <label>49</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TensorFlow: A System for Large-Scale Machine Learning TensorFlow: A system for large-scale machine learning</article-title>
        <conf-name>12th USENIX Symp Oper Syst Des Implement (OSDI ’16)</conf-name>
        <year>2016</year>
        <fpage>265</fpage>
        <lpage>284</lpage>
      </element-citation>
    </ref>
    <ref id="R50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="R51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <elocation-id>R25</elocation-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="R52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for Computing and Annotating Genomic Ranges</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <elocation-id>e1003118</elocation-id>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="R53">
      <label>53</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <publisher-name>Springer</publisher-name>
        <publisher-loc>New York</publisher-loc>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="R54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>rtracklayer: An R package for interfacing with genome browsers</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1841</fpage>
        <lpage>1842</lpage>
        <pub-id pub-id-type="pmid">19468054</pub-id>
      </element-citation>
    </ref>
    <ref id="R55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grothendieck</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Zoo: S3 infrastructure for regular and irregular time series</article-title>
        <source>J Stat Softw</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="R56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colbert</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The NumPy Array: A Structure for Efficient Numerical Computation</article-title>
        <source>Comput Sci Eng</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>22</fpage>
        <lpage>30</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Predicting Hi-C interactions from DNA sequence.</title>
      <p>a) Overview of the deepC architecture and training workflow. b) Encoding of Hi-C data as target vector for prediction given a 1 Mb window of DNA sequence. c) Comparison of Hi-C data, the derived Hi-C skeleton and the interactions predicted from DNA sequence using deepC. Shown is a ~ 7 Mb region on hold out chromosome 17. d) Distance-stratified Pearson correlation between the Hi-C skeleton and the deepC predictions in a cross-validation scheme across all chromosomes. Solid lines indicate the mean correlation value and the area indicates the space between the maximum and the minimum values over all chromosomes. Red shows the correlation with the raw and blue with the (5x5) mean filter smoothed skeleton values. Dotted lines at 0.3, 0.4 and 0.5.</p>
    </caption>
    <graphic xlink:href="EMS118366-f001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Validation of deepC predictions.</title>
      <p>a) Comparing the correlation between the validation NG Capture-C profiles and the virtual 4C profiles derived from the Hi-C skeleton (red); and the deepC prediction map (blue) from all viewpoints in two cell types. Compared are n = 81 CTCF and n = 139 intra domain viewpoints. Boxplots: median middle thick line, 25th and 75th percentile left and right hinge respectively, whiskers stretch up 1.5 times the IQR (inter quartile range). b) Meta-profiles of the average NG Capture-C signal over domain boundaries called at high resolution from the Hi-C data, the skeleton and the deepC predicted interaction map respectively. Shown is the mean distance-normalized NG Capture-C signal relative to the boundary centre. The labels “CTCF” and “Intra domain” refer to the NG Capture-C viewpoint fragments. These were designed to overlap either CTCF sites or to lie within insulated domains but not overlap with regulatory genomic elements, so as to capture the domain structure and not the interactions of specific genomic elements. c) Shown are Hi-C data, the deepC predicted interaction map and the Tiled-C high sensitivity map over a locus on chr17, a hold-out chromosome. Boundaries called at high resolution from Hi-C (green) and deepC predictions (purple) are aligned under the respective map and the Tiled-C map. Cell-type-specific CTCF ChIP-seq tracks are visualized below. For contrast, Hi-C and Tiled-C data were bounded between 5 and 95 % of coverage and deepC predictions were bounded between 2 and 8 predicted regression score.</p>
    </caption>
    <graphic xlink:href="EMS118366-f002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>DeepC for dissecting the determinants of genome folding and predicting the impact of variation.</title>
      <p>a) Mean saliency enrichment in 10 bp bins over different classes of regulatory elements genome-wide in GM12878 cells. b) Mean predicted chromatin interaction difference between reference and variant when deleting all open chromatin and CTCF sites and shuffled background sequences individually, genome-wide in GM12878 cells. Differences were quantified as the mean absolute interaction difference per bin to bin interaction. Each deletion was classified based on the overlap with genome segmentation classes. A total of n = 96805 was analysed. Boxplots show the median as thick line, the 25th and 75th percentile as left and right hinge respectively. The whiskers stretch up 1.5 times the IQR (inter quartile range) away from the respective whisker. Outliers outside this range were omitted from plotting. c) Effect of deleting a ~ 30 kb fragment containing four CTCF sites. Shown is the effect as validated by 5C data in wild-type (WT) and mutant in HEK293 cells by Hnisz et al. and the predicted effect using the GM12878 model. CTCF ChIP-seq tracks from HEK293 and GM12878 cells are visualized below. Dotted lines mark the deleted fragment. The mutant deepC prediction was shifted to be centred on the deleted site. d) Predicting the effect of two Asthma associated SNPs with the GM12878 model. Shown is the prediction for non risk and the risk allele, the differential map (non risk – risk) and a GM12878 CTCF ChIP-seq track. Location of the SNPs is indicated by triangles (red – rs12936231, blue – rs4065275). Black lines indicate the location of <italic>ORMDL3</italic> and <italic>IKZF3</italic> and only those two genes are highlighted for clarity. Comparing the predicted SNP effects against 1000 randomly sampled SNPs within CTCF sites places rs4065275 in the top 11 % and rs12936231 in the top 1% of predicted mean absolute interaction difference.</p>
    </caption>
    <graphic xlink:href="EMS118366-f003"/>
  </fig>
</floats-group>
