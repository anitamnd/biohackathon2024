<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3017084</article-id>
    <article-id pub-id-type="pmid">21253599</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-10-01734</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0015925</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Pool</subject>
              <subject>Genetic Drift</subject>
              <subject>Genetic Polymorphism</subject>
              <subject>Natural Selection</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Pool</subject>
              <subject>Genetic Drift</subject>
              <subject>Genetic Polymorphism</subject>
              <subject>Natural Selection</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subj-group>
              <subject>Genome Scans</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PoPoolation: A Toolbox for Population Genetic Analysis of Next Generation Sequencing Data from Pooled Individuals</article-title>
      <alt-title alt-title-type="running-head">Analysis of Pooled Next Generation Sequencing Data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kofler</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Orozco-terWengel</surname>
          <given-names>Pablo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Maio</surname>
          <given-names>Nicola</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pandey</surname>
          <given-names>Ram Vinay</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nolte</surname>
          <given-names>Viola</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Futschik</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kosiol</surname>
          <given-names>Carolin</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schlötterer</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Institute of Population Genetics, Vetmeduni Vienna, Vienna, Austria</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Statistics, University of Vienna, Vienna, Austria</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kayser</surname>
          <given-names>Manfred</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">Erasmus University Medical Center, Netherlands</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>christian.schloetterer@vetmeduni.ac.at</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CS CK. Performed the experiments: VN RK. Analyzed the data: PO-t RK RVP NDM. Contributed reagents/materials/analysis tools: AF. Wrote the paper: CS. Read and approved the final manuscript: RK PO-t NDM RVP VN AF CK CS.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>e15925</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>11</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Kofler et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Recent statistical analyses suggest that sequencing of pooled samples provides a cost effective approach to determine genome-wide population genetic parameters. Here we introduce PoPoolation, a toolbox specifically designed for the population genetic analysis of sequence data from pooled individuals. PoPoolation calculates estimates of <italic>θ</italic>
<sub>Watterson</sub>, <italic>θ</italic>
<sub>π</sub>, and Tajima's D that account for the bias introduced by pooling and sequencing errors, as well as divergence between species. Results of genome-wide analyses can be graphically displayed in a sliding window plot. PoPoolation is written in Perl and R and it builds on commonly used data formats. Its source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/popoolation/">http://code.google.com/p/popoolation/</ext-link>. Furthermore, we evaluate the influence of mapping algorithms, sequencing errors, and read coverage on the accuracy of population genetic parameter estimates from pooled data.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The recent advances in sequencing technology have changed our experimental approaches to biological questions. It has become possible to move from small scale, gene centric studies to genome-wide analyses and remain within the budget of individual research grants. Even population genetic analyses have become within the reach of moderate research budgets by sequencing pools of individuals <xref rid="pone.0015925-Turner1" ref-type="bibr">[e.g.: 1]</xref>, <xref rid="pone.0015925-Rubin1" ref-type="bibr">[2]</xref>
</p>
    <p>The new sequencing technologies have also changed the time allocation within a research project as well as the training required. Classic population studies typically involved a considerable wet-lab component for data collection. The new sequencing technologies reduce wet-lab work to DNA extraction and library construction. The analysis of the massive amounts of data generated in the course of a single experiment not only requires more time, but also new skills.</p>
    <p>The challenges of Next Generation Sequencing data, namely a hitherto unprecedented number of extremely short sequence reads containing more sequencing errors than previous sequencing technologies, have lead to the development of many new software tools over the past few years. For many applications, such as SNP (single nucleotide polymorphism) discovery <xref rid="pone.0015925-Li1" ref-type="bibr">[e.g.: 3]</xref>, <xref rid="pone.0015925-Quinlan1" ref-type="bibr">[4]</xref>, <xref rid="pone.0015925-Koboldt1" ref-type="bibr">[5]</xref>, RNA-Seq <xref rid="pone.0015925-Hu1" ref-type="bibr">[e.g.: 6]</xref>, <xref rid="pone.0015925-Trapnell1" ref-type="bibr">[7]</xref>, ChIP-Seq <xref rid="pone.0015925-Zhang1" ref-type="bibr">[e.g.: 8]</xref>, <xref rid="pone.0015925-Rozowsky1" ref-type="bibr">[9]</xref>, and de novo assembly <xref rid="pone.0015925-Zerbino1" ref-type="bibr">[e.g.: 10]</xref>, <xref rid="pone.0015925-Birol1" ref-type="bibr">[11]</xref>, users can choose among a variety of software tools either in the public domain or from commercial software suppliers. For population genetic analyses, software tools are targeted at the analysis of individual genome sequencing projects <xref rid="pone.0015925-Haubold1" ref-type="bibr">[e.g.: 12]</xref>. To our knowledge no software packages are publicly available for population genetic analysis of pooled sequence data.</p>
    <p>Here, we introduce PoPoolation, a software suite specifically tailored for the analysis of pooled samples for population genetic inference. Furthermore, we carefully evaluate how peculiarities of the Next Generation Sequencing data (such as sequencing errors, mapping to a reference genome and read coverage) affect population genetic inferences.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p>The analysis of short sequence reads from pooled DNA samples requires several steps, as indicated in <xref ref-type="fig" rid="pone-0015925-g001">Figure 1</xref>. The first step in processing the data is trimming of the reads. <xref ref-type="table" rid="pone-0015925-t001">Table 1</xref> shows how trimming parameters influence the average length and quality of the reads used for mapping. While only few reads are lost with a quality threshold of 10 or 20, almost 70% are lost when a quality of 30 is used. We found that a threshold of 20 with a minimum length of 40–50 bp reliably generates high quality data. After trimming the reads for low quality bases, reads are mapped against a reference genome with the Burrows-Wheeler Alignment Tool (bwa <xref rid="pone.0015925-Li3" ref-type="bibr">[15]</xref>). Using SAMtools <xref rid="pone.0015925-Li3" ref-type="bibr">[15]</xref> the aligned reads are converted into a pileup file. This pileup file is used by PoPoolation to perform population genetic analyses.</p>
    <fig id="pone-0015925-g001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0015925.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Outline of a population genetic analysis from pooled sequence data.</title>
        <p>Sequencer figure from <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/">http://www.illumina.com/</ext-link>
</p>
      </caption>
      <graphic xlink:href="pone.0015925.g001"/>
    </fig>
    <table-wrap id="pone-0015925-t001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0015925.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Trimming statistics of 14×10<sup>6</sup> reads.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0015925-t001-1" xlink:href="pone.0015925.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">No trimming</td>
              <td align="left" rowspan="1" colspan="1">
                <xref ref-type="table-fn" rid="nt101">0*</xref>
              </td>
              <td align="left" rowspan="1" colspan="1">10</td>
              <td align="left" rowspan="1" colspan="1">20</td>
              <td align="left" rowspan="1" colspan="1">30</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">% reads passing trimming</td>
              <td align="left" rowspan="1" colspan="1">100</td>
              <td align="left" rowspan="1" colspan="1">99.73</td>
              <td align="left" rowspan="1" colspan="1">91.93</td>
              <td align="left" rowspan="1" colspan="1">88.92</td>
              <td align="left" rowspan="1" colspan="1">33.49</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sum read length [Mbp]</td>
              <td align="left" rowspan="1" colspan="1">1081.22</td>
              <td align="left" rowspan="1" colspan="1">1077.42</td>
              <td align="left" rowspan="1" colspan="1">960.57</td>
              <td align="left" rowspan="1" colspan="1">912.08</td>
              <td align="left" rowspan="1" colspan="1">298.65</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average read length</td>
              <td align="left" rowspan="1" colspan="1">76.00</td>
              <td align="left" rowspan="1" colspan="1">75.94</td>
              <td align="left" rowspan="1" colspan="1">73.45</td>
              <td align="left" rowspan="1" colspan="1">72.10</td>
              <td align="left" rowspan="1" colspan="1">62.68</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average quality</td>
              <td align="left" rowspan="1" colspan="1">27.50</td>
              <td align="left" rowspan="1" colspan="1">27.56</td>
              <td align="left" rowspan="1" colspan="1">29.51</td>
              <td align="left" rowspan="1" colspan="1">29.90</td>
              <td align="left" rowspan="1" colspan="1">32.23</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>0*: trimming includes removal of ‘N’-characters at the end of reads.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec id="s2a">
      <title>Validation</title>
      <p><xref ref-type="fig" rid="pone-0015925-g002">Figure 2</xref> shows the polymorphism and divergence pattern along the 3R chromosome of <italic>D. melanogaster</italic>. Our analysis captures important features of variability in <italic>D. melanogaster</italic>: regions close to the centromere and telomere (located at the left and right ends of <xref ref-type="fig" rid="pone-0015925-g002">figure 2</xref>, respectively) show the well-described drop in variability.</p>
      <fig id="pone-0015925-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Graphical output of polymorphism and divergence estimates using PoPoolation.</title>
          <p>Sliding window analysis of <italic>θ</italic>
<sub>π</sub> of a Portuguese <italic>D. melanogaster</italic> population on chromosome 3R (black line). The red line shows divergence (dxy) between <italic>D. melanogaster</italic> and <italic>D. simulans</italic> using the same window size and step size as for <italic>θ</italic>
<sub>π.</sub> Note that dxy is scaled by 1/10. Both lines are based on non-overlapping windows of 50 kb.</p>
        </caption>
        <graphic xlink:href="pone.0015925.g002"/>
      </fig>
      <p>Another striking feature apparent in <xref ref-type="fig" rid="pone-0015925-g002">Figure 2</xref> is the ragged pattern of polymorphism, which shows 2-fold differences in variation between some regions in close physical proximity. To validate that this pattern reflects heterogeneity in sequence variation rather than problems with our pooling approach, we compared the polymorphism pattern on 3R obtained from a Portuguese <italic>D. melanogaster</italic> population to the polymorphism data generated by Sanger re-sequencing of a <italic>D. melanogaster</italic> population from The Netherlands <xref rid="pone.0015925-Hutter1" ref-type="bibr">[21]</xref>. Using the targeted regions option of PoPoolation (see below) we found a high correlation between our variability estimates and the ones published by Hutter et al. (2007) for the Dutch population (<italic>θ</italic>
<sub>Watterson</sub> ρ = 0.78, <italic>p-value</italic>&lt;2.2×10<sup>−16</sup> and <italic>θ</italic>
<sub>π</sub> ρ = 0.82, <italic>p-value</italic>&lt;2.2×10<sup>−16</sup>; <xref ref-type="supplementary-material" rid="pone.0015925.s001">Table S1</xref>). Nevertheless, we also noted that the average variability in the Portuguese population was higher than for the Dutch population (<italic>θ</italic>
<sub>Watterson</sub>: 0.0084 vs. 0.0065, Wilcoxon sum rank test <italic>p-value</italic>: 2.118*10<sup>−6</sup>; <italic>θ</italic>
<sub>π</sub>: 0.0075 vs. 0.0063, Wilcoxon sum rank test <italic>p-value</italic>: 0.004567).</p>
      <p>Three important sources of error could affect the population genetic analysis of pooled samples: sequencing errors, problems with mapping the reads to the reference and insufficient sequence coverage. In the following, we evaluate all three factors.</p>
    </sec>
    <sec id="s2b">
      <title>Sequencing errors</title>
      <p>The typical error rate of unprocessed reads from an Illumina sequencer is about 1%. As sequencing errors inevitably affect the polymorphism estimates and Tajima's D, it is highly desirable to reduce the sequencing error. It has been proposed to condition on a minor allele count larger than one, resulting in a truncated allele frequency spectrum <xref rid="pone.0015925-Futschik1" ref-type="bibr">[22]</xref>. We performed computer simulations to evaluate whether this correction is sufficient. We simulated 400 chromosomes (100 kb each) with the ms software <xref rid="pone.0015925-Hudson1" ref-type="bibr">[20]</xref>. The simulated chromosomes were re-coded into DNA sequence data by using a <italic>D. melanogaster</italic> chromosome as template. Finally, we generated random reads from these chromosomes with a sequencing error of 0.1–1%. These reads were then fed into the analysis pipeline of PoPoolation and the variability estimators were calculated. Our simulations show that with low error rates of 0.1–0.2% a minor allele count of two is well suited for a coverage up to 100, while for higher coverage a minor allele count of three is needed. Nevertheless, for an error rate of 1%, even a minor allele count of three is insufficient.</p>
      <p>Alternatively, it is possible to reduce the sequencing error by incorporating adequate quality control measures such that even low frequency alleles could be reliably detected and quantified <xref rid="pone.0015925-Druley1" ref-type="bibr">[23]</xref>, <xref rid="pone.0015925-Out1" ref-type="bibr">[24]</xref>. We evaluated whether simple quality measures could lead to a sufficient reduction in the error rates of Illumina reads to make their use in pooling experiments feasible. We determined the influence of trimming on the error rate of 74 bp (base pairs) Illumina sequence reads using the PhiX control lane of a GAIIx with sequencing chemistry v 3. The error rate of unprocessed reads was about 1%. After trimming the PhiX reads with a quality cutoff of 20 the error rate was reduced by an order of magnitude to 0.15%. Further reductions in error rate were achieved by conditioning on a minimum sequence quality of every SNP (e.g.: 0.07% for a sequence quality of 20). Hence, simple quality control measures that do not discard a large fraction of the sequence reads (<xref ref-type="table" rid="pone-0015925-t001">Table 1</xref>) are sufficient to reduce the sequencing error to an extent that reliable population genetic analyses of pooled samples are possible with a minor allele count of two or three.</p>
      <p>In our computer simulations we assumed that all sequencing errors are independent. If sequencing errors are biased, the same error may be generated more frequently than assumed, leading to an inflated variability estimate. As this effect is difficult to simulate without knowing the exact bias, we decided to obtain an empirical error rate of pooled samples after using the quality control measures mentioned above: trimmed reads, sequencing quality, and minor allele count. We determined the efficiency of these measures by inferring the error rate (fraction of bases carrying at least one incorrectly identified SNP) in a pooling setting with different coverage. Please note that the definition of the error rate differs from the one used above to quantify the influence of trimming. <xref ref-type="fig" rid="pone-0015925-g003">Figure 3</xref> shows that without quality filtering and with a minor allele count of one, a very low read coverage results in an extremely high error rate. Introducing a minor allele count cutoff has a profound effect on the error rate. By conditioning on a minimum of two counts the error rate is reduced by at least one order of magnitude. Filtering for quality further reduces the error rate by a factor of about five. For coverage between 100 and 200 it is advised to increase the minor allele count to three. An even higher coverage needs a further minor allele count increase. These analyses demonstrate that after accounting for sequence quality and choosing an adequate minor allele count, the effective number of sequencing errors is low enough to allow for reliable polymorphism analysis in sequence pools.</p>
      <fig id="pone-0015925-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Sequencing errors in relation to coverage, minor allele count, and sequence quality.</title>
          <p>PhiX sequences (74 bp) generated with an Illumina GAIIx sequencer were analyzed for sequencing error rate (number of mutated bases after quality filtering). The gray bar indicates the presence of a polymorphic site in the PhiX sequence, which results in a minimum sequencing error rate.</p>
        </caption>
        <graphic xlink:href="pone.0015925.g003"/>
      </fig>
    </sec>
    <sec id="s2c">
      <title>Mapping errors</title>
      <p>Mapping of sequence reads from pooled data is a challenging task. The population pool may contain alleles with a different number of substitutions relative to the reference genome. Hence, if the mapping parameters are too stringent some of the reads may not be mapped. Contrary to the sequencing of a single genome, these unmapped reads may remain unnoticed, in particular if the highly diverged reads occur at a low frequency. Overly liberal mapping parameters, on the other hand, increase the chance that a read is incorrectly mapped. Given the central importance of mapping, we evaluated different mapping strategies and show that most of them introduce a systematic bias and subsequently are not well-suited for a population genetic analysis.</p>
      <p>While it is possible to test alignments with simulated reads, this strategy is restricted by the assumption that the simulations capture the pattern of variability observed in real sequences. The simulations may, for example, assume that polymorphisms are evenly distributed over the sequence and thereby ignore the fact that different parts of the genome have variable selective constraints. Hence, we did not rely on simulated reads to evaluate mapping parameters. Rather, we took advantage of paired-end reads from real pooling data and evaluated two aspects of mapping: 1) biased allele frequency estimates due to sequence divergence between reference and mapped reads and 2) mapping quality, i.e. incorrectly or unmapped reads.</p>
      <p>Allele frequency bias: In comparison to mapping with global alignment, the frequency of the reference allele was on average 3% higher when a local alignment was used. The bias towards the reference allele with local alignments has been described before <xref rid="pone.0015925-Degner1" ref-type="bibr">[25]</xref> and results from soft masking (i.e.: ignoring) the end of the read if a mismatch between reference and read is observed. Global alignments, however, aim to map the entire read. While this reduces the bias compared to local alignment mapping, some bias remains as highly diverged reads may not map at all. Hence, we also evaluated a mapping strategy which takes advantage of paired-end sequencing: the two reads of a pair are mapped individually using global alignment without a seed, and if only one of the two reads is mapped, the other one is aligned by local alignment. We will refer to this strategy as PE-SW-remap throughout the manuscript. Two thirds of the reads showed no difference and about 20% displayed a strong bias against the reference allele, suggesting a high frequency of highly diverged alleles. <xref ref-type="fig" rid="pone-0015925-g004">Figure 4</xref> provides such an example where PE-SW-remap allows mapping of several reads carrying multiple non-reference alleles.</p>
      <fig id="pone-0015925-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Improvement of the alignment for diverged regions using the PE-SW remap algorithm.</title>
          <p>IGV screenshot of the mapping of pooled sequence reads in a highly divergent region of <italic>D. melanogaster</italic>. The upper panel shows an alignment of the PE reads without the PE-SW remap and the lower panel shows the same region with the PE-SW remap.</p>
        </caption>
        <graphic xlink:href="pone.0015925.g004"/>
      </fig>
      <p>Mapping accuracy can be assessed via the number of correctly mapped paired-end reads. Improper spacing between the paired-end reads, mapping to two different chromosomes, mapping in the wrong direction and unmapped mates are indications of problems with mapping. As expected, the worst result was obtained when reads were mapped without allowing for gaps (<xref ref-type="table" rid="pone-0015925-t002">Table 2</xref>). We also noted that the use of a seed for mapping resulted in fewer mapped reads and more broken pairs. Allowing for a higher sequence divergence improved the mapping (i.e.: fewer broken pairs). PE-SW-remap obtained the best mapping results using a global alignment without seeds. <xref ref-type="fig" rid="pone-0015925-g004">Figure 4</xref> gives an example on how PE-SW-remap could improve the alignment.</p>
      <table-wrap id="pone-0015925-t002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of mapping strategies.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0015925-t002-2" xlink:href="pone.0015925.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">seed</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
                <td align="left" rowspan="1" colspan="1">No</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Max. # gap openings</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Max. # mismatches</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PE-SW-remap</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Mapped</td>
                <td align="left" rowspan="1" colspan="1">94.83</td>
                <td align="left" rowspan="1" colspan="1">93.78</td>
                <td align="left" rowspan="1" colspan="1">97.79</td>
                <td align="left" rowspan="1" colspan="1">97.59</td>
                <td align="left" rowspan="1" colspan="1">96.45</td>
                <td align="left" rowspan="1" colspan="1">99.25</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Proper pair</td>
                <td align="left" rowspan="1" colspan="1">89.66</td>
                <td align="left" rowspan="1" colspan="1">87.81</td>
                <td align="left" rowspan="1" colspan="1">95.10</td>
                <td align="left" rowspan="1" colspan="1">94.75</td>
                <td align="left" rowspan="1" colspan="1">92.57</td>
                <td align="left" rowspan="1" colspan="1">98.28</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Mate not mapped</td>
                <td align="left" rowspan="1" colspan="1">4.30</td>
                <td align="left" rowspan="1" colspan="1">5.16</td>
                <td align="left" rowspan="1" colspan="1">1.71</td>
                <td align="left" rowspan="1" colspan="1">1.90</td>
                <td align="left" rowspan="1" colspan="1">2.94</td>
                <td align="left" rowspan="1" colspan="1">0.24</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Mate mapped to wrong chromosome</td>
                <td align="left" rowspan="1" colspan="1">0.53</td>
                <td align="left" rowspan="1" colspan="1">0.50</td>
                <td align="left" rowspan="1" colspan="1">0.59</td>
                <td align="left" rowspan="1" colspan="1">0.58</td>
                <td align="left" rowspan="1" colspan="1">0.57</td>
                <td align="left" rowspan="1" colspan="1">0.46</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>30×10<sup>6</sup> paired-end reads were used for mapping. Long insertions and deletions with 12 bp were allowed for mapping strategies including gaps. If seeding was used, the seed length was 32 bp.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s2d">
      <title>Stochastic errors</title>
      <p>The accuracy of allele frequency estimates by sequencing of pooled individuals is highly dependent on the sequence coverage. If sequence coverage is low, it is better to obtain population estimators in a larger window to avoid incorrect estimates caused by stochastic error. PoPoolation provides the option to measure <italic>θ</italic>
<sub>Watterson</sub>, <italic>θ</italic>
<sub>π</sub> and Tajima's D in a sliding window analysis with a variable window size. To avoid an arbitrary window size choice and provide some analytical guidelines, we determined the joint effect of window size and coverage on the accuracy of <italic>θ</italic>
<sub>π</sub>. As expected, low coverage and small window sizes had a higher uncertainty (<xref ref-type="fig" rid="pone-0015925-g005">Figure 5</xref>). Nevertheless, 40-fold coverage in a 1 kb window produced highly reliable estimates, which suggests that this level of coverage is sufficient for a comparison of polymorphism among genes. Analyses requiring a reliable estimate for every SNP (which corresponds to SNP heterozygosity) require a much higher coverage. Even with 90-fold coverage, which was the highest level considered by us, we noted a considerable error.</p>
      <fig id="pone-0015925-g005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The influence of coverage and window size on the accuracy of the estimated <italic>θ</italic>
<sub>π</sub>.</title>
          <p>The accuracy was measured as the mean standardized difference between <italic>θ</italic>
<sub>π</sub> estimated for a given window size and its expectation.</p>
        </caption>
        <graphic xlink:href="pone.0015925.g005"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>Previous analyses showed that sequencing pooled DNA samples is a cost-effective approach to obtain genome-wide polymorphism data <xref rid="pone.0015925-Futschik1" ref-type="bibr">[22]</xref>. Here, we introduced PoPoolation, a software tool allowing a genome-wide polymorphism analysis using Next Generation Sequence reads. PoPoolation provides several options to retrieve polymorphism data for specific genomic regions of interest and allows this data to be displayed in FlyBase and the UCSC Genome Browser, thus linking polymorphism data with functional information.</p>
    <p>Our analysis of the 3R chromosome arm showed that the inferred distribution of polymorphism along the chromosome closely fits that inferred by sequencing short PCR products distributed along the chromosome in a small number of flies (≤12) from The Netherlands <xref rid="pone.0015925-Hutter1" ref-type="bibr">[21]</xref>. Shallow sequencing of several individuals from a North American and an African population with 454 reads also resulted in a high correlation of the polymorphism estimates in comparisons with Dutch or Zimbabwean populations <xref rid="pone.0015925-Sackton1" ref-type="bibr">[26]</xref>. Interestingly, the 454 data showed less polymorphism than the data from Hutter et al. (2007), while the pooling data in our study were more polymorphic than the corresponding loci from the Dutch population. Furthermore, <italic>θ</italic>
<sub>Watterson</sub> was higher than <italic>θ</italic>
<sub>π</sub> in our data set. Interestingly, increasing the minor allele count up to five did not change the overall pattern, the Portuguese population remained more variable than the Dutch population and <italic>θ</italic>
<sub>Watterson</sub> was still higher than <italic>θ</italic>
<sub>π</sub> (data not shown). These results clearly demonstrate that the strong fluctuations in variability along the chromosome reflect a biological feature that is conserved across populations, rather than an artifact of pooling. As the Portuguese population has not been studied before, it is possible that its higher variability reflects a true biological property of this population, but we cannot exclude the possibility that it is an artifact of the mapping. Furthermore, our data also shows how the pattern of variation in the 3R chromosome decreases towards the centromere and telomere. As the divergence between <italic>D. melanogaster</italic> and <italic>D. simulans</italic> does not follow this pattern, the drop in variability cannot be explained by mutation rate variation, but is attributed to selection <xref rid="pone.0015925-Charlesworth1" ref-type="bibr">[27]</xref>, <xref rid="pone.0015925-Begun1" ref-type="bibr">[28]</xref>.</p>
    <p>As a high sequencing error rate as well as erroneous mapping of reads could have inflated the variability estimate, we very carefully evaluated the sequencing error rate and mapping accuracy. Our results indicate that very simple quality control measures, such as trimming of reads and conditioning on a moderate sequence quality of 20 reduces the sequencing error by more than one order of magnitude to about 0.01%. The computer simulations indicated that for this sequencing error rate it is sufficient to condition on a minor allele count of two or three to obtain population genetic summary statistics that are close to the expectation. While all these results suggest that the variability estimators obtained in our pooling study have been correctly inferred, we cannot rule out that some sequencing and mapping errors affected our estimates. Nevertheless, the high correlation in variability estimates between sequencing of pooled individuals and Sanger sequencing indicates that the analysis of pooled samples correctly recovers heterogeneity in variability patterns across the genome. Hence, we anticipate that the analysis of pooled samples will become highly popular for the comparison of polymorphism patterns along the genome and between populations. Furthermore, experimental evolution studies will greatly benefit from sequencing pooled DNA samples to identify the spread of beneficial mutations in an outcrossing population. With PoPoolation we have provided a tool that allows users with limited bioinformatic skills to take advantage of Next Generation Sequencing of pooled DNA samples and to obtain genome-wide polymorphism patterns. We expect in the near future to also incorporate other statistics of interest for population genomics, like the McDonal-Kreitman test <xref rid="pone.0015925-McDonald1" ref-type="bibr">[29]</xref>, the HKA test <xref rid="pone.0015925-Hudson2" ref-type="bibr">[30]</xref> and tests for synonymous vs. non-synonymous polymorphisms.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>Materials and Methods</title>
    <sec id="s4a">
      <title>Fly samples</title>
      <p>113 isofemale lines of <italic>D. melanogaster</italic> were collected 2008 in Northern Portugal (Povoa de Varzim). The isofemale lines were kept in the laboratory for five generations and five females from every line were combined into a pool of flies for sequencing.</p>
    </sec>
    <sec id="s4b">
      <title>Sequencing</title>
      <p>Female flies were homogenized and DNA was extracted with the Qiagen DNeasy Blood and Tissue Kit (Qiagen, Hilden, Germany). We used the Genomic DNA Sample Preparation Kit (Illumina, San Diego, CA) to generate paired-end libraries. Five µg DNA were sheared with a nebulizer, and after end repair, A-tailing and ligation of paired-end adapters the library was size-selected on an agarose gel (300 bp) and amplified using 10 PCR cycles.</p>
      <p>Cluster amplification was performed using a Paired-End Cluster Generation Kit v2. Sequences were generated with the Illumina Sequencing Kits v3 on a Genome Analyzer IIx.</p>
      <p>Image analysis was performed with the Firecrest, Bustard and Gerald modules of the Illumina pipeline v. 1.4.</p>
    </sec>
    <sec id="s4c">
      <title>Mapping of reads</title>
      <p>For all analyses presented in this manuscript we used bwa <xref rid="pone.0015925-Li2" ref-type="bibr">[13]</xref> to map reads against the <italic>D. melanogaster</italic> (version 5.18) reference genome. Nevertheless, it is important to note that PoPoolation is based on the widely used SAM format allowing for the use of alternative mapping software provided that this software generates a SAM file.</p>
    </sec>
    <sec id="s4d">
      <title>Trimming statistics and error rates</title>
      <p>Sequencing errors are not evenly distributed along sequence reads <xref rid="pone.0015925-Dohm1" ref-type="bibr">[14]</xref>. The error rate increases with the position in the read. Additionally, the first base often has an elevated error rate. To account for this pattern of sequencing errors, we implemented a modified Mott algorithm from Phred (<ext-link ext-link-type="uri" xlink:href="http://www.phrap.org/phredphrap/phred.html">http://www.phrap.org/phredphrap/phred.html</ext-link>). This algorithm identifies the highest scoring substring of every read given a quality threshold and trims the read from either side until only bases of this substring are kept. In addition, the user can specify a minimum number of bases for each read to be kept in the data set.</p>
      <p>We used one lane of PhiX reads (14×10<sup>6</sup>) with a length of 74 bp and an error rate of 1.03% as estimated by the Illumina pipeline 1.4.0. The reads were trimmed with the script trim-fastq.pl using different quality thresholds (0, 10, 20, 30) and a minimum length of 50. The trimming statistic was generated using a custom Perl script. To calculate the error rates, reads that were trimmed with a quality threshold of 20 were mapped to the PhiX genome, filtered for a mapping quality of 20 and converted into a pileup file. The error rate for a given quality threshold was calculated as the number of mismatches meeting the quality requirement divided by all bases meeting the quality requirement.</p>
    </sec>
    <sec id="s4e">
      <title>Comparison of mapping algorithms</title>
      <p>Several strategies can be pursued to map reads. The most simple and fastest strategy specifies a sequence string (seed) that needs to be mapped against the reference with a specified maximum number of mismatches. The mapped seed is then extended, either using local or global alignment. Local alignment does not attempt to match the full read. This inevitably leads to the omission of SNPs, particularly at the ends of the read, causing a bias towards the character state in the reference genome. The global mapping strategy avoids this bias, but requires an a priori specification of the maximum number of inserted/deleted bases and an upper bound for the number of substitutions in the read. The limitation of this approach is that the success of the mapping depends on the correct specification of these mapping parameters. Irrespective of whether local or global alignments are used, the seed restricts the divergence of the read to the reference genome. Hence, an alternative mapping strategy avoids the use of seeds at the expense of computational speed. The third mapping option takes advantage of paired-end reads. Both reads are initially mapped separately, and if one read of the pair cannot be mapped it is aligned using a local alignment procedure (Smith-Waterman). Throughout the manuscript, we refer to this mapping strategy as PE-SW-remap.</p>
      <p>A single lane of <italic>D. melanogaster</italic> paired-end data was used (SRA023610.1). 36×10<sup>6</sup> 74 bp reads were trimmed with the script trim-fastq.pl using a quality threshold of 20 and a minimum length of 40. A total of 15098991 (84%) paired-end reads met the requirements. These reads were mapped to the <italic>D. melanogaster</italic> genome (version 5.18) using ‘bwa aln’ <xref rid="pone.0015925-Li2" ref-type="bibr">[13]</xref> with the following parameters: seeding of the reads (-l), the allowed error rate (-n), the number of gap openings (-o), and the Smith-Waterman alignment of the unmapped mate with ‘bwa sampe’. If not mentioned otherwise the gap length was set to 12 (-e and -d). The maximum allowed distance between reads was set to 500 bp. We used single reads to evaluate the bias towards the reference allele with local and global alignments, as bwa does not support local alignment of paired reads. The choice of the exact mapping parameters is highly dependent on the polymorphism pattern and levels in the target organism. Hence, we focused on the comparison of different strategies (algorithms) to map short reads, as these results could be generalized.</p>
    </sec>
    <sec id="s4f">
      <title>Estimating the number of false positive SNPs using PhiX</title>
      <p>We used one lane of PhiX reads (14×10<sup>6</sup>) with a length of 74 bp and an error rate of 1.03% as estimated by the Illumina Pipeline 1.4.0. The reads were trimmed with the script trim-fastq.pl using a quality threshold of 20 and a minimum length of 40. All trimmed reads were mapped to the reference genome of PhiX using ‘bwa aln’ <xref rid="pone.0015925-Li2" ref-type="bibr">[13]</xref> with the parameters ‘-o 2 -e 12 -n 0.01 -l 100 -d 12’. We did not attempt to match pairs, thus this analysis rests effectively on single reads. The mapping results were filtered for a mapping quality of 20 and converted into a fastq file. We randomly sampled reads from the resulting fastq file to obtain PhiX coverages of 10, 50, 100, 250, 500 and 1000 with different quality thresholds of 0, 10, 20 and 30. The randomly sampled reads were again mapped to the PhiX reference using ‘bwa aln’ <xref rid="pone.0015925-Li2" ref-type="bibr">[13]</xref> with the parameters ‘-o 2 -e 12 -n 0.01 -l 100 -d 12’. The mapping results were converted to pileup files with SAMtools <xref rid="pone.0015925-Li3" ref-type="bibr">[15]</xref>. SNPs were called from the pileup files with a custom script using different minor allele counts of 1, 2, 3 and different quality thresholds of 0, 10, 20 and 30.</p>
    </sec>
    <sec id="s4g">
      <title>Features implemented in PoPoolation</title>
      <p>The widely used population genetics parameters <italic>θ</italic>
<sub>Watterson</sub> and <inline-formula><inline-graphic xlink:href="pone.0015925.e001.jpg" mimetype="image"/></inline-formula> were designed for sequencing of individuals. We have implemented unbiased estimates for pooled samples with poolsize <inline-formula><inline-graphic xlink:href="pone.0015925.e002.jpg" mimetype="image"/></inline-formula> and coverage <inline-formula><inline-graphic xlink:href="pone.0015925.e003.jpg" mimetype="image"/></inline-formula>
<disp-formula><graphic xlink:href="pone.0015925.e004.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pone.0015925.e005.jpg" mimetype="image" position="float"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0015925.e006.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0015925.e007.jpg" mimetype="image"/></inline-formula> are modified versions of the classical <inline-formula><inline-graphic xlink:href="pone.0015925.e008.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0015925.e009.jpg" mimetype="image"/></inline-formula> that are only evaluated on SNPs with minimum allele count of <inline-formula><inline-graphic xlink:href="pone.0015925.e010.jpg" mimetype="image"/></inline-formula>.</p>
      <p>Furthermore, <inline-formula><inline-graphic xlink:href="pone.0015925.e011.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0015925.e012.jpg" mimetype="image"/></inline-formula> is the probability of having allele frequency <inline-formula><inline-graphic xlink:href="pone.0015925.e013.jpg" mimetype="image"/></inline-formula> among the reads given an allele frequency <inline-formula><inline-graphic xlink:href="pone.0015925.e014.jpg" mimetype="image"/></inline-formula> in the pool and <inline-formula><inline-graphic xlink:href="pone.0015925.e015.jpg" mimetype="image"/></inline-formula> is the probability that an allele has frequency <inline-formula><inline-graphic xlink:href="pone.0015925.e016.jpg" mimetype="image"/></inline-formula> in the pool.</p>
      <p>These two parameter estimators account for the truncated allele frequency spectrum (see below) and re-sequencing of the same chromosomes, as described in <xref rid="pone.0015925-Dohm1" ref-type="bibr">[14]</xref>.</p>
      <p>Tajima's D is a classic summary statistic characterizing deviations from the null model of a constant size population without selection <xref rid="pone.0015925-Tajima1" ref-type="bibr">[16]</xref>. PoPoolation uses a modified Tajima's D that accounts for the truncated allele frequency spectrum (see below) used for pooled data:<disp-formula><graphic xlink:href="pone.0015925.e017.jpg" mimetype="image" position="float"/></disp-formula>with<disp-formula><graphic xlink:href="pone.0015925.e018.jpg" mimetype="image" position="float"/></disp-formula>
<inline-formula><inline-graphic xlink:href="pone.0015925.e019.jpg" mimetype="image"/></inline-formula>, where <italic>θ</italic> is estimated by <inline-formula><inline-graphic xlink:href="pone.0015925.e020.jpg" mimetype="image"/></inline-formula> in the same window in which <inline-formula><inline-graphic xlink:href="pone.0015925.e021.jpg" mimetype="image"/></inline-formula> is calculated. Hereby we assume that all individuals contribute roughly equal amounts of DNA to the pool.</p>
      <p>To facilitate the interpretation of genome-wide polymorphism data, PoPoolation also calculates sequence divergence for closely related species pairs. For this purpose complete genomes are aligned with the MAUVE alignment software <xref rid="pone.0015925-Darling1" ref-type="bibr">[17]</xref> and sequence divergence is calculated.</p>
      <p><inline-formula><inline-graphic xlink:href="pone.0015925.e022.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0015925.e023.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0015925.e024.jpg" mimetype="image"/></inline-formula> and divergence are calculated for a specified DNA fragment of interest or for all aligned fragments of the genome. To analyze heterogeneity between different chromosomal regions, a sliding window analysis is used. PoPoolation allows the user to specify the window size as well as step size.</p>
      <p>PoPoolation generates a simple graphical overview of the polymorphism pattern along a chromosome (<xref ref-type="fig" rid="pone-0015925-g002">Figure 2</xref>). Furthermore, PoPoolation also produces a file in the wiggle format (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/goldenPath/help/wiggle.html">http://genome.ucsc.edu/goldenPath/help/wiggle.html</ext-link>) that can be loaded by the Integrative Genomics Viewer (<ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/igv/">http://www.broadinstitute.org/igv/</ext-link>). Alternatively, the wiggle file can be uploaded on the UCSC Genome Browser <xref rid="pone.0015925-Karolchik1" ref-type="bibr">[18]</xref> allowing the user to link population genetic analyses with the relevant genome annotation and other functional features. Because FlyBase <xref rid="pone.0015925-Tweedie1" ref-type="bibr">[19]</xref> does not accept wiggle files, PoPoolation generates a special output file that enables the polymorphism pattern to be linked with FlyBase.</p>
      <p>While the sequencing of pooled samples generates genome-wide polymorphism patterns, researchers are often only interested in one or a few genomic regions. PoPoolation provides the option to restrict the analysis to regions specified in a gene transfer format (GTF) input file (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/FAQ/FAQformat.html">http://genome.ucsc.edu/FAQ/FAQformat.html</ext-link>). Apart from polymorphism and divergence data, PoPoolation also supplies a table of polymorphic sites for the specified region. Alternatively, researchers may be interested in excluding specific regions from the analysis. Repetitive sequences, for example, are notoriously difficult to handle with Next Generation Sequencing reads. Hence, it is possible to use a gtf file to mask genomic regions containing repetitive sequences. Similarly, genomic regions with known structural variants can be also excluded.</p>
    </sec>
    <sec id="s4h">
      <title>Sensitivity of θ<sub>π</sub> to window size and coverage</title>
      <p>From a data set consisting of 212×10<sup>6</sup> reads generated from the Portuguese population that were mapped to the <italic>D. melanogaster</italic> genome (version 5.18) with ‘bwa aln’ and the parameters ‘-o 2 -e 12 -n 0.01 -l 100 -d 12’, we extracted 40×10<sup>6</sup> reads mapping to chromosome 3R (corresponding to ∼100-fold coverage). All reads with a minimum mapping quality of at least 20 were used as single read data and converted into a fastq file. From this fastq file, we randomly sampled reads to obtain a total coverage of 5, 10, 20, 30, 40, 50, 60, 70, 80 and 90 of chromosome 3R using a custom Perl script. The randomly sampled reads were mapped to chromosome 3R of <italic>D. melanogaster</italic> with ‘bwa aln’ and the parameters ‘-o 2 -e 12 -n 0.01 -l 100 -d 12’. Using a custom Perl script and the full data set, we identified 2000 SNPs (minor allele count = 4; minimum coverage = 8; minimum base quality = 20) on chromsome 3R, which are separated by at least 10,500 bp. Furthermore, we required that at least 90% of the 10,000 base pairs downstream of the SNP have a minimum coverage of 8 in the full data set. These high confidence SNPs were used to calculate <italic>θ</italic>
<sub>π</sub> for windows starting with the SNP. We calculated the difference in <italic>θ</italic>
<sub>π</sub> of the full data set to the respective values obtained using the reduced data set (for example coverage: 5, 10, 20 etc.) and standardized this difference by <italic>θ</italic>
<sub>π</sub> from the full data set. Note that this standardization accounts for the bias generated by conditioning each window to start with a SNP. The average over 2000 windows is reported in <xref ref-type="fig" rid="pone-0015925-g005">Figure 5</xref>. For SNPs other than the high confidence SNPs we required the following criteria: minor allele count &gt;1, a minimum coverage of 4 and a minimum base quality of 20.</p>
    </sec>
    <sec id="s4i">
      <title>Simulated reads</title>
      <p>We used ms <xref rid="pone.0015925-Hudson1" ref-type="bibr">[20]</xref> to generate five datasets assuming a <italic>θ</italic> of 5×10<sup>−3</sup>, which matches <italic>D. melanogaster</italic> data (ms 400 1 -seed 1 17 666 -t 500 -r 2500 100000). <italic>θ</italic>
<sub>Watterson</sub>, <italic>θ</italic>
<sub>π</sub>, and Tajima's D were determined with the sample_stats software included in the ms package <xref rid="pone.0015925-Hudson1" ref-type="bibr">[20]</xref>. The output of ms was converted to DNA sequences using ms2dna (<ext-link ext-link-type="uri" xlink:href="http://guanine.evolbio.mpg.de/cgi-bin/mlRho/mlRho.cgi.pl">http://guanine.evolbio.mpg.de/cgi-bin/mlRho/mlRho.cgi.pl</ext-link>) with the 3R chromosome of <italic>D. melanogaster</italic> (position 10,000,0000 to 10,100,000) as template sequence. Short sequence reads were generated with Sequencer (<ext-link ext-link-type="uri" xlink:href="http://guanine.evolbio.mpg.de/sequencer/">http://guanine.evolbio.mpg.de/sequencer/</ext-link>) with assumed error rates 0.1%, 0.2% and 1%, and targeted coverage 50×, 100× and 250×. The simulated reads were mapped with bwa (-o 2 -e 12 -n 0.01 -l 100 -d 12) and processed with PoPoolation. We measured the relative difference between the estimates obtained from PoPoolation (<italic>o</italic>) and the expected (<italic>e</italic>) results calculated with sample_stats from the ms package <xref rid="pone.0015925-Hudson1" ref-type="bibr">[20]</xref> using the original ms output. For each set of parameter combinations, we repeated this procedure five times (<italic>n</italic>). The averages of the relative differences (<inline-formula><inline-graphic xlink:href="pone.0015925.e025.jpg" mimetype="image"/></inline-formula>) are reported in <xref ref-type="table" rid="pone-0015925-t003">Table 3</xref> (<italic>θ</italic>
<sub>π</sub>) and the <xref ref-type="supplementary-material" rid="pone.0015925.s002">Table S2</xref> (<italic>θ</italic>
<sub>Watterson</sub> and Tajima's D).</p>
      <table-wrap id="pone-0015925-t003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0015925.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Effect of coverage and sequencing error rates on <italic>θ</italic>
<sub>π</sub>.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0015925-t003-3" xlink:href="pone.0015925.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Cov 50</td>
                <td align="left" rowspan="1" colspan="1">Cov 100</td>
                <td align="left" rowspan="1" colspan="1">Cov 250</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">minor allele count 1</td>
                <td align="left" rowspan="1" colspan="1">Error Rate 1%</td>
                <td align="left" rowspan="1" colspan="1">3.93</td>
                <td align="left" rowspan="1" colspan="1">3.94</td>
                <td align="left" rowspan="1" colspan="1">3.94</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.2%</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.1%</td>
                <td align="left" rowspan="1" colspan="1">0.41</td>
                <td align="left" rowspan="1" colspan="1">0.42</td>
                <td align="left" rowspan="1" colspan="1">0.42</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">minor allele count 2</td>
                <td align="left" rowspan="1" colspan="1">Error Rate 1%</td>
                <td align="left" rowspan="1" colspan="1">0.72</td>
                <td align="left" rowspan="1" colspan="1">1.36</td>
                <td align="left" rowspan="1" colspan="1">2.82</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.2%</td>
                <td align="left" rowspan="1" colspan="1">0.04</td>
                <td align="left" rowspan="1" colspan="1">0.08</td>
                <td align="left" rowspan="1" colspan="1">0.17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.1%</td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
                <td align="left" rowspan="1" colspan="1">0.03</td>
                <td align="left" rowspan="1" colspan="1">0.06</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">minor allele count 3</td>
                <td align="left" rowspan="1" colspan="1">Error Rate 1%</td>
                <td align="left" rowspan="1" colspan="1">0.093</td>
                <td align="left" rowspan="1" colspan="1">0.25</td>
                <td align="left" rowspan="1" colspan="1">1.12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.2%</td>
                <td align="left" rowspan="1" colspan="1">0.01</td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
                <td align="left" rowspan="1" colspan="1">0.03</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Error Rate 0.1%</td>
                <td align="left" rowspan="1" colspan="1">0.01</td>
                <td align="left" rowspan="1" colspan="1">0.01</td>
                <td align="left" rowspan="1" colspan="1">0.02</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>Average relative mean absolute deviation between the observed and expected value of <italic>θ</italic>
<sub>π</sub>. Expectations were obtained from ms (sample_stats) and compared to the observed value calculated with PoPoolation for three different coverage values and three different sequencing error rates. The observed <italic>θ</italic>
<sub>π</sub> was calculated assuming three different values of the minimum frequency of the alternative allele in the sequenced pool. Cov: Coverage.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0015925.s001">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Comparison of variability estimates for genomic fragments sequenced by traditional Sanger or by sequencing of pooled samples.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0015925.s001.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0015925.s002">
      <label>Table S2</label>
      <caption>
        <p><bold>Effect of coverage and sequencing error rates on Watterson's </bold><bold><italic>θ</italic></bold><bold> and Tajima's D.</bold> Sequences were submitted to the short read archive [SRA023610.1].</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0015925.s002.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are thankful to members of the institute for testing earlier versions of PoPoolation. Special thanks to A. Betancourt, C. Vogl and Raymond Tobler for helpful comments.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>This work has been supported by grants of the Austrian Science Funds (FWF) to Christian Schlötterer (P19467-B11). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0015925-Turner1">
      <label>1</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Turner</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Von Wettberg</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Nuzhdin</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Population resequencing reveals local adaptation of <italic>Arabidopsis lyrata</italic> to serpentine soils.</article-title>
        <source>Nat Genet</source>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Rubin1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubin</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meadows</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sherwood</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Whole-genome resequencing reveals loci under selection during chicken domestication.</article-title>
        <source>Nature</source>
        <volume>464</volume>
        <fpage>587</fpage>
        <lpage>591</lpage>
        <pub-id pub-id-type="pmid">20220755</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Li1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>
        <source>Genome Res</source>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Quinlan1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Stromberg</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Pyrobayes: an improved base caller for SNP discovery in pyrosequences.</article-title>
        <source>Nat Methods</source>
        <volume>5</volume>
        <fpage>179</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="pmid">18193056</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Koboldt1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wylie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Hu1">
      <label>6</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Prins</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>A Probabilistic Framework for Aligning Paired-end RNA-seq Data.</article-title>
        <source>Bioinformatics</source>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Trapnell1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>TopHat: discovering splice junctions with RNA-Seq.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Zhang1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Model-based analysis of ChIP-Seq (MACS).</article-title>
        <source>Genome Biol</source>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Rozowsky1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Euskirchen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Auerbach</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls.</article-title>
        <source>Nat Biotechnol</source>
        <volume>27</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">19122651</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Zerbino1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs.</article-title>
        <source>Genome Res</source>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Birol1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>JQ</given-names>
          </name>
          <name>
            <surname>Varhol</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>De novo transcriptome assembly with ABySS.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2872</fpage>
        <lpage>2877</lpage>
        <pub-id pub-id-type="pmid">19528083</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Haubold1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haubold</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pfaffelhuber</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>mlRho - a program for estimating the population mutation and recombination rates from shotgun-sequenced diploid genomes.</article-title>
        <source>Mol Ecol</source>
        <volume>19 </volume>
        <issue>Suppl 1</issue>
        <fpage>277</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="pmid">20331786</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Li2">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Dohm1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Li3">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>The Sequence Alignment/Map format and SAMtools.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Tajima1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tajima</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism.</article-title>
        <source>Genetics</source>
        <volume>123</volume>
        <fpage>585</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="pmid">2513255</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Darling1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements.</article-title>
        <source>Genome Res</source>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Karolchik1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>The UCSC Genome Browser.</article-title>
        <source>Curr Protoc Bioinformatics</source>
        <volume>Chapter 1: Unit1 4</volume>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Tweedie1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tweedie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Falls</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Leyland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McQuilton</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>FlyBase: enhancing Drosophila Gene Ontology annotations.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>37</volume>
        <fpage>D555</fpage>
        <lpage>559</lpage>
        <pub-id pub-id-type="pmid">18948289</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Hudson1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation.</article-title>
        <source>Bioinformatics</source>
        <volume>18</volume>
        <fpage>337</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="pmid">11847089</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Hutter1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hutter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beisswanger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>De Lorenzo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Distinctly different sex ratios in African and European populations of <italic>Drosophila melanogaster</italic> inferred from chromosomewide single nucleotide polymorphism data.</article-title>
        <source>Genetics</source>
        <volume>177</volume>
        <fpage>469</fpage>
        <lpage>480</lpage>
        <pub-id pub-id-type="pmid">17660560</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Futschik1">
      <label>22</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Futschik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schlötterer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Masively parallel sequencing of pooled samples-the next generation of molecular markers.</article-title>
        <source>Genetics in press</source>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Druley1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Druley</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Vallania</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Wegner</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Varley</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>Quantification of rare allelic variants from pooled genomic DNA.</article-title>
        <source>Nat Methods</source>
        <volume>6</volume>
        <fpage>263</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="pmid">19252504</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Out1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Out</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>van Minderhout</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Ariyurek</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ossowski</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>Deep sequencing to reveal new variants in pooled DNA samples.</article-title>
        <source>Hum Mutat</source>
        <volume>30</volume>
        <fpage>1703</fpage>
        <lpage>1712</lpage>
        <pub-id pub-id-type="pmid">19842214</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Degner1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Nkadori</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>3207</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="pmid">19808877</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Sackton1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sackton</surname>
            <given-names>TB</given-names>
          </name>
          <name>
            <surname>Kulathinal</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Dopman</surname>
            <given-names>EB</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>Population Genomic Inferences from Sparse High-Throughput Sequencing of Two Populations of Drosophila melanogaster.</article-title>
        <source>Genome Biol Evol</source>
        <volume>2009</volume>
        <fpage>449</fpage>
        <lpage>465</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Charlesworth1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charlesworth</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Charlesworth</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1993</year>
        <article-title>The effect of deleterious mutations on neutral molecular variation.</article-title>
        <source>Genetics</source>
        <volume>134</volume>
        <fpage>1289</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="pmid">8375663</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Begun1">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Begun</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Aquadro</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>Levels of naturally occurring DNA polymorphism correlate with recombination rates in <italic>D. melanogaster</italic>.</article-title>
        <source>Nature</source>
        <volume>356</volume>
        <fpage>519</fpage>
        <lpage>520</lpage>
        <pub-id pub-id-type="pmid">1560824</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-McDonald1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Kreitman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>1991</year>
        <article-title>Adaptive protein evolution at the Adh locus in Drosophila.</article-title>
        <source>Nature</source>
        <volume>351</volume>
        <fpage>652</fpage>
        <lpage>654</lpage>
        <pub-id pub-id-type="pmid">1904993</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0015925-Hudson2">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Kreitman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aguade</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>1987</year>
        <article-title>A test of neutral molecular evolution based on nucleotide data.</article-title>
        <source>Genetics</source>
        <volume>116</volume>
        <fpage>153</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="pmid">3110004</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
