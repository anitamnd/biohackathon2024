<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4848403</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw004</article-id>
    <article-id pub-id-type="publisher-id">btw004</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OEFinder: a user interface to identify and visualize ordering effects in single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Leng</surname>
          <given-names>Ning</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Choi</surname>
          <given-names>Jeea</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chu</surname>
          <given-names>Li-Fang</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomson</surname>
          <given-names>James A.</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>Ron</given-names>
        </name>
        <xref ref-type="aff" rid="btw004-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btw004-cor1">*</xref>
      </contrib>
      <aff id="btw004-aff1"><sup>1</sup>Morgridge Institute for Research, </aff>
      <aff id="btw004-aff2"><sup>2</sup>Department of Statistics, University of Wisconsin and </aff>
      <aff id="btw004-aff3"><sup>3</sup>Department of Biostatistics and Medical Informatics, University of Wisconsin, Madison, WI, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btw004-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw004-FN1">
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>06</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>9</issue>
    <fpage>1408</fpage>
    <lpage>1410</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>9</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> A recent article identified an artifact in multiple single-cell RNA-seq (scRNA-seq) datasets generated by the Fluidigm C1 platform. Specifically, Leng et al. showed significantly increased gene expression in cells captured from sites with small or large plate output IDs. We refer to this artifact as an ordering effect (OE). Including OE genes in downstream analyses could lead to biased results. To address this problem, we developed a statistical method and software called OEFinder to identify a sorted list of OE genes. OEFinder is available as an R package along with user-friendly graphical interface implementations which allows users to check for potential artifacts in scRNA-seq data generated by the Fluidigm C1 platform.</p>
      <p><bold>Availability and implementation:</bold> OEFinder is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lengning/OEFinder">https://github.com/lengning/OEFinder</ext-link></p>
      <p><bold>Contact:</bold><email>rstewart@morgridge.org</email> or <email>lengning1@gmail.com</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-seq (scRNA-seq) has led to important findings in many fields and is becoming increasingly popular in studies of transcriptome-wide expression (<xref rid="btw004-B2" ref-type="bibr">Deng <italic><italic><italic>et al</italic></italic></italic>., 2014</xref>; <xref rid="btw004-B3" ref-type="bibr">Leng <italic>et al</italic>., 2015</xref>; <xref rid="btw004-B4" ref-type="bibr">Shalek <italic><italic><italic>et al</italic></italic></italic>., 2014</xref>; <xref rid="btw004-B5" ref-type="bibr">Trapnell <italic>et al</italic>., 2014</xref>; <xref rid="btw004-B6" ref-type="bibr">Treutlein <italic>et al</italic>., 2014</xref>). To facilitate scRNA-seq, the majority of studies utilize the Fluidigm C1 platform for cell capture, reverse transcription and cDNA amplification, as this platform allows for rapid and reliable isolation and processing of individual cells. In spite of the advantages, <xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref> identified an artifact in multiple datasets generated by C1 and confirmed that the artifact was present in the cDNA processed by the C1 machine. In particular, in these datasets, there are genes showing higher expression in cells captured in specific capture sites. These capture sites are the ones with small or large plate output IDs. We refer to this artifact as an ordering effect (OE), which has been shown to be independent of organism and laboratory (<xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>., 2015</xref>). As detailed in <xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref>, accurate identification of OE genes is important to ensure unbiased downstream analyses.</p>
    <p><xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref> used an ANOVA-based approach to detect OE genes. The ANOVA-based approach performs well in many cases, but has reduced power when few cells are available. (Note that in empirical data, the cells can be missed owing to the random effects of capture failure—an empty capture site, or doublets—capturing more than one cells in one capture site.) To improve power for identifying OE genes, we developed an approach, OEFinder, based on orthogonal polynomial regression. Results show that OEFinder is less sensitive to sample size and outperforms the ANOVA-based approach when few cells are available.</p>
    <p>OEFinder is implemented in R, a free and open source language, with a vignette that provides working examples. The graphical user interface (GUI) implementations of OEFinder allow users with little computing background to easily identify and characterize OE genes in scRNA-seq data (<xref ref-type="fig" rid="btw004-F1">Fig. 1a</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Fig. S4</ext-link>).
<fig id="btw004-F1" orientation="portrait" position="float"><label>Fig. 1</label><caption><p>(<bold>a</bold>) OEFinder GUI for identifying OE genes (shown is implementation using R/RGtk2 package; an implementation using R/shiny package is also available, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Fig. S4</ext-link>). (<bold>b</bold>, <bold>c</bold>) Operating characteristics in simulated datasets. The <italic>x</italic>-axes show the number of available cells. The <italic>y</italic>-axis shows TPR and FDR. (<bold>d</bold>, <bold>e</bold>) The OE genes identified in the first experiment of Trapnell <italic>et al.</italic> data and Leng <italic>et al.</italic> data, respectively. The cells were ordered following the capture site ID. The <italic>y</italic>-axis shows scaled gene expression (<italic>z</italic>-score). Each line represents one OE gene</p></caption><graphic xlink:href="btw004f1p"/></fig>
</p>
  </sec>
  <sec>
    <title>2 Analysis input and output</title>
    <sec>
      <title>2.1 Input</title>
      <sec>
        <title>2.1.1 Expression estimates</title>
        <p>OEFinder requires a genes-by-cells expression matrix. The expression matrix can be either normalized or unnormalized. If the input matrix is unnormalized, OEFinder applies the Median-by-Ratio normalization method introduced by <xref rid="btw004-B1" ref-type="bibr">Anders and Huber (2010)</xref> prior to OE detection.</p>
      </sec>
      <sec>
        <title>2.1.2 Capture site group definitions</title>
        <p>As detailed in <xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref>, the capture sites are labeled as A01,…, A12, B01,…, B12,…, H01,…, H12. If the capture site IDs are provided, OEFinder groups cells from sites with the same starting letters. When the capture site information is not available, OEFinder groups cells based on their input order. By default, OEFinder groups cells into eight even-sized groups. The number of groups may be changed by the user.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Method</title>
      <p>The normalized expression values of each gene are scaled to <italic>z</italic>-scores. For each gene, OEFinder applies an orthogonal polynomial regression on <italic>z</italic>-scores against group code. To infer whether gene <italic>g</italic> follows the OE trend, OEFinder calculates the <italic>P</italic>-value <italic>p<sub>g</sub></italic><sub>,2</sub> of a one-tailed test that tests whether the coefficient of the quadratic term is positive. To account for the goodness of the spline fitting, OEFinder defines an aggregate statistics <italic>S<sub>g</sub></italic> as −log(<italic>p<sub>g</sub></italic><sub>,2</sub>) − log(<italic>p<sub>model</sub></italic>), in which <italic>p<sub>model</sub></italic> denotes the <italic>F</italic> test <italic>P</italic>-value of the full model. OEFinder then generates 10 000 simulated genes from permuted data to evaluate the significance of the observed aggregated statistics. By default, genes with permutation <italic>P</italic>-value &lt;0.01 are identified as OE genes. The number of simulated genes and the <italic>P</italic>-value cutoff may be changed by a user (for further details, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Section S2</ext-link>).</p>
    </sec>
    <sec>
      <title>2.3 Output</title>
      <sec>
        <title>2.3.1 List of OE genes</title>
        <p>OEFinder outputs two.csv files - one contains a sorted list of OE genes and the other contains p-values for all genes.</p>
      </sec>
      <sec>
        <title>2.3.2 Expression matrix for downstream analysis</title>
        <p>OEFinder outputs a normalized expression matrix that can be directly input to downstream analyses. The user has the option to choose either removal of the OE genes, or imputation of the OE genes with adjusted values.</p>
      </sec>
      <sec>
        <title>2.3.3 Visualization of OE genes</title>
        <p>OEFinder generates a .pdf file contains expression plots of the top <italic>N</italic> OE genes, where <italic>N</italic> is user specified. An example is shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Fig. S1</ext-link>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Evaluations</title>
    <sec>
      <title>3.1 Simulation studies</title>
      <p>We conducted eight simulation studies to evaluate the performance of the OE detection algorithms. In each simulation, we generated 5000 expressed genes with 500 OE genes. Expression of OE genes was generated based on expression profiles of OE genes detected in empirical data. (Details of the simulations may be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Section S3</ext-link>.) The eight simulation studies evaluate cases with varying numbers of available cells (20–90 cells). Each simulation study contains 100 repeated simulations.</p>
      <p><xref ref-type="fig" rid="btw004-F1">Figure 1b and c</xref> shows the true positive rate (TPR) and false positive rate (FDR) comparing the ANOVA-based method introduced in <xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref> and OEFinder. Results indicate that &gt;60 cells are available, both methods have TPR &gt;90% while FDR is controlled &lt;10%. When fewer cells are available, OEFinder has a higher TPR than the ANOVA-based approach and the FDR is still well controlled. The improved power in OEFinder is likely because the polynomial regression in OEFinder fits the OE trend more specifically than the ANOVA-based approach. Additional simulation results may be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Section S4</ext-link>.</p>
    </sec>
    <sec>
      <title>3.2 Case studies</title>
      <p>We applied OEFinder on two publicly available datasets with capture site ID information. <xref rid="btw004-B5" ref-type="bibr">Trapnell <italic>et al</italic>. (2014)</xref> data and <xref rid="btw004-B3" ref-type="bibr">Leng <italic><italic><italic>et al</italic></italic></italic>. (2015)</xref> data contain four and three experiments, respectively. <xref ref-type="fig" rid="btw004-F1">Figure 1d</xref> and <xref ref-type="fig" rid="btw004-F1">e</xref> shows 187 and 451 OE genes identified in the first experiment of each dataset. Genes detected by OEFinder show a clear OE pattern. Results of other experiments may be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw004/-/DC1">Supplementary Section S5</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We developed an R package OEFinder which can robustly detect OE genes in scRNA data generated by the Fluidigm C1 platform. OEFinder provides user-friendly graphical interface implementations that facilitate use by investigators.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was funded in part by <award-id>GM102756</award-id>, <award-id>4UH3TR000506</award-id>, <award-id>5U01HL099773</award-id>, <award-id>U54 AI117924</award-id>
<funding-source>Charlotte Geyer Foundation and Morgridge Institute for Research</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_9_1408__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw004_OEFinder_supplement.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btw004-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btw004-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>Q.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>. <source>Science</source>, <volume>343</volume>, <fpage>193</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">24408435</pub-id></mixed-citation>
    </ref>
    <ref id="btw004-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leng</surname><given-names>N.</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Oscope: a pipeline for identifying oscillatory genes in unsynchronized single cell RNA-seq experiments</article-title>. <source>Nat. Methods</source>
<volume>12</volume>, <fpage>947</fpage>–<lpage>950</lpage>.<pub-id pub-id-type="pmid">26301841</pub-id></mixed-citation>
    </ref>
    <ref id="btw004-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shalek</surname><given-names>A.K.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>. <source>Nature</source>, <volume>510</volume>, <fpage>363</fpage>–<lpage>369</lpage>.<pub-id pub-id-type="pmid">24919153</pub-id></mixed-citation>
    </ref>
    <ref id="btw004-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btw004-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>, <volume>509</volume>, <fpage>371</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
