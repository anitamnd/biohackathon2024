<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3532078</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-13-216</article-id>
    <article-id pub-id-type="pmid">22928840</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-13-216</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>GenNon-h</monospace>: Generating multiple sequence alignments on nonhomogeneous phylogenetic trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Kedzierska</surname>
          <given-names>Anna M</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>anna.kedzierska@upc.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Casanellas</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>marta.casanellas@upc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Centre for Genomic Regulation, Dr. Aiguader 88, 08003 Barcelona, Spain</aff>
    <aff id="I2"><label>2</label>Departament de Matemàtica Aplicada I, ETSEIB, Universitat Politècnica de Catalunya, Avinguda Diagonal 647, 08028 Barcelona, Spain</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>8</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>216</fpage>
    <lpage>216</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>8</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Kedzierska and Casanellas; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Kedzierska and Casanellas; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/13/216"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>A number of software packages are available to generate DNA multiple sequence alignments (MSAs) evolved under continuous-time Markov processes on phylogenetic trees. On the other hand, methods of simulating the DNA MSA directly from the transition matrices do not exist. Moreover, existing software restricts to the time-reversible models and it is not optimized to generate nonhomogeneous data (i.e. placing distinct substitution rates at different lineages).</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present the first package designed to generate MSAs evolving under discrete-time Markov processes on phylogenetic trees, directly from probability substitution matrices. Based on the input model and a phylogenetic tree in the Newick format (with branch lengths measured as the expected number of substitutions per site), the algorithm produces DNA alignments of desired length. <monospace>GenNon-h</monospace> is publicly available for download.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The software presented here is an efficient tool to generate DNA MSAs on a given phylogenetic tree. <monospace>GenNon-h</monospace> provides the user with the nonstationary or nonhomogeneous phylogenetic data that is well suited for testing complex biological hypotheses, exploring the limits of the reconstruction algorithms and their robustness to such models.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The package <monospace>GenNon-h</monospace> presented here simulates DNA sequences evolving on a given phylogenetic tree directly from the transition matrices. In other words, the goal of developing <monospace>GenNon-h</monospace> was to generate DNA sequences following <italic>discrete-time</italic> Markov models on a given phylogenetic tree (with assigned branch lengths measured as the expected number of substitutions per site). Given a phylogenetic tree <italic>T</italic>, the parameters of these models are the root distribution and the substitution matrices <italic>P</italic><sub><italic>e</italic></sub> assigned to each edge <italic>e</italic> of <italic>T</italic>. The entries of <italic>P</italic><sub><italic>e</italic></sub> correspond to the conditional probabilities <italic>P</italic>(<italic>x</italic>|<italic>y</italic><italic>e</italic>) that a nucleotide <italic>y</italic> at the parent node of <italic>e</italic> is substituted by nucleotide <italic>x</italic> at the child node (we refer to
[<xref ref-type="bibr" rid="B1">1, chapter 8</xref>] for an introduction to these type of Markov processes). There is no extra restriction on these matrices, in contrast to <italic>continuous-time</italic> processes, where the substitution matrices are the exponential of a rate matrix <italic>Q</italic> multiplied by the number of events. Whereas generating matrices of type <italic>exp</italic>(<italic>tQ</italic>) with a preassigned number of substitutions (branch length) is relatively easy, the task of generating (discrete-time) Markov matrices with a preassigned expected number of substitutions per site has been recently solved in
[<xref ref-type="bibr" rid="B2">2</xref>]. The software <monospace>GenNon-h</monospace> is implemented for the (discrete-time) Jukes-Cantor <monospace>JC69</monospace>, Kimura two <monospace>K80</monospace> and three <monospace>K81</monospace> parameters, strand symmetric <monospace>SSM</monospace>, and general Markov models <monospace>GMM</monospace>.</p>
    <p>The shape of the substitution matrices (in all cases sum of rows is equal to 1 and the entries are nonnegative) for <monospace>JC69</monospace>, <monospace>K80</monospace>, <monospace>K81</monospace>, <monospace>SSM</monospace> and <monospace>GMM</monospace> models is given by: </p>
    <p>
      <disp-formula>
        <mml:math id="M1" name="1471-2105-13-216-i1" overflow="scroll">
          <mml:mrow>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:mtable class="array" columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="1em"/>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:mtable class="array" columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="1em"/>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:mtable class="array" columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>
      <disp-formula>
        <mml:math id="M2" name="1471-2105-13-216-i2" overflow="scroll">
          <mml:mrow>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:mtable class="array" columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>e</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>f</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>g</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>h</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>h</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>g</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>f</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>e</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="1em"/>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:mtable class="array" columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>c</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>d</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>e</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>f</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>g</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>h</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>i</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>j</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>k</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>l</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>m</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>n</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>o</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>p</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mi>.</mml:mi>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p> For these models, the algorithms given in
[<xref ref-type="bibr" rid="B2">2</xref>] can generate any stochastic matrix corresponding to a given branch length (except for the general Markov model, where the algorithms cover a dense set of matrices that is not proved to be complete). We refer the reader to
[<xref ref-type="bibr" rid="B2">2</xref>] for more details and references of these models.</p>
    <p>In the continuous-time models, the process is often assumed to be <italic>homogeneous</italic> (with the same rates of substitutions in all lineages) and the rate matrix <italic>Q</italic> is common throughout the entire tree. This is not an implicit hypothesis for the discrete-time Markov processes, thus the evolutionary processes simulated using <monospace>GenNon-h</monospace> are nonhomogeneous. Although a variety of methods exist for simulating alignments under the continuous-time models (see for example <monospace>Rose</monospace>[<xref ref-type="bibr" rid="B3">3</xref>], <monospace>Seq-Gen</monospace>[<xref ref-type="bibr" rid="B4">4</xref>], and <monospace>Evolver</monospace> in <monospace>PAML</monospace>[<xref ref-type="bibr" rid="B5">5</xref>]), we provide the first software for generating multiple sequence alignments evolving under the discrete-time Markov processes on trees.</p>
    <p>Other powerful software include the Bayesian phylogenetic methods of
[<xref ref-type="bibr" rid="B6">6</xref>] and
[<xref ref-type="bibr" rid="B7">7</xref>]. <monospace>MRBAYES</monospace>[<xref ref-type="bibr" rid="B6">6</xref>] is a robust inference and model selection method, which provides a variety of tools for nucleotide and amino-acid data analysis. <monospace>BEAST</monospace>[<xref ref-type="bibr" rid="B7">7</xref>] enables to generate MSA with rate matrices differing at distinct edges. However, both packages are based on the rate-based continuous-time models for nucleotide data and as such, assume the exponential form of the substitution matrices. This in turn restricts the space of possible matrices assigned to a given edge length. <monospace>GenNon-h</monospace>, which aims to explore the space of all matrices, mimics the stochastic character of evolution as attempted to be captured by mathematical models. <monospace>GenNon-h</monospace> is the first software tailored specifically for the purpose of generating the DNA sequence alignments evolving on phylogenetic trees under the nonhomogeneous models. <monospace>GenNon-h</monospace> does not aim to replace the existing methods, but to serve as an option for researchers, whose interest lies in testing the performance of the algorithms on data generated under the assumption of more general models. A newly created software <monospace>Empar</monospace> (
<ext-link ext-link-type="uri" xlink:href="http://genome.crg.es/cgi-bin/phylo_mod_sel/Empar.pl">http://genome.crg.es/cgi-bin/phylo_mod_sel/Empar.pl</ext-link>,
[<xref ref-type="bibr" rid="B8">8</xref>]), enables to infer the parameters of the model considered in this work.</p>
    <p>It is worth pointing out that the strand symmetric model and the general Markov model considered in <monospace>GenNon-h</monospace> do not lie in the class of stationary models, which adds to the flexibility of the framework presented here. As a comparison, we note that the software packages that are prevalently in use consider only stationary and time-reversible models. This is due to the fact that the continuous-time models require computing exponentials of rate matrices, which is a nontrivial task for a general matrix. This contributes to the practice of using the time-reversible rate-based models irrespective of the setting under consideration.</p>
    <p>As shown in
[<xref ref-type="bibr" rid="B9">9</xref>], the substitution parameters for the <monospace>GMM</monospace> model (and thus for all its submodels), are identifiable up to permutation. In <monospace>GenNon-h</monospace> we fabricate matrices of the <italic>Diagonal Largest in Column</italic> (<italic>DLC</italic>) type
[<xref ref-type="bibr" rid="B10">10</xref>], whenever possible, i.e. matrices whose largest entry in every column is placed on the diagonal. <italic>DLC</italic> matrices share an important feature of being identifiable– there exists a unique set of substitution matrices satisfying the <italic>DLC</italic> condition and a unique root distribution that leads to the given joint distribution at the leaves. In other words, the data generated from the <italic>DLC</italic> matrices and sufficient alignment lengths have high likelihood of being identifiable and therefore can be safely used to test hypotheses about the tree or the data.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p><monospace>GenNon-h</monospace> has been implemented in C++. Its input is a tree in the Newick format (rooted or unrooted, with nodes of any degree) with annotated branch lengths. Other arguments include the base name of the output files, length of the alignment and a model. An exemplary command-line input is: </p>
    <p> ./GenNon-h treefilename outputfilename length modelname</p>
    <p>For instance, if ‘tree.txt’ is a text file consisting a Newick 5-taxon phylogenetic tree: </p>
    <p> ((species1:0.01,species2:0.2,species3:0.3):0.5,species4:0.4,species5:0.7),</p>
    <p>then the following command line input </p>
    <p> ./GenNon-h tree.txt data.fa 10000 k81</p>
    <p>generates a MSA of length 10,000nt evolving on the tree given in ‘ tree.txt’ under the <monospace>K81</monospace> model. The result is recorded it in the file ‘data.fa’.</p>
    <p>The algorithm proceeds as follows: </p>
    <p>Input: a discrete-time Markov model
<inline-formula><mml:math id="M3" name="1471-2105-13-216-i3" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>, a phylogenetic tree
<inline-formula><mml:math id="M4" name="1471-2105-13-216-i4" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula> with assigned branch lengths in the Newick format, and an alignment length <italic>L</italic>;</p>
    <p>Step 1: generate a DNA sequence <italic>s</italic><sub>0</sub>of length <italic>L</italic> at the root of
<inline-formula><mml:math id="M5" name="1471-2105-13-216-i5" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula> according to distribution of the model
<inline-formula><mml:math id="M6" name="1471-2105-13-216-i6" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula>;</p>
    <p>Step 2: for each edge <italic>e</italic> in
<inline-formula><mml:math id="M7" name="1471-2105-13-216-i7" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>, using
[<xref ref-type="bibr" rid="B2">2</xref>], we generate a matrix <italic>P</italic><sub><italic>e </italic></sub>of the type
<inline-formula><mml:math id="M8" name="1471-2105-13-216-i8" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow></mml:math></inline-formula> corresponding to the length <italic>l</italic><sub><italic>e </italic></sub>of edge <italic>e</italic> (i.e. a matrix <italic>P</italic><sub><italic>e </italic></sub>such that
<inline-formula><mml:math id="M9" name="1471-2105-13-216-i9" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mtext>det</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>). If the resulting matrix is not <italic>DLC</italic>, we apply a permutation of rows to convert it to a <italic>DLC</italic> matrix. Every model has a set of permutations allowable, such that the form of the matrix dictated by the model is maintained. If neither of the permutations creates a DLC matrix, we generate a new matrix <italic>P</italic><sub><italic>e </italic></sub>and repeat the procedure. We limited the number of trials to 1000 before the simulations require a re-start, however, in practice a <italic>DLC</italic> matrix is expected to be found in much fewer iterations;</p>
    <p>Step 3: we let <italic>s</italic><sub>0</sub> evolve according to the corresponding Markov process on
<inline-formula><mml:math id="M10" name="1471-2105-13-216-i10" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>;</p>
    <p>Output: a multiple sequence alignment and the substitution matrices used for its simulation.</p>
    <p>The output files constitute both a fasta file with a multiple sequence alignment simulated on
<inline-formula><mml:math id="M11" name="1471-2105-13-216-i11" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>, and a file listing the parameters used for the simulations of the data. The order of the output matrices corresponds to the order in which the branches of the Newick tree are read: terminal edges are put first, followed by the top-down listing of the edges starting at the root (see package README for detailed information).</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>The C++ implementation of <monospace>GenNon-h</monospace> can be accessed at the project home page
<ext-link ext-link-type="uri" xlink:href="http://genome.crg.es/cgi-bin/phylo_mod_sel/AlgGenNonH.pl">http://genome.crg.es/cgi-bin/phylo_mod_sel/AlgGenNonH.pl</ext-link>, at Sourceforge, or in the Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref> accompanying this paper. The algorithm has been successfully used in
[<xref ref-type="bibr" rid="B11">11</xref>] to test a new model selection method based on 4 and 6-taxon DNA multiple sequence alignments. The size of the tree is not a limiting factor to the use of the code as the execution time grows linearly in the number of taxa, thus the method can be used to generate data of any size.</p>
    <p>In order to test the speed of <monospace>GenNon-h</monospace>, we investigated the times it took to generate 100 alignments of 1,000nt on the following 5-taxa tree ((<italic>seq</italic>1:0.01,<italic>seq</italic>2:0.2,<italic>seq</italic>3:0.3):0.5,<italic>seq</italic>4:0.4,<italic>seq</italic>5:0.7). The results are given in Table
<xref ref-type="table" rid="T1">1</xref>.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>
          <monospace>
            <bold>GenNon-h</bold>
          </monospace>
          <bold>: time to generate 100 alignments of length 1,000bp on a 5-taxon tree on a Macintosh 2.4 GHz Intel Core 2 Duo with 4GB</bold>
        </p>
      </caption>
      <table frame="hsides" rules="groups" border="1">
        <colgroup>
          <col align="left"/>
          <col align="center"/>
          <col align="center"/>
          <col align="center"/>
          <col align="center"/>
          <col align="center"/>
        </colgroup>
        <thead valign="top">
          <tr>
            <th align="left">
              <bold>Model</bold>
            </th>
            <th align="center">
              <monospace>JC69</monospace>
            </th>
            <th align="center">
              <monospace>K80</monospace>
            </th>
            <th align="center">
              <monospace>K81</monospace>
            </th>
            <th align="center">
              <monospace>SSM</monospace>
            </th>
            <th align="center">
              <monospace>GMM</monospace>
            </th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td align="left">Time</td>
            <td align="center">2.6s</td>
            <td align="center">2.6s</td>
            <td align="center">2.5s</td>
            <td align="center">2.6s</td>
            <td align="center">3.0s</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The simulated data saved in the output files together with the parameters used for its simulation are suited for hypothesis testing in a variety of biological applications.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p><monospace>GenNon-h</monospace> is the first software simulating DNA sequences directly from the transition matrices computed from the branch lengths of a given phylogenetic tree. It implements discrete-time Markov processes on phylogenetic trees on any number of taxa. In the current release the support was given to the most well-known discrete-time Markov models: the Jukes-Cantor, Kimura 2 and 3 parameters, strand symmetric and general Markov models.</p>
    <p>The possibility of generating nonhomogeneous (for any of the models above) or nonstationary (for the <monospace>SSM</monospace> or <monospace>GMM</monospace> models) processes makes the method particularly appealing when handling complex biological questions.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: <monospace>GenNon-h</monospace></p>
    <p><bold>Project home page</bold>:
<ext-link ext-link-type="uri" xlink:href="http://genome.crg.es/cgi-bin/phylo_mod_sel/AlgGenNonH.pl">http://genome.crg.es/cgi-bin/phylo_mod_sel/AlgGenNonH.pl</ext-link>; also available from SourceForge
<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/gennonh/">https://sourceforge.net/projects/gennonh/</ext-link>, and as Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref></p>
    <p><bold>Operating systems</bold>: Platform independent</p>
    <p><bold>Programming language</bold>: C++</p>
    <p><bold>Other requirements</bold>: GNU gcc compiler, version 1.47.0 of the boost library (
<ext-link ext-link-type="uri" xlink:href="http://www.boost.org/">http://www.boost.org/</ext-link>)</p>
    <p><bold>Distributed under</bold> the GNU General Public License</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p><monospace>JC69</monospace>: discrete-time Jukes-Cantor model; <monospace>K80</monospace>: discrete-time Kimura 2-parameter model; <monospace>K81</monospace>: discrete-time Kimura 3-parameter model; <monospace>SSM</monospace>: strand symmetric model; <monospace>GMM</monospace>: general Markov model.</p>
  </sec>
  <sec>
    <title>Competing interest</title>
    <p>Both authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Author’s contributions</title>
    <p>AK created and tested the software, established a platform for its usage and drafted part of the manuscript. MC conceived of the project and drafted part of the manuscript. Both authors read and approved the final manuscript and declare no conflicts of interests.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>
          <bold>Is a zipped (extension .zip) file containing the C++ implementation of </bold>
          <monospace>
            <bold>GenNon-h.</bold>
          </monospace>
        </p>
      </caption>
      <media xlink:href="1471-2105-13-216-S1.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>Both authors were partially supported by Generalitat de Catalunya, 2009 SGR 1284. MC is partially supported by Ministerio de Educación y Ciencia MTM2009-14163-C02-02.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="book">
        <name>
          <surname>Semple</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Steel</surname>
          <given-names>M</given-names>
        </name>
        <source>Phylogenetics, Volume 24 of Oxford Lecture Series in Mathematics and its Applications</source>
        <year>2003</year>
        <publisher-name>Oxford: Oxford University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="other">
        <name>
          <surname>Casanellas</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kedzierska</surname>
          <given-names>AM</given-names>
        </name>
        <source>Generating Markov evolutionary matrices for a given branch length</source>
        <year>2011</year>
        <comment>Preprint, <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1112.3529">http://arxiv.org/abs/1112.3529</ext-link></comment>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stoye</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Evers</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>F</given-names>
        </name>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.2.157</pub-id>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Grassly</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Seq-Gen: An application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>
        <source>Comput. Appl. Biosci</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="pmid">9183526</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>PAML: A program package for phylogenetic analysis by maximum likelihood</article-title>
        <source>CABIOS</source>
        <year>1997</year>
        <volume>15</volume>
        <fpage>555</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="pmid">9367129</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ronquist</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Huelsenbeck</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>MRBAYES 3: Bayesian phylogenetic inference under mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1572</fpage>
        <lpage>1574</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg180</pub-id>
        <pub-id pub-id-type="pmid">12912839</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Xie</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Bayesian phylogenetics with BEAUti and the BEAST 1.7</article-title>
        <source>MBE</source>
        <year>2012</year>
        <comment>in press</comment>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="other">
        <name>
          <surname>Kedzierska</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Casanellas</surname>
          <given-names>M</given-names>
        </name>
        <source>Empar: EM-based algorithm for parameter estimation of Markov models on trees</source>
        <year>2012</year>
        <comment>Preprint, <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1207.1236">http://arxiv.org/abs/1207.1236</ext-link></comment>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Allman</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Rhodes</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Phylogenetic invariants for the general Markov model of sequence mutation</article-title>
        <source>Math. Biosci</source>
        <year>2003</year>
        <volume>186</volume>
        <issue>2</issue>
        <fpage>113</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mbs.2003.08.004</pub-id>
        <pub-id pub-id-type="pmid">14583169</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chang</surname>
          <given-names>JT</given-names>
        </name>
        <article-title>Full reconstruction of Markov models on evolutionary trees: identifiability and consistency</article-title>
        <source>Math. Biosci</source>
        <year>1996</year>
        <volume>137</volume>
        <fpage>51</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/S0025-5564(96)00075-2</pub-id>
        <pub-id pub-id-type="pmid">8854662</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kedzierska</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Drton</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Guigó</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Casanellas</surname>
          <given-names>M</given-names>
        </name>
        <article-title>SPIn: model selection for phylogenetic mixtures via linear invariants</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>929</fpage>
        <lpage>937</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr259</pub-id>
        <pub-id pub-id-type="pmid">22009060</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
