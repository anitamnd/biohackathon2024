<?properties open_access?>
<?subarticle pone.0231446.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7145015</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-17279</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Multivariate Analysis</subject>
              <subj-group>
                <subject>Principal Component Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Multivariate Analysis</subject>
                <subj-group>
                  <subject>Principal Component Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Colorectal Cancer</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Bioassays and Physiological Analysis</subject>
          <subj-group>
            <subject>Microarrays</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Linear Algebra</subject>
              <subj-group>
                <subject>Vector Spaces</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Linear Algebra</subject>
              <subj-group>
                <subject>Singular Value Decomposition</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Blind estimation and correction of microarray batch effect</article-title>
      <alt-title alt-title-type="running-head">Blind microarray batch correction</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4096-4782</contrib-id>
        <name>
          <surname>Varma</surname>
          <given-names>Sudhir</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>HiThru Analytics, HiThru Analytics LLC, Princeton, NJ, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Helms</surname>
          <given-names>Volkhard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universitat des Saarlandes, GERMANY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The author (SV) does contract statistical analysis under the business name of “HiThru Analytics LLC”. Currently he is working as a contractor, part time with the National Institutes of Health (Bethesda MD) and part time with Tridiuum Inc. (Philadelphia PA). This does not alter our adherence to PLOS ONE policies on sharing data and materials.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sudhir.varma@hithru.com</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>4</issue>
    <elocation-id>e0231446</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Sudhir Varma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Sudhir Varma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0231446.pdf"/>
    <abstract>
      <p>Microarray batch effect (BE) has been the primary bottleneck for large-scale integration of data from multiple experiments. Current BE correction methods either need known batch identities (<italic>ComBat</italic>) or have the potential to overcorrect, by removing true but unknown biological differences (Surrogate Variable Analysis <italic>SVA</italic>). It is well known that experimental conditions such as array or reagent batches, PCR amplification or ozone levels can affect the measured expression levels; often the direction of perturbation of the measured expression is the same in different datasets. However, there are no BE correction algorithms that attempt to estimate the individual effects of technical differences and use them to correct expression data. In this manuscript, we show that a set of signatures, each of which is a vector the length of the number of probes, calculated on a reference set of microarray samples can predict much of the batch effect in other validation sets. We present a rationale of selecting a reference set of samples designed to estimate technical differences without removing biological differences. Putting both together, we introduce the Batch Effect Signature Correction (<italic>BESC</italic>) algorithm that uses the BES calculated on the reference set to efficiently predict and remove BE. Using two independent validation sets, we show that <italic>BESC</italic> is capable of removing batch effect without removing unknown but true biological differences. Much of the variations due to batch effect is shared between different microarray datasets. That shared information can be used to predict signatures (<italic>i</italic>.<italic>e</italic>. directions of perturbation) due to batch effect in new datasets. The correction can be precomputed without using the samples to be corrected (blind), done on each sample individually (single sample) and corrects only known technical effects without removing known or unknown biological differences (conservative). Those three characteristics make it ideal for high-throughput correction of samples for a microarray data repository. We also compare the performance of <italic>BESC</italic> to three other batch correction methods: <italic>SVA</italic>, Removing Unwanted Variation (<italic>RUV</italic>) and Hidden Covariates with Prior (<italic>HCP</italic>). An R Package <italic>besc</italic> implementing the algorithm is available from <ext-link ext-link-type="uri" xlink:href="http://explainbio.com/">http://explainbio.com</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author (SV) does contract statistical analysis under the business name of “HiThru Analytics LLC”. Currently he is working as a contractor, part time with the National Institutes of Health (Bethesda MD) and part time with Tridiuum Inc. (Philadelphia PA). There are no other owners of employees of HiThru Analytics and it is not a subsidiary of any other company. The Funder provided support in the form of salaries for authors (SV), but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data are taken from publicly available Gene Expression Omnibus projects (List of projects available in Supporting Information Tables).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data are taken from publicly available Gene Expression Omnibus projects (List of projects available in Supporting Information Tables).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Batch effect (BE) has been the primary bottleneck for the large-scale integration of data from multiple experiments. BE, defined as the systematic biases between microarray data generated by different labs at different times or under different experimental conditions [<xref rid="pone.0231446.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0231446.ref002" ref-type="bibr">2</xref>], can act as a confounding variable in statistical tests and usually has a stronger effect on the measured expression than the biological phenotype under study [<xref rid="pone.0231446.ref003" ref-type="bibr">3</xref>].</p>
    <p>Unknown or unrecorded experimental or biological differences can add a systematic difference between putative replicates within or between two batches. Thus, we use the term <italic>batch effect</italic> as a general term for any heterogeneity due to experimental factors between samples that are putative experimental replicates. The heterogeneity can extend to different samples within the same sample collection, <italic>i</italic>.<italic>e</italic>. considering only average difference between two collections will likely underestimate the BE.</p>
    <p>In practice, it has proven difficult to separate heterogeneity due to technical differences from that due to unknown biological differences. The usual approach in batch correction [<xref rid="pone.0231446.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0231446.ref006" ref-type="bibr">6</xref>] is to protect the known covariates and remove all remaining heterogeneity. Biological differences such as sex and genotype can be clinically important but they will be removed if they are not part of the protected covariates [<xref rid="pone.0231446.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0231446.ref008" ref-type="bibr">8</xref>]. Conversely, if the study design is unbalanced, the statistical significance of the association of gene expression with the protected covariates can be inflated beyond what one would expect by just a reduction in noise [<xref rid="pone.0231446.ref009" ref-type="bibr">9</xref>].</p>
    <p>Additionally, current batch correction methods are intended to be used each time a new composite dataset is created. It is known that specific differences in sample condition, experimental technique [<xref rid="pone.0231446.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0231446.ref010" ref-type="bibr">10</xref>] and environmental conditions [<xref rid="pone.0231446.ref002" ref-type="bibr">2</xref>] can affect the measured gene expression in predictable directions irrespective of the sample type. However, there has been little systematic effort to estimate how many of those common effects are shared between datasets or to compute dataset-independent batch correction parameters that can be used for “blind” prediction of BE.</p>
    <p>In this article, we take another approach: instead of estimating and removing all differences between two batches, we only remove those differences that are known to be associated with technical variations. We show that a large proportion of the BE in Affymetrix U133 Plus2 array data can be captured by a relatively small set of signatures, defined as the directions in which the measured expression has been perturbed by batch effects. We estimate <italic>batch effect signatures</italic> (BES) in the form of orthogonal components from a large reference dataset of samples. We develop an algorithm for computing the BES using the reference dataset such that the BES are unlikely to model known or unknown biological differences. We introduce a novel batch-correction method called Batch Effect Signature Correction (<italic>BESC</italic>) that uses the batch effect signatures for blind prediction and correction of BE in new samples and compare the performance to <italic>SVA</italic>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Batch effect and correction methods</title>
      <p>The measured expression for a set of samples can depend on one or more biological factors (such as cell line name, tissue of origin or disease status) and unknown or unmodeled experimental factors (such as microarray batch, FFPE vs. fresh samples, and experimental technique). Following [<xref rid="pone.0231446.ref004" ref-type="bibr">4</xref>] we can model the expression of a sample as a linear combination of known biological covariates, unknown batch effect and noise
<disp-formula id="pone.0231446.e001"><alternatives><graphic xlink:href="pone.0231446.e001.jpg" id="pone.0231446.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">lj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ij</mml:mi></mml:mrow></mml:msub></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Where <italic>x</italic><sub><italic>ij</italic></sub> is the measured expression of gene <italic>i</italic> (out of <italic>m</italic> genes) for sample <italic>j</italic> (out of <italic>n</italic> samples), <italic>μ</italic><sub><italic>i</italic></sub> is the overall mean expression of gene <italic>i</italic>, <italic>f</italic><sub><italic>i</italic></sub>(<italic>y</italic><sub><italic>j</italic></sub>) is a (possibly non-linear) function that models the dependence of the expression of the <italic>i</italic><sup><italic>th</italic></sup> gene on the <italic>j</italic><sup><italic>th</italic></sup> known biological factors <italic>y</italic><sub><italic>j</italic></sub>. The batch effect is modelled as a linear combination <inline-formula id="pone.0231446.e002"><alternatives><graphic xlink:href="pone.0231446.e002.jpg" id="pone.0231446.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">lj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of <italic>L</italic> experimental factors each composed of <italic>g</italic><sub>lj</sub> the effect of the <italic>l</italic><sup><italic>th</italic></sup> experimental factor on the <italic>i</italic><sup><italic>th</italic></sup> gene multiplied by weight <italic>γ</italic><sub>il</sub>. The last term <italic>e</italic><sub>ij</sub> is uncorrelated noise.</p>
      <p><xref ref-type="disp-formula" rid="pone.0231446.e001">Eq 1</xref> indicates that the overall space of measured gene expressions can be separated into a space spanned by the biological variation <italic>f</italic><sub><italic>i</italic></sub>(<italic>y</italic><sub><italic>j</italic></sub>) and a space spanned by systematic batch effects <inline-formula id="pone.0231446.e003"><alternatives><graphic xlink:href="pone.0231446.e003.jpg" id="pone.0231446.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">lj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The purpose of BE correction is to estimate and remove the latter (third term on the RHS of <xref ref-type="disp-formula" rid="pone.0231446.e001">Eq 1</xref>) while retaining the biological differences. <italic>Data-specific</italic> batch correction methods (such as <italic>ComBat</italic> and <italic>SVA</italic>) assume that the BE space (third term) is unique to each composite dataset and has to be recalculated each time a new composite dataset is created. However, we show that an orthogonal basis derived from the BE space of a reference dataset can be used to estimate and remove the variation in the BE space for other test datasets (<italic>i</italic>.<italic>e</italic>. <italic>blind batch correction</italic>).</p>
      <sec id="sec004">
        <title>Surrogate Variable Analysis (SVA)</title>
        <p>SVA [<xref rid="pone.0231446.ref004" ref-type="bibr">4</xref>] has been widely used for estimating hidden covariates (including technical and biological). Fitting the functions f<sub><bold><italic>i</italic></bold></sub> and global means μ<sub><bold><italic>i</italic></bold></sub> using linear or non-linear regression, we can express <xref ref-type="disp-formula" rid="pone.0231446.e001">Eq 1</xref> in terms of the residuals of the fit
<disp-formula id="pone.0231446.e004"><alternatives><graphic xlink:href="pone.0231446.e004.jpg" id="pone.0231446.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">‐</mml:mi><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">‐</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">lj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula></p>
        <p>The aim of <italic>SVA</italic> is to find a set of <italic>K</italic>≤<italic>L</italic> orthogonal vectors (<italic>surrogate variables</italic>) that span the same linear space as <italic>g</italic><sub><italic>l</italic></sub>
<disp-formula id="pone.0231446.e005"><alternatives><graphic xlink:href="pone.0231446.e005.jpg" id="pone.0231446.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">kj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">lj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
        <p>Each surrogate variable <italic>h</italic><sub><italic>k</italic></sub> = [<italic>h</italic><sub><italic>k</italic>1</sub>,h<sub><italic>k</italic>2</sub>,…,h<sub>kn</sub>]<sup><italic>T</italic></sup> is a vector of length equal to the number of samples that models one hidden covariate that is not present in the known covariates, and <italic>λ</italic><sub>ik</sub> is the influence of <italic>h</italic><sub><italic>k</italic></sub> the measured expression of the <italic>i</italic><sup><italic>th</italic></sup> gene. Together they can be used to model heterogeneity from unknown sources in any future statistical analysis on that dataset. <italic>SVA</italic> proceeds to find these surrogate variables by doing a Singular Value Decomposition of the residuals <italic>r</italic><sub><italic>ij</italic></sub>.</p>
        <p>The advantage of <italic>SVA</italic> is that we do not need to know the actual batches. The disadvantages of <italic>SVA</italic> are that, firstly, it has to be recomputed on each new dataset, secondly, it can remove unknown but important biological differences between samples.</p>
      </sec>
      <sec id="sec005">
        <title>Removing Unwanted Variation (RUV)</title>
        <p>RUV [<xref rid="pone.0231446.ref011" ref-type="bibr">11</xref>] is a batch correction algorithm that uses factor analysis on control genes (i.e. genes that are not known to be differentially expressed for any of the known covariates) to estimate and remove batch effect. Apart from selection of the control genes, there is a parameter <bold><italic>ν</italic></bold> that has to be adapted to the dataset being corrected. RUV can be used without knowing the actual batches, but the selection of the control genes and <bold><italic>ν</italic></bold> remain challenging. Furthermore, these two selections are only valid for a particular dataset; they have to be re-evaluated for each new dataset.</p>
      </sec>
      <sec id="sec006">
        <title>Hidden Covariates with Prior (HCP)</title>
        <p>HCP [<xref rid="pone.0231446.ref012" ref-type="bibr">12</xref>] is an approach to estimating batch effects modelled as a linear combination of known covariates. HCP aims to be a generalization of several factorization-based batch correction methods by modelling both the known and unknown biological or technical covariates. The weights given to the known and unknown variation results in three parameters <bold><italic>λ</italic></bold>,<bold><italic>σ</italic></bold><sub><bold>1</bold></sub>,<bold><italic>σ</italic></bold><sub><bold>2</bold></sub> that have to be optimized for each dataset. HCP has the disadvantage that these parameters are specific to a particular dataset and have to be re-computed for each new dataset. Furthermore, without some ground truth to compare to (e.g. gene co-expression compared to known co-expressions, detection of known eQTLs), it is not possible to find the values for the three parameters that minimize the batch effect.</p>
      </sec>
      <sec id="sec007">
        <title>Batch Effect Signature Correction (BESC</title>
        <p>We introduce a novel approach <italic>BESC</italic> that aims to learn the variation due to unknown technical differences using a reference dataset and apply it to correct batch effect in other datasets. To motivate our approach, note that <italic>λ</italic><sub>ik</sub> is the difference in the expression of the <italic>i</italic><sup><italic>th</italic></sup> gene for each unit change in the <italic>k</italic><sup><italic>th</italic></sup> surrogate variable. Thus, the vector <italic>λ</italic><sub><italic>k</italic></sub> = [<italic>λ</italic><sub>1<italic>k</italic></sub>,λ<sub>2<italic>k</italic></sub>,…,λ<sub>mk</sub>], for the <italic>k</italic><sup><italic>th</italic></sup> surrogate variable and each genes 1…<italic>m</italic>, is a <italic>signature</italic> that quantifies the dependence of the expression of each gene on the <italic>k</italic><sup><italic>th</italic></sup> surrogate variable. For example, if the surrogate variable captures the effect of a particular type of sample preparation, the <italic>signature</italic> is the differential expression between samples that use that preparation method <italic>vs</italic>. samples that do not. We call the set of <italic>K</italic> vectors <italic>λ</italic><sub><italic>k</italic></sub> the <italic>Batch Effect Signatures</italic> (BES). Each vector is a zero-mean unit vector (<italic>i</italic>.<italic>e</italic>. sum of square of components equals one) that is as long as the number of probes on the array. We can consider batch effect to be a perturbation in a certain direction for all samples in the same batch. These perturbations can be estimated by looking at the expressions of the same cell line in different batches. Each perturbation is a sum of contributions from multiple sources of technical variation. BES decomposes the individual contribution of each source of technical variation by looking for a set of vectors that spans the batch effect perturbation-space.</p>
        <p>Our claim is that the expression difference (<italic>i</italic>.<italic>e</italic>. signature <italic>λ</italic><sub><italic>k</italic></sub>) between samples that differ on a certain experimental factor (<italic>e</italic>.<italic>g</italic>. RNA amplified vs. un-amplified) would be more likely to remain the same, multiplied by some coefficient even if the surrogate variables do not remain the same. Given a dataset of reference samples that is large and diverse enough, we can compute the signatures of the various known or unknown factors that contribute to BE. Those signatures can then be used to estimate and remove BE from new samples. We call this approach the <italic>Batch Effect Signature Correction</italic> (<italic>BESC</italic>).</p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Difference between SVA and BESC</title>
      <p>There are some differences between the <italic>SVA</italic> and <italic>BESC</italic> formulations. Writing Eq (<xref ref-type="disp-formula" rid="pone.0231446.e004">2</xref>) in matrix form
<disp-formula id="pone.0231446.e006"><alternatives><graphic xlink:href="pone.0231446.e006.jpg" id="pone.0231446.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>U</mml:mi></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>Where <italic>R</italic> is the <italic>m</italic>×<italic>n</italic> matrix of residuals (<italic>n</italic> samples, <italic>m</italic> genes), <italic>D</italic> is the <italic>m</italic>×<italic>K</italic> matrix of batch effect signatures (<italic>λ</italic><sub>ik</sub> the element at <italic>i</italic><sup><italic>th</italic></sup> row and <italic>k</italic><sup><italic>th</italic></sup> column) and <italic>U</italic> is the <italic>K</italic>×<italic>n</italic> matrix of surrogate variables (<italic>h</italic><sub>kj</sub> the element at <italic>k</italic><sup><italic>th</italic></sup> row and <italic>j</italic><sup><italic>th</italic></sup> column). <italic>SVA</italic> constrains the rows of <italic>U</italic> to be orthogonal and estimates the matrix <italic>U</italic> using singular value decomposition (SVD) on the residual matrix <italic>R</italic> (which also constrains the columns of D to be orthogonal). On the other hand, we constrain the columns of <italic>D</italic> to be orthogonal and estimate <italic>D</italic> by taking the Principal Components (PCA) of the transpose of the residual matrix, <italic>R</italic><sup><italic>T</italic></sup>. Note that there is no substantial difference between using SVD or PCA for decomposing <italic>R</italic> (except computational stability).</p>
      <p>Strictly speaking, <italic>SVA</italic> is not a batch correction algorithm. The surrogate variables also capture heterogeneity due to unknown biological differences since they are calculated without reference to the batch. Other batch correction methods such as <italic>ComBat</italic> [<xref rid="pone.0231446.ref005" ref-type="bibr">5</xref>] require known batch assignment, <italic>i</italic>.<italic>e</italic>. which samples belongs to which batch. A modification to <italic>SVA</italic>, <italic>permuted-SVA</italic> (or <italic>pSVA</italic>) [<xref rid="pone.0231446.ref008" ref-type="bibr">8</xref>] has been proposed to prevent the algorithm from removing unknown biological differences. However, <italic>pSVA</italic> has the same limitation as ComBat, <italic>i</italic>.<italic>e</italic>. it is applicable only when the technical covariates that contribute to batch effect are known. As <italic>SVA</italic> does not require that information, it is the closest comparable algorithm to <italic>BESC</italic> and was selected for comparison to <italic>BESC</italic> in this article.</p>
    </sec>
    <sec id="sec009">
      <title>Selecting samples for the reference set</title>
      <p>The selection of the reference set is crucial to ensure that the BES computed from it does not capture unknown biological covariates of the samples (<italic>e</italic>.<italic>g</italic>. sex, genotype). We selected and annotated a reference set of 2020 cell line samples (242 unique cell lines) on the Affymetrix U133 Plus 2.0 platform, selected from 348 collections from the Gene Expression Omnibus (<xref ref-type="supplementary-material" rid="pone.0231446.s008">S1 Table</xref>). Fitting the linear model in Eq (<xref ref-type="disp-formula" rid="pone.0231446.e001">1</xref>) using the cell line name as the known covariate captures all known and unknown biological differences between the samples. The same cell line, under untreated conditions, should give similar expression profiles between replicates.</p>
      <p>Although it is possible for growth conditions (<italic>e</italic>.<italic>g</italic>. passage number, growth medium) to affect the expression for a cell line, it can be argued that cell lines that have been grown from a standardized population of cells are one of the most replicable biological samples. Any differences in expression measured in two batches can be treated as mostly arising from BEs and experimental noise.</p>
    </sec>
    <sec id="sec010">
      <title>Correcting BE using BES</title>
      <p>Given a set of BES, the batch effect in a new set of samples is computed by fitting a linear model of the BES to the expressions of each sample, <italic>i</italic>.<italic>e</italic>. we find weights <italic>a</italic><sub>k</sub> that minimize the squared residuals
<disp-formula id="pone.0231446.e007"><alternatives><graphic xlink:href="pone.0231446.e007.jpg" id="pone.0231446.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives><label>(5)</label></disp-formula></p>
      <p>Where <italic>x</italic><sub><italic>new</italic></sub> is the vector of expressions for a new sample to be corrected and <italic>λ</italic><sub><italic>k</italic></sub> is the <italic>k</italic><sup><italic>th</italic></sup> BES. <inline-formula id="pone.0231446.e008"><alternatives><graphic xlink:href="pone.0231446.e008.jpg" id="pone.0231446.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the estimate of the BEs and the residuals <inline-formula id="pone.0231446.e009"><alternatives><graphic xlink:href="pone.0231446.e009.jpg" id="pone.0231446.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the corrected expression for the sample. Since the BES <italic>λ</italic><sub><italic>k</italic></sub> are zero sum orthonormal vectors, it is simple to show that <inline-formula id="pone.0231446.e010"><alternatives><graphic xlink:href="pone.0231446.e010.jpg" id="pone.0231446.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> where the superscript T indicates the transpose, <italic>i</italic>.<italic>e</italic>. the weights for each BES is the scalar product of the BES and the expression vector.</p>
      <p>BES is thus a “blind" estimate of the BE; we do not recalculate BE parameters on the set of new samples. That enables <italic>single sample correction</italic> of new samples, <italic>i</italic>.<italic>e</italic>. without having to re-compute the correction for all the samples whenever new samples are added.</p>
    </sec>
    <sec id="sec011">
      <title>Quantifying batch effect</title>
      <p>Several methods have been proposed in literature to visualize or quantify the batch effect in a dataset [<xref rid="pone.0231446.ref013" ref-type="bibr">13</xref>]. Visualization methods include clustering (dendrograms) and principal component analysis (PCA). However, they are not suited for very large number of samples, as is the case for the datasets in this paper. Principal Variance Component Analysis (PVCA) [<xref rid="pone.0231446.ref001" ref-type="bibr">1</xref>] has been proposed as a quantitative measure. PVCA fits a linear mixed model to the principal components of the data using the known biological covariates and batch identities as random effects. The variance due to the different covariates and batch is summed up across the principal components and offers a way to compare the primary sources of variance. For the two validation sets, we used PVCA to compute the contribution of variance due to sample-type as a measure of the batch effect. The higher the contribution, the lower the batch effect.</p>
      <p>However, PVCA has the disadvantage that the variances due to batch effect in different test datasets cannot be averaged together (as is required for cross-validation). So, we developed another batch effect measure, the Distance Ratio Score (DRS) that is intuitive, provides one value for each sample and can be averaged across various test sets. Consider a set of samples from one or more sample types hybridized in multiple batches. For a sample of a certain sample type, we take the log of the ratio of the distance to the closest sample of a different sample type to the distance to the closest sample belonging to a different batch but the same sample type.</p>
      <disp-formula id="pone.0231446.e011">
        <alternatives>
          <graphic xlink:href="pone.0231446.e011.jpg" id="pone.0231446.e011g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M11">
            <mml:mi>D</mml:mi>
            <mml:mi>R</mml:mi>
            <mml:mi>S</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">n</mml:mi>
              </mml:mrow>
            </mml:mfrac>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:munderover>
              </mml:mstyle>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mi>b</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(6)</label>
      </disp-formula>
      <p>Where <italic>d</italic>() is any measure of dissimilarity between two samples, <italic>x</italic><sub><italic>i</italic></sub> is the <italic>i</italic><sup><italic>th</italic></sup> sample, <italic>x</italic><sub><italic>i</italic>,<italic>dt</italic></sub> is the closest sample of a different sample type and <italic>x</italic><sub><italic>i</italic>,<italic>db</italic>/<italic>st</italic></sub> is the closest sample from a different batch of the same sample type as <italic>x</italic><sub><italic>i</italic></sub>. Intuitively, the DRS is high if samples of the same type cluster together irrespective of batch since the denominator will be small compared to the numerator. Conversely if most of the samples cluster according to batch rather than sample type, the DRS will be small. For our analysis, we used the Euclidean distance as the dissimilarity measure.</p>
    </sec>
    <sec id="sec012">
      <title>Cross-validating batch effect signatures</title>
      <p>The question remains whether BES calculated on one dataset are general enough to be predictive of the BE in another dataset. To investigate that, we did 5-fold cross-validation, <italic>i</italic>.<italic>e</italic>. created 5 random splits of the samples in the reference set into training and testing sets (approximately 80% samples for training and 20% samples for testing) ensuring that all samples from an individual collection are either all in the testing set or in the training set (<xref ref-type="supplementary-material" rid="pone.0231446.s008">S1 Table</xref>).</p>
      <p>For each train/test split, we used the training set to compute the residuals after fitting a model to the expression with the known sample type as the covariate. Then we computed the principal components of the transpose of the residual matrix. The eigenvectors of the covariance matrix (<italic>i</italic>.<italic>e</italic>. the principal components) were used as putative BES. We used varying numbers of eigenvectors with the highest eigenvalues to correct the samples in the testing set and computed a Distance Ratio Score (DRS) of the test set samples for each number of BES.</p>
    </sec>
    <sec id="sec013">
      <title>Consistency of BESC corrections for different reference sets</title>
      <p>Since we claim that the BESC algorithm picks up batch effects due to common technical differences, it should pick the same corrections when trained on different reference sets. To investigate that, we used the 5 cross-validation splits of the reference set to create two smaller reference sets: one reference set using splits 1 and 2 together and another reference set using splits 3 and 4 together. From each reference set, we computed a set of BES: BES<sub>1+2</sub> from splits 1 and 2 and BES<sub>3+4</sub> from splits 3 and 4. Using these two sets of BES, we did three analyses. First, both sets of BES were used to correct the 5<sup>th</sup> split with different numbers of BES. We visualized the two sets of corrected data for split 5 using principal component analysis (PCA). Second, we corrected random vectors with the two BES and computed the correlations between the corrections for different numbers of BES. Third, we corrected the colon cancer dataset (validation set 2) with both sets of BES and compared the list of genes differentially expressed between MSI and MSS samples. Results for these analyses are in <xref ref-type="supplementary-material" rid="pone.0231446.s011">S1 File</xref>.</p>
    </sec>
    <sec id="sec014">
      <title>Testing on validation sets</title>
      <p>We selected two validation sets to test the effectiveness of the BES calculated on the reference set for removing BE. All of these samples were collected from public GEO datasets. Annotations for the samples were compiled from annotations provided by the original data submitter.</p>
      <p>Different numbers of the top BES were used to estimate and remove the BE in the validation sets and the DRS BE score was calculated. Note that the BES were calculated using only the reference set samples. The sample type (or any other covariate) of the validation set samples were not used during the BE correction.</p>
      <p><bold>Validation set 1 (Primary normal samples)</bold>– 878 samples of primary healthy tissue (532 blood, 228 colon and 118 lung samples from 41 collections) on the U133 Plus 2.0 platform from GEO (<xref ref-type="supplementary-material" rid="pone.0231446.s009">S2 Table</xref>). We predicted the sex of each sample using 5 chromosome-Y genes (<xref ref-type="supplementary-material" rid="pone.0231446.s011">S1 File</xref>). Samples were selected to create a balanced dataset with respect to collection, organ and sex.</p>
      <p><bold>Validation set 2 (Colon cancer and normal)</bold>– 3041 samples of primary colon cancer and normal samples (476 normal colon and 2565 colon cancer samples from 60 GEO collections) on the U133 Plus 2.0 platform from GEO (<xref ref-type="supplementary-material" rid="pone.0231446.s010">S3 Table</xref>). We have compiled the reported Micro-Satellite Stability/Instability (MSS/MSI) status for 513 out of the 2565 colon cancer samples (154 MSI, 359 MSS). Out of those 513, we selected a balanced set of 503 samples with known MSI/MSS status to test for differential expression between MSI and MSS.</p>
    </sec>
    <sec id="sec015">
      <title>Permutation p-value for DRS</title>
      <p>To test whether the improvement in the DRS is statistically significant, we performed a permutation test of the DRS obtained with various numbers of BES. We permuted the data for each gene in the reference set to destroy any batch effect signatures and then computed the BES using that null dataset. Varying numbers of those null BES were used to correct the samples in the validation set and the DRS obtained was compared to the true DRS at different numbers of BES. The procedure was repeated 100 times and the null DRSs used to compute the p-value for the true DRS using a Student’s t-test at each number of BES.</p>
    </sec>
    <sec id="sec016">
      <title>Comparison to SVA, RUV and HCP</title>
      <p>We compared the DRS for the validation set for increasing numbers of BES to that for increasing levels of correction for <italic>SVA</italic>, <italic>RUV</italic> and <italic>HCP</italic>. The comparison was done for varying number of 1) surrogate variables (<italic>SVA</italic>), 2) factors (<italic>RUV</italic>) and 3) estimated hidden covariates (<italic>HCP</italic>). Note that it is not a direct comparison, since the other three methods use the validation set samples to compute the BE parameters. The training set/validation set approach we have taken with BES cannot be applied to <italic>SVA</italic>, <italic>RUV</italic> or <italic>HCP</italic> since they are expected to be run on the same dataset that is being corrected.</p>
      <p>For <italic>RUV</italic>, we selected the set of housekeeping genes as well as the value of <italic>ν</italic> that gave the best performance in terms of DRS and PVCA (<xref ref-type="supplementary-material" rid="pone.0231446.s011">S1 File</xref>). For <italic>HCP</italic>, we did a grid search over the three parameters <italic>λ</italic>,<italic>σ</italic><sub>1</sub>,<italic>σ</italic><sub>2</sub> and selected the values that gave the highest DRS.</p>
      <p>One disadvantage of <italic>SVA</italic> is that it will remove unknown biological differences (<italic>e</italic>.<italic>g</italic>. sex) from the cleaned data [<xref rid="pone.0231446.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0231446.ref008" ref-type="bibr">8</xref>]. To show that, we predicted the sex of each sample in the validation set 1 using the expression of chromosome Y genes (RPS4Y1, KDM5D, USP9Y, DDX3Y, EIF1AY, see <xref ref-type="supplementary-material" rid="pone.0231446.s011">S1 File</xref>) and looked at the number of genes significantly different between male and female samples at various levels of correction for <italic>BESC</italic> and <italic>SVA</italic>. For validation set 2, we had the reported MSI status for 513 colon cancer samples. We looked at the number of genes significantly different between MSI and MSS samples. The computation of statistical significance for validation set 1 was done using organ source, sex and batch as covariates and for validation set 2 was done using batch and MSI/MSS status as covariates.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec017">
    <title>Results</title>
    <sec id="sec018">
      <title>BES computed on training data is predictive of batch effect in test data</title>
      <p><xref ref-type="fig" rid="pone.0231446.g001">Fig 1</xref> shows the 5-split cross-validated batch effect DRS on the reference set. The plot shows the average DRS on the test set corrected using BES calculated on the training set. The DRS increases as the number of BES increases, indicating reduction of BE with increasing correction. It reaches a maximum with 30 BES used in the correction, indicating that the first 30 Batch Effect Signatures estimated on the training set capture variation due to BE in the test set. Further correction reduces the DRS, indicating that the BES above 30 do not capture any information about the BE.</p>
      <fig id="pone.0231446.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231446.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Cross-validated performance on reference set.</title>
          <p>The cross-validated Distance Ratio Score (DRS) for the reference set vs. the number of Batch Effect Signatures (BES) used for the correction. Higher DRS indicate lower levels of batch effect. The DRS reaches a maximum for 30 BES.</p>
        </caption>
        <graphic xlink:href="pone.0231446.g001"/>
      </fig>
    </sec>
    <sec id="sec019">
      <title>BES computed on different reference sets are consistent</title>
      <p><xref ref-type="supplementary-material" rid="pone.0231446.s005">S5 Fig</xref> shows the results of applying BESC using BES computed from different reference sets. As long as the number of BES is smaller than 10, the corrected samples from the two sets of BES stay close together (while moving away from the uncorrected samples). After 10 BES, the two sets of corrected samples start separating. <xref ref-type="supplementary-material" rid="pone.0231446.s006">S6 Fig</xref> shows the mean correlation between the corrections performed by the two sets of BES on a random vector. The correlation increases with increasing number of BES, reaching a maximum at 10 BES and then goes down. Furthermore, <xref ref-type="supplementary-material" rid="pone.0231446.s007">S7 Fig</xref> shows the overlap percentage between genes differentially expressed between MSI and MSS for validation set 2 corrected by the two sets of BES. The overlap remains high (&gt;80%) for up to 10 BES.</p>
      <p>Together, the three results show that two reference sets (splits 1+2 and splits 3+4), pick up similar batch effect signatures (until ~ 10 BES) indicating that the algorithm is picking up consistent correction factors from different reference sets.</p>
    </sec>
    <sec id="sec020">
      <title>BES computed on reference set corrects batch effect in validation sets</title>
      <p><xref ref-type="fig" rid="pone.0231446.g002">Fig 2A</xref> shows the DRS on validation set 1 using various numbers of BES calculated on the reference set. The figure compares the performance of the <italic>BESC</italic> method to the <italic>SVA</italic>, <italic>RUV</italic> and <italic>HCP</italic> methods using the same number of correction factors as the number of BES. The <italic>BESC</italic> method shows improvement in the DRS when up-to 15 BES are used for correction. Using more than 15 signatures begins to decrease the effectiveness. <italic>SVA</italic> shows a steady improvement in batch effect at each level while <italic>RUV</italic> shows improvement up to two correction factors and then saturates. <italic>HCP</italic> shows improvement for the first correction factor, but its performance decreases once 20 or more correction factors are included. <xref ref-type="fig" rid="pone.0231446.g002">Fig 2B</xref> shows similar results using the variance contributed to the sample type (in this case, the organ of origin of the samples). The variance increases for the sample type (with a corresponding decreasing in variance due to batch effect; not shown) as the number of BES or number of surrogate variables increases. As with the DRS (<xref ref-type="fig" rid="pone.0231446.g002">Fig 2A</xref>), <italic>SVA</italic> show a steady improvement in batch effect at each level. The performance for <italic>BESC</italic> reaches a maximum when 15 BES are used. <italic>RUV</italic> and <italic>HCP</italic> do not show any improvement with correction (with the performance of <italic>HCP</italic> decreasing over the un-corrected data).</p>
      <fig id="pone.0231446.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231446.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Performance on validation set 1.</title>
          <p>a) DRS for the validation set 1 using <italic>BESC</italic>, <italic>SVA</italic>, <italic>RUV</italic> and <italic>HCP</italic> and the permuted null BES b) Contribution of variance due to organ-type, calculated using PVCA c) Number of genes differentially ex-pressed between male and female samples at various levels of correction.</p>
        </caption>
        <graphic xlink:href="pone.0231446.g002"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0231446.g003">Fig 3A</xref> shows the DRS on validation set 2 for varying number of BES used in the correction. For that dataset too, the DRS reaches a maximum plateau at 15 BES. Using more than 15 BES does not significantly change the DRS. <xref ref-type="fig" rid="pone.0231446.g003">Fig 3B</xref> shows similar results using the PVCA-computed variance contribution due to sample-type (<italic>i</italic>.<italic>e</italic>. disease status- colon cancer <italic>vs</italic>. normal in this case). In both cases, the <italic>SVA</italic> corrected data shows superior performance in removing batch effect.</p>
      <fig id="pone.0231446.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231446.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Performance on validation set 2.</title>
          <p>a) DRS for the validation set 2 using <italic>BESC</italic>, <italic>SVA</italic>, <italic>RUV</italic> and <italic>HCP</italic> and the permuted null BES b) Contribution of variance due to disease status, calculated using PVCA c) Number of genes differentially expressed between MSI and MSS samples at various levels of correction by <italic>BESC</italic>, <italic>SVA</italic>, <italic>RUV</italic> and <italic>HCP</italic>.</p>
        </caption>
        <graphic xlink:href="pone.0231446.g003"/>
      </fig>
    </sec>
    <sec id="sec021">
      <title>Comparison to SVA</title>
      <p><italic>SVA</italic> shows superior performance (<xref ref-type="fig" rid="pone.0231446.g002">Fig 2A</xref>) over most of the range of the x-axis (number of BES/number of surrogate variables used for correction).</p>
      <p>However, Figs <xref ref-type="fig" rid="pone.0231446.g002">2C</xref> and <xref ref-type="fig" rid="pone.0231446.g003">3C</xref> illustrates the primary disadvantage of <italic>SVA</italic> which is the “normalizing away” of unknown but true biological differences. When sample sex is not included as one of the “protected” covariates in the <italic>SVA</italic> algorithm, the difference between male and female samples (<italic>i</italic>.<italic>e</italic>. the number of statistically significant genes) decreases with increasing <italic>SVA</italic> correction. On the other hand, the difference is maintained (and slightly increased) with increasing BES correction.</p>
      <p><xref ref-type="fig" rid="pone.0231446.g003">Fig 3C</xref> shows the number of genes that are differentially expressed between MSI and MSS samples at a statistically significant level (FDR&lt;0.05). There is a steep drop off of the number of genes for the <italic>SVA</italic>-corrected data. <italic>SVA</italic> correction eventually removes almost all of the differences between the MSI and MSS samples. On the other hand, the BES corrected data retains most of the differential expression.</p>
      <p>Figs <xref ref-type="fig" rid="pone.0231446.g002">2C</xref> and <xref ref-type="fig" rid="pone.0231446.g003">3C</xref> emphasize the conservative nature of <italic>BESC</italic>; only differences that are known to be due to BE are removed. Any unknown/unmodeled difference between the samples that is due to true biology is maintained. In contrast, <italic>SVA</italic> captures those differences unless they are protected, and correction with the surrogate variables removes those differences from the samples.</p>
    </sec>
    <sec id="sec022">
      <title>Comparison to RUV</title>
      <p>For validation set 1, <italic>RUV</italic> shows some promise as a batch correction method for small numbers of correction factors (2 or less). However, it fails to do any correction for validation set 2. Also note that the results for <italic>RUV</italic> are selected from that value of <italic>ν</italic> and set of housekeeping genes that has the highest performance. In practice, it is computationally cumbersome to select the best parameter.</p>
    </sec>
    <sec id="sec023">
      <title>Comparison to HCP</title>
      <p><italic>HCP</italic> does some significant correction for validation set 2 (<xref ref-type="fig" rid="pone.0231446.g003">Fig 3</xref>) but shows disappointing performance on validation set 1 (<xref ref-type="fig" rid="pone.0231446.g002">Fig 2</xref>). In addition, <italic>HCP</italic> had the disadvantage that its performance had to be tuned by optimizing over a grid of three parameters (we show the results for the best performing combination).</p>
    </sec>
    <sec id="sec024">
      <title>BES correction is statistically significant</title>
      <p>The orange line (Figs <xref ref-type="fig" rid="pone.0231446.g002">2A</xref> and <xref ref-type="fig" rid="pone.0231446.g003">3A</xref>) shows the average DRS for the validation sets corrected using the BES calculated on the permuted reference set data. As expected, there is no significant correction of the data (<italic>i</italic>.<italic>e</italic>. the DRS does not improve from baseline). The z-score p-value of the DRS using the true reference set (black line) is &lt;1e-16 over the entire range of numbers of BES.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec025">
    <title>Discussion</title>
    <p>We show that the batch effects between different datasets occupy a space that can be characterized by a small set of orthogonal basis vectors. That enables us to compute Batch Effect Signature (BES) vectors that capture the direction of perturbation using a reference dataset and apply them to predict and remove the batch in independent validation datasets. As far as we know, no other “blind” methods of batch correction have been published. All methods, (including <italic>SVA</italic> [<xref rid="pone.0231446.ref004" ref-type="bibr">4</xref>], <italic>RUV</italic> [<xref rid="pone.0231446.ref011" ref-type="bibr">11</xref>] and <italic>HCP</italic> [<xref rid="pone.0231446.ref012" ref-type="bibr">12</xref>]) require the correction factors to be computed on the entire sample set, needing re-calculation each time new samples are added.</p>
    <p>Crucial to the correct operation of our algorithm is the selection of a reference set composed of cell lines since specifying the cell line name completely fixes all known and unknown biological covariates. We argue that cell lines that have been grown from a standardized population of cells are one of the most replicable biological experiments, and any difference between the same cell line sample from different experiments is quite likely due only to technical variation. However, note that we can use any sample that has been analysed in multiple experiments by different labs. For example, samples from The Cancer Genome Atlas (TCGA) or any other sample repository have the property that specifying the sample id completely specifies all of the known and unknown biological covariates. All that is required for inclusion in the reference set is that the sample must be uniquely identified across multiple experiments.</p>
    <p>We compared the <italic>BESC</italic> algorithm to Surrogate Variable Analysis (<italic>SVA</italic>), Removing Unwanted Variation (<italic>RUV</italic>) and Hidden Covariates with Prior (<italic>HCP</italic>). At larger number of surrogate variables, <italic>SVA</italic> is more effective at detecting and removing residual structure from the dataset, however it is not possible to know how much of that residual structure is due to batch effect compared to unknown but true biological differences. We show that <italic>SVA</italic> is very likely to remove unknown but important biological information in our validation sets (<italic>e</italic>.<italic>g</italic>. sex in the case of normal samples and MSI <italic>vs</italic>. MSS differences in the case of colon cancer). We show that <italic>BESC</italic> is much more conservative about retaining unknown biological differences while removing technical differences. <italic>RUV</italic> and <italic>HCP</italic> show some performance on one validation set each, but do not do any significant correction in the other validation set. Furthermore, both algorithms need to be tuned by testing out various values of tuning parameter(s); a computationally expensive process.</p>
    <p>The characteristics of the <italic>BESC</italic> algorithm make it ideally suited for large-scale batch correction in microarray data repositories. <italic>BESC</italic> is conservative, <italic>i</italic>.<italic>e</italic>. only BE known to be likely due to technical differences is removed. We have shown that biological variation, even if unknown to the <italic>BESC</italic> algorithm, is preserved. <italic>BESC</italic> can be applied to individual samples and does not need to be recomputed as more samples are added to the repository.</p>
    <p>One primary disadvantage of the <italic>BESC</italic> algorithm is that it will remove all differences between samples that are parallel to the BES vectors. It is possible that there is important biological information along those directions. However, that biological difference is confounded with the technical differences and cannot be separated out in any analysis.</p>
    <p>Another disadvantage is that the current BES vectors are only applicable to the Affymetrix U133 Plus2 array. We used samples from the U133 Plus2 platform to calculate the BES, mainly because it is the most commonly used platform with a large number of cell line samples. Before BES can be used on another platform, we will have to compile a reference set of cell line or other identified samples on that platform and re-compute the vectors on that set. Other BE correction methods are platform agnostic.</p>
  </sec>
  <sec sec-type="conclusions" id="sec026">
    <title>Conclusions</title>
    <p>This paper describes a novel finding that batch effect (BE) perturbs measured gene expression in predictable directions which we call Batch Effect Signatures (BES). That characteristic can be used to compute possible directions of the perturbations in a reference dataset which can be used to predict the BE in an independent validation set. Selecting the reference set to contain only known cell-lines ensures that all (known or unknown) biological differences are fixed by specifying the cell-line name. That ensures that the BES capture differences due only to technical differences between the batches.</p>
    <p>We show that the BES calculated on the reference set efficiently removes batch effect in two validation sets, as measured by PVCA and the Distance Ratio Score (DRS), a novel measure of batch effect. Compared to <italic>SVA</italic>, our algorithm does not remove all possible differences between samples of the same type in different batches, but we show that <italic>SVA</italic> also over-corrects by removing unknown but true biological differences. Compared to <italic>RUV</italic> and <italic>HCP</italic>, our algorithm shows superior performance over a wider range of datasets.</p>
    <p>An R Package <italic>besc</italic> implementing the algorithm is available from <ext-link ext-link-type="uri" xlink:href="http://www.explainbio.com/">http://www.explainbio.com</ext-link>. All data used are public data available from GEO (Gene Expression Omnibus <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>). GEO accession numbers for all samples used in the analyses are in <xref ref-type="supplementary-material" rid="pone.0231446.s008">S1</xref>–<xref ref-type="supplementary-material" rid="pone.0231446.s010">S3</xref> Tables.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec027">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0231446.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Normalization of arrays.</title>
        <p>a) Bias in measured expression that depends on intensity b) Bias in measured expression that depends on array y-axis.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0231446.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Prediction of sex.</title>
        <p>Scatterplots of sex related genes with known sex and ellipse of 95% density for fitted Gaussian mixture model.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0231446.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s003">
      <label>S3 Fig</label>
      <caption>
        <title><italic>RUV</italic> parameter selection for validation set 1.</title>
        <p>Plot of DRS and PVCA for various levels of the tuning parameter for <italic>RUV</italic> as well as two different sets of housekeeping genes.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0231446.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s004">
      <label>S4 Fig</label>
      <caption>
        <title><italic>RUV</italic> parameter selection for validation set 2.</title>
        <p>Plot of DRS and PVCA for various levels of the tuning parameter for <italic>RUV</italic> as well as two different sets of housekeeping genes.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0231446.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Consistency of calculated BES.</title>
        <p>Overlap between significant genes selected for MSS/MSI differences in validation set 2 for BES calculated on different subsets of the reference set.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0231446.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s006">
      <label>S6 Fig</label>
      <caption>
        <title>PCA of corrected samples for two sets of BES.</title>
        <p>Principal Component Analysis (PCA) plots of uncorrected samples and samples corrected using two different sets of BES calculated on different subsets of the reference set.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0231446.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Correlation between corrected samples.</title>
        <p>Correlation between corrected samples at various levels of correction for BES calculated on different subsets of the reference set.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0231446.s007.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s008">
      <label>S1 Table</label>
      <caption>
        <title>List of samples in the reference set (Cell lines) with cross-validation split IDs.</title>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0231446.s008.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s009">
      <label>S2 Table</label>
      <caption>
        <title>List of samples in validation set 1 (Primary normal samples) with predicted sex.</title>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0231446.s009.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s010">
      <label>S3 Table</label>
      <caption>
        <title>List of samples in validation set 2 (Colon cancer and normal) with known MSI/MSS status.</title>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0231446.s010.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231446.s011">
      <label>S1 File</label>
      <caption>
        <title>Supplementary methods.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0231446.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The author gratefully acknowledges the valuable feedback on this paper given by Vinodh Rajpakse and Augustin Luna. The author is also grateful for the constructive suggestions from the two anonymous reviewers which has resolved several errors and made the manuscript stronger overall.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0231446.ref001">
      <label>1</label>
      <mixed-citation publication-type="other">Scherer A. Batch Effects and Noise in Microarray Experiments: Sources and Solutions. <ext-link ext-link-type="uri" xlink:href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470741384.html">http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470741384.html</ext-link>. Accessed 29 Nov 2016.</mixed-citation>
    </ref>
    <ref id="pone.0231446.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Fare</surname><given-names>TL</given-names></name>, <name><surname>Coffey</surname><given-names>EM</given-names></name>, <name><surname>Dai</surname><given-names>H</given-names></name>, <name><surname>He</surname><given-names>YD</given-names></name>, <name><surname>Kessler</surname><given-names>DA</given-names></name>, <name><surname>Kilian</surname><given-names>KA</given-names></name>, <etal>et al</etal><article-title>Effects of Atmospheric Ozone on Microarray Data Quality</article-title>. <source>Anal Chem</source>. <year>2003</year>;<volume>75</volume>:<fpage>4672</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1021/ac034241b</pub-id><?supplied-pmid 14632079?><pub-id pub-id-type="pmid">14632079</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Leek</surname><given-names>JT</given-names></name>, <name><surname>Scharpf</surname><given-names>RB</given-names></name>, <name><surname>Bravo</surname><given-names>HC</given-names></name>, <name><surname>Simcha</surname><given-names>D</given-names></name>, <name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Johnson</surname><given-names>WE</given-names></name>, <etal>et al</etal><article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat Rev Genet</source>. <year>2010</year>;<volume>11</volume>:<fpage>733</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2825</pub-id><?supplied-pmid 20838408?><pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Leek</surname><given-names>JT</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>. <article-title>Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis</article-title>. <source>PLoS Genet</source>. <year>2007</year>;<volume>3</volume>:<fpage>e161</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0231446.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>WE</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Rabinovic</surname><given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods.</article-title><source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>:<fpage>118</fpage>–<lpage>27</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Marron</surname><given-names>JS</given-names></name>, <name><surname>Todd</surname><given-names>MJ</given-names></name>, <name><surname>Ahn</surname><given-names>J</given-names></name>. <article-title>Distance-Weighted Discrimination.</article-title><source>J Am Stat Assoc</source>. <year>2007</year>;<volume>102</volume>:<fpage>1267</fpage>–<lpage>71</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0231446.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jaffe</surname><given-names>AE</given-names></name>, <name><surname>Hyde</surname><given-names>T</given-names></name>, <name><surname>Kleinman</surname><given-names>J</given-names></name>, <name><surname>Weinbergern</surname><given-names>DR</given-names></name>, <name><surname>Chenoweth</surname><given-names>JG</given-names></name>, <name><surname>McKay</surname><given-names>RD</given-names></name>, <etal>et al</etal><article-title>Practical impacts of genomic data “cleaning” on biological discovery using surrogate variable analysis.</article-title><source>BMC Bioinformatics</source>. <year>2015</year>;<volume>16</volume>:<fpage>372</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0808-5</pub-id><?supplied-pmid 26545828?><pub-id pub-id-type="pmid">26545828</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Parker</surname><given-names>HS</given-names></name>, <name><surname>Leek</surname><given-names>JT</given-names></name>, <name><surname>Favorov</surname><given-names>AV</given-names></name>, <name><surname>Considine</surname><given-names>M</given-names></name>, <name><surname>Xia</surname><given-names>X</given-names></name>, <name><surname>Chavan</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Preserving biological heterogeneity with a permuted surrogate variable analysis for genomics batch correction</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>2757</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu375</pub-id><?supplied-pmid 24907368?><pub-id pub-id-type="pmid">24907368</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Nygaard</surname><given-names>V</given-names></name>, <name><surname>Rødland</surname><given-names>EA</given-names></name>, <name><surname>Hovig</surname><given-names>E</given-names></name>. <article-title>Methods that remove batch effects while retaining group differences may lead to exaggerated confidence in downstream analyses.</article-title><source>Biostatistics</source>. <year>2015</year>;:<fpage>kxv027</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0231446.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Łabaj</surname><given-names>PP</given-names></name>, <name><surname>Zumbo</surname><given-names>P</given-names></name>, <name><surname>Sykacek</surname><given-names>P</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Shi</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Detecting and correcting systematic variation in large-scale RNA sequencing data</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>:<fpage>888</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3000</pub-id><?supplied-pmid 25150837?><pub-id pub-id-type="pmid">25150837</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Gagnon-Bartsch</surname><given-names>JA</given-names></name>, <name><surname>Speed</surname><given-names>TP</given-names></name>. <article-title>Using control genes to correct for unwanted variation in microarray data.</article-title><source>Biostatistics</source>. <year>2012</year>;<volume>13</volume>:<fpage>539</fpage>–<lpage>52</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxr034</pub-id><?supplied-pmid 22101192?><pub-id pub-id-type="pmid">22101192</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Mostafavi</surname><given-names>S</given-names></name>, <name><surname>Battle</surname><given-names>A</given-names></name>, <name><surname>Zhu</surname><given-names>X</given-names></name>, <name><surname>Urban</surname><given-names>AE</given-names></name>, <name><surname>Levinson</surname><given-names>D</given-names></name>, <name><surname>Montgomery</surname><given-names>SB</given-names></name>, <etal>et al</etal><article-title>Normalizing RNA-Sequencing Data by Modeling Hidden Covariates with Prior Knowledge.</article-title><source>PLOS ONE.</source><year>2013</year>;<volume>8</volume>:<fpage>e68141</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0068141</pub-id><?supplied-pmid 23874524?><pub-id pub-id-type="pmid">23874524</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231446.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lazar</surname><given-names>C</given-names></name>, <name><surname>Meganck</surname><given-names>S</given-names></name>, <name><surname>Taminau</surname><given-names>J</given-names></name>, <name><surname>Steenhoff</surname><given-names>D</given-names></name>, <name><surname>Coletta</surname><given-names>A</given-names></name>, <name><surname>Molter</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Batch effect removal methods for microarray gene expression data integration: a survey</article-title>. <source>Brief Bioinform</source>. <year>2012</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0231446.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Puebla</surname>
          <given-names>Iratxe</given-names>
        </name>
        <role>Staff Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Iratxe Puebla</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Iratxe Puebla</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">2 Sep 2019</named-content>
    </p>
    <p>PONE-D-19-17279</p>
    <p>Blind estimation and correction of microarray batch effect</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Varma,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>The manuscript has been assessed by two reviewers; their comments are available below.</p>
    <p>The reviewers have raised some major concerns that need attention in a revision. The reviewers note that further information is needed on where the method can be publicly accessed, and they also raise the need to complete further tests as well as comparison to other approaches in order to validate the proposed methodology.</p>
    <p>Could you please revise the manuscript to carefully address the concerns raised by the reviewers?</p>
    <p>We would appreciate receiving your revised manuscript by Oct 15 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Iratxe Puebla</p>
    <p>Senior Managing Editor, PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>1. Thank you for including your competing interests statement; "The author has declared that no competing interests exist."</p>
    <p>We note that one or more of the authors are employed by a commercial company: HiThru Analytics LLC</p>
    <p>
      <list list-type="order">
        <list-item>
          <p>Please provide an amended Funding Statement declaring this commercial affiliation, as well as a statement regarding the Role of Funders in your study. If the funding organization did not play a role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript and only provided financial support in the form of authors' salaries and/or research materials, please review your statements relating to the author contributions, and ensure you have specifically and accurately indicated the role(s) that these authors had in your study. You can update author roles in the Author Contributions section of the online submission form.</p>
        </list-item>
      </list>
    </p>
    <p>Please also include the following statement within your amended Funding Statement.</p>
    <p>“The funder provided support in the form of salaries for authors [insert relevant initials], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.”</p>
    <p>If your commercial affiliation did play a role in your study, please state and explain this role within your updated Funding Statement.</p>
    <p>2. Please also provide an updated Competing Interests Statement declaring this commercial affiliation along with any other relevant declarations relating to employment, consultancy, patents, products in development, or marketed products, etc.  </p>
    <p>Within your Competing Interests Statement, please confirm that this commercial affiliation does not alter your adherence to all PLOS ONE policies on sharing data and materials by including the following statement: "This does not alter our adherence to  PLOS ONE policies on sharing data and materials.” (as detailed online in our guide for authors <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/competing-interests">http://journals.plos.org/plosone/s/competing-interests</ext-link>) . If this adherence statement is not accurate and  there are restrictions on sharing of data and/or materials, please state these. Please note that we cannot proceed with consideration of your article until this information has been declared.</p>
    <p>Please include both an updated Funding Statement and Competing Interests Statement in your cover letter. We will change the online submission form on your behalf.</p>
    <p>Please know it is PLOS ONE policy for corresponding authors to declare, on behalf of all authors, all potential competing interests for the purposes of transparency. PLOS defines a competing interest as anything that interferes with, or could reasonably be perceived as interfering with, the full and objective presentation, peer review, editorial decision-making, or publication of research or non-research articles submitted to one of the journals. Competing interests can be financial or non-financial, professional, or personal. Competing interests can arise in relationship to an organization or another person. Please follow this link to our website for more details on competing interests: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/competing-interests">http://journals.plos.org/plosone/s/competing-interests</ext-link></p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: This manuscript presents a novel computational method (BESC) to correct for batch effects in microarray experiments. The novel idea of the author is that he argues that scanning a large representative set of data should be informative enough for parametrizing the "general" batch effects that are inherent to a particular microarray chip once and for all.</p>
    <p>If this works, the author points out that one could run BESC once and apply it to new data sets in the future without having to rerun BESC.</p>
    <p>I find this a novel, appealing idea. I am not aware of a comparable approach.</p>
    <p>The manuscript is well written, clearly understandable and structured.</p>
    <p>Major points</p>
    <p>(1) The manuscript states that the method is available from <ext-link ext-link-type="uri" xlink:href="http://explainbio.com">http://explainbio.com</ext-link></p>
    <p>But I did not find the software there when I accessed that site.</p>
    <p>Hence, I/we could not test the tool ourselves, which is standard when announcing a new bioinformatics tool.</p>
    <p>(2) The presented results (figures + suppl figures) appear convincing.</p>
    <p>To illustrate the generality and limitations of BESC I suggest to add the following 2 tests:</p>
    <p>(a) In addition to the 5-fold CV already done, I suggest that the same 5 data splits should be processed as follows:</p>
    <p>-&gt; First, BESC should be parametrized on sets 1 + 2 and then applied to set 5.</p>
    <p>-&gt; Alternatively, BESC should be parametrized on sets 3 + 4 and then applied to set 5.</p>
    <p>It this manner, two halves of the training data would be used to predict batch-effect corrected versions of set 5. I am curious how different are the results of this exercise.</p>
    <p>If one does this for the TCGA data (Fig. 3 C), how large is the overlap coefficient of the differentially expressed genes between the two runs?</p>
    <p>(b) The author argued he used data for a large panel of representative cell lines so that the parametrized BESC should be of general nature.</p>
    <p>I wonder what the limitations of this approach are?</p>
    <p>Does this also work for tissues and conditions that are not represented in the training data set?</p>
    <p>This should be demonstrated on a suitable example.</p>
    <p>(3) Another research group told us about their experience with TCGA data from the Illumina 27k CpG methylation chip (breast cancer). They found a strong batch effect between separate charges of the chip produced at different times.</p>
    <p>Such a case would not be covered by BESC. If you parametrized on MA data collected up to a certain moment in time and apply this to process "all" future data processed with this chip type, one would have to assume that the chip is homogeneously manufactured over many years.</p>
    <p>But this may not be the case, and may remain undetected if users simply rely on BESC.</p>
    <p>Discussion of this and related effects should be added in the discussion section.</p>
    <p>Minor points</p>
    <p>(4) throughtout the text many nouns start with capital letters, but need not to do so.</p>
    <p>(5) line 317: is to much more -&gt; is much more</p>
    <p>(6) line 337: which can used -&gt; which can be used</p>
    <p>Reviewer #2: The paper presents a novel method using signatures of batch effects generated from an external reference to eliminate batch effects from microarray data without harming the biological signal.</p>
    <p>The idea and method is very interesting and well presented.</p>
    <p>1. My main criticism is regarding the validation of the method. the method was compared to SVA which removes batch effects as well as the biological signal. The current validation might just show that SVA removes also biology with the batch effects which is worse than the present method or even the raw uncorrected data. Another comparison should be used for validation. For example, comparison with Combat (RUV etc) or other method that deals with removing batch effects without the biological signal, should be added. It might be also compared to the raw data, showing that it outperform the raw data. In case the new method doesn't correct the data, still it will outperform SVA which overfits the data and eliminated the DEGs.</p>
    <p>2. Im missing a presentation of other recent methods that deal with removing batch effects without removing the biological signal. For example, HCP by Mustafavi, BCeF by Somekh etc.</p>
    <p>Minor issues:</p>
    <p>p.1. line 9 "Even though the effects..." - unclear sentence</p>
    <p>p.1. line 22 - very long sentence with too many parentheses.</p>
    <p>p.2. l 34 - "or biological" - should be just experimental here?</p>
    <p>p.4 - some mistake for gij on the jth gene? not enough explanation on gamma and the factors.</p>
    <p>p 5 - need to add more explanation on the SVA formulas. so (3) is currently not fully clear. I had to read the SVA paper to understand.</p>
    <p>p 5 l.90 - sometimes ki and sometimes ik are used.</p>
    <p>p 5 l.92 - should be "each gene" instead of "all genes"?</p>
    <p>l 96 - length one is unclear</p>
    <p>l 98 - refine the English sentence</p>
    <p>l 102 - please add: to remain the same, multiplied by some coefficient.</p>
    <p>p 12 line 246 - Figure not Fig. Figure 2A - please add explanation on what can be seen for SVA.</p>
    <p>p. 15 line 294 - unclear sentence</p>
    <p>line 299 - for SVA, please add reference</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231446.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">6 Dec 2019</named-content>
    </p>
    <p>Response to reviewers</p>
    <p>Firstly, I would like to thank the reviewers for the thorough review and very constructive suggestions. I have taken their suggestions to heart and performed extensive work to do the comparisons to other batch effect methods as well as validation methods. I believe this makes the manuscript stronger and improves the presentation considerably.</p>
    <p>I have added my responses below in light orange font.</p>
    <p>Reviewer #1: </p>
    <p>This manuscript presents a novel computational method (BESC) to correct for batch effects in microarray experiments. The novel idea of the author is that he argues that scanning a large representative set of data should be informative enough for parametrizing the "general" batch effects that are inherent to a particular microarray chip once and for all.</p>
    <p>If this works, the author points out that one could run BESC once and apply it to new data sets in the future without having to rerun BESC.</p>
    <p>I find this a novel, appealing idea. I am not aware of a comparable approach.</p>
    <p>The manuscript is well written, clearly understandable and structured.</p>
    <p>Major points</p>
    <p>(1) The manuscript states that the method is available from <ext-link ext-link-type="uri" xlink:href="http://explainbio.com">http://explainbio.com</ext-link></p>
    <p>But I did not find the software there when I accessed that site.</p>
    <p>Hence, I/we could not test the tool ourselves, which is standard when announcing a new bioinformatics tool.</p>
    <p>That was due to a misconfiguration of the web server. The package should be available to download now, on clicking the “BESC R package” link on the top right-hand side. Please make sure to clear your browser cache before reloading <ext-link ext-link-type="uri" xlink:href="http://explainbio.com">http://explainbio.com</ext-link></p>
    <p>(2) The presented results (figures + suppl figures) appear convincing.</p>
    <p>To illustrate the generality and limitations of BESC I suggest to add the following 2 tests:</p>
    <p>(a) In addition to the 5-fold CV already done, I suggest that the same 5 data splits should be processed as follows:</p>
    <p>-&gt; First, BESC should be parametrized on sets 1 + 2 and then applied to set 5.</p>
    <p>-&gt; Alternatively, BESC should be parametrized on sets 3 + 4 and then applied to set 5.</p>
    <p>It this manner, two halves of the training data would be used to predict batch-effect corrected versions of set 5. I am curious how different are the results of this exercise.</p>
    <p>I’ve included a plot that explores this (Supplementary Figure 6). I’ve plotted the uncorrected samples from split 5 along with the same samples corrected by batch effect signatures (BES) calculated on splits 1+2 and splits 3+4 (i.e. two sets of BES). As long as the number of BES is smaller than 10, the corrected samples from the two sets of BES stay close together (while moving away from the uncorrected samples). After 10 BES, the two sets of corrected samples start separating.</p>
    <p>Furthermore, Supplementary Figure 7 shows the mean correlation between the corrections performed by the sets of BES computed on splits 1+2 vs 3+4. The correlation increases with increasing number of BES, reaching a maximum at 10 BES and then goes down.</p>
    <p>Together, the two results show that two sets of reference data splits (splits 1+2 and splits 3+4), pick up similar batch effect signatures (until ~ 10 BES) indicating that the algorithm is detecting a robust signal.</p>
    <p>It seems reasonable that we can find 10 robust BES from a bit less than half the reference data (splits 1+2 or split 3+4) compared to ~20 robust BES from the full reference set. It is possible that additional data in the reference set can give us a larger number of BES covering more of the batch effect </p>
    <p>If one does this for the TCGA data (Fig. 3 C), how large is the overlap coefficient of the differentially expressed genes between the two runs?</p>
    <p>I’ve included a plot of the fraction of common genes between the colon cancer/normal dataset (validation set 2) when corrected by sets of BES calculated on the 1st + 2nd split combined and the 3rd + 4th split combined (Supplementary Figure 5). There is a high degree of overlap (&gt;80% intersection) till the number of BES reaches 10. The BES start to diverge from 20 onwards and the overlap decreases.</p>
    <p>(b) The author argued he used data for a large panel of representative cell lines so that the parametrized BESC should be of general nature.</p>
    <p>I wonder what the limitations of this approach are?</p>
    <p>Does this also work for tissues and conditions that are not represented in the training data set?</p>
    <p>This should be demonstrated on a suitable example.</p>
    <p>The two validation sets are actually different tissues and conditions compared to the reference set that was used to compute the BES. The reference set contains only cell line samples while the validation sets contain primary tissue samples (blood, lung and colon normal samples for validation set 1 and primary colon normal and cancer for validation set 2). </p>
    <p>(3) Another research group told us about their experience with TCGA data from the Illumina 27k CpG methylation chip (breast cancer). They found a strong batch effect between separate charges of the chip produced at different times.</p>
    <p>Such a case would not be covered by BESC. If you parametrized on MA data collected up to a certain moment in time and apply this to process "all" future data processed with this chip type, one would have to assume that the chip is homogeneously manufactured over many years.</p>
    <p>But this may not be the case, and may remain undetected if users simply rely on BESC.</p>
    <p>Discussion of this and related effects should be added in the discussion section.</p>
    <p>I do detect a year-dependent effect of one of the BES. The coefficient calculated for samples with different scan years varies smoothly from year to year. It is true that any abrupt large change in the array manufacturing would not be detected by BESC until we have a number of reference samples on the new array. I’ve added a remark in the discussion on this issue.</p>
    <p>Minor points</p>
    <p>(4) throughtout the text many nouns start with capital letters, but need not to do so.</p>
    <p>(5) line 317: is to much more -&gt; is much more Corrected line 372</p>
    <p>(6) line 337: which can used -&gt; which can be used Corrected line 395</p>
    <p>Reviewer #2: </p>
    <p>The paper presents a novel method using signatures of batch effects generated from an external reference to eliminate batch effects from microarray data without harming the biological signal.</p>
    <p>The idea and method is very interesting and well presented.</p>
    <p>Major issues:</p>
    <p>1. My main criticism is regarding the validation of the method. the method was compared to SVA which removes batch effects as well as the biological signal. The current validation might just show that SVA removes also biology with the batch effects which is worse than the present method or even the raw uncorrected data. Another comparison should be used for validation. For example, comparison with Combat (RUV etc) or other method that deals with removing batch effects without the biological signal, should be added. It might be also compared to the raw data, showing that it outperform the raw data. In case the new method doesn't correct the data, still it will outperform SVA which overfits the data and eliminated the DEGs.</p>
    <p>Firstly, I would like to clarify that the comparison to the raw data is present in each figure (the very first point on the left with BES=0, indicating uncorrected data). I’ve added a dotted horizontal line in each figure to show the value for the uncorrected data.</p>
    <p>I’ve added comparisons to the results using RUV [1] and HCP [2]. I find that RUV does outperform BESC in validation set 2 for correction with a small number of factors (Figure 3). However, this best performance is selected after choosing between two different sets of control genes and varying the value of ν (a tunable parameter for RUV). In contrast BESC (and SVA) does not need to be tuned. </p>
    <p>The results with HCP was disappointing for both validation sets (Figures 2 and 3). In both cases HCP does not do any better than the raw data. Note that these are the best results as selected from a range of values for the three HCP parameters λ,σ_1,σ_2.</p>
    <p>The tuning of the parameters for RUV and HCP are described in the Supplementary Methods.</p>
    <p>2. Im missing a presentation of other recent methods that deal with removing batch effects without removing the biological signal. For example, HCP by Mustafavi, BCeF by Somekh etc.</p>
    <p>I’ve added comparisons to RUV [1] and HCP [2] in the manuscript and discussion of the results from those algorithms. BCeF [3] appears to be a framework to evaluate and compare different batch correction methods based on how closely they recapitulate a known gene co-expression matrix. They report that none of the batch correction methods is able to fully recapitulate all the unmodelled confounders. As I understand it, they do not propose any new batch correction methods.</p>
    <p>1. Gagnon-Bartsch JA, Speed TP. Using control genes to correct for unwanted variation in microarray data. Biostatistics. 2012;13: 539–552. doi:10.1093/biostatistics/kxr034</p>
    <p>2. Mostafavi S, Battle A, Zhu X, Urban AE, Levinson D, Montgomery SB, et al. Normalizing RNA-Sequencing Data by Modeling Hidden Covariates with Prior Knowledge. PLOS ONE. 2013;8: e68141. doi:10.1371/journal.pone.0068141</p>
    <p>3. Somekh J, Shen-Orr SS, Kohane IS. Batch correction evaluation framework using a-priori gene-gene associations: applied to the GTEx dataset. BMC Bioinformatics. 2019;20: 268. doi:10.1186/s12859-019-2855-9</p>
    <p>Minor issues:</p>
    <p>p.1. line 9 "Even though the effects..." - unclear sentence I’ve rewritten the sentence (p.1. line 9)</p>
    <p>p.1. line 22 - very long sentence with too many parentheses. I’ve rewritten the sentence (p.1. line 23)</p>
    <p>p.2. l 34 - "or biological" - should be just experimental here? I have tried to differentiate between batch effect caused due to unknown technical effects from that due to biological effects (in p.2. line 37). Most batch correction methods (e.g. ComBat) remove both, but BESC attempts to remove only the technical differences.</p>
    <p>p.4 - some mistake for gij on the jth gene? not enough explanation on gamma and the factors. I’ve explained gamma and tried to make the batch effect term clearer. glj (note it is “l”, a lower case “L”) is the effect of the batch l on sample j. The dependence on the gene “i” is modeled by γ_"il" . (p.4. line 77)</p>
    <p>p 5 - need to add more explanation on the SVA formulas. so (3) is currently not fully clear. I had to read the SVA paper to understand. I’ve expanded the description (page 5)</p>
    <p>p 5 l.90 - sometimes ki and sometimes ik are used. Corrected (p.6. line 122)</p>
    <p>p 5 l.92 - should be "each gene" instead of "all genes"? Corrected (p.6. line 124)</p>
    <p>l 96 - length one is unclear I’ve made it clearer (p.6. line 128)</p>
    <p>l 98 - refine the English sentence I’ve re-written the sentence to make it clearer (p.7. 129-134)</p>
    <p>l 102 - please add: to remain the same, multiplied by some coefficient. I’ve added that phrase (p.7. line 137)</p>
    <p>p 12 line 246 - Figure not Fig. Figure 2A - please add explanation on what can be seen for SVA. I’ve updated the figure with results for RUV and HCA with description of the results for each algorithm (p.14. line 290)</p>
    <p>p. 15 line 294 - unclear sentence I’ve re-written the sentence (p.16. line 349)</p>
    <p>line 299 - for SVA, please add reference Added for SVA, RUV and HCP (p.17. line 353)</p>
    <supplementary-material content-type="local-data" id="pone.0231446.s012">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response-to-reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0231446.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231446.r003" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Helms</surname>
          <given-names>Volkhard</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Volkhard Helms</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Volkhard Helms</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">16 Jan 2020</named-content>
    </p>
    <p>PONE-D-19-17279R1</p>
    <p>Blind estimation and correction of microarray batch effect</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Varma,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that your manuscript may become acceptable after fixing a few remaining minor issues. Therefore, we invite you to submit a revised version of the manuscript that addresses the following 4 points:</p>
    <p>(1) The supplemental figures are not referenced in the main text. It is up to readers to detect that there are some supplemental figures and to try to figure out what they show. So please add some sentences in the main text and explain what the supplemental figures show, like you did in your reply to the reviewers.</p>
    <p>(2) Also, the legends of supplemental figures S5 to S7 should be improved.</p>
    <p>For example, the current legend of Fig. S5</p>
    <p>"S5 Fig: Consistency of calculated BES – Overlap between significant genes selected for</p>
    <p>MSS/MSI differences in validation set 2 for BES calculated on different subsets of</p>
    <p>the reference set."</p>
    <p>does not reflect your reply to the comment of reviewer #1:</p>
    <p>"I’ve included a plot of the fraction of common genes between the colon cancer/normal</p>
    <p>dataset (validation set 2) when corrected by sets of BES calculated on the 1st + 2nd</p>
    <p>split combined and the 3rd + 4th split combined (Supplementary Figure 5).</p>
    <p>There is a high degree of overlap (&gt;80% intersection) till the number of BES reaches 10.</p>
    <p>The BES start to diverge from 20 onwards and the overlap decreases."</p>
    <p>Similarly, the legends Figs. S6 and S7 could be improved.</p>
    <p>For example, the legend of Fig. S6 does not explain what the black, red and blue symbols are.</p>
    <p>The following small points refer to the line numbering of the revised manuscript with tracked changes</p>
    <p>(3) line 108: the disadvantages ... is -&gt; the disadvantages ... are</p>
    <p>(4) line 387: correct plural/singular in</p>
    <p>"We show that the batch effect between different datasets occupy a space"</p>
    <p>We would appreciate receiving your revised manuscript by Mar 01 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Volkhard Helms</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (if provided):</p>
    <p>The author has done a commendable job in addressing the points raised by the two reviewers.</p>
    <p>He has performed all requested additional analysis (reviewer #1) and comparisons to other tools (reviewer #2).</p>
    <p>The new analysis is convincing. The reply letter properly addresses all raised points.</p>
    <p>However, when looking at the revised version of the manuscript I felt that the presentation of the additional analysis (reviewer #1) in the manuscript could be improved, see points listed above.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231446.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Mar 2020</named-content>
    </p>
    <p>1) The supplemental figures are not referenced in the main text. It is up to readers to detect that there are some supplemental figures and to try to figure out what they show. So please add some sentences in the main text and explain what the supplemental figures show, like you did in your reply to the reviewers.</p>
    <p>Response:I have added text to the manuscript describing those analyses and their results (lines 223-235 and 297-309)</p>
    <p>2) Also, the legends of supplemental figures S5 to S7 should be improved. For example, the current legend of Fig. S5 "S5 Fig: Consistency of calculated BES – Overlap between significant genes selected for</p>
    <p>MSS/MSI differences in validation set 2 for BES calculated on different subsets of</p>
    <p>the reference set."does not reflect your reply to the comment of reviewer #1:</p>
    <p>"I’ve included a plot of the fraction of common genes between the colon cancer/normal</p>
    <p>dataset (validation set 2) when corrected by sets of BES calculated on the 1st + 2nd</p>
    <p>split combined and the 3rd + 4th split combined (Supplementary Figure 5).</p>
    <p>There is a high degree of overlap (&gt;80% intersection) till the number of BES reaches 10.</p>
    <p>The BES start to diverge from 20 onwards and the overlap decreases."</p>
    <p>Similarly, the legends Figs. S6 and S7 could be improved.</p>
    <p>For example, the legend of Fig. S6 does not explain what the black, red and blue symbols are.</p>
    <p>Response: I’ve update the legends and descriptions</p>
    <p>3) The following small points refer to the line numbering of the revised manuscript with tracked changes</p>
    <p>a. line 108: the disadvantages ... is -&gt; the disadvantages ... are</p>
    <p>b. line 387: correct plural/singular in "We show that the batch effect between different datasets occupy a space"</p>
    <p>Response: I have corrected these errors</p>
    <supplementary-material content-type="local-data" id="pone.0231446.s013">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0231446.s013.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231446.r005" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Helms</surname>
          <given-names>Volkhard</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Volkhard Helms</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Volkhard Helms</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Mar 2020</named-content>
    </p>
    <p>Blind estimation and correction of microarray batch effect</p>
    <p>PONE-D-19-17279R2</p>
    <p>Dear Dr. Varma,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Volkhard Helms</p>
    <p>Guest Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>The author has now properly addressed my remaining minor points.</p>
    <p>Reviewers' comments:</p>
  </body>
</sub-article>
<sub-article id="pone.0231446.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231446.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Helms</surname>
          <given-names>Volkhard</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Volkhard Helms</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Volkhard Helms</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231446" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">27 Mar 2020</named-content>
    </p>
    <p>PONE-D-19-17279R2 </p>
    <p>Blind estimation and correction of microarray batch effect </p>
    <p>Dear Dr. Varma:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Prof. Volkhard Helms </p>
    <p>Guest Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
