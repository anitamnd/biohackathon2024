<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8895921</article-id>
    <article-id pub-id-type="publisher-id">589</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-022-00589-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeSIDE-DDI: interpretable prediction of drug-drug interactions using drug-induced gene expressions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Eunyoung</given-names>
        </name>
        <address>
          <email>eykim@gist.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5109-9114</contrib-id>
        <name>
          <surname>Nam</surname>
          <given-names>Hojung</given-names>
        </name>
        <address>
          <email>hjnam@gist.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.61221.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 1033 9831</institution-id><institution>School of Electrical Engineering and Computer Science, </institution><institution>Gwangju Institute of Science and Technology (GIST), </institution></institution-wrap>Buk-gu, Gwangju, 61005 Republic of Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>9</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Adverse drug-drug interaction (DDI) is a major concern to polypharmacy due to its unexpected adverse side effects and must be identified at an early stage of drug discovery and development. Many computational methods have been proposed for this purpose, but most require specific types of information, or they have less concern in interpretation on underlying genes. We propose a deep learning-based framework for DDI prediction with drug-induced gene expression signatures so that the model can provide the expression level of interpretability for DDIs. The model engineers dynamic drug features using a gating mechanism that mimics the co-administration effects by imposing attention to genes. Also, each side-effect is projected into a latent space through translating embedding. As a result, the model achieved an AUC of 0.889 and an AUPR of 0.915 in unseen interaction prediction, which is competitively very accurate and outperforms other state-of-the-art methods. Furthermore, it can predict potential DDIs with new compounds not used in training. In conclusion, using drug-induced gene expression signatures followed by gating and translating embedding can increase DDI prediction accuracy while providing model interpretability. The source code is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/GIST-CSBL/DeSIDE-DDI">https://github.com/GIST-CSBL/DeSIDE-DDI</ext-link>).</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-022-00589-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Drug-drug interaction</kwd>
      <kwd>Polypharmacy side effects</kwd>
      <kwd>In silico prediction</kwd>
      <kwd>Deep learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            <institution>National Research Foundation of Korea</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NRF-2020R1A2C2004628</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nam</surname>
            <given-names>Hojung</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003621</institution-id>
            <institution>Ministry of Science, ICT and Future Planning</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NRF-2017M3A9C4092978</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nam</surname>
            <given-names>Hojung</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par12">Polypharmacy has resulted in an increasing number of patients taking multiple drugs simultaneously. This can be problematic because drug interactions can alter the intended responses. In some cases, it leads to unexpected side effects or decreased clinical efficacy. This phenomenon is commonly referred to as a drug-drug interaction (DDI). Identifying potential DDIs in advance is crucial because the most vulnerable people in society (e.g., older people and multimorbid patients) are the primary targets of polypharmacy.</p>
    <p id="Par13">DDIs are generally found through experimentation. However, in vitro and in vivo identification of DDIs are largely infeasible, owing to patient safety and ethical considerations that increase time and costs. Furthermore, major polypharmacy side effects are difficult to identify from small trials and cohorts [<xref ref-type="bibr" rid="CR1">1</xref>]. Therefore, computational approaches have been developed. Many computational approaches use datasets retrieved from past studies, electronic health records, and social media [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. Similarity-based and network-based approaches were commonly used in predicting DDIs. Contemporary similarity-based approaches assume that similar drugs may have similar interactions. Such similarities are obtained based on drug structures, targets, ontologies, and side effects, which are utilized as features for machine-learning training [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. In the case of network-based approaches, novel interactions are inferred via network analyses. Interactions are predicted using label propagation or newly calculated features [<xref ref-type="bibr" rid="CR10">10</xref>]. Additionally, various graph-embedding algorithms have been proposed using graph analysis, showing potentially effective network-based features [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par14">Recently, deep learning has demonstrated outstanding performance in various domains, including DDI prediction tasks. Deep neural networks have been applied to prediction models using various drug features. Previously, DeepDDI, which comprises eight hidden layers, was developed to consider the structural similarities of two drugs [<xref ref-type="bibr" rid="CR19">19</xref>]. Another model (i.e., DDIMDL) was constructed based on the similarity assumption, and its architecture is a multimodal deep neural network that comprises separate models of each similarity [<xref ref-type="bibr" rid="CR20">20</xref>]. Unlike traditional approaches that predict the possibility of interactions, two proposed models are multi-class classifiers that indicate interaction types presenting the ability of predicting specific side effect types. Additionally, graph neural networks (GNNs) have improved the performance of graph- or node-embedding approaches. Decagon operated graph convolutional networks on a heterogeneous network comprised of DDIs, protein–protein interactions (PPIs), and drug-target interactions [<xref ref-type="bibr" rid="CR21">21</xref>]. The model updates node features in consideration of side-effect-related neighbor nodes and further predicts whether drug combinations have interactions. GNNs were applied to predict DDIs with consideration of indirect interactions and to represent compound structures [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR25">25</xref>]. Moreover, GNNs have been employed on both compounds and interactions networks achieving good performance [<xref ref-type="bibr" rid="CR26">26</xref>]. Recently, the National Institutes of Health conducted the Library of Integrated Network-based Cellular Signatures (LINCS) L1000 project, which provides drug-induced gene expression profile information under various conditions [<xref ref-type="bibr" rid="CR27">27</xref>]. Transcriptome-level information is provided that describes detailed drug responses. A recent study proposed an artificial neural network (ANN) that uses L1000 data [<xref ref-type="bibr" rid="CR28">28</xref>] for gene expression, gene ontology, and compound fingerprint information as features. Their proposal includes a multi-label classification ANN model with three simple hidden layers. However, the performance of the model is relatively poor compared with previous deep-learning models, indicating the need for a more sophisticated method of handling transcriptome signals.</p>
    <p id="Par15">Notwithstanding the numerous extant studies, many problems are waiting to be solved. First, most studies utilized structures and/or properties of the drug compound while less concerning interpretation on molecular levels of drug response signals. Because the prediction models only used features originating from compounds, the models cannot capture the characteristics of the DDI mechanism derived from drug treatments. Second, predicting the interactions of new compounds not used in training remains a significant challenge. To address these issues, we developed a deep-learning strategy for interpretable prediction of DDIs that leverages drug-induced gene expression signatures (DeSIDE-DDI). As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we designed to predict triplets that represent the relationship between one drug pair and one side effect. When representing drugs, we use drug-induced gene expressions to account for how drugs affect gene expression changes. To allow the utilization of all possible compounds, we develop a feature generation model. A gate unit is then applied to drug features to mimic drug co-administration effects by imposing attention to important genes, which engineers dynamic features of one drug when combined with others. Then, each feature is projected to each side-effect space in the score calculation module. The robustness of our models was verified through several rigorous tests. Overall, the proposed model was confirmed to be an accurate and interpretable DDI prediction model for predicting potential side-effects among drug combinations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the drug-drug interaction (DDI) prediction model. <bold>A</bold> Datasets are preprocessed for each feature generation model and DDI prediction model. <bold>B</bold> Given drug-pair and side-effect data, each drug feature is obtained using a feature generation model and a side effect is embedded to latent space; then, drugs pass through neural networks having gated linear units to consider the pair information. Finally, using latent representations of drugs and the side effect, the side-effect score is calculated. <bold>C</bold> The model is evaluated considering three DDI cases. <bold>D</bold>, <bold>E</bold> The independent dataset from DrugBank is used for external validation</p></caption><graphic xlink:href="13321_2022_589_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Datasets</title>
      <p id="Par16">Our model consists of two parts: one of feature generation and another of DDI prediction. The feature generation model generates drug-induced gene expression, which uses compound structures and property information for inputs and outputs predicted gene expressions. The gold-standard dataset of the model is the LINCS L1000 database [<xref ref-type="bibr" rid="CR27">27</xref>]. These data contain gene expression profiles of multiple cell lines treated with thousands of chemicals at different time points and doses. Among the different levels of L1000 data, we used the level-5 data, which provide differential gene expression signatures. First, we extracted signatures of 978 landmark genes that were directly measured for confidence. Then, because each gene expression signature of a compound was taken under various sets of experimental conditions, we used “Signature Strength” (SS), which is the representative signature of a compound showing the most significant change [<xref ref-type="bibr" rid="CR29">29</xref>]. Finally, we selected organic compounds and obtained gene expression signatures of 19,156 compounds (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>LINCS L1000 data statistics of feature generation model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Raw signature information (drug-induced only)</th><th align="left">Processed</th></tr></thead><tbody><tr><td align="left">#Compounds</td><td align="left">20,413</td><td align="left">19,156</td></tr><tr><td align="left">#Cell lines</td><td align="left">72</td><td align="left">58</td></tr><tr><td align="left">#Genes</td><td align="left">12,328</td><td align="left">978</td></tr><tr><td align="left">#Response signatures</td><td align="left">251M</td><td align="left">18M</td></tr></tbody></table></table-wrap></p>
      <p id="Par17">To train the DDI prediction model, two DDI datasets were used in our study: TWOSIDES and DrugBank [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. The TWOSIDES database provides processed polypharmacy side effects retrieved from the US Food and Drug Administration adverse reporting systems. We downloaded BioSNAP, which is an additionally refined dataset of TWOSIDES [<xref ref-type="bibr" rid="CR32">32</xref>]. We filtered out uncommon side effects from the raw data that occurred with less than 500 drug combinations, as performed by previous studies. Finally, we obtained 4,576,287 interactions between 63,472 drug combinations and 963 side effects. Also, DrugBank data were used for external validation. We downloaded old and new versions of DrugBank (v. 5.0.0 and 5.1.7). Only DDIs were extracted from the raw extended markup-language file, each containing 33,497 interactions among 1129 drugs and 782,405 interactions among 2616 drugs. The details of data statistics are listed in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Data statistics of DDI prediction model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Database</th><th align="left">#Drugs</th><th align="left">#Drug combinations</th><th align="left">#DDI types</th><th align="left">#Triplets</th></tr></thead><tbody><tr><td align="left">TWOSIDES</td><td char="." align="char">645</td><td align="left">63,472</td><td align="left">963</td><td align="left">4,576,287</td></tr><tr><td align="left">DrugBank (ver5.0.0)</td><td char="." align="char">1129</td><td align="left">33,497</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">DrugBank (ver5.1.7)</td><td char="." align="char">2616</td><td align="left">782,405</td><td align="left">–</td><td align="left">–</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Feature preprocessing</title>
      <p id="Par18">We used compound structures and properties as features to train the feature generation model. All compounds were standardized using canonical SMILES. Then, the Morgan fingerprints and compound properties were retrieved using Mordred [<xref ref-type="bibr" rid="CR33">33</xref>]. Mordred provides 1613 2-dimensional and 213 3-dimensional compound properties, and 771 properties were obtained after removing not-a-numbers. Then, to use the most significant features, we performed random-forest feature selection and selected the top-100 significant compound properties (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Selected features were scaled between zero and one for each feature type because the range of each feature varied. The above process was completed for all compounds of LINCS and TWOSIDES, and the scaling range was based on LINCS compounds because the model was trained with it. In the case of external data identifiers (IDs) compound ID (CID) conversion from DrugBank ID to PubChem CID was done for DrugBank compounds to check duplicates between datasets. Only compounds having SMILES information were extracted, and corresponding interactions were filtered, including mirror pair removal.</p>
    </sec>
    <sec id="Sec5">
      <title>Feature generation model</title>
      <p id="Par19">The purpose of the feature generation model is to generate a vector of drug-induced gene expression given a compound. The model was trained with LINCS L1000 data. Compound structures were represented as fingerprints and properties were used as input features; each value passed a simple dense neural network. Then, both latent representations were concatenated to output 978-dimensional vectors. The model was trained and evaluated by the cross-validation method to train with as many data points as possible. Owing to the relatively small data size compared with the feature dimension, various techniques were used to handle overfitting, such as the L2 regularizer with batch normalization. Furthermore, the cosine annealing method, a learning-rate scheduling method that avoids the local minimum, was used. As a loss function, we used the mean-squared error, whose formula is: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{{\text{n}}}\mathop \sum \limits_{{{\text{i}} = 1}}^{{\text{n}}} \left( {{\text{y}}_{{{\text{pred}}}} - {\text{y}}_{{{\text{true}}}} } \right)^{2} ,$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mtext>n</mml:mtext></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mtext>n</mml:mtext></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mtext>y</mml:mtext><mml:mtext>pred</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mtext>y</mml:mtext><mml:mtext>true</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq1.gif"/></alternatives></inline-formula> where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{y}}_{{{\text{pred}}}}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mtext>y</mml:mtext><mml:mtext>pred</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{y}}_{{{\text{true}}}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mtext>y</mml:mtext><mml:mtext>true</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq3.gif"/></alternatives></inline-formula> each indicates predicted and actual labels. The specification of the feature generation model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.</p>
    </sec>
    <sec id="Sec6">
      <title>DDI prediction model</title>
      <p id="Par20">The DDI prediction model takes inputs in the form of triplet (i.e., drug <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M8"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq4.gif"/></alternatives></inline-formula>, drug <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M10"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq5.gif"/></alternatives></inline-formula>, and side effect <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M12"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq6.gif"/></alternatives></inline-formula>). First, drug features are engineered through a gating mechanism to represent the co-administration effects of drug pairs. Drug feature formulation is the process of selecting important genes related to interactions between given drugs. Here, we applied gated linear units (GLUs) to adjust the information flow of each drug feature based on drug pairs [<xref ref-type="bibr" rid="CR34">34</xref>]. GLU is a simple gating mechanism originally developed for language models to control information propagating when passing layers as output gates with long short-term memory.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$GLU\left( {A,B} \right) = A \otimes \sigma \left( B \right).$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>⊗</mml:mo><mml:mi>σ</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="13321_2022_589_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par21">Equation (<xref rid="Equ1" ref-type="">1</xref>) takes two inputs, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M16"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M18"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq8.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M20"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq9.gif"/></alternatives></inline-formula> is the output of the former layer, which is the information to propagate, and the other <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M22"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq10.gif"/></alternatives></inline-formula> is the input of the gate <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M24"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq11.gif"/></alternatives></inline-formula>, which controls how much of <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M26"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq12.gif"/></alternatives></inline-formula> to use by applying sigmoid non-linearity. With the element-wise multiplication of two parts, it works as an output gate. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B, two hidden layers of <italic>drug i</italic> and <italic>drug j</italic> were concatenated to represent co-administration and the dense layer was sigmoid-activated to output the same dimension as previous layers. Then, the vector is multiplied to the previous layer. Through multiplication, the vector works as a weight vector on gene expression values. Finally, an additional dense layer was followed for dimension reduction. Here, two dense layers, the one before co-administration module and one for dimension reduction, were shared between the two drugs to handle non-directionality of pairs.</p>
      <p id="Par22">Next, engineered drug features are projected into the side-effect space via translating embedding. Here, we applied the concept of translating embeddings [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. The embedding space represents each side effect, and both head and tail nodes each of which represents the start and the end point connected by a relation vector are given the drugs. Hence, a drug pair may have positive or negative interactions for a given side effect. Therefore, we considered a side effect as a relationship between two drugs and applied the margin-based loss function, implying positive pairs of drug combinations are positioned closely on the given side-effect space [<xref ref-type="bibr" rid="CR37">37</xref>]. To train the model, we calculated a score and used the margin-based loss as described in a previous paper [<xref ref-type="bibr" rid="CR23">23</xref>]. The score of a drug pair, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{i}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq14.gif"/></alternatives></inline-formula>, given side-effect <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M32"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq15.gif"/></alternatives></inline-formula>, is calculated by Eq. (<xref rid="Equ2" ref-type="">2</xref>).<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left( {d_{i} ,d_{j} ,r} \right) = \left| {\left| {M_{rh} h + r - M_{rt} t} \right|} \right|_{2} + \left| {\left| {M_{rh} t + r - M_{rt} h} \right|} \right|_{2} ,$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rh</mml:mi></mml:mrow></mml:msub><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rt</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rh</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rt</mml:mi></mml:mrow></mml:msub><mml:mi>h</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13321_2022_589_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h$$\end{document}</tex-math><mml:math id="M36"><mml:mi>h</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M38"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq17.gif"/></alternatives></inline-formula> are embedding vectors of entities that are drug latent representations, <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M40"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq18.gif"/></alternatives></inline-formula> is an embedding vector of a relation, and <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{rh}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rh</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{rt}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">rt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq20.gif"/></alternatives></inline-formula> are mapping matrices multiplied to <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h$$\end{document}</tex-math><mml:math id="M46"><mml:mi>h</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M48"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq22.gif"/></alternatives></inline-formula> to project drug features to side effect spaces, respectively. Here, we considered either direction because drug combination data do not have directionality. Then, the L2 norm was applied to calculate the distances. The specification of the DDI prediction model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4.</p>
      <p id="Par23">The final output is the score (distance) of a triplet. Therefore, to train the model, a margin-based loss was used. The loss is defined as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = \mathop \sum \limits_{{\left( {r \in R_{se} } \right)}} {\text{max}}\left( {0,\mathop \sum \limits_{{\left( {d_{i} ,{ }d_{j} } \right)^{ + } \in D_{r} }} S\left( {\left( {d_{i} ,{ }d_{j} } \right)^{ + } ,r} \right) - \mathop \sum \limits_{{\left( {d_{i} ,{ }d_{j} } \right)^{ - } \in D_{r} }} S\left( {\left( {d_{i} ,{ }d_{j} } \right)^{ - } ,r} \right) + margin} \right),$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">se</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:munder><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13321_2022_589_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{se}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">se</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq23.gif"/></alternatives></inline-formula> represents side effects, <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{r}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq24.gif"/></alternatives></inline-formula> represents a set of drug pairs given a side effect, <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ }r$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mrow/><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq25.gif"/></alternatives></inline-formula> containing both positive and negative pairs marked as ±. The classification model was trained to derive the scores that differ by the margin between positives and negatives.</p>
    </sec>
    <sec id="Sec7">
      <title>Experimental setup</title>
      <p id="Par24">To test the robustness of the model in a rigorous way, we prepared differently split datasets for each evaluation. The first test predicted unknown interactions between known drugs (i.e., “unseen” interactions). Here, a known drug is the one used to train the model. The second case predicted interactions between a known drug and an unknown drug, meaning that either drug is seen in the model by training. We refer to this case as “one-unseen” drug. The last case (i.e., “both-unseen” drug) predicted interactions between arbitrary drugs that were not used for training the model. The first case contains the objectives of previous studies; thus, we compared our model using this condition. However, the latter two cases were more challenging because the drugs were not learned by the model, resulting in insufficient information during the training phase.</p>
      <p id="Par25">We split the dataset based on each case and data type for training, validation, and testing. First, for the case of unseen interaction prediction, we split the total triplets into training and testing at a ratio of nine-to-one. Then, 1% of the training set was sampled for validation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Moreover, negative triplets were obtained for each set by randomly sampling <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq26.gif"/></alternatives></inline-formula> for each (<inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{i} , r$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2022_589_Article_IEq27.gif"/></alternatives></inline-formula>) as in a previous study [<xref ref-type="bibr" rid="CR21">21</xref>]. The negatives were sampled so that the ratio of positives to negatives to be equal (see Additional file1: Table S7, Fig. S2, and Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Triplets were selected to be exclusive to all sets. Moreover, the reversed pairs are considered for all datasets, because drug pairs do not have directionality—drug 1–drug 2 and drug 2–drug 1 should have the same side effects.</p>
      <p id="Par26">For evaluation, we compared the prediction performance with previous studies—one is the first paper for predicting polypharmacy side effects using graph convolutional networks, and the other utilized the L1000 data [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Especially we implemented the ANN model to predict with our dataset because the proposed architecture can be applied for ‘one-unseen’ and ‘both-unseen’ cases.</p>
      <p id="Par27">The parameters of each model are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5, S6. In the feature generation model, we compared the performances of models with different lengths of fingerprints, and the best case was selected. The different embedding sizes in the DDI model were tested, but there were no significant differences in performance. Moreover, different sizes of input features were tested on DDI model to examine whether the size of gene expression features affects model performance. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11, the original features performed the best despite its dimension and also allowed feature analysis.</p>
    </sec>
    <sec id="Sec8">
      <title>External validation process</title>
      <p id="Par28">We downloaded and preprocessed two versions of DrugBank (versions 5.0.0 and 5.1.7) for external validation. We first predicted potential DDIs using the old version (v. 5.0.0, released 2016) and evaluated the prediction performance against the new version (v. 5.1.7, released 2020) by checking if the predicted potential DDIs can be found in the new version. For this purpose, the 603,259 unknown drug pairs obtained to exclude positive pairs from all possible drug combinations of DrugBank 5.0.0 drugs were predicted. The input of our model was designed to intake a triplet of two drugs and their corresponding side effects, whereas the DrugBank provides DDI information with no explicit side-effect terms (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2). Therefore, to manage the knowledge discrepancy of the two databases, we constructed positive and negative DDI datasets for DrugBank using the following procedures. First, to construct the positive DDI dataset, we collected drug pairs that were reported as having side effects. Next, for the negative DDIs, the negative drug pairs were obtained by excluding positive drug pairs from all possible drug combinations. Then, to evaluate prediction results with a triplet form of representation from our model, we referred to the average number of side effects of the drug pair in TWOSIDES and used the average value as the cutoff for determining the DDI positive (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). The average number of side effects for each drug pair was ~ 65; thus, hence pairs having more than 65 side effects were labeled “positive” and “negative” otherwise.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <sec id="Sec10">
      <title>Performance evaluation of gene-expression generation model</title>
      <p id="Par29">The feature generation model was trained using the entire LINCS L1000 dataset, and the performance was evaluated by how closely it predicted the actual expression values. We used the Pearson correlation coefficients between the golden standards and predicted expression values as an evaluation metric. The distribution of expression values can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3. The feature model was selected considering both metrics via tenfold cross-validation and further validated through external validation by splitting dataset into train-test sets. To achieve better performance, we trained for 1000 epochs and checked the loss and Pearson correlation coefficient (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5, Table S8). The model achieved a correlation of 0.518 and a training loss of 1.834. The performance comparisons with models using different features are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4. Moreover, the distributions of true expression values from LINCS and predicted values for TWOSIDES are compared as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6. The chosen model was then trained with the entire dataset to check all compounds because the dataset was relatively small.</p>
    </sec>
    <sec id="Sec11">
      <title>Performance evaluation of DDI prediction</title>
      <p id="Par30">The performance of the proposed model was evaluated under robust conditions. We used three test datasets that were exclusive to training: unseen interaction, one-unseen, both-unseen (see <xref rid="Sec2" ref-type="sec">Materials and methods</xref> section for details). The first case is the general case of predicting new interactions between known drugs; this is the focus of most extant reports. The area-under-the-curve (AUC) and the area-under-the-precision-recall (AUPR) values were calculated using the prediction scores (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Additional Materials and Methods). Sensitivity and specificity values of each side effect were calculated using the optimal threshold values (see the section “<xref rid="Sec7" ref-type="sec">Experimental setup</xref>”). As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the prediction model presented high performance with an AUC of 0.889 and an AUPR of 0.915 for unseen interactions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). We noticed that the model showed varied performance for each side effect. The best and worst performing side effects are listed in Table <xref rid="Tab3" ref-type="table">3</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Model performances of each DDI prediction case. The model performances are the average values of all side effect results. We compared our models to Decagon (orange) and the ANN model; from Shankar et al. (green). <bold>A</bold> Our model showed good performances compared to previous studies. The performance of ANN model is implemented results with our dataset, while the reported performances in the original paper are AUC of 0.634, accuracy of 0.787, and F1 of 0.631 obtained by averaging prediction performances of 243 side effects. <bold>B</bold>, <bold>C</bold> Decagon was not applicable to predict unseen drugs, and the ANN model was implemented</p></caption><graphic xlink:href="13321_2022_589_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Best- and the worst-performing side effects</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="3">Best-performing side effects</th><th align="left" colspan="3">Worst-performing side effects</th></tr><tr><th align="left">Side-effect Name</th><th align="left">AUC</th><th align="left">AUPR</th><th align="left">Side-effect Name</th><th align="left">AUC</th><th align="left">AUPR</th></tr></thead><tbody><tr><td align="left">Hypermetropia</td><td char="." align="char">0.963</td><td char="." align="char">0.967</td><td align="left">Brain abscess</td><td char="." align="char">0.803</td><td char="." align="char">0.848</td></tr><tr><td align="left">Epicondylitis</td><td char="." align="char">0.954</td><td char="." align="char">0.962</td><td align="left">Renal colic</td><td char="." align="char">0.814</td><td char="." align="char">0.853</td></tr><tr><td align="left">Pneumoconiosis</td><td char="." align="char">0.953</td><td char="." align="char">0.961</td><td align="left">Impetigo</td><td char="." align="char">0.817</td><td char="." align="char">0.856</td></tr><tr><td align="left">Fibrosing alveolitis</td><td char="." align="char">0.950</td><td char="." align="char">0.966</td><td align="left">Cerebral thrombosis</td><td char="." align="char">0.832</td><td char="." align="char">0.857</td></tr><tr><td align="left">Epididymitis</td><td char="." align="char">0.946</td><td char="." align="char">0.954</td><td align="left">Ejaculation premature</td><td char="." align="char">0.807</td><td char="." align="char">0.858</td></tr></tbody></table></table-wrap></p>
      <p id="Par31">In addition, we validated the DDI prediction model to confirm robustness. First, we investigated whether the model performance is related to the frequency of side effects or similarities between side effects. There were no significant correlations between performances and the frequency of side effects. Also, the model showed consistent performance regardless of side effect similarities and categories in terms of concept level (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S7, S8). Next, the triplets include cases where the side effect of one drug is equal to the polypharmacy side effect (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). However, it is hard to determine if a reported polypharmacy side effect is induced by either drug because the dataset is originally from FAERS. Therefore, we compared the predicted DDI scores between original pairs and either one drug in the pair, assuming that the model may output similar scores if polypharmacy side effects are highly correlated to single side effects. The pairs of the one-sided drugs resulted in different predicted scores while the original and reversed pairs showed similar scores resulting in the Pearson correlation coefficient of 0.952 and R<sup>2</sup> of 0.905 (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10).</p>
      <p id="Par32">Moreover, as the Decagon reported their best and worst lists, we compared our results similarly. Our model showed better AUPR in four out of the ten best-performing side effects and outperformed all worst-performing side effects by up to 23% (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10). To confirm the predictive power of the model, we extracted the prediction result of previously known fatal drug interactions. Warfarin, an anticoagulant, is known to have dangerous interactions with non-steroidal anti-inflammatory drugs (NSAIDs) resulting in serious bleeding, especially gastrointestinal (GI) bleeding. Also, amiodarone, which is one of the antiarrhythmic medications, is known to induce muscle-related pain when combined with statins. In the test set of unseen interactions, we found those drug pairs with several side effects. Our model correctly predicted those side effects and there are corresponding types as listed in Table <xref rid="Tab4" ref-type="table">4</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption><p>The list of previously known drug pairs and positively predicted side effects</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Drug 1</th><th align="left">Drug 2</th><th align="left">Predicted known side effects</th></tr></thead><tbody><tr><td align="left" rowspan="4">Warfarin</td><td align="left">Naproxen</td><td align="left">Bleeding gums, coughing blood, blood disorder, Epistaxis</td></tr><tr><td align="left">Ibuprofen</td><td align="left">Abdominal pain</td></tr><tr><td align="left">Indomethacin</td><td align="left">Lower GI bleeding, subarachnoid haemorrhage</td></tr><tr><td align="left">Meloxicam</td><td align="left">Haematochezia, malnourished</td></tr><tr><td align="left" rowspan="3">Amiodarone</td><td align="left">Loavastatin</td><td align="left">Arterial pressure NOS decreased, cramp</td></tr><tr><td align="left">Rosuvastatin</td><td align="left">Asystole</td></tr><tr><td align="left">Fluvastatin</td><td align="left">Rhabdomyolysis</td></tr></tbody></table></table-wrap></p>
      <p id="Par33">Next, for the “one-unseen” prediction problem, our model achieved an AUC of 0.640 and an AUPR of 0.627. Unlike the unseen interaction case, the Decagon model cannot be applied to “one-unseen” drug prediction because it uses a graph structure when representing interactions where nodes are fixed. In the case of the ANN model (Shankar et al.), it showed low performances, especially regarding AUPR (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). For the “both-unseen” case, the model showed limited performance. The average performances had an AUC of 0.553 and an AUPR of 0.556.</p>
      <p id="Par34">In all cases, our model performed better than previous models. Decagon shows a good performance in predicting unseen interactions, but it is not applicable to predict interactions with unseen drugs because unseen drugs are not connected to the network [<xref ref-type="bibr" rid="CR21">21</xref>]. Meanwhile, the ANN model worked by Shankar et al. could be implemented for case 2 and 3 [<xref ref-type="bibr" rid="CR38">38</xref>]. However, it showed relatively poor performance with our dataset. The performance drop might be the result of predicting more types of side effects while the original study focused on only 243 side effects. Furthermore, the ANN model concatenates all features resulting in high dimension features, and it may be challenging for a simple neural network to capture interactions with unseen drugs. The prediction performances for each side effect type are listed in Additional files <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, and <xref rid="MOESM6" ref-type="media">6</xref> for each case with detailed metrics including sensitivity, specificity and precision.</p>
      <p id="Par35">We also investigated which model contributed the most to performance improvement. The models without each feature generation model and DDI model were tested. Also, the model without the co-administration module of the GLU was compared. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the performance drastically dropped when DDI model with the GLU and the score calculation module was substituted with simple neural networks. Next, the performance slightly decreased without the GLU module while the model without the feature generation model showed little change in performance. This result indicates that both the co-administration module and the embedding contributed the most to the model performance.<fig id="Fig3"><label>Fig. 3</label><caption><p>Ablation study results on each DDI case. The differences in performance for each case—unseen interactions (<bold>A</bold>), one-unseen drug (<bold>B</bold>), and both unseen drugs (<bold>C</bold>). In all cases, the model without DDI prediction model (green) showed drastic decrease in performance which indicates that it contributed the most</p></caption><graphic xlink:href="13321_2022_589_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>External validation using DrugBank dataset</title>
      <p id="Par36">We next performed external validation using the DrugBank datasets. The validation process is described in <xref rid="Sec2" ref-type="sec">Materials and methods</xref> section. We made predictions for all possible pairs from DrugBank version 5.0.0, including 33,497 positive and 603,259 negative pairs from 1129 drugs. With the threshold of 65 obtained from the trained model, 9543 true positives and 137,201 false positives were detected. To validate the prediction performance of the model, we checked predicted DDIs in the earlier version (5.0.0) against the later version (5.1.7) to check whether predicted DDIs were found to be real DDIs in the future. Among 137,201 drug pairs, 53,322 drug pairs were detected in DrugBank v.5.1.7. As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, in the old version, only 6.50% were true positives; however, the proportion increased by 41.67% in the updated version. Moreover, the permutation test was performed to confirm that the number of found DDIs was significant. We randomly sampled 53,322 drug pairs 10,000 times and confirmed how many were found in the new version. Figure <xref rid="Fig4" ref-type="fig">4</xref>B shows the distribution of the number of confirmed DDIs of random sampling, and the red line indicates the number of confirmed DDIs of the predicted result with a p-value of 0.0001. The validated drug pairs consist of all three cases—most were one-unseen and both-unseen drug cases—confirming that our DDIs prediction model has a high potential to detect unknown DDIs among drugs (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>C and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14 for details).<fig id="Fig4"><label>Fig. 4</label><caption><p>External validation with DrugBank datasets. <bold>A</bold> Change in the proportions of true positives and false positives predicted in DrugBank verv5.0.0 compared with v.5.1.7. More than 35% of drug pairs were found to be interactions present in the new version. <bold>B</bold> Result of the permutation test. The grey distribution is from 10,000 random samplings, and the red line indicates the number of drug pairs found in the updated DrugBank version. <bold>C</bold> Proportion of each DDI case of validated drug pairs. Most cases were one-unseen and both-unseen drug cases</p></caption><graphic xlink:href="13321_2022_589_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Prediction of potential drug combinations</title>
      <p id="Par37">We further investigated the potential novel DDIs, which were not reported in the TWOSIDES database. Among the positively predicted drug pairs with ten different models, we confirmed 2733 pairs out of 19,811 annotated as DDIs in the DrugBank database on an average. (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12). The part of validated interactions is listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9. With a stricter criterion of positively predicted from all models, we found 1072 potential DDIs that were not reported previously. (see Additional file <xref rid="MOESM7" ref-type="media">7</xref>) From this result, we can conclude that our proposed model shows robust prediction performance and can suggest potential DDIs.</p>
    </sec>
    <sec id="Sec14">
      <title>Exploration on drug features</title>
      <p id="Par38">One of the main contributions of this study is the engineering of dynamic drug features that represent drug co-administration effects. This concept was implemented by a gating mechanism that differentiates latent representations of a drug when it was co-administrated with the other. Here, we observed the changes of latent drug representations of cyclophosphamide, which is one of the anticancer drugs. There were 318 drug pairs that were reported to have side effects when taken together with cyclophosphamide. We examined the changed features of cyclophosphamide in combinations with other drugs. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>A and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S15, we confirm that the latent representation of the cyclophosphamide varied with the paired drugs. Representation of each gene for DDIs were multiplied by the existing latent features according to their importance to generate different latent representations.<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of drug dynamic features.<bold> A</bold> Visualization of changes in compound treated gene expressions depending on co-administered drugs. The heatmap shows the changed features of one drug affected by each paired drug. Hierarchical clustering was done considering the correlation of features, and drug categories of each cluster were labeled. <bold>B</bold> Pathway information of cyclophosphamide and celecoxib. Among highly attended genes, ADH5 in chyclophosphamide pathway and PLA2G4A, TBXA2R, and CDKN1A genes in celecoxib pathway were detected as highlighted in red</p></caption><graphic xlink:href="13321_2022_589_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par39">The following result shows that the model can capture the response of a same drug differently depending on the drug with which it is combined. Additionally, we analyzed which drugs had similar effects by clustering the latent representation values. Moreover, we checked whether the drugs of each cluster had any characteristics by examining the drug categories that are defined in DrugBank. We confirmed the Anatomical Therapeutic Chemical (ATC) codes of the drugs for each cluster and selected the code that appeared most through the enrichment test [<xref ref-type="bibr" rid="CR39">39</xref>]. The therapeutic classes are not all exclusive, but representative classes are illustrated. Because the cluster 1, 2, and 3 consist of small number of drugs, there exist overlapping ATC codes. The most enriched codes in cluster 1 and 2 are ‘other gyncologicals’ and ‘drugs for constipation’. In the case of cluster 3, ‘dermatologicals’, ‘vitamins’, and ‘nasal preparations’ are unique codes, one of each was included. Among them, ‘nasal preparations’ is unique in all drug pairs with cyclophosphamide. The major cluster included various exclusive classes such as ‘antimycotics for systemic use’ and ‘lipid modifying agents’. The total list of ATC codes are listed in Additional file <xref rid="MOESM8" ref-type="media">8</xref>. Also, different side effect occurrences were detected for each cluster as listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S11. Finally, analysis on important genes was performed based on the attention values of each gene feature calculated via a GLU. Assuming that the genes receiving high attention values would be important for a given DDI, we analyzed highly attended genes in the interaction between cyclophosphamide and celecoxib using the pathway information obtained from the PharmGKB database [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. Based on each vector calculated from the two-drug information, 100 genes having the highest values were extracted. Then, we confirmed whether any genes corresponded to pathway-related genes. Hence, the ADH5 in the cyclophosphamide pathway and the PLA2G4A, CDKN1A, and TBXA2R in the celecoxib pathway were found among the top-100 genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). This result indicates that the GLU can capture molecular information from drug-induced gene expressions.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par40">In this study, we proposed a robust deep-learning model for predicting polypharmacy side effects. The main contribution of our work includes the construction of a gene-expression feature generation model that produces drug-treated gene expression signatures, the application of a gating mechanism to represent the co-administration effect of a drug pair, and a report of potential DDIs among drug pairs.</p>
    <p id="Par41">First, our model utilized gene-expression data to predict DDIs. Differing from previous studies that simply used structures or properties of drugs, our model used a gene-expression signal that represents the holistic view of the drug-induced effects of cells. However, because not all compounds had compound-treated gene-expression signatures, our model included a pre-trained feature generation model to produce compound features. We used compound structure and property information to generate expected compound-treated gene expressions. Then, the DDI prediction model processed expression features to output defined side-effect scores. The model was evaluated under three cases: predicting unseen interactions, one-unseen drug, and both-unseen drugs. For each case, data were split into training and testing sets for strict evaluation. The model showed competitive performance compared with previous studies of predicting unseen interactions.</p>
    <p id="Par42">Second, to mimic the effect of co-administration, we applied feature processing with respect to a gating mechanism, and the KG embedding algorithm was applied to handle multiple side effects per drug pair. Through the co-administration module, we aimed to reflect the changes in features by the other drug. Additionally, the translating embedding module resulted in a dramatic increase in performance.</p>
    <p id="Par43">Third, we reported potential DDIs that were not reported before. Based on the external validation using the DrugBank database, we can expect that the list of potential DDIs will help prevent harmful effects from co-administration. Furthermore, because the model can predict interactions with unseen drugs, it can possibly pre-detect unwelcomed reactions among compounds during the early drug-discovery process.</p>
    <p id="Par44">There still exist issues to be improved in the future. First, the datasets in this case were very sparse in terms of side-effect type. The small proportion of interactions between drugs were known, but the numbers were extremely sparse and imbalanced when considered with relation type. For this reason, rare side effects were excluded for the current model. This can be overcome with a combination of disease-related information, including pathways. Second, the identification of the side-effect mechanism remains challenging. Although our model utilized gene expression data, only a portion of human genes was selected, and the heterogeneity of cell lines induced noise. We constructed the feature generation model to supplement lack of experimental data, however, predicting transcriptiome-level features from drug structures and properties is both challenging and limited. With enriched drug response and network information signaling, all underlying mechanisms may soon be uncovered.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2022_589_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Additional information. Additional description on Materials and Methods, Results with Figures and Tables.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13321_2022_589_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2. </bold>LINCS compound properties. Total list of compound properties used for the feature generation model and each value.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13321_2022_589_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3. </bold>The number of positive and negative triplets for each side effect type. Detailed number of triplets for each side effect type in Case 1 dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13321_2022_589_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4. </bold>DDI prediction model performance for Case 1. Side effect specific performance of DDI model in Case 1 (unseen interactions).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13321_2022_589_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5. </bold>DDI prediction model performance for Case 2. Side effect specific performance of DDI model in Case 2 (one-unseen drug).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13321_2022_589_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6. </bold>DDI prediction model performance for Case 3. Side effect specific performance of DDI model in Case 3 (both unseen drugs).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13321_2022_589_MOESM7_ESM.xlsx">
            <caption>
              <p><bold>Additional file 7. </bold>List of predicted DDIs. The list of positively predicted triplets in unseen interactions test set. The validation labels from DrugBank are annotated.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="13321_2022_589_MOESM8_ESM.xlsx">
            <caption>
              <p><bold>Additional file 8. </bold>The list of ATC codes of drugs in each cluster from dynamic drug features of cyclophosphamide. The second level of ATC codes was obtained which represents therapeutic subgroups. The list is sorted by the odds ratio of the number of drugs in the cluster over the total number of drugs with the code.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DDI</term>
        <def>
          <p id="Par2">Drug-drug interaction</p>
        </def>
      </def-item>
      <def-item>
        <term>LINCS</term>
        <def>
          <p id="Par3">Library of integrated network-based cellular signatures</p>
        </def>
      </def-item>
      <def-item>
        <term>ANN</term>
        <def>
          <p id="Par4">Artificial neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>SS</term>
        <def>
          <p id="Par5">Signature strength</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par6">Simplified molecular-input line-entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>GLU</term>
        <def>
          <p id="Par7">Gated linear unit</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par8">Area-under-the-curve</p>
        </def>
      </def-item>
      <def-item>
        <term>AUPR</term>
        <def>
          <p id="Par9">Area-under-the-precision-recall</p>
        </def>
      </def-item>
      <def-item>
        <term>NSAIDs</term>
        <def>
          <p id="Par10">Non-steroidal anti-inflammatory drugs</p>
        </def>
      </def-item>
      <def-item>
        <term>ATC</term>
        <def>
          <p id="Par11">Anatomical therapeutic chemical</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>EK and HN conceptualized the study. EK implemented the model and performed experiments. EK prepared the initial draft. HN revised the manuscript and supervised the study. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Research Foundation of Korea (NRF) Grant funded by the Korea government (NRF-2020R1A2C2004628) and supported by the Bio-Synergy Research Project (NRF-2017M3A9C4092978) of the Ministry of Science, ICT.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/GIST-CSBL/DeSIDE-DDI">https://github.com/GIST-CSBL/DeSIDE-DDI</ext-link></p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par45">No competing interests are declared.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Menden</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A community computational challenge to predict the activity of pairs of compounds</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>1213</fpage>
        <lpage>1222</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3052</pub-id>
        <?supplied-pmid 25419740?>
        <pub-id pub-id-type="pmid">25419740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vilar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hripcsak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Detection of drug–drug interactions through data mining studies using clinical sources, scientific literature and social media</article-title>
        <source>Brief Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>5</issue>
        <fpage>863</fpage>
        <lpage>877</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx010</pub-id>
        <pub-id pub-id-type="pmid">28334070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Percha B, Garten Y, Altman RB (2012) Discovery and explanation of drug-drug interactions via text mining. Pac Symp Biocomput 410–421</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Percha</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>Informatics confronts drug-drug interactions</article-title>
        <source>Trends Pharmacol Sci</source>
        <year>2013</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>178</fpage>
        <lpage>184</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tips.2013.01.006</pub-id>
        <?supplied-pmid 23414686?>
        <pub-id pub-id-type="pmid">23414686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gottlieb</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>GY</given-names>
          </name>
          <name>
            <surname>Oron</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ruppin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sharan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>INDI: a computational framework for inferring drug interactions and their associated recommendations</article-title>
        <source>Mol Syst Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>592</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2012.26</pub-id>
        <pub-id pub-id-type="pmid">22806140</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferdousi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Safdari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Omidi</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Computational prediction of drug-drug interactions based on drugs functional similarities</article-title>
        <source>J Biomed Inform</source>
        <year>2017</year>
        <volume>70</volume>
        <fpage>54</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2017.04.021</pub-id>
        <?supplied-pmid 28465082?>
        <pub-id pub-id-type="pmid">28465082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Machine learning-based prediction of drug-drug interactions by integrating drug phenotypic, therapeutic, chemical, and genomic properties</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2014</year>
        <volume>21</volume>
        <issue>e2</issue>
        <fpage>e278</fpage>
        <lpage>286</lpage>
        <pub-id pub-id-type="doi">10.1136/amiajnl-2013-002512</pub-id>
        <?supplied-pmid 24644270?>
        <pub-id pub-id-type="pmid">24644270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Predicting combinative drug pairs towards realistic screening via integrating heterogeneous features</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>Suppl 12</issue>
        <fpage>409</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1818-2</pub-id>
        <?supplied-pmid 29072137?>
        <pub-id pub-id-type="pmid">29072137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Shi J-Y, Gao K, Shang X-Q, Yiu S-M (2016) LCM-DS: a novel approach of predicting drug-drug interactions for new drugs via Dempster-Shafer theory of evidence. In: 2016 IEEE international conference on bioinformatics and biomedicine (BIBM): IEEE, pp 512–515</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sorrentino</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Label propagation prediction of drug–drug interactions based on clinical side effects</article-title>
        <source>Sci Rep</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>12339</fpage>
        <pub-id pub-id-type="doi">10.1038/srep12339</pub-id>
        <?supplied-pmid 26196247?>
        <pub-id pub-id-type="pmid">26196247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Tang J, Qu M, Wang M, Zhang M, Yan J, Mei Q (2015) Line: large-scale information network embedding. In: proceedings of the 24th international conference on world wide web. pp 1067–1077</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grover</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>node2vec: scalable feature learning for networks</article-title>
        <source>KDD</source>
        <year>2016</year>
        <volume>2016</volume>
        <fpage>855</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1145/2939672.2939754</pub-id>
        <?supplied-pmid 27853626?>
        <pub-id pub-id-type="pmid">27853626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Perozzi B, Al-Rfou R, Skiena S (2014) Deepwalk: online learning of social representations. In: proceedings of the 20th ACM SIGKDD international conference on knowledge discovery and data mining. pp 701–710</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roweis</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Saul LKJs, </surname>
          </name>
        </person-group>
        <article-title>Nonlinear dimensionality reduction by locally linear embedding</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>290</volume>
        <issue>5500</issue>
        <fpage>2323</fpage>
        <lpage>2326</lpage>
        <pub-id pub-id-type="doi">10.1126/science.290.5500.2323</pub-id>
        <pub-id pub-id-type="pmid">11125150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Belkin M, Niyogi P (2001) Laplacian eigenmaps and spectral techniques for embedding and clustering. Nips, pp 585–591</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Cao S, Lu W, Xu Q (2015) Grarep: learning graph representations with global structural information. In: proceedings of the 24th ACM international on conference on information and knowledge management. pp 891–900</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Predicting pharmacodynamic drug-drug interactions through signaling propagation interference on protein-protein interaction networks</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>e0140816</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0140816</pub-id>
        <pub-id pub-id-type="pmid">26469276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Synergy evaluation by a pathway–pathway interaction network: a new way to predict drug combination</article-title>
        <source>Mol BioSyst</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>614</fpage>
        <lpage>623</lpage>
        <pub-id pub-id-type="doi">10.1039/C5MB00599J</pub-id>
        <pub-id pub-id-type="pmid">26687590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ryu</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Deep learning improves prediction of drug–drug and drug–food interactions</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2018</year>
        <volume>115</volume>
        <issue>18</issue>
        <fpage>E4304</fpage>
        <lpage>E4311</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1803294115</pub-id>
        <pub-id pub-id-type="pmid">29666228</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A multimodal deep learning framework for predicting drug–drug interaction events</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>15</issue>
        <fpage>4316</fpage>
        <lpage>4322</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa501</pub-id>
        <pub-id pub-id-type="pmid">32407508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zitnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Modeling polypharmacy side effects with graph convolutional networks</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>13</issue>
        <fpage>i457</fpage>
        <lpage>i466</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty294</pub-id>
        <pub-id pub-id-type="pmid">29949996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Chen X, Liu X, Wu J (2019) Drug–drug interaction prediction with graph representation learning. In: 2019 IEEE international conference on bioinformatics and biomedicine (BIBM): IEEE, pp 354–361</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Deac A, Huang Y-H, Veličković P, Liò P, Tang J (2019) Drug-drug adverse effect prediction with graph co-attention. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1905.00534">arXiv:1905.00534</ext-link></mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Zitnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SkipGNN: predicting molecular interactions with skip-graph networks</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-56847-4</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Xu H, Sang S, Lu H (2020) Tri-graph information propagation for polypharmacy side effect prediction. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2001.10516">arXiv:2001.10516</ext-link></mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Bai Y, Gu K, Sun Y, Wang W (2020) Bi-level graph neural networks for drug-drug interaction prediction. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2006.14002">arXiv:2006.14002</ext-link></mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Narayan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Corsello</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Natoli</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A next generation connectivity map: L1000 platform and the first 1,000,000 profiles</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>6</issue>
        <fpage>1437</fpage>
        <lpage>1452. e1417</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.049</pub-id>
        <pub-id pub-id-type="pmid">29195078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shankar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bhandari</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Okou</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Srinivasa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Athri</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Predicting adverse drug reactions of two-drug combinations using structural and transcriptomic drug representations to train an artificial neural network</article-title>
        <source>Chem Biol Drug Des</source>
        <year>2021</year>
        <volume>97</volume>
        <issue>3</issue>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1111/cbdd.13802</pub-id>
        <?supplied-pmid 33006799?>
        <pub-id pub-id-type="pmid">33006799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Ma’ayan A, </surname>
          </name>
        </person-group>
        <article-title>Drug-induced adverse events prediction with the LINCS L1000 data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>15</issue>
        <fpage>2338</fpage>
        <lpage>2345</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw168</pub-id>
        <pub-id pub-id-type="pmid">27153606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatonetti</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>PY</given-names>
          </name>
          <name>
            <surname>Daneshjou</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>Data-driven prediction of drug effects and interactions</article-title>
        <source>Sci Transl Med</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>125</issue>
        <fpage>125ra131</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.3003377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Feunang</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DrugBank 50: a major update to the DrugBank database for 2018</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D1074</fpage>
        <lpage>D1082</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1037</pub-id>
        <pub-id pub-id-type="pmid">29126136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Zitnik M, Sosic R, Leskovec J (2018) BioSNAP Datasets: Stanford biomedical network dataset collection. <ext-link ext-link-type="uri" xlink:href="http://snap.stanford.edu/biodata">http://snap.stanford.edu/biodata</ext-link></mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moriwaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>Y-S</given-names>
          </name>
          <name>
            <surname>Kawashita</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Takagi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Mordred: a molecular descriptor calculator</article-title>
        <source>J Cheminform</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-018-0258-y</pub-id>
        <pub-id pub-id-type="pmid">29340790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Dauphin YN, Fan A, Auli M, Grangier D (2017) Language modeling with gated convolutional networks. In: international conference on machine learning: PMLR, pp 933–941</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Bordes A, Usunier N, Garcia-Duran A, Weston J, Yakhnenko O (2013) Translating embeddings for modeling multi-relational data. In: neural information processing systems (NIPS). pp 1–9</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Yoon H-G, Song H-J, Park S-B, Park S-Y (2016) A translation-based knowledge graph embedding preserving logical property of relations. In: proceedings of the 2016 conference of the North American chapter of the association for computational linguistics: human language technologies. pp 907–916</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Lin Y, Liu Z, Sun M, Liu Y, Zhu X (2015) Learning entity and relation embeddings for knowledge graph completion. In: twenty-ninth AAAI conference on artificial intelligence</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shankar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bhandari</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Okou</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Srinivasa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Athri</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Predicting adverse drug reactions of two-drug combinations using structural and transcriptomic drug representations to train an artificial neural network</article-title>
        <source>Chem Biol Drug Des</source>
        <year>2021</year>
        <volume>97</volume>
        <issue>3</issue>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1111/cbdd.13802</pub-id>
        <pub-id pub-id-type="pmid">33006799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>World Health Organization</collab>
        </person-group>
        <source>WHO collaborating centre for drug statistics methodology, anatomical therapeutic chemical (ATC) classification index with defined daily doses (DDDs)</source>
        <year>2021</year>
        <publisher-loc>Oslo</publisher-loc>
        <publisher-name>World Health Organization</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whirl-Carrillo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McDonagh</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hebert</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sangkuhl</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thorn</surname>
            <given-names>CF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pharmacogenomics knowledge for personalized medicine</article-title>
        <source>Clin Pharmacol Ther</source>
        <year>2012</year>
        <volume>92</volume>
        <issue>4</issue>
        <fpage>414</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="doi">10.1038/clpt.2012.96</pub-id>
        <?supplied-pmid 22992668?>
        <pub-id pub-id-type="pmid">22992668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barbarino</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Staatz</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Venkataramanan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>PharmGKB summary: cyclosporine and tacrolimus pathways</article-title>
        <source>Pharmacogenet Genomics</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>10</issue>
        <fpage>563</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.1097/FPC.0b013e328364db84</pub-id>
        <?supplied-pmid 23922006?>
        <pub-id pub-id-type="pmid">23922006</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
