<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?covid-19-tdm?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5466706</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/gix003</article-id>
    <article-id pub-id-type="publisher-id">gix003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>drVM: a new tool for efficient genome assembly of known eukaryotic viruses from metagenomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Hsin-Hung</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liao</surname>
          <given-names>Yu-Chieh</given-names>
        </name>
        <!--<email>jade@nhri.org.tw</email>-->
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">Institute of Population Health Sciences, National Health Research Institutes, No. 35, Keyan Road, Zhunan Town, Miaoli County, 35053, Taiwan</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label>Correspondence: <email>jade@nhri.org.tw</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-01-20">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>6</volume>
    <issue>2</issue>
    <elocation-id>gix003</elocation-id>
    <history>
      <date date-type="accepted">
        <day>15</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="received">
        <day>25</day>
        <month>7</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>11</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gix003.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><bold>Background:</bold> Virus discovery using high-throughput next-generation sequencing has become more commonplace. However, although analysis of deep next-generation sequencing data allows us to identity potential pathogens, the entire analytical procedure requires competency in the bioinformatics domain, which includes implementing proper software packages and preparing prerequisite databases. Simple and user-friendly bioinformatics pipelines are urgently required to obtain complete viral genome sequences from metagenomic data.</p>
      <p><bold>Results:</bold> This manuscript presents a pipeline, drVM (detect and reconstruct known viral genomes from metagenomes), for rapid viral read identification, genus-level read partition, read normalization, <italic>de novo</italic> assembly, sequence annotation, and coverage profiling. The first two procedures and sequence annotation rely on known viral genomes as a reference database. drVM was validated via the analysis of over 300 sequencing runs generated by Illumina and Ion Torrent platforms to provide complete viral genome assemblies for a variety of virus types including DNA viruses, RNA viruses, and retroviruses. drVM is available for free download at: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sb2nhri/files/drVM/">https://sourceforge.net/projects/sb2nhri/files/drVM/</ext-link> and is also assembled as a Docker container, an Amazon machine image, and a virtual machine to facilitate seamless deployment.</p>
      <p><bold>Conclusions:</bold> drVM was compared with other viral detection tools to demonstrate its merits in terms of viral genome completeness and reduced computation time. This substantiates the platform's potential to produce prompt and accurate viral genome sequences from clinical samples.</p>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>next-generation sequencing (NGS)</kwd>
      <kwd>bioinformatics</kwd>
      <kwd>metagenomics</kwd>
      <kwd>detect</kwd>
      <kwd>reconstruct</kwd>
    </kwd-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>Viruses are the most abundant biological entities on Earth and are found among all cellular forms of life including animals, plants, bacteria, and fungi. More than 4500 viral species have been discovered; their sequence information has been collected by researchers [<xref rid="bib1" ref-type="bibr">1</xref>–<xref rid="bib3" ref-type="bibr">3</xref>]. Viruses have caused some of the most dramatic and deadly disease pandemics in human history and viral disease outbreaks tend to occur every several years. Over the past two decades, avian influenza H5N1 virus [<xref rid="bib4" ref-type="bibr">4</xref>], SARS coronavirus, H1N1 pandemic, MERS coronavirus [<xref rid="bib5" ref-type="bibr">5</xref>], Ebola virus [<xref rid="bib6" ref-type="bibr">6</xref>], and Zika virus [<xref rid="bib7" ref-type="bibr">7</xref>] have emerged in the human population. During such outbreaks, identification of the causative agent and comparative genome analysis is of cornerstone importance for disease surveillance and epidemiology. Unbiased next-generation sequencing (NGS) is emerging as an attractive approach for viral identification from varied samples, including blood, feces, sputum, and other swab samples [<xref rid="bib8" ref-type="bibr">8</xref>, <xref rid="bib9" ref-type="bibr">9</xref>]. The technique holds the promise to aid in the identification of potential pathogens in a single assay without a prior knowledge of the target [<xref rid="bib10" ref-type="bibr">10</xref>]. However, computational analyses for crude metagenomic deep-sequencing reads are extremely time-consuming.</p>
    <p>SURPI [<xref rid="bib10" ref-type="bibr">10</xref>] and Taxonomer [<xref rid="bib11" ref-type="bibr">11</xref>] are pathogen detection tools that have been proposed to rapidly analyze metagenomic NGS data for comprehensive diagnostic applications. However, both tools are incapable of complete viral genome assembly. VIP pursues the same strategy as SURPI, subtraction to identification, to subtract host and bacteria reads prior to the identification of viral reads, although it does provide an alternative strategy to the assembly of reads under a genus, classification to assembly, hence enabling improved viral genome assembly [<xref rid="bib12" ref-type="bibr">12</xref>]. Although VIP generates phylogenetic trees, thereby facilitating the visualization of genealogy between a candidate virus and existing reference sequences, it does not produce assembled viral sequences in its final report. Moreover, ease-of-use challenges associated with operating SURPI and VIP impede their applications in most laboratories and are often accessible only by trained personnel. VirusTAP is a web-based integrated NGS analysis tool for viral genome assembly from metagenomic reads [<xref rid="bib13" ref-type="bibr">13</xref>]. This user-friendly tool enables users to obtain viral genomes more easily by merely uploading raw NGS reads and clicking on several selections. However, VirusTAP only accepts Illumina data and does not support users to update reference databases. Therefore, tools for viral metagenomics analyses are urgently required that are substantially more computationally efficient, accurate (for compete viral genome assembly), and easy to use.</p>
    <p>Here we present drVM (detect and reconstruct known viral genomes from metagenomes), a bioinformatics pipeline that first provides rapid classification of NGS reads generated by Illumina or Ion Torrent sequencing technology against a viral database, then partitions the viral reads into genus groups, and finally <italic>de novo</italic> assembles viral genomes from the corresponding genus-level reads. For ease of deployment, a Docker container [<xref rid="bib14" ref-type="bibr">14</xref>], an Amazon machine image, and a virtual machine [<xref rid="bib15" ref-type="bibr">15</xref>] image were created for drVM. The performance of the platform was evaluated in the analysis of 349 sequence data in the Sequence Read Archive (SRA) from 18 independent studies [<xref rid="bib8" ref-type="bibr">8</xref>–<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib16" ref-type="bibr">16</xref>–<xref rid="bib29" ref-type="bibr">29</xref>]. These data sets encompass a variety of sample types, viruses, and sequencing depths. drVM was demonstrated to be highly adept at the detection and reconstruction of various known viral genomes and concomitantly outperforms other analytical pipelines including SURPI, VIP, and VirusTAP.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Materials and Methods</title>
    <sec id="sec2-1">
      <title>Reference databases</title>
      <p>Viral nucleotide sequences were obtained from the Nucleotide database of the National Center for Biotechnology Information (NCBI) using the query term “(complete[title]) AND (viridae[organism])”; this query resulted in 642 079 hits (as of 16 March 2016) and increased to 705 577 hits (as of 20 October 2016). Based on each sequence identifier (accession number) of the viral sequence, its taxonomic ID, scientific name, and genus-level annotation were separately obtained from the NCBI Taxonomy database. Viral sequences with taxonomy ID not included in the virus division (division id = 9), those with taxonomic information absent, and those lacking genus-level annotation were labeled “nonViral, “noTax,” and “noGenus,” respectively. The noGenus sequences can be used by adding “-kn on” option in the creation of databases. With the exception of noGenus sequences, those sequences with the nonViral or noTax labels were excluded from database construction. The remaining viral sequences were utilized as rawDB. Three hundred and seventy-seven viral genomes were obtained by filtering with host “human” from the NCBI viral genome resource to retrieve 684 sequences (1 March 2016) [<xref rid="bib1" ref-type="bibr">1</xref>]. The viral sequences were segmented into their corresponding genus level for refDB; the corresponding refDB was uploaded to SourceForge for later use (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sb2nhri/files/drVM/refDB.tar.gz">https://sourceforge.net/projects/sb2nhri/files/drVM/refDB.tar.gz</ext-link>). To increase read alignments and reduce memory requirements, rawDB was split into eight sub-databases, and each contained sequences with total length &lt;200 Mbp. SNAP (version 0.15.4) [<xref rid="bib30" ref-type="bibr">30</xref>], possessing a default seed size of 20, was used to generate index tables (snap_index_virus) for the viral sub-databases. In addition, a BLAST database (blast_index_virus) was created by makeblastdb (BLAST 2.2.28+) [<xref rid="bib31" ref-type="bibr">31</xref>] from rawDB to enable contig annotation.</p>
    </sec>
    <sec id="sec2-2">
      <title>Implementation of drVM</title>
      <p>The drVM pipeline is implemented in Python and incorporates several open-source tools, including BLAST, SNAP, and SPAdes [<xref rid="bib32" ref-type="bibr">32</xref>]. The package comprises two modules: CreateDB.py and drVM.py. A schematic flowchart of drVM is shown in Fig. <xref ref-type="fig" rid="fig1">1</xref>. In CreateDB.py, viral sequences (provided by the user) are processed to produce rawDB for SNAP and BLAST database construction, and refDB is downloaded from the SourceForge link. drVM.py takes single- or paired-end reads as input. It aligns reads to SNAP DB and, accordingly, identifies viral reads using the following parameters: snap single -x -h 250 -d 24 -n 25 -F a. Based on taxonomic information (genus-level annotation) of the aligned sequence, the viral reads are partitioned into genus-level groups. Each group is labeled according to its corresponding genus. By examining the aligned sequences with reads, sequence coverage and read depth are calculated. Maximum coverage and average depth for a genus are estimated by taking all aligned sequences corresponding to that genus into consideration. Viral reads in a genus with average depth more than or equal to min depth (default = 1) undergo <italic>de novo</italic> assembly via SPAdes (v.3.6.1). Prior to assembly, digital normalization [<xref rid="bib33" ref-type="bibr">33</xref>] in khmer [<xref rid="bib34" ref-type="bibr">34</xref>] is employed to remove reads with high-abundance (default = 100) k-mers. Using BLAST, each genus-level assembly is annotated to its closest reference against refDB using blastn (identity ≧80%). Each reference is examined to confirm that it contains at least a 50% alignment rate. If this procedure returns no hits, the assembly is annotated by BLAST against rawDB. Note that, although the viral sequences in refDB are restricted to human viruses, there is no filter by host option in rawDB. Reads are aligned to contigs by means of SOAP2 [<xref rid="bib35" ref-type="bibr">35</xref>] and the read-covered contigs are placed into a coverage plot with reference-guide coordinates. To increase contig continuity, reads aligned to contigs corresponding to a reference are extracted for pairs and those paired reads are re-assembled. This re-assembly process is only performed for paired-end reads.</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>A schematic flowchart of drVM. CreateDB.py processes viral sequences to produce SNAP and BLAST databases. drVM.py analyzes NGS reads to produce viral genomes.</p>
        </caption>
        <graphic xlink:href="gix003fig1"/>
      </fig>
    </sec>
    <sec id="sec2-3">
      <title>Simulation datasets</title>
      <p>A reference genome of the hepatitis C virus (HCV; NC_004102.1) was used to simulate metagenomes with 10×, 15×, 20×, 30×, 40×, and 50× viral reads using VirtualNextGenSequencer [<xref rid="bib36" ref-type="bibr">36</xref>]. The simulated reads were concatenated to 1-Gbp sequencing reads (3.5 million paired-end 150-bp reads) of liver cancer cells (SRR3031107 in SRA) and 328-Mbp reads of a human microbiome sample (SRR062412, 100-bp paired-end reads containing any Ns were removed). The reads of liver cancer cells and the reads from the human microbiome project (HMP) were taken as host and bacterial metagenomes. Three reference genomes of respiratory viruses including human enterovirus (NC_001612 for CA16), human rhinovirus (NC_001617 for HRV), and human respiratory syncytial virus (NC_001781 for HRSV) were used separately to simulate 20×, 20× and 40×, and 20× and 80× viral sequences using VirtualNextGenSequencer. The simulated reads (all 20×, and 20×-40×-80×) and randomly selected reads (1 Gbp, 5 million paired-end 100-bp reads), as a background, from an influenza-negative sample (ERR690488) [<xref rid="bib9" ref-type="bibr">9</xref>] were used to assess the ability of drVM to assemble viral genomes within the same genus (human enterovirus and rhinovirus).</p>
    </sec>
    <sec id="sec2-4">
      <title>Metagenomic datasets</title>
      <p>A total of 349 sequencing runs in the SRA were downloaded (see <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>). The metagenome datasets based on prior studies [<xref rid="bib8" ref-type="bibr">8</xref>–<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib16" ref-type="bibr">16</xref>–<xref rid="bib29" ref-type="bibr">29</xref>] are summarized in Table <xref rid="tbl1" ref-type="table">1</xref>. Each run was analyzed by drVM: drVM.py -1 read1.fastq -2 read2.fastq -t 16 (-type iontorrent for Ion Torrent datasets) on a server (Intel Xeon E7-4820, 2.00GHz with 256 GB of RAM).</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>The feasibility of drVM in various types of clinical samples and public datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="center" colspan="2" rowspan="1">drVM result (No. of run)</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1">Study description</th>
              <th align="center" rowspan="1" colspan="1">Sequencing method</th>
              <th align="center" rowspan="1" colspan="1">No. of runs</th>
              <th align="center" rowspan="1" colspan="1">Ref</th>
              <th align="center" rowspan="1" colspan="1">Detection</th>
              <th align="center" rowspan="1" colspan="1">Reconstruction</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Bioinformatics pipeline for ultrarapid pathogen identification</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">[<xref rid="bib10" ref-type="bibr">10</xref>]</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Complete viral RNA genome sequencing of ultra-low copy samples</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">34</td>
              <td rowspan="1" colspan="1">[<xref rid="bib19" ref-type="bibr">19</xref>]</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">25</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Faecal virome of red foxes from peri-urban areas</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">[<xref rid="bib28" ref-type="bibr">28</xref>]</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Full genome virus detection in fecal samples</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">[<xref rid="bib20" ref-type="bibr">20</xref>]</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Human papillomavirus community in healthy persons</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">20<sup><xref ref-type="fn" rid="tb1fn1">a</xref></sup></td>
              <td rowspan="1" colspan="1">[<xref rid="bib21" ref-type="bibr">21</xref>]</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Identification of hepatotropic viruses from plasma</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">[<xref rid="bib18" ref-type="bibr">18</xref>]</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Intestinal bacterial and RNA viral communities from sentinel birds</td>
              <td rowspan="1" colspan="1">Ion Torrent</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">[<xref rid="bib24" ref-type="bibr">24</xref>]</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Intestinal virome in healthy and diarrhoeic neonatal piglets</td>
              <td rowspan="1" colspan="1">Ion Torrent</td>
              <td rowspan="1" colspan="1">29</td>
              <td rowspan="1" colspan="1">[<xref rid="bib27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Metagenomic analysis for severe acute respiratory infection</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">[<xref rid="bib29" ref-type="bibr">29</xref>]</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Metagenomic identification of viral pathogens in clinical samples</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">[<xref rid="bib25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">New viral sequences identified in Asian citrus psyllid</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">[<xref rid="bib26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Novel adenovirus associated with baboon acute respiratory outbreak</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">[<xref rid="bib17" ref-type="bibr">17</xref>]</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Novel human pegivirus associated with hepatitis C virus co-infection</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">[<xref rid="bib23" ref-type="bibr">23</xref>]</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNA sequencing in influenza virus-positive respiratory samples</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">49</td>
              <td rowspan="1" colspan="1">[<xref rid="bib9" ref-type="bibr">9</xref>]</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">13</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNA-seq of RNA viruses from faecal and blood samples</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">82</td>
              <td rowspan="1" colspan="1">[<xref rid="bib8" ref-type="bibr">8</xref>]</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">76</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simultaneous sequencing of multiple RNA virus genomes</td>
              <td rowspan="1" colspan="1">Ion Torrent</td>
              <td rowspan="1" colspan="1">40</td>
              <td rowspan="1" colspan="1">[<xref rid="bib22" ref-type="bibr">22</xref>]</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Viral genome-targeted assembly pipeline</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">[<xref rid="bib13" ref-type="bibr">13</xref>]</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Virus identification in unknown tropical febrile illness cases</td>
              <td rowspan="1" colspan="1">Illumina</td>
              <td rowspan="1" colspan="1">1<sup><xref ref-type="fn" rid="tb1fn2">b</xref></sup></td>
              <td rowspan="1" colspan="1">[<xref rid="bib16" ref-type="bibr">16</xref>]</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tb1fn1">
            <p><sup>a</sup>Selected runs with assembled contigs &gt;1000 bp [<xref rid="bib21" ref-type="bibr">21</xref>].</p>
          </fn>
          <fn id="tb1fn2">
            <p><sup>b</sup>A selected run with mapped viral reads &gt;5000 [<xref rid="bib16" ref-type="bibr">16</xref>].</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3">
    <title>Results</title>
    <sec id="sec3-1">
      <title>drVM pipeline</title>
      <p>drVM was designed to detect and reconstruct known viral genomes from metagenomes. As described in the Materials and Methods, it contains two modules: CreateDB.py and drVM.py (Fig. <xref ref-type="fig" rid="fig1">1</xref>). The viral sequences downloaded from NCBI were processed by CreateDB.py to produce SNAP and BLAST databases. Taxonomy information was also automatically extracted from NCBI. In drVM.py, metagenomic reads that were aligned to complete viral sequences were firstly partitioned into genus-level groups to facilitate <italic>de novo</italic> assembly of classified reads. Each genus-level assembly was then annotated with a close reference in refDB or rawDB to produce corresponding coverage plots. The drVM pipeline was implemented, in Python, to incorporate open-source tools including BLAST, khmer, SNAP, SOAP2, and SPAdes. The software is open-source and available for download: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sb2nhri/files/drVM/">https://sourceforge.net/projects/sb2nhri/files/drVM/</ext-link>. In addition to the drVM script, the module is distributed as a Docker image in the Docker Hub (<ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/990210oliver/drvm/">https://hub.docker.com/r/990210oliver/drvm/</ext-link>) repository, an Amazon Machine Image (AMI) in Community AMIs, and as a virtual machine image (drVM.ova) on the sourceforge website. The instructions for users can be found in <xref ref-type="supplementary-material" rid="sup12">Supplementary file 2</xref>. With the Docker, Amazon machine image, and the drVM virtual machine, users are able to interface with drVM with ease. In addition to executing commands in a terminal window (Fig. <xref ref-type="fig" rid="fig2">2</xref>A), a graphical user interface (Fig. <xref ref-type="fig" rid="fig2">2</xref>B) was created in the drVM virtual machine. Users are thus able to construct the required databases for drVM by simply clicking on the ‘Create’ button featured in CreateDB.py. Following a 30-minute period during which DB is created, users are able to analyze metagenomic data with drVM.py to produce a folder (Fig. <xref ref-type="fig" rid="fig2">2</xref>C) containing assembled viral genomes (*.ctg.fa) along with annotated coverage plots (Fig. <xref ref-type="fig" rid="fig2">2</xref>D). Note that viral sequences were fully assembled, <italic>de novo</italic>, by SPAdes using reads within the same genus, and each assembled contig (e.g. NODE_2_length_7654 and NODE_1_length_7914 in Fig. <xref ref-type="fig" rid="fig2">2</xref>D) was annotated with its closely related genome (e.g. Human papillomavirus type 45 and type 53). The coverage plots were generated by plotting read coverage across genomic position, with the y-axis representing read depth.</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Input and output explanation of drVM. (A) Input associated with the command-line interface. (B) Input associated with the graphical user interface. (C) Output file structure generated by drVM. (D) Coverage profiles produced by drVM.</p>
        </caption>
        <graphic xlink:href="gix003fig2"/>
      </fig>
    </sec>
    <sec id="sec3-2">
      <title>Viral genome reconstruction using simulated data</title>
      <p>To reconstruct the 9646-bp HCV genome from the simulated datasets (485–2425 100-bp paired-end HCV reads for 10× to 50× HCV + 3.5 million SRR3031107 liver cancer cell paired-end reads + 1.6 million SRR062412 HMP paired-end reads), drVM first placed all the HCV (485–2425) along with 105 liver and 274 HMP paired-end reads into fastq files classified under the genus “Hepacivirus.” It proceeded to assemble the reads into a HCV genome (length ranging from 9631 to 9644 bp) with 100% sequence identity to the reference genome (NC_004102.1) as the depth of HCV reads was ≧20×. Hence, based on this simulation study, the minimum read depth for drVM to reconstruct the viral genome was 20×. To assess the capability of assembling mixed viral genomes, two simulation datasets have been used: 20×-40×-80× and 20×-20×-20× for a mixture of reads of CA16, HRV, and HRSV combined with 1-Gbp reads from an influenza-negative respiratory sample (ERR690488). The results generated by drVM for 20×-40×-80× and 20×-20×-20× are shown in Fig. <xref ref-type="fig" rid="fig3">3</xref>A-D and E-H, respectively. drVM correctly classified viral reads into the corresponding genus fastq files (CA16 and HRV reads in Enterovirus and HRSV in Orthopneumovirus, shown in Fig. <xref ref-type="fig" rid="fig3">3</xref>A and E) and successfully reconstructed the three viral genomes (Fig. <xref ref-type="fig" rid="fig3">3</xref>B-D and F-H) in the two genus folders. The assembled sequences of length 7145 to 15 224 bp were 100% identical to their reference genomes. The simulations revealed that few bacterial and host reads (&lt;0.02%, 274 of 1.6 million) were classified into the viral genus-level fastq files, and the existence of background reads did not interfere with viral assembly.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>drVM results for read mixture simulations of human enterovirus (CA16), human rhinovirus (HRV), human respiratory syncytial virus (HRSV), and reads from ERR690488. (A-D) 20X-40X-80X: 741 CA16, 1430 HRV, and 6090 HRSV reads. (E-H) 20X-20X-20X: 741 CA16, 715 HRV, and 1522 HRSV reads.</p>
        </caption>
        <graphic xlink:href="gix003fig3"/>
      </fig>
    </sec>
    <sec id="sec3-3">
      <title>Detection and reconstruction of viral genomes</title>
      <p>Three hundred and forty-nine sequencing datasets from 18 research studies (Table <xref rid="tbl1" ref-type="table">1</xref> and <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>) were downloaded and analyzed by means of drVM. The results generated by the drVM package (except filtered reads) for the 349 runs are provided at <ext-link ext-link-type="uri" xlink:href="http://sb.nhri.org.tw/drVM/">http://sb.nhri.org.tw/drVM/</ext-link>, and the assembled viral sequences (also in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>), along with their corresponding coverage plots, are available for download. As shown in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref> and the website, drVM produced coverage plots in analyzing metagenomics reads of 260 sequencing runs and reconstructed viral genomes from 147 runs by presenting a single contig mapped on a reference. Here, we take the second study listed in Table <xref rid="tbl1" ref-type="table">1</xref> as an example; the authors described sequence-independent amplification for samples containing ultra-low amounts of viral RNA coupled with 34-run Illumina sequencing (SRR513075 to SRR527726 and SRR629705-9 listed in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>). <italic>De novo</italic> assembly, optimized for viral genomes, was performed so as to capture 96% to 100% of the viral protein coding region of the human immunodeficiency virus (HIV), respiratory syncytial virus (RSV), and West Nile virus (WNV); 31 consensus genome assemblies have been submitted to NCBI (JX503071-JX503101) [<xref rid="bib19" ref-type="bibr">19</xref>]. These viruses were successfully detected by drVM in separate samples through the creation of coverage plots for the 34 sequencing runs (see <ext-link ext-link-type="uri" xlink:href="http://sb.nhri.org.tw/drVM/">http://sb.nhri.org.tw/drVM/</ext-link>). drVM reconstructed complete viral genomes in 25 runs, thus the remaining 9 runs are labeled as “detection” in Table <xref rid="tbl1" ref-type="table">1</xref>. The assembled genome sequences such as HIV in SRR513075, WNV in SRR527701, and RSV in SRR527708 can be found in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>. Although drVM did not reconstruct HIV genomes for JX503077 and JX503083 from SRR513078 and SRR527710, respectively, it produced HIV contigs with length &gt;4000 bp. The drVM-produced viral sequences shared over 99.9% average sequence identity to the reference genomes (20 pairs of reference and assembled sequence). In addition to HIV, RSV, and WNV, drVM reconstructed GB virus C genomes in SRR513075, SRR513080, SRR513087, SRR629705, and SRR629708. The maximum identity of the assembled sequences to the reference genomes deposited in NCBI's Nucleotide collection (nr/nt) is 93%, which reveals that these assembled sequences have yet to be published. drVM also detected hepatitis C viruses in SRR513080 (three assembled HCV contigs &gt; 1 kbp), SRR629705 (one HCV contig &gt; 5 kbp), and SRR629708; torque teno virus (contigs &gt; 1.5 kbp) was also detected in SRR527718, SRR527725, SRR629705, and SRR629707. This finding has, to date, not been reported in the literature. Furthermore, 12 complete or near-complete viral genomes of viruses including adenovirus, norovirus, and hepatitis B virus have been obtained and submitted to NCBI (KJ194499-KJ194510) in the fourth study [<xref rid="bib20" ref-type="bibr">20</xref>]; drVM automatically produced nine complete genomes among them, with over 99.9% average sequence identity to the reference genomes (<xref ref-type="supplementary-material" rid="sup12">Table S1</xref>). In analyzing reads of the 20 sequencing runs, drVM reconstructed 17 viral genomes in 11 runs and did not produce any coverage plot for the other 9 runs (Table <xref rid="tbl1" ref-type="table">1</xref>). An additional eight viral genomes, belonging to plant viruses (including cucumber green mottle mosaic virus, paprika mild mottle virus, pepper mild mottle virus, tobacco mosaic virus, and tomato mosaic virus), were assembled by drVM. Genomes of the four plant viruses, with the exception of pepper mild mottle virus, have undergone complete assembly by the prior study [<xref rid="bib20" ref-type="bibr">20</xref>], albeit the plant viral sequences provided in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref> have not been published. As for the fourth study from the bottom of Table <xref rid="tbl1" ref-type="table">1</xref>, the RNA shotgun sequencing method has been used in 82 samples, but only 17 sequences of norovirus (HF952119-HF952135) have been submitted to NCBI [<xref rid="bib8" ref-type="bibr">8</xref>]. drVM produced coverage plots for all 82 sequencing runs (shown on the website) and assembled two hepatitis C virus genomes, 74 norovirus genomes, two human picobirnavirus genomes, and one pepino mosaic virus genome from 76 sequencing runs (<xref ref-type="supplementary-material" rid="sup12">Table S1</xref>). Over 99.98% average sequence identity was obtained when the drVM-produced sequences were compared to the 17 corresponding references. To illustrate the wide-ranging versatility of drVM, it was also leveraged to detect/reconstruct viral genomes from respiratory samples [<xref rid="bib9" ref-type="bibr">9</xref>], the fifth study from the bottom of Table <xref rid="tbl1" ref-type="table">1</xref>. drVM produced 2 complete influenza A H1N1 virus genomes (ERR690494 and ERR690532 in <ext-link ext-link-type="uri" xlink:href="http://sb.nhri.org.tw/drVM/">http://sb.nhri.org.tw/drVM/</ext-link>) and 10 H3N2 virus genomes (e.g., ERR690510) in 12 influenza-positive samples and one human respiratory syncytial virus in a negative control sample (ERR690491). Taken together, various viral genomes including DNA, RNA, and retro-transcribing viruses (Table <xref rid="tbl2" ref-type="table">2</xref>) have been reconstructed by drVM; this has been applied to the analysis of 349 metagenomic datasets from 18 studies. For example, drVM assembled a human adenovirus D genome with length of 34 901 bp in ERR233414, a human bocavirus (ssDNA) genome with length of 5250 bp, and a genome of human parainfluenza virus (ssRNA negative strand) with length of 15519 bp in SRR2010686, two segments of human picobirnavirus (dsRNA) with lengths of 2485 and 1717 bp in ERR227885, a bovine viral diarrhea virus (ssRNA positive strand) with length of 12 216 bp in SRR1170806, and a hepatitis B virus (retrovirus) genome with length of 3166 bp in ERR233420. In summary, drVM successfully reconstructed over 200 viral genomes of 30 viral species (Table <xref rid="tbl2" ref-type="table">2</xref>) among 349 metagenomic sequencing runs. Over 150 assembled viral genomes are provided in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>.</p>
      <table-wrap id="tbl2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Various viral genomes reconstructed by drVM based on the corresponding NGS reads</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="center" rowspan="1" colspan="1">Virus type</th>
              <th align="left" rowspan="1" colspan="1">Viral genome reconstruction by drVM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">dsDNA</td>
              <td rowspan="1" colspan="1">Human adenovirus (ERR233414), Human papillomavirus (ERR233428), Simian adenovirus (SRR766764)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ssDNA</td>
              <td rowspan="1" colspan="1">Adeno-associated virus (SRR766763), Bovine parvovirus (SRR2010686), Fox circovirus (SRR1920168), Human bocavirus (SRR2010686), Torque teno mini virus (SRR2040553), Torque teno virus (SRR2010686)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">dsRNA</td>
              <td rowspan="1" colspan="1">Human picobirnavirus (ERR227885)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ssRNA (+)</td>
              <td rowspan="1" colspan="1">Bovine viral diarrhea virus (SRR1170806), Chikungunya virus (SRR3180716), GB virus C (SRR544883), Hepatitis C virus (SRR2940645), Human pegivirus (SRR2940645), Human rhinovirus (SRR2010685), Norovirus (ERR233428), Pepino mosaic virus (ERR227848), Pepper mild mottle virus (ERR233431), Porcine kobuvirus (ERR1097471), Tobacco mild green mosaic virus (ERR233421), Tobacco mosaic virus (ERR233421), Tomato mosaic virus (ERR233424), West Nile virus (SRR527705)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ssRNA (−)</td>
              <td rowspan="1" colspan="1">Human parainfluenza virus (SRR2010686), Human respiratory syncytial virus (ERR690491), Respiratory syncytial virus (SRR527708), Influenza A virus (ERR690510)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Retro-transcribing</td>
              <td rowspan="1" colspan="1">Hepatitis B virus (ERR233420), Human immunodeficiency virus (SRR513075)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="sec3-4">
      <title>Performance comparison</title>
      <p>Unlike SURPI [<xref rid="bib10" ref-type="bibr">10</xref>], VIP [<xref rid="bib12" ref-type="bibr">12</xref>], and VirusTAP [<xref rid="bib13" ref-type="bibr">13</xref>], drVM directly identifies reads by aligning them to complete viral sequences and therefore is expected to save a substantial amount of computational time from subtracting reads of the host and co-located bacteria. Three datasets – SRR1170797, SRR1106548, and DRR049387 – used in VIP, SURPI, and VirusTAP were separately input into them for the pipeline evaluation [<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib12" ref-type="bibr">12</xref>, <xref rid="bib13" ref-type="bibr">13</xref>]. Two sequencing runs comprising co-existing multiple human papillomavirus types [<xref rid="bib21" ref-type="bibr">21</xref>] and segmented-genome influenza viruses [<xref rid="bib9" ref-type="bibr">9</xref>] were used as additional datasets for performance comparison. As demonstrated in Table <xref rid="tbl3" ref-type="table">3</xref>, drVM requires the shortest execution time with regards to SRR1106548 and DRR049387 and the second-shortest time for the other three datasets. Nevertheless, it produced a complete genome of bovine viral diarrhea virus (genome size: 12.5 kbp) in SRR1170797, two complete genomes of human papillomavirus type 45 and type 53 (genome size: ∼7.8 kbp) in SRR062073, and eight complete segments of influenza A virus H3N2 in ERR690519. Commands and results can be found in Supplementary information. Note that the analyses of drVM, SURPI, and VIP (in Table <xref rid="tbl3" ref-type="table">3</xref>) were performed on a quad-core CPU with 128 GB RAM while VirusTAP was executed on a 120-core CPU web server with 1 TB RAM. Therefore, drVM was validated to be the most rapid tool for virus identification when computational hardware was considered. Moreover, drVM reconstructed the complete viral genomes from metagenomics reads of SRR1170797, SRR062073, and ERR690519 runs, while the other three tools were not able to produce complete genomes for these viruses. The outputs generated by each tool running on the datasets delineated in Table <xref rid="tbl3" ref-type="table">3</xref> are available at: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sb2nhri/files/drVM/Comparison/">https://sourceforge.net/projects/sb2nhri/files/drVM/Comparison/</ext-link>. Please also note that the results are reproducible even when running a drVM virtual machine with a configured memory size of 8 GB on a Windows system with Intel Xeon E31248 CPU and 32 GB RAM (see Supplementary information). To simulate the disturbance of host reads, <italic>homo sapiens</italic> raw reads from liver cancer cells (SRR3031107) were concatenated to sequencing reads (SRR544883) from the hepatitis C virus infection [<xref rid="bib18" ref-type="bibr">18</xref>]. Before read concatenation, drVM reconstructed a GB virus C genome (length of 9244 bp) from 101 364 paired-end reads in fastq files of Pegivirus in SRR544883, as shown in Table <xref rid="tbl2" ref-type="table">2</xref>. Although the software managed to reconstruct the viral genome of GB virus C from the concatenated reads, execution time increased by a factor of three (from 43 minutes to 2 hours 7 minutes while analyzing read bases of 711 Mb to 10 Gb). Please note that SRR3031107 reads were not classified into fastq files of Pegivirus when the concatenated reads (SRR3031107 + SRR544883) were employed as inputs to drVM. It was therefore confirmed that host read subtraction is not necessary in drVM. Taken together, drVM not only facilitates the rapid detection of viral reads but also enables the <italic>de novo</italic> assembly of the classified reads into viral genomes.</p>
      <table-wrap id="tbl3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Performance comparison between drVM, SURPI, VIP, and VirusTAP</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Target virus (run accession)</th>
              <th align="center" colspan="2" rowspan="1">Read bases (Mbp)</th>
              <th align="left" rowspan="1" colspan="1">drVM</th>
              <th align="left" rowspan="1" colspan="1">SURPI (comprehensive)</th>
              <th align="left" rowspan="1" colspan="1">VIP (sense)</th>
              <th align="left" rowspan="1" colspan="1">VirusTAP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Bovine viral diarrhea virus (SRR1170797)</td>
              <td rowspan="1" colspan="1">12.5</td>
              <td rowspan="1" colspan="1">Run time<sup><xref ref-type="fn" rid="tb3fn1">a</xref></sup></td>
              <td rowspan="1" colspan="1">149 sec</td>
              <td rowspan="1" colspan="1">52<bold> </bold>365 sec</td>
              <td rowspan="1" colspan="1">1683 sec</td>
              <td rowspan="1" colspan="1">71 sec</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Result<sup><xref ref-type="fn" rid="tb3fn2">b</xref></sup></td>
              <td rowspan="1" colspan="1">
                <bold>12 224 bp</bold>
              </td>
              <td rowspan="1" colspan="1">262 bp</td>
              <td rowspan="1" colspan="1">9078 bp</td>
              <td rowspan="1" colspan="1">353 bp</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Human immunodeficiency virus (SRR1106548)<sup><xref ref-type="fn" rid="tb3fn3">c</xref></sup></td>
              <td rowspan="1" colspan="1">600.9</td>
              <td rowspan="1" colspan="1">Run time</td>
              <td rowspan="1" colspan="1">598 sec</td>
              <td rowspan="1" colspan="1">32<bold> </bold>604 sec</td>
              <td rowspan="1" colspan="1">25<bold> </bold>049 sec</td>
              <td rowspan="1" colspan="1">1388 sec</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Result</td>
              <td rowspan="1" colspan="1">3055 bp</td>
              <td rowspan="1" colspan="1">799 bp</td>
              <td rowspan="1" colspan="1">4632 bp</td>
              <td rowspan="1" colspan="1">2896 bp</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Human papillomavirus (SRR062073)</td>
              <td rowspan="1" colspan="1">5000</td>
              <td rowspan="1" colspan="1">Run time</td>
              <td rowspan="1" colspan="1">608 sec</td>
              <td rowspan="1" colspan="1">18<bold> </bold>107 sec</td>
              <td rowspan="1" colspan="1">8603 sec</td>
              <td rowspan="1" colspan="1">519 sec</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Result</td>
              <td rowspan="1" colspan="1">
                <bold>7654 &amp; 7914 bp</bold>
              </td>
              <td rowspan="1" colspan="1">3515 bp</td>
              <td rowspan="1" colspan="1">2164 bp</td>
              <td rowspan="1" colspan="1">555 bp</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Human rotavirus A (DRR049387)</td>
              <td rowspan="1" colspan="1">266.1</td>
              <td rowspan="1" colspan="1">Run time</td>
              <td rowspan="1" colspan="1">464 sec</td>
              <td rowspan="1" colspan="1">59<bold> </bold>510 sec</td>
              <td rowspan="1" colspan="1">6259 sec</td>
              <td rowspan="1" colspan="1">925 sec</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Result</td>
              <td rowspan="1" colspan="1">13 contigs</td>
              <td rowspan="1" colspan="1">13 contigs</td>
              <td rowspan="1" colspan="1">41<bold> </bold>377 reads</td>
              <td rowspan="1" colspan="1">
                <bold>11 viral contigs</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Influenza A virus (ERR690519)</td>
              <td rowspan="1" colspan="1">3300</td>
              <td rowspan="1" colspan="1">Run time</td>
              <td rowspan="1" colspan="1">12<bold> </bold>697sec</td>
              <td rowspan="1" colspan="1">16<bold> </bold>997 sec</td>
              <td rowspan="1" colspan="1">86<bold> </bold>001 sec</td>
              <td rowspan="1" colspan="1">4504 sec</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Result</td>
              <td rowspan="1" colspan="1">
                <bold>8 H3N2 segments</bold>
              </td>
              <td rowspan="1" colspan="1">11 contigs</td>
              <td rowspan="1" colspan="1">2673 reads</td>
              <td rowspan="1" colspan="1">34 viral contigs</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tb3fn1">
            <p><sup>a</sup>The analyses were executed on a quad-core CPU with 128 GB RAM, except for VirusTAP (executed on a 120-core CPU with 1 TB RAM). Please note that drVM is able to run these datasets with 8 GB RAM (Supplementary information).</p>
          </fn>
          <fn id="tb3fn2">
            <p><sup>b</sup>The result is summarized as the largest length of viral contig (bold: close to the genome size of target virus), read number mapped to the target virus, or contig number depending on the output of tools and the target virus (Human rotavirus A: 11 segments, Influenza A virus: 8 segments).</p>
          </fn>
          <fn id="tb3fn3">
            <p><sup>c</sup>The results were produced by analyzing reads with barcode: GCCAAT, except for SURPI, which recognizes multiple barcodes.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4">
    <title>Discussion</title>
    <p>As NGS technology is becoming a more common means to detect pathogens in clinical samples, our goal is to establish a simple and effective pipeline that allows accurate and rapid viral genome reconstruction from metagenomic NGS data generated from complex clinical samples. As described in SURPI, SNAP executes 10–100 × more rapidly than existing alignment tools including Bowtie 2 [<xref rid="bib37" ref-type="bibr">37</xref>] and BWA [<xref rid="bib38" ref-type="bibr">38</xref>]. drVM and SURPI use SNAP while VIP and VirusTAP utilize Bowtie 2 and BWA-SW [<xref rid="bib39" ref-type="bibr">39</xref>], respectively. SNAP coupling with the light reference database (viral sequences vs. human, bacterial, and viral sequences used in SURPI, VIP, and VirusTAP) yields a noteworthy reduction in the processing time for viral read identification in drVM. Furthermore, the reference database can easily be updated whenever necessary (see Supplementary information). In contrast, SURPI classifies reads against viral and bacterial databases to identify all potential pathogens, which invariably requires extended execution time and requires more effort with regards to ensuring that the references are updated and current. In drVM, viral reads with the loosest edit distance of 24 (in SNAP) were partitioned into genus-level groups based on the virus taxonomy retrieved from the NCBI Taxonomy databases, excluding phages. The filtered reads belonging to a viral genus are therefore allowed to be divergent from reference genomes so long as there is one contiguous seed of 20 bases matching exactly to a reference. However, since drVM relies on known viral sequences for viral read identification and genus-level partition, it may not be able to discover novel viruses that are very different to known viruses. For subsequent <italic>de novo</italic> assembly, digital normalization was then employed to correct uneven read depth distribution so as to eliminate redundant reads while retaining sufficient information. For example, drVM produced a 7455-bp contig of porcine kobuvirus for ERR1097471 (Table <xref rid="tbl2" ref-type="table">2</xref>, the assembled sequence in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>) but produced a fragmented assembly when digital normalization was not used (-dn off). This assembled sequence shared only 90% identity at nucleotide level with a closely related porcine kobuvirus genome sequence deposited in NCBI's Nucleotide collection (nr/nt), hence demonstrating that drVM is able to produce a complete genome sequence of porcine kobuvirus from the intestinal virome in neonatal piglets [<xref rid="bib27" ref-type="bibr">27</xref>]. Additionally, normalization enables us to reduce the processing time required for assembly. For example, not activating the digital normalization routine in drVM increased the execution time of ERR1097472 from 20 minutes to 3 hours. It is important to note that the digital normalization routine is employed to down-sample reads, insinuating that the results produced by drVM can vary (e.g., SRR527703 in <ext-link ext-link-type="uri" xlink:href="http://sb.nhri.org.tw/drVM/">http://sb.nhri.org.tw/drVM/</ext-link>) from run to run. The normalized reads were assembled, in a <italic>de novo</italic> fashion, by SPAdes with multiple k-mer sizes (21, 33, 55… automatically selected based on read length). Since SPAdes operates with Illumina and Ion Torrent reads, drVM is able to handle sequencing reads produced by these two platforms (default for Illumina, -type iontorrent for Ion Torrent). Moreover, drVM annotates each genus-level assembly with a close reference to produce the corresponding coverage plots. If multiple contigs are present in one coverage plot, reads aligned to the contigs are extracted in pairs for subsequent re-assembly; such a process is able to improve genome completeness. An example can be seen in the run corresponding to SRR527705 – fragmented contigs were annotated with the WNV in the pre.run routine; drVM produced a 11 017-bp contig of the complete genome (see <ext-link ext-link-type="uri" xlink:href="http://sb.nhri.org.tw/drVM/">http://sb.nhri.org.tw/drVM/</ext-link> for the details). Over 99.98% of the target sequence identity was obtained in the drVM-produced contig when referenced against the submitted assembly (JX503096.1) [<xref rid="bib19" ref-type="bibr">19</xref>], as shown in <xref ref-type="supplementary-material" rid="sup12">Table S1</xref>.</p>
    <p>In the comparative study of VIP and VirusTAP, the authors have compared their assemblies with direct metagenomic assemblies via Ensemble Assembler, IDBA_UD, A5-miseq, and CLC workbench. The results have led the authors to conclude that “classification to assembly” outperformed direct assembly in terms of assembly continuity and execution time [<xref rid="bib12" ref-type="bibr">12</xref>, <xref rid="bib13" ref-type="bibr">13</xref>], suggesting that to extract viral reads from metagenomes is a prior step to sequence assembly. Although drVM was not compared with SPAdes, it was compared against SURPI, VIP, and VirusTAP. As evident from Table <xref rid="tbl3" ref-type="table">3</xref>, drVM produced complete genomes of bovine viral diarrhea virus and human papillomavirus in the analysis of reads produced by Ion Torrent and Illumina platforms, respectively; the other tools were not able to assemble complete genomes for these viruses. Although drVM produced distinct viral genome assemblies within the same genus, for human papillomavirus types 45 and 53 in SRR062073 (Fig. <xref ref-type="fig" rid="fig2">2</xref> and Table <xref rid="tbl3" ref-type="table">3</xref>) and for human enterovirus rhinovirus in the simulation dataset (Fig. <xref ref-type="fig" rid="fig3">3</xref>), the assembler may not be able to handle mixtures of very closely related viruses. Moreover, a biased viral reference database may result in assemblies with missing segments or no assembly whatsoever. Unlike SURPI and VIP, the coverage plots produced by drVM are created by mapping raw reads back to the assembled contigs, not to closely-related references. A coverage plot with a continuous profile reflects the accuracy and continuity of the assembly paradigm. With the support of coverage plot, one can rest assured that viruses with drVM-produced genome assemblies are present in the sample. Among SURPI, VIP, and VirusTAP, VirusTAP is the only user-friendly tool for viral genome assembly from metagenomic reads. The other two pipelines are not easily operated by users lacking advanced bioinformatics skills. Although academic users can access VirusTAP and obtain viral genomes with ease, the package is not suitable for assembling Ion Torrent data (Table <xref rid="tbl3" ref-type="table">3</xref>, SRR1170797) and low-copy viruses (Table <xref rid="tbl3" ref-type="table">3</xref>, SRR062073). Moreover, users are not able to update reference databases in VirusTAP, a web-based tool. Alternatively, drVM provides various images for Docker, Amazon, and Virtual Machine deployment and features a user-friendly interface (as shown in Fig. <xref ref-type="fig" rid="fig2">2</xref>B) in the Virtual Machine. drVM also generates self-explanatory results (Fig. <xref ref-type="fig" rid="fig2">2</xref>C and D) accurately and rapidly; it therefore is well-suited for clinical applications.</p>
    <p>Although drVM operates in such a manner that the subtraction of the host read is neglected, which may produce valid host sequences annotated with viral references, this error can be easily identified via inspection of the assembled contigs. For example, analyzing SRR3031107 concatenated with SRR544883, a 1872-bp contig annotated with Feline leukemia virus gene for viral Notch2 (92% identity) actually corresponded to <italic>homo sapiens</italic> notch 2 (100% identity). Nevertheless, the provirus that integrated into a host genome is partial and it can be easily distinguished from the complete viral genome (Feline leukemia virus, genome size: 8.45 kbp) by length. We therefore recommend that conclusions drawn from drVM should be made with caution, especially with regards to retrovirus detection. We have applied drVM in the analyses of over 300 sequencing runs retrieved from NCBI's SRA to demonstrate that drVM is indeed able to efficiently produce genome assemblies for known eukaryotic viruses from metagenomic data.</p>
  </sec>
  <sec id="sec5">
    <title>Availability and requirements</title>
    <p>Project name: drVM</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/sb2nhri/files/drVM/">https://sourceforge.net/projects/sb2nhri/files/drVM/</ext-link></p>
    <p>Operating system(s): OS X, Linux, Windows</p>
    <p>Programming language: Python</p>
    <p>Requirements: Amazon machine image, Docker, or Virtual machine; 8 GB RAM</p>
    <p>License: GNU General Public License, version 3.0 (GPL-3.0)</p>
  </sec>
  <sec sec-type="data-availability" id="sec6">
    <title>Availability of supporting data</title>
    <p>Snapshots of the code and further supporting data is available in the GigaScience repository GigaDB [<xref rid="bib40" ref-type="bibr">40</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Abbreviations</title>
    <p>AMI: Amazon machine image; HCV: hepatitis C virus; HIV: immunodeficiency virus; NGS: next-generation sequencing; RSV: respiratory syncytial virus; SRA: sequencing read archive; WNV: West Nile virus.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec8">
    <title>Supplementary data</title>
    <p>Supplementary data are available at <italic><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/gigascience">GIGSCI</ext-link></italic> online.</p>
    <p><bold>Supplementary Table S1:</bold> list of 349 sequencing datasets from 18 research studies.</p>
    <p><bold>Supplementary File 2:</bold> supplementary information.</p>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-16-00060_Original_Submission.pdf</label>
      <media xlink:href="gix003_giga-d-16-00060_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-16-00060_Revision_1.pdf</label>
      <media xlink:href="gix003_giga-d-16-00060_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>GIGA-D-16-00060_Revision_2.pdf</label>
      <media xlink:href="gix003_giga-d-16-00060_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Responses_to_reviewer_comments_Orginal_Submission.pdf</label>
      <media xlink:href="gix003_responses_to_reviewer_comments_orginal_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Response_to_Reviewer_Comments_Revision_1.pdf</label>
      <media xlink:href="gix003_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Reviewer_1_Report_(Revision_1).pdf</label>
      <media xlink:href="gix003_reviewer_1_report_(revision_1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>Reviewer_1_Report_Original_Submission.pdf</label>
      <media xlink:href="gix003_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup8">
      <label>Reviewer_2_Report_(Revision_1).pdf</label>
      <media xlink:href="gix003_reviewer_2_report_(revision_1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup9">
      <label>Reviewer_2_Report_Original_Submission.pdf</label>
      <media xlink:href="gix003_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup10">
      <label>Reviewer_3_Report_(Revision_1).pdf</label>
      <media xlink:href="gix003_reviewer_3_report_(revision_1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup11">
      <label>Reviewer_3_Report_Original_Submission.pdf</label>
      <media xlink:href="gix003_reviewer_3_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup12">
      <label>Supplemental material</label>
      <caption>
        <p><bold>Supplementary Table S1:</bold> list of 349 sequencing datasets from 18 research studies.</p>
        <p><bold>Supplementary File 2:</bold> supplementary information.</p>
      </caption>
      <media xlink:href="gix003_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <sec id="sec9">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Author contributions</title>
    <p>YCL conceived the project. HHL implemented the pipeline. YCL and HHL prepared, read, and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This work was supported by grants (PH-105-PP-05) from the National Health Research Institute, Taiwan, and a research grant (MOST-104-2320-B-400-021-MY2) from the Ministry of Science and Technology, Taiwan. We would like to thank Bioinformatics Core Facility for Translational Medicine and Biotechnology Development (TMDB) and National Applied Research Laboratories (NARLabs) of Taiwan for providing computational facilities.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brister</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Ako-Adjei</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bao</surname><given-names>Y</given-names></name></person-group><italic>et al</italic><article-title>NCBI viral genomes resource</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>D571</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">25428358</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pickett</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Sadat</surname><given-names>EL</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name></person-group><italic>et al</italic><article-title>ViPR: an open bioinformatics database and analysis resource for virology research</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>40</volume>:<fpage>D593</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">22006842</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharma</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Priyadarshini</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Vrati</surname><given-names>S</given-names></name></person-group><article-title>Unraveling the web of viroinformatics: computational tools and databases in virus research</article-title>. <source>J Virol</source><year>2015</year>;<volume>89</volume>:<fpage>1489</fpage>–<lpage>501</lpage>.<pub-id pub-id-type="pmid">25428870</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chan</surname><given-names>PK.</given-names></name></person-group><article-title>Outbreak of avian influenza A(H5N1) virus infection in Hong Kong in 1997</article-title>. <source>Clin Infect Dis</source><year>2002</year>;<volume>34</volume>(<issue>Suppl 2</issue>):<fpage>S58</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">11938498</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bean</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Baker</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Stewart</surname><given-names>CR</given-names></name></person-group><italic>et al</italic><article-title>Studying immunity to zoonotic diseases in the natural host - keeping it real</article-title>. <source>Nat Rev Immunol</source><year>2013</year>;<volume>13</volume>:<fpage>851</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">24157573</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Feldmann</surname><given-names>H.</given-names></name></person-group><article-title>Ebola–a growing threat?</article-title><source>N Engl J Med</source><year>2014</year>;<volume>371</volume>:<fpage>1375</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">24805988</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Calvet</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Aguiar</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Melo</surname><given-names>ASO</given-names></name></person-group><italic>et al</italic><article-title>Detection and sequencing of Zika virus from amniotic fluid of fetuses with microcephaly in Brazil: a case study</article-title>. <source>The Lancet Infect Dis</source><year>2016;16:653–60</year>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Batty</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>TH</given-names></name>, <name name-style="western"><surname>Trebes</surname><given-names>A</given-names></name></person-group><italic>et al</italic><article-title>A modified RNA-Seq approach for whole genome sequencing of RNA viruses from faecal and blood samples</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<fpage>e66129</fpage>.<pub-id pub-id-type="pmid">23762474</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fischer</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Indenbirken</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Meyer</surname><given-names>T</given-names></name></person-group><italic>et al</italic><article-title>Evaluation of unbiased next-generation sequencing of RNA (RNA-seq) as a diagnostic method in influenza virus-positive respiratory samples</article-title>. <source>J Clin Microbiol</source><year>2015</year>;<volume>53</volume>:<fpage>2238</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">25972420</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Naccache</surname><given-names>SN</given-names></name>, <name name-style="western"><surname>Federman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Veeraraghavan</surname><given-names>N</given-names></name></person-group><italic>et al</italic><article-title>A cloud-compatible bioinformatics pipeline for ultrarapid pathogen identification from next-generation sequencing of clinical samples</article-title>. <source>Genome Res</source><year>2014</year>;<volume>24</volume>:<fpage>1180</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">24899342</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flygare</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Simmon</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>C</given-names></name></person-group><italic>et al</italic><article-title>Taxonomer: an interactive metagenomics analysis portal for universal pathogen detection and host mRNA expression profiling</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>111</fpage>.<pub-id pub-id-type="pmid">27224977</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Nie</surname><given-names>K</given-names></name></person-group><italic>et al</italic><article-title>VIP: an integrated pipeline for metagenomics of virus identification and discovery</article-title>. <source>Sci Rep</source><year>2016</year>;<volume>6</volume>:<fpage>23774</fpage>.<pub-id pub-id-type="pmid">27026381</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yamashita</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sekizuka</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kuroda</surname><given-names>M</given-names></name></person-group><article-title>VirusTAP: Viral genome-targeted assembly pipeline</article-title>. <source>Front Microbiol</source><year>2016</year>;<volume>7</volume>:<fpage>32</fpage>.<pub-id pub-id-type="pmid">26870004</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Merkel</surname><given-names>D</given-names></name></person-group><article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J</source><year>2014</year>;<volume>2014</volume>:<fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nocq</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Celton</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gendron</surname><given-names>P</given-names></name></person-group><italic>et al</italic><article-title>Harnessing virtual machines to simplify next-generation DNA sequencing analysis</article-title>. <source>Bioinformatics</source><year>2013</year>;<volume>29</volume>:<fpage>2075</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">23786767</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yozwiak</surname><given-names>NL</given-names></name>, <name name-style="western"><surname>Skewes-Cox</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Stenglein</surname><given-names>MD</given-names></name></person-group><italic>et al</italic><article-title>Virus identification in unknown tropical febrile illness cases using deep sequencing</article-title>. <source>PLoS Negl Trop Dis</source><year>2012</year>;<volume>6</volume>:<fpage>e1485</fpage>.<pub-id pub-id-type="pmid">22347512</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chiu</surname><given-names>CY</given-names></name>, <name name-style="western"><surname>Yagi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>X</given-names></name></person-group><italic>et al</italic><article-title>A novel adenovirus species associated with an acute respiratory outbreak in a baboon colony and evidence of coincident human infection</article-title>. <source>MBio</source><year>2013</year>;<volume>4</volume>:<fpage>e00084</fpage>.<pub-id pub-id-type="pmid">23592261</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Law</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jovel</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Patterson</surname><given-names>J</given-names></name></person-group><italic>et al</italic><article-title>Identification of hepatotropic viruses from plasma using deep sequencing: a next generation diagnostic tool</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<fpage>e60595</fpage>.<pub-id pub-id-type="pmid">23613733</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malboeuf</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Charlebois</surname><given-names>P</given-names></name></person-group><italic>et al</italic><article-title>Complete viral RNA genome sequencing of ultra-low copy samples by sequence-independent amplification</article-title>. <source>Nucleic Acids Res</source><year>2013</year>;<volume>41</volume>:<fpage>e13</fpage>.<pub-id pub-id-type="pmid">22962364</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cotten</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Oude Munnink</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Canuti</surname><given-names>M</given-names></name></person-group><italic>et al</italic><article-title>Full genome virus detection in fecal samples using sensitive nucleic acid preparation, deep sequencing, and a novel iterative sequence classification algorithm</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>:<fpage>e93269</fpage>.<pub-id pub-id-type="pmid">24695106</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Madupu</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Karaoz</surname><given-names>U</given-names></name></person-group><italic>et al</italic><article-title>Human papillomavirus community in healthy persons, defined by metagenomics analysis of human microbiome project shotgun sequencing data sets</article-title>. <source>J Virol</source><year>2014</year>;<volume>88</volume>:<fpage>4786</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">24522917</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Neill</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Bayles</surname><given-names>DO</given-names></name>, <name name-style="western"><surname>Ridpath</surname><given-names>JF</given-names></name></person-group><article-title>Simultaneous rapid sequencing of multiple RNA virus genomes</article-title>. <source>J Virol Methods</source><year>2014</year>;<volume>201</volume>:<fpage>68</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">24589514</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berg</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Coller</surname><given-names>K</given-names></name></person-group><italic>et al</italic><article-title>Discovery of a novel human pegivirus in blood associated with hepatitis C virus co-infection</article-title>. <source>PLoS Pathog</source><year>2015</year>;<volume>11</volume>:<fpage>e1005325</fpage>.<pub-id pub-id-type="pmid">26658760</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Day</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Oakley</surname><given-names>BB</given-names></name>, <name name-style="western"><surname>Seal</surname><given-names>BS</given-names></name></person-group><italic>et al</italic><article-title>Comparative analysis of the intestinal bacterial and RNA viral communities from sentinel birds placed on selected broiler chicken farms</article-title>. <source>PLoS One</source><year>2015</year>;<volume>10</volume>:<fpage>e0117210</fpage>.<pub-id pub-id-type="pmid">25635690</pub-id></mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Greninger</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Naccache</surname><given-names>SN</given-names></name>, <name name-style="western"><surname>Federman</surname><given-names>S</given-names></name></person-group><italic>et al</italic><article-title>Rapid metagenomic identification of viral pathogens in clinical samples by real-time nanopore sequencing analysis</article-title>. <source>Genome Medicine</source><year>2015</year>;<volume>7</volume>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nouri</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Salem</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Nigg</surname><given-names>JC</given-names></name></person-group><italic>et al</italic><article-title>Diverse array of new viral sequences identified in worldwide populations of the Asian citrus psyllid (Diaphorina citri) using viral metagenomics</article-title>. <source>J Virol</source><year>2015</year>;<volume>90</volume>:<fpage>2434</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">26676774</pub-id></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Karlsson</surname><given-names>OE</given-names></name>, <name name-style="western"><surname>Larsson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hayer</surname><given-names>J</given-names></name></person-group><italic>et al</italic><article-title>The intestinal eukaryotic virome in healthy and diarrhoeic neonatal piglets</article-title>. <source>PLoS One</source><year>2016</year>;<volume>11</volume>:<fpage>e0151481</fpage>.<pub-id pub-id-type="pmid">26982708</pub-id></mixed-citation>
    </ref>
    <ref id="bib28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lojkic</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Bidin</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Prpic</surname><given-names>J</given-names></name></person-group><italic>et al</italic><article-title>Faecal virome of red foxes from peri-urban areas</article-title>. <source>Comp Immunol Microbiol Infect Dis</source><year>2016</year>;<volume>45</volume>:<fpage>10</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">27012914</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y</given-names></name></person-group><italic>et al</italic><article-title>Metagenomic analysis of viral genetic diversity in respiratory samples from children with severe acute respiratory infection in China</article-title>. <source>Clin Microbiol Infect</source><year>2016;22:458</year>.</mixed-citation>
    </ref>
    <ref id="bib30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zaharia</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bolosky</surname><given-names>WJ</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>K</given-names></name></person-group><italic>et al</italic><article-title>Faster and more accurate sequence alignment with SNAP</article-title>. <source>arXiv preprint arXiv:11115572</source><year>2011</year>.</mixed-citation>
    </ref>
    <ref id="bib31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Camacho</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Coulouris</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Avagyan</surname><given-names>V</given-names></name></person-group><italic>et al</italic><article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bankevich</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nurk</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Antipov</surname><given-names>D</given-names></name></person-group><italic>et al</italic><article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>. <source>J Comput Biol</source><year>2012</year>;<volume>19</volume>:<fpage>455</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">22506599</pub-id></mixed-citation>
    </ref>
    <ref id="bib33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Howe</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Jansson</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Malfatti</surname><given-names>SA</given-names></name></person-group><italic>et al</italic><article-title>Tackling soil diversity with the assembly of large, complex metagenomes</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2014</year>;<volume>111</volume>:<fpage>4904</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24632729</pub-id></mixed-citation>
    </ref>
    <ref id="bib34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crusoe</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Alameldin</surname><given-names>HF</given-names></name>, <name name-style="western"><surname>Awad</surname><given-names>S</given-names></name></person-group><italic>et al</italic><article-title>The khmer software package: enabling efficient nucleotide sequence analysis</article-title>. <source>F1000Res</source><year>2015</year>;<volume>4</volume>:<fpage>900</fpage>.<pub-id pub-id-type="pmid">26535114</pub-id></mixed-citation>
    </ref>
    <ref id="bib35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y</given-names></name></person-group><italic>et al</italic><article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1966</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">19497933</pub-id></mixed-citation>
    </ref>
    <ref id="bib36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Boisvert</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Raymond</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Godzaridis</surname><given-names>E</given-names></name></person-group><italic>et al</italic><article-title>Ray meta: scalable de novo metagenome assembly and profiling</article-title>. <source>Genome Biol</source><year>2012</year>;<volume>13</volume>:<fpage>R122</fpage>.<pub-id pub-id-type="pmid">23259615</pub-id></mixed-citation>
    </ref>
    <ref id="bib37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>357</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="bib38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="bib39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>589</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="bib40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>Y</given-names></name></person-group><article-title>Supporting data for “drVM: a new tool for efficient genome assembly of known eukaryotic viruses from metagenomes”</article-title><source>GigaScience Database</source>. <year>2017</year><pub-id pub-id-type="doi">10.5524/100272</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
