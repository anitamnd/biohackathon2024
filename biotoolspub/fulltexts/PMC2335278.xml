<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2335278</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-144</article-id>
    <article-id pub-id-type="pmid">18325106</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-144</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Empirical Bayes analysis of single nucleotide polymorphisms</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Schwender</surname>
          <given-names>Holger</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>holger.schw@gmx.de</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Ickstadt</surname>
          <given-names>Katja</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ickstadt@statistik.uni-dortmund.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Collaborative Research Center 475, Faculty of Statistics, Dortmund University of Technology, 44221 Dortmund, Germany</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>3</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>144</fpage>
    <lpage>144</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/144"/>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>9</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>3</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Schwender and Ickstadt; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Schwender and Ickstadt; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Schwender
               Holger
               
               holger.schw@gmx.de
            </dc:author><dc:title>
            Empirical Bayes analysis of single nucleotide polymorphisms
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 144-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;144&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>An important goal of whole-genome studies concerned with single nucleotide polymorphisms (SNPs) is the identification of SNPs associated with a covariate of interest such as the case-control status or the type of cancer. Since these studies often comprise the genotypes of hundreds of thousands of SNPs, methods are required that can cope with the corresponding multiple testing problem. For the analysis of gene expression data, approaches such as the empirical Bayes analysis of microarrays have been developed particularly for the detection of genes associated with the response. However, the empirical Bayes analysis of microarrays has only been suggested for binary responses when considering expression values, i.e. continuous predictors.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we propose a modification of this empirical Bayes analysis that can be used to analyze high-dimensional categorical SNP data. This approach along with a generalized version of the original empirical Bayes method are available in the R package siggenes version 1.10.0 and later that can be downloaded from  <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>As applications to two subsets of the HapMap data show, the empirical Bayes analysis of microarrays cannot only be used to analyze continuous gene expression data, but also be applied to categorical SNP data, where the response is not restricted to be binary. In association studies in which typically several ten to a few hundred SNPs are considered, our approach can furthermore be employed to test interactions of SNPs. Moreover, the posterior probabilities resulting from the empirical Bayes analysis of (prespecified) interactions/genotypes can also be used to quantify the importance of these interactions.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Whole-genome experiments comprise data of hundreds of thousands of single nucleotide polymorphisms (SNPs), where a SNP is the most common type of genetic variations that occurs when at a single base pair position different base alternatives exist in a population. SNPs are typically biallelic. Therefore, SNPs can be interpreted as categorical variables having three realizations: the homozygous reference genotype (if both chromosomes show the more frequent variant), the heterozygous genotype (if one chromosome shows the more frequent, and the other the less frequent variant), and the homozygous variant genotype (if both bases explaining the SNP are of the less frequent variant).</p>
    <p>Since SNPs can alter the risk for developing a disease, an important goal in studies concerned with SNPs is the identification of the SNPs that show a distribution of the genotypes that differs substantially between different groups (e.g., cancer vs. non-cancer). Detecting such SNPs requires methods that can cope with this vast multiple testing problem in which hundreds of thousands of hypotheses are tested simultaneously. Naturally, the value of a statistic appropriate for the considered testing situation and the corresponding <italic>p</italic>-value are computed for each variable, where in the case of SNPs Pearson's <italic>χ</italic><sup>2</sup>-statistic is an appropriate test score. These raw <italic>p</italic>-values are then adjusted for multiple comparisons such that a Type I error rate is strongly controlled at a prespecified level of significance <italic>α</italic>.</p>
    <p>The classical example for a Type I error rate is the family-wise error rate</p>
    <p>
      <disp-formula>FWER = Prob(<italic>V </italic>≥ 1),</disp-formula>
    </p>
    <p>where <italic>V </italic>is the number of false positives, i.e. the number of rejected null hypotheses that are actually true – or in biological terms, the number of SNPs found by the procedure to differ between groups that actually do not differ between the groups. This error rate is strongly controlled at a level <italic>α </italic>so that Prob(<italic>V </italic>≥ 1) ≤ <italic>α </italic>by approaches such as the Bonferroni correction or the procedures of Westfall and Young [<xref ref-type="bibr" rid="B1">1</xref>]. An overview on such methods is given in [<xref ref-type="bibr" rid="B2">2</xref>]. In [<xref ref-type="bibr" rid="B3">3</xref>], procedures for controlling this and other error rates are compared in an application to gene expression data.</p>
    <p>In classical multiple testing situations in which rarely more than 20 hypotheses are tested simultaneously, it is reasonable to keep down the probability of one or more false positives. However, in the analysis of data from whole-genome studies, hundreds of thousands of SNPs are considered simultaneously. Moreover, a few false positives are acceptable in such experiments as long as their number is small in proportion to the total number <italic>R </italic>of rejected null hypotheses, i.e. identified SNPs. This situation for which the family-wise error rate might be too conservative is thus similar to the multiple testing problem in studies concerned with gene expression data. In the analysis of such DNA microarray data, another error rate, namely the false discovery rate</p>
    <p>
      <disp-formula>
        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-144-i1" overflow="scroll">
          <mml:semantics>
            <mml:mrow>
              <mml:mtext>FDR</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnalign="left">
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mtext>E</mml:mtext>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>V</mml:mi>
                          <mml:mo>/</mml:mo>
                          <mml:mi>R</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mtext>if </mml:mtext>
                          <mml:mi>R</mml:mi>
                          <mml:mo>&gt;</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr columnalign="left">
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mtext>if </mml:mtext>
                          <mml:mi>R</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:semantics>
        </mml:math>
      </disp-formula>
    </p>
    <p>proposed by Benjamini and Hochberg [<xref ref-type="bibr" rid="B4">4</xref>], has hence become popular which in turn is a reasonable choice in the analysis of high-dimensional SNP data.</p>
    <p>Apart from adjusting <italic>p</italic>-values, there also exist other approaches for adjusting for multiple comparisons such as the significance analysis of microarrays (SAM [<xref ref-type="bibr" rid="B5">5</xref>]) and the empirical Bayes analysis of microarrays (EBAM [<xref ref-type="bibr" rid="B6">6</xref>]) that have been developed particularly for the analysis of gene expression data.</p>
    <p>In the original versions of both SAM and EBAM, a moderated <italic>t</italic>-statistic is computed. In SAM, the observed values of this test score are then plotted against the values of the statistic expected under the null hypothesis of no difference between the two groups, and a gene is called differentially expressed if the point representing this gene in this Quantile-Quantile plot is far away from the diagonal. In EBAM, the density <italic>f </italic>of the observed values <italic>z </italic>of the moderated <italic>t</italic>-statistic is modeled by a mixture of the density <italic>f</italic><sub>1 </sub>of the differentially expressed genes and the density <italic>f</italic><sub>0 </sub>of the not differentially expressed genes, i.e. by</p>
    <p>
      <disp-formula><italic>f</italic>(<italic>z</italic>) = <italic>π</italic><sub>0</sub><italic>f</italic><sub>0</sub>(<italic>z</italic>) + <italic>π</italic><sub>1</sub><italic>f</italic><sub>1</sub>(<italic>z</italic>),</disp-formula>
    </p>
    <p>where <italic>π</italic><sub>1 </sub>and <italic>π</italic><sub>0 </sub>= 1 - <italic>π</italic><sub>1 </sub>are the prior probabilities that a gene is differentially expressed or not, respectively. Following Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>], a gene having a <italic>z</italic>-value of <italic>z</italic>* is detected to be differentially expressed if the posterior probability</p>
    <p>
      <disp-formula>
        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-144-i2" overflow="scroll">
          <mml:semantics>
            <mml:mrow>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msup>
                <mml:mi>z</mml:mi>
                <mml:mo>∗</mml:mo>
              </mml:msup>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mi>π</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>f</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi>z</mml:mi>
                    <mml:mo>∗</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi>z</mml:mi>
                    <mml:mo>∗</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:semantics>
        </mml:math>
      </disp-formula>
    </p>
    <p>for being differentially expressed is larger than or equal to 0.9.</p>
    <p>In [<xref ref-type="bibr" rid="B7">7</xref>], a generalized version of the SAM algorithm is presented, whereas in [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>] SAM is adapted for categorical data such as SNP data.</p>
    <p>In the following section, we first present a generalized EBAM algorithm. Then, we propose an adaption of EBAM enabling the analysis of categorical data. As computing the values of the test statistic for all SNPs individually would be very time-consuming, we further suggest an approach based on matrix algebra that allows to compute all values simultaneously. Afterwards, EBAM for categorical data is applied, on the one hand, to two subsets of the high-dimensional SNP data from the HapMap project [<xref ref-type="bibr" rid="B10">10</xref>], and on the other hand, to simulated data that mimic data from a typical association study in which several ten SNPs are considered. In the latter application, it is also shown how EBAM can be applied to identify SNP interactions associated with the response, and how it can be used to specify the importance of prespecified SNP interactions.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Generalized EBAM algorithm</title>
      <p>In Algorithm 1, a generalized version of the empirical Bayes analysis of microarrays (EBAM [<xref ref-type="bibr" rid="B6">6</xref>]) is presented. This algorithm makes use of the fact that for a given rejection region Γ, the FDR can be estimated by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-144-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mtext>FDR</mml:mtext>
                  </mml:mrow>
                  <mml:mo stretchy="true">_</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>Γ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>π</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msub>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mtext>E</mml:mtext>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mtext>H</mml:mtext>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mo>#</mml:mo>
                        <mml:mo>{</mml:mo>
                        <mml:msub>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>Γ</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mo>#</mml:mo>
                        <mml:mo>{</mml:mo>
                        <mml:msub>
                          <mml:mi>z</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>Γ</mml:mi>
                        <mml:mo>}</mml:mo>
                        <mml:mo>,</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mo>}</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>z</italic><sub><italic>i </italic></sub>is the observed value of the test statistic <italic>Z</italic><sub><italic>i </italic></sub>for variable <italic>i </italic>= 1 ⋯ <italic>m</italic>, <italic>π</italic><sub>0 </sub>is the prior probability that a gene is not differentially expressed – or more generally, that a variable is not associated with the response – and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-144-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mrow><mml:msub><mml:mtext>H</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> (#{<italic>Z</italic><sub><italic>i </italic></sub>∈ Γ}) is the number of values expected under the null hypothesis to fall into Γ [<xref ref-type="bibr" rid="B11">11</xref>].</p>
      <p>Several procedures have been suggested to estimate the prior probability <italic>π</italic><sub>0</sub>[<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>], e.g., propose to use a narrow interval <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-144-i5" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">A</mml:mi></mml:semantics></mml:math></inline-formula> around <italic>z </italic>= 0, and to estimate <italic>π</italic><sub>0 </sub>by the ratio of the number of observed <italic>z</italic>-values in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-144-i5" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">A</mml:mi></mml:semantics></mml:math></inline-formula> to the number of <italic>z</italic>-values that are expected under the null hypothesis to fall into <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-144-i5" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">A</mml:mi></mml:semantics></mml:math></inline-formula>. However, the narrower <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-144-i5" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">A</mml:mi></mml:semantics></mml:math></inline-formula>, the more instable is this estimate. To stabilize this estimate, we use the procedure of Storey and Tibshirani [<xref ref-type="bibr" rid="B12">12</xref>] in which a natural cubic spline <italic>h </italic>with three degrees of freedom is fitted through the data points</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-144-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>λ</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>#</mml:mo>
                                <mml:mrow>
                                  <mml:mo>{</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>z</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>∈</mml:mo>
                                    <mml:mi>Λ</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>}</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>λ</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>λ</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.00</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0.01</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>...</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0.95</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-144-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>Λ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mn>0</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>λ</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:mi>Γ</mml:mi>
                            <mml:mtext> is one-sided</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mi>λ</mml:mi>
                                <mml:mo>/</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>λ</mml:mi>
                                <mml:mo>/</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:mi>Γ</mml:mi>
                            <mml:mtext> is two-sided</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and <italic>q</italic><sub><italic>λ </italic></sub>denotes the <italic>λ </italic>quantile of the (estimated) null distribution. The estimate of <italic>π</italic><sub>0 </sub>is then given by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-144-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>π</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mn>0</mml:mn>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>min</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mi>h</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>Algorithm 1 (Generalized EBAM Procedure)</title>
      <p>Let <bold>X </bold>be an <italic>m </italic>× <italic>n </italic>matrix comprising the values of <italic>m </italic>variables and <italic>n </italic>observations, <bold>y </bold>be a vector of length <italic>n </italic>composed of the values of the response for the <italic>n </italic>observations, and <italic>B </italic>be the number of permutations.</p>
      <p>1. For each variable <italic>i </italic>= 1, ..., <italic>m</italic>, compute the value <italic>z</italic><sub><italic>i </italic></sub>of a statistic appropriate for testing if the values of this variable are associated with the response.</p>
      <p>2. If the null density <italic>f</italic><sub>0</sub>, is known, use a density estimation procedure to obtain <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-144-i9" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> and compute <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-144-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula>. Otherwise, estimate the ratio <italic>ϕ </italic>= <italic>f</italic><sub>0</sub>/<italic>f </italic>directly by</p>
      <p>(a) determining the <italic>m </italic>permuted <italic>z</italic>-values <italic>z</italic><sub><italic>ib </italic></sub>for each permutation <italic>b </italic>= 1, ..., <italic>B </italic>of the <italic>n </italic>values of the response,</p>
      <p>(b) binning the <italic>m </italic>observed and <italic>mB </italic>permuted <italic>z</italic>-values into an appropriate number of intervals,</p>
      <p>(c) fitting a logistic regression model with repeated observations through these intervals using an appropriate regression function.</p>
      <p>3. Estimate <italic>π</italic><sub>0 </sub>by the procedure of Storey and Tibshirani [<xref ref-type="bibr" rid="B12">12</xref>].</p>
      <p>4. For each variable <italic>i</italic>, compute the posterior probability <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-144-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula></p>
      <p>5. Order the observed <italic>z</italic>-values to obtain <italic>z</italic><sub>(1) </sub>≤ ... ≤ <italic>z</italic><sub>(<italic>m</italic>)</sub>, and set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-144-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula></p>
      <p>6. For a prespecified probability Δ or a set of appropriate values for Δ,</p>
      <p>(a) set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-9-144-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:semantics></mml:math></inline-formula>, and compute the upper cut-off <italic>c</italic><sub><italic>U </italic></sub>by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-9-144-i14" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>c</mml:mi>
                  <mml:mi>U</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:msub>
                              <mml:mi>i</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:mo>≤</mml:mo>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mi>∞</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>(b) set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-9-144-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>Δ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:semantics></mml:math></inline-formula>, and compute the lower cut-off <italic>c</italic><sub><italic>L </italic></sub>by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-9-144-i16" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>c</mml:mi>
                  <mml:mi>L</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:msub>
                              <mml:mi>i</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mtext> and </mml:mtext>
                            <mml:msub>
                              <mml:mi>i</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mo>≥</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mi>∞</mml:mi>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>(c) call all variables <italic>i </italic>with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-9-144-i17" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∉</mml:mo><mml:msubsup><mml:mi>Γ</mml:mi><mml:mi>Δ</mml:mi><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> significant, where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-9-144-i18" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>Γ</mml:mi><mml:mi>Δ</mml:mi><mml:mi>C</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> denotes the complement of the rejection region Γ<sub>Δ</sub>,</p>
      <p>(d) estimate the FDR of Γ<sub>Δ </sub>by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-9-144-i19" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mtext>FDR</mml:mtext>
                  </mml:mrow>
                  <mml:mo stretchy="true">_</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>Γ</mml:mi>
                  <mml:mi>Δ</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>π</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mn>0</mml:mn>
                </mml:msub>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mo>#</mml:mo>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mi>Γ</mml:mi>
                              <mml:mi>Δ</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>}</mml:mo>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mo>}</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-9-144-i20" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mstyle displaystyle="true">
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mo>∫</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>c</mml:mi>
                                      <mml:mi>L</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>c</mml:mi>
                                      <mml:mi>U</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>f</mml:mi>
                                    <mml:mn>0</mml:mn>
                                  </mml:msub>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>z</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mtext>d</mml:mtext>
                                  <mml:mi>z</mml:mi>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mstyle>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:msub>
                              <mml:mi>f</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                            <mml:mtext> is known</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>#</mml:mo>
                                <mml:mrow>
                                  <mml:mo>{</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>z</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mi>b</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>∈</mml:mo>
                                    <mml:msub>
                                      <mml:mi>Γ</mml:mi>
                                      <mml:mi>Δ</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>}</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>B</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The original version of EBAM is of course a special case of Algorithm 1: Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] compute the moderated <italic>t</italic>-statistic</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-9-144-i21" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>z</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>d</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>a</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>s</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>for each gene <italic>i </italic>= 1, ..., <italic>m</italic>, where <italic>d</italic><sub><italic>i </italic></sub>is the difference of the groupwise mean expression values and <italic>s</italic><sub><italic>i </italic></sub>is the corresponding standard deviation such that <italic>d</italic><sub><italic>i</italic></sub>/<italic>s</italic><sub><italic>i </italic></sub>is the ordinary <italic>t</italic>-statistic. The fudge factor <italic>a</italic><sub>0 </sub>is computed by the quantile of the <italic>m </italic>standard deviations that leads to the largest number of genes called differentially expressed in a standardized EBAM analysis (see [<xref ref-type="bibr" rid="B6">6</xref>] for details on this standardized analysis). Since the null distribution of (1) is unknown, the response is permuted repeatedly to generate <italic>mB </italic>permuted <italic>z</italic>-values. Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] then bin the <italic>m </italic>observed and <italic>mB </italic>permuted <italic>z</italic>-values into 139 intervals. Treating the observed scores as successes and the permuted values as failures, a logistic regression model is fitted through the binned data points using a natural cubic spline with five degrees of freedom as regression function. For details on this logistic regression, see Remark (D) in [<xref ref-type="bibr" rid="B6">6</xref>].</p>
      <p>Algorithm 1 also comprises the approach used by Efron and Tibshirani [<xref ref-type="bibr" rid="B13">13</xref>] to test two-group gene expression data with Wilcoxon rank statistics.</p>
      <p>The main difference between Algorithm 1 and the original version of EBAM is that Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] call all genes differentially expressed that have a posterior probability larger than or equal to Δ = 0.9, whereas we only call a variable <italic>i </italic>with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-9-144-i22" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>1</sub>(<italic>z</italic><sub><italic>i</italic></sub>) ≥ Δ significant if there is no other variable with a more extreme <italic>z</italic>-value (a larger <italic>z</italic>-value if <italic>z</italic><sub><italic>i </italic></sub>&gt; 0, or a smaller <italic>z</italic>-value if <italic>z</italic><sub><italic>i </italic></sub>&lt; 0) that has a posterior probability less than Δ. This approach that is comparable to the proceeding in SAM, therefore, ensures that all variables with a <italic>z</italic>-value exceeding some threshold are called significant, whereas in the original version of EBAM it might happen that a variable is not called significant, even though it has a more extreme <italic>z</italic>-value than some of the identified variables.</p>
      <p>Another difference is that Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] consider one fixed posterior probability, namely Δ = 0.9, for calling genes differentially expressed, whereas we allow both to prespecify one probability Δ and to consider a set of reasonable values for Δ. The latter again is similar to the SAM procedure in which the number of genes called differentially expressed and the estimated FDR is determined for several values of the SAM threshold, and then the value is chosen that provides the best balance between the number of identified genes and the estimated FDR. This approach can be helpful when the detection of interesting variables is just an intermediate aim, and the actual goal of the analysis is, e.g., the construction of a classification rule. In such a case, prespecifying the value of Δ might work poorly, as this might lead to either a too small number of identified variables, or a too high FDR. For an example of this proceeding in the context of the empirical Bayes analysis, see the application of EBAM for categorical data to the HapMap data set.</p>
    </sec>
    <sec>
      <title>EBAM for categorical data</title>
      <p>We now assume that our data consist of <italic>m </italic>categorical variables each exhibiting <italic>C </italic>levels denoted by 1, ..., <italic>C</italic>, and <italic>n </italic>observations each belonging to one of <italic>R </italic>groups denoted by 1, ..., <italic>R</italic>. If these variables are SNPs, <italic>C </italic>= 3.</p>
      <p>A statistic appropriate for testing each of the <italic>m </italic>categorical variables if its null distribution differs between the <italic>R </italic>groups is Pearson's <italic>χ</italic><sup>2</sup>-statistic</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-9-144-i23" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>χ</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mover accent="true">
                                    <mml:mi>n</mml:mi>
                                    <mml:mo>~</mml:mo>
                                  </mml:mover>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>n</mml:mi>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mi>n</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mover accent="true">
                                    <mml:mi>n</mml:mi>
                                    <mml:mo>~</mml:mo>
                                  </mml:mover>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo>−</mml:mo>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:mstyle>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>n</italic><sub><italic>rc </italic></sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-9-144-i24" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub><italic>rc </italic></sub>are the observed number of observations and the number of observations expected under the null hypothesis in group <italic>r </italic>= 1, ..., <italic>R</italic>, respectively, showing level <italic>c </italic>= 1, ..., <italic>C</italic>.</p>
      <p>Since the small denominator problem [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B14">14</xref>], which is the reason for adding the fudge factor <italic>a</italic><sub>0 </sub>to the denominator of the ordinary <italic>t</italic>-statistic in (1), does not show up in this case, it is not necessary to add a fudge factor to the denominator of (2). Therefore, Algorithm 1 can be applied to SNPs – or to any other type of (genetic) categorical data – by employing Pearson's <italic>χ</italic><sup>2</sup>-statistic as test score.</p>
      <p>In EBAM, it is assumed that all variables follow the same null distribution. In the permutation based approach of Algorithm 1, this, e.g., means that not only the <italic>B </italic>permuted <italic>z</italic>-values corresponding to a particular variable, but all <italic>mB </italic>permutations of all <italic>m </italic>variables are considered in the estimation of the null distribution of this variable. Normally, this is an advantage in the analysis of high-dimensional data [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. In the analysis of categorical data, this, however, might lead to a loss of a large number of variables, as only variables showing the same number of levels can be considered together in an EBAM analysis.</p>
      <sec>
        <title>Approximation to <italic>χ</italic><sup>2</sup>-distribution</title>
        <p>Since the null distribution of (2) can be approximated by a <italic>χ</italic><sup>2</sup>-distribution with (<italic>R </italic>- 1)(<italic>C </italic>- 1) degrees of freedom, only the density <italic>f </italic>of the observed test statistics needs to be estimated. This can be done by applying a (non-parametric) kernel density estimator to the observed <italic>z</italic>-values [<xref ref-type="bibr" rid="B16">16</xref>]. However, the standard kernels are typically symmetric such that negative values of <italic>z </italic>will have a positive estimated density, even though <italic>f</italic>(<italic>z</italic>) = 0 for <italic>z </italic>&lt; 0. A solution to this problem is to use asymmetric kernels that only give non-negative values of <italic>z </italic>a positive density [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. Another solution, which we will use, is a semi-parametric method proposed by Efron and Tibshirani [<xref ref-type="bibr" rid="B19">19</xref>].</p>
        <p>In the first step of this procedure, a histogram of the observed <italic>z</italic>-values is generated. To obtain a reasonable number of bins for the histogram, we employ the one-level bin width estimator of Wand [<xref ref-type="bibr" rid="B20">20</xref>]. Although other bin width estimators such as the approaches of Scott [<xref ref-type="bibr" rid="B21">21</xref>] or of Freedman and Diaconis [<xref ref-type="bibr" rid="B22">22</xref>] lead to different bin widths, the densities resulting from the method of Efron and Tibshirani [<xref ref-type="bibr" rid="B19">19</xref>] are virtually identical. The approach of Sturges [<xref ref-type="bibr" rid="B23">23</xref>], however, which is, e.g., the default method for estimating the number of bins in the R function hist, typically leads to a much too small number of intervals when considering large numbers of observations [<xref ref-type="bibr" rid="B24">24</xref>], and is therefore an inappropriate procedure in our application.</p>
        <p>In the second step of the procedure of Efron and Tibshirani [<xref ref-type="bibr" rid="B19">19</xref>], a Poisson regression model is fitted in which the midpoints of the bins are used as explanatory variables, and the numbers of observations in the intervals are the values of the response. As most of the SNPs are assumed to show the same distribution in the different groups, the density <italic>f </italic>of the observed <italic>z</italic>-values typically looks similar to the null density <italic>f</italic><sub>0</sub>, but has a heavier right tail (see Figure <xref ref-type="fig" rid="F1">1</xref>). We therefore use a natural cubic spline with three degrees of freedom as regression function if (<italic>R </italic>- 1)(<italic>C </italic>- 1) ≤ 2. For (<italic>R </italic>- 1)(<italic>C </italic>- 1) ≥ 3, a natural cubic spline with five degrees of freedom would be a reasonable regression function. However, in functions such as the R function ns for generating the basis matrix of the spline, the inner knots by default are given by the 20%, 40%, 60%, and 80% quantile of the midpoints of the bins. These inner knots work well for symmetric densities. But the <italic>χ</italic><sup>2</sup>-distribution is asymmetric – in particular for a small value of the degrees of freedom. If (<italic>R </italic>- 1)(<italic>C </italic>- 1) ≥ 3, we hence specify the inner knots directly by centering them around the mode and not around the median. The inner knots are thus given by the 0.4<italic>q</italic><sub>M</sub>, 0.8<italic>q</italic><sub>M</sub>, 1 - 0.8(1 - <italic>q</italic><sub>M</sub>), and 1 - 0.4(1 - <italic>q</italic><sub>M</sub>) quantile of the midpoints, where <italic>q</italic><sub>M</sub> is the quantile of the midpoints that corresponds to the mode estimated by the midpoint of the bin of the histogram containing the most observations. If there is more than one bin showing the largest number of observations, then the smallest of the corresponding midpoints is used as estimate. Other mode estimators such as the half-range mode [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>] might lead to better estimates than this ad hoc methods, but the estimation of <italic>f </italic>is typically only slightly influenced by the choice of the mode estimator.</p>
        <fig position="float" id="F1">
          <label>Figure 1</label>
          <caption>
            <p><bold>Densities of the test scores in the analyses of the HapMap data</bold>. On the left hand side, the histograms and the estimated densities (marked by red lines) of the values of Pearson's <italic>χ</italic><sup>2</sup>-statistic of the SNPs from the two subsets of the HapMap data (upper panel: JPT vs. CHB, lower panel: all four HapMap populations) are shown. The cyan line marks the estimated density when the inner knots are centered around the median in the natural cubic spline used in the density estimation. On the right hand side, the estimated densities (again, marked by red lines) and the corresponding null densities (black lines) are displayed.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-144-1"/>
        </fig>
        <p>In Figure <xref ref-type="fig" rid="F2">2</xref>, the estimated densities of four <italic>χ</italic><sup>2</sup>-distributions with different degrees of freedom resulting from the application of this procedure to 100,000 values randomly drawn from the respective <italic>χ</italic><sup>2</sup>-distribution are displayed, where the inner knots are centered, on the one hand, around the mode (red lines), and on the other hand, around the median (cyan lines). This figure reveals that the former leads to a better estimation than using the standard inner knots. In fact, the densities estimated using the former approach are very similar to the true densities.</p>
        <fig position="float" id="F2">
          <label>Figure 2</label>
          <caption>
            <p><bold>Estimating the density of the <italic>χ</italic><sup>2</sup>-distribution</bold>. For different degrees of freedom, the true (black line) and the estimated density (red line) of the <italic>χ</italic><sup>2</sup>-distribution are shown, where the density is estimated by applying the procedure of Efron and Tibshirani [19] to 100,000 values randomly drawn from the <italic>χ</italic><sup>2</sup>-distribution. The cyan line marks the estimated density when the inner knots of the natural cubic spline are centered around the median in the <italic>df </italic>≥ 3 case.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-144-2"/>
        </fig>
        <p>Having estimated <italic>f</italic>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-9-144-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> is determined, and the remaining steps 3 to 6 of Algorithm 1 are processed.</p>
      </sec>
      <sec>
        <title>Permutation based estimation of the null density</title>
        <p>If the assumptions for the approximation to the <italic>χ</italic><sup>2</sup>-distribution are not met [<xref ref-type="bibr" rid="B27">27</xref>], the null density <italic>f</italic><sub>0 </sub>also has to be estimated. In this case, we calculate the ratio <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-9-144-i25" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> directly by permuting the group labels <italic>B </italic>times, computing the <italic>mB </italic>permuted <italic>z</italic>-values, dividing these scores and the <italic>m </italic>observed <italic>z</italic>-values into intervals, and fitting a logistic regression model through the binned data points. Similar to the application of the procedure of Efron and Tibshirani [<xref ref-type="bibr" rid="B19">19</xref>] (see previous section), the estimation of <italic>ϕ </italic>does not depend on the number of intervals used in the binning as long as this number is not too small or too large. We therefore follow Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>], and split the observed and permuted <italic>z</italic>-values into 139 intervals. Since the rejection region is one-sided when considering Pearson's <italic>χ</italic><sup>2</sup>-statistic as test score, a natural cubic spline with three degrees of freedom is used as regression function.</p>
      </sec>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Whole-genome studies comprise the genotypes of hundreds of thousands of SNPs for each of which the value of Pearson's <italic>χ</italic><sup>2</sup>-statistic (2) has to be computed. Since calculating these values one-by-one is very time-consuming, we employ matrix algebra for determining all the scores simultaneously.</p>
      <p>Assume that we have given an <italic>m </italic>× <italic>n </italic>matrix <bold>X </bold>in which each row corresponds to a categorical variable exhibiting the levels 1, ..., <italic>C</italic>, and a vector <bold>y</bold> comprising the group labels 1, ..., <italic>R </italic>of the <italic>n </italic>observations represented by the columns of <bold>X</bold>.</p>
      <p>Firstly, <italic>C m </italic>× <italic>n </italic>indicator matrices <bold>X</bold><sup>(<italic>c</italic>) </sup>for the <italic>C </italic>levels are constructed by setting the elements of these matrices to</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-9-144-i26" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mi>I</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:msub>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>i </italic>= 1, ..., <italic>m</italic>, <italic>j </italic>= 1, ..., <italic>n</italic>. Furthermore, an <italic>n </italic>× <italic>R </italic>matrix <bold>Y </bold>with entries <italic>y</italic><sub><italic>jr </italic></sub>= <italic>I</italic>(<italic>y</italic><sub><italic>j </italic></sub>= <italic>r</italic>) is built in which each column represents one of the <italic>R </italic>group labels. Then, we set</p>
      <p>
        <disp-formula><bold>N</bold><sup>(<italic>c</italic>) </sup>= <bold>X</bold><sup>(<italic>c</italic>)</sup><bold>Y</bold></disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-9-144-i27" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mover accent="true">
                    <mml:mi>N</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:mfrac>
                <mml:msup>
                  <mml:mi>X</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mn>1</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:msup>
                    <mml:mn>1</mml:mn>
                    <mml:mo>′</mml:mo>
                  </mml:msup>
                  <mml:mi>n</mml:mi>
                </mml:msub>
                <mml:mi>Y</mml:mi>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>c </italic>= 1, ..., <italic>C</italic>, where <bold>1</bold><sub><italic>n </italic></sub>is a vector of length <italic>n </italic>consisting only of ones, so that the <italic>i</italic>th column and <italic>r</italic>th row of the <italic>m </italic>× <italic>R </italic>matrices <bold>N</bold><sup>(<italic>c</italic>) </sup>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-9-144-i28" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sup>(<italic>c</italic>) </sup>comprise the observed and the expected number of observations, respectively, that belong to the <italic>r</italic>th group and show the <italic>c</italic>th level at the <italic>i</italic>th variable. Afterwards, the <italic>m </italic>× <italic>R </italic>matrices</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-9-144-i29" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>c</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>N</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>c</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>∗</mml:mo>
                            <mml:msup>
                              <mml:mi>N</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>c</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mover accent="true">
                                <mml:mi>N</mml:mi>
                                <mml:mo>˜</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>c</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>...</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>are determined by elementwise matrix calculation, i.e. by setting</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-9-144-i30" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>⋅</mml:mo>
                    <mml:msubsup>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mover accent="true">
                        <mml:mi>n</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Finally, the vector <bold>z </bold>comprising the value of Pearson's <italic>χ</italic><sup>2</sup>-statistic for each of the <italic>m </italic>variables is given by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-9-144-i31" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>z</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msub>
                      <mml:mn>1</mml:mn>
                      <mml:mi>R</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>If the permutation based version of EBAM for categorical data is used, then not "just" <italic>m</italic>, but <italic>m</italic>(<italic>B </italic>+ 1) <italic>z</italic>-values have to be computed. Again, matrix algebra can help to speed up computation by considering all <italic>B </italic>permutations at once, or – if the number of variables or permutations is too large – subsets of the <italic>B </italic>permutations.</p>
      <p>For this, suppose that <bold>L </bold>is a <italic>B </italic>× <italic>n </italic>matrix in which each row corresponds to one of the <italic>B </italic>permutations of the <italic>n </italic>group labels. If the <italic>B </italic>× <italic>n </italic>indicator matrices <bold>L</bold><sup>(<italic>r</italic>)</sup>, <italic>r </italic>= 1, ..., <italic>R</italic>, are defined analogously to <bold>X</bold><sup>(<italic>c</italic>)</sup>, then the <italic>m </italic>× <italic>B </italic>matrix <bold>Z</bold><sup>0 </sup>= {<italic>z</italic><sub><italic>ib</italic></sub>} containing the <italic>mB </italic>permuted <italic>z</italic>-values can be determined by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-9-144-i32" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>Z</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mi>X</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>c</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:msup>
                                  <mml:mi>L</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>r</mml:mi>
                                    <mml:msup>
                                      <mml:mo stretchy="false">)</mml:mo>
                                      <mml:mo>′</mml:mo>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>∗</mml:mo>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mi>X</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>c</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:msup>
                                  <mml:mi>L</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>r</mml:mi>
                                    <mml:msup>
                                      <mml:mo stretchy="false">)</mml:mo>
                                      <mml:mo>′</mml:mo>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mover accent="true">
                                <mml:mi>n</mml:mi>
                                <mml:mo>˜</mml:mo>
                              </mml:mover>
                              <mml:mi>r</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>c</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo>⊗</mml:mo>
                            <mml:msub>
                              <mml:msup>
                                <mml:mn>1</mml:mn>
                                <mml:mo>′</mml:mo>
                              </mml:msup>
                              <mml:mi>B</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mo>−</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-9-144-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is the <italic>r</italic>th column of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-9-144-i28" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, ⊗ is the symbol for the Kronecker product, and * and the fraction line denote elementwise matrix calculation.</p>
    </sec>
    <sec>
      <title>Processing time</title>
      <p>To evaluate how much the matrix calculation procedure presented in the previous section can speed up the computation in comparison to an individual determination of Pearson's <italic>χ</italic><sup>2</sup>-statistic, both approaches are applied to several numbers of variables. In Table <xref ref-type="table" rid="T1">1</xref>, the resulting processing times are summarized. This table shows that employing matrix algebra leads to an immense reduction of time needed for computation – in particular if the number <italic>m </italic>of variables is large. If, e.g., 100,000 variables are considered, it takes just 6.2 seconds to determine the values of Pearson's <italic>χ</italic><sup>2</sup>-statistic when employing matrix calculation, but more than 4.5 minutes when calculating the values one-by-one.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Comparison of computation times (in seconds) on an AMD Athlon XP 3000+ machine with one GB of RAM for both the matrix algebra based calculation and the individual determination of the values of Pearson's <italic>χ</italic><sup>2</sup>-statistic for different numbers of variables and observations. Each of the <italic>m </italic>variables can take <italic>C </italic>= 3 levels, and each of the <italic>n </italic>observations belongs to one of <italic>R </italic>= 2 classes.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center" colspan="2">Matrix Algebra Based</td>
              <td align="center" colspan="2">Individual</td>
            </tr>
            <tr>
              <td/>
              <td colspan="2">
                <hr/>
              </td>
              <td colspan="2">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="right">
                <italic>m</italic>
              </td>
              <td align="right"><italic>n </italic>= 200</td>
              <td align="right"><italic>n </italic>= 1, 000</td>
              <td align="right"><italic>n </italic>= 200</td>
              <td align="right"><italic>n </italic>= 1, 000</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right">50</td>
              <td align="right">&lt; 0.01</td>
              <td align="right">0.01</td>
              <td align="right">0.13</td>
              <td align="right">0.16</td>
            </tr>
            <tr>
              <td align="right">100</td>
              <td align="right">&lt; 0.01</td>
              <td align="right">0.02</td>
              <td align="right">0.26</td>
              <td align="right">0.32</td>
            </tr>
            <tr>
              <td align="right">1,000</td>
              <td align="right">0.05</td>
              <td align="right">0.40</td>
              <td align="right">2.64</td>
              <td align="right">3.35</td>
            </tr>
            <tr>
              <td align="right">10,000</td>
              <td align="right">0.63</td>
              <td align="right">2.39</td>
              <td align="right">26.74</td>
              <td align="right">34.42</td>
            </tr>
            <tr>
              <td align="right">100,000</td>
              <td align="right">6.16</td>
              <td align="right">-</td>
              <td align="right">274.96</td>
              <td align="right">-</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Note that the main reason for this immense reduction in computation time is not that the matrix calculation approach is algorithmically less complex than an individual computation, but that the implementation of this approach makes essential use of the way how vectorization and matrix multiplication are implemented in R [<xref ref-type="bibr" rid="B28">28</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>To exemplify that EBAM can be used to analyze high-dimensional categorical data, it is first applied to two subsets of the genotype data from the International Hapmap Project [<xref ref-type="bibr" rid="B10">10</xref>]. Afterwards, it is shown how EBAM can be employed to identify SNP interactions associated with the response in association studies, and to quantify the importance of genotypes. R code for reproducing the results of all analyses performed in this section is available in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
    <sec>
      <title>Application to HapMap data</title>
      <p>In the International HapMap Project, millions of SNPs have been genotyped for each of 270 people from the four populations Japanese from Tokyo (abbreviated by JPT), Han Chinese from Beijing (CHB), Yoruba in Ibadan, Nigeria (YRI), and CEPH (Utah residents with ancestry from northern and western Europe, abbreviated by CEU).</p>
      <p>About 500,000 of these SNPs have been measured using the Affymetrix GeneChip Mapping 500 K Array Set that consists of two chips. In this paper, we focus on the BRLMM (Bayesian Robust Linear Models with Mahalanobis distance) genotypes [<xref ref-type="bibr" rid="B29">29</xref>] of the 262,264 SNPs from one of these chips, namely the Nsp array (see [<xref ref-type="bibr" rid="B30">30</xref>] for these genotypes).</p>
      <sec>
        <title>JPT vs. CHB</title>
        <p>Since we are mainly interested in case-control studies, or more generally in binary responses, EBAM is applied to the 45 JPT and the 45 CHB to detect the SNPs that show a distribution that differs substantially between these two population. Another reason is that both the JPT are unrelated, and the CHB are unrelated, whereas the other two populations consist each of 30 trios each of which is composed of genotype data from a mother, a father and their child.</p>
        <p>Since in EBAM it is assumed that all variables follow the same null distribution, only SNPs showing the same number of genotypes are considered in the same EBAM analysis. Moreover, the current implementation of EBAM in the R package siggenes cannot handle missing values such that either missing genotypes have to be imputed, or SNPs with missing genotypes have to be removed prior to the EBAM analysis. Therefore, 54,400 SNPs showing one or more missing genotypes and 75,481 SNPs for which not all three genotypes are observed at the 90 persons are excluded from the analysis leading to a data set composed of the genotypes of 132,383 SNPs.</p>
        <p>Using an AMD Athlon XP 3000+ machine with one GB of RAM on which Windows XP is installed, an application of EBAM to this data set takes 11.62 seconds if the null density <italic>f</italic><sub>0 </sub>is approximated by the <italic>χ</italic><sup>2</sup>-density with two degrees of freedom, whereas it takes about 182 seconds if <italic>f</italic><sub>0 </sub>is estimated using 100 permutations.</p>
        <p>In the upper left panel of Figure <xref ref-type="fig" rid="F1">1</xref>, a histogram and the estimated density <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-9-144-i9" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> of the observed test scores is displayed. For many of the SNPs the assumptions for an approximation to the <italic>χ</italic><sup>2</sup>-distribution might not be met [<xref ref-type="bibr" rid="B27">27</xref>], as some of the expected numbers in the corresponding contingency table are smaller than 5. We therefore prefer not to use the approximation to the <italic>χ</italic><sup>2</sup>-distribution, but the permutation based approach of EBAM for categorical data.</p>
        <p>Employing the threshold Δ = 0.9 as suggested by Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>], i.e. calling all SNPs significant that have a posterior probability of being significant larger than or equal to 0.9, leads to the identification of 193 SNPs with an estimated FDR of 0.08.</p>
        <p>It is, however, also possible to use EBAM similarly to SAM [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. For this, assume that we aim, on the one hand, to control the FDR at a level of about 0.05, and on the other hand, to identify about 200 SNPs for further analyses with, e.g., discrimination methods [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B31">31</xref>] such as logic regression [<xref ref-type="bibr" rid="B32">32</xref>]. In Table <xref ref-type="table" rid="T2">2</xref>, the numbers of detected SNPs and the corresponding FDRs are summarized for six reasonable values of Δ. This table reveals that it is not possible to attain both goals simultaneously, as calling 200 SNPs significant would lead to an FDR larger than 0.08, whereas controlling the FDR at 0.05 would result in the identification of about 42 SNPs. This table also shows that Δ = 0.90 (or Δ = 0.91) provides a good trade-off between the two goals. Hence, Δ = 0.90 will be also a good choice here if EBAM is used similarly to SAM.</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Estimated FDRs and numbers of identified SNPs for several values of the threshold Δ.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td align="right">0.89</td>
                <td align="right">0.90</td>
                <td align="right">0.91</td>
                <td align="right">0.92</td>
                <td align="right">0.93</td>
                <td align="right">0.94</td>
                <td align="right">0.95</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">Number</td>
                <td align="right">224</td>
                <td align="right">193</td>
                <td align="right">147</td>
                <td align="right">109</td>
                <td align="right">66</td>
                <td align="right">42</td>
                <td align="right">22</td>
              </tr>
              <tr>
                <td align="right">FDR</td>
                <td align="right">0.090</td>
                <td align="right">0.080</td>
                <td align="right">0.070</td>
                <td align="right">0.063</td>
                <td align="right">0.056</td>
                <td align="right">0.048</td>
                <td align="right">0.039</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>A list of the 193 SNPs with a posterior probability of being significant larger than or equal to 0.9 along with links to dbSNP [<xref ref-type="bibr" rid="B33">33</xref>] is available in the Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>. Besides the <italic>z</italic>-values and the posterior probabilities <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-9-144-i22" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>1</sub>(<italic>z</italic>), this file also contains an estimate for the local FDR for each SNP [<xref ref-type="bibr" rid="B6">6</xref>]. Contrary to the FDR employed to quantify the overall accuracy of a list of variables, the local FDR proposed by Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] is a variable-specific measure that can be estimated by</p>
        <p>
          <disp-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-9-144-i34" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mtext>fdr</mml:mtext>
                    </mml:mrow>
                    <mml:mo stretchy="true">_</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>z</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi>π</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>ϕ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>z</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mover accent="true">
                          <mml:mi>p</mml:mi>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>z</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Multi-class case</title>
        <p>EBAM for categorical variables is not restricted to binary responses. It, e.g., can also be used to identify the SNPs showing a distribution that differs strongly between the four HapMap populations.</p>
        <p>For this analysis, the most obvious dependencies are removed by excluding the child from each of the 60 trios such that 45 JPT, 45 CHB, 60 YRI, and 60 CEU are considered. Again, all SNPs for which at least one of the 210 values are missing (104,872 SNPs), or for which not all three genotypes are observed (14,273 SNPs), are excluded from the analysis resulting in a data set composed of the genotypes of 143,119 SNPs. In the lower right panel of Figure <xref ref-type="fig" rid="F1">1</xref>, the estimated density of the <italic>z</italic>-values of these SNPs and the estimated null density are displayed. This figure reveals that a huge number of these SNPs exhibit a distribution that differs substantially in at least one of the populations. In fact, 131,336 SNPs show a posterior probability <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-9-144-i22" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>1</sub>(<italic>z</italic>) larger than or equal to 0.9, whereas 33,101 SNPs even have a posterior probability of 1.</p>
        <p>To examine which of the populations are responsible for this huge number of significant SNPs, we perform a two-class EBAM analysis for each pair of the four HapMap populations. In Table <xref ref-type="table" rid="T3">3</xref>, the numbers of SNPs exhibiting a posterior probability <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-9-144-i22" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>1</sub>(<italic>z</italic>) ≥ 0.9 are summarized for all these analyses. This table reveals that only JPT and CHB show a small number of SNPs that differ between these two populations. In all other two-class comparisons, a huge number of SNPs are called significant, where CEU differs the most from the other populations. These results do not seem to be that surprising, since JPT and CHB are both populations from Asia, whereas the other two populations come from two other continents.</p>
        <table-wrap position="float" id="T3">
          <label>Table 3</label>
          <caption>
            <p>Numbers of significant SNPs found in pairwise EBAM analyses of the four HapMap populations.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td align="right">JPT</td>
                <td align="right">CHB</td>
                <td align="right">YRI</td>
                <td align="right">CEU</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">JPT</td>
                <td align="right">-</td>
                <td align="right">148</td>
                <td align="right">66,410</td>
                <td align="right">92,732</td>
              </tr>
              <tr>
                <td align="right">CHB</td>
                <td align="right">148</td>
                <td align="right">-</td>
                <td align="right">66,196</td>
                <td align="right">92,492</td>
              </tr>
              <tr>
                <td align="right">YRI</td>
                <td align="right">66,410</td>
                <td align="right">66,196</td>
                <td align="right">-</td>
                <td align="right">92,969</td>
              </tr>
              <tr>
                <td align="right">CEU</td>
                <td align="right">92,732</td>
                <td align="right">92,492</td>
                <td align="right">92,969</td>
                <td align="right">-</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
    <sec>
      <title>Identification of interactions</title>
      <p>When considering complex diseases, e.g., sporadic breast cancer, it is assumed that not individual SNPs, but interactions of SNPs have a high impact on the risk of developing the disease [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. In such a case, it would therefore be of interest to also test interactions of SNPs. However, in whole-genome studies in which the number <italic>m </italic>of SNPs is in the tens or even hundreds of thousands, it would take – depending on the order of the interactions – hours, days or even weeks to compute the test scores for all <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-9-144-i35" overflow="scroll"><mml:semantics><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula><italic>p</italic>-way interactions comprised by the <italic>m </italic>variables. For strategies on testing two-way interactions comprised by data from a simulated whole-genome study on a cluster of computers and their computation times, see [<xref ref-type="bibr" rid="B36">36</xref>]. Here, we focus our interest on the EBAM analysis of interactions of SNPs from association studies such as the GENICA study [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B37">37</xref>] in which typically several ten SNPs are examined.</p>
      <p>For the simulation of such a study, data for 50 SNPs and 1,000 observations are generated by randomly drawing the genotypes 1 (for the homozygous reference), 2 (heterozygous), and 3 (homozygous variant) for each SNP <italic>S</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1 ,..., 50, where the minor allele frequency of the SNP is chosen uniformly at random from the interval [0.25, 0.4]. Afterwards, the case-control status <italic>y </italic>is randomly drawn from a Bernoulli distribution with mean Prob(<italic>Y </italic>= 1), where</p>
      <p>l<disp-formula>ogit(Prob(<italic>Y </italic>= 1)) = -0.5 + <italic>I</italic>(<italic>S</italic><sub>6 </sub>≠ 1, <italic>S</italic><sub>7 </sub>= 1),</disp-formula></p>
      <p>such that the probability of being a case is 62.25% if SNP <italic>S</italic><sub>6 </sub>is not of the homozygous reference genotype and SNP <italic>S</italic><sub>7 </sub>is of this genotype.</p>
      <p>In the left panel of Figure <xref ref-type="fig" rid="F3">3</xref>, the result of the application of EBAM to these 50 SNPs is displayed. This figure shows that <italic>S</italic><sub>6 </sub>is the only SNP with a posterior probability larger than or equal to 0.9, and thus the only SNP called significant. This figure also reveals that <italic>S</italic><sub>7 </sub>shows the eighth largest <italic>z</italic>-value with a posterior probability of 0.313. If, however, the <italic>m</italic>(<italic>m </italic>- 1)/2 = 1,225 two-way interactions of the <italic>m </italic>= 50 SNPs are considered, then the interaction of <italic>S</italic><sub>6 </sub>and <italic>S</italic><sub>7 </sub>shows the by far largest <italic>z</italic>-value (see right panel of Figure <xref ref-type="fig" rid="F3">3</xref>). Most of the other features found to be significant are interactions of <italic>S</italic><sub>6 </sub>with another SNP. In this analysis, not all 1,225, but 1,224 of the two-way interactions are included, since one of the interactions shows only seven of the nine genotypes comprised by the respective two SNPs, and is thus excluded from the EBAM analysis of interactions showing all nine genotypes.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>EBAM analysis of the simulated data</bold>. Scatter plots of the posterior probabilities vs. the <italic>z</italic>-values resulting from the applications of EBAM to both the simulated SNPs themselves (left panel) and the two-way interactions comprised by these SNPs (right panel). Red points mark SNPs or SNP interactions called significant by EBAM, as their posterior probability is larger than or equal to 0.9 (dashed line).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-144-3"/>
      </fig>
      <p>This analysis is repeated several times using different simulated data sets each generated randomly with the above settings. In each of the applications of EBAM to the individual SNPs, either one of <italic>S</italic><sub>6 </sub>and <italic>S</italic><sub>7</sub>, or both are identified to be significant. Rarely, also other SNPs show a posterior probability larger than 0.9. In all of the analyses of the two-way interactions, the interaction of <italic>S</italic><sub>6 </sub>and <italic>S</italic><sub>7 </sub>is detected to be the most important one.</p>
    </sec>
    <sec>
      <title>Measuring the importance of genotypes</title>
      <p>EBAM cannot only be used to detect interesting variables or interactions. The posterior probabilities estimated by EBAM can also be employed to quantify the importance of features found by other approaches such as logicFS [<xref ref-type="bibr" rid="B38">38</xref>].</p>
      <p>Logic regression [<xref ref-type="bibr" rid="B32">32</xref>] – which is employed as base learner in logicFS – is an adaptive regression and classification procedure that searches for Boolean combinations of binary variables associated with the response. Since this method has shown a good performance in comparison to other discrimination [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B39">39</xref>] and regression [<xref ref-type="bibr" rid="B40">40</xref>,<xref ref-type="bibr" rid="B41">41</xref>] approaches, a bagging [<xref ref-type="bibr" rid="B42">42</xref>] version of logic regression is used in logicFS to identify interactions of SNPs that are potentially interesting, i.e. associated with the response. While some of the found genotypes/interactions, that are of a similar form as the one intended to be influential for the disease risk in the previous section, have a high impact on the disease risk, others are only found at random by logicFS. It is therefore necessary to quantify the importance of the detected genotypes.</p>
      <p>Since logic regression and thus logicFS can only handle binary predictors, each SNP has to be split into (at least) two binary dummy variables. We follow [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B38">38</xref>] and code each SNP <italic>S</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1, ..., <italic>m</italic>, by</p>
      <p><italic>S</italic><sub><italic>i</italic>1</sub>: "<italic>S</italic><sub><italic>i </italic></sub>is not of the homozygous reference genotype."</p>
      <p><italic>S</italic><sub><italic>i</italic>2</sub>: "<italic>S</italic><sub><italic>i </italic></sub>is of the homozygous variant genotype."</p>
      <p>such that <italic>S</italic><sub><italic>i</italic>1 </sub>codes for a dominant and <italic>S</italic><sub><italic>i</italic>2 </sub>for a recessive effect. The genotype intended to be influential in the simulated data set described in the previous section can thus also be specified by the logic expression</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-9-144-i36" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mn>61</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>∧</mml:mo>
                <mml:msubsup>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mn>71</mml:mn>
                  </mml:mrow>
                  <mml:mi>C</mml:mi>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <sup><italic>C </italic></sup>denotes the complement of a binary variable with outcome true or false, and ⋀ represents the AND-operator.</p>
      <p>Contrary to the previous section in which each of the <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-9-144-i35" overflow="scroll"><mml:semantics><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> distributions of the values of the 3<sup><italic>p </italic></sup>levels comprised by the respective combination of <italic>p </italic>of the <italic>m </italic>SNPs is tested whether it differs between groups of persons, EBAM is here applied to conjunctions, i.e. AND-combinations, of binary variables with outcome true or false which are in turn binary variables such that genotypes of different orders, i.e. combinations of genotypes of different numbers of SNPs, can be considered together in the same EBAM analysis.</p>
      <p>Applying the single tree approach of logicFS, see [<xref ref-type="bibr" rid="B38">38</xref>], with 50 iterations to the data set composed of the 100 dummy variables coding for the 50 simulated SNPs from the previous section leads to the detection of 84 potentially interesting interactions. For each of these genotypes which are conjunctions of one to four binary variables, the importance is then determined by the posterior probability estimated by EBAM. The importances, however, should not be quantified using the same data set on which the genotypes are identified, as it is very likely that almost any of the found genotypes is called significant, since it already has shown up as potentially interesting. In fact, if EBAM is applied to the 84 genotypes evaluated on the data set on which they were detected, 70 of them are called significant using Δ = 0.9 and 15 show a posterior probability of 1 (see left panel of Figure <xref ref-type="fig" rid="F4">4</xref>). While these 15 genotypes are composed of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-9-144-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>71</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> and one or two other binary variables, 32 of the genotypes called significant do neither contain <italic>S</italic><sub>6 </sub>nor <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-9-144-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>71</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. Moreover, two genotypes exist that exhibit a larger <italic>z</italic>-value than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-9-144-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>71</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>EBAM applied to the genotypes identified by logicFS</bold>. Scatter plots of the posterior probabilities vs. the <italic>z</italic>-values resulting from the applications of EBAM to the genotypes found in an application of logicFS to the simulated data. On the left hand side, the results of the application of EBAM to the data set on which the genotypes are found is shown, whereas on the right hand side, an independent data set is used to test the genotypes. Red points mark SNPs called significant by EBAM using Δ = 0.9 (dashed line).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-144-4"/>
      </fig>
      <p>It is therefore more appropriate to test the found genotypes on an independent data set. Thus, a new (test) data set is randomly generated as described in the previous section. Afterwards, the values of the 84 detected genotypes for the observations from the new data set are computed, and EBAM is applied to these values.</p>
      <p>The same 15 genotypes as in the application to the original data set show a posterior probability of 1, where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-9-144-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>71</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is found to be the genotype with the largest <italic>z</italic>-value. The other three genotypes also called significant using Δ = 0.9 either contain <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-9-144-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>61</mml:mn></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mn>71</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> or <italic>S</italic><sub>61</sub>. All the other genotypes not intended to have an impact on the disease risk, but called significant in the application to the data set on which they were found show a posterior probability less than 0.9, and thus are not called significant anymore in the application to the test data set.</p>
      <p>Again, this analysis is repeated several times with different training and test data sets leading to similar results in each of the applications.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion and Discussion</title>
    <p>Using the Bayesian framework to adjust for multiple comparisons is an attractive alternative to adjusting <italic>p</italic>-values – in particular if the data are high-dimensional. Thus, Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] have suggested an empirical Bayes analysis of microarrays (EBAM) for testing each gene if its mean expression value differs between two groups with a moderated <italic>t</italic>-statistic.</p>
    <p>In this paper, we have proposed an algorithm that generalizes this procedure. This algorithm comprises the original EBAM analysis of Efron et al. [<xref ref-type="bibr" rid="B6">6</xref>] as well as the EBAM analysis based on Wilcoxon rank sums [<xref ref-type="bibr" rid="B13">13</xref>], and allows for other types of EBAM analyses in other testing situations. For this, it is only necessary to choose an appropriate test statistic, and, if the null density is known, a method for estimating the density of the observed test scores. The EBAM approach for categorical data proposed in this paper is one example for such an analysis. Another example would be to use an <italic>F</italic>-statistic for performing an EBAM analysis of continuous data (e.g., gene expression data) when the response shows more than two levels. In this case, the <italic>z</italic>-values of the genes would be given by the values of the <italic>F</italic>-statistic, and the density of the observed <italic>z</italic>-values might be estimated by the procedure of Efron and Tibshirani [<xref ref-type="bibr" rid="B19">19</xref>] if an <italic>F</italic>-distribution with appropriate degrees of freedom is assumed to be the null distribution.</p>
    <p>The generalized EBAM algorithm along with functions for using (moderated) <italic>t</italic>-statistics (one- and two-class, paired and unpaired, assuming equal or unequal group variances), (moderated) <italic>F</italic>-statistics and Wilcoxon rank sums is implemented in the R package siggenes version 1.10.0 and later that can be downloaded from the webpage [<xref ref-type="bibr" rid="B43">43</xref>] of the BioConductor project [<xref ref-type="bibr" rid="B44">44</xref>] (see also the section Availability and requirements).</p>
    <p>siggenes version 1.11.7 and later also contains a function for the EBAM analysis of categorical data proposed in this paper. Note that siggenes 1.10.× already comprises a preversion of this function. The main difference between these versions is the estimation of the density <italic>f </italic>of the observed test scores: While in siggenes 1.10.× the default version of the R function ns is used to generate the basis matrix for the natural cubic spline that is employed in the estimation of <italic>f</italic>, the inner knots of this spline are centered around the mode (and not the median) in siggenes 1.11.7 and later which leads to a better estimate of <italic>f </italic>as Figure <xref ref-type="fig" rid="F2">2</xref> shows.</p>
    <p>To exemplify how EBAM for categorical data can be applied to SNP data from whole-genome studies, it has been used to analyze two subsets of the HapMap data. In the first application aiming to identify SNPs showing a distribution that differs substantially between JPT and CHB, 193 of the 132,383 considered SNPs show a posterior probability larger than or equal to 0.9, and are therefore called significant by EBAM, where the estimated FDR of this set of SNPs is 0.08.</p>
    <p>The number of identified SNPs and the corresponding FDR resulting from this EBAM analysis are identical to the results of the application of SAM to this HapMap data set [<xref ref-type="bibr" rid="B9">9</xref>] when the same permutations of the group labels are used in both methods. This is due to the fact that both EBAM and SAM employ the same approach to estimate the FDR. Moreover, the same set of SNPs is identified by both methods, since the same non-negative test statistic is used in both applications. Virtually the same applies to the usage of the <italic>q</italic>-values [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] as implemented, e.g., in John Storey's R package qvalue. For example, each of the 193 SNPs found by EBAM exhibit a <italic>q</italic>-value less than or equal to 0.08.</p>
    <p>In the second application to the HapMap data set in which all four populations are considered, most of the 143,119 SNPs show a distribution that differs substantially in at least one of the four groups. This huge number of differences does not seem to be that surprising, as the four HapMap populations come from three different continents. Pairwise EBAM analyses of the four populations show that CEU is the population that differs the most from the other populations. Again, a SAM analysis would lead to the same estimated FDR as the EBAM analysis if the same number of SNPs is identified, where this set of significant variables will contain the same SNPs in both analyses.</p>
    <p>An advantage of EBAM over other approaches is that it not only estimates the FDR for a set of detected variables, but also naturally provides a variable-specific estimate for the probability that a variable is associated with the response.</p>
    <p>The two applications to the HapMap data, however, also reveal two restrictions of the EBAM procedure. Since in EBAM it is assumed that all variables follow the same null distribution, a large number of SNPs have to be removed prior to both analyses, as these SNPs either exhibit missing values or only show (one or) two of the three genotypes. A solution to the former problem would be to replace the missing genotypes using imputation methods such as KNNcatImpute [<xref ref-type="bibr" rid="B45">45</xref>] or – when considering Affymetrix SNP chips – to employ genotype calling algorithms such as RLMM [<xref ref-type="bibr" rid="B46">46</xref>] or CRLMM [<xref ref-type="bibr" rid="B47">47</xref>] that allow to obtain genotypes for all SNPs.</p>
    <p>An idea to solve the second problem is to perform two EBAM analyses – one for the SNPs showing only two genotypes, and one for the SNPs with data available for all three genotypes. Having computed the posterior probabilities for the two sets of SNPs separately and called all SNPs significant that exhibit a posterior probability of being significant larger than or equal to Δ in any of the analyses, a combined FDR needs to be estimated for both analysis, since we are interested in one estimate for the FDR of all detected SNPs. How such a combined estimate of the FDR can be obtained is an open question that will be part of future research.</p>
    <p>EBAM cannot only be used to test individual categorical variables such as SNPs, but can also be applied to interactions of these variables.</p>
    <p>However, two problems occur when considering interactions. The first problem is that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-9-144-i35" overflow="scroll"><mml:semantics><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula><italic>p</italic>-way interactions have to be tested. Although the functions implemented in siggenes allow to split the variables into subsets, an EBAM analysis of interactions in high-dimensional data is not feasible in a reasonable amount of time. It is thus restricted to data from association studies in which several ten to a few hundred SNPs are considered.</p>
    <p>The second problem is the empty cell problem: The number of observations available in a study is limited such that when considering <italic>p</italic>-way interactions of SNPs some of the 3<sup><italic>p </italic></sup>cells of the <italic>p</italic>-dimensional contingency tables of some of the interactions will be empty leading to features with different numbers of categories and thus with different null distributions. Hence, EBAM cannot be applied to all of these features at once. In the analysis of the two-way interactions from the simulated data set, e.g., one interaction exhibits values only for seven of the nine genotypes comprised by two SNPs. This interaction therefore has to be removed from the EBAM analysis.</p>
    <p>The abovementioned idea of performing separate EBAM analyses for variables with different numbers of levels and computing a combined FDR might not be ideal in the case of interactions, as many different numbers of level could exist. In such a situation, a better solution is not to consider the <italic>p</italic>-way interactions as variables with 3<sup><italic>p </italic></sup>categories, but to test each of the 3<sup><italic>p </italic></sup>genotypes comprised by <italic>p </italic>SNPs that are observed at at least a particular number of persons. Furthermore, it might make sense to include the complements of the genotypes, as, e.g., "Not the homozygous reference genotype" corresponds to a recessive effect of a SNP. This, however, would increase the multiple testing problem by a factor of up to 6<sup><italic>p </italic></sup>such that a filtering prior to the EBAM analysis might be advisable/necessary.</p>
    <p>Boulesteix et al. [<xref ref-type="bibr" rid="B48">48</xref>] propose a multiple testing procedure for the identification of the combination of genotypes in a prespecified subset of (interacting) SNPs that shows the largest association with the response. Another solution to this multiple testing problem that does not require a prespecification of a subset of SNPs has been described in this paper: Firstly, a search algorithm such as logicFS is used to identify potentially interesting genotypes, where these genotypes can be composed of the genotypes from any of the SNPs considered in the study. Afterwards, the detected genotypes are tested on an independent data set using EBAM, where the posterior probability of being significant resulting from this EBAM analysis can be interpreted as an importance measure for the genotypes. For this analysis, it is not necessary that all genotypes are composed of the genotypes of the same number of SNPs, as they are coded as binary variables. Quantifying the importance of (combinations of) binary variables is implemented in the R packages logicFS version 1.7.6 and later [<xref ref-type="bibr" rid="B49">49</xref>].</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Project name: siggenes – Multiple testing using SAM and Efron's empirical Bayes approach</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.1/bioc/html/siggenes.html"/> (for siggenes 1.12.0)</p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: R</p>
    <p>Licence: Free for non-commercial use</p>
    <p>Any restrictions to use by non-academics: See the licence in the siggenes package</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>CEPH – Utah residents with ancestry from northern and western Europe (CEU). Han Chinese from Beijing (CHB). Empirical Bayes Analysis of Microarrays (EBAM). False Discovery Rate (FDR). Japanese from Tokyo (JPT). Significance Analysis of Microarrays (SAM). Single Nucleotide Polymorphism (SNP). Yoruba in Ibadan, Nigeria (YRI).</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>HS had the idea to generalize EBAM and to adapt EBAM to SNPs, implemented the software, and wrote the paper. KI was involved in the development of EBAM for categorical data and the design of the applications. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>scriptEBAMSNP.R</bold>. This file that can be opened either in R or in any txt-editor contains the R code that has been used to generate the results presented in this paper.</p>
      </caption>
      <media xlink:href="1471-2105-9-144-S1.r" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>ebam.jpt.chb.html</bold>. This html-file contains information about the significant SNPs found in the EBAM analysis of JPT vs. CHB.</p>
      </caption>
      <media xlink:href="1471-2105-9-144-S2.html" mimetype="text" mime-subtype="html">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>Financial support of the Deutsche Forschungsgemeinschaft (SFB 475, "Reduction of Complexity in Multivariate Data Structures") is gratefully acknowledged. The authors also would like to thank the reviewers for their helpful comments.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Westfall</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <source>Resampling-based multiple testing: examples and methods for p-value adjustments</source>
        <year>1993</year>
        <publisher-name>New York, NY: Wiley</publisher-name>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaffer</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing</article-title>
        <source>Ann Rev Psych</source>
        <year>1995</year>
        <volume>46</volume>
        <fpage>561</fpage>
        <lpage>584</lpage>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Boldrick</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing in microarray experiments</article-title>
        <source>Stat Sci</source>
        <year>2003</year>
        <volume>18</volume>
        <fpage>71</fpage>
        <lpage>103</lpage>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Roy Statist Soc B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5116</fpage>
        <lpage>5124</lpage>
        <pub-id pub-id-type="pmid">11309499</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes analysis of a microarray experiment</article-title>
        <source>J Amer Statist Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <fpage>1151</fpage>
        <lpage>1160</lpage>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ickstadt</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Identifying interesting genes with siggenes</article-title>
        <source>RNews</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>45</fpage>
        <lpage>50</lpage>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Modifying microarray analysis methods for categorical data – SAM and PAM for SNPs</article-title>
        <source>Classification – The Ubiquitous Challenge</source>
        <year>2005</year>
        <edition>Weihs C, Gaul W</edition>
        <publisher-name>Springer, Heidelberg</publisher-name>
        <fpage>370</fpage>
        <lpage>377</lpage>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of genotype and gene expression data</article-title>
        <source>PhD thesis</source>
        <year>2007</year>
        <publisher-name>University of Dortmund, Department of Statistics</publisher-name>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>The International HapMap Consortium</collab>
        </person-group>
        <article-title>The International HapMap Project</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>426</volume>
        <fpage>789</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="pmid">14685227</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J Roy Statist Soc B</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance of genome-wide studies</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes methods and false discovery rates for microarrays</article-title>
        <source>Genet Epidemiol</source>
        <year>2002</year>
        <volume>23</volume>
        <fpage>70</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="pmid">12112249</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>Article 3</fpage>
        <pub-id pub-id-type="pmid">16646809</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Parmigiani G, Garrett ES, Irizarry RA, Zeger SL</surname>
          </name>
        </person-group>
        <article-title>SAM thresholding and false discovery rates for detecting differential gene expression in DNA microarrays</article-title>
        <source>The Analysis of Gene Expression Data: Methods and Software</source>
        <year>2004</year>
        <publisher-name>Springer, New York</publisher-name>
        <fpage>272</fpage>
        <lpage>290</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Silverman</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <source>Density estimation for statistics and data analysis</source>
        <year>1986</year>
        <publisher-name>London: Chapman and Hall</publisher-name>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>SX</given-names>
          </name>
        </person-group>
        <article-title>Probability density functions estimation using gamma kernels</article-title>
        <source>Ann Inst Statist Math</source>
        <year>2000</year>
        <volume>52</volume>
        <fpage>471</fpage>
        <lpage>480</lpage>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scaillet</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Density estimation using inverse and reciprocal inverse Gaussian kernels</article-title>
        <source>J Nonparam Statist</source>
        <year>2004</year>
        <volume>16</volume>
        <fpage>217</fpage>
        <lpage>226</lpage>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using specially designed exponential families for density estimation</article-title>
        <source>Ann Statist</source>
        <year>1996</year>
        <volume>24</volume>
        <fpage>2431</fpage>
        <lpage>2461</lpage>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wand</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Data-based choice of histogram bin width</article-title>
        <source>Amer Stat</source>
        <year>1997</year>
        <volume>51</volume>
        <fpage>59</fpage>
        <lpage>64</lpage>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>On optimal and data-based histograms</article-title>
        <source>Biometrika</source>
        <year>1979</year>
        <volume>66</volume>
        <fpage>605</fpage>
        <lpage>610</lpage>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freedman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Diaconis</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>On the histogram as a density estimator: <italic>L</italic><sub>2 </sub>theory</article-title>
        <source>Z Wahr Verw Geb</source>
        <year>1981</year>
        <volume>57</volume>
        <fpage>453</fpage>
        <lpage>476</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sturges</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The choice of a class-interval</article-title>
        <source>J Amer Statist Assoc</source>
        <year>1926</year>
        <volume>21</volume>
        <fpage>65</fpage>
        <lpage>66</lpage>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <source>Multivariate density estimation: theory, practice, and visualization</source>
        <year>1992</year>
        <publisher-name>New York: Wiley</publisher-name>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bickel</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Robust estimators of the mode and skewness of continuous data</article-title>
        <source>Computat Statist Data Anal</source>
        <year>2002</year>
        <volume>39</volume>
        <fpage>153</fpage>
        <lpage>163</lpage>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedges</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comparison of mode estimation methods and application in molecular clock analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>31</fpage>
        <pub-id pub-id-type="pmid">12892571</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cochran</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>Some methods for strengthening the common <italic>χ</italic><sup>2 </sup>tests</article-title>
        <source>Biometrics</source>
        <year>1954</year>
        <volume>10</volume>
        <fpage>417</fpage>
        <lpage>451</lpage>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <collab>R Development Core Team</collab>
        </person-group>
        <source>R: a language and environment for statistical computing</source>
        <year>2007</year>
        <publisher-name>R Foundation for Statistical Computing, Vienna, Austria</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org"/>
        <comment>ISBN 3-900051-07-0</comment>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <collab>Affymetrix</collab>
        </person-group>
        <source>BRLMM: an improved genotype calling method for the GeneChip Human Mapping 500 k array set</source>
        <year>2006</year>
        <publisher-name>Tech rep, Affymetrix, Santa Clara, CA</publisher-name>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <article-title>Affymetrix – Mapping 500 k genotype calls on 270HapMap samples</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/sample_data/500k_hapmap_genotype_data.affx"/>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zucknick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ickstadt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bolt</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <article-title>A pilot study on the application of statistical classification procedure to molecular epidemiological data</article-title>
        <source>Tox Letter</source>
        <year>2004</year>
        <volume>151</volume>
        <fpage>291</fpage>
        <lpage>299</lpage>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kooperberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Logic regression</article-title>
        <source>J Comput Graph Stat</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>475</fpage>
        <lpage>511</lpage>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="other">
        <article-title>The single nucleotids polymorphism database (dbSNP)</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/projects/SNP"/>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garte</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Metabolic susceptibility genes as cancer risk factors: time for a reassessment?</article-title>
        <source>Cancer Epidemiol Biomarkers Prev</source>
        <year>2001</year>
        <volume>10</volume>
        <fpage>1233</fpage>
        <lpage>1237</lpage>
        <pub-id pub-id-type="pmid">11751439</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Culverhouse</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Suarez</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A perspective on epistasis: limits of models displaying no main effect</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>70</volume>
        <fpage>461</fpage>
        <lpage>471</lpage>
        <pub-id pub-id-type="pmid">11791213</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Donnely</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide strategies for detecting multiple loci that influence complex diseases</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>413</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="pmid">15793588</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Justenhoven</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hamann</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Pesch</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Harth</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rabstein</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baisch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vollmert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Illig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brüning</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brauch</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ERCC2 genotypes and a corresponding haplotype are linked with breast cancer risk in a German population</article-title>
        <source>Cancer Epidemiol Biomarker Prev</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>2059</fpage>
        <lpage>2064</lpage>
        <pub-id pub-id-type="pmid">15598761</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ickstadt</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Identification of SNP interactions using logic regression</article-title>
        <source>Biostat</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>187</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="pmid">17578898</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kooperberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Exploring interactions in high-dimensional genomic data: an overview of logic regression, with applications</article-title>
        <source>J Mult Anal</source>
        <year>2004</year>
        <volume>90</volume>
        <fpage>178</fpage>
        <lpage>195</lpage>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kooperberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Sequence analysis using logic regression</article-title>
        <source>Genet Epidemiol</source>
        <year>2001</year>
        <volume>21</volume>
        <fpage>S626</fpage>
        <lpage>S631</lpage>
        <pub-id pub-id-type="pmid">11793751</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witte</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Fijal</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Introduction: analysis of sequence data and population structure</article-title>
        <source>Genet Epidemiol</source>
        <year>2001</year>
        <volume>21</volume>
        <fpage>600</fpage>
        <lpage>601</lpage>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Bagging predictors</article-title>
        <source>Mach Learn</source>
        <year>1996</year>
        <volume>26</volume>
        <fpage>123</fpage>
        <lpage>140</lpage>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="other">
        <article-title>BioConductor project</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tierney</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2004/5/10/R80"/>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schwender</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ickstadt</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Imputing missing genotypes with k nearest neighbors</source>
        <year>2008</year>
        <publisher-name>Tech rep., Collaborative Research Center 475, Department of Statistics, University of Dortmund</publisher-name>
      </citation>
    </ref>
    <ref id="B46">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabbee</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A genotype calling algorithm for Affymetrix SNP arrays</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>7</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">16267090</pub-id>
      </citation>
    </ref>
    <ref id="B47">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvalho</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bengtsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and genotype calls for high-density oligonucleotide SNP array data</article-title>
        <source>Biostat</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>485</fpage>
        <lpage>499</lpage>
      </citation>
    </ref>
    <ref id="B48">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boulesteix</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Strobl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weidinger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wichmann</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Wagenpfeil</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multiple testing for SNP-SNP interactions</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2007</year>
        <volume>6</volume>
        <pub-id pub-id-type="pmid">18171321</pub-id>
      </citation>
    </ref>
    <ref id="B49">
      <citation citation-type="other">
        <article-title>logicFS version 1.8.0</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.1/bioc/html/logicFS.html"/>
      </citation>
    </ref>
  </ref-list>
</back>
