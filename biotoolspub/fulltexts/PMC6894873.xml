<?properties open_access?>
<?subarticle pone.0225734.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6894873</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-21282</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0225734</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Programming Languages</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Spatial and Landscape Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Spatial and Landscape Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Theoretical Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Theoretical Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecosystems</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecosystems</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computing Methods</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Geometry</subject>
            <subj-group>
              <subject>Fractals</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyLandStats: An open-source Pythonic library to compute landscape metrics</article-title>
      <alt-title alt-title-type="running-head">PyLandStats: Landscape metrics in Python</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8735-9144</contrib-id>
        <name>
          <surname>Bosch</surname>
          <given-names>Martí</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Urban and Regional Planning Community (CEAT), École Polytechnique Fédérale de Lausanne (EPFL), Lausanne, Switzerland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rocchini</surname>
          <given-names>Duccio</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universita degli Studi di Trento, ITALY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The author has declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>marti.bosch@epfl.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>12</issue>
    <elocation-id>e0225734</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Martí Bosch</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Martí Bosch</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0225734.pdf"/>
    <abstract>
      <p>Quantifying the spatial pattern of landscapes has become a common task of many studies in landscape ecology. Most of the existing software to compute landscape metrics is not well suited to be used in interactive environments such as Jupyter notebooks nor to be included as part of automated computational workflows. This article presents PyLandStats, an open-source Pythonic library to compute landscape metrics within the scientific Python stack. The PyLandStats package provides a set of methods to quantify landscape patterns, such as the analysis of the spatiotemporal patterns of land use/land cover change or zonal analysis. The implementation is based on the prevailing Python libraries for geospatial data analysis in a way that they can be forthwith integrated into complex computational workflows. Notably, the provided methods offer a large variety of options so that users can employ PyLandStats in the way that best supports their needs. The source code is publicly available, and is organized in a modular object-oriented structure that enhances its maintainability and extensibility.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="12"/>
      <page-count count="19"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All the data files are available at a GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats-notebooks/tree/biorxiv/data">https://github.com/martibosch/pylandstats-notebooks/tree/biorxiv/data</ext-link> and have been derived from the Corine Land Cover datasets <ext-link ext-link-type="uri" xlink:href="https://land.copernicus.eu/pan-european/corine-land-cover">https://land.copernicus.eu/pan-european/corine-land-cover</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All the data files are available at a GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats-notebooks/tree/biorxiv/data">https://github.com/martibosch/pylandstats-notebooks/tree/biorxiv/data</ext-link> and have been derived from the Corine Land Cover datasets <ext-link ext-link-type="uri" xlink:href="https://land.copernicus.eu/pan-european/corine-land-cover">https://land.copernicus.eu/pan-european/corine-land-cover</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Landscape ecology is based on the notion that the spatial pattern of landscapes strongly influences the ecological processes that occur upon them [<xref rid="pone.0225734.ref001" ref-type="bibr">1</xref>]. From this perspective, quantifying the spatial patterns of landscapes becomes a central prerequisite to the study of the pattern-process relationships. Landscape ecologists often view landscapes as an heterogeneous spatial mosaic of discrete patches, each representing a zone of relatively homogeneous conditions, where the size, shape and configuration of patches significantly affects key ecosystem functions such as biodiversity and fluxes of organisms and materials [<xref rid="pone.0225734.ref002" ref-type="bibr">2</xref>].</p>
    <p>Recent decades have seen the development of a series of landscape metrics that quantify several aspects of the spatial pattern of landscapes [<xref rid="pone.0225734.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0225734.ref005" ref-type="bibr">5</xref>]. In a context of significant advances in geographical information systems (GIS) and increasing availability of land use/land cover (LULC) datasets, landscape metrics have been implemented within a variety of software packages [<xref rid="pone.0225734.ref006" ref-type="bibr">6</xref>]. The present article introduces PyLandStats, an open-source library to compute landscape metrics, which represents an advance over previously available software because of its implementation within the most popular libraries of the scientific and data-centric Python stack. Additionally, its modular and object-oriented design allows it to be efficiently used in interactive environments such as Jupyter notebooks as well as in automated computational workflows, and eases the maintainability and extensibility of the code.</p>
    <p>The remainder of the article describes the structure and use of PyLandStats by presenting a thorough example analysis case for a sequence of three raster landscape snapshots of the Canton of Vaud (Switzerland) for the years 2000, 2006 and 2012, which have been extracted from the Corine Land Cover [<xref rid="pone.0225734.ref007" ref-type="bibr">7</xref>] inventory. The code snippets and materials to reproduce the figures of the following four sections can be found in <xref ref-type="supplementary-material" rid="pone.0225734.s003">S1</xref>, <xref ref-type="supplementary-material" rid="pone.0225734.s004">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0225734.s005">S3</xref> and <xref ref-type="supplementary-material" rid="pone.0225734.s006">S4</xref> Codes respectively.</p>
  </sec>
  <sec id="sec002">
    <title>Analysis of a single landscape</title>
    <p>The basic unit of the PyLandStats library is the <monospace>Landscape</monospace> class, which represents the LULC mosaic of a particular region <italic>at a given point in time</italic>. A <monospace>Landscape</monospace> instance mainly consists of an array where each position represents the LULC class at the corresponding pixel of the lanscape.</p>
    <p>Since LULC data is most often stored in raster files (e.g., GeoTiff), the easiest way to instantiate a <monospace>Landscape</monospace> object is by passing a path to a raster file as first argument, as in:</p>
    <p specific-use="line">&gt; ls = Landscape(‘<italic>path/to/raster.tif</italic>’)</p>
    <p>The above call will use the rasterio Python library in order to read the raster files, and will extract the pixel resolution and no-data value from the file metadata. Alternatively, <monospace>Landscape</monospace> instances might also be initialized by passing a NumPy array [<xref rid="pone.0225734.ref008" ref-type="bibr">8</xref>] as first argument, which also requires specifying the x and y coordinates of pixel resolution as a tuple in the <monospace>res</monospace> keyword argument. By default, PyLandStats assumes that zero values in the array represent pixels with no data. Otherwise, the no-data value can be specified by means of the <monospace>nodata</monospace> keyword argument. A <monospace>Landscape</monospace> instance can be plotted at any moment by using its <monospace>plot_landscape</monospace> method. Note that all the plotting methods of PyLandStats make use of the matplotlib library [<xref rid="pone.0225734.ref009" ref-type="bibr">9</xref>].</p>
    <sec id="sec003">
      <title>Computing data frames of landscape metrics</title>
      <p>Landscape metrics might be classified into two main groups (see <xref ref-type="supplementary-material" rid="pone.0225734.s002">S1 Table</xref> for the list of metrics implemented in PyLandStats, their classification and their description). The first concerns metrics that provide a scalar value for each patch of the landscape, which are often referred to as patch-level metrics. The second consists of metrics that provide a scalar value that aggregates a characteristic of interest over a set of the patches. This second group allows for an additional distinction between class-level metrics, which are computed over all patches of a given LULC class, and landscape-level metrics, which are those computed over all the patches of a landscape.</p>
      <p>For a given <monospace>Landscape</monospace> instance, the patch-level metrics can be computed by means of the <monospace>compute_patch_metrics_df</monospace> method as in:</p>
      <p specific-use="line"><italic>#</italic> ‘<italic>ls</italic>’ <italic>is a given ‘Landscape’ instance</italic></p>
      <p specific-use="line">&gt; ls.compute_patch_metrics_df()</p>
      <p>which will return a pandas data frame [<xref rid="pone.0225734.ref010" ref-type="bibr">10</xref>] as depicted in <xref rid="pone.0225734.t001" ref-type="table">Table 1</xref>, where each row corresponds to a patch of the landscape with its associated LULC class value and the computed metrics.</p>
      <table-wrap id="pone.0225734.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Example data frame of patch-level metrics.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t001g" xlink:href="pone.0225734.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">patch_id</th>
                <th align="center" rowspan="1" colspan="1">class_val</th>
                <th align="center" rowspan="1" colspan="1">area</th>
                <th align="center" rowspan="1" colspan="1">perimeter</th>
                <th align="center" rowspan="1" colspan="1">perimeter_area_ratio</th>
                <th align="center" rowspan="1" colspan="1">shape_index</th>
                <th align="center" rowspan="1" colspan="1">fractal_dimension</th>
                <th align="center" rowspan="1" colspan="1">euclidean_nearest_neighbor</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">115.0</td>
                <td align="char" char="." rowspan="1" colspan="1">10600.0</td>
                <td align="char" char="." rowspan="1" colspan="1">92.173913</td>
                <td align="char" char="." rowspan="1" colspan="1">2.409091</td>
                <td align="char" char="." rowspan="1" colspan="1">1.129654</td>
                <td align="char" char="." rowspan="1" colspan="1">1431.782106</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">13.0</td>
                <td align="char" char="." rowspan="1" colspan="1">2600.0</td>
                <td align="char" char="." rowspan="1" colspan="1">200.000000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.625000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.100096</td>
                <td align="char" char="." rowspan="1" colspan="1">223.606798</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0</td>
                <td align="char" char="." rowspan="1" colspan="1">600.0</td>
                <td align="char" char="." rowspan="1" colspan="1">300.000000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.000000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.011893</td>
                <td align="char" char="." rowspan="1" colspan="1">223.606798</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
                <td align="center" rowspan="1" colspan="1">⋮</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">203</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">11.0</td>
                <td align="char" char="." rowspan="1" colspan="1">1800.0</td>
                <td align="char" char="." rowspan="1" colspan="1">163.636364</td>
                <td align="char" char="." rowspan="1" colspan="1">1.285714</td>
                <td align="char" char="." rowspan="1" colspan="1">1.052571</td>
                <td align="char" char="." rowspan="1" colspan="1">223.606798</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">204</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0</td>
                <td align="char" char="." rowspan="1" colspan="1">800.0</td>
                <td align="char" char="." rowspan="1" colspan="1">400.000000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.333333</td>
                <td align="char" char="." rowspan="1" colspan="1">1.069990</td>
                <td align="char" char="." rowspan="1" colspan="1">223.606798</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">205</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">14.0</td>
                <td align="char" char="." rowspan="1" colspan="1">2400.0</td>
                <td align="char" char="." rowspan="1" colspan="1">171.428571</td>
                <td align="char" char="." rowspan="1" colspan="1">1.500000</td>
                <td align="char" char="." rowspan="1" colspan="1">1.079705</td>
                <td align="char" char="." rowspan="1" colspan="1">282.842712</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Similarly, metrics can be computed at the class level by using the <monospace>compute_class_metrics_df</monospace> method as in:</p>
      <p specific-use="line">&gt; ls.compute_class_metrics_df()</p>
      <p>which will return a pandas data frame as depicted in <xref rid="pone.0225734.t002" ref-type="table">Table 2</xref>, where each row corresponds to a LULC class and each column represents a metric computed at the row’s class level.</p>
      <table-wrap id="pone.0225734.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Example data frame of class-level metrics.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t002g" xlink:href="pone.0225734.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">24729</td>
                <td align="char" char="." rowspan="1" colspan="1">7.701939</td>
                <td align="center" rowspan="1" colspan="1">193</td>
                <td align="char" char="." rowspan="1" colspan="1">0.060111</td>
                <td align="char" char="." rowspan="1" colspan="1">2.069921</td>
                <td align="center" rowspan="1" colspan="1">1431600</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">296346</td>
                <td align="char" char="." rowspan="1" colspan="1">92.298061</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="char" char="." rowspan="1" colspan="1">0.004049</td>
                <td align="char" char="." rowspan="1" colspan="1">89.451374</td>
                <td align="center" rowspan="1" colspan="1">1431600</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Lastly, the landscape-level metrics can be computed by using the <monospace>compute_landscape_metrics_df</monospace> method as in:</p>
      <p specific-use="line">&gt; ls.compute_landscape_metrics_df()</p>
      <p>which will return a pandas data frame as depicted in <xref rid="pone.0225734.t003" ref-type="table">Table 3</xref>, where the only row features the values of the metrics computed at the landscape level.</p>
      <table-wrap id="pone.0225734.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Example data frame of landscape-level metrics.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t003g" xlink:href="pone.0225734.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">edge_density</th>
                <th align="center" rowspan="1" colspan="1">landscape_shape_index</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">321075</td>
                <td align="center" rowspan="1" colspan="1">206</td>
                <td align="center" rowspan="1" colspan="1">0.064159</td>
                <td align="center" rowspan="1" colspan="1">89.451374</td>
                <td align="center" rowspan="1" colspan="1">1431600</td>
                <td align="center" rowspan="1" colspan="1">4.458771</td>
                <td align="center" rowspan="1" colspan="1">9.716931</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>Customizing the landscape analysis</title>
      <p>While a vast collection of metrics have been proposed over the literature of the last decades, many of them are highly correlated with one another. As a matter of fact, Riitters et al. [<xref rid="pone.0225734.ref011" ref-type="bibr">11</xref>] found that the characteristics represented by 55 prevalent landscape metrics could be reduced to only 6 independent factors. Therefore, analysis cases tend to consider a limited subset of metrics. To that end, the three methods that compute data frames of metrics showcased above can be customized by means of the <monospace>metrics</monospace> keyword argument as in:</p>
      <p specific-use="line">&gt; ls.compute_class_metrics_df(</p>
      <p specific-use="line"> metrics = [‘<italic>proportion_of_landscape</italic>’, ‘<italic>edge_density</italic>’])</p>
      <p>which will return a pandas data frame where only the specified metrics will appear as columns.</p>
      <p>On the other hand, certain metrics allow for some customization concerning the way in which they are computed. In PyLandStats, each metric is defined in its dedicated method in the <monospace>Landscape</monospace> class, which includes metric-specific keyword arguments that allow controlling how the metric is computed. For instance, when computing the edge density (ED), the user might decide whether edges between LULC pixels and no-data pixels (e.g., landscape boundaries) are considered, or whether the area should be converted to hectares. By default, PyLandStats computes the metrics according to the definitions specified in FRAGSTATS v4 [<xref rid="pone.0225734.ref005" ref-type="bibr">5</xref>] (see also <xref ref-type="supplementary-material" rid="pone.0225734.s007">S5 Code</xref>), and therefore does not consider edges between LULC pixels and no-data pixels, and converts areas to hectares. Nevertheless, the user might decide to change that by providing the <monospace>count_boundary</monospace> and <monospace>hectares</monospace> keyword arguments to the <monospace>edge_density</monospace> method as in:</p>
      <p specific-use="line">&gt; ls.edge_density()</p>
      <p specific-use="line">4.4587713151132915</p>
      <p specific-use="line">&gt; ls.edge_density(count_boundary = True)</p>
      <p specific-use="line">6.863816865218407</p>
      <p specific-use="line">&gt; ls.edge_density(count_boundary = True, hectares = False)</p>
      <p specific-use="line">0.0006863816865218407</p>
      <p>Similarly, the <monospace>compute_patch_metrics_df</monospace>, <monospace>compute_class_metrics_df</monospace>, and <monospace>compute_landscape_metrics_df</monospace> accept the <monospace>metrics_kws</monospace> keyword argument in the form of a dictionary, which allows setting the keyword arguments that must be passed to each metrics’ method when computing the data frames. For instance, in order to compute a class-level data frame with the <monospace>proportion_of_landscape</monospace> as a fraction instead of a percentage, and include the landscape boundaries in <monospace>edge_density</monospace>, the <monospace>metrics_kws</monospace> keyword argument must be provided as in:</p>
      <p specific-use="line">&gt; ls.compute_class_metrics_df(</p>
      <p specific-use="line"> metrics_kws={</p>
      <p specific-use="line">  ‘<italic>proportion_of_landscape</italic>’: {‘<italic>percent</italic>’: False},</p>
      <p specific-use="line">  ‘<italic>edge_density</italic>’: {‘<italic>count_boundary</italic>’: True}</p>
      <p specific-use="line"> })</p>
      <p>In the above example, the columns of the returned data frame will feature not only the proportion of landscape and edge density, but all the available metrics instead. In order to compute a reduced set of metrics, some of which with non-default arguments, both <monospace>metrics</monospace> and <monospace>metric_kws</monospace> keyword arguments must be defined. For instance, in the code snippet below:</p>
      <p specific-use="line">&gt; ls.compute_class_metrics_df(</p>
      <p specific-use="line"> metrics = [</p>
      <p specific-use="line">  ‘<italic>proportion_of_landscape</italic>’, ‘<italic>edge_density</italic>’, ‘<italic>fractal_dimension_am</italic>’</p>
      <p specific-use="line"> ],</p>
      <p specific-use="line"> metrics_kws={</p>
      <p specific-use="line">  ‘<italic>proportion_of_landscape</italic>’: {‘<italic>percent</italic>’: False},</p>
      <p specific-use="line">  ‘<italic>edge_density</italic>’: {‘<italic>count_boundary</italic>’: True}</p>
      <p specific-use="line"> })</p>
      <p>the returned data frame will be of the form depicted in <xref rid="pone.0225734.t004" ref-type="table">Table 4</xref>.</p>
      <table-wrap id="pone.0225734.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Example of a data frame of class-level metrics computed with custom <monospace>metrics</monospace> and <monospace>metrics_kws</monospace> keyword arguments.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t004g" xlink:href="pone.0225734.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">edge_density</th>
                <th align="center" rowspan="1" colspan="1">fractal_dimension_am</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.077019</td>
                <td align="char" char="." rowspan="1" colspan="1">4.502998</td>
                <td align="char" char="." rowspan="1" colspan="1">1.129561</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.922981</td>
                <td align="char" char="." rowspan="1" colspan="1">6.819590</td>
                <td align="char" char="." rowspan="1" colspan="1">1.204003</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Note that the <monospace>metrics</monospace> and <monospace>metric_kws</monospace> keyword arguments work in the same way for the <monospace>compute_patch_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods. Additionally, a list of LULC class values might be provided to the <monospace>classes</monospace> keyword argument of <monospace>compute_class_metrics_df</monospace> in order to compute the metrics for the specified subset of classes only. The three keyword arguments are complimentary and might therefore be used in conjunction. For instance, adding a <monospace>classes = [1]</monospace> to the foregoing code snippet would return a data frame of the form depicted in <xref rid="pone.0225734.t004" ref-type="table">Table 4</xref> but featuring only the first row.</p>
    </sec>
  </sec>
  <sec id="sec005">
    <title>Spatiotemporal analysis</title>
    <p>Landscape metrics are often applied to assess the spatiotemporal patterns of LULC change for a given region by computing landscape metrics over a temporally-ordered sequence of landscape snapshots. To this end, PyLandStats features the <monospace>SpatioTemporalAnalysis</monospace> class, which is instantiated with a temporally-ordered sequence of landscape snapshots.</p>
    <p specific-use="line">&gt; input_filepaths = [</p>
    <p specific-use="line">  ‘<italic>snapshot00.tif</italic>’, ‘<italic>snapshot06.tif</italic>’, ‘<italic>snapshot12.tif</italic>’</p>
    <p specific-use="line"> ]</p>
    <p specific-use="line">&gt; dates = [2000, 2006, 2012] <italic># the dates of each snapshot</italic></p>
    <p specific-use="line">&gt; sta = pls.SpatioTemporalAnalysis(input_filepaths, dates = dates)</p>
    <p>When initializing a <monospace>SpatioTemporalAnalysis</monospace> instance, a <monospace>Landscape</monospace> instance will be created for each of the landscape snapshots provided as first argument. The <monospace>dates</monospace> argument might also be provided as string or <monospace>datetime</monospace> objects (see <xref ref-type="supplementary-material" rid="pone.0225734.s004">S2 Code</xref>).</p>
    <sec id="sec006">
      <title>Computing spatiotemporal data frames</title>
      <p>Similarly to <monospace>Landscape</monospace> instances, the data frames of class and landscape-level metrics of a <monospace>SpatioTemporalAnalysis</monospace> instance can be computed by means of the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods respectively. For instance, following the snippet above, the data frame of class-level metrics can be obtained as in:</p>
      <p specific-use="line">&gt; sta.compute_class_metrics_df()</p>
      <p>which will return a data frame indexed by both the class value and date, as depicted in <xref rid="pone.0225734.t005" ref-type="table">Table 5</xref>.</p>
      <table-wrap id="pone.0225734.t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Example data frame of class-level metrics for a spatiotemporal analysis.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t005g" xlink:href="pone.0225734.t005"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="right" rowspan="1" colspan="1">dates</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="3" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">2000</td>
                <td align="center" rowspan="1" colspan="1">24729</td>
                <td align="char" char="." rowspan="1" colspan="1">7.70194</td>
                <td align="center" rowspan="1" colspan="1">193</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0601106</td>
                <td align="char" char="." rowspan="1" colspan="1">2.06992</td>
                <td align="center" rowspan="1" colspan="1">1.4316e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2006</td>
                <td align="center" rowspan="1" colspan="1">24599</td>
                <td align="char" char="." rowspan="1" colspan="1">7.66145</td>
                <td align="center" rowspan="1" colspan="1">200</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0622907</td>
                <td align="char" char="." rowspan="1" colspan="1">2.02227</td>
                <td align="center" rowspan="1" colspan="1">1.436e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2012</td>
                <td align="center" rowspan="1" colspan="1">24766</td>
                <td align="char" char="." rowspan="1" colspan="1">7.71346</td>
                <td align="center" rowspan="1" colspan="1">201</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0626022</td>
                <td align="char" char="." rowspan="1" colspan="1">2.02227</td>
                <td align="center" rowspan="1" colspan="1">1.4459e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="3" colspan="1">2</td>
                <td align="right" rowspan="1" colspan="1">2000</td>
                <td align="center" rowspan="1" colspan="1">296346</td>
                <td align="char" char="." rowspan="1" colspan="1">92.2981</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0040489</td>
                <td align="char" char="." rowspan="1" colspan="1">89.4514</td>
                <td align="center" rowspan="1" colspan="1">1.4316e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2006</td>
                <td align="center" rowspan="1" colspan="1">296476</td>
                <td align="char" char="." rowspan="1" colspan="1">92.3386</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00249163</td>
                <td align="char" char="." rowspan="1" colspan="1">89.1318</td>
                <td align="center" rowspan="1" colspan="1">1.436e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2012</td>
                <td align="center" rowspan="1" colspan="1">296309</td>
                <td align="char" char="." rowspan="1" colspan="1">92.2865</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00249163</td>
                <td align="char" char="." rowspan="1" colspan="1">89.0916</td>
                <td align="center" rowspan="1" colspan="1">1.4459e+06</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Similarly, the data frame of landscape metrics can be obtained as follows:</p>
      <p specific-use="line">&gt; sta.compute_landscape_metrics_df()</p>
      <p>where the resulting data frame will be indexed by the dates as depicted in <xref rid="pone.0225734.t006" ref-type="table">Table 6</xref>.</p>
      <table-wrap id="pone.0225734.t006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t006</object-id>
        <label>Table 6</label>
        <caption>
          <title>Example data frame of landscape-level metrics for a spatiotemporal analysis.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t006g" xlink:href="pone.0225734.t006"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">dates</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">edge_density</th>
                <th align="center" rowspan="1" colspan="1">landscape_shape_index</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">2000</td>
                <td align="center" rowspan="1" colspan="1">321075</td>
                <td align="center" rowspan="1" colspan="1">206</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0641595</td>
                <td align="char" char="." rowspan="1" colspan="1">89.4514</td>
                <td align="center" rowspan="1" colspan="1">1.4316e+06</td>
                <td align="char" char="." rowspan="1" colspan="1">4.45877</td>
                <td align="char" char="." rowspan="1" colspan="1">9.71693</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2006</td>
                <td align="center" rowspan="1" colspan="1">321075</td>
                <td align="center" rowspan="1" colspan="1">208</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0647824</td>
                <td align="char" char="." rowspan="1" colspan="1">89.1318</td>
                <td align="center" rowspan="1" colspan="1">1.436e+06</td>
                <td align="char" char="." rowspan="1" colspan="1">4.47248</td>
                <td align="char" char="." rowspan="1" colspan="1">9.73633</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2012</td>
                <td align="center" rowspan="1" colspan="1">321075</td>
                <td align="center" rowspan="1" colspan="1">209</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0650938</td>
                <td align="char" char="." rowspan="1" colspan="1">89.0916</td>
                <td align="center" rowspan="1" colspan="1">1.4459e+06</td>
                <td align="char" char="." rowspan="1" colspan="1">4.50331</td>
                <td align="char" char="." rowspan="1" colspan="1">9.77998</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Note that PyLandStats does not compute data frames for spatiotemporal analyses at the patch level, given that new patches emerge and others disappear over the years and therefore there is no common index upon which the data frames of patch-level metrics for different snapshots could be assembled.</p>
    </sec>
    <sec id="sec007">
      <title>Customizing the spatiotemporal analysis</title>
      <p>As with the <monospace>Landscape</monospace> class, the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods of the <monospace>SpatioTemporalAnalysis</monospace> class also allow customizing how each metric is computed by means of the <monospace>metrics</monospace> and <monospace>metric_kws</monospace> arguments. Additionally, the <monospace>classes</monospace> keyword argument might be provided to <monospace>compute_class_metrics_df</monospace> in order to compute the metrics for the specified subset of classes only. For instance, the code snippet below:</p>
      <p specific-use="line">&gt; sta.compute_class_metrics_df(</p>
      <p specific-use="line"> metrics = [‘<italic>proportion_of_landscape</italic>’, ‘<italic>edge_density</italic>’,</p>
      <p specific-use="line">  ‘<italic>fractal_dimension_am</italic>’, ‘<italic>landscape_shape_index</italic>’,</p>
      <p specific-use="line">  ‘<italic>shannon_diversity_index</italic>’],</p>
      <p specific-use="line"> classes = [1],</p>
      <p specific-use="line"> metrics_kws = {</p>
      <p specific-use="line">  ‘<italic>proportion_of_landscape</italic>’: {‘<italic>percent</italic>’: False},</p>
      <p specific-use="line">  ‘<italic>edge_density</italic>’: {‘<italic>count_boundary</italic>’: True}})</p>
      <p>will return a data frame of the form depicted in <xref rid="pone.0225734.t007" ref-type="table">Table 7</xref>.</p>
      <table-wrap id="pone.0225734.t007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t007</object-id>
        <label>Table 7</label>
        <caption>
          <title>Example of a data frame of class-level metrics for a spatiotemporal analysis computed with custom <monospace>classes</monospace>, <monospace>metrics</monospace> and <monospace>metrics_kws</monospace> keyword arguments.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t007g" xlink:href="pone.0225734.t007"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="right" rowspan="1" colspan="1">dates</th>
                <th align="center" rowspan="1" colspan="1">edge_density</th>
                <th align="center" rowspan="1" colspan="1">fractal_dimension_am</th>
                <th align="center" rowspan="1" colspan="1">landscape_shape_index</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="3" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">2000</td>
                <td align="char" char="." rowspan="1" colspan="1">4.503</td>
                <td align="char" char="." rowspan="1" colspan="1">1.12956</td>
                <td align="char" char="." rowspan="1" colspan="1">22.9492</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0770194</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2006</td>
                <td align="char" char="." rowspan="1" colspan="1">4.51608</td>
                <td align="char" char="." rowspan="1" colspan="1">1.12336</td>
                <td align="char" char="." rowspan="1" colspan="1">23.0892</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0766145</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2012</td>
                <td align="char" char="." rowspan="1" colspan="1">4.54847</td>
                <td align="char" char="." rowspan="1" colspan="1">1.12347</td>
                <td align="char" char="." rowspan="1" colspan="1">23.181</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0771346</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Note that although provided within the <monospace>metrics</monospace> keyword argument, the Shannon’s diversity index does not appear in the data frame of <xref rid="pone.0225734.t007" ref-type="table">Table 7</xref> since it can only be computed at the landscape level. Analogously, the proportion of landscape would not appear in the data frame of landscape-level metrics.</p>
    </sec>
    <sec id="sec008">
      <title>Plotting the evolution of metrics</title>
      <p>One of the most important features of the <monospace>SpatioTemporalAnalysis</monospace> class is plotting the evolution of the metrics. To that end, the class features the <monospace>plot_metric</monospace> method, which takes the snake case label of the respective metric name as first argument, e.g., for proportion of landscape, the argument becomes <monospace>’proportion_of_landscape’</monospace> (see <xref ref-type="supplementary-material" rid="pone.0225734.s002">S1 Table</xref> for the list of metrics implemented in PyLandStats and their respective snake case labels). In order to plot the evolution of a metric at the class level, the value of the LULC class must be passed to the <monospace>class_val</monospace> keyword argument as in:</p>
      <p specific-use="line"># a class value of 1 represents “urban” LULC in this example</p>
      <p specific-use="line">&gt; sta.plot_metric(‘<italic>proportion_of_landscape</italic>’, class_val = 1)</p>
      <p>which will produce a plot for the metric at the class level as depicted in <xref ref-type="fig" rid="pone.0225734.g001">Fig 1</xref>.</p>
      <fig id="pone.0225734.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Example of a plot for a class-level metric in a spatiotemporal analysis.</title>
        </caption>
        <graphic xlink:href="pone.0225734.g001"/>
      </fig>
      <p>If the <monospace>class_val</monospace> keyword argument is ommited, the metric will instead be plotted at the landscape level. For instance, the following snippet will plot both the class and landscape-level area-weighted fractal dimension in the same matplotlib axis:</p>
      <p specific-use="line">&gt; ax = sta.plot_metric(‘<italic>fractal_dimension_am</italic>’, class_val = 1,</p>
      <p specific-use="line">         plot_kws={‘<italic>label</italic>’: ‘<italic>class level</italic> (<italic>urban</italic>)’})</p>
      <p specific-use="line">&gt; sta.plot metric(</p>
      <p specific-use="line">  ‘<italic>fractal_dimension_am</italic>’, ax = ax, plot_kws={‘<italic>label</italic>’: ‘<italic>landscape level</italic>’})</p>
      <p specific-use="line">&gt; ax.legend()</p>
      <p>producing a plot as depicted in <xref ref-type="fig" rid="pone.0225734.g002">Fig 2</xref>.</p>
      <fig id="pone.0225734.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Example with a metric plotted at both the class and landscape level in a spatiotemporal analysis.</title>
        </caption>
        <graphic xlink:href="pone.0225734.g002"/>
      </fig>
      <p>In order to customize the resulting plot, the <monospace>plot_metric</monospace> method accepts, among other keyword arguments, a <monospace>plt_kws</monospace> keyword argument that will be forwarded to the matplotlib’s plot method (see the chapter 2 “Spatiotemporal analysis” of <xref ref-type="supplementary-material" rid="pone.0225734.s001">S1 Text</xref>).</p>
    </sec>
  </sec>
  <sec id="sec009">
    <title>Zonal analysis</title>
    <p>Landscape metrics are very sensitive to scale, that is, to the pixel resolution and especially to the spatial extent of the considered map [<xref rid="pone.0225734.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0225734.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0225734.ref013" ref-type="bibr">13</xref>]. To overcome such shortcoming, landscape ecologists often turn to methods of multiscale analysis which explicitly consider multiple scales, both in terms of resolution and map extents [<xref rid="pone.0225734.ref014" ref-type="bibr">14</xref>].</p>
    <p>The PyLandStats library features two classes that might be used for such purpose. The first is <monospace>BufferAnalysis</monospace>, which segments a given landscape based on a series of buffers of increasing distances around a feature of interest, whereas the more generic <monospace>ZonalAnalysis</monospace> allows the user to freely choose how the landscape is segmented by providing a list of NumPy masks.</p>
    <sec id="sec010">
      <title>Buffer analysis around a feature of interest</title>
      <p>In line with the classic concentric models of location and land use, evaluating the spatial variation of the environmental characteristics across the urban-rural gradient has become one of the central topics of landscape ecology [<xref rid="pone.0225734.ref015" ref-type="bibr">15</xref>].</p>
      <p>Consider a LULC raster file featuring a city and its rural hinterlands. Then, given a coordinate that represents the center of the feature of interest (e.g., a Shapely point with its coordinate reference system) and a list of buffer distances (in meters), a <monospace>BufferAnalysis</monospace> can be instantiated as follows:</p>
      <p specific-use="line">&gt; from shapely.geometry import Point</p>
      <p specific-use="line"># latitude and longitude of the center of Lausanne in the OpenStreetMap</p>
      <p specific-use="line">&gt; base_mask = Point(6.6327025, 46.5218269)</p>
      <p specific-use="line">&gt; base_mask_crs = ‘<italic>+proj = longlat +ellps = WGS84 +datum = WGS84 +no defs</italic>’</p>
      <p specific-use="line"># buffer distances (in meters)</p>
      <p specific-use="line">&gt; buffer_dists = [10000, 15000, 20000]</p>
      <p specific-use="line"># instantiation of ‘BufferAnalysis’</p>
      <p specific-use="line">&gt; ba = pls.BufferAnalysis(</p>
      <p specific-use="line">  path_to_raster, base_mask, buffer_dists, base_mask_crs = base_mask_crs)</p>
      <p>where the <monospace>BufferAnalysis</monospace> instance will generate the landscape of interest for each buffer distance by masking the pixels of the input raster, as illustrated in <xref ref-type="fig" rid="pone.0225734.g003">Fig 3</xref>.</p>
      <fig id="pone.0225734.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Landscapes generated by instantiating a <monospace>BufferAnalysis</monospace> with a raster of urban and non-urban LULC classes (values of 1 and 2 respectively), the coordinates of the city center as base mask, and buffer distances of 10000, 15000 and 20000m (corresponding to the three subplots from left to right).</title>
        </caption>
        <graphic xlink:href="pone.0225734.g003"/>
      </fig>
      <p>On the other hand, the <monospace>base_mask</monospace> argument might also be a polygon geometry (e.g., administrative boundaries) instead of a point. In such case, note that the list of buffer distances might start from zero in order to start computing the metrics for the region defined by the polygon geometry itself.</p>
      <p>Like in the other classes, the data frames of class and landscape-level metrics can be obtained through the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods respectively. For instance, the following snippet:</p>
      <p specific-use="line">&gt; ba.compute_class_metrics_df()</p>
      <p>will return a data frame indexed by both the class value and buffer distance, as depicted in <xref rid="pone.0225734.t008" ref-type="table">Table 8</xref>.</p>
      <table-wrap id="pone.0225734.t008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t008</object-id>
        <label>Table 8</label>
        <caption>
          <title>Example data frame of class-level metrics for a buffer analysis.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t008g" xlink:href="pone.0225734.t008"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="right" rowspan="1" colspan="1">buffer_dist</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="3" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">10000</td>
                <td align="center" rowspan="1" colspan="1">7261</td>
                <td align="char" char="." rowspan="1" colspan="1">24.9648</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="char" char="." rowspan="1" colspan="1">0.068764</td>
                <td align="char" char="." rowspan="1" colspan="1">21.5472</td>
                <td align="center" rowspan="1" colspan="1">223900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">15000</td>
                <td align="center" rowspan="1" colspan="1">9630</td>
                <td align="char" char="." rowspan="1" colspan="1">16.7106</td>
                <td align="center" rowspan="1" colspan="1">46</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0798223</td>
                <td align="char" char="." rowspan="1" colspan="1">11.5326</td>
                <td align="center" rowspan="1" colspan="1">395200</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">20000</td>
                <td align="center" rowspan="1" colspan="1">12149</td>
                <td align="char" char="." rowspan="1" colspan="1">13.3476</td>
                <td align="center" rowspan="1" colspan="1">76</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0834981</td>
                <td align="char" char="." rowspan="1" colspan="1">7.30169</td>
                <td align="center" rowspan="1" colspan="1">565200</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="3" colspan="1">2</td>
                <td align="right" rowspan="1" colspan="1">10000</td>
                <td align="center" rowspan="1" colspan="1">21824</td>
                <td align="char" char="." rowspan="1" colspan="1">75.0352</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0137528</td>
                <td align="char" char="." rowspan="1" colspan="1">74.3614</td>
                <td align="center" rowspan="1" colspan="1">223900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">15000</td>
                <td align="center" rowspan="1" colspan="1">47998</td>
                <td align="char" char="." rowspan="1" colspan="1">83.2894</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.00694107</td>
                <td align="char" char="." rowspan="1" colspan="1">82.9493</td>
                <td align="center" rowspan="1" colspan="1">395200</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">20000</td>
                <td align="center" rowspan="1" colspan="1">78871</td>
                <td align="char" char="." rowspan="1" colspan="1">86.6524</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0054933</td>
                <td align="char" char="." rowspan="1" colspan="1">86.3151</td>
                <td align="center" rowspan="1" colspan="1">565200</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Again, the metrics that are considered in the analysis and how they metrics are computed can be customized by providing the <monospace>metrics</monospace> and <monospace>metrics_kws</monospace> keyword arguments respectively to the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods, while the considered classes can be set as the <monospace>classes</monospace> keyword argument of <monospace>compute_class_metrics_df</monospace>.</p>
      <p>On the other hand, and analogously to the <monospace>SpatioTemporalAnalysis</monospace> class, the metrics computed for each buffer distance in a <monospace>BufferAnalysis</monospace> instance can be plotted by means of the <monospace>plot_metric</monospace> method. Again, <monospace>plot_metric</monospace> takes an optional <monospace>class_val</monospace> keyword argument that if provided, plots the metric at the class level, and otherwise, plots the metric at the landscape level. For instance, the following snippet:</p>
      <p specific-use="line">&gt; ba.plot_metric(‘<italic>proportion_of_landscape</italic>’, class_val = 1)</p>
      <p>will produce a plot for the metric at the class level as depicted in <xref ref-type="fig" rid="pone.0225734.g004">Fig 4</xref>.</p>
      <fig id="pone.0225734.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Example of a plot for a class-level metric in a buffer analysis.</title>
          <p>The x axis corresponds to the buffer distances.</p>
        </caption>
        <graphic xlink:href="pone.0225734.g004"/>
      </fig>
      <p>Another approach to examine how landscape patterns change across the urban-rural gradient is to compute the metrics for each buffer ring that defined between each pair of distances. For instance, for the buffer distances considered in latter example, i.e., 10000, 15000 and 20000, the metrics would be computed for the buffer rings that go from 0 to 10000 m, 10000-15000 m and 15000-20000 m. Such analysis can be performed in PyLandStats by setting the keyword argument <monospace>buffer_rings</monospace> to <monospace>True</monospace>, as in the snippet below:</p>
      <p specific-use="line">&gt; ba = pls.BufferAnalysis(</p>
      <p specific-use="line">  input_filepath, base_mask, buffer_dists, base_mask_crs = base_mask_crs,</p>
      <p specific-use="line">  buffer_rings = True)</p>
      <p>where <monospace>BufferAnalysis</monospace> will generate the landscapes as depicted in <xref ref-type="fig" rid="pone.0225734.g005">Fig 5</xref>.</p>
      <fig id="pone.0225734.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Landscapes generated by instantiating a <monospace>BufferAnalysis</monospace> with a raster of urban and non-urban LULC classes (values of 1 and 2 respectively), the coordinates of the city center as base mask, and buffer distances of 10000, 15000 and 20000m (corresponding to the three subplots from left to right) and <monospace>buffer_rings</monospace> set to <monospace>True</monospace>.</title>
        </caption>
        <graphic xlink:href="pone.0225734.g005"/>
      </fig>
      <p>Under such circumstances, the buffer distance of each in the data frame of class and landscape-level metrics will be strings that represent the buffer distances that correspond to the start and end of each ring, as depicted in <xref rid="pone.0225734.t009" ref-type="table">Table 9</xref>.</p>
      <table-wrap id="pone.0225734.t009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t009</object-id>
        <label>Table 9</label>
        <caption>
          <title>Example data frame of class-level metrics for a buffer analysis computing the metrics for the buffer rings.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t009g" xlink:href="pone.0225734.t009"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="right" rowspan="1" colspan="1">buffer_dist</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="3" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">0-10000</td>
                <td align="center" rowspan="1" colspan="1">7261</td>
                <td align="char" char="." rowspan="1" colspan="1">24.9648</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="char" char="." rowspan="1" colspan="1">0.068764</td>
                <td align="char" char="." rowspan="1" colspan="1">21.5472</td>
                <td align="center" rowspan="1" colspan="1">223900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">10000-15000</td>
                <td align="center" rowspan="1" colspan="1">2369</td>
                <td align="char" char="." rowspan="1" colspan="1">8.29976</td>
                <td align="center" rowspan="1" colspan="1">37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.129629</td>
                <td align="char" char="." rowspan="1" colspan="1">1.68518</td>
                <td align="center" rowspan="1" colspan="1">168600</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">15000-20000</td>
                <td align="center" rowspan="1" colspan="1">2519</td>
                <td align="char" char="." rowspan="1" colspan="1">7.54372</td>
                <td align="center" rowspan="1" colspan="1">37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.110805</td>
                <td align="char" char="." rowspan="1" colspan="1">3.11152</td>
                <td align="center" rowspan="1" colspan="1">169100</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="3" colspan="1">2</td>
                <td align="right" rowspan="1" colspan="1">0-10000</td>
                <td align="center" rowspan="1" colspan="1">21824</td>
                <td align="char" char="." rowspan="1" colspan="1">75.0352</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0137528</td>
                <td align="char" char="." rowspan="1" colspan="1">74.3614</td>
                <td align="center" rowspan="1" colspan="1">223900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">10000-15000</td>
                <td align="center" rowspan="1" colspan="1">26174</td>
                <td align="char" char="." rowspan="1" colspan="1">91.7002</td>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0105105</td>
                <td align="char" char="." rowspan="1" colspan="1">83.6282</td>
                <td align="center" rowspan="1" colspan="1">168600</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">15000-20000</td>
                <td align="center" rowspan="1" colspan="1">30873</td>
                <td align="char" char="." rowspan="1" colspan="1">92.4563</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0239578</td>
                <td align="char" char="." rowspan="1" colspan="1">76.117</td>
                <td align="center" rowspan="1" colspan="1">169100</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Accordingly, the <monospace>plot_metric</monospace> method of a <monospace>BufferAnalysis</monospace> will produce a figure as depicted in <xref ref-type="fig" rid="pone.0225734.g006">Fig 6</xref>, where the x axis represents the buffer distances of the rings.</p>
      <fig id="pone.0225734.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Example of a plot for a class-level metric in a buffer analysis that computes the metrics for the buffer rings.</title>
          <p>The x axis delineates three discrete points, each corresponding to a buffer ring, and whose label represents the ring’s start and end buffer distance.</p>
        </caption>
        <graphic xlink:href="pone.0225734.g006"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Generic zonal analysis</title>
      <p>In certain analysis cases, the user might consider more appropriate to compute the metrics along a decomoposition of the landscape different than concentric buffers, for example, rectangular transects. To that end, PyLandStats features the <monospace>ZonalAnalysis</monospace> class, which instead of a base mask, accepts a list of boolean arrays of the same shape of our landscape as masks to define our transects (or any other type of subregion). Consider the code snippet below:</p>
      <p specific-use="line"># this reads the input raster landscape and creates a boolean base mask</p>
      <p specific-use="line"># of the same shape of the landscape and filled with ‘False’ values</p>
      <p specific-use="line">with rasterio.open(input_filepath) as src:</p>
      <p specific-use="line">  base_mask_arr = np.full(src.shape, False)</p>
      <p specific-use="line">masks_arr = []</p>
      <p specific-use="line"># for a pixel resolution of 100m, this corresponds to transects of 30km</p>
      <p specific-use="line">transect_len = 300</p>
      <p specific-use="line"># this will iterate over three transects (0-30km, 30-60km, 60-90km)</p>
      <p specific-use="line">for transect_start in range(0, 900, transect_len):</p>
      <p specific-use="line">  mask_arr = np.copy(base_mask_arr)</p>
      <p specific-use="line">  <italic># the 400 and 600 serve to slice the landscape vertically along the</italic></p>
      <p specific-use="line">  <italic># 20km where the feature of interest is located</italic></p>
      <p specific-use="line">  mask_arr[400:600,transect_start:transect_start+transect_len] = True</p>
      <p specific-use="line">  masks_arr.append(mask_arr)</p>
      <p>where the variable <monospace>masks_arr</monospace> will be a list of three NumPy boolean arrays, each corresponding to a distinct rectangular transect, as plotted in <xref ref-type="fig" rid="pone.0225734.g007">Fig 7</xref>.</p>
      <fig id="pone.0225734.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Example of a list of three boolean mask arrays that delineate three rectangular transects of a landscape.</title>
        </caption>
        <graphic xlink:href="pone.0225734.g007"/>
      </fig>
      <p>The instantiation of <monospace>ZonalAnalysis</monospace> requires the list of mask arrays (e.g., the <monospace>masks_arr</monospace> variable created above) as second argument. Additionally, the keyword argument <monospace>attribute_values</monospace> might be used to map an identifying value or label to each of our landscapes. In this example, a list of strings will be provided in a form which denotes that each landscape corresponds to the transect from kilometers 0 to 30, 30 to 60 and 60 to 90 respectively:</p>
      <p specific-use="line">&gt; attribute_values = [‘<italic>0-30</italic>’, ‘<italic>30-60</italic>’, ‘<italic>60-90</italic>’]</p>
      <p specific-use="line">&gt; za = pls.ZonalAnalysis(</p>
      <p specific-use="line">  input_filepath, masks_arr, attribute_values = attribute_values)</p>
      <p>where <monospace>ZonalAnalysis</monospace> will generate the landscapes as depicted in <xref ref-type="fig" rid="pone.0225734.g008">Fig 8</xref>.</p>
      <fig id="pone.0225734.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Landscapes generated by instantiating a <monospace>ZonalAnalysis</monospace> for three rectangular transects.</title>
        </caption>
        <graphic xlink:href="pone.0225734.g008"/>
      </fig>
      <p>In <monospace>ZonalAnalysis</monospace> instances, the data frames of metrics are indexed by the values provided to the keyword argument <monospace>attribute_values</monospace> as depicted in <xref rid="pone.0225734.t010" ref-type="table">Table 10</xref>.</p>
      <table-wrap id="pone.0225734.t010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t010</object-id>
        <label>Table 10</label>
        <caption>
          <title>Example data frame of class-level metrics in a zonal analysis of three transects.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t010g" xlink:href="pone.0225734.t010"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">class_val</th>
                <th align="right" rowspan="1" colspan="1">attribute_values</th>
                <th align="center" rowspan="1" colspan="1">total_area</th>
                <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
                <th align="center" rowspan="1" colspan="1">number_of_patches</th>
                <th align="center" rowspan="1" colspan="1">patch_density</th>
                <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
                <th align="center" rowspan="1" colspan="1">total_edge</th>
                <th align="center" rowspan="1" colspan="1">…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="3" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">0-30</td>
                <td align="center" rowspan="1" colspan="1">2641</td>
                <td align="char" char="." rowspan="1" colspan="1">5.0768</td>
                <td align="center" rowspan="1" colspan="1">37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0711251</td>
                <td align="char" char="." rowspan="1" colspan="1">0.707407</td>
                <td align="center" rowspan="1" colspan="1">216700</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">30-60</td>
                <td align="center" rowspan="1" colspan="1">9577</td>
                <td align="char" char="." rowspan="1" colspan="1">17.6965</td>
                <td align="center" rowspan="1" colspan="1">40</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0739126</td>
                <td align="char" char="." rowspan="1" colspan="1">12.2806</td>
                <td align="center" rowspan="1" colspan="1">370500</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">60-90</td>
                <td align="center" rowspan="1" colspan="1">1761</td>
                <td align="char" char="." rowspan="1" colspan="1">9.27281</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0473909</td>
                <td align="char" char="." rowspan="1" colspan="1">6.90854</td>
                <td align="center" rowspan="1" colspan="1">71900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="3" colspan="1">2</td>
                <td align="right" rowspan="1" colspan="1">0-30</td>
                <td align="center" rowspan="1" colspan="1">49380</td>
                <td align="char" char="." rowspan="1" colspan="1">94.9232</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0038446</td>
                <td align="char" char="." rowspan="1" colspan="1">94.9194</td>
                <td align="center" rowspan="1" colspan="1">216700</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">30-60</td>
                <td align="center" rowspan="1" colspan="1">44541</td>
                <td align="char" char="." rowspan="1" colspan="1">82.3035</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0110869</td>
                <td align="char" char="." rowspan="1" colspan="1">81.8859</td>
                <td align="center" rowspan="1" colspan="1">370500</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">60-90</td>
                <td align="center" rowspan="1" colspan="1">17230</td>
                <td align="char" char="." rowspan="1" colspan="1">90.7272</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0315939</td>
                <td align="char" char="." rowspan="1" colspan="1">53.2199</td>
                <td align="center" rowspan="1" colspan="1">71900</td>
                <td align="center" rowspan="1" colspan="1">…</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Again, the data frames of metrics <monospace>ZonalAnalysis</monospace> can also customized by providing the <monospace>metrics</monospace> and <monospace>metrics_kws</monospace> keyword arguments to the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods, and additionally by the <monospace>classes</monospace> keyword argument in <monospace>compute_class_metrics_df</monospace>.</p>
      <p>In order to plot a metric’s computed value for each subregion, the class <monospace>ZonalAnalysis</monospace> features a <monospace>plot_metric</monospace> method which works in the same way as its counterpart in <monospace>SpatioTemporalAnalysis</monospace> and <monospace>BufferAnalysis</monospace>. For instance, the following snippet:</p>
      <p specific-use="line">&gt; za.plot_metric(‘<italic>proportion_of_landscape</italic>’, class_val = 1)</p>
      <p>will produce a plot for the metric at the class level as depicted in <xref ref-type="fig" rid="pone.0225734.g009">Fig 9</xref>.</p>
      <fig id="pone.0225734.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Example of a plot for a class-level metric in a zonal analysis of three transects.</title>
          <p>The x axis corresponds to the values provided to the keyword argument <monospace>attribute_values</monospace> provided to the initialization of <monospace>ZonalAnalysis</monospace>.</p>
        </caption>
        <graphic xlink:href="pone.0225734.g009"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec012">
    <title>Spatiotemporal buffer analysis</title>
    <p>The zonal analysis methods presented above are themselves multiscale analysis approaches since they explicitly consider multiple map extents. Accordingly, the <monospace>BufferAnalysis</monospace> and <monospace>ZonalAnalysis</monospace> classes might be employed to obtain scalograms, namely, response curves of the metrics to changing the map extent [<xref rid="pone.0225734.ref016" ref-type="bibr">16</xref>].</p>
    <p>Nevertheless, when performing spatiotemporal analyses, it might also be useful to evaluate how the computed time series of metrics responds to changes in the map extent. To that end, PyLandStats features an additional <monospace>SpatioTemporalBufferAnalysis</monospace> class, which is instantiated like a <monospace>BufferAnalysis</monospace> except that the first argument is a temporally-ordered list of landscape raster snapshots—like in the <monospace>SpatioTemporalAnalysis</monospace> class—instead of a single raster landscape. In addition, like the <monospace>SpatioTemporalAnalysis</monospace> class, a list with the dates that correspond to each of the landscape snapshots can be passed to the keyword argument <monospace>dates</monospace>. Putting it all together, <monospace>SpatioTemporalBufferAnalysis</monospace> can be instantiated as in:</p>
    <p specific-use="line"># Note: ‘input_filepaths’ is a list (like in ‘SpatioTemporalAnalysis’)</p>
    <p specific-use="line">&gt; stba = pls.SpatioTemporalBufferAnalysis(</p>
    <p specific-use="line">  input_filepaths, base_mask, buffer_dists,</p>
    <p specific-use="line">  base_mask_crs = base_mask_crs, dates = [2000, 2006, 2012])</p>
    <p>Like <monospace>BufferAnalysis</monospace>, a <monospace>SpatioTemporalBufferAnalysis</monospace> can also be instantiated from a polygon geometry. The data frame of class and landscape-level metrics can be computed by means of the the <monospace>compute_class_metrics_df</monospace> and <monospace>compute_landscape_metrics_df</monospace> methods respectively, which again, might also be customized by providing the <monospace>metrics</monospace> and <monospace>metrics_kws</monospace> keyword arguments, and additionally by the <monospace>classes</monospace> keyword argument in <monospace>compute_class_metrics_df</monospace>. In <monospace>SpatioTemporalBufferAnalysis</monospace> instances, the data frames are indexed by the buffer distances and the snapshot dates (and also by the LULC class values in the class-level data frame, as depicted in <xref rid="pone.0225734.t011" ref-type="table">Table 11</xref>).</p>
    <table-wrap id="pone.0225734.t011" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t011</object-id>
      <label>Table 11</label>
      <caption>
        <title>Example data frame of class-level metrics in a spatiotemporal buffer analysis.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0225734.t011g" xlink:href="pone.0225734.t011"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="right" rowspan="1" colspan="1">buffer_dist</th>
              <th align="right" rowspan="1" colspan="1">class_val</th>
              <th align="right" rowspan="1" colspan="1">dates</th>
              <th align="center" rowspan="1" colspan="1">total_area</th>
              <th align="center" rowspan="1" colspan="1">proportion_of_landscape</th>
              <th align="center" rowspan="1" colspan="1">number_of_patches</th>
              <th align="center" rowspan="1" colspan="1">patch_density</th>
              <th align="center" rowspan="1" colspan="1">largest_patch_index</th>
              <th align="center" rowspan="1" colspan="1">total_edge</th>
              <th align="center" rowspan="1" colspan="1">…</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right" rowspan="6" colspan="1">10000</td>
              <td align="right" rowspan="3" colspan="1">1</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">7261</td>
              <td align="char" char="." rowspan="1" colspan="1">24.9648</td>
              <td align="center" rowspan="1" colspan="1">20</td>
              <td align="char" char="." rowspan="1" colspan="1">0.068764</td>
              <td align="char" char="." rowspan="1" colspan="1">21.5472</td>
              <td align="center" rowspan="1" colspan="1">223900</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">7205</td>
              <td align="char" char="." rowspan="1" colspan="1">24.7722</td>
              <td align="center" rowspan="1" colspan="1">20</td>
              <td align="char" char="." rowspan="1" colspan="1">0.068764</td>
              <td align="char" char="." rowspan="1" colspan="1">21.0211</td>
              <td align="center" rowspan="1" colspan="1">226600</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">7205</td>
              <td align="char" char="." rowspan="1" colspan="1">24.7722</td>
              <td align="center" rowspan="1" colspan="1">20</td>
              <td align="char" char="." rowspan="1" colspan="1">0.068764</td>
              <td align="char" char="." rowspan="1" colspan="1">21.0211</td>
              <td align="center" rowspan="1" colspan="1">227000</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="3" colspan="1">2</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">21824</td>
              <td align="char" char="." rowspan="1" colspan="1">75.0352</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0137528</td>
              <td align="char" char="." rowspan="1" colspan="1">74.3614</td>
              <td align="center" rowspan="1" colspan="1">223900</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">21880</td>
              <td align="char" char="." rowspan="1" colspan="1">75.2278</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0137528</td>
              <td align="char" char="." rowspan="1" colspan="1">74.5539</td>
              <td align="center" rowspan="1" colspan="1">226600</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">21880</td>
              <td align="char" char="." rowspan="1" colspan="1">75.2278</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0137528</td>
              <td align="char" char="." rowspan="1" colspan="1">74.5539</td>
              <td align="center" rowspan="1" colspan="1">227000</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="6" colspan="1">15000</td>
              <td align="right" rowspan="3" colspan="1">1</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">9630</td>
              <td align="char" char="." rowspan="1" colspan="1">16.7106</td>
              <td align="center" rowspan="1" colspan="1">46</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0798223</td>
              <td align="char" char="." rowspan="1" colspan="1">11.5326</td>
              <td align="center" rowspan="1" colspan="1">395200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">9278</td>
              <td align="char" char="." rowspan="1" colspan="1">16.0998</td>
              <td align="center" rowspan="1" colspan="1">49</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0850281</td>
              <td align="char" char="." rowspan="1" colspan="1">11.2671</td>
              <td align="center" rowspan="1" colspan="1">391300</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">9320</td>
              <td align="char" char="." rowspan="1" colspan="1">16.1727</td>
              <td align="center" rowspan="1" colspan="1">50</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0867634</td>
              <td align="char" char="." rowspan="1" colspan="1">11.2671</td>
              <td align="center" rowspan="1" colspan="1">395500</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="3" colspan="1">2</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">47998</td>
              <td align="char" char="." rowspan="1" colspan="1">83.2894</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.00694107</td>
              <td align="char" char="." rowspan="1" colspan="1">82.9493</td>
              <td align="center" rowspan="1" colspan="1">395200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">48350</td>
              <td align="char" char="." rowspan="1" colspan="1">83.9002</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.00694107</td>
              <td align="char" char="." rowspan="1" colspan="1">83.5601</td>
              <td align="center" rowspan="1" colspan="1">391300</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">48308</td>
              <td align="char" char="." rowspan="1" colspan="1">83.8273</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="char" char="." rowspan="1" colspan="1">0.00694107</td>
              <td align="char" char="." rowspan="1" colspan="1">83.4872</td>
              <td align="center" rowspan="1" colspan="1">395500</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="6" colspan="1">20000</td>
              <td align="right" rowspan="3" colspan="1">1</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">12149</td>
              <td align="char" char="." rowspan="1" colspan="1">13.3476</td>
              <td align="center" rowspan="1" colspan="1">76</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0834981</td>
              <td align="char" char="." rowspan="1" colspan="1">7.30169</td>
              <td align="center" rowspan="1" colspan="1">565200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">11827</td>
              <td align="char" char="." rowspan="1" colspan="1">12.9938</td>
              <td align="center" rowspan="1" colspan="1">78</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0856955</td>
              <td align="char" char="." rowspan="1" colspan="1">7.1336</td>
              <td align="center" rowspan="1" colspan="1">566200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">11882</td>
              <td align="char" char="." rowspan="1" colspan="1">13.0543</td>
              <td align="center" rowspan="1" colspan="1">79</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0867941</td>
              <td align="char" char="." rowspan="1" colspan="1">7.1336</td>
              <td align="center" rowspan="1" colspan="1">571400</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="3" colspan="1">2</td>
              <td align="right" rowspan="1" colspan="1">2000</td>
              <td align="center" rowspan="1" colspan="1">78871</td>
              <td align="char" char="." rowspan="1" colspan="1">86.6524</td>
              <td align="center" rowspan="1" colspan="1">5</td>
              <td align="char" char="." rowspan="1" colspan="1">0.0054933</td>
              <td align="char" char="." rowspan="1" colspan="1">86.3151</td>
              <td align="center" rowspan="1" colspan="1">565200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2006</td>
              <td align="center" rowspan="1" colspan="1">79193</td>
              <td align="char" char="." rowspan="1" colspan="1">87.0062</td>
              <td align="center" rowspan="1" colspan="1">6</td>
              <td align="char" char="." rowspan="1" colspan="1">0.00659196</td>
              <td align="char" char="." rowspan="1" colspan="1">86.6678</td>
              <td align="center" rowspan="1" colspan="1">566200</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
            <tr>
              <td align="right" rowspan="1" colspan="1">2012</td>
              <td align="center" rowspan="1" colspan="1">79138</td>
              <td align="char" char="." rowspan="1" colspan="1">86.9457</td>
              <td align="center" rowspan="1" colspan="1">7</td>
              <td align="char" char="." rowspan="1" colspan="1">0.00769062</td>
              <td align="char" char="." rowspan="1" colspan="1">86.604</td>
              <td align="center" rowspan="1" colspan="1">571400</td>
              <td align="center" rowspan="1" colspan="1">…</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>The <monospace>SpatioTemporalBufferAnalysis</monospace> class features a <monospace>plot_metric</monospace> method with the same signature of its counterparts in <monospace>SpatioTemporalAnalysis</monospace>, <monospace>BufferAnalysis</monospace> and <monospace>ZonalAnalysis</monospace>. For example, the snippet below:</p>
    <p specific-use="line">&gt; stba.plot_metric(‘<italic>fractal_dimension_am</italic>’)</p>
    <p>will plot the temporal evolution of the area-weighted fractal dimension at the landscape level for the three buffer distances in the same axis, producing an output as depicted in <xref ref-type="fig" rid="pone.0225734.g010">Fig 10</xref>.</p>
    <fig id="pone.0225734.g010" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0225734.g010</object-id>
      <label>Fig 10</label>
      <caption>
        <title>Example of a plot for a landscape-level metric in a spatiotemporal buffer analysis.</title>
      </caption>
      <graphic xlink:href="pone.0225734.g010"/>
    </fig>
    <p>Although this is beyond the scope of this article, the above plot suggests that the area-weighted fractal dimension shows a predictable response to changing the spatial extent of the considered landscape [<xref rid="pone.0225734.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0225734.ref017" ref-type="bibr">17</xref>].</p>
  </sec>
  <sec id="sec013">
    <title>The PyLandStats library</title>
    <sec id="sec014">
      <title>Availability and installation</title>
      <p>The source code of PyLandStats is available in a GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats">https://github.com/martibosch/pylandstats</ext-link>, and is licensed under the open source GNU General Public License 3 (GNU GPLv3) to ensure that any derivative work is kept as open source. The easiest way to install PyLandStats is by installing the dedicated conda recipe hosted on the conda-forge channel at <ext-link ext-link-type="uri" xlink:href="https://anaconda.org/conda-forge/pylandstats">https://anaconda.org/conda-forge/pylandstats</ext-link>, as in:</p>
      <p specific-use="line">$ conda install -c conda-forge pylandstats</p>
      <p>The above command will install all the necessary requirements to run all the features of PyLandStats. Alternatively, a dedicated Python package is hosted on the Python Package Index (PyPI) at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/pylandstats/">https://pypi.org/project/pylandstats/</ext-link>, and can be readily installed with <monospace>pip</monospace> as in:</p>
      <p specific-use="line">$ pip install pylandstats</p>
      <p>Nevertheless, the <monospace>BufferAnalysis</monospace> and <monospace>SpatioTemporalBufferAnalysis</monospace> classes have dependencies that cannot be installed with <monospace>pip</monospace>, namely the Geospatial Data Abstraction Library (GDAL) and the Geometry Engine Open Source (GEOS). In order to use these two PyLandStats classes, GDAL and GEOS must be present at the time of installing PyLandStats, which in this case will further require specifying the <monospace>geo</monospace> extra requirements as in:</p>
      <p specific-use="line">$ pip install pylandstats[geo]</p>
      <p>Unit tests are run within the Travis Continuous Integration (Travis CI) platform at <ext-link ext-link-type="uri" xlink:href="https://travis-ci.org/martibosch/pylandstats">https://travis-ci.org/martibosch/pylandstats</ext-link> every time that new commits ar pushed to the GitHub repository. Additionally, test coverage is reported on Coveralls at <ext-link ext-link-type="uri" xlink:href="https://coveralls.io/github/martibosch/pylandstats?branch=master">https://coveralls.io/github/martibosch/pylandstats?branch=master</ext-link>.</p>
      <p>The documentation of PyLandStats is hosted in Read the Docs at <ext-link ext-link-type="uri" xlink:href="https://pylandstats.readthedocs.io/">https://pylandstats.readthedocs.io/</ext-link> and is also available in <xref ref-type="supplementary-material" rid="pone.0225734.s001">S1 Text</xref>. Additionally, a collection of example notebooks with a thorough overview of PyLandStats’s features is provided at a dedicated GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats-notebooks">https://github.com/martibosch/pylandstats-notebooks</ext-link>, which can be executed interactively online by means of the Binder web service [<xref rid="pone.0225734.ref018" ref-type="bibr">18</xref>]. Such repository includes unit tests which ensure the correctness of the computations (see <xref ref-type="supplementary-material" rid="pone.0225734.s007">S5 Code</xref>).</p>
      <p>Finally, an example application of PyLandStats in an academic article can be found in the analysis of the spatiotemporal patterns of urbanization of three Swiss urban agglomerations by Bosch and Chenal [<xref rid="pone.0225734.ref019" ref-type="bibr">19</xref>], and all the code and materials necessary to reproduce the results are available in a dedicated GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/swiss-urbanization">https://github.com/martibosch/swiss-urbanization</ext-link>.</p>
    </sec>
    <sec id="sec015">
      <title>Dependencies and implementation details</title>
      <p>The PyLandStats package is fully implemented in Python, and requires the Python packages NumPy, SciPy, pandas, matplotlib, rasterio. The first four are among the most popular packages for scientific and data-centric Python and are used for a wide-variety of scientific needs, whereas rasterio is a popular library to read and write geospatial raster data. In PyLandStats, NumPy arrays are used to represent landscapes and patch-level metrics. In addition, NumPy functions are used in the computations of all the implemented landscape metrics. The SciPy library is used to segment the patches in the landscape arrays, compute the inter-patch nearest-neighbor distances, and to compute the coefficient of variation of the patch-level landscape metrics. The pandas data frames are used to build the data frames of landscape metrics, matplotlib is used to produce the plots and rasterio is used to read raster data, plot the landscapes as well as to rasterize the vector geometries used in <monospace>BufferAnalysis</monospace> and <monospace>SpatioTemporalBufferAnalysis</monospace>. As noted above, the foregoing two classes further require the GeoPandas and Shapely Python packages.</p>
      <p>The implementation of PyLandStats is organized in Python modules, where the classes described throughout this paper are defined. Such object-oriented design offers many advantages. On the one hand, it allows both for a conceptual separation and reusability of the functionalities, which enhances the maintainability and extensibility of PyLandStats. On the other hand, Python properties serve to cache results that are computationally expensive to obtain, which can later be accessed in constant (almost immediate) time. This mechanism is exploited to cache intermediate results that are later used to compute the metrics (see <xref ref-type="supplementary-material" rid="pone.0225734.s008">S6 Code</xref>). More precisely, instances of the <monospace>Landscape</monospace> class cache the list of patches, each with its respective LULC class, area, perimeter and nearest-neigbhor distance, as well as the pixel adjacency matrix, i.e., the number of adjacencies between pixels of each landscape class (including adjacencies between pixels of the same class). Furthermore, such mechanism eases the task of implementing new metrics, since the vast majority of landscape metrics found throughout the academic literature can be straight-forwardly computed out of such cached properties (see the section 1.1 “List of implemented metrics” of <xref ref-type="supplementary-material" rid="pone.0225734.s001">S1 Text</xref> as well as [<xref rid="pone.0225734.ref005" ref-type="bibr">5</xref>]). Finally, as follows from the cache mechanism described above, the memory size of a <monospace>Landscape</monospace> instance scales linearly with the number of patches present in the respective raster landscape.</p>
      <p>Regarding the performance, the most expensive operations of PyLandStats are the computation of the adjacency matrix, and more importantly, the computation of the inter-patch nearest-neighbor distances. The code for the former is transformed from Python to C++ by means of the Pythran ahead-of-time compiler [<xref rid="pone.0225734.ref020" ref-type="bibr">20</xref>], which achieves speed-ups of an order of magnitude of three. The code for the latter consists of a slow nested Python loop that iterates over each patch of each class and employs SciPy’s implementation of the K-d tree in Cython [<xref rid="pone.0225734.ref021" ref-type="bibr">21</xref>] in order to find the nearest neigbor of each patch. The computation of the inter-patch nearest-neighbor distances is by far the main performance bottleneck of PyLandStats (see <xref ref-type="supplementary-material" rid="pone.0225734.s008">S6 Code</xref>), and it is therefore recommended that in analysis cases that do not require computing euclidean nearest-neighbor metrics avoid its computation by making use of the <monospace>metrics</monospace> keyword argument as explained above.</p>
    </sec>
    <sec id="sec016">
      <title>Improvements of PyLandStats over existing software packages</title>
      <p>There have been many other freely-available software packages to compute landscape metrics [<xref rid="pone.0225734.ref006" ref-type="bibr">6</xref>] (see <xref rid="pone.0225734.t012" ref-type="table">Table 12</xref>). By far, the most popular one has been FRAGSTATS [<xref rid="pone.0225734.ref022" ref-type="bibr">22</xref>], yet as a stand-alone software, its functions cannot be directly integrated into advanced computational workflows. Furthermore, FRAGSTATS is not open-source software. Recently, the open-source R package landscapemetrics [<xref rid="pone.0225734.ref023" ref-type="bibr">23</xref>] has been developed to overcome such shortcomings by relying on a well-established spatial framework in R. On the other hand, the only available tool to compute landscape metrics in Python is the LecoS package [<xref rid="pone.0225734.ref024" ref-type="bibr">24</xref>], which is designed as a QGIS plugin.</p>
      <table-wrap id="pone.0225734.t012" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0225734.t012</object-id>
        <label>Table 12</label>
        <caption>
          <title>Comparison of FRAGSTATS, landscapemetrics, LecoS and PyLandStats.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0225734.t012g" xlink:href="pone.0225734.t012"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Characteristic</th>
                <th align="center" rowspan="1" colspan="1">FRAGSTATS</th>
                <th align="center" rowspan="1" colspan="1">landscapemetrics</th>
                <th align="center" rowspan="1" colspan="1">LecoS</th>
                <th align="center" rowspan="1" colspan="1">PyLandStats</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">open source</td>
                <td align="center" rowspan="1" colspan="1">no</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">programming language</td>
                <td align="center" rowspan="1" colspan="1">?</td>
                <td align="center" rowspan="1" colspan="1">R</td>
                <td align="center" rowspan="1" colspan="1">Python</td>
                <td align="center" rowspan="1" colspan="1">Python</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">cross-platform compatibility</td>
                <td align="center" rowspan="1" colspan="1">no</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">integration into advanced workflows</td>
                <td align="center" rowspan="1" colspan="1">no</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
                <td align="center" rowspan="1" colspan="1">QGIS only</td>
                <td align="center" rowspan="1" colspan="1">yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Benchmark Vaud [s]</td>
                <td align="center" rowspan="1" colspan="1">0.61</td>
                <td align="center" rowspan="1" colspan="1">14.27</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Benchmark Bern and Valais [s]</td>
                <td align="center" rowspan="1" colspan="1">33.31</td>
                <td align="center" rowspan="1" colspan="1">553.45</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">32.2</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t012fn001">
            <p>The two benchmarks consist in the computation of the 95 metrics implemented in PyLandStats for the landscape snapshots of the canton of Vaud (889x916 pixels of 2 LULC classes) and the cantons of Bern and Valais (1640x1319 pixels of 28 LULC classes) respectively (see <xref ref-type="supplementary-material" rid="pone.0225734.s008">S6 Code</xref> for more details). Both landscapes have been derived from the Corine Land Cover [<xref rid="pone.0225734.ref007" ref-type="bibr">7</xref>] dataset for the year 2000. Note that LecoS has been excluded from the benchmarks since only features 20 landscape metrics.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The computed values for the landscape metrics in PyLandStats are the same as in FRAGSTATS, with a maximum relative difference of 0.1% (see <xref ref-type="supplementary-material" rid="pone.0225734.s007">S5 Code</xref>). Furthermore, the performance of both packages is very similar. Nevertheless, unlike FRAGSTATS, PyLandStats is open source and it is therefore straightfoward for users to contribute to its development on its GitHub repository. On the other hand, PyLandStats is an alternative to landscapemetrics for those users that prefer to write their computational workflows in Python rather than R. Additionally, the cache mechanisms included within PyLandStats lead to significantly better performance and make it more suitable for experimentation in interactive environments such as Jupyter notebooks [<xref rid="pone.0225734.ref025" ref-type="bibr">25</xref>], since it ensures that the marginal cost of subsequent calls to compute a metric are minimal (see <xref ref-type="supplementary-material" rid="pone.0225734.s008">S6 Code</xref>).</p>
      <p>Finally, although LecoS is based on the NumPy and SciPy stack (like PyLandStats), only 20 metrics have been implemented, and its design as a QGIS plugin forces the users to adapt the computational workflows to QGIS. In sharp contrast, PyLandStats is designed as a Python package which can be directly used in Python scripts, Jupyter notebooks and in other Python packages including QGIS plugins.</p>
      <p>In view of the growing popularity of Jupyter notebooks and continuous releases of new Python packages to visualize geospatial data interactively, it is reasonable to expect that geospatial scientists, including landscape ecologists, will increasingly turn to the Jupyter environments for their analyses. From this perspective, PyLandStats intends to offer a Python package that geospatial scientists can use in order to compute landscape metrics, and whose modularity and object-oriented design allows it to evolve and adapt to new developments in the Python and Jupyter ecosystem.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0225734.s001">
      <label>S1 Text</label>
      <caption>
        <title>PyLandStats documentation.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0225734.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s002">
      <label>S1 Table</label>
      <caption>
        <title>Table of metrics implemented in PyLandStats.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0225734.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s003">
      <label>S1 Code</label>
      <caption>
        <title>Landscape analysis with PyLandStats for the canton of Vaud (Switzerland), as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s003.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s004">
      <label>S2 Code</label>
      <caption>
        <title>Spatiotemporal analysis with PyLandStats for the canton of Vaud (Switzerland), as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s004.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s005">
      <label>S3 Code</label>
      <caption>
        <title>Zonal analysis with PyLandStats for the canton of Vaud (Switzerland), as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s005.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s006">
      <label>S4 Code</label>
      <caption>
        <title>Spatiotemporal buffer analysis with PyLandStats for the canton of Vaud (Switzerland), as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s006.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s007">
      <label>S5 Code</label>
      <caption>
        <title>Comparison of the metrics computed in FRAGSTATS v4 and PyLandStats for the canton of Vaud (Switzerland), as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s007.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0225734.s008">
      <label>S6 Code</label>
      <caption>
        <title>Performance notes and benchmarks comparing FRAGSTATS v4, landscapemetrics and PyLandStats, as Jupyter notebook.</title>
        <p>(IPYNB)</p>
      </caption>
      <media xlink:href="pone.0225734.s008.ipynb">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0225734.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>MG</given-names></name>. <article-title>Landscape ecology: the effect of pattern on process</article-title>. <source>Annual review of ecology and systematics</source>. <year>1989</year>;<volume>20</volume>(<issue>1</issue>):<fpage>171</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.es.20.110189.001131</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pickett</surname><given-names>ST</given-names></name>, <name><surname>Cadenasso</surname><given-names>ML</given-names></name>. <article-title>Landscape ecology: spatial heterogeneity in ecological systems</article-title>. <source>Science</source>. <year>1995</year>;<volume>269</volume>(<issue>5222</issue>):<fpage>331</fpage>–<lpage>334</lpage>. <pub-id pub-id-type="doi">10.1126/science.269.5222.331</pub-id><?supplied-pmid 17841249?><pub-id pub-id-type="pmid">17841249</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>O’Neill</surname><given-names>R</given-names></name>, <name><surname>Krummel</surname><given-names>J</given-names></name>, <name><surname>Gardner</surname><given-names>R</given-names></name>, <name><surname>Sugihara</surname><given-names>G</given-names></name>, <name><surname>Jackson</surname><given-names>B</given-names></name>, <name><surname>DeAngelis</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Indices of landscape pattern</article-title>. <source>Landscape ecology</source>. <year>1988</year>;<volume>1</volume>(<issue>3</issue>):<fpage>153</fpage>–<lpage>162</lpage>. <pub-id pub-id-type="doi">10.1007/BF00162741</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>MG</given-names></name>. <article-title>Spatial and temporal analysis of landscape patterns</article-title>. <source>Landscape ecology</source>. <year>1990</year>;<volume>4</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1007/BF02573948</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref005">
      <label>5</label>
      <mixed-citation publication-type="other">McGarigal K, Cushman SA, Ene E. FRAGSTATS v4: spatial pattern analysis program for categorical and continuous maps; 2012. Computer software program produced by the authors at the University of Massachusetts, Amherst. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.umass.edu/landeco/research/fragstats/fragstats.html">http://www.umass.edu/landeco/research/fragstats/fragstats.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Steiniger</surname><given-names>S</given-names></name>, <name><surname>Hay</surname><given-names>GJ</given-names></name>. <article-title>Free and open source geographic information tools for landscape ecology</article-title>. <source>Ecological informatics</source>. <year>2009</year>;<volume>4</volume>(<issue>4</issue>):<fpage>183</fpage>–<lpage>195</lpage>. <pub-id pub-id-type="doi">10.1016/j.ecoinf.2009.07.004</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref007">
      <label>7</label>
      <mixed-citation publication-type="other">Heymann Y, Steenmans C, Croisille G, Bossard M. CORINE land cover: Technical guide; 1994.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Van Der Walt</surname><given-names>S</given-names></name>, <name><surname>Colbert</surname><given-names>SC</given-names></name>, <name><surname>Varoquaux</surname><given-names>G</given-names></name>. <article-title>The NumPy array: a structure for efficient numerical computation</article-title>. <source>Computing in Science &amp; Engineering</source>. <year>2011</year>;<volume>13</volume>(<issue>2</issue>):<fpage>22</fpage><pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Hunter</surname><given-names>JD</given-names></name>. <article-title>Matplotlib: A 2D graphics environment</article-title>. <source>Computing in science &amp; engineering</source>. <year>2007</year>;<volume>9</volume>(<issue>3</issue>):<fpage>90</fpage><pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">McKinney W. Data structures for statistical computing in python. In: van der Walt S, Millman J, editors. Proceedings of the 9th Python in Science Conference. vol. 445. Austin, TX; 2010. p. 51–56.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Riitters</surname><given-names>KH</given-names></name>, <name><surname>O’Neill</surname><given-names>R</given-names></name>, <name><surname>Hunsaker</surname><given-names>C</given-names></name>, <name><surname>Wickham</surname><given-names>JD</given-names></name>, <name><surname>Yankee</surname><given-names>D</given-names></name>, <name><surname>Timmins</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>A factor analysis of landscape pattern and structure metrics</article-title>. <source>Landscape ecology</source>. <year>1995</year>;<volume>10</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>39</lpage>. <pub-id pub-id-type="doi">10.1007/BF00158551</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref012">
      <label>12</label>
      <mixed-citation publication-type="book"><name><surname>Meentemeyer</surname><given-names>V</given-names></name>, <name><surname>Box</surname><given-names>EO</given-names></name>. <chapter-title>Scale effects in landscape studies</chapter-title> In: <source>Landscape heterogeneity and disturbance</source>. <publisher-name>Springer</publisher-name>; <year>1987</year> p. <fpage>15</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Saura</surname><given-names>S</given-names></name>, <name><surname>Martinez-Millan</surname><given-names>J</given-names></name>. <article-title>Sensitivity of landscape pattern metrics to map spatial extent</article-title>. <source>Photogrammetric engineering and remote sensing</source>. <year>2001</year>;<volume>67</volume>(<issue>9</issue>):<fpage>1027</fpage>–<lpage>1036</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Jelinski</surname><given-names>DE</given-names></name>, <name><surname>Luck</surname><given-names>M</given-names></name>, <name><surname>Tueller</surname><given-names>PT</given-names></name>. <article-title>Multiscale analysis of landscape heterogeneity: scale variance and pattern metrics</article-title>. <source>Geographic information sciences</source>. <year>2000</year>;<volume>6</volume>(<issue>1</issue>):<fpage>6</fpage>–<lpage>19</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>McDonnell</surname><given-names>MJ</given-names></name>, <name><surname>Pickett</surname><given-names>ST</given-names></name>. <article-title>Ecosystem structure and function along urban-rural gradients: an unexploited opportunity for ecology</article-title>. <source>Ecology</source>. <year>1990</year>;<volume>71</volume>(<issue>4</issue>):<fpage>1232</fpage>–<lpage>1237</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Shen</surname><given-names>W</given-names></name>, <name><surname>Sun</surname><given-names>W</given-names></name>, <name><surname>Tueller</surname><given-names>PT</given-names></name>. <article-title>Empirical patterns of the effects of changing scale on landscape metrics</article-title>. <source>Landscape Ecology</source>. <year>2002</year>;<volume>17</volume>(<issue>8</issue>):<fpage>761</fpage>–<lpage>782</lpage>. <pub-id pub-id-type="doi">10.1023/A:1022995922992</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>J</given-names></name>. <article-title>Effects of changing scale on landscape pattern analysis: scaling relations</article-title>. <source>Landscape ecology</source>. <year>2004</year>;<volume>19</volume>(<issue>2</issue>):<fpage>125</fpage>–<lpage>138</lpage>. <pub-id pub-id-type="doi">10.1023/B:LAND.0000021711.40074.ae</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref018">
      <label>18</label>
      <mixed-citation publication-type="other">Matthias Bussonnier, Jessica Forde, Jeremy Freeman, Brian Granger, Tim Head, Chris Holdgraf, et al. Binder 2.0—Reproducible, interactive, sharable environments for science at scale. In: Proceedings of the 17th Python in Science Conference; 2018. p. 113–120.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Bosch M, Chenal J. Spatiotemporal patterns of urbanization in three Swiss urban agglomerations: insights from landscape metrics, growth modes and fractal analysis. bioRxiv. 2019; p. 645549.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Guelton</surname><given-names>S</given-names></name>, <name><surname>Brunet</surname><given-names>P</given-names></name>, <name><surname>Amini</surname><given-names>M</given-names></name>, <name><surname>Merlini</surname><given-names>A</given-names></name>, <name><surname>Corbillon</surname><given-names>X</given-names></name>, <name><surname>Raynaud</surname><given-names>A</given-names></name>. <article-title>Pythran: Enabling static optimization of scientific python programs</article-title>. <source>Computational Science &amp; Discovery</source>. <year>2015</year>;<volume>8</volume>(<issue>1</issue>):<fpage>014001</fpage><pub-id pub-id-type="doi">10.1088/1749-4680/8/1/014001</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Behnel</surname><given-names>S</given-names></name>, <name><surname>Bradshaw</surname><given-names>R</given-names></name>, <name><surname>Citro</surname><given-names>C</given-names></name>, <name><surname>Dalcin</surname><given-names>L</given-names></name>, <name><surname>Seljebotn</surname><given-names>DS</given-names></name>, <name><surname>Smith</surname><given-names>K</given-names></name>. <article-title>Cython: The best of both worlds</article-title>. <source>Computing in Science &amp; Engineering</source>. <year>2011</year>;<volume>13</volume>(<issue>2</issue>):<fpage>31</fpage><pub-id pub-id-type="doi">10.1109/MCSE.2010.118</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">McGarigal K, Marks BJ. FRAGSTATS: spatial pattern analysis program for quantifying landscape structure. Gen Tech Rep PNW-GTR-351 Portland, OR: US Department of Agriculture, Forest Service, Pacific Northwest Research Station 122 p. 1995;351.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Hesselbarth</surname><given-names>MH</given-names></name>, <name><surname>Sciaini</surname><given-names>M</given-names></name>, <name><surname>With</surname><given-names>KA</given-names></name>, <name><surname>Wiegand</surname><given-names>K</given-names></name>, <name><surname>Nowosad</surname><given-names>J</given-names></name>. <article-title>landscapemetrics: an open-source R tool to calculate landscape metrics</article-title>. <source>Ecography</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pone.0225734.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Jung</surname><given-names>M</given-names></name>. <article-title>LecoS—A python plugin for automated landscape ecology analysis</article-title>. <source>Ecological informatics</source>. <year>2016</year>;<volume>31</volume>:<fpage>18</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1016/j.ecoinf.2015.11.006</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0225734.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Kluyver T, Ragan-Kelley B, Pérez F, Granger BE, Bussonnier M, Frederic J, et al. Jupyter Notebooks-a publishing format for reproducible computational workflows. In: Positioning and Power in Academic Publishing: Players, Agents and Agendas. IOS Press; 2016. p. 87–90.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0225734.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0225734.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rocchini</surname>
          <given-names>Duccio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Duccio Rocchini</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Duccio Rocchini</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0225734" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Sep 2019</named-content>
    </p>
    <p>PONE-D-19-21282</p>
    <p>PyLandStats: An open-source Pythonic library to compute landscape metrics</p>
    <p>PLOS ONE</p>
    <p>Dear %TITLE% Bosch,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Oct 28 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Prof. Duccio Rocchini, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal requirements;</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>1. Thank you fo rincluding the following funding information within your acknowledgements section; "This research has been supported by the Ecole Polytechnique Federale de Lausanne 397</p>
    <p>(EPFL). The Corine Land Cover inventory used for the example data were produced 398</p>
    <p>with funding by the European Union."</p>
    <p>We note that you have provided funding information that is not currently declared in your Funding Statement. However, funding information should not appear in the Acknowledgments section or other areas of your manuscript. We will only publish funding information present in the Funding Statement section of the online submission form.</p>
    <p>Please remove any funding-related text from the manuscript and let us know how you would like to update your Funding Statement. Currently, your Funding Statement reads as follows:</p>
    <p>"The author(s) received no specific funding for this work."</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: N/A</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: This article introduces PyLandStats, a definitely needed Python-based alternative to other patch metrics packages.</p>
    <p>General comments:</p>
    <p>* I would prefer having the patch metrics listed in the article rather than refer to the documentation, it seems like important information readers would want to see right away. How were these metrics selected? (around line 70)</p>
    <p>* I miss benchmark to see how much memory and time is required. What are the limitations, I assume everything is in memory? It could be also useful to see how demanding are individual metrics.</p>
    <p>* Did you compare the results with other packages? Do the automated tests actually test the correctness of the computations (e.g. compare with manually verified values)?</p>
    <p>* The quality of the figures is really bad, I wonder if the submission system messed that up?</p>
    <p>Software comments:</p>
    <p>* why there are functions for computing metrics for Landscape, but only properties for spatio-temporal and buffer analysis? Seems to be inconsistent, if possible comment on that.</p>
    <p>* how are dates specified, could it be e.g. DateTime object as well?</p>
    <p>* you call it gradient analysis, however, especially the generic case sounds more like zonal analysis in GIS terms, perhaps worth clarifying that in the manuscript.</p>
    <p>* L152: might be better to mention matplotlib as the library used for plotting in the beginning of the section</p>
    <p>* L112: perhaps clarify when the metrics are computed, if I understood correctly, it's not during the initialization but once you get the property.</p>
    <p>Typos:</p>
    <p>L20: missing 'and'</p>
    <p>L125: the the</p>
    <p>L138: skip 'probably'</p>
    <p>L146: slug?</p>
    <p>Figure 1 caption: metric</p>
    <p>L159: consists of</p>
    <p>L192: across</p>
    <p>L195: missing space</p>
    <p>L196: I would add space between number and unit</p>
    <p>L203: weird formulation</p>
    <p>L211: skip 'really'</p>
    <p>L263: scope of this article</p>
    <p>L268: in a GitHub repository</p>
    <p>L276: dependencies</p>
    <p>L282: are</p>
    <p>L300: neighbor</p>
    <p>L300: inter-patch (or one word), see also other places</p>
    <p>L324: of adjacency matrix</p>
    <p>L335: software packages</p>
    <p>L368:object-oriented what?</p>
    <p>in references there are multiple places where it needs upper case in titles</p>
    <p>Reviewer #2: In this study the author introduce PyLandStats, a new Python library to compute and quantify landscapes spatial patterns.</p>
    <p>I’ve found the paper interesting and the library really useful, especially because before the recent Hesselbarth et al. (2019) there were not (to the best of my knowledge) R packages or Python libraries to efficiently compute a whole set of landscape statistics without relying to standalone GIS software.</p>
    <p>The figures provided have a low quality, I recommend the author to improve them. The palette of Fig 3,5,7,8 could also be improved to increase the readability of the figure.</p>
    <p>It would be nice to see some comparison between the proposed packaged and the R pkg landscapemetrics, as well as for FRAGSTATS and LecoS QGIS plugin, in term of both accuracy and precision of the measures and time computation.</p>
    <p>I cannot access to the GitHub repository, something went wrong with the link?</p>
    <p>Personal curiosity: the library relies on rasterio, have you found some issues regarding the incompatibility between rasterio and gdal python libraries ? (e.g. <ext-link ext-link-type="uri" xlink:href="https://rasterio.readthedocs.io/en/stable/topics/switch.html">https://rasterio.readthedocs.io/en/stable/topics/switch.html</ext-link>).</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0225734.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0225734.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0225734" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">1 Oct 2019</named-content>
    </p>
    <p># Rebuttal letter</p>
    <p>## Editor</p>
    <p>In order to avoid any misunderstandings, the "Acknowledgements" section has been dropped. The funding statement can be left as it is since the authors have not received any specific funding for this work.</p>
    <p>## Reviewer #1</p>
    <p>The metrics have been listed in Table S1. The choice of implemented metrics has been mostly guided by their recurrence in the studies of land use/land cover change associated to urbanization. As detailed in the section "The PyLandStats library", the organization of the code and its open-source model enable users to contribute to the repository by requesting the implementation of new metrics or actually implementing them. On the other hand, lines 68-74 do not intend to suggest which metrics should be selected, but instead to show that users might employ the metrics keyword argument in order to limit their analysis to a subset of metrics of their choice.</p>
    <p>Two benchmarks comparing the execution times with those of FRAGSTATS and landscapemetrics has been included as Code S6. Such supporting information also features further details regarding the performance of PyLandStats. Additionally, a note regarding the memory size of Landscape objects has been added to the section "Dependencies and implementation details"</p>
    <p>The values computed for all the metrics implemented in PyLandStats are compared with those computed with FRAGSTATS v4 in Code S5, showing a maximum discrepancy of 0.1%. Such notebook is included in the example notebook repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats-notebooks">https://github.com/martibosch/pylandstats-notebooks</ext-link>), which is also subject to automated tests in Travis CI. Therefore, the automated tests for such repository do test for the correctness of the computations.</p>
    <p>I have updated the figures with higher DPI and updated the color palette of the landscape raster plots.</p>
    <p>Properties were used to compute the data frames of metrics in spatiotemporal, buffer and gradient analysis in order to avoid recomputing the metrics each time that the user desired to obtain a data frame or plot. Nevertheless, after the in-depth exploration of the performance detailed in Code S6, it seems that such performance gains are negligible. Therefore, in order to ensure a consistent API, the computation of data frames of metrics will use methods (instead of properties) throughout all the classes of PyLandStats.</p>
    <p>I have added a note (and updated the notebook in Code S2) to acknowledge that dates might also be specified as strings or datetime objects.</p>
    <p>The generic GradientAnalysis class has been renamed to ZonalAnalysis, and the manuscript and notebook of Code S3 have updated accordingly.</p>
    <p>A reference to matplotlib has been added (with its corresponding citation). For consistency, the citations for numpy and pandas have also been added (note that scipy, rasterio, shapely and geopandas do not have proper academic articles).</p>
    <p>I believe that after the unification of the API regarding the computation of data frames with methods, it is no longer necessary to clarify when metrics are computed since they are indeed computed when the methods are called. Additionally, details regarding how metrics are computed in PyLandStats are covered in section "Dependencies and implementation details" as well as Code S6.</p>
    <p>I have corrected the typos.</p>
    <p>## Reviewer #2</p>
    <p>I have updated the figures with higher DPI and updated the color palette of the landscape raster plots.</p>
    <p>Two benchmarks comparing the execution times with those of FRAGSTATS and landscapemetrics has been included as Code S6. Such supporting information also features further details regarding the performance of PyLandStats.</p>
    <p>The values computed for all the metrics implemented in PyLandStats are compared with those computed with FRAGSTATS v4 in Code S5, showing a maximum discrepancy of 0.1%.</p>
    <p>The link to the GitHub repository is displayed correctly in the manuscript (<ext-link ext-link-type="uri" xlink:href="https://github.com/martibosch/pylandstats">https://github.com/martibosch/pylandstats</ext-link>) and I believe that it has been working all along.</p>
    <p>Regarding the incompatibility between rasterio and GDAL's Python bindings, I have never encountered any issues, neither when installing PyLandStats via pip nor when installing it via conda. In any case, users might report any of such eventual issues in the GitHub repository.</p>
    <supplementary-material content-type="local-data" id="pone.0225734.s009">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">rebuttal_letter.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0225734.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0225734.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0225734.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rocchini</surname>
          <given-names>Duccio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Duccio Rocchini</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Duccio Rocchini</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0225734" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">12 Nov 2019</named-content>
    </p>
    <p>PyLandStats: An open-source Pythonic library to compute landscape metrics</p>
    <p>PONE-D-19-21282R1</p>
    <p>Dear Dr. Bosch,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Duccio Rocchini, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: (No Response)</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: Thank you for addressing my comments and putting the effort into reproducible research. I am looking forward to using the library. Found just couple small typos, which could be fixed:</p>
    <p>L119: Likewise Landscape instances ('Similarly to' would be better)</p>
    <p>L154: follow -&gt; following</p>
    <p>L330: is scales</p>
    <p>Reviewer #2: the author has answered to all the comments and provided an updated version of the manuscript. I would recommend to accept the paper. Well done!</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pone.0225734.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0225734.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rocchini</surname>
          <given-names>Duccio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Duccio Rocchini</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Duccio Rocchini</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0225734" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Nov 2019</named-content>
    </p>
    <p>PONE-D-19-21282R1 </p>
    <p>PyLandStats: An open-source Pythonic library to compute landscape metrics </p>
    <p>Dear Dr. Bosch:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Duccio Rocchini </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
