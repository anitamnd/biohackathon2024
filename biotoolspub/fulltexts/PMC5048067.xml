<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5048067</article-id>
    <article-id pub-id-type="pmid">27318200</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw370</article-id>
    <article-id pub-id-type="publisher-id">btw370</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Genome puzzle master (GPM): an integrated pipeline for building and editing pseudomolecules from fragmented sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jianwei</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff1">1</xref>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
        <xref ref-type="corresp" rid="btw370-cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kudrna</surname>
          <given-names>Dave</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mu</surname>
          <given-names>Ting</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Weiming</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Copetti</surname>
          <given-names>Dario</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
        <xref ref-type="aff" rid="btw370-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Yeisoo</given-names>
        </name>
        <author-comment>
          <p>†Present address: Phyzen Genomics Institute, Phyzen Inc., Seoul 151-836, South Korea.</p>
        </author-comment>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goicoechea</surname>
          <given-names>Jose Luis</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lei</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wing</surname>
          <given-names>Rod A.</given-names>
        </name>
        <xref ref-type="aff" rid="btw370-aff2">2</xref>
        <xref ref-type="aff" rid="btw370-aff3">3</xref>
        <xref ref-type="corresp" rid="btw370-cor1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btw370-aff1"><label><sup>1</sup></label>National Key Laboratory of Crop Genetic Improvement, Huazhong Agricultural University, Wuhan 430070, China</aff>
    <aff id="btw370-aff2"><label><sup>2</sup></label>Arizona Genomics Institute and BIO5 Institute, School of Plant Sciences, University of Arizona, Tucson, AZ 85721, USA</aff>
    <aff id="btw370-aff3"><label><sup>3</sup></label>International Rice Research Institute, Genetic Resource Center, Los Baños, Laguna, Philippines</aff>
    <author-notes>
      <corresp id="btw370-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw370-FM1">
        <p>†Present address: Phyzen Genomics Institute, Phyzen Inc., Seoul 151-836, South Korea.</p>
      </fn>
      <fn id="btw370-FM2">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2016-06-17">
      <day>17</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>20</issue>
    <fpage>3058</fpage>
    <lpage>3064</lpage>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>6</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>6</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw370.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><bold>Motivation:</bold> Next generation sequencing technologies have revolutionized our ability to rapidly and affordably generate vast quantities of sequence data. Once generated, raw sequences are assembled into contigs or scaffolds. However, these assemblies are mostly fragmented and inaccurate at the whole genome scale, largely due to the inability to integrate additional informative datasets (e.g. physical, optical and genetic maps). To address this problem, we developed a semi-automated software tool—Genome Puzzle Master (GPM)—that enables the integration of additional genomic signposts to edit and build ‘new-gen-assemblies’ that result in high-quality ‘annotation-ready’ pseudomolecules.</p>
      <p><bold>Results:</bold> With GPM, loaded datasets can be connected to each other <italic>via</italic> their logical relationships which accomplishes tasks to ‘group,’ ‘merge,’ ‘order and orient’ sequences in a draft assembly. Manual editing can also be performed with a user-friendly graphical interface. Final pseudomolecules reflect a user’s total data package and are available for long-term project management. GPM is a web-based pipeline and an important part of a Laboratory Information Management System (LIMS) which can be easily deployed on local servers for any genome research laboratory.</p>
      <p><bold>Availability and Implementation:</bold> The GPM (with LIMS) package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Jianwei-Zhang/LIMS">https://github.com/Jianwei-Zhang/LIMS</ext-link></p>
      <p><bold>Contacts:</bold><email>jzhang@mail.hzau.edu.cn</email> or <email>rwing@mail.arizona.edu</email></p>
      <p><bold>Supplementary information:</bold><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Illumina and PacBio SMRT sequencing technologies are the two most widely accepted sequencing platforms currently used for large scale genomics-driven data generation. Illumina, representing the most widely used second-generation sequencing technology, produces short reads (35–150 base read lengths), that are highly accurate, with base call outputs that can yield hundreds of millions of bases from a single lane over several days (depending upon complexity) (<xref rid="btw370-B15" ref-type="bibr">Schatz <italic>et al.</italic>, 2010</xref>). PacBio produces hundreds of thousands of long-read error-corrected sequences (up to 20 kb average read lengths) that can be produced in 3–6 h per SMRT cell. Data generated by either platform can be used independently, or in combination, to successfully assemble genomes <italic>de novo</italic> (<xref rid="btw370-B1" ref-type="bibr">Alkan <italic>et al.</italic>, 2011</xref>; <xref rid="btw370-B5" ref-type="bibr">Chin <italic>et al.</italic>, 2013</xref>; <xref rid="btw370-B7" ref-type="bibr">Kajitani <italic>et al.</italic>, 2014</xref>). Many assemblers have been developed to assemble raw sequence reads into sequence contigs (i.e. minimum sequence units for an assembly), such as SOAPdenovo (<xref rid="btw370-B10" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>), Allpaths (<xref rid="btw370-B3" ref-type="bibr">Butler <italic>et al.</italic>, 2008</xref>; <xref rid="btw370-B11" ref-type="bibr">MacCallum <italic>et al.</italic>, 2009</xref>), HGAP (<xref rid="btw370-B5" ref-type="bibr">Chin <italic>et al.</italic>, 2013</xref>), or Falcon (<ext-link ext-link-type="uri" xlink:href="https://github.com/PacificBiosciences/FALCON-integrate">https://github.com/PacificBiosciences/FALCON-integrate</ext-link>). A few programs or packages (e.g. Bambus, ABACAS, Mauve Aligner, ALLMAPS, etc.) are also available for scaffolding contigs (<xref rid="btw370-B2" ref-type="bibr">Assefa <italic>et al.</italic>, 2009</xref>; <xref rid="btw370-B6" ref-type="bibr">Hunt <italic>et al.</italic>, 2014</xref>; <xref rid="btw370-B13" ref-type="bibr">Pop <italic>et al.</italic>, 2004</xref>; <xref rid="btw370-B14" ref-type="bibr">Rissman <italic>et al.</italic>, 2009</xref>; <xref rid="btw370-B18" ref-type="bibr">Tang <italic>et al.</italic>, 2015</xref>). However, software tools that can be used to inspect/edit NGS sequence assemblies, as well as integrate other evidence types (i.e. physical and genetics maps) to produce an assembly that more accurately and completely reflects the native structure of a given genome, are currently lacking.</p>
    <p>To analyze, manage and incorporate genome datasets for diverse sequencing projects, such as pseudomolecule construction for the maize and several wild <italic>Oryza</italic> genome sequencing projects (<xref rid="btw370-B16" ref-type="bibr">Schnable <italic>et al.</italic>, 2009</xref>; J. Stein <italic>et al</italic>., submitted for publication; <xref rid="btw370-B20" ref-type="bibr">Wei <italic>et al.</italic>, 2009</xref>), we developed a software tool called ‘Genome Puzzle Master’ (GPM). GPM does not require sophisticated bioinformatics skills or support, and the final products are ready to use in the form of annotation-ready pseudomolecules. GPM can also facilitate the incorporation of additional datasets as new refinements are generated. Here we make GPM available to researchers who have NGS genome assemblies and other unlinked genomic datasets, and are struggling to generate ‘annotation-ready’ or ‘submission-ready’ pseudomolecules.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>GPM is a key part of a web-based Laboratory Information Management System (LIMS) that we developed to manage and analyze genomic data at different levels from both wet and dry lab experiments. The LIMS is set up in a LAMP environment (Linux operating system, Apache HTTP Server, MySQL database software and Perl programing language) and requires additional libraries and software listed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. We used jQuery (plus UI), a fast and concise JavaScript library, to build GPM’s highly interactive web applications.</p>
    <p>A database schema was designed which contains one main table called ‘<italic>matrix</italic>’ to record most types of data from ‘wet’ or ‘dry’ lab experiments (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>), and several extra tables (e.g. ‘<italic>link</italic>’, ‘<italic>alignment</italic>’) to store relationship data. Combined with these tables, we can extensively handle all types of datasets and connect them logically. In our database, the expansibility is flexible, as we can either add a new type of ‘<italic>container</italic><italic>’</italic> in the ‘<italic>matrix</italic><italic>’</italic> table or create another table for new data if needed, depending on the data type. For example, huge amounts of individual clone information can potentially cause process servers to slow down while performing complicated search operations on the ‘<italic>matrix</italic>’ table; hence, we specifically created a ‘<italic>clone</italic>’ table to store this type of data and separately can run queries on it to avoid concurrent queries on the ‘<italic>matrix</italic>’ table. To include additional information for certain existing data types, we extended the ability to store more informative data by adopting the JavaScript Object Notation (JSON), a lightweight data-interchange format, in the ‘<italic>note</italic>’ field of the ‘<italic>matrix</italic>’ table.</p>
    <p>GPM can currently utilize data categorized into different types, such as sequence contigs/scaffolds, Bacterial Artificial Chromosome (BAC) clone end-sequences (BESs), and reference genome sequences (RefSeq) that are the basic input elements for GPM assemblies. Different data types can be connected to one another <italic>via</italic> their sequence relationships. For example, AGP (a golden path, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/">https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/</ext-link>) information can describe the assembly of a larger sequence object (e.g. a contig, a scaffold, or a chromosome) from smaller objects and list their relationships. Most importantly, these kinds of relationships are used to link multiple datasets and to logically integrate genomic data with accuracy.</p>
    <p>To demonstrate a GPM assembly result, here we specifically defined two terms, ‘assemblyCtg’ for a GPM assembly contig and ‘assemblySeq’ for a sequence component that belongs to an assemblyCtg. Both data types are stored in the ‘<italic>matrix</italic>’ table as individual containers. In the database, a record of assemblyCtg describes its constituent members (assemblySeqs) and attributes (e.g. length, chromosome number and position); and an assemblySeq records the original sequence and the actual part and status of the component sequence (e.g. coordinates and orientation) that contributes to its corresponding assemblyCtg. A complete GPM assembly contains a set of assemblyCtgs, which are formed by various numbers of assemblySeqs.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Information-guided assembly</title>
      <p>To build pseudomolecules from sequence contigs with reference information, a GPM ‘assemblyRun’ execution (<xref ref-type="fig" rid="btw370-F1">Fig. 1</xref>) can be divided into 11 optional operations:
</p>
      <fig id="btw370-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>GPM assemblyRun operations</p>
        </caption>
        <graphic xlink:href="btw370f1p"/>
      </fig>
      <list list-type="order">
        <list-item>
          <p>Assembly initialization. First, to initialize a new assembly, GPM converts all <italic>de novo</italic> assembled sequences into assemblySeqs and each assemblySeq is assigned to a single assemblyCtg. (Note: This operation can be skipped for an existing assembly to avoid losing any manual edits.)</p>
        </list-item>
        <list-item>
          <p>Seq-to-Seq alignment. Depending on the potential relationship of all sequence elements, GPM can prepare overlapping alignments among all sequences in an assembly by running a ‘Seq-to-Seq’ pre-calculation with ‘blastn’ (NCBI BLAST 2.2.29+, E-value =1e-200) (<xref rid="btw370-B4" ref-type="bibr">Camacho <italic>et al.</italic>, 2008</xref>) as the default alignment engine. Pre-calculation parameters can be customized as needed. Overlap information between sequence contigs can be used in later processing steps, e.g. to determine the orientation of two neighboring sequences.</p>
        </list-item>
        <list-item>
          <p>Physical reference (PR)-guided assembly. Based on an existing physical reference, such as a physical map (PM) or an AGP file, sequences will be assigned to assemblyCtgs. If an AGP file is available, object-component information is used to build links between sequences. If a FingerPrinted Contig (FPC) file (<xref rid="btw370-B12" ref-type="bibr">Nelson <italic>et al.</italic>, 2005</xref>) is available, we use PM contig-clone information to connect potentially neighboring sequences and merge two assemblySeqs from neighboring BACs on PMs into an assemblyCtg. AssemblyCtgs will only be merged when overlapping evidence is detected. For a non-PR-based whole genome shotgun (WGS) project, the original sequences would be loaded into GPM, and this operation would be skipped. To build assemblyCtgs, the default parameters for merging two sequences are ‘minOverlapSeqToSeq = 1000 bp’ and ‘identitySeqToSeq = 99%,’ plus the overlap should be at both ends of each sequence.</p>
        </list-item>
        <list-item>
          <p>Seq-to-Genome alignment. This operation allows the user to run the alignment engine (‘blastn’ as default, E-value =1e-200) to search against reference genome sequences by using the original sequences of all assemblySeqs. The alignment information can be used to ‘group,’ ‘order,’ and ‘orient’ assemblyCtgs at a chromosomal scale. Depending on the similarity between the RefSeq and the to-be-assembled sequence, alignment parameters can be varied and tested by the user. GPM currently supports blastn, megablast (<xref rid="btw370-B4" ref-type="bibr">Camacho <italic>et al.</italic>, 2008</xref>) and BLAT (<xref rid="btw370-B9" ref-type="bibr">Kent <italic>et al.</italic>, 2002</xref>) as alignment engines for sequence comparison. Users can choose a proper alignment engine to accelerate GPM’s performance. For example, megablast or BLAT can be chosen for aligning sequences with high similarities since they run faster than blastn (in most situations). Importantly, to minimize the misleading impacts of repetitive sequences in both to-be-assembled and reference datasets during this step, users can (i) activate the ‘Mark Repeat Region’ option to filter out any non-unique alignments, which will not be considered as evidence to guide a GPM assembly; or (ii) select the alternative ‘Soft Masking’ option for the blastn/megablast alignment processing if repetitive regions in reference sequences have already been soft-masked for an assembly.</p>
        </list-item>
        <list-item>
          <p>Chromosome number assignment. If a high-quality reference genome is available, we prefer to use it as a guide to automatically assign chromosome numbers to assemblyCtgs. Alternatively, chromosome assignments can also be performed manually in a batch mode.</p>
        </list-item>
        <list-item>
          <p>Redundant assemblySeq removal. GPM will mask and remove a buried or redundant sequence according to the alignment information processed in operation 2. Here a redundant sequence is defined as a sequence that can be fully aligned by two neighboring sequences and the two neighboring sequences have end-overlapped alignment (default parameters ‘minOverlapSeqToSeq = 1000 bp’ and ‘identitySeqToSeq = 99%’). Such assemblySeqs would be marked as redundant and are hidden in the final assembly. Masking redundancies can reduce the computational complexity of orienting assemblySeqs and assemblyCtgs.</p>
        </list-item>
        <list-item>
          <p>Non-redundant assemblySeq orientation. In a multi-assemblySeq contig, GPM can orient sequences based on overlap data. This operation is performed on the premise that an overlapping region of two neighboring sequences should be at the end of each sequence, specifically at the right end of a pre-assemblySeq, and at the left end of the next-assemblySeq. GPM adjusts the orientation of these assemblySeqs to fit the premise accordingly with the proper extension of both non-overlapping parts that will elongate an expanding contig. GPM determines the orientation of each initial seed assemblySeq and then the subsequent assemblySeq one-by-one.</p>
        </list-item>
        <list-item>
          <p>AssemblyCtg orientation. Using a reference genome, GPM can orient assemblyCtgs according to the linear information suggested by the ‘Seq-to-Genome’ alignment data.</p>
        </list-item>
        <list-item>
          <p>End-to-End assemblyCtg merge. In some cases, physically overlapping sequences can be separated into two different assemblyCtgs due to the lack of strong evidence derived from the guide data, for example, when there is weak evidence to merge two contigs during a PM construction step. These kinds of situations usually arise from BACs located at the ends of PM contigs, and as a consequence, assemblySeqs of these BACs are also found at assemblyCtg ends. Detection of end-to-end overlaps between neighboring assemblyCtgs facilitates merging into larger assemblyCtgs.</p>
        </list-item>
        <list-item>
          <p>Redundancies in overlapping regions removed. Overlapping sequences between two neighboring assemblySeqs are considered redundant, and one redundant portion of either assemblySeq is removed from the final pseudomolecule. Here GPM makes no preferences on which overlapping sequence is retained. However, if evidence is provided that one overlapping sequence is of a higher quality than the other, then the highest quality sequence will be retained.</p>
        </list-item>
        <list-item>
          <p>AssemblyCtgs ordered and/or renumbered. GPM can sort assemblyCtgs based on their chromosomal number and position and provide an option to renumber assemblyCtgs in their proper order.</p>
        </list-item>
      </list>
      <p>After running an automated GPM assembly, the user is also able to manually check and edit the assembly (<xref ref-type="fig" rid="btw370-F2">Fig. 2</xref>). With the visualization function, GPM can provide a convenient way to manually check and edit an assembly, thereby eliminating the need to rely solely on automated assembly results. Relationships among datasets (including BAC sequences, BESs, physical maps, reference sequences, etc.) can logically guide assembly operations, including but not limited to grouping, merging, ordering and orienting. All manual editing steps are saved automatically, so the entire editing process can be reproduced and quality checked. Upon completion of an editing step, GPM can be used to export contig sequences, chromosome-based pseudomolecules and AGP files in real time.
</p>
      <fig id="btw370-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Visualization of typical available data in GPM. <bold>(A</bold>) GPM assemblyCtg view of a 500-KB region. AssemblySeqs, top and bottom, are shown as overlapping (yellow) and fully redundant assemblySeqs are gray. The retained (green) and removed (gray) portions of assemblySeqs are indicated. (<bold>B</bold>) Chromosome-scale view of a 500-KB region that compares two genome assemblies to a Reference sequence. The Reference Sequence is shown in the middle (bright green) with alignments (yellow) to each assemblyCtg (violet) at the top and bottom. The assemblyCtg order can be changed by drag-and-drop (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="btw370f2p"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Application of the GPM pipeline to assemble two high-quality reference genome sequences for <italic>indica</italic> rice: a case study</title>
      <p>Recently, our consortia published two high-quality reference genome sequences for the two main varietal groups of <italic>indica</italic> rice—Zhenshan 97 (ZS97) and Minghui 63 (MH63) (<xref rid="btw370-B21" ref-type="bibr">Zhang <italic>et al.</italic>, 2016a,b</xref>). These genomes were primarily sequenced using PacBio long-read sequencing of minimum tiling path BAC pools, combined with Illumina WGS assembled contigs to fill gaps. Once individual BAC sequences were assembled they were loaded into GPM for assembly editing and pseudomolecule construction.</p>
      <p>Following is a summary of how these data were used to assemble two of the highest quality <italic>indica</italic> rice genome assemblies produced to date:</p>
      <p>To assemble the ZS97 and MH63 genomes, the following datasets were loaded in to GPM: (i) Whole Genome Profiling (WGP, <xref rid="btw370-B19" ref-type="bibr">van Oeveren <italic>et al.</italic>, 2011</xref>) sequence-based PMs for each genome; and (ii) 5363 assembled BAC sequences (including duplicates for the same BAC clones sequenced in multiple jobs or pools) from 188 HGAP jobs for ZS97, and 6,801 from 313 jobs for MH63. Here we take ZS97 as an example to demonstrate the assembly procedure once these data were loaded (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). To start a new assembly, we set the ‘FPC: ZS97 v.1’ PM as the physical reference and the ‘IRGSP-MSU’ (i.e. <italic>O.</italic><italic>sativa</italic> subsp. <italic>japonica</italic> cv. Nipponbare genome sequence, <xref rid="btw370-B8" ref-type="bibr">Kawahara <italic>et al.</italic>, 2013</xref>) as the reference genome. We checked ‘Assign chromosome number for contigs’ and ‘Orient contigs based-on reference genome’ since both ZS97 and Nipponbare belong to the same genus and species (i.e. <italic>O.</italic><italic>sativa</italic>), and minor differences between the to-be-assembled and reference genomes would not mislead the results because they are so closely related. ‘Seq-to-Seq Alignment’ was used to pre-build all possible overlapping relationships among all BAC sequences since it was expected that those should be connected. ‘Seq-to-Genome Alignment’ was also used to map all BAC sequences to the reference genome. We also utilized the ‘End-to-End Merge,’ ‘Auto-Orient Sequences’ and ‘Filter Redundant Sequences and Overlaps’ options. (Note: A similar process was used to assemble the MH63 genome, except we used the ‘FPC: MH63 v.1’ PM as the physical reference.)</p>
      <p>After manual checking, editing and removing redundancies, the final assembly products yielded 318 (ZS97, composed of 3862 assemblySeqs) and 216 (MH63, composed of 3256 assemblySeqs) assemblyCtgs that were ordered, oriented, and assigned to their appropriate chromosomes. The ‘assemblyCtg’ sequences were used as the primary frameworks to build pseudomolecules after gap-filling sequences were integrated during the second round of GPM assembly (<xref rid="btw370-B22" ref-type="bibr">Zhang <italic>et al.</italic>, 2016b</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>GPM is an integrated pipeline for generating and editing pseudomolecules from existing next gen sequence assembles using evidence-based guides such as reference sequences, physical maps, genetic maps and paired BESs. We demonstrated how GPM can be used to generate high-quality submission-ready pseudomolecules for two <italic>indica</italic> rice accessions, ZS97 and MH63, by the integration of BAC-based physical maps and reference sequence guides. To perform an assembly with GPM, not all the resources like those used for ZS97 and MH63 are required, but GPM does require at least one guide type (e.g. genetic, physical or genome reference). Since GPM does not reassemble sequence data from the original short/long reads, the kind and quality of the evidence-based guides will greatly affect the amount of time required for editing and will impact the final quality of an assembly. Using a reference genome in a GPM assembly is quite valuable, however, the utilization of more evidence guides can greatly enhance the ability to build high-quality pseudomolecules and to avoid the overuse of the reference sequences in conforming a GPM assembly to mimic a RefSeq. If a reference genome is the only evidence to guide an assembly, then reference sequence overuse mistakes can’t be avoided. However, using other information that is available could detect overuse errors which would be corrected during a manual check step (which is not labor-intensive and strongly recommended) with GPM. Hence, evidence data are key factors used to build high-quality GPM assemblies.</p>
    <p>In the current version of our LIMS, we can track each processing step from BAC library construction to the final genome assembly seamlessly during the entire phase of a sequencing project. BAC library resources and wet lab sequencing runs are recorded in our system. As a part of the LIMS, GPM supports FASTA-formatted sequences. However, the ability to deal with raw reads has been limited due to their huge data size. Some additional features, such as paired end/mate and MTP information, are partially adapted for assembly manipulation in the current version of GPM. Pseudomolecules in FASTA format with an AGP file can be generated as the final output for further downstream analysis and public repository sequence submissions (e.g. GenBank).</p>
    <p>The LIMS can be expanded to integrate new functions for a specific project as needed. For example, we built a pipeline called ‘postHGAP’ to perform circularization and identification of BAC sequences for the two rice genome sequencing projects described above (<xref ref-type="fig" rid="btw370-F3">Fig. 3</xref>). As reported in our data descriptor (<xref rid="btw370-B22" ref-type="bibr">Zhang <italic>et al.</italic>, 2016b</xref>), we used a map-based BAC-pool sequencing strategy to produce sequence data that were assembled into a set of sequences (termed unitigs by HGAP) for each pool. We were able to process the output of each corresponding HGAP job to circularize and identify BAC sequences properly using related data information in the LIMS as follows: (i) postHGAP first filtered unitigs with lengths shorter than 10 kb, then (ii) trimmed vectors and circularized plasmid or BAC sequences according to pairs of sequences at specific breakpoints and (iii) assigned BAC IDs to each sequence according to WGP tags or BES information. During the postHGAP processing step, two parameters (default: minOverlap = 500 bp, overlapIdentity = 95%) could be set for sequence circularization and four optional parameters (default: minCloneTagNumber = 5, tagMatchIdentity = 100%, tagMatchPercent = 80%, besMatchIdentity = 98% if no WGP tags available) for BAC ID assignment. The program ‘blastn’ (NCBI BLAST 2.2.29+) was used to perform sequence comparison and alignment analysis in postHGAP. As a result, a total of 501 HGAP jobs (multiple runs for the same pool count multiple times) for 375 pools were run through postHGAP in this study and produced 12 164 BAC-ID-ready sequences (including duplicates for the same BAC processed in multiple jobs or pools) for both ZS97 and MH63. All BAC-ID-ready sequences were seamlessly converted as input datasets for both GPM assemblies.
</p>
    <fig id="btw370-F3" orientation="portrait" position="float">
      <label>Fig. 3.</label>
      <caption>
        <p>Flowchart for processing unitigs with postHGAP</p>
      </caption>
      <graphic xlink:href="btw370f3p"/>
    </fig>
    <p>Technically, the use of a one-main-table database schema design may simplify query processing. However, one possible disadvantage for this schema is that the response time to query might be longer with increasing amounts of data. Based upon our LIMS structure, we used the new ‘<italic>container</italic>’ option for less complicated data and created new tables for large datasets (e.g. clones). To date, we are able to operate GPM smoothly on a 4× 12-core cluster with more than 1.7 million data records. These kinds of strategies are recommended for other users. We can provide free host services to academic projects of medium-size genomes (up to 1 Gb) with full technical support.</p>
    <p>Several WGS scaffolding packages (e.g. Bambus, Mauve Aligner, ABACAS, ALLMAPS, etc.) treat assembled contig sequences as non-overlapping and single-copy sequences. Unfortunately, these packages are not focused toward the handling of inherent sequence redundancies and are not programmed to produce incremental assemblies. Further, these scaffolding tools are all file-based and do not provide a flexible process for manual checking and editing, especially if the input data has been modified or updated. In contrast, GPM is a relationship-based pipeline, which has the flexibility to edit and visualize assembled data, not only by showing the order and orientation of contig sequences and sequence redundancies but also by displaying the necessary guide information for easy user confirmation. One thing GPM cannot do is to assemble a genome <italic>de novo</italic> from raw reads. This deficit can be compensated for by its ability to import results (sequences and AGPs) from other assembly programs to guide new and improved assemblies. The final quality of a GPM assembly relies heavily on the quality and richness of the guide information used. For example, if a draft genome assembly is used as the guide rather than a map-based BAC-by-BAC assembly, the quality of the GPM assembly will suffer.</p>
    <p>DNA sequencing technologies and assembly programs change rapidly, and the GPM pipeline presented here is no exception. We will continue to improve the interactive functionalities of GPM, as well as integrate additional tools to support more data types. With GPM, data types are seamlessly linked and logically integrated into an encompassing LIMS for all genomic data. GPM is an open source software dynamically developed for the genomics research community and can be extensively adapted/improved by different research groups for their own applications.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw370_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This study was supported by the Start-up Fund of the National Key Laboratory of Crop Genetic Improvement to J.Z. and the National Science Foundation Grant (#1026200) to R.A.W.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btw370-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alkan</surname><given-names>C.</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>Limitations of next-generation genome sequence assembly</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>61</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">21102452</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Assefa</surname><given-names>S.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>ABACAS: algorithm-based automatic contiguation of assembled sequences</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1968</fpage>–<lpage>1969</lpage>.<pub-id pub-id-type="pmid">19497936</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>J.</given-names></name></person-group><etal/> (<year>2008</year>) <article-title>ALLPATHS: de novo assembly of whole-genome shotgun microreads</article-title>. <source>Genome Res</source>., <volume>18</volume>, <fpage>810</fpage>–<lpage>820</lpage>.<pub-id pub-id-type="pmid">18340039</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C.</given-names></name></person-group><etal/> (<year>2008</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>421</fpage>.</mixed-citation>
    </ref>
    <ref id="btw370-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chin</surname><given-names>C.S.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>563</fpage>–<lpage>569</lpage>.<pub-id pub-id-type="pmid">23644548</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>A comprehensive evaluation of assembly scaffolding tools</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R42</fpage>.<pub-id pub-id-type="pmid">24581555</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kajitani</surname><given-names>R.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Efficient <italic>de novo</italic> assembly of highly heterozygous genomes from whole-genome shotgun short reads</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>1384</fpage>–<lpage>1395</lpage>.<pub-id pub-id-type="pmid">24755901</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawahara</surname><given-names>Y.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Improvement of the <italic>Oryza sativa</italic> Nipponbare reference genome using next generation sequence and optical map data</article-title>. <source>Rice</source>, <volume>6</volume>, <fpage>4</fpage>.<pub-id pub-id-type="pmid">24280374</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>W.</given-names></name></person-group><etal/> (<year>2002</year>) <article-title>BLAT – the BLAST-like alignment tool</article-title>. <source>Genome Res</source>., <volume>12</volume>, <fpage>656</fpage>–<lpage>664</lpage>.<pub-id pub-id-type="pmid">11932250</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>R.</given-names></name></person-group><etal/> (<year>2012</year>) <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>. <source>GigaScience</source>, <volume>1</volume>, <fpage>18</fpage>.<pub-id pub-id-type="pmid">23587118</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacCallum</surname><given-names>I.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>ALLPATHS 2: small genomes assembled accurately and with high continuity from short paired reads</article-title>. <source>Genome Biol</source>., <volume>10</volume>, <fpage>R103</fpage>.<pub-id pub-id-type="pmid">19796385</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>W.</given-names></name></person-group><etal/> (<year>2005</year>) <article-title>Whole-genome validation of high-information-content fingerprinting</article-title>. <source>Plant Physiol</source>., <volume>139</volume>, <fpage>27</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">16166258</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pop</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2004</year>) <article-title>Hierarchical scaffolding with Bambus</article-title>. <source>Genome Res</source>., <volume>14</volume>, <fpage>149</fpage>–<lpage>159</lpage>.<pub-id pub-id-type="pmid">14707177</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rissman</surname><given-names>A.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>Reordering contigs of draft genomes using the Mauve aligner</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2071</fpage>–<lpage>2073</lpage>.<pub-id pub-id-type="pmid">19515959</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schatz</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2010</year>) <article-title>Assembly of large genomes using second-generation sequencing</article-title>. <source>Genome Res</source>., <volume>20</volume>, <fpage>1165</fpage>–<lpage>1173</lpage>.<pub-id pub-id-type="pmid">20508146</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnable</surname><given-names>P.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>The B73 maize genome: complexity, diversity, and dynamics</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>1112</fpage>–<lpage>1115</lpage>.<pub-id pub-id-type="pmid">19965430</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>H.</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>ALLMAPS: robust scaffold ordering based on multiple maps</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>3</fpage>.<pub-id pub-id-type="pmid">25583564</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Oeveren</surname><given-names>J.</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>Sequence-based physical mapping of complex genomes by whole genome profiling</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>618</fpage>–<lpage>625</lpage>.<pub-id pub-id-type="pmid">21324881</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>F.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>The physical and genetic framework of the maize B73 genome</article-title>. <source>PLoS Genet</source>., <volume>5</volume>, <fpage>e1000715</fpage>.<pub-id pub-id-type="pmid">19936061</pub-id></mixed-citation>
    </ref>
    <ref id="btw370-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal/> (<year>2016a</year>) Extensive sequence divergence between the reference genomes of two elite <italic>indica</italic> rice varieties Zhenshan97 and Minghui 63. <source>Proc. Natl. Acad. Sci. USA</source>, <comment>doi:10.1073/pnas.1611012113</comment>.</mixed-citation>
    </ref>
    <ref id="btw370-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal/> (<year>2016b</year>) Building two <italic>indica</italic> rice reference genomes with PacBio long-read and Illumina paired-end sequencing data. <italic>Sci. Data</italic>, 10.1038/sdata.2016.76.</mixed-citation>
    </ref>
  </ref-list>
</back>
