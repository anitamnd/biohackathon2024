<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5644082</article-id>
    <article-id pub-id-type="publisher-id">1863</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1863-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>chngpt: threshold regression model estimation and inference</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4230-6863</contrib-id>
        <name>
          <surname>Fong</surname>
          <given-names>Youyi</given-names>
        </name>
        <address>
          <email>yfong@fhcrc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Ying</given-names>
        </name>
        <address>
          <email>yhuang@fhcrc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gilbert</surname>
          <given-names>Peter B.</given-names>
        </name>
        <address>
          <email>pgilbert@fhcrc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Permar</surname>
          <given-names>Sallie R.</given-names>
        </name>
        <address>
          <email>sallie.permar@duke.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution>Department of Biostatistics, Bioinformatics and Epidemiology, Vaccine and Infectious Disease Division, </institution><institution>Fred Hutchinson Cancer Research Center, USA, </institution></institution-wrap>1100 Fairview Ave N., Seattle, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000100241216</institution-id><institution-id institution-id-type="GRID">grid.189509.c</institution-id><institution>Human Vaccine Institute, </institution><institution>Duke University Medical Center, </institution></institution-wrap>2 Genome Court, Durham, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>454</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Threshold regression models are a diverse set of non-regular regression models that all depend on change points or thresholds. They provide a simple but elegant and interpretable way to model certain kinds of nonlinear relationships between the outcome and a predictor.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The R package <italic>chngpt</italic> provides both estimation and hypothesis testing functionalities for four common variants of threshold regression models. All allow for adjustment of additional covariates not subjected to thresholding. We demonstrate the consistency of the estimating procedures and the type 1 error rates of the testing procedures by Monte Carlo studies, and illustrate their practical uses using an example from the study of immune response biomarkers in the context of Mother-To-Child-Transmission of HIV-1 viruses.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p><italic>chngpt</italic> makes several unique contributions to the software for threshold regression models and will make these models more accessible to practitioners interested in modeling threshold effects.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1863-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Segmented regression model</kwd>
      <kwd>Regression kink</kwd>
      <kwd>Jump-type</kwd>
      <kwd>Change point</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-AI122991</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UM1-AI068635</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM106177</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Threshold regression models are a class of regression models where the predictors are associated with the outcome in a threshold-dependent way. By introducing a threshold parameter, also known as the change point, threshold regression models provide a simple but elegant and interpretable way to model certain kinds of nonlinear relationships between the outcome and a predictor. There are many applications to threshold regression models in biomedical fields. Our interests in these models come primarily from the analyses of immunological assay data in human vaccine studies, where threshold-dependent association between risk of infection and immune response biomarkers abounds [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>Threshold regression models can take many forms depending on what happens at the threshold [<xref ref-type="bibr" rid="CR3">3</xref>]. For example, Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows four types of threshold effects: step, hinge, segmented and ‘stegmented’. The step and hinge models are two of the most basic forms of threshold effects with zero slope before the threshold; the segmented model generalizes the hinge model by allowing non-zero slope between the threshold; and the stegmented model, as the name suggests, can be viewed as the fusion of the step and segmented models.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Four types of threshold effects</p></caption><graphic xlink:href="12859_2017_1863_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>In the generalized linear regression framework, we can write down the mean function of these four types of threshold models as follows: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \eta &amp; =\alpha_{1}+\alpha_{2}^{T}z+\beta_{1}I\left(x&gt;e\right)\qquad\qquad\qquad\qquad\quad \text{step}\\ \eta &amp; =\alpha_{1}+\alpha_{2}^{T}z+\beta_{1}\left(x-e\right)_{+}\qquad\qquad\qquad\qquad\,\,\text{hinge}\\ \eta &amp; =\alpha_{1}+\alpha_{2}^{T}z+\beta_{1}\left(x-e\right)_{+}+\gamma x\qquad\qquad \text{segmented} \\ \eta &amp; =\alpha_{1}+\alpha_{2}^{T}z+\beta_{1}\left(x-e\right)_{+}+\gamma x\\ &amp;\quad+\beta_{2}I\left(x&gt;e\right).\qquad\qquad\qquad\qquad\qquad \text{stegmented} \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>η</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mtext>step</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>η</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mtext>hinge</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>η</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γx</mml:mi><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext>segmented</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>η</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γx</mml:mi><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mi>.</mml:mi><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext>stegmented</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2017_1863_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
    <p>Here <italic>e</italic> is the threshold parameter, <italic>x</italic> is the predictor with threshold effect, <italic>z</italic> denotes additional predictors, <italic>I</italic>(<italic>x</italic>&gt;<italic>e</italic>)=1 when <italic>x</italic>&gt;<italic>e</italic> and 0 otherwise, and (<italic>x</italic>−<italic>e</italic>)<sub>+</sub> denotes the hinge function, which equals <italic>x</italic>−<italic>e</italic> when <italic>x</italic>&gt;<italic>e</italic> and 0 otherwise.</p>
    <p>Threshold regression models are related to but distinct from change-point analysis [<xref ref-type="bibr" rid="CR4">4</xref>], which deal with time series data and are primarily concerned with detecting structural changes along a natural axis such as time or location on a chromosome. Many problems in change-point analysis are not regression problems. In change-point analysis regression problems, time series data are divided into regimens by change points; the relationships between the outcome and all the predictors are allowed to differ between regimens. In other words, all predictors are simultaneously thresholded in change-point analysis regression problems [<xref ref-type="bibr" rid="CR5">5</xref>]. On the other hand, threshold regression models are fundamentally concerned with modeling nonlinearity. In this aspect, threshold regression models are more comparable to other nonlinear regression methods such as regression spline models [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Both threshold models and spline models are capable of modeling nonlinear relationships between the outcome and predictors. Their main differences lie in versatility and ease of interpretation. Take for example the hinge model and a natural cubic spline [<xref ref-type="bibr" rid="CR7">7</xref>] with two degrees of freedom. Both have two degrees of freedom; in the case of the hinge model, the two relevant parameters are <italic>β</italic>
<sub>1</sub> and <italic>e</italic>. The spline model is more versatile than the hinge model, but when both models offer reasonably good fits, the hinge model is more readily interpretable [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>While many software programs are available for change-point analysis and regression spline models, there are relatively few for threshold regression models. The best existing implementation is the R package <italic>segmented</italic> [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], which supports the hinge and segmented models and allows multiple thresholds. Our <italic>chngpt</italic> package complements the <italic>segmented</italic> package by making three unique contributions: (1) it supports all four types of threshold effects in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, and supports models with interaction terms between predictors subjected to thresholding and predictors not subjected to thresholding [<xref ref-type="bibr" rid="CR10">10</xref>]; (2) the search method in <italic>segmented</italic> employs a first order approximation of the non-smooth criterion function [<xref ref-type="bibr" rid="CR11">11</xref>], while <italic>chngpt</italic> offers two alternative search methods: exact, which optimizes the exact criterion function, and smooth, which approximates the criterion function with a logistic function-based smooth function [<xref ref-type="bibr" rid="CR3">3</xref>]. The exact method guarantees to find the globally optimal solution but can be slow when the sample size is large, while the smooth method, like <italic>segmented</italic>, is faster but may find a locally optimal solution;</p>
    <p>(3) <italic>segmented</italic> does not provide confidence intervals that account for the uncertainty of the threshold estimate, while <italic>chngpt</italic> do. The latter also includes model-robust confidence intervals, which are designed to provide proper coverage even if the data-generating model is not truly a threshold model [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Estimation and confidence intervals</title>
      <p>Estimation of threshold regression models is complicated by the fact that the models are not smooth in the threshold parameter. We consider two approaches for finding the maximum likelihood estimate of the threshold model parameters: <italic>exact</italic> and <italic>smooth</italic>. In the exact method we choose a grid of candidate change points that uniformly span the quantiles of the empirical distribution of the thresholded covariate. Given a candidate change point, the threshold regression model reduces to a regular regression model. The estimated change point is defined as the one corresponding to the reduced regression model with the highest likelihood. The advantages of the exact method are that it does not require a starting value for change point, and finds the global optimal solution; on the other hand, this method does not scale well to large datasets. As a practical measure, we set a default grid size of 500; when the sample size is larger than the grid size, we choose a subset of thresholded covariate values by uniformly sampling the ranks.</p>
      <p>In the smooth method, we approximate the discontinuous likelihood function of a threshold regression model by approximating the step function <italic>I</italic>(<italic>x</italic>&gt;<italic>e</italic>) with a two-parameter logistic function [1+ exp{<italic>b</italic>(<italic>x</italic>−<italic>e</italic>)}]<sup>−1</sup> [<xref ref-type="bibr" rid="CR3">3</xref>], where <italic>b</italic> is chosen to be an appropriately large constant. To find the parameter estimate, we perform iterated optimization. Given an initial estimate of all model parameters, we alternatively 
<list list-type="order"><list-item><p>update the threshold parameter <italic>e</italic> and the coefficients <italic>β</italic>’s and <italic>γ</italic> that are associated with thresholded covariate, conditional on the rest of the model parameters estimates, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M4"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq1.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p>update all coefficients, <italic>α</italic>, <italic>β</italic>’s and <italic>γ</italic>, conditional on the estimated threshold <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {e}$\end{document}</tex-math><mml:math id="M6"><mml:mi>ê</mml:mi></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq2.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p>
      <p>Due to approximation of the step function, the second step above has a smooth objective function and can be performed using a wide variety of optimization methods. Our choice is a quasi-Newton method with box constraint as implemented in the R function optim. We stop the algorithm when the relative changes dip below a pre-determined tolerance level. The main advantage of the smooth approximation algorithm is that even with a large dataset, it can converge relatively quickly. On the other hand, the solution found by this algorithm is a local optimum, and its performance depends critically on the choice of starting value. To get good starting values, we perform hypothesis testing on the coefficients associated with the thresholded covariate, which will be described next, and use the threshold value corresponding to the maximal test statistic as the starting value.</p>
      <p>There are two basic types of confidence intervals for threshold regression model parameter estimates: model-based and model-robust. The former has the proper coverage only when the model is correctly specified, while the coverage of the latter is robust to model misspecification. There is an interesting interplay between these two types of confidence intervals and continuous (hinge and segmented) versus discontinuous (step and stegmented) threshold models. For continuous threshold models, all parameters converge at the regular <italic>n</italic>
<sup>−1/2</sup> rate whether or not the model is correctly specified, but the asymptotic variance-covariance matrices differ [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. For discontinuous threshold models, under correct model specification, the threshold estimate converges at a fast rate of <italic>n</italic>
<sup>−1</sup>, and the regression coefficient estimates converge at their usual rates of <italic>n</italic>
<sup>−1/2</sup> [<xref ref-type="bibr" rid="CR14">14</xref>]; under model misspecification, all parameters converge at the slower <italic>n</italic>
<sup>−1/3</sup> rate [<xref ref-type="bibr" rid="CR15">15</xref>]. In the <italic>chngpt</italic> package, we provide implementation of model-based intervals for all types of threshold models as well as model-robust confidence intervals for the continuous threshold models.</p>
    </sec>
    <sec id="Sec4">
      <title>Hypothesis testing</title>
      <p>For hypothesis testing, we extend the methods in [<xref ref-type="bibr" rid="CR10">10</xref>], which dealt with the step model, to handle all four types of threshold effects. In the step and hinge models, we are interested in testing the null hypothesis <italic>β</italic>
<sub>1</sub>=0. In the segmented and stegmented models, the situation is more complex. We may be interested in testing all <italic>β</italic> and <italic>γ</italic> are 0, which corresponds to the null hypothesis that <italic>x</italic> has no effect on <italic>Y</italic>, or we may wish to leave <italic>γ</italic> out of the null hypothesis and test all <italic>β</italic> are 0. The latter puts the focus on threshold effect, and that is what we will focus on. Specifically, we will test <italic>β</italic>
<sub>1</sub>=0 for the segmented model and <italic>β</italic>
<sub>1</sub>=<italic>β</italic>
<sub>2</sub>=0 for the stegmented model. When the null hypothesis involves only one parameter, either the maximum of scores or the maximum of likelihood ratios can be used. When the null hypothesis involves more than one parameter, tests based on maximum of likelihood ratios can be more powerful [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      <p>Consider the following equation that describes all threshold models in a uniform way: 
<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\eta=\alpha^{T}\underline{z}+\beta^{T}\underline{x}\left(e\right), $$ \end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:munder accentunder="false"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:munder accentunder="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2017_1863_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <underline>z</underline> represents all predictors independent of <italic>e</italic> and <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {x}\left (e\right)$\end{document}</tex-math><mml:math id="M10"><mml:munder accentunder="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq3.gif"/></alternatives></inline-formula> represents all predictors dependent on <italic>e</italic>. Let <italic>p</italic> be the dimension of <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {x}(e)$\end{document}</tex-math><mml:math id="M12"><mml:munder accentunder="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq4.gif"/></alternatives></inline-formula>; <italic>p</italic>=2 in the stegmented model and <italic>p</italic>=1 otherwise.</p>
      <p>Let <italic>Q</italic>(<italic>e</italic>) denote the likelihood ratio statistic for comparing a threshold model and the null model conditional on a candidate change point <italic>e</italic>. Assuming there are <italic>M</italic> candidate change points, the maximum of likelihood ratios test statistics is defined as 
<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${LR}_{\max}=\max\left\{ Q\left(e_{1}\right),\cdots,Q\left(e_{M}\right) \right\}. $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">LR</mml:mtext></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2017_1863_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Under the standard regularity conditions, <italic>Q</italic>(<italic>e</italic>) converges to a chi-squared distribution with <italic>p</italic> degrees of freedom under the null hypothesis. Furthermore, the statistic has the asymptotic representation 
<disp-formula id="Equd"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$Q\left(e\right) =S_{\beta}^{T}\left(e\right) \hat{I}_{\beta\beta.\alpha }^{-1}\left(e\right) S_{\beta}\left(e\right) +o_{p}\left(1\right), $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2017_1863_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\beta }^{T}\left (e\right) $\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq5.gif"/></alternatives></inline-formula> is the score vector for coefficients <italic>β</italic>, and <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {I}_{\beta \beta.\alpha }^{-1}\left (e\right) $\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq6.gif"/></alternatives></inline-formula> is the estimated information for <italic>β</italic> in the alternative model using <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mu }$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq7.gif"/></alternatives></inline-formula> estimated under the null. In other words, <italic>Q</italic>(<italic>e</italic>) is asymptotically equivalent to the inner product of <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\beta }^{T}\left (e\right) \hat {I}_{\beta \beta.\alpha }^{-1/2}\left (e\right) $\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq8.gif"/></alternatives></inline-formula> and itself. Thus the joint distribution of {<italic>Q</italic>(<italic>e</italic>
<sub>1</sub>),⋯,<italic>Q</italic>(<italic>e</italic>
<sub><italic>M</italic></sub>)} can be estimated via a Monte Carlo procedure by simulating from a multivariate normal whose correlate matrix is the correlation matrix of <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{ S_{\beta }^{T}\left (e_{1}\right) \hat {I}_{\beta \beta.\alpha }^{-1/2}\left (e_{1}\right),$\end{document}</tex-math><mml:math id="M26"><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq9.gif"/></alternatives></inline-formula>...,<inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\beta }^{T}\left (e_{M}\right) \hat {I}_{\beta \beta.\alpha }^{-1/2}\left (e_{M}\right) \}^{T}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq10.gif"/></alternatives></inline-formula>. Specifically, we 
<list list-type="bullet"><list-item><p>Draw <italic>B</italic> independent random samples of size <italic>pM</italic> from a multivariate normal distribution with mean 0, variance 1 and correlation matrix derived from <italic>JVJ</italic>, where <italic>J</italic> is a block diagonal matrix with <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {I}_{\beta \beta.\alpha }^{-1/2}\left (e^{\ast }\right) $\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>Î</mml:mi></mml:mrow><mml:mrow><mml:mi>ββ.α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq11.gif"/></alternatives></inline-formula> on the diagonal and <italic>V</italic> is the variance-covariance matrix of <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left [ \begin {array} [c]{ccc} S\left (e_{1}\right) &amp; \cdots &amp; S\left (e_{M}\right) \end {array} \right ]^{T}$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq12.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p>Each of the <italic>B</italic> samples can be viewed as a sequence of <italic>M</italic>
<italic>p</italic>-tuples of random variables. For the <italic>b</italic>
<sup><italic>t</italic><italic>h</italic></sup> sample, compute the sum of squares for each <italic>p</italic>-tuple of random variables, and denote the maximum of the <italic>M</italic> sums of square by <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${LR}_{\max }^{b}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mtext mathvariant="italic">LR</mml:mtext></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq13.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p>Obtain the p-value as <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\#\left \{ {LR}_{\max }&gt;{LR}_{\max }^{b}\right \} /B$\end{document}</tex-math><mml:math id="M36"><mml:mi>#</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">LR</mml:mtext></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="italic">LR</mml:mtext></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq14.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p>
    </sec>
  </sec>
  <sec id="Sec5" sec-type="results">
    <title>Results</title>
    <sec id="Sec6">
      <title>Monte Carlo studies</title>
      <p>To validate the proposed methods and check the accuracy of the implementation, we conduct Monte Carlo experiments. We simulate data from logistic threshold regression models with true parameters listed in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table A.1. For the covariate distributions, we simulate from <italic>z</italic>∼<italic>N</italic>(0,<italic>σ</italic>=1), <italic>x</italic>∼<italic>N</italic>(4.7,<italic>σ</italic>=1.6). Each experiment is repeated 2,000 times to evaluate estimation performance and 10,000 times to evaluate hypothesis testing performance.</p>
      <p>The results of estimation are collected in Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>. Table <xref rid="Tab1" ref-type="table">1</xref> shows the relative bias of the estimated coefficients and the bias of the estimated threshold. For the step, hinge, and segmented models, the relative bias is computed by dividing the difference between the Monte Carlo mean and the true value by the true value; for the stegmented model, the Monte Carlo mean is replaced by the Monte Carlo median due to the skewness of the distribution of the parameters. The results indicate that the estimates from both grid search and smooth approximation are asymptotically unbiased. We also see that the estimated coefficients associated with the thresholded covariate <italic>x</italic> have larger finite sample biases than the estimated coefficients associated with <italic>z</italic>, but the biases decrease as the sample size increases. Table <xref rid="Tab2" ref-type="table">2</xref> shows that the sampling variability decreases as the sample size increases as expected.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Relative bias of coefficient estimates and bias of threshold estimates of three search strategies: grid search, smooth approximation, and first order approximation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">step</th><th align="left" colspan="2">hinge</th><th align="left" colspan="2">segmented</th><th align="left" colspan="2">stegmented</th></tr><tr><th align="left"><italic>n</italic></th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">2000</th></tr></thead><tbody><tr><td align="left">grid</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.00</td><td align="left">0.04</td><td align="left">0.01</td></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.22</td><td align="left">0.09</td><td align="left">0.48</td><td align="left">0.02</td></tr><tr><td align="left">I(x &gt;e)</td><td align="left">0.17</td><td align="left">0.09</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.85</td><td align="left">0.19</td></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.15</td><td align="left">0.05</td><td align="left">0.23</td><td align="left">0.11</td><td align="left">-0.33</td><td align="left">-0.05</td></tr><tr><td align="left">e</td><td align="left">0.00</td><td align="left">-0.01</td><td align="left">0.01</td><td align="left">-0.02</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">-0.16</td><td align="left">-0.02</td></tr><tr><td align="left">smooth</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left">0.01</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.03</td><td align="left">0.01</td><td align="left">0.03</td><td align="left">0.01</td></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.20</td><td align="left">0.10</td><td align="left">0.43</td><td align="left">0.02</td></tr><tr><td align="left">I(x &gt;e)</td><td align="left">0.13</td><td align="left">0.06</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.35</td><td align="left">0.03</td></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.15</td><td align="left">0.05</td><td align="left">0.22</td><td align="left">0.11</td><td align="left">-0.26</td><td align="left">-0.03</td></tr><tr><td align="left">e</td><td align="left">-0.02</td><td align="left">-0.01</td><td align="left">0.01</td><td align="left">-0.02</td><td align="left">0.03</td><td align="left">0.01</td><td align="left">-0.17</td><td align="left">-0.03</td></tr><tr><td align="left">first order</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left"/><td align="left"/><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.02</td><td align="left">0.00</td><td align="left"/><td align="left"/></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.24</td><td align="left">0.09</td><td align="left"/><td align="left"/></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.13</td><td align="left">0.05</td><td align="left">0.34</td><td align="left">0.11</td><td align="left"/><td align="left"/></tr><tr><td align="left">e</td><td align="left"/><td align="left"/><td align="left">-0.00</td><td align="left">-0.02</td><td align="left">0.04</td><td align="left">0.04</td><td align="left"/><td align="left"/></tr></tbody></table></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Monte Carlo interquartile range of coefficient and threshold estimates of three search strategies: grid search, smooth approximation, and first order approximation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">step</th><th align="left" colspan="2">hinge</th><th align="left" colspan="2">segmented</th><th align="left" colspan="2">stegmented</th></tr><tr><th align="left"><italic>n</italic></th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">500</th><th align="left">250</th><th align="left">2000</th></tr></thead><tbody><tr><td align="left">grid</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left">0.19</td><td align="left">0.14</td><td align="left">0.19</td><td align="left">0.14</td><td align="left">0.20</td><td align="left">0.15</td><td align="left">0.22</td><td align="left">0.07</td></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.40</td><td align="left">0.26</td><td align="left">0.68</td><td align="left">0.17</td></tr><tr><td align="left">I(x &gt;e)</td><td align="left">0.35</td><td align="left">0.24</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">3.15</td><td align="left">1.09</td></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.50</td><td align="left">0.31</td><td align="left">0.49</td><td align="left">0.31</td><td align="left">1.19</td><td align="left">0.24</td></tr><tr><td align="left">e</td><td align="left">0.31</td><td align="left">0.15</td><td align="left">0.69</td><td align="left">0.45</td><td align="left">1.00</td><td align="left">0.65</td><td align="left">1.47</td><td align="left">0.57</td></tr><tr><td align="left">smooth</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left">0.19</td><td align="left">0.13</td><td align="left">0.19</td><td align="left">0.14</td><td align="left">0.21</td><td align="left">0.15</td><td align="left">0.22</td><td align="left">0.07</td></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.40</td><td align="left">0.26</td><td align="left">0.63</td><td align="left">0.16</td></tr><tr><td align="left">I(x &gt;e)</td><td align="left">0.35</td><td align="left">0.24</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">2.84</td><td align="left">0.97</td></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.49</td><td align="left">0.31</td><td align="left">0.49</td><td align="left">0.31</td><td align="left">1.14</td><td align="left">0.25</td></tr><tr><td align="left">e</td><td align="left">0.29</td><td align="left">0.13</td><td align="left">0.69</td><td align="left">0.45</td><td align="left">0.99</td><td align="left">0.64</td><td align="left">1.47</td><td align="left">0.54</td></tr><tr><td align="left">first order</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">z</td><td align="left"/><td align="left"/><td align="left">0.20</td><td align="left">0.14</td><td align="left">0.20</td><td align="left">0.15</td><td align="left"/><td align="left"/></tr><tr><td align="left">x</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.41</td><td align="left">0.26</td><td align="left"/><td align="left"/></tr><tr><td align="left">(<italic>x</italic>−<italic>e</italic>)<sub>+</sub>
</td><td align="left"/><td align="left"/><td align="left">0.49</td><td align="left">0.31</td><td align="left">0.53</td><td align="left">0.31</td><td align="left"/><td align="left"/></tr><tr><td align="left">e</td><td align="left"/><td align="left"/><td align="left">0.67</td><td align="left">0.45</td><td align="left">1.05</td><td align="left">0.65</td><td align="left"/><td align="left"/></tr></tbody></table></table-wrap>
</p>
      <p>In Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref> we also include the first order approximation search method that is available from the <italic>segmented</italic> package. These results show that the parameter estimates using this method have a similar profile to the estimates from the grid search and smooth approximation methods. An exception is when n=250, the estimated slope parameter associated with (<italic>x</italic>−<italic>e</italic>)<sub>+</sub> in the segmented model is more biased by the first order approximation method, 0.34 versus 0.22 for grid search. To further compare their performance, we repeat this simulation study with a reduced magnitude of the slope parameter associated with (<italic>x</italic>−<italic>e</italic>)<sub>+</sub> (<italic>β</italic>
<sub>1</sub>=−0.51 instead of − 0.92). The results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table A.2 and A.3) show that the distance between the parameter estimates from the first order approximation and the grid search deviates increases dramatically, while the distance between the results from the smooth approximation and the grid search remains close.</p>
      <p>Table <xref rid="Tab3" ref-type="table">3</xref> shows the type 1 error rates of hypothesis testing. We choose a moderate sample size of 250 for illustration. For the step, hinge, and segmented models, both the maximal score test and the maximal likelihood ratio test have close to nominal level type 1 error rates. For the stegmented model, the maximal likelihood ratio test type 1 error rate is slightly elevated, and as <italic>p</italic>=2, there is not a univariate score test that is directly comparable to the other three models.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Type 1 error rates at sample size 250</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">step</th><th align="left">hinge</th><th align="left">segmented</th><th align="left">stegmented</th></tr></thead><tbody><tr><td align="left">LR</td><td align="left">0.055</td><td align="left">0.055</td><td align="left">0.058</td><td align="left">0.073</td></tr><tr><td align="left">score</td><td align="left">0.050</td><td align="left">0.047</td><td align="left">0.050</td><td align="left">–</td></tr></tbody></table></table-wrap>
</p>
      <p>Finally, we compare the speed of grid search versus approximation methods. The model fitting is done on a Linux machine with a Intel<sup>®;</sup> Xeon<sup>®;</sup> CPU E5-2690 clocked at 2.90GHz. We examine four different samples sizes from 250 to 2000. The results from averaging over 10 simulations are shown in Table <xref rid="Tab4" ref-type="table">4</xref>. For the smooth approximation method, model fitting for a dataset of 2000 rows takes less than one second, while for the exact method, model fitting for a dataset of 500 rows already takes more than one second. The performance of the first order approximation method also beats grid search but lags behind the smooth approximation method.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Time (sec) for fitting threshold regression models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="4">grid</th><th align="left"/><th align="left" colspan="4">smooth</th><th align="left"/><th align="left" colspan="4">first order</th></tr><tr><th align="left">n</th><th align="left">250</th><th align="left">500</th><th align="left">1000</th><th align="left">2000</th><th align="left"/><th align="left">250</th><th align="left">500</th><th align="left">1000</th><th align="left">2000</th><th align="left"/><th align="left">250</th><th align="left">500</th><th align="left">1000</th><th align="left">2000</th></tr></thead><tbody><tr><td align="left">step</td><td align="left">0.36</td><td align="left">1.00</td><td align="left">2.05</td><td align="left">3.72</td><td align="left"/><td align="left">0.12</td><td align="left">0.15</td><td align="left">0.25</td><td align="left">0.49</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">hinge</td><td align="left">0.37</td><td align="left">1.01</td><td align="left">2.09</td><td align="left">3.77</td><td align="left"/><td align="left">0.11</td><td align="left">0.15</td><td align="left">0.25</td><td align="left">0.49</td><td align="left"/><td align="left">0.30</td><td align="left">0.40</td><td align="left">0.60</td><td align="left">1.09</td></tr><tr><td align="left">segmented</td><td align="left">0.39</td><td align="left">1.07</td><td align="left">2.14</td><td align="left">3.97</td><td align="left"/><td align="left">0.12</td><td align="left">0.16</td><td align="left">0.27</td><td align="left">0.55</td><td align="left"/><td align="left">0.25</td><td align="left">0.38</td><td align="left">0.65</td><td align="left">1.34</td></tr><tr><td align="left">stegmented</td><td align="left">0.45</td><td align="left">1.25</td><td align="left">2.49</td><td align="left">5.06</td><td align="left"/><td align="left">0.15</td><td align="left">0.21</td><td align="left">0.35</td><td align="left">0.81</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec7">
      <title>Real data illustrations</title>
      <p>We illustrate the use of <italic>chngpt</italic> for fitting thresholded logistic regression models using a real data example from a study on the immunological biomarkers associated with the risk of Mother-To-Children Transmission (MTCT) of HIV-1 viruses [<xref ref-type="bibr" rid="CR1">1</xref>]. The study was performed using stored blood samples from a cohort of U.S. non-breastfeeding, HIV-1–infected mother–infant pairs enrolled in the pre-ARV era Women and Infants Transmission Study [<xref ref-type="bibr" rid="CR16">16</xref>]. Immunological assays were performed to measure antibody immune responses, including binding antibodies, neutralization antibodies, antibody avidity, and antibody-dependent cell-mediated cytotoxicity. The dataset includes 236 subjects, each corresponding to an infected mother; among them, 79 were transmitters and 157 are non-transmitters. For illustration, we consider the association between the transmission status and two covariates: <italic>birth</italic>, a categorical variable indicating the type of births, C-section or vaginal, and <italic>NAb_SF162LS</italic>, a continuous covariate giving the log titers of neutralization activities against a relatively easy to neutralize HIV-1 isolate named SF162LS.</p>
      <p>We fit the model using the exact search method, and a plot of the likelihood of the restricted regression model given a fixed change point versus the value of the change point is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>. Figure <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref> plots the predicted risk as a function of <italic>NAb_SF162LS</italic> from the fitted model for vaginal births. For comparison, the figure also shows the predicted risk from a spline model that models the effect of <italic>NAb_SF162LS</italic> with a natural cubic spline with two degrees of freedom. Both the spline and hinge model fits suggest that the relationship between transmission and <italic>NAb_SF162LS</italic> is nonlinear; the hinge model fit further suggests that <italic>NAb_SF162LS</italic> needs to be above 7.4 (95% robust confidence interval 5.5, 8.2) before it is associated with decreased risk of MTCT.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The HIV immune response and MTCT example. <bold>a</bold> Likelihoods of the restricted regression models with fixed change points versus candidate change points. <bold>b</bold> Predicted MTCT risks from a hinge model and a spline model</p></caption><graphic xlink:href="12859_2017_1863_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>To examine the classification performance of the hinge model, we perform Monte Carlo cross validation. We use 4/5 of the data to fit the model and a comparison model with <italic>birth</italic> only and use the rest of the data to evaluate classification performance of the models using the area under the ROC curve (AUC). Histograms of the AUC’s from 1000 repeats are shown in Additional file 1: Figure A.1. The median training and validation AUC of the <italic>birth</italic>-only model is 0.52 and 0.50, respectively; and the median training and validation AUC of the hinge model is 0.63 and 0.61, respectively. The Wilcoxon paired two-sample test comparing the validation AUC between the two models yield a p value of 2.2×10<sup>−16</sup>.</p>
      <p>A second example illustrating the use of <italic>chngpt</italic> for fitting thresholded linear regression models can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section B.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have developed an R package <italic>chngpt</italic> that supports four variants of threshold regression models that are most widely used in practice. The package implements both estimation and hypothesis testing functionalities based on a number of recent methodological advances [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. <italic>chngpt</italic> is an open source software and can be downloaded from the Comprehensive R Archive Network. A short tutorial on how to use the package is contained in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section B.</p>
    <p>Choosing among the four types of threshold models is an important and difficult question. We may divide this question into two parts: (i) whether a jump occurs at the threshold and (ii) whether the parameter space of the slope parameters should be restricted. The first question is especially challenging. For some processes, e.g. the occurrence of recombination events on a chromosome, it is natural to have jumps. For many others, the true underlying process may not be discontinuous; nonetheless, a discontinuous threshold model can be a useful approximation of a sudden shift in the response over a small span of the predictor values. To make this decision we recommend performing a test of the null hypothesis <italic>β</italic>
<sub>2</sub>=0 based on the stegmented model using a method from [<xref ref-type="bibr" rid="CR15">15</xref>]. For the second question, take the choice between the two continuous threshold models for example. The hinge model is nested within the segmented model, which may suggest that we always use the segmented model. However, as the simulation studies in [<xref ref-type="bibr" rid="CR17">17</xref>] show, for the same sample size the hinge model can be estimated with much greater accuracy than the segmented model. Thus, if applicable, the hinge model would be preferred over the segmented model. The decision to use the hinge model should be based on a combination of statistical evidence, e.g. fitting the segmented model and checking whether the model-robust confidence interval of <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\gamma }$\end{document}</tex-math><mml:math id="M38"><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq15.gif"/></alternatives></inline-formula> includes 0, and scientific consideration, e.g. if <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\gamma }&lt;0$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq16.gif"/></alternatives></inline-formula> and yet, the predictor is not expected to have an inverse association with outcome given the domain knowledge, then it is more compelling to choose the hinge model when the confidence interval of <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\gamma }$\end{document}</tex-math><mml:math id="M42"><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2017_1863_Article_IEq17.gif"/></alternatives></inline-formula> includes 0.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec9">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2017_1863_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary tables and a short tutorial on using <italic>chngpt</italic>. (PDF 63.5 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MTCT</term>
        <def>
          <p>Mother-To-Children Transmission</p>
        </def>
      </def-item>
      <def-item>
        <term>ARV</term>
        <def>
          <p>Antiretroviral drug</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s12859-017-1863-x) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We thank members of the CRAN team for testing and distributing the package. This work was supported by the National Institutes of Health (R01-AI122991; R01-GM106177; UM1-AI068635).</p>
    <sec id="d29e3108">
      <title>Availability of data and materials</title>
      <p>The real dataset used for illustration in this article is available as part of the R package chngpt, which can be downloaded from the Comprehensive R Archive Network at <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/chngpt">http://cran.r-project.org/web/packages/chngpt</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>YF designed the algorithms, wrote the program, comparatively benchmarked the different algorithms, and wrote the manuscript. YH and PBG provided technical expertise, helped design Monte Carlo studies, and revised the manuscript. SP provided biological expertise, helped interpret real data analysis results, and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e3124">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3129">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3134">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e3139">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Permar</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Vandergrift</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fouda</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaeger</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Pollara</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liebl</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Overman</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Whitaker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pritchett</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Solomon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Friberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Whitesides</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Gurley</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Holle</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Martinez</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Louzao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wilkes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sarzotti-Kelsoe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>HX</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alam</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Montefiori</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Denny</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Tomaras</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haynes</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>Maternal hiv-1 envelope–specific antibody responses and reduced risk of perinatal transmission</article-title>
        <source>J Clin Investig</source>
        <year>2015</year>
        <volume>125</volume>
        <issue>7</issue>
        <fpage>2702</fpage>
        <lpage>06</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI81593</pub-id>
        <?supplied-pmid 26053661?>
        <pub-id pub-id-type="pmid">26053661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <mixed-citation publication-type="other">Moodie Z, Juraska M, Huang Y, Zhuang Y, Fong Y, Self SG, Chambonneau L, Small R, Jackson N, Noriega F, Gilbert PB. Neutralizing antibody correlates analysis of tetravalent dengue vaccine efficacy trials in asia and latin america. 2016. University of Washington, Technical report.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pastor-Barriuso</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guallar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Coresh</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Transition models for change-point estimation in logistic regression</article-title>
        <source>Stat Med</source>
        <year>2003</year>
        <volume>22</volume>
        <issue>7</issue>
        <fpage>1141</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.1045</pub-id>
        <?supplied-pmid 12652559?>
        <pub-id pub-id-type="pmid">12652559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>AK</given-names>
          </name>
        </person-group>
        <source>Parametric Statistical Change Point Analysis: with Applications to Genetics, Medicine, and Finance</source>
        <year>2011</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer Science &amp; Business Media</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muggeo</surname>
            <given-names>VM</given-names>
          </name>
        </person-group>
        <article-title>Segmented: an r package to fit regression models with broken-line relationships</article-title>
        <source>R news</source>
        <year>2008</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>20</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wakefield</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Bayesian and Frequentist Regression Methods. Springer Series in Statistics Series</source>
        <year>2012</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <source>Generalized Additive Models. Chapman and Hall/CRC Monographs on Statistics and Applied Probability Series</source>
        <year>1990</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Chapman &amp; Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>PB</given-names>
          </name>
        </person-group>
        <article-title>Model-robust inference for continuous threshold regression models</article-title>
        <source>Biometrics</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>2</issue>
        <fpage>452</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12623</pub-id>
        <?supplied-pmid 27858965?>
        <pub-id pub-id-type="pmid">27858965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muggeo</surname>
            <given-names>VM</given-names>
          </name>
        </person-group>
        <article-title>Testing with a nuisance parameter present only under the alternative: a score-based approach with application to segmented modelling</article-title>
        <source>J Stat Comput Simul</source>
        <year>2016</year>
        <volume>86</volume>
        <issue>15</issue>
        <fpage>3059</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1080/00949655.2016.1149855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Di</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Permar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Change point testing in logistic regression models with interaction term</article-title>
        <source>Stat Med</source>
        <year>2015</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1483</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.6419</pub-id>
        <?supplied-pmid 25612253?>
        <pub-id pub-id-type="pmid">25612253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muggeo</surname>
            <given-names>VMR</given-names>
          </name>
        </person-group>
        <article-title>Estimating regression models with unknown break-points</article-title>
        <source>Stat Med</source>
        <year>2003</year>
        <volume>22</volume>
        <issue>19</issue>
        <fpage>3055</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.1545</pub-id>
        <?supplied-pmid 12973787?>
        <pub-id pub-id-type="pmid">12973787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>KY</given-names>
          </name>
        </person-group>
        <article-title>On estimating the change point in generalized linear models</article-title>
        <source>IMS Collections Beyond Parametrics in Interdisciplinary Research: Festschrift in Honor of Professor Pranab K. Sen</source>
        <year>2008</year>
        <volume>1</volume>
        <fpage>305</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Tsay</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Limiting properties of the least squares estimator of a continuous threshold autoregressive model</article-title>
        <source>Biometrika</source>
        <year>1998</year>
        <volume>85</volume>
        <issue>2</issue>
        <fpage>413</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/85.2.413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Sample splitting and threshold estimation</article-title>
        <source>Econometrica</source>
        <year>2000</year>
        <volume>68</volume>
        <issue>3</issue>
        <fpage>575</fpage>
        <lpage>603</lpage>
        <pub-id pub-id-type="doi">10.1111/1468-0262.00124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banerjee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McKeague</surname>
            <given-names>IW</given-names>
          </name>
        </person-group>
        <article-title>Confidence sets for split points in decision trees</article-title>
        <source>Ann Stat</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>543</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1214/009053606000001415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rich</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Mofenson</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Abboud</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pitt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mendez</surname>
            <given-names>H</given-names>
          </name>
          <collab>for the Women</collab>
          <name>
            <surname>Group</surname>
            <given-names>ITS</given-names>
          </name>
        </person-group>
        <article-title>Maternal and infant factors predicting disease progression in human immunodeficiency virus type 1-infected infants</article-title>
        <source>Pediatrics</source>
        <year>2000</year>
        <volume>105</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1542/peds.105.1.e8</pub-id>
        <pub-id pub-id-type="pmid">10617697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>PB</given-names>
          </name>
        </person-group>
        <article-title>Model-robust inference for continuous threshold regression models</article-title>
        <source>Biometrics</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>2</issue>
        <fpage>452</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12623</pub-id>
        <?supplied-pmid 27858965?>
        <pub-id pub-id-type="pmid">27858965</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
