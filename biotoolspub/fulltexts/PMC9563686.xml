<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9563686</article-id>
    <article-id pub-id-type="pmid">36063052</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac603</article-id>
    <article-id pub-id-type="publisher-id">btac603</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ABEILLE: a novel method for ABerrant Expression Identification empLoying machine LEarning from RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Labory</surname>
          <given-names>Justine</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Center of Modeling, Simulation and Interactions</institution>, Nice 06000, <country country="FR">France</country></aff>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
        <xref rid="btac603-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Le Bideau</surname>
          <given-names>Gwendal</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
        <xref rid="btac603-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pratella</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Center of Modeling, Simulation and Interactions</institution>, Nice 06000, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yao</surname>
          <given-names>Jean-Elisée</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Center of Modeling, Simulation and Interactions</institution>, Nice 06000, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ait-El-Mkadem Saadi</surname>
          <given-names>Samira</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bannwarth</surname>
          <given-names>Sylvie</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>El-Hami</surname>
          <given-names>Loubna</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Center of Modeling, Simulation and Interactions</institution>, Nice 06000, <country country="FR">France</country></aff>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paquis-Fluckinger</surname>
          <given-names>Véronique</given-names>
        </name>
        <aff><institution>Université Côte d’Azur, Inserm U1081, CNRS UMR 7284, Institute for Research on Cancer and Aging, Nice (IRCAN), Centre Hospitalier Universitaire (CHU) de Nice</institution>, Nice 06200, <country country="FR">France</country></aff>
        <xref rid="btac603-FM2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0605-4646</contrib-id>
        <name>
          <surname>Bottini</surname>
          <given-names>Silvia</given-names>
        </name>
        <!--silvia.bottini@univ-cotedazur.fr-->
        <aff><institution>Université Côte d’Azur, Center of Modeling, Simulation and Interactions</institution>, Nice 06000, <country country="FR">France</country></aff>
        <xref rid="btac603-cor1" ref-type="corresp"/>
        <xref rid="btac603-FM2" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btac603-FM1">
        <label>†</label>
        <p>The authors wish it to be known that, in their opinion, Justine Labory and Gwendal Le Bideau should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btac603-FM2">
        <label>‡</label>
        <p>The authors wish it to be known that, in their opinion, Véronique Paquis-Fluckinger and Silvia Bottini should be regarded as Joint Last Authors.</p>
      </fn>
      <corresp id="btac603-cor1">To whom correspondence should be addressed. <email>silvia.bottini@univ-cotedazur.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-09-05">
      <day>05</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>20</issue>
    <fpage>4754</fpage>
    <lpage>4761</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac603.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Current advances in omics technologies are paving the diagnosis of rare diseases proposing a complementary assay to identify the responsible gene. The use of transcriptomic data to identify aberrant gene expression (AGE) has demonstrated to yield potential pathogenic events. However, popular approaches for AGE identification are limited by the use of statistical tests that imply the choice of arbitrary cut-off for significance assessment and the availability of several replicates not always possible in clinical contexts.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Hence, we developed ABerrant Expression Identification empLoying machine LEarning from sequencing data (ABEILLE) a variational autoencoder (VAE)-based method for the identification of AGEs from the analysis of RNA-seq data without the need for replicates or a control group. ABEILLE combines the use of a VAE, able to model any data without specific assumptions on their distribution, and a decision tree to classify genes as AGE or non-AGE. An anomaly score is associated with each gene in order to stratify AGE by the severity of aberration. We tested ABEILLE on a semi-synthetic and an experimental dataset demonstrating the importance of the flexibility of the VAE configuration to identify potential pathogenic candidates.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>ABEILLE source code is freely available at: <ext-link xlink:href="https://github.com/UCA-MSI/ABEILLE" ext-link-type="uri">https://github.com/UCA-MSI/ABEILLE</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UCA JEDI Investments in the Future project managed by the National Research Agency (ANR)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-15-IDEX-01</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Omics technologies have revolutionized the world of biology and medicine tailoring the way to next-generation healthcare. The advent of whole-exome sequencing (WES) and whole-genome sequencing (WGS) has greatly accelerated the identification of variants in previously unknown rare disease genes (<xref rid="btac603-B26" ref-type="bibr">Wortmann <italic toggle="yes">et al.</italic>, 2015</xref>). Although these technologies are mainstays in Mendelian disease diagnosis, their success rate for detecting causal variants is far from complete, ranging from 25 to 50% (<xref rid="btac603-B24" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic>, 2015</xref>). Several variants remain as variants of unknown significance (VUS) or they are missed due to the inability to prioritize them. Recently the employ of RNA sequencing (RNA-seq) has been proposed (<xref rid="btac603-B5" ref-type="bibr">Byron <italic toggle="yes">et al.</italic>, 2016</xref>). This technology provides a direct probing of RNA abundance and sequence of both coding and non-coding genome, including allele-specific expression and splice isoforms (<xref rid="btac603-B25" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2009</xref>). Despite the very promising premises of RNA-seq to detect new variants, the pioneering works using this technique improved the diagnostic power by only 10% (<xref rid="btac603-B6" ref-type="bibr">Cummings <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac603-B7" ref-type="bibr">Frésard <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac603-B8" ref-type="bibr">Gonorazky <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac603-B12" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac603-B16" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2020</xref>). Transcriptome analysis facilitates genome-wide interpretation of DNA variants, specifically three aberrant events can be analyzed: aberrant expression, aberrant splicing, allelic imbalance, or allele-specific expression. Currently, some improvements have been achieved in the identification of aberrant splicing events and allele-specific expression thanks to the development of novel tools designed for rare diseases such as FRASER (<xref rid="btac603-B19" ref-type="bibr">Mertes <italic toggle="yes">et al.</italic>, 2021</xref>), LeafCutterMD (<xref rid="btac603-B9" ref-type="bibr">Jenkinson <italic toggle="yes">et al.</italic>, 2020</xref>) and ANEVA-DOT (<xref rid="btac603-B20" ref-type="bibr">Mohammadi <italic toggle="yes">et al.</italic>, 2019</xref>). On the other hand, the identification of aberrant gene expression (AGE) in this context requires a paradigm shift toward a novel way to analyze gene expression data. Usually, to identify AGE, a comparison of gene expression levels between two groups of individuals with different conditions such as healthy/diseased, exposed/unexposed to treatment, or others, is carried out. The significance of the results is measured by statistical tests whose statistical power decreases if the two groups are made up of too few individuals (<xref rid="btac603-B10" ref-type="bibr">Khang and Lau, 2015</xref>). This approach is not adapted in the context of rare diseases. By definition, rare diseases concern only a very small number of subjects, thus the availability of large cohorts is uncommon. Most importantly, very often, replicates for the same individual are not available in a such clinical context. Furthermore, the disposal of a control group, such as healthy individuals, is often limited. Moreover, the heterogeneity of these pathologies is very high, which means that the same disease present in several patients will not be due to the same responsible genes. Consequently, these individuals cannot be combined to constitute the diseased group. Finally, Li <italic toggle="yes">et al.</italic>, they showed that most of the popular methods for detecting differentially expressed genes, identify an elevated number of false positives (<xref rid="btac603-B17" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2022</xref>). Therefore, classical statistical methods cannot be used for the detection of AGEs in the context of rare diseases. Two approaches have been proposed to fulfill these needs. OUTRIDER (<xref rid="btac603-B3" ref-type="bibr">Brechtmann <italic toggle="yes">et al.</italic>, 2018</xref>), which combines an autoencoder and a statistical test to identify AGE, and OutPyR (<xref rid="btac603-B23" ref-type="bibr">Salkovic <italic toggle="yes">et al.</italic>, 2020</xref>) which uses a Bayesian model. Although OUTRIDER showed good results on the Kremer <italic toggle="yes">et al.</italic> dataset, its performance relies on considerable sample size (more than 60 samples) not always possible in the context of rare diseases. OutPyR showed good performances in reporting injected AGE on small sample size but the number of total AGE identified was very high leading to a high number of false positives. Consequently, there is an urgent burning to develop novel computational approaches to resolve the diagnostic deadlock and improve our knowledge of rare disorders (<xref rid="btac603-B14" ref-type="bibr">Labory <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac603-B21" ref-type="bibr">Rahman and Rahman, 2018</xref>). Here, we describe ABEILLE, (ABerrant Expression Identification empLoying machine LEarning from sequencing data) a VAE-based method for the identification of AGE from RNA-seq data without the need for replicates and without assumption on the distribution, using a flexible model obtained after testing several parameters. We compare its performances to the state-of-the-art alternatives, OUTRIDER (<xref rid="btac603-B3" ref-type="bibr">Brechtmann <italic toggle="yes">et al.</italic>, 2018</xref>) and OutPyR (<xref rid="btac603-B23" ref-type="bibr">Salkovic <italic toggle="yes">et al.</italic>, 2020</xref>), using semi-synthetic data and a real dataset.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets</title>
      <p><bold>Rare-disease cohort from Kremer <italic toggle="yes">et al</italic></bold>. The RNA-seq raw read counts for this cohort were downloaded from <xref rid="sup1" ref-type="supplementary-material">Supplementary Data S1</xref> (<xref rid="btac603-B12" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>). The cohort is composed of 119 patients with suspected mitochondrial disease in diagnostic stalemate for which RNA has been extracted from fibroblasts and sequenced.</p>
      <p><bold>Small datasets</bold>. We used the Kremer <italic toggle="yes">et al.</italic> dataset and we created six smaller sub-datasets of size 110, 90, 60, 30, 20, and 10 samples, respectively, composed of the 6 patients with validated AGE (MUC1344, MUC1365, MUC1396, MUC1404, MUC1350, and MUC1361) and the complementary number of patients to arrive to the desired dataset size. For each size, we created 10 datasets randomly selecting the patients without the validated AGE. We then run the two tools ABEILLE and OUTRIDER and we measured how many times they were able to identify any combination of the six AGEs depending on the size of the dataset.</p>
      <p><bold>GTEx cohort</bold>. The Genotype-Tissue Expression (GTEx) project (Consortium, 2015) is a public database of WGS, WES, and RNA-seq data collected <italic toggle="yes">post-mortem</italic> from 54 non-diseased tissue sites across nearly 1000 individuals. We randomly selected samples from the GTEx database to build the semi-synthetics datasets. We also filtered out samples with RIN &lt; 6 (RNA Integrity Number).</p>
      <p><bold>Semi-synthetic datasets</bold>. Due to the absence of a gold standard real dataset with known AGE, we decided to use a computational strategy to inject AGE in the GTEx cohort. We implemented the same strategy as described in the study of <xref rid="btac603-B3" ref-type="bibr">Brechtmann <italic toggle="yes">et al.</italic> (2018)</xref>. Briefly, raw read counts in the original dataset were replaced by:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">round</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup><mml:mo>±</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p>With <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, the generated count for gene <italic toggle="yes">j</italic> and sample <italic toggle="yes">i</italic> to substitute to the original value, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the size number, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> the mean of u across the gene <italic toggle="yes">j</italic>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> the standard deviation and as described in (<xref rid="btac603-B3" ref-type="bibr">Brechtmann <italic toggle="yes">et al.</italic>, 2018</xref>), <italic toggle="yes">N</italic> is the amplitude of the corrupted count [a random value drawn in a normal distribution characterized by a mean of log(3) and a standard deviation of log(1.6)]. AGEs are injected randomly with probability 10<sup>−6</sup>, 10<sup>−5</sup> or 10<sup>−4</sup> resulting in different percentages of injected AGEs (0.001‰, 0.01‰ or 0.1‰ respectively) in samples randomly selected from the GTEx database. We created 18 semi-synthetic datasets composed of 50, 75, 125, 250, 500 and 1000 samples with AGE injected with the three different probabilities. For a complete summary of the semi-synthetic dataset characteristics see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.2 Algorithm</title>
      <p>ABEILLE is a computational framework to identify AGEs (<xref rid="btac603-F1" ref-type="fig">Fig. 1</xref>). It is composed of two phases: a supervised phase to identify parameters intervals of aberration and an unsupervised one to identify AGEs.</p>
      <fig position="float" id="btac603-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>The workflow of ABEILLE to identify AGE. It is comprised of two phases: (<bold>A</bold>) a supervised phase to identify parameters intervals of aberration and (<bold>B</bold>) an unsupervised one to identify AGE. (A) We feed the VAE with the semi-synthetic dataset (I_expr) and let the model generate the reconstructed counts (R_expr) (A-I). AGEs present in the original dataset represent a perturbation to the data distribution. The integrity of reconstructed values by the VAE is compromised for AGEs. Thus, comparing I_expr and R_expr should lead the identification of AGEs (A-II left). To enhance the comparison and evaluate the reconstruction fidelity, we established two novel metrics: the divergence score and the delta count (A-II right). For each gene, the divergence score and delta count are plotted for each patient composing the cohort. We thus apply a linear regression model and calculate parameters associated to this model to evaluate its position on the plot and its reconstruction fidelity (A-III). These parameters were used to feed a decision tree using the CART algorithm. The obtained decision tree is showed in A-IV. This decision tree gives the intervals of the regression parameters to classify gene expression as AGE or NGE. (B) The first step is to run the VAE and the linear regression model on unlabeled dataset in order to calculate the regression parameters on the values of divergence score and delta count obtained by comparing I_expr and R_expr (B-I and B-II). The procedure is the same as described for the supervised phase. The obtained regression parameters on the unlabeled dataset are compared to the intervals obtained with <italic toggle="yes">ABEILLE decision tree</italic> during the supervised phase. This allow to classify gene expression as AGE or NGE based on the regression parameters (B-III). An isolation forest approach is used to calculate the anomaly score to be associated to AGEs (B-IV)</p>
        </caption>
        <graphic xlink:href="btac603f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Supervised phase</title>
        <p>The purpose of this phase is to determine the thresholds of parameters implemented in ABEILLE model to discriminate AGEs respect to normal gene expression (NGE). For this phase, we use two modules: <italic toggle="yes">ABEILLE main</italic> and <italic toggle="yes">ABEILLE decision tree.</italic> Hence, a labeled dataset with known AGEs must be used. In absence of that, as it is the case for us, a semi-synthetic dataset can be built. AGEs can be simulated as described in <xref rid="btac603-B3" ref-type="bibr">Brechtmann <italic toggle="yes">et al.</italic> (2018)</xref> and described in the paragraph ‘Datasets’.</p>
        <p><bold>ABEILLE main</bold>. The core of ABEILLE is composed by a VAE followed by a linear regression model.</p>
        <p>VAEs are generative models, which means they learn to approximate a data generating distribution. Through approximation and compression, these models have been shown to capture an underlying data manifold (a constrained, lower-dimensional space where data is distributed) and disentangle sources of variation from different classes of data.</p>
        <p>The variational auto-encoder was built with Tensorflow (<xref rid="btac603-B1" ref-type="bibr">Martín Abadi <italic toggle="yes">et al.</italic>, 2015</xref>). The VAE is composed of the input and the output, four hidden layers in the encoder and in the decoder, and the special latent space of a VAE. The sampling process and the lost function of the VAE is from the Kingma <italic toggle="yes">et al.</italic> study (<xref rid="btac603-B11" ref-type="bibr">Kingma and Welling, 2014</xref>). Each layer of the encoder or decoder is composed of the dense layer followed by a batch normalization and the ELU activation function. More details on the VAE configuration are in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
        <p>We feed the VAE with the semi-synthetic dataset (I_expr) and let the model generate the reconstructed counts (R_expr) (<xref rid="btac603-F1" ref-type="fig">Fig. 1A-I</xref>). AGEs present in the original dataset represent a perturbation to the data distribution. The integrity of reconstructed values by the VAE is compromised for AGEs. Thus, comparing I_expr and R_expr should lead the identification of AGEs (<xref rid="btac603-F1" ref-type="fig">Fig. 1A-II left</xref>). To enhance the comparison and evaluate the reconstruction fidelity, we established two novel metrics: the divergence score and the delta count (<xref rid="btac603-F1" ref-type="fig">Fig. 1A-II right</xref>). The divergence score <italic toggle="yes">D</italic>. It measures the divergence between the reconstructed values for each gene by the VAE and the original values. We define the divergence score as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula></p>
        <p>Where <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the original raw count for gene <italic toggle="yes">j</italic> and sample <italic toggle="yes">i</italic>, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the reconstructed count for gene <italic toggle="yes">j</italic> and sample <italic toggle="yes">i</italic>, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:math></inline-formula> is the mean of <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across all the patients and where <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:math></inline-formula> is the standard of deviation of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> across all the patients.</p>
        <p>The delta count Δ, that we define here as:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mfenced separators="|"><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the reconstructed count for gene <italic toggle="yes">j</italic> and sample <italic toggle="yes">i</italic>, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mo>μ</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>is the mean of the original counts for gene <italic toggle="yes">j</italic>.</p>
        <p>For each gene, the divergence score and delta count are plotted for each patient composing the cohort: we expect the points to be agglomerated very close to each other in case of NGE (high reconstruction fidelity) while to see point(s) further from the main agglomeration in case of AGE (low reconstruction fidelity). We thus apply a linear regression model and calculate parameters associated to this model to evaluate its position on the plot and its reconstruction fidelity. These parameters are:</p>
        <list list-type="bullet">
          <list-item>
            <p><italic toggle="yes">Typeerror</italic>, the standard residues is the distance between the predicted value on the linear regression and the real value.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">Dfbetas</italic>, are statistics that indicate the effect that deleting each one observation has on the estimates of the regression coefficients associated with the gene.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">Hat</italic>, projection matrix where the value of the diagonal corresponds to leverages. The leverages describe the influence that each response value has on the fitted value for that same observation.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">CooksD</italic>, Cook’s distance is defined as the sum of all the changes in the regression model when observation i is removed from it.</p>
          </list-item>
        </list>
        <p><bold>ABEILLE decision tree.</bold> To avoid to set threshold for the parameters calculated on the linear regression to define the AGE, we used a decision tree approach. Regression parameters calculated on the semi-synthetic datasets were used to feed a decision tree using the CART algorithm (<xref rid="btac603-F1" ref-type="fig">Fig. 1A-III</xref>). The obtained decision tree is showed in <xref rid="btac603-F1" ref-type="fig">Figure 1A-IV</xref>. This decision tree gives the intervals of the regression parameters to classify gene expression as AGE or NGE. Once calculated, these intervals can be used on unlabeled datasets to classify gene expression by comparing reconstructed counts by the VAE with the input gene counts through the linear regression model.</p>
      </sec>
      <sec>
        <title>2.2.2 Unsupervised phase</title>
        <p>This phase can be run once obtained the aberration intervals through the supervised phase. Alternatively, the aberration intervals found in this study can be used without re-running the supervised phase. The unsupervised phase allows to classify gene expression on unlabeled datasets.</p>
        <p><bold>ABEILLE main</bold>. The first step is to run the VAE and the linear regression model on unlabeled dataset in order to calculate the regression parameters on the values of divergence score and delta count obtained by comparing I_expr and R_expr (<xref rid="btac603-F1" ref-type="fig">Fig. 1B-I and II</xref>). The procedure is the same as described for the supervised phase.</p>
        <p><bold>ABEILLE identify</bold>. The decision tree calculated in the supervised phase lead us the intervals of regression parameters to classify gene expression as AGE or NGE. During this step, the regression parameters calculated by <italic toggle="yes">ABEILLE main</italic> on the unlabeled dataset are compared with the intervals obtained with <italic toggle="yes">ABEILLE decision tree</italic>. This allows to classify gene expression as AGE or NGE based on the regression parameters.</p>
        <p><bold>ABEILLE anomaly score</bold>. Since ABEILLE is not a statistical method, classical calculation of <italic toggle="yes">P</italic>-value is not applicable. Thus, to score the predicted AGE, we employed an isolation forest approach. Just like the random forests, isolation forests are built using decision trees. They are implemented in an unsupervised fashion as there are no pre-defined labels. Isolation forests were designed with the idea that anomalies are ‘few and distinct’ data points in a dataset. Each observation, i.e. a pair of divergence score—delta count, is given an anomaly score. The closer the score is to 1 the higher is the anomaly. We run this approach on each plot of divergence score and delta count for each gene (<xref rid="btac603-F1" ref-type="fig">Fig. 1B-IV</xref>) and we retrieve the anomaly scores for predicted AGE from <italic toggle="yes">ABEILLE identify</italic>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Benchmark of AGE detection methods</title>
      <p>We compared the performances of ABEILLE, OUTRIDER and OutPyR. OUTRIDER and OutPyR were used with their respective default parameters. We calculated precision, recall and F1 score on semi-synthetic data by counting the number of AGE injected and identified and the AGE injected but not identified with the total number of AGE identified or AGE injected. Precision-recall curves were built by ranking identified AGE by <italic toggle="yes">P</italic>-value or Z-score for OUTRIDER and by divergence score or delta count for ABEILLE.</p>
    </sec>
    <sec>
      <title>2.4 Functional analysis</title>
      <p>To identify enriched terms in AGEs found in the Kremer dataset by ABEILLE, OUTRIDER and the case-control approach used in the original study, we used the R package enrichR (<xref rid="btac603-B13" ref-type="bibr">Kuleshov <italic toggle="yes">et al.</italic>, 2016</xref>). EnrichR interrogates 10 gene-set libraries and finds enriched terms using a hypergeometric test. Results are reported only for significant enrichment (<italic toggle="yes">P</italic>-value &lt; 0.05).</p>
    </sec>
    <sec>
      <title>2.5 Exploring ABEILLE VAE features</title>
      <p>We developed a Shiny app to allow exploration of ABEILLE encoded feature dimensions with covariate information. The app is available at <ext-link xlink:href="https://jlabory.shinyapps.io/ABEILLE-main/" ext-link-type="uri">https://jlabory.shinyapps.io/ABEILLE-main/</ext-link>.</p>
    </sec>
    <sec>
      <title>2.6 Implementation</title>
      <p>ABEILLE is implemented in Python and R. The use of the VAE allowing the reconstruction of the data can be done in two different ways, either using the script abeille.py in a standalone way, or by importing the python function through the framework in R, the totality of the remaining steps working in R. Once the data is reconstructed, it is enough to import them in R and then to compute the parameters of divergence score and delta count. The IdentifyAGE function will then retrieve these parameters as well as the original data and the reconstructed data in order to select the AGEs.</p>
      <p>OUTRIDER is an R package available on Bioconductor. It can be used in two different ways: either by using the OUTRIDER function which allows to launch the whole analysis or by proceeding step by step. To start the analyses, you must first filter out the unexpressed genes using the filterExpression function. The next step is to fit the count data to a negative binomial distribution, and then calculate the <italic toggle="yes">P</italic>-values. Finally, the last step of the pipeline consists in calculating the Z-scores.</p>
      <p>OutPyR is fully implemented in Python. It uses a Bayesian model to identify AGEs. OutPyR takes as input an expression matrix in raw counts. Unlike ABEILLE and OUTRIDER, there is no filtering step to remove low expressed genes. OutPyR computes a <italic toggle="yes">P</italic>-value for each couple of gene-patient and returns a matrix of <italic toggle="yes">P</italic>-values. We retained AGEs if the <italic toggle="yes">P</italic>-values is less than or equal to 0.05.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 ABEILLE VAE features capture biological signals</title>
      <p>First, we tested the ABEILLE VAE on the Kremer dataset. The ABEILLE VAE compressed the patients into a lower-dimensional space, the latent space, composed by 128 features dimension. The goal was to evaluate ABEILLE on its ability to learn biological signals in the data. Since ABEILLE VAE works in unsupervised fashion, the compressed features dimension encoded in the latent space can represent known or unknown biological patterns. Therefore, we investigated whether or not ABEILLE could distinguish the biological characteristics available for this cohort: the patient sex and the batch group. Feature dimension 118 nearly perfectly separates samples by sex (<xref rid="btac603-F2" ref-type="fig">Fig. 2A</xref>) and feature dimension 110 by batch group (<xref rid="btac603-F2" ref-type="fig">Fig. 2B</xref>) indicating that ABEILLE VAE model patient sex and bath group robustly. We then explored all the 128 features dimension of the latent space (<xref rid="btac603-F2" ref-type="fig">Fig. 2C</xref>). The heatmap shows that features are non-redundant and highly heterogeneous. Based on the hierarchical clustering dendrogram, we can see that these features capture distinct signals: for instance, hox group are large signals present in these data (<xref rid="btac603-B12" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>) but they are uniformly distributed in the dendrogram indicating non-redundant features activations. Overall, these observations showed the ability of the ABEILLE VAE to model gene expression data of patients through the identification of features dimensions that encode for biological patterns.</p>
      <fig position="float" id="btac603-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>ABEILLE VAE features captures biological signals. (<bold>A</bold>) Encoding dimensions 10 and 1 stratify patients batch group. (<bold>B</bold>) Encoding dimension 118 separates patients by sex. (<bold>C</bold>) Full ABEILLE encoding dimensions by Kremer sample heatmap. Patients on the <italic toggle="yes">y</italic> axis, biological features on the <italic toggle="yes">x</italic> axis according to the legend in the plot</p>
        </caption>
        <graphic xlink:href="btac603f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Divergence score, delta count and anomaly score: three novel metrics to identify AGE</title>
      <p>VAE are well-established generative models with the ability to reconstruct original data with high fidelity (<xref rid="btac603-B11" ref-type="bibr">Kingma and Welling, 2014</xref>). Since AGE represents a perturbation to the gene raw count distribution, the integrity of the reconstruction is compromised for AGEs. Thus, the comparison of the original and reconstructed counts allows the identification of AGEs. The divergence score and delta count are two novel metrics introduced here to evaluate the reconstruction fidelity of the original gene expression counts by the VAE model. Once AGEs are identified, they are scored by an isolation tree approach that allows to calculate the anomaly score: the closer this score is to 1, the more severe is the aberration.</p>
      <p>We tested these three scores on the Kremer dataset. After using ABEILLE to identify AGEs, we plotted the divergence score, delta count and anomaly score for the top and the bottom five AGEs sorted by anomaly score as well as five randomly chosen NGE (<xref rid="btac603-F3" ref-type="fig">Fig. 3</xref>). We can observe that the divergence score and delta count allow to easily identify AGE as the point far from the main points distribution. Similarly, by comparing the distance of the AGE from the rest of the distribution of the top five compared with the bottom five, we can see the importance of the anomaly score to sort the aberration.</p>
      <fig position="float" id="btac603-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>The three novel parameters defined in ABEILLE: the divergence score, the delta count and the Aberrant Score. Measure of the divergence score versus delta count (first row) and divergence score versus anomaly score (second row) (<bold>A</bold>) representing the top five AGEs and (<bold>B</bold>) the bottom five AGEs found by ABEILLE in the Kremer dataset sorted by anomaly score; (<bold>C</bold>) five randomly selected genes where no aberrant expression was found in any patient of the cohort. The red point represents the AGE with the patient identifier indicated closer to the point and black point the NGE</p>
        </caption>
        <graphic xlink:href="btac603f3" position="float"/>
      </fig>
      <p>Then we focused on the experimentally validated pathogenic candidates in the original publication. These genes have different sources of aberration in specific patients: MGST1 was identified by AGE in patient MUC1396, TIMMDC1 was identified by AGE and aberrant splicing in two patients MUC1344 and MUC1365, MCOLN1 in patient MUC1361 was identified by AGE although with a signal slightly inferior of the thresholds of significance for <italic toggle="yes">Z</italic>-score and <italic toggle="yes">P</italic>-values set by the authors, ALDH18A1 was identified by aberrant splicing with AGE at the limit of thresholds for patient MUC1404, finally in patient MUC1350, CLPP was identified by allele specific-expression only without any consequences on the expression level. ABEILLE correctly identified as AGE the genes MGST1 and TIMMDC1 but could not identify ALDH18A1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). However, this gene mainly shows aberrant splicing, that is not calculated by ABEILLE. The gene MCOLN1, as well as in the original publication, can be retrieved as AGE if thresh-olds are relaxed allowing to include this gene. Finally, CLPP was not identified as AGE as expected, because, as well as in the original study, this gene was not identified as AGE but only having allele specific-expression. Overall, ABEILLE could retrieve the AGE for the pathogenic candidates identified by Kremer with exception of ALDH18A1.</p>
      <p>Altogether these analyses demonstrated that the divergence score, delta count and anomaly score are valid parameters to identify AGE.</p>
    </sec>
    <sec>
      <title>3.3 AGE detection on a real dataset</title>
      <p>We studied the performance of the three tools, ABEILLE, OUTRIDER and OutPyR to detect AGEs on real data from <xref rid="btac603-B12" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic> (2017)</xref> and we compared with the classical case-control analysis performed with DESeq2 by the original study. We found that OutPyR identified a number of AGEs considerably higher than the other approaches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
      <p>Then we calculated the number of AGE per patient (<xref rid="btac603-F4" ref-type="fig">Fig. 4A</xref>) and we can observe that the minimal number of AGE per patient identified by OutPyR is 10696. OutPyR violates the definition of AGE in rare diseases where we expect very few AGEs for each patient. These observations rule out OutPyR as a tool for AGE identification in this context.</p>
      <fig position="float" id="btac603-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Benchmark of ABEILLE, OUTRIDER and OutPyR on real data. (<bold>A</bold>) The number of AGEs per patient is reported sorted in descending order for ABEILLE, OUTRIDER and Kremer, in ascending order for OutPyR. (<bold>B</bold>) Venn diagram representing the number of AGEs shared by ABEILLE, OUTRIDER and Kremer. (<bold>C</bold>) Mosaic plot showing the proportion of AGEs shared by ABEILLE and Kremer or OUTRIDER and Kremer with respect to not shared AGEs. (<bold>D</bold>) Summary of the functional analysis results performed on AGEs identified by the 3 approaches on 11 ontologies regarding terms related to mitochondrial biology and diseases. (<bold>E</bold>) Performances of ABEILLE and OUTRIDER on small datasets</p>
        </caption>
        <graphic xlink:href="btac603f4" position="float"/>
      </fig>
      <p>We compared the number of AGEs found by OUTRIDER and ABEILLE with the AGE detected in the original study (<xref rid="btac603-F4" ref-type="fig">Fig. 4B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). ABEILLE identified a higher proportion of AGEs in common with Kremer <italic toggle="yes">et al.</italic> respect to OUTRIDER (<italic toggle="yes">P</italic>-value 5.289e-07, fisher test; <xref rid="btac603-F4" ref-type="fig">Fig. 4C</xref>): 48% of AGE detected by ABEILLE are in common with the original study, while only 19% for OUTRIDER. Very few AGEs identified are common to ABEILLE and OUTRIDER, meaning that the two tools target different AGE populations. Consequently, when we study the intersection of the AGE found by the two tools with those identified in the original publication, we observe little overlap.</p>
      <p>We noticed that in the original Kremer study, the number of AGE identified for one patient, MUC1372, is considerably high: 493 out of 615 for the entire cohort. Interestingly, ABEILLE found 70 AGEs for this patient, that is, the maximal number of AGE per patient reported by this tool, while OUTRIDER did not find any AGE for the same patient. Although further information about the patient and the data processing would be necessary, our hypothesis is that OUTRIDER autoencoder is too stringent thus all patterns in the data are canceled, on the other hand the case-control approach overestimates the number of AGEs by comparing each patient with all other of the cohort. In conclusion, ABEILLE seems to offer the best balance of cofounder controlling without suppression of hidden biological patterns in the data. This observation highlights the limitation of the case-control approach in this context.</p>
      <p>Finally, we investigated the biological meaning of AGE found by ABEILLE and OUTRIDER compared to the AGE found by the case-control approach of the original study (<xref rid="btac603-F4" ref-type="fig">Fig. 4D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Overall terms related to mitochondrial biology or diseases are enriched of AGE identified by ABEILLE, similarly to the AGEs identified in the original study. On the contrary, AGE identified by OUTRIDER are poorly enriched in mitochondrial-related gene-sets. Notably, a novel set of AGEs identified only by ABEILLE showed significant enrichment in ClinVar variants (<xref rid="btac603-B15" ref-type="bibr">Landrum <italic toggle="yes">et al.</italic>, 2014</xref>) related to mitochondrial diseases.</p>
    </sec>
    <sec>
      <title>3.4 AGE detection on small dataset size</title>
      <p>One of the main limitations in the field of rare diseases is the samples availability. Thus having a data analysis tool that do not require a consistent number of samples is pivotal. To test the performances of ABEILLE and OUTRIDER regarding this fundamental issue, we created small sub datasets of the Kremer dataset (see section 2 for more details). Briefly, we randomly suppressed samples from the original cohort in order to obtain datasets with sizes: 110, 90, 60, 30, 20 and 10 always keeping the 6 patients with validated AGEs. We repeated the strategy 10 times for each size thus obtaining 60 datasets. We then tested the ability of ABEILLE and OUTRIDER to recall any of the 6 validated AGEs accordingly with the sample size (<xref rid="btac603-F4" ref-type="fig">Fig. 4E</xref>). As expected, OUTRIDER was not able to identify any validated AGE when the sample size is smaller than 60. On the contrary, ABEILLE performances are stable regarding the size of the dataset being able to identify validated AGEs also for datasets composed with less than 30 samples. This analysis demonstrates that the performances of OUTRIDER strongly depends on the number of samples provided due to the use of a statistical approach to identify AGEs, while our novel strategy independent of any statistical test, shows good performances for very small datasets. This result is relevant for the rare disease context since small cohorts are usually available.</p>
    </sec>
    <sec>
      <title>3.5 Precision–recall benchmark for AGE detection</title>
      <p>We then studied the identification of AGEs by ABEILLE and OUTRIDER. To perform this analysis, we injected simulated AGEs into the GTEx data and counted the number of such AGEs that were recovered as described in Section 2. We simulated AGEs with three different probabilities resulting in different percentages of injected AGEs (0.1‰, 0.01‰ or 0.001‰). The analysis was repeated for six different size datasets: 50, 75, 125, 250, 500, 1000 samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We calculated precision, recall and F1 score to measure ABEILLE and OUTRIDER performances on the 18 semi-synthetic datasets. Regarding precision, both tools show very similar performances on all the datasets despite the size and the proportion of injected AGEs. We can assess that both tools correctly recall similar proportions of injected AGEs. Interestingly, we can observe a stratification of sensitivity of both tools accordingly with the size of the dataset. Overall, ABEILLE shows higher sensitivity than OUTRIDER especially for small datasets composed of 50 or 75 samples, while similar values of this score are obtained for datasets of size bigger than 250 samples. This result is particularly relevant in the context of rare diseases where usually only very small cohorts are available. On the other hand, for these aforementioned datasets, OUTRIDER achieved a slightly better F1 score. We observe that performances of OUTRIDER strongly depend on the proportion of AGEs injected in the dataset, showing better results when the proportion of injected AGEs is the highest simulated. This dependence is less important for ABEILLE. Also, this result is of particular note in the context of rare diseases since we expect to have very few AGEs for each patient.</p>
      <p>To further explore the properties of the two tools, we calculated the precision-recall curves on two ranking for each tool, namely <italic toggle="yes">P</italic>-values and Z-scores for OUTRIDER and divergence score and delta count for ABEILLE (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). On datasets with 0.1‰ AGEs injected, ABEILLE ranking by delta count showed the higher performances than the ranking by divergence score, especially for datasets sizes above 250 and smaller than 50. When the percentage of injected AGEs diminish, the ranking by divergence score yielded better results for ABEILLE. OUTRIDER ranking by <italic toggle="yes">P</italic>-values are slightly better than by Z-score.</p>
      <p>Overall depending on dataset size and percentage of injected AGEs, the performances of the tools depend on the score used to rank the AGEs. This result underlines that the ranking by one score and defined thresholds are not best suitable for AGE identification.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusions</title>
    <p>In this study, we presented ABEILLE, it combines the use of a VAE, able to model any type of data without any assumption about their distribution, and a decision tree, allowing to obtain a classification of genes as AGE or non-AGE. We compared the performances of ABEILLE with the state-of-the-art alternative OUTRIDER that uses an AE to normalize the data and then identify AGEs through a statistical test. The performance comparison of these two tools was done using two datasets: a semi-synthetic dataset and a real dataset from the study by Kremer <italic toggle="yes">et al.</italic></p>
    <p>Due to the lack of a ‘gold standard’ dataset with known real AGEs, we had to generate <italic toggle="yes">in silico</italic> datasets in order to compare the precision and recall of these two tools. One limitation of this analysis is that the GTEx database contains real AGEs over which we have no control and which suggests an underestimation of the performance of both tools with our analyses. Our results show that, although both tools have similar precision, ABEILLE has a higher recall than OUTRIDER especially for small datasets (&lt;75 samples). Since recall expresses the proportion of correctly found AGEs among the total number of injected AGEs, we can state that ABEILLE performs better in identifying true AGEs. ABEILLE performs better on datasets with very few AGEs, which makes it particularly suitable for rare diseases where a single gene in a patient may be responsible for the pathology and where the available cohorts are small. These results were corroborated by the application on the real data from Kremer <italic toggle="yes">et al.</italic> dataset. Here ABEILLE showed a higher agreement with AGE found by the original study than OUTRIDER and a higher specificity to detect AGEs experimentally validated. Of note, ABEILLE outperformed OUTRIDER when sample size is smaller than 60 samples: while OUTRIDER cannot identify any of the validated AGE, ABEILLE showed similar performances as observed on the entire cohort. Thus ABEILLE is suitable for AGE identification in the context of rare diseases.</p>
    <p>We did not compare ABEILLE with other known methods for RNA-Seq data analysis such as DESeq2 (<xref rid="btac603-B18" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>) or edgeR (<xref rid="btac603-B22" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>), because the estimation of AGEs is not based on the same principle. While these methods are suitable for identification of fold-change variation comparing two population, ABEILLE is conceived to identify AGE in one population. Moreover, these methods require several replicates to obtain reliable results and in general these replicates are not produced in the context of diagnostic research. However, it could be interesting to add these estimators to ABEILLE in order to improve the decision tree used to identify AGEs.</p>
    <p>Finally, we tested ABEILLE and OUTRIDER on finding AGEs in single-tissues of the GTEx dataset (data available at <ext-link xlink:href="https://zenodo.org/record/6395166" ext-link-type="uri">https://zenodo.org/record/6395166</ext-link>). Both tools showed some limitations to handle these data, leading to a large number of genes with very low expression identified as AGE. For OUTRIDER this limitation was already claimed by the authors because of a possible poor fit of the negative binomial model. For ABEILLE, the issue is in the sparsity of the data because we optimized the model for small datasets where we do not expect a high degree of sparsity as in the single-tissue datasets in GTEx. Thus a novel model should be developed to handle single-tissue and multiple-tissues AGE identification, although we do not expect to have data from several tissues for the same patient in the diagnostic context.</p>
    <p>In conclusion, we have demonstrated that ABEILLE is a valid alternative to OUTRIDER, especially for small cohorts composed by less than 60 samples, targeting a different population of AGEs more specific for aberrant expression than the population of AGEs identified by OUTRIDER. The advantages of ABEILLE are: ability to have good performances on small cohorts thanks to the VAE model that performs the learning phase on less data because of the sampling in the latent space, more flexibility due to the representation of each input point as a normal distribution in the latent space that should be able to approximate any other distribution and more resistant to noise.</p>
    <p>In the future, we need to perform more tests in order to evaluate the ability of ABEILLE to work properly on different types of data and not only on RNA-Seq data. The ability to analyze different types of data could pave the way for the use of ABEILLE on multi-tissues and multi-omics data, including proteomic and metabolomic data.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article, in its online <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> and at the repository <ext-link xlink:href="https://zenodo.org/record/6395166" ext-link-type="uri">https://zenodo.org/record/6395166</ext-link>. The app to explore the latent space is available at <ext-link xlink:href="https://jlabory.shinyapps.io/ABEILLE-main/" ext-link-type="uri">https://jlabory.shinyapps.io/ABEILLE-main/</ext-link>. ABEILLE source code is freely available at: <ext-link xlink:href="https://github.com/UCA-MSI/ABEILLE" ext-link-type="uri">https://github.com/UCA-MSI/ABEILLE</ext-link>.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the French government, through the UCA JEDI Investments in the Future project managed by the National Research Agency (ANR) under reference number [ANR-15-IDEX-01].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac603_Supplementary_Data</label>
      <media xlink:href="btac603_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac603-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <italic toggle="yes">TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems</italic>.</mixed-citation>
    </ref>
    <ref id="btac603-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ardlie</surname><given-names>K.G.</given-names></string-name></person-group>  <etal>et al</etal>  <collab>The GTEx Consortium</collab>. (<year>2015</year>) <article-title>The Genotype-Tissue expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>. <source>Science</source>, <volume>348</volume>, <fpage>648</fpage>–<lpage>660</lpage>.<pub-id pub-id-type="pmid">25954001</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brechtmann</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>OUTRIDER: a statistical method for detecting aberrantly expressed genes in RNA sequencing data</article-title>. <source>Am. J. Hum. Genet</source>., <volume>103</volume>, <fpage>907</fpage>–<lpage>917</lpage>.<pub-id pub-id-type="pmid">30503520</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author">, <string-name><surname>Breiman</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1984</year>) <italic toggle="yes">Classification and Regression Trees</italic>. (1st ed.). Routledge. <pub-id pub-id-type="doi">10.1201/9781315139470</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Byron</surname><given-names>S.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Translating RNA sequencing into clinical diagnostics: opportunities and challenges</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>257</fpage>–<lpage>271</lpage>.<pub-id pub-id-type="pmid">26996076</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cummings</surname><given-names>B.B.</given-names></string-name></person-group>  <etal>et al</etal>  <collab>Genotype-Tissue Expression Consortium</collab>. (<year>2017</year>) <article-title>Improving genetic diagnosis in Mendelian disease with transcriptome sequencing</article-title>. <source>Sci. Transl. Med</source>., <volume>9</volume>.</mixed-citation>
    </ref>
    <ref id="btac603-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frésard</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal>; <collab>Care4Rare Canada Consortium</collab>. (<year>2019</year>) <article-title>Identification of rare-disease genes using blood transcriptome sequencing and large control cohorts</article-title>. <source>Nat. Med</source>., <volume>25</volume>, <fpage>911</fpage>–<lpage>919</lpage>.<pub-id pub-id-type="pmid">31160820</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gonorazky</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <italic toggle="yes">Expanding the Boundaries of RNA Sequencing as a Diagnostic Tool for Rare Mendelian Disease</italic>. <italic toggle="yes">Am. J. Hum. Gen.</italic>, <bold>104</bold>,466–483.</mixed-citation>
    </ref>
    <ref id="btac603-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jenkinson</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>LeafCutterMD: an algorithm for outlier splicing detection in rare diseases</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>4609</fpage>–<lpage>4615</lpage>.<pub-id pub-id-type="pmid">32315392</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khang</surname><given-names>T.F.</given-names></string-name>, <string-name><surname>Lau</surname><given-names>C.Y.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Getting the most out of RNA-seq data analysis</article-title>. <source>PeerJ</source>, <volume>3</volume>, <fpage>e1360</fpage>.<pub-id pub-id-type="pmid">26539333</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>D.P.</given-names></string-name>, <string-name><surname>Welling</surname><given-names>M.</given-names></string-name></person-group> (<year>2014</year>) Auto-encoding variational Bayes. arXiv:1312.6114 [cs, stat].</mixed-citation>
    </ref>
    <ref id="btac603-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kremer</surname><given-names>L.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Genetic diagnosis of Mendelian disorders via RNA sequencing</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15824</fpage>.<pub-id pub-id-type="pmid">28604674</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuleshov</surname><given-names>M.V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W90</fpage>–<lpage>W97</lpage>.<pub-id pub-id-type="pmid">27141961</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Labory</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) Multi-omics approaches to improve mitochondrial disease diagnosis: challenges, advances and perspectives. <italic toggle="yes"><italic toggle="yes">Front. Mol. Sci.,</italic><bold>2</bold>, 590842.</italic></mixed-citation>
    </ref>
    <ref id="btac603-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landrum</surname><given-names>M.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>ClinVar: public archive of relationships among sequence variation and human phenotype</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D980</fpage>–<lpage>D985</lpage>.<pub-id pub-id-type="pmid">24234437</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal>  <collab>Undiagnosed Diseases Network</collab>. (<year>2020</year>) <article-title>Diagnostic utility of transcriptome sequencing for rare Mendelian diseases</article-title>. <source>Genet. Med</source>., <volume>22</volume>, <fpage>490</fpage>–<lpage>499</lpage>.<pub-id pub-id-type="pmid">31607746</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>Exaggerated false positives by popular differential expression methods when analyzing human population samples</article-title>. <source>Genome Biol</source>., <volume>23</volume>, <fpage>79</fpage>.<pub-id pub-id-type="pmid">35292087</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mertes</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Detection of aberrant splicing events in RNA-seq data using FRASER</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>529</fpage>.<pub-id pub-id-type="pmid">33483494</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mohammadi</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Genetic regulatory variation in populations informs transcriptome analysis in rare disease</article-title>. <source>Science</source>, <volume>366</volume>, <fpage>351</fpage>–<lpage>356</lpage>.<pub-id pub-id-type="pmid">31601707</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rahman</surname><given-names>J.</given-names></string-name>, <string-name><surname>Rahman</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <italic toggle="yes">Mitochondrial Medicine in the Omics Era</italic>.</mixed-citation>
    </ref>
    <ref id="btac603-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salkovic</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>OutPyR: Bayesian inference for RNA-Seq outlier detection</article-title>. <source>J. Comput. Sci</source>., <volume>47</volume>, <fpage>101245</fpage>.</mixed-citation>
    </ref>
    <ref id="btac603-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Factors influencing success of clinical genome sequencing across a broad spectrum of disorders</article-title>. <source>Nat. Genet</source>., <volume>47</volume>, <fpage>717</fpage>–<lpage>726</lpage>.<pub-id pub-id-type="pmid">25985138</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nat. Rev. Genet</source>., <volume>10</volume>, <fpage>57</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="btac603-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wortmann</surname><given-names>S.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Whole exome sequencing of suspected mitochondrial patients in clinical practice</article-title>. <source>J. Inherited Metab. Dis</source>., <volume>38</volume>, <fpage>437</fpage>–<lpage>443</lpage>.<pub-id pub-id-type="pmid">25735936</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
