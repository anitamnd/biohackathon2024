<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6198860</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty387</article-id>
    <article-id pub-id-type="publisher-id">bty387</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Indexed variation graphs for efficient and accurate resistome profiling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0384-4463</contrib-id>
        <name>
          <surname>Rowe</surname>
          <given-names>Will P M</given-names>
        </name>
        <xref ref-type="aff" rid="bty387-aff1">1</xref>
        <xref ref-type="aff" rid="bty387-aff2">2</xref>
        <xref ref-type="corresp" rid="bty387-cor1"/>
        <!--<email>will.rowe@stfc.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Winn</surname>
          <given-names>Martyn D</given-names>
        </name>
        <xref ref-type="aff" rid="bty387-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty387-aff1"><label>1</label>Institute of Integrative Biology, The University of Liverpool, Liverpool, UK</aff>
    <aff id="bty387-aff2"><label>2</label>Scientific Computing Department, The Hartree Centre, STFC Daresbury Laboratory, Warrington, UK</aff>
    <author-notes>
      <corresp id="bty387-cor1">To whom correspondence should be addressed. E-mail: <email>will.rowe@stfc.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-14">
      <day>14</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>21</issue>
    <fpage>3601</fpage>
    <lpage>3608</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>4</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty387.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Antimicrobial resistance (AMR) remains a major threat to global health. Profiling the collective AMR genes within a metagenome (the ‘resistome’) facilitates greater understanding of AMR gene diversity and dynamics. In turn, this can allow for gene surveillance, individualized treatment of bacterial infections and more sustainable use of antimicrobials. However, resistome profiling can be complicated by high similarity between reference genes, as well as the sheer volume of sequencing data and the complexity of analysis workflows. We have developed an efficient and accurate method for resistome profiling that addresses these complications and improves upon currently available tools.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Our method combines a variation graph representation of gene sets with a locality-sensitive hashing Forest indexing scheme to allow for fast classification of metagenomic sequence reads using similarity-search queries. Subsequent hierarchical local alignment of classified reads against graph traversals enables accurate reconstruction of full-length gene sequences using a scoring scheme. We provide our implementation, graphing Resistance Out Of meTagenomes (GROOT), and show it to be both faster and more accurate than a current reference-dependent tool for resistome profiling. GROOT runs on a laptop and can process a typical 2 gigabyte metagenome in 2 min using a single CPU. Our method is not restricted to resistome profiling and has the potential to improve current metagenomic workflows.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GROOT is written in Go and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/will-rowe/groot">https://github.com/will-rowe/groot</ext-link> (MIT license).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p>Supplementary data are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">STFC Hartree Centre’s Innovation Return on Research</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Department for Business, Energy &amp; Industrial Strategy</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Antimicrobial resistance (AMR) remains a significant global threat to public health, with directly attributable deaths per annum predicted to rise from 700 000 to 10 000 000 by the year 2050 (<xref rid="bty387-B34" ref-type="bibr">O’Neill, 2016</xref>). This threat is not restricted to humans, with consequences also for animal health, welfare and food production (<xref rid="bty387-B4" ref-type="bibr">Bengtsson and Greko, 2014</xref>). In an effort to inform policy that can mitigate the spread of AMR, there has been a recent drive to establish surveillance programmes to monitor the prevalence of AMR (<xref rid="bty387-B40" ref-type="bibr">Public Health Agency of Canada, 2016</xref>; <xref rid="bty387-B54" ref-type="bibr">World Health Organization, 2015</xref>). These programmes have traditionally used culture or polymerase chain reaction–based surveillance techniques, restricting monitoring to a few key genes or organisms. However, the use of metagenomics for surveilling AMR is gaining traction as it offers a much greater breadth of testing over these traditional techniques (<xref rid="bty387-B2" ref-type="bibr">Baquero, 2012</xref>; <xref rid="bty387-B31" ref-type="bibr">Miller <italic>et al.</italic>, 2013</xref>).</p>
    <p>The use of metagenomics to determine the antibiotic resistance gene (ARG) content of a microbial community, hereafter referred to as resistome profiling, has been applied in studies of a wide variety of biomes (<xref rid="bty387-B1" ref-type="bibr">Auffret <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B23" ref-type="bibr">Jalali <italic>et al.</italic>, 2015</xref>; <xref rid="bty387-B30" ref-type="bibr">Ma <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B33" ref-type="bibr">Munk <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B43" ref-type="bibr">Rose <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B46" ref-type="bibr">Rowe <italic>et al.</italic>, 2017</xref>, <xref rid="bty387-B44" ref-type="bibr">2016</xref>; <xref rid="bty387-B50" ref-type="bibr">Tao <italic>et al.</italic>, 2016</xref>; <xref rid="bty387-B57" ref-type="bibr">Yang <italic>et al.</italic>, 2013</xref>). Studies such as these utilize several well-maintained ARG databases (<xref rid="bty387-B19" ref-type="bibr">Gupta <italic>et al.</italic>, 2014</xref>; Jia <xref rid="bty387-B25" ref-type="bibr"><italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B58" ref-type="bibr">Zankari <italic>et al.</italic>, 2012</xref>) and ARG-annotation tools (<xref rid="bty387-B21" ref-type="bibr">Hunt <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B22" ref-type="bibr">Inouye <italic>et al.</italic>, 2014</xref>; <xref rid="bty387-B45" ref-type="bibr">Rowe <italic>et al.</italic>, 2015</xref>; <xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>), of which only a few are designed for resistome profiling (<xref ref-type="fig" rid="bty387-F1">Fig. 1</xref>). These databases and tools are used with assembled metagenomic contigs, or alternatively with metagenomic sequence reads. In the case of the latter some tools and studies opt to align reads to reference ARGs and report only fully covered references (<xref rid="bty387-B46" ref-type="bibr">Rowe <italic>et al.</italic>, 2017</xref>), whereas some bin reads using BLAST and similarity/length thresholds (<xref rid="bty387-B50" ref-type="bibr">Tao <italic>et al.</italic>, 2016</xref>). All of these strategies offer the user a compromise between ease of use, analysis speed and the accurate typing of ARGs (ability to detect ARG type/subtype).
</p>
    <fig id="bty387-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Summary of ARG annotation tools and databases. This figure shows several published tools and databases that are used to detect ARGs (in sequencing data or assembled contigs) (<xref rid="bty387-B6" ref-type="bibr">Bradley <italic>et al.</italic>, 2015</xref>; <xref rid="bty387-B12" ref-type="bibr">Clausen <italic>et al.</italic>, 2016</xref>; <xref rid="bty387-B21" ref-type="bibr">Hunt <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B25" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B26" ref-type="bibr">Lakin <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B28" ref-type="bibr">Li <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B29" ref-type="bibr">Liu and Pop, 2009</xref>; <xref rid="bty387-B45" ref-type="bibr">Rowe <italic>et al.</italic>, 2015</xref>; <xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>; <xref rid="bty387-B58" ref-type="bibr">Zankari <italic>et al.</italic>, 2012</xref>). The list is not exhaustive and the tools that are designed specifically for the resistome profiling of metagenomic datasets are highlighted with an asterisk</p>
      </caption>
      <graphic xlink:href="bty387f1"/>
    </fig>
    <p>One of the main limitations of existing tools for resistome profiling (or profiling of other gene sets) in metagenomes is that high similarity shared between reference sequences can result in ambiguous alignments, unaligned reads (false negatives), or mis-annotated reads (false positives); thus reducing the accuracy when typing ARGs (<xref rid="bty387-B38" ref-type="bibr">Petersen <italic>et al.</italic>, 2017</xref>). A solution to this has been to cluster the reference sequences and then use the cluster representative sequences as a target for read alignment (<xref rid="bty387-B45" ref-type="bibr">Rowe <italic>et al.</italic>, 2015</xref>); however, this results in a loss of information as ARG subtypes will be masked. Likewise, a related approach has been to collapse final annotations of ARG variants into a common ARG annotation, also masking subtypes (<xref rid="bty387-B33" ref-type="bibr">Munk <italic>et al.</italic>, 2017</xref>). The ability to accurately detect ARG type/subtype, here termed profiling resolution, is important considering that the variation between subtypes of ARGs can result in different phenotypic activity (<xref rid="bty387-B10" ref-type="bibr">Bush and Jacoby, 2010</xref>).</p>
    <p>Recently non-linear data structures, such as variation graphs, have been used to encode reference sequences for applications such as variant calling (<xref rid="bty387-B14" ref-type="bibr">Garrison <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B37" ref-type="bibr">Paten <italic>et al.</italic>, 2017</xref>). In terms of ARG annotation, the Mykrobe predictor tool applies non-linear reference representation in the form of a de Bruijn graph to identify resistance profiles in <italic>Staphylococcus aureus</italic> and <italic>Mycobacterium tuberculosis</italic> isolates (<xref rid="bty387-B6" ref-type="bibr">Bradley <italic>et al.</italic>, 2015</xref>). Non-linear reference representation reduces redundancy whilst maintaining information that facilitates classification. Variation graphs, which are directed acyclical graphs (DAGs), are offered as a solution to reference bias in population genomics as they represent sequence variation within a population (<xref rid="bty387-B14" ref-type="bibr">Garrison <italic>et al.</italic>, 2017</xref>). To align a sequence against a variation graph, the traversals within a graph are indexed. Variation graph indexing approaches to date have included hash-map and Burrow-Wheeler transform encoding (<xref rid="bty387-B47" ref-type="bibr">Schneeberger <italic>et al.</italic>, 2009</xref>; <xref rid="bty387-B49" ref-type="bibr">Sirén, 2016</xref>). Index design must balance query length, performance and index size in order to deal with the complexity of variation graphs. Efficient indexing is further complicated in the case of multiple graphs.</p>
    <p>We propose that variation graph traversals can be indexed using locality-sensitive hashing (LSH), allowing for fast and approximate assignment of a sequence to a specific region of a traversal within one or more graphs. MinHash is a form of LSH that can be used to compress sets into smaller representations, called MinHash signatures. MinHash signatures can be used to estimate the similarity of the original sets independently of the original set size and was first used for duplicate webpage detection (<xref rid="bty387-B8" ref-type="bibr">Broder, 1997</xref>, <xref rid="bty387-B7" ref-type="bibr">2000</xref>). The MinHash technique is increasingly being used in bioinformatics applications for clustering and searching large sequencing datasets (<xref rid="bty387-B9" ref-type="bibr">Brown and Irber, 2016</xref>; <xref rid="bty387-B36" ref-type="bibr">Ondov <italic>et al.</italic>, 2016</xref>) and has also recently been applied to read alignment algorithms (<xref rid="bty387-B5" ref-type="bibr">Berlin <italic>et al.</italic>, 2015</xref>; <xref rid="bty387-B39" ref-type="bibr">Popic and Batzoglou, 2017</xref>; <xref rid="bty387-B41" ref-type="bibr">Quedenfeld and Rahmann, 2017</xref>). In applications such as these, the ability to efficiently compare signatures is essential. Additional LSH indexing techniques can therefore be applied to reduce dimensionality and facilitate querying of signatures. One such technique is the LSH Forest indexing scheme that uses multiple prefix trees to store hash tables containing portions of the MinHash signatures and facilitates self-tuning of index parameters, offering a performance improvement over traditional LSH indexes (<xref rid="bty387-B3" ref-type="bibr">Bawa <italic>et al.</italic>, 2005</xref>).</p>
    <p>In this article, we present a method for resistome profiling that utilizes a variation graph representation of ARG databases to reduce ambiguous alignment of metagenomic sequence reads. We store sets of similar ARG reference sequences in variation graphs; collapsing identical sequences whilst retaining unique nodes that allow for accurate typing. By applying an LSH Forest indexing strategy to the variation graph collection that allows for fast and approximate search queries, we show that metagenomic reads can be seeded against candidate graph traversals. Subsequent hierarchical local alignment of reads and scoring enables accurate and efficient resistome profiling. We also provide our implementation, Graphing Resistance Out Of meTagenomes (GROOT), and compare it against ARGS-OAP and AMRPlusPlus, the most recently published tools for resistome profiling from metagenomic data (<xref rid="bty387-B26" ref-type="bibr">Lakin <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>) (<xref ref-type="fig" rid="bty387-F1">Fig. 1</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Here we describe our method to index a collection of ARG reference sequences, align sequence reads using the index and then apply this for resistome profiling of metagenomics samples. We then document our implementation, GROOT, and describe how we evaluated its performance.</p>
    <sec>
      <title>2.1 Indexing</title>
      <p>The first stage in indexing a collection of ARG reference sequences is to remove redundancy, thus reducing the number of potential alignments to multiple references by collapsing identical sequence regions into a single reference. To do this we employ a DAG (variation graph) representation of ARG reference sequences. By fingerprinting variation graph traversals and using this as an index, we can then perform approximate seeding of sequence reads (<xref ref-type="fig" rid="bty387-F2">Fig. 2</xref>) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Algorithm 1).
</p>
      <fig id="bty387-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Overview of our method to index and query ARG variation graphs. This figure shows the indexing (index) and alignment (seed and align) steps of the method. In the alignment step, once a query read has been seeded against a variation graph, a hierarchical local alignment process is performed, and the alignment is scored before being reported</p>
        </caption>
        <graphic xlink:href="bty387f2"/>
      </fig>
      <sec>
        <title>2.1.1 Create variation graphs</title>
        <p>To convert a collection of FASTA-formatted ARG reference sequences to a set of variation graphs, all sequences are first clustered based on sequence identity (∼90%) in order to group sequences into distinct sets of similar sequences. Each resulting set of similar sequences can be viewed as a multiple sequence alignment (MSA) that describes the insertions, deletions and polymorphisms in each member of the set, relative to a set representative sequence. The MSA is converted to a variation graph by first using the representative sequence as the graph backbone; each base of the sequence is a node with edges connecting them in series. The other sequences of the MSA are then incorporated; common bases are consolidated as single nodes and all deletions and insertions are added via edges and bubbles.</p>
        <p>Each variation graph node contains information such as parent sequence, reference position and encoded base, allowing restriction of graph traversals to known references and the translation of traversals into reference name and sequence location. In the case of sets containing a single sequence, they are still converted to variation graphs but will be a linear series of nodes and only contain one possible traversal. All variation graphs are topologically sorted so that node ordering reflects MSA position prior to fingerprinting graph traversals.</p>
      </sec>
      <sec>
        <title>2.1.2 Fingerprint graph traversals</title>
        <p>The second indexing stage is to fingerprint the traversals in each variation graph, allowing for fast and approximate matching of query reads to region(s) of a variation graph. To fingerprint a graph, a sliding window of length <italic>w</italic> is moved across all graph traversals and a MinHash signature is created for each window (<xref rid="bty387-B8" ref-type="bibr">Broder, 1997</xref>). The windows are typically the same length as the expected query reads. The starting nodes of consecutive windows are spaced by an offset, <italic>o</italic>, where <italic>o</italic> ≤ <italic>w</italic>.</p>
        <p>For each window, the contained nodes are joined to form a sequence (encoded as an array of bytes), which is then decomposed into a set of <italic>k</italic>-mers of length <italic>k</italic>, where <italic>k</italic> &lt; <italic>w</italic>. To then create a MinHash signature (an array of unsigned 64-bit integers) of length <italic>s</italic>, each <italic>k</italic>-mer in the set is evaluated in series. A <italic>k</italic>-mer is hashed to an unsigned 64-bit integer <italic>s</italic> times, using <italic>s</italic> distinct hash functions. Each time a <italic>k</italic>-mer is hashed, the index position in the signature is advanced from 0 and the new hash value is evaluated against the value stored at the current index position; if the stored value is greater than the new value, the stored value is replaced by the new value. The signature index is reset to 0 prior to hashing the next <italic>k</italic>-mer in the series and the same <italic>s</italic> hash functions are used. Once all <italic>k</italic>-mers in a set for a given window have been hashed, the signature for that window is complete; the signature is linked to the graph ID and the window start node before it is stored. A single graph node can have multiple linked signatures if multiple traversals are possible.</p>
      </sec>
      <sec>
        <title>2.1.3 Store window signatures</title>
        <p>The final indexing stage is to store the window signatures for each variation graph in a data structure that allows for fast and approximate nearest-neighbour queries. To do this, we enlist the LSH Forest self-tuning indexing scheme (<xref rid="bty387-B3" ref-type="bibr">Bawa <italic>et al.</italic>, 2005</xref>). This indexing scheme, given a query, will give a subset of nearest-neighbour candidates to which the query can be compared, based on the number of hash collisions between query and candidates. In our case, querying the index with a MinHash signature from a sequencing read will return candidate window signatures.</p>
        <p>As in a traditional LSH index, two parameters must be tuned in order to maximize the occurrence of collisions between a query and its nearest neighbour: (i) the number of hash functions to encode an item (<italic>K</italic>) and (ii) the number of hash tables (buckets) to split an item into (<italic>L</italic>). As we have already hashed the signature during MinHashing, we are essentially splitting the signature uint64 values over a series of buckets. Explicitly, for each of the <italic>L</italic> buckets we take <italic>K</italic> uint64 values from the signature (where <italic>K</italic> ≤ <italic>s</italic>) and hash the values again to a single binary string. The original signature of <italic>s</italic> uint64 values is replaced by a more compact representation of <italic>L</italic> binary strings.</p>
        <p>The challenge with traditional LSH indexing schemes was setting appropriate <italic>L</italic> and <italic>K</italic> values. Too small a value for <italic>K</italic> results in an increased false positive rate due to increased collisions of dissimilar query-neighbour pairs, and a large value for <italic>K</italic> lowers the collision chances of similar query-neighbour pairs. Therefore, setting <italic>L</italic> &gt; 1 is needed to maximize the occurrence of collisions between similar query-neighbour pairs. To set appropriate <italic>K</italic> and <italic>L</italic> values, the distance between query and nearest neighbour is needed, but tuning for one query-neighbour pair can reduce performance for other query-neighbour pairs (<xref rid="bty387-B15" ref-type="bibr">Gionis <italic>et al.</italic>, 1999</xref>). The LSH Forest indexing scheme addresses the limitations of the traditional LSH indexing by using a unique label of variable length to assign data points to buckets and storing these in a data structure that combines multiple prefix trees, each constructed from hash functions (derived from the MinHash signature).</p>
        <p>The LSH Forest data structure is first initialized and tuned using the MinHash signature length and the Jaccard Similarity threshold for reporting query-neighbour matches. To tune the index, multiple combinations of the number of buckets (<italic>L</italic>) and the number of hash functions (<italic>K</italic>) are tested (within the bounds of the signature length) for false positive and false negative rates at the specified Jaccard Similarity. <italic>L</italic> and <italic>K</italic> are then set according to the lowest error rate possible and a set of <italic>L</italic> initial hash tables are then created (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Algorithm 2).</p>
        <p>Once the LSH Forest data structure has been initialized, each signature from the variation graph(s) is added to the initial hash tables. Each signature is split into <italic>L</italic> equally sized chunks of <italic>K</italic> hash functions. The chunks are hashed to a binary string (little-endian ordering) and stored in the corresponding hash table, with each chunk pointing to the graph and window from which they derive. Once all signatures have been added, the initial hash tables are transferred into a set of arrays (buckets) and sorted.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Alignment</title>
      <p>To align sequence reads to a variation graph, our method uses an approximate nearest-neighbour search to seed a read against a region of a graph and then employs a hierarchical local alignment to fully align the read.</p>
      <sec>
        <title>2.2.1 Nearest-neighbour search</title>
        <p>For a given sequence read, a MinHash signature is generated as during indexing, using the same values for <italic>k</italic> and <italic>s</italic>, etc. The signature is then queried against the LSH Forest data structure containing the indexed variation graphs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Algorithm 3). To run a query, the signature is split into <italic>L</italic> equally sized chunks and each chunk is hashed to a binary string using the same hash function as during the LSH Forest population (<xref rid="bty387-B3" ref-type="bibr">Bawa <italic>et al.</italic>, 2005</xref>). Each hashed chunk of the query signature is then queried against the corresponding bucket in the LSH Forest. To improve querying efficiency, each bucket is compressed by constructing a prefix tree (PATRICIA trie) (<xref rid="bty387-B32" ref-type="bibr">Morrison, 1968</xref>). Binary search is used to search the bucket (in ascending order) and return the smallest index of the bucket where the prefix matches the query chunk; the bucket is then iterated over from this index position, returning graph windows held until the prefix no longer matches the query chunk. Once all chunks of the query sequence have been searched, all the windows (graph IDs and start nodes) are collated and stored as seeds for each read. The nearest-neighbour search is then repeated using the reverse complement of the query read.</p>
      </sec>
      <sec>
        <title>2.2.2 Hierarchical local alignment</title>
        <p>For a read that has been seeded one or more times, a hierarchical local alignment process is used to align the read to a graph traversal. We assume that most reads do not feature novel variation, so we first try an exact match alignment. We then try an exact match alignment after shuffling the seed <italic>n</italic> nodes along the graph, followed by a clipped alignment. As soon as the read aligns, no further alignments are tried for that seed. To perform an alignment from a given seed, a recursive depth-first search (DFS) of the seeded graph is performed, beginning at the start node identified during the nearest-neighbour search (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, Algorithm 4). If a match between node and read base is encountered, the position in the read is incremented and the next node in the DFS is checked. When no match is found or the whole read has been iterated over, the DFS of the current traversal is ended.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Reporting</title>
      <p>Reads are classified as ARG-derived if they have successfully aligned to a variation graph. To apply our method to resistome profiling, the classified reads must be evaluated to annotate what gene they derive from and if that entire gene is present in a given sample.</p>
      <p>To classify a read alignment, a score is calculated according to the parent information of the nodes of the alignment. That is, if a node was derived from gene X and gene Y, the read would receive a point for each parent. Points are tallied, the top parent(s) in the tally is used to classify the read. If the top parent was not present for every node traversed, the read is ambiguous. If multiple parents score the highest then the read has multiple valid classifications (a multi-mapper).</p>
      <p>Once reads have been classified, gene annotations are then made. Classified reads are binned according to the graphs to which they align and then reference information is extracted from the corresponding graph(s). The length of the reference is used to perform a simple pileup of classified reads. Length and coverage thresholds are applied to determine if a gene can be reported as present in the resistome profile.</p>
    </sec>
    <sec>
      <title>2.4 Our implementation</title>
      <p>We have implemented our method as an easy to use program called GROOT (<xref ref-type="fig" rid="bty387-F2">Fig. 2</xref>). GROOT is written in Go (version 1.9) and compiles for a variety of operating systems and architectures.</p>
      <p>To create the supplied reference data (used for indexing), ARG sequences were downloaded from the CARD, Resfinder and ARG-annot databases (<xref rid="bty387-B19" ref-type="bibr">Gupta <italic>et al.</italic>, 2014</xref>; <xref rid="bty387-B25" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B58" ref-type="bibr">Zankari <italic>et al.</italic>, 2012</xref>) (accessed June 2016). Each database was clustered using the VSEARCH cluster_size command and stored as MSA files (<xref rid="bty387-B42" ref-type="bibr">Rognes <italic>et al.</italic>, 2016</xref>). The GROOT get command will fetch a specified pre-clustered database, check it and unpack it ready for indexing. Alternatively, a user can provide their own clustered database.</p>
      <p>The index command checks MSA files for formatting and discards sequences shorter than the expected read query length. Variation graphs are then built from the MSAs, pruned and topologically sorted. For each graph, a sliding window is moved along each traversal (default length = 100, offset = 1), decomposed to <italic>k</italic>-mer sets (default <italic>k</italic> = 7) and MinHash signatures are created using the Go implementations of Spooky and Farm hash functions (default signature length = 128, based on XORing the Spooky and Farm hash functions) (Jenkins; Google; Gryski <ext-link ext-link-type="uri" xlink:href="https://github.com/dgryski/go-spooky">https://github.com/dgryski/go-spooky</ext-link>). An LSH Forest is then initialized, tuned and populated, before being serialized using the Go gob package and written to disk.</p>
      <p>The align command loads the index, sets all hashing parameters to match the index and then streams the FASTQ read file(s) (multiple FASTQ files or paired reads can be read but paired-end information is not utilized). MinHash signatures are created for each read and its reverse complement; signatures are then queried against the index. Once seeded, reads are optionally quality trimmed prior to hierarchical local alignment and reporting. All variation graphs that had reads align are saved to disk [in graphical fragment assembly (GFA) format] and can be viewed using Bandage (<xref rid="bty387-B52" ref-type="bibr">Wick <italic>et al.</italic>, 2015</xref>). All aligned reads are also reported in relation to a linear reference sequence (in BAM format).</p>
      <p>The index, align and report subcommands of GROOT all utilize a concurrent pipeline pattern that is driven by the flow of data between structs. This pattern also facilitates the streaming of data from STDIN, as well as from disk, and allows the GROOT commands to be piped together.</p>
    </sec>
    <sec>
      <title>2.5 Evaluating performance</title>
      <p>The full commands and code used to evaluate the performance of our implementation can be found in the GROOT repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/will-rowe/groot/tree/master/paper">https://github.com/will-rowe/groot/tree/master/paper</ext-link>). GROOT version 0.7 was used in all experiments (release 0.7, commit b43c32c). For running the accuracy benchmark, simulated FASTQ reads (150 bp read length) were generated from the ARG-annot database using BBMap (<xref rid="bty387-B11" ref-type="bibr">Bushnell, 2014</xref>; <xref rid="bty387-B19" ref-type="bibr">Gupta <italic>et al.</italic>, 2014</xref>). An index of the ARG-annot database was created using the GROOT index command (length = 150, all other settings default). Reads were aligned using the GROOT align command with default settings, running on a Linux laptop using 1, 4, and 8 CPUs for each test, respectively.</p>
      <p>For running the comparison benchmark, the genomes from the Critical Assessment of Metagenome Interpretation (CAMI) project were downloaded in FASTA format (<xref rid="bty387-B48" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>). The genomes were screened against the CARD database to mask any ARGs already present in the genomes (<xref rid="bty387-B25" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>). A subset of ARGs were then randomly sampled from the CARD database (v1.1.2) using Bioawk and were combined with the CAMI genomes in a single FASTA file (<xref rid="bty387-B25" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>). The CARD database was selected as ARGs-OAP uses this and it is one of the default databases provided by GROOT (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>). Sets of metagenomic FASTQ reads (150 bp read length, errors allowed) at varying coverage levels were then generated from the FASTA file using BBMap (<xref rid="bty387-B11" ref-type="bibr">Bushnell, 2014)</xref>. For each set of metagenomics reads, GROOT and ARGs-OAP [stage 1, version 1 (release 1, commit: ed19cd1)] were both run with default parameters (recommended settings) on a LINUX laptop using 1 core (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>). ARGs-OAP (stage 2, version 2) was completed on the dedicated Galaxy webserver, allowing only full-length, 100% identity read matches (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>). For comparing GROOT against AMRPlusPlus, reads were simulated (5× coverage) from the CAMI database as above, this time spiked with 10 ARGs from the MegaRes database (version 1.01) (<xref rid="bty387-B26" ref-type="bibr">Lakin <italic>et al.</italic>, 2017</xref>). Simulated reads were analysed using AMRPlusPlus (default settings, commit: 3086a1f) and GROOT on a Linux cluster, both using eight cores and a reporting threshold of 100%, 99% and 80% gene coverage for each test.</p>
      <p>For performing the resistome analysis, we reanalysed the metagenomic data from a recent microbiome study (<xref rid="bty387-B53" ref-type="bibr">Winglee <italic>et al.</italic>, 2017</xref>). FASTQ reads for all 40 microbiomes were downloaded from the SRA (BioProject: PRJNA349463) and were classified by GROOT using the CARD database (<xref rid="bty387-B25" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>). GROOT was set to report full-length ARG annotations and the variation graph alignments (GFA format) for each annotation were validated by manual inspection using Bandage (<xref rid="bty387-B52" ref-type="bibr">Wick <italic>et al.</italic>, 2015</xref>). Toxin/antitoxin genes were identified in microbiome samples using GROOT and the TADB database (clustered at 90% sequence identity) (<xref rid="bty387-B55" ref-type="bibr">Xie <italic>et al.</italic>, 2018</xref>). The full commands used are available in the online GROOT tutorial (<ext-link ext-link-type="uri" xlink:href="https://groot-documentation.readthedocs.io/en/latest/tutorial.html">https://groot-documentation.readthedocs.io/en/latest/tutorial.html</ext-link>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>The results presented here evaluate our implementation of indexed variation graphs for resistome profiling, in terms of both the accuracy of the tool and its performance compared to a recently published resistome profiling tool.</p>
    <sec>
      <title>3.1 Accuracy assessment</title>
      <p>To assess the accuracy of our implementation, we generated sets of random FASTQ reads from the ARG-annot database, classified the reads with GROOT and then compared the classification to the ARG from which the read derived (<xref rid="bty387-B19" ref-type="bibr">Gupta <italic>et al.</italic>, 2014</xref>). For six sets of simulated reads, ranging from 100 to 10 000 000 reads, GROOT classified the ARG-derived reads with no recorded false negatives. GROOT took an average of 216.44 wall clock seconds to classify 1 000 000 ARG-derived reads using 8 CPUs. At &lt;1000 reads, runtimes were equivalent regardless of the number of CPUs used, however, as the datasets approached real-world metagenome size (&gt;1 000 000 reads), increasing the number of CPUs resulted in decreased runtime of approximately 2.5-fold per 4 CPUs (<xref ref-type="fig" rid="bty387-F3">Fig. 3</xref>). The average RAM occupation recorded during the accuracy assessment was 2.23 GB.
</p>
      <fig id="bty387-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Runtime performance. This figure shows the runtime performance of our implementation (GROOT) on 1, 4, and 8 CPUs. The data were collected during the accuracy assessment of GROOT, where it classified ARG-derived reads (no false negatives were recorded)</p>
        </caption>
        <graphic xlink:href="bty387f3"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Performance comparison</title>
      <p>To compare the accuracy and speed of our implementation against a recently published resistome profiling tool [ARGs-OAP (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>)], we used a set of publically available, simulated metagenomes and spiked in full-length ARG sequences. The spiked data was sampled at varying coverage levels and the performance of GROOT and ARGs-OAP was evaluated in terms of the number of ARGs correctly annotated from each sample, as well as the time taken for each tool to process the samples.</p>
      <p>On average GROOT was 6.3 times faster at processing the samples compared to stage 1 of ARGs-OAP. The mean time to process a metagenome with 1× coverage (approximately 1.1 million reads) was 157.87 s for GROOT, compared to 989.15 s for ARGs-OAP (stage 1 only) (<xref ref-type="fig" rid="bty387-F4">Fig. 4A</xref>). ARGs-OAP stage 2 took an average of 12 h to run on a dedicated server (not included in <xref ref-type="fig" rid="bty387-F4">Fig. 4A</xref>).
</p>
      <fig id="bty387-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Benchmarking GROOT and ARGs-OAP. (<bold>A</bold>) The runtime comparison of GROOT and ARGs-OAP when processing metagenomes at varying coverage levels. (<bold>B</bold>) The number of errors (false positives and false negatives) recorded by each program at varying metagenome coverage levels</p>
        </caption>
        <graphic xlink:href="bty387f4"/>
      </fig>
      <p>In terms of accuracy, GROOT recorded only one false negative across all samples (present in the lowest coverage metagenome), whereas ARGs-OAP (Stages 1 + 2) consistently recorded three false negatives per sample. GROOT had a mean rate of 1.6 false positives per sample, whereas ARGs-OAP had a mean rate of 99.6 false positives per sample. The number of false positives found by GROOT did not increase beyond 10× coverage, compared to the false positive increase observed at every coverage increase by ARGs-OAP (<xref ref-type="fig" rid="bty387-F4">Fig. 4B</xref>).</p>
      <p>We additionally compared GROOT to AMRPlusPlus. Although GROOT outperformed this software on the basis of runtime (117 s versus 3366 s average run time) and accuracy (<xref ref-type="supplementary-material" rid="sup1">Supplementary Results 1</xref>), the comparison of GROOT and AMRPlusPlus is not ideal. This is due to AMRPlusPlus being unable to run on a laptop using a single core (as in the above benchmark test) and the fact that AMRPlusPlus is a pipeline that involves a lot of additional data processing, leading to a much longer runtime.</p>
    </sec>
    <sec>
      <title>3.3 Resistome analysis</title>
      <p>To show the application of our method on real-world data, we reanalysed 40 recently published metagenomes that were derived from the microbiome of rural and urban subjects from the Hunan province of China (<xref rid="bty387-B53" ref-type="bibr">Winglee <italic>et al.</italic>, 2017</xref>). GROOT made 84777 ARG read classifications across all the samples; the mean number of ARG-classified reads was higher in rural microbiome samples than urban (<xref ref-type="fig" rid="bty387-F5">Fig. 5A</xref>). The resistome profiles generated by GROOT identified 11 and 20 ARGs that could be accurately subtyped in the rural and urban microbiome samples respectively (<xref ref-type="fig" rid="bty387-F5">Fig. 5B</xref>). The ARG subtypes were also confirmed by inspection of variation graphs; uniform read coverage along graph traversals corresponded to the identified ARGs (see example variation graph for bla-cfxA, <xref ref-type="fig" rid="bty387-F5">Fig. 5C</xref>). Finally, to show the utility of GROOT in classifying non-ARG sequences, we used GROOT to classify reads that were derived from toxin genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). We found 11 different full-length toxin sequences in the microbiomes of urban subjects, whereas no full-length sequences could be identified in the rural samples.
</p>
      <fig id="bty387-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Resistome analysis using GROOT on 40 human microbiome samples. (<bold>A</bold>) A boxplot comparing ARG-classified reads derived from all rural versus urban subject microbiomes. (<bold>B</bold>) The full length ARGs detected by GROOT during resistome profiling and in which microbiome class they were present. (<bold>C</bold>) A subgraph of the bla-cfxA variation graph used by GROOT in this analysis (the full graph encodes 4 sequences using 10 nodes and 13 edges). Grey shading corresponds to nodes with aligned reads. The bla-cfxA3 traversal is highlighted by the black arrows</p>
        </caption>
        <graphic xlink:href="bty387f5"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>AMR remains a significant challenge to human and animal health. With the increasing drive for AMR surveillance in order to inform policy and mitigate the spread of resistance, metagenomic studies to identify and monitor ARGs in a wide variety of biomes are becoming commonplace. Sampled biomes range from the human gut, through to water supplies, agricultural land and marine environments. Despite this scale and variety, the question being asked remains simple, what ARGs are present in a given sample? Although simple, resistome profiling still presents a challenge, as illustrated by the many tools available (<xref ref-type="fig" rid="bty387-F1">Fig. 1</xref>). Our method improves upon two main issues with these existing tools; the resolution offered and the speed at which a sample can be profiled. Crucially also, as a novel algorithm, it is translatable to identifying other highly related gene sets within metagenomes. Variation graphs can be generated, indexed and searched using any reference set of similar sequences. For example, we have shown that GROOT can be used to annotate toxin genes in microbiome data (see results—resistome analysis). We should note however that our implementation currently restricts the number of graphs that can be generated to around 2000.</p>
    <p>In terms of profiling resolution, we are referring to the accuracy of the annotations in a resistome profile. That is, is it possible to annotate the subtype of ARG in a sample (e.g. <italic>bla-SHV-1</italic>) or just the type (e.g. <italic>bla-SHV</italic>)? This resolution is important as different ARG subtypes can provide selective resistance to different antibiotics, for example genes within a single beta lactamase gene class (structural classes, based on amino acid sequence) can confer resistance to different beta lactam antibiotics (<xref rid="bty387-B10" ref-type="bibr">Bush and Jacoby, 2010</xref>). Therefore, the greater the resolution, the more information can be extracted from a sample. To gain this resolution, we need to both cover an entire reference sequence and be confident in the reads placed. We address this by allowing only exact matches to the whole reference sequence before annotating the gene as present. The counter to this argument for greater resolution is that sequence quality will impact read placement and also, novel ARGs will be missed. Whilst we believe that the main utility of GROOT is its ability to confidently resolve ARGs, we have also added features to allow for these points. Firstly, our implementation has an optional quality trimming algorithm to remove low quality bases prior to read alignment. Secondly, to allow potentially novel ARGs or accommodate low coverage samples, there is an option to relax the scoring system in order to allow non-exact matches or partially covered genes.</p>
    <p>Our method offers an improvement in resolution over those that consolidate variant ARGs to a representative sequence (<xref rid="bty387-B33" ref-type="bibr">Munk <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B45" ref-type="bibr">Rowe <italic>et al.</italic>, 2015</xref>), or that have high false positive rates due to allowing partial or inexact matches (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>). Despite a marked improvement on ARGs-OAP in our benchmark our method did record a false negative and some false positives, likely as a result of introduced sequencing error and the low sample coverage (in the case of the single false negative). These errors could be considered a limitation of the exact local alignment utilized in this method, a more relaxed alignment could be allowed but this would be at the expense of confidence in the ARG annotations.</p>
    <p>In terms of speed, our method offers several advantages over other resistome profiling tools. Our method does not require metagenome assembly or the upload of data to remote servers, both of which add significant time to a resistome profiling analysis. The latter requires good bandwidth and the former can require large compute resources; a complex metagenome can take up to 10 h and 500 GB of RAM to assemble (<xref rid="bty387-B51" ref-type="bibr">van der Walt <italic>et al.</italic>, 2017</xref>). Our implementation can run a typical 2 GB metagenome in 2 min using a single CPU, and scales when run on higher-performance systems. Our benchmark was restricted to a single CPU as ARGs-OAP is limited in the number of CPUs it can use. The benchmark also ignored the time taken during Stage 2 of ARGs-OAP (on the remote server) as this could be variable depending on server load and available bandwidth for upload. Despite this, GROOT still offers a much faster runtime than ARGs-OAP. In addition to runtime, analysis times are also reduced with GROOT due to its ease of use. It runs as a self-contained binary, is packaged with bioconda (<xref rid="bty387-B13" ref-type="bibr">Dale <italic>et al.</italic>, 2017</xref>) and requires only two commands to run a resistome profiling analysis, offering significant advantage over more complex workflows or those that require upload to remote servers halfway through the analysis (<xref rid="bty387-B56" ref-type="bibr">Yang <italic>et al.</italic>, 2016</xref>). Our implementation is targeted towards researchers who may not have access to high performance computing and wish to run metagenomics workflows on a laptop, for this reason we elected to compare our tool against ARGs-OAP as it was one of three published resistome profilers that is targeted for metagenomic workflows (<xref ref-type="fig" rid="bty387-F1">Fig. 1</xref>). We also tried using AMRPlusPlus and SEAR in this benchmark but we could not get them to run using our 1-core laptop configuration (<xref rid="bty387-B26" ref-type="bibr">Lakin <italic>et al.</italic>, 2017</xref>; <xref rid="bty387-B45" ref-type="bibr">Rowe <italic>et al.</italic>, 2015</xref>). However, as GROOT also scales for use on larger servers, we were able to include a comparison of GROOT and AMRPlusPlus. Although this comparison is still slightly unfair as GROOT is a self-contained resistome profiler and AMRPlusPlus is a pipeline that involves many additional steps, this comparison is useful as it shows GROOT is comparable to an approach using linear reference-based read mapping [as AMRPlusPlus uses BWA to align reads (<xref rid="bty387-B27" ref-type="bibr">Li, 2013</xref>)].</p>
    <p>With the advent of long-read and barcoding protocols for resistome profiling, it is tempting to think that tools for short read resistome profiling may prove less relevant in the near future (<xref rid="bty387-B18" ref-type="bibr">Guérillot <italic>et al.</italic>, 2018</xref>; <xref rid="bty387-B20" ref-type="bibr">Van Der Helm <italic>et al.</italic>, 2017</xref>). However, Illumina sequencing currently remains the standard technology for metagenomics applications and historic Illumina datasets will also need to be reanalysed where new sampling is not feasible. In addition, our method can be used in conjunction with other new methods that elucidate gene context in metagenomics samples, allowing for novel insights to be gained from analysis and re-analysis of metagenomic data collections (<xref rid="bty387-B35" ref-type="bibr">Olekhnovich <italic>et al.</italic>, 2018</xref>).</p>
    <p>Our implementation offers efficient and accurate resistome profiling, enabling the identification of full-length ARGs in complex samples. It should be noted that this method is database dependent and is not intended for the identification of novel ARGs. The implementation is easy and quick to run as there is no complicated installation or dependencies, no split local/remote processing, it facilitates streaming of input and is built using Go’s concurrency patterns.</p>
  </sec>
  <sec>
    <title>5 Conclusions</title>
    <p>We present a method for resistome profiling that utilizes a novel index and search strategy to accurately type resistance genes in metagenomic samples. The use of variation graphs yields several advantages over other methods using linear reference sequences. GROOT performed much more quickly than a recent resistome profiling tool, and also recorded few false positives and negatives. Our method is not restricted to resistome profiling and has the potential to improve current metagenomic workflows.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Material</label>
      <media xlink:href="bty387_supplementary_material.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>
      <italic>Availability and implementation.</italic>
    </p>
    <p>The source code for our implementation, as well as the code used to evaluate its performance and plot the manuscript figures, can be found in the GROOT repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/will-rowe/groot">https://github.com/will-rowe/groot</ext-link>) (MIT License. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1217889">https://doi.org/10.5281/zenodo.1217889</ext-link>).</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported in part by the STFC Hartree Centre’s Innovation Return on Research programme, funded by the Department for Business, Energy &amp; Industrial Strategy.</p>
    </sec>
    <sec>
      <title>Authors’ contributions</title>
      <p>W.P.M.R. conceived and implemented the method. All authors wrote, read and approved the final manuscript.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty387-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Auffret</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>The rumen microbiome as a reservoir of antimicrobial resistance and pathogenicity genes is directly affected by diet in beef cattle</article-title>. <source>Microbiome</source>, <volume>5</volume>, <fpage>159.</fpage><pub-id pub-id-type="pmid">29228991</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baquero</surname><given-names>F.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Metagenomic epidemiology: a public health need for the control of antimicrobial resistance</article-title>. <source>Clin. Microbiol. Infect</source>., <volume>18</volume>, <fpage>67</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Bawa</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) LSH forest: self-tuning indexes for similarity search. <italic>Proceedings of the 14th International Conference on World Wide Web – WWW ’05</italic>, p.651.</mixed-citation>
    </ref>
    <ref id="bty387-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bengtsson</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Greko</surname><given-names>C.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Antibiotic resistance–consequences for animal health, welfare, and food production</article-title>. <source>Ups. J. Med. Sci</source>., <volume>119</volume>, <fpage>96</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">24678738</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berlin</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Assembling large genomes with single-molecule sequencing and locality-sensitive hashing</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>623</fpage>–<lpage>630</lpage>.<pub-id pub-id-type="pmid">26006009</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bradley</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Rapid antibiotic-resistance predictions from genome sequence data for Staphylococcus aureus and Mycobacterium tuberculosis</article-title>. <source>Nat. Commun</source>., <volume>6</volume>, <fpage>10063</fpage>.<pub-id pub-id-type="pmid">26686880</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Broder</surname><given-names>A.Z.</given-names></name></person-group> (<year>2000</year>) Identifying and filtering near-duplicate documents. In <italic>Annual Symposium on Combinatorial Pattern Matching</italic>, pp. <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Broder</surname><given-names>A.Z.</given-names></name></person-group> (<year>1997</year>) On the resemblance and containment of documents. In <italic>Proceedings. Compression and Complexity of SEQUENCES (Cat. No.97TB100171)</italic> IEEE Comput. Soc., pp. <fpage>21</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>C.T.</given-names></name>, <name name-style="western"><surname>Irber</surname><given-names>L.</given-names></name></person-group> (<year>2016</year>) 
<article-title>sourmash: a library for MinHash sketching of DNA</article-title>. <source>J. Open Source Softw</source>., <volume>1</volume>, <fpage>27.</fpage></mixed-citation>
    </ref>
    <ref id="bty387-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bush</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Jacoby</surname><given-names>G.A.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Updated functional classification of beta-lactamases</article-title>. <source>Antimicrob. Agents Chemother</source>., <volume>54</volume>, <fpage>969</fpage>–<lpage>976</lpage>.<pub-id pub-id-type="pmid">19995920</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Bushnell</surname><given-names>B.</given-names></name></person-group> (<year>2014</year>) 
<article-title>BBMap: a fast, accurate, splice-aware aligner</article-title>. In: <italic>9th Annual Genomics of Energy &amp; Environment Meeting</italic>, 
<publisher-name>Walnut Creek, CA</publisher-name>, March 17-20, 2014.</mixed-citation>
    </ref>
    <ref id="bty387-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Clausen</surname><given-names>P.T.L.C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Benchmarking of methods for identification of antimicrobial resistance genes in bacterial whole genome data</article-title>. <source>J. Antimicrob. Chemother</source>., <volume>71</volume>, <fpage>2484</fpage>–<lpage>2488</lpage>.<pub-id pub-id-type="pmid">27365186</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dale</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Bioconda: a sustainable and comprehensive software distribution for the life sciences</article-title>. <source>bioRxiv</source>, <fpage>207092</fpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Garrison</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Sequence variation aware references and read mapping with vg: the variation graph toolkit</article-title>. <source>bioRxiv</source>, <fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gionis</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>1999</year>) 
<article-title>Similarity search in high dimensions via hashing</article-title>. <source>VLDB ’99 Proceedings of the 25th International Conference Very Large Data Bases</source>, <volume>99</volume>, <fpage>518</fpage>–<lpage>529</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B16">
      <mixed-citation publication-type="other">Google. FarmHash. <ext-link ext-link-type="uri" xlink:href="https://github.com/google/farmhash">https://github.com/google/farmhash</ext-link>.</mixed-citation>
    </ref>
    <ref id="bty387-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Gryski</surname><given-names>D.</given-names></name></person-group> (<year>2014</year>) go-spooky. <ext-link ext-link-type="uri" xlink:href="https://github.com/dgryski/go-spooky">https://github.com/dgryski/go-spooky</ext-link>.</mixed-citation>
    </ref>
    <ref id="bty387-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guérillot</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Comprehensive antibiotic-linked mutation assessment by Resistance Mutation Sequencing (RM-seq)</article-title>. <source>bioRxiv</source>, <fpage>257915</fpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S.K.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>ARG-ANNOT, a new bioinformatic tool to discover antibiotic resistance genes in bacterial genomes</article-title>. <source>Antimicrob. Agents Chemother</source>., <volume>58</volume>, <fpage>212</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">24145532</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Der Helm</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Rapid resistome mapping using nanopore sequencing</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, gkw1328.</mixed-citation>
    </ref>
    <ref id="bty387-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hunt</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>ARIBA: rapid antimicrobial resistance genotyping directly from sequencing reads</article-title>. <source>Microb. Genom</source>., <volume>3</volume>, <fpage>e000131</fpage>.<pub-id pub-id-type="pmid">29177089</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Inouye</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>SRST2: rapid genomic surveillance for public health and hospital microbiology labs</article-title>. <source>Genome Med</source>., <volume>6</volume>, <fpage>90</fpage>.<pub-id pub-id-type="pmid">25422674</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jalali</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Screening currency notes for microbial pathogens and antibiotic resistance genes using a shotgun metagenomic approach</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0128711</fpage>.<pub-id pub-id-type="pmid">26035208</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Jenkins</surname><given-names>B.</given-names></name></person-group> SpookyHash: a 128-bit noncryptographic hash. <ext-link ext-link-type="uri" xlink:href="http://burtleburtle.net/bob/hash/spooky.html">http://burtleburtle.net/bob/hash/spooky.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="bty387-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jia</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>CARD 2017: expansion and model-centric curation of the comprehensive antibiotic resistance database</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D566</fpage>–<lpage>D573</lpage>.<pub-id pub-id-type="pmid">27789705</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lakin</surname><given-names>S.M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>MEGARes: an antimicrobial resistance database for high throughput sequencing</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D574</fpage>–<lpage>D580</lpage>.<pub-id pub-id-type="pmid">27899569</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM.</mixed-citation>
    </ref>
    <ref id="bty387-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>VRprofile: gene-cluster-detection-based profiling of virulence and antibiotic resistance traits encoded within genome sequences of pathogenic bacteria</article-title>. <source>Brief Bioinform</source>., bbw141.</mixed-citation>
    </ref>
    <ref id="bty387-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M.</given-names></name></person-group> (<year>2009</year>) 
<article-title>ARDB–Antibiotic Resistance Genes Database</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>D443</fpage>–<lpage>D447</lpage>.<pub-id pub-id-type="pmid">18832362</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Catalogue of antibiotic resistome and host-tracking in drinking water deciphered by a large scale survey</article-title>. <source>Microbiome</source>, <volume>5</volume>, <fpage>154</fpage>.<pub-id pub-id-type="pmid">29179769</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>R.R.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Metagenomics for pathogen detection in public health</article-title>. <source>Genome Med</source>., <volume>5</volume>, <fpage>81.</fpage><pub-id pub-id-type="pmid">24050114</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Morrison</surname><given-names>D.R.</given-names></name></person-group> (<year>1968</year>) 
<article-title>PATRICIA—practical algorithm to retrieve information coded in alphanumeric</article-title>. <source>J. ACM</source>, <volume>15</volume>, <fpage>514</fpage>–<lpage>534</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Munk</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A sampling and metagenomic sequencing-based methodology for monitoring antimicrobial resistance in swine herds</article-title>. <source>J. Antimicrob. Chemother</source>., <volume>72</volume>, <fpage>385</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">28115502</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>O’Neill</surname><given-names>J.</given-names></name></person-group> (<year>2016</year>) <source>Tackling Drug-Resistant Infections Globally: Final Report and Recommendations. The Review on Antimicrobial Resistance</source>. 
<publisher-loc>London</publisher-loc>: 
<publisher-name>HM Government and the Wellcome Trust</publisher-name>; 2016.</mixed-citation>
    </ref>
    <ref id="bty387-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Olekhnovich</surname><given-names>E.I.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>MetaCherchant: analyzing genomic context of antibiotic resistance genes in gut microbiota</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>434</fpage>–<lpage>444</lpage>.<pub-id pub-id-type="pmid">29092015</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ondov</surname><given-names>B.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>, <volume>17</volume>, <fpage>132</fpage>.<pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Paten</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Genome graphs and the evolution of genome inference</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>665</fpage>–<lpage>676</lpage>.<pub-id pub-id-type="pmid">28360232</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petersen</surname><given-names>T.N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>MGmapper: reference based mapping and taxonomy annotation of metagenomics sequence reads</article-title>. <source>PLoS One</source>, <volume>12</volume>, <fpage>e0176469</fpage>.<pub-id pub-id-type="pmid">28467460</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Popic</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group> (<year>2017</year>) 
<article-title>A hybrid cloud read aligner based on MinHash and kmer voting that preserves privacy</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15311.</fpage><pub-id pub-id-type="pmid">28508884</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B40">
      <mixed-citation publication-type="other"><collab>Public Health Agency of Canada</collab>. (<year>2016</year>) Canadian antimicrobial resistance surveillance system – Report 2016. Guelph, Canada.</mixed-citation>
    </ref>
    <ref id="bty387-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Quedenfeld</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Variant tolerant read mapping using min-hashing</article-title>. <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
    </ref>
    <ref id="bty387-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rognes</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>VSEARCH: a versatile open source tool for metagenomics</article-title>. <source>PeerJ</source>, <volume>4</volume>, <fpage>e2584.</fpage><pub-id pub-id-type="pmid">27781170</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rose</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Antibiotic resistance potential of the healthy preterm infant gut microbiome</article-title>. <source>PeerJ</source>, <volume>5</volume>, <fpage>e2928.</fpage><pub-id pub-id-type="pmid">28149696</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rowe</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Comparative metagenomics reveals a diverse range of antimicrobial resistance genes in effluents entering a river catchment</article-title>. <source>Water Sci. Technol</source>., <volume>73</volume>, <fpage>1541</fpage>–<lpage>1549</lpage>.<pub-id pub-id-type="pmid">27054725</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rowe</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Search engine for antimicrobial resistance: a cloud compatible pipeline and web interface for rapidly detecting antimicrobial resistance genes directly from sequence data</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0133492.</fpage><pub-id pub-id-type="pmid">26197475</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rowe</surname><given-names>W.P.M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Overexpression of antibiotic resistance genes in hospital effluents over time</article-title>. <source>J. Antimicrob. Chemother</source>., <volume>72</volume>, <fpage>1617</fpage>–<lpage>1623</lpage>.<pub-id pub-id-type="pmid">28175320</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schneeberger</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Simultaneous alignment of short reads against multiple genomes</article-title>. <source>Genome Biol</source>., <volume>10</volume>, <fpage>R98.</fpage><pub-id pub-id-type="pmid">19761611</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sczyrba</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Critical assessment of metagenome interpretation—a benchmark of metagenomics software</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>1063</fpage>–<lpage>1071</lpage>.<pub-id pub-id-type="pmid">28967888</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B49">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Sirén</surname><given-names>J.</given-names></name></person-group> (<year>2016</year>) Indexing variation graphs. <italic>arXiv</italic>.1604.06605.</mixed-citation>
    </ref>
    <ref id="bty387-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tao</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>High levels of antibiotic resistance genes and their correlations with bacterial community and mobile genetic elements in pharmaceutical wastewater treatment bioreactors</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0156854</fpage>.<pub-id pub-id-type="pmid">27294780</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van der Walt</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Assembling metagenomes, one community at a time</article-title>. <source>BMC Genom</source>., <volume>18</volume>, <fpage>521.</fpage></mixed-citation>
    </ref>
    <ref id="bty387-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wick</surname><given-names>R.R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Bandage: interactive visualization of de novo genome assemblies</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3350</fpage>–<lpage>3352</lpage>.<pub-id pub-id-type="pmid">26099265</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Winglee</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Recent urbanization in China is correlated with a Westernized microbiome encoding increased virulence and antibiotic resistance genes</article-title>. <source>Microbiome</source>, <volume>5</volume>, <fpage>121</fpage>.<pub-id pub-id-type="pmid">28915922</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B54">
      <mixed-citation publication-type="other"><collab>World Health Organization</collab>. (<year>2015</year>) <italic>Global Antimicrobial Resistance Surveillance System Manual for Early Implementation Global Antimicrobial Resistance Surveillance System</italic>.</mixed-citation>
    </ref>
    <ref id="bty387-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xie</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>TADB 2.0: an updated database of bacterial type II toxin-antitoxin loci</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D749</fpage>–<lpage>D753</lpage>.<pub-id pub-id-type="pmid">29106666</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>ARGs-OAP: online analysis pipeline for antibiotic resistance genes detection from metagenomic data using an integrated structured ARG-database</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2346</fpage>–<lpage>2351</lpage>.<pub-id pub-id-type="pmid">27153579</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Exploring variation of antibiotic resistance genes in activated sludge over a four-year period through a metagenomic approach</article-title>. <source>Environ. Sci. Technol</source>., <volume>47</volume>, <fpage>10197</fpage>–<lpage>10205</lpage>.<pub-id pub-id-type="pmid">23919449</pub-id></mixed-citation>
    </ref>
    <ref id="bty387-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zankari</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Identification of acquired antimicrobial resistance genes</article-title>. <source>J. Antimicrob. Chemother</source>., <volume>67</volume>, <fpage>2640</fpage>–<lpage>2644</lpage>.<pub-id pub-id-type="pmid">22782487</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
