<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">g3journal</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8496211</article-id>
    <article-id pub-id-type="pmid">34544141</article-id>
    <article-id pub-id-type="doi">10.1093/g3journal/jkab250</article-id>
    <article-id pub-id-type="publisher-id">jkab250</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>orthofisher: a broadly applicable tool for automated gene identification and retrieval</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8436-595X</contrib-id>
        <name>
          <surname>Steenwyk</surname>
          <given-names>Jacob L</given-names>
        </name>
        <xref rid="jkab250-cor1" ref-type="corresp"/>
        <xref rid="jkab250-aff1" ref-type="aff"/>
        <!--jacob.steenwyk@vanderbilt.edu-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7248-6551</contrib-id>
        <name>
          <surname>Rokas</surname>
          <given-names>Antonis</given-names>
        </name>
        <xref rid="jkab250-cor1" ref-type="corresp"/>
        <xref rid="jkab250-aff1" ref-type="aff"/>
        <!--antonis.rokas@vanderbilt.edu-->
      </contrib>
    </contrib-group>
    <aff id="jkab250-aff1"><institution>Department of Biological Sciences, Vanderbilt University</institution><addr-line>, Nashville</addr-line>, TN 37235, <country country="US">USA</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Comeron</surname>
          <given-names>J M</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="jkab250-cor1">Corresponding author: Email: <email>jacob.steenwyk@vanderbilt.edu</email> (J.L.S.); <email>antonis.rokas@vanderbilt.edu</email> (A.R.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-15">
      <day>15</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue>9</issue>
    <elocation-id>jkab250</elocation-id>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2021. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab250.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Identification and retrieval of genes of interest from genomic data are an essential step for many bioinformatic applications. We present orthofisher, a command-line tool for automated identification and retrieval of genes with high sequence similarity to a query profile Hidden Markov Model sequence alignment across a set of proteomes. Performance assessment of orthofisher revealed high accuracy and precision during single-copy orthologous gene identification. orthofisher may be useful for assessing gene annotation quality, identifying single-copy orthologous genes for phylogenomic analyses, estimating gene copy number, and other evolutionary analyses that rely on identification and retrieval of homologous genes from genomic data. orthofisher comes complete with comprehensive documentation (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://jlsteenwyk.com/orthofisher/" ext-link-type="uri">https://jlsteenwyk.com/orthofisher/</ext-link>), is freely available under the MIT license, and is available for download from GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/JLSteenwyk/orthofisher" ext-link-type="uri">https://github.com/JLSteenwyk/orthofisher</ext-link>), PyPi (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pypi.org/project/orthofisher/" ext-link-type="uri">https://pypi.org/project/orthofisher/</ext-link>), and the Anaconda Cloud (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://anaconda.org/jlsteenwyk/orthofisher" ext-link-type="uri">https://anaconda.org/jlsteenwyk/orthofisher</ext-link>).</p>
    </abstract>
    <kwd-group>
      <kwd>phylogenomics</kwd>
      <kwd>homology</kwd>
      <kwd>orthology</kwd>
      <kwd>Hidden Markov Model</kwd>
      <kwd>gene family</kwd>
      <kwd>sequence similarity search</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>DEB-1442113</award-id>
        <award-id>DEB-2110404</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>R56 AI146096</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Guggenheim Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100005851</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Burroughs Wellcome Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/100000861</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Sequence similarity searches of genomic data are commonly employed in diverse fields of biology. Several pieces of software have been designed to infer statistically homologous sequences from databases of sequence data, such as BLAST, DIAMOND, and HMMER (<xref rid="jkab250-B2" ref-type="bibr">Camacho <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="jkab250-B5" ref-type="bibr">Eddy 2011</xref>; <xref rid="jkab250-B9" ref-type="bibr">Madden 2013</xref>; <xref rid="jkab250-B1" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>). One frequent use of sequence similarity search methods is for the identification of orthologs, sequences present in the common ancestor of two species, and homologs, sequences that stem from the same common ancestral sequence (<xref rid="jkab250-B7" ref-type="bibr">GabaldÃ³n and Koonin 2013</xref>). For example, the OrthoFinder software conducts BLAST all-<italic toggle="yes">vs</italic>-all searches across proteomes to infer groups of putatively orthologous genes (<xref rid="jkab250-B6" ref-type="bibr">Emms and Kelly 2019</xref>). Similarly, the BUSCO software aims to identify putatively orthologous genes using a predetermined set of profile Hidden Markov Model sequence alignments (pHMMs) derived from single-copy orthologous proteins from the OrthoDB database (<xref rid="jkab250-B17" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="jkab250-B16" ref-type="bibr">2018</xref>).</p>
    <p>The results of these or similar pieces of software can facilitate diverse downstream analyses (<xref rid="jkab250-B11" ref-type="bibr">Remm <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="jkab250-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2003</xref>; <xref rid="jkab250-B15" ref-type="bibr">Train <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkab250-B16" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkab250-B6" ref-type="bibr">Emms and Kelly 2019</xref>). However, global analyses, such as those conducted by OrthoFinder, are computationally expensive and may be beyond the scope of a research project (<italic toggle="yes">e.g.</italic>, studies focused on a few genes). Similarly, software that rely on databases, such as BUSCO, are constrained to the orthologs therein. As a result, there is a need for bioinformatic software that can conduct automated identification and retrieval of putative homologs and orthologs across sequence databases using user-specified query sequences and output files that facilitate downstream analyses.</p>
    <p>We introduce orthofisher, a command-line toolkit for automated identification of highly similar sequences across proteomes using custom pHMMs. orthofisher facilitates downstream analyses by creating multi-FASTA files populated with highly similar sequences identified during pHMM searches. Default parameters are designed to identify sequences with the highest sequence similarity (<italic toggle="yes">i.e.</italic>, putative orthologous genes), but users can customize its use to best fit their research question (<italic toggle="yes">e.g.</italic>, relaxed thresholds can be used to obtain all putatively homologous genes; similarly, searches in databases that contain gene isoforms can be used to retrieve all isoforms of a particular gene). We demonstrate the efficacy of orthofisher by evaluating the precision and recall for the identification of sequences with high similarity to query pHMMs in a multiple sequence FASTA (multi-FASTA) files from animals, plants, and fungi. Comparison of orthofisher, BUSCO, and OrthoFinder revealed similar performance in identification of sequences with high sequence similarity. Thus, orthofisher aims to streamline gene identification and retrieval from genomic data, which is the first step of many bioinformatic analyses and projects. We anticipate orthofisher will be of interest to diverse fields of computational biology and to biologists and bioinformaticians.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>orthofisher requires two files as input (<xref rid="jkab250-F1" ref-type="fig">Figure 1</xref>). One fileâspecified with the -m, âhmm argumentâprovides the paths to query pHMMs that will be used during sequence similarity search; the other fileâspecified with the -f, âfasta argumentâprovides the paths to FASTA files that will be used as the sequence search database. orthofisher then loops through each FASTA file and uses each pHMM to search for similar sequences using HMMER3 (<xref rid="jkab250-B5" ref-type="bibr">Eddy 2011</xref>) with an expectation-value threshold of 0.001 (which can be modified with the -e, âevalue argument). orthofisher then parses the resulting HMMER3 output using biopython (<xref rid="jkab250-B3" ref-type="bibr">Cock <italic toggle="yes">et al.</italic> 2009</xref>) and identifies top hits. Top hits are defined following criteria used in the BUSCO pipeline (<xref rid="jkab250-B16" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2018</xref>) wherein all sequences with scores that are greater than or equal to 85% of the score of the best hit are maintained. Users can modify this threshold using the -b, âbitscore argument. Top hits are considered homologous genes.</p>
    <fig position="float" id="jkab250-F1">
      <label>Figure 1</label>
      <caption>
        <p>Workflow overview for orthofisher. orthofisher takes two files as input, which specify the location of query pHMMs and the FASTA files wherein sequence similarity searches will be performed. orthofisher then outputs three directories and two text files that summarize results and facilitate downstream analyses.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab250f1" position="float"/>
    </fig>
    <p>orthofisher outputs three directories and two text files that enable researchers to easily evaluate results from sequence similarity search and facilitate downstream analyses. The three directories are
</p>
    <list list-type="bullet">
      <list-item>
        <p><italic toggle="yes">hmmsearch_output</italic>: HMMER3 output files,</p>
      </list-item>
      <list-item>
        <p><italic toggle="yes">all_sequences</italic>: one multi-FASTA file per pHMM, which are populated with homologous sequences identified during the sequence similarity search step, and</p>
      </list-item>
      <list-item>
        <p><italic toggle="yes">scog</italic>: one multi-FASTA file per pHMM, which are populated with only those homologous sequences that are present at most only once in each genome.</p>
      </list-item>
    </list>
    <p>The two text files are
</p>
    <list list-type="bullet">
      <list-item>
        <p><italic toggle="yes">short_summary.txt</italic>: the number and percentage of sequences present in single-copy, multicopy, or absent sequences per pHMM search and</p>
      </list-item>
      <list-item>
        <p><italic toggle="yes">long_summary.txt</italic>: the homologous sequences identified during pHMM search for every query and sequence database.</p>
      </list-item>
    </list>
    <p>Contents of output files will be heavily dependent on user parameters, the pHMMs used, and the input files. For example, transcriptomic data may require additional processing steps such as collapsing isoforms into a single-representative sequence per gene. The intent of orthofisherâwhich is to identify single-copy orthologous genesâis flexible enough to capture paralogous sequences as well. A tutorial for how to use orthofisher is publicly available as part of the online documentation <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://jlsteenwyk.com/orthofisher/tutorial" ext-link-type="uri">https://jlsteenwyk.com/orthofisher/tutorial (last accessed: 2021-07-14)</ext-link>.</p>
    <p>Nearly 30% of bioinformatic tools fail to install (<xref rid="jkab250-B10" ref-type="bibr">Mangul <italic toggle="yes">et al.</italic> 2019</xref>), which poses a nontrivial problem for the reproducibility of computational experiments. To remedy this issue, we implemented state-of-the-art standards of software development practices and design principles (<xref rid="jkab250-B4" ref-type="bibr">Darriba <italic toggle="yes">et al.</italic> 2018</xref>) following previously established protocol (<xref rid="jkab250-B13" ref-type="bibr">Steenwyk <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="jkab250-B12" ref-type="bibr">2021</xref>). For example, whenever changes to code are made, faithful function of orthofisher is tested using a continuous integration pipeline, a process that automatically builds, packages, and tests installation and function using Python versions 3.6, 3.7, and 3.8. We also wrote several unit and integration tests that span 95% of the orthofisher code.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>To determine the similarities and differences between orthofisher and other algorithms that identify putative orthologs, we compared results obtained from orthofisher with that of BUSCO and OrthoFinder. BUSCO and OrthoFinder are both widely adopted methods of identifying orthologous genes across multiple proteomes. As noted in the introduction, each software differsâmore specifically, BUSCO conducts homology searches using a predefined set of pHMMs and OrthoFinder conducts proteome-wide analysis to identify groups of orthologous genes. Thus, we expect that if orthofisher can identify putative orthologs across proteomes, it will identify the same genes BUSCO identifies during its sequence similarity search. Given that both algorithms conduct pHMM-based searches, we anticipate that both will exhibit near-identical performances. When comparing orthofisher and BUSCO to OrthoFinder, we anticipate the sequences identified during sequence similarity search by orthofisher and BUSCO will be in the same orthologous group of genes inferred by OrthoFinder.</p>
    <sec>
      <title>orthofisher and BUSCO obtain similar results</title>
      <p>To evaluate the efficacy of orthofisher, we compared results obtained from orthofisher to those obtained from BUSCO, v4.0.4 (<xref rid="jkab250-B16" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2018</xref>). To do so, both algorithms were used to identify 255 near-universally single-copy orthologous genes obtained from the Eukaryota OrthoDB, v10 (<xref rid="jkab250-B17" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2013</xref>), database across the proteomes of animals (<italic toggle="yes">Homo sapiens</italic>: GCF_000001405.39; <italic toggle="yes">Mus musculus</italic>: GCF_000001635.27), plants (<italic toggle="yes">Arabidopsis thaliana</italic>, NCBI accession: GCA_000001735.2; <italic toggle="yes">Solanum lycopersicum</italic>: GCF_000188115.4), and fungi (<italic toggle="yes">Saccharomyces cerevisiae</italic>, NCBI accession: GCA_000146045.2; <italic toggle="yes">Candida albicans</italic>: GCA_000182965.3). Measures of precision and recall were calculated as follows:
<disp-formula id="E1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mml:mi mathvariant="normal">Precision</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"/><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="E2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:mi mathvariant="normal">Recall</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"/><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula>
where TP represents true positives, FP represents false positives, and FN represents false negatives of single-copy orthologous genes. Precision and recall values range from 0 to 1 and higher values reflect better performance.</p>
      <p>Near perfect values of precision and recall {0.98 or [231/(231â+â4)] and 1.0 or [231/(231â+â0)], respectively} reveal orthofisher is able to automate the identification and retrieval of sequences with high similarity to the query pHMM. A low false-positive rate of 0.02 was observed. The difference in the performance of BUSCO and orthofisher stems from an additional set of gene-specific score and length thresholds used by the BUSCO software, which are not implemented in orthofisher. These results demonstrate that orthofisher can accurately identify homologous genes.</p>
      <p>To demonstrate the importance of using a score threshold of 85% of the score observed in the best hit following the BUSCO pipeline (<xref rid="jkab250-B16" ref-type="bibr">Waterhouse <italic toggle="yes">et al.</italic> 2018</xref>), we highlight an example where absence of a score threshold would have led to the identification of additional putatively orthologous genes. An HMMER search using the query BUSCO pHMM 1001705at2759 and an <italic toggle="yes">e</italic>-value threshold of 1e-10 in the proteome of <italic toggle="yes">A. thaliana</italic> reports the gene as multicopy whereas both orthofisher and BUSCO report this gene to be single copy. More specifically, when using only an <italic toggle="yes">e</italic>-value threshold of 1e-10, the following nine genes are reported: AEE76455.1, AEE78573.1, AEC10322.1, ANM68500.1, AED93406.1, AEE76521.1, AEE82221.1, AED98328.1, and AEE29324.1; however, AEE76455.1 has a score of 242.5 and the next best hit, AEE78573.1 has a score of 64.5. Thus, a score threshold of 85% of the best hit (in this case 242.5*0.85) is helpful during sequence similarity searches.</p>
    </sec>
    <sec>
      <title>orthofisher and BUSCO perform similarly to OrthoFinder</title>
      <p>Comparison of the results of BUSCO and orthofisher to OrthoFinder, a global (or whole proteome) ortholog calling algorithm revealed BUSCO, orthofisher, and OrthoFinder produce similar results. To perform these comparisons, we first used OrthoFinder, v2.3.8 (<xref rid="jkab250-B6" ref-type="bibr">Emms and Kelly 2019</xref>), to identify putative orthologous groups of genes in the same animal, plant, and fungal proteomes described above using an inflation parameter of 1.5 and DIAMOND, v0.9.24.125 (<xref rid="jkab250-B1" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>). Then, we determined if genes identified as multicopy are part of the same or different orthologous group(s) of genes and also assessed if genes identified as single copy in BUSCO or orthofisher were also single copy in OrthoFinder.</p>
      <p>Among multicopy genes, we found BUSCO and OrthoFinder had nearly identical performance in the proteomes of <italic toggle="yes">A. thaliana</italic>, <italic toggle="yes">S. lycopersicum</italic>, and <italic toggle="yes">C. albicans</italic>. For <italic toggle="yes">S. cerevisiae</italic>, one gene, 1545004at2759, out of 255 differed between BUSCO and OrthoFinder wherein BUSCO identified two homologs and OrthoFinder split these two genes into different orthologous groups of genes. A similar scenario was observed among 12/255 and 3/255 genes in the human and mouse proteomes, respectively. For orthofisher, a similar scenario was observed for 1/255 genes in <italic toggle="yes">S. lycopersicum</italic>; 1/255 genes in <italic toggle="yes">A. thaliana</italic>; 8/255 genes in <italic toggle="yes">S. cerevisiae</italic>; 4/255 genes in <italic toggle="yes">C. albicans</italic>; 13/255 genes in the human proteome; and 4/255 genes in the mouse proteome. We note that isoforms of the same gene sequence were present in the analyzed proteomes and were accounted for in these analyses.</p>
      <p>Among single-copy genes, we observed a few instances where single-copy genes in BUSCO were multicopy in OrthoFinder. More specifically, this was observed for 8 genes in <italic toggle="yes">S. lycopersicum</italic>; 16 genes in <italic toggle="yes">A. thaliana</italic>; 2 genes in <italic toggle="yes">S. cerevisiae</italic>; 2 genes in <italic toggle="yes">C. albicans</italic>; 36 genes in the human proteome; and 26 genes in the mouse proteome. Similar results were observed for orthofisher. More specifically, 16/255 genes in <italic toggle="yes">A. thaliana</italic> were identified as single copy by orthofisher but were in multicopy orthologous groups of genes in OrthoFinder. The same observation was made for 7/255 genes in <italic toggle="yes">S. lycopersicum</italic>; 1/255 gene in <italic toggle="yes">S. cerevisiae</italic>; 2/255 genes in <italic toggle="yes">C. albicans</italic>; 35/255 genes in the human proteome; and 24/255 genes in the mouse proteome.</p>
      <p>In summary, sequence similarity searches of 255 genes in 6 proteomes identified differences among 105 genes (6.86%; 105/1530) between BUSCO and OrthoFinder; similarly, we identified differences among 116 genes (7.58%; 116/1530) between orthofisher and OrthoFinder. These differences likely stem from differences in the approach of each algorithm to identify putative orthologs. Specifically, OrthoFinder uses DIAMOND and Markov clustering to identify orthologous groups, BUSCO uses pHMM-based search and gene-specific score and length thresholds using OrthoDB, and orthofisher uses pHMM-based similarity search thresholds. Also, these differences are in part driven by each algorithm reporting different results (<italic toggle="yes">i.e.</italic>, OrthoFinder reports groups of putatively orthologous genes and BUSCO and orthofisher report putative orthologous genes).</p>
    </sec>
    <sec>
      <title>orthofisher is helpful for estimating the number of members in a gene family</title>
      <p>To demonstrate how to use orthofisher to estimate the number of gene family members, we estimate the number of DNA photolyase (PFam: PF00875) and zinc finger, C2H2 type (PFam: PF00096) homologs in <italic toggle="yes">S. cerevisiae</italic>, <italic toggle="yes">C. albicans</italic>, two species from the <italic toggle="yes">Hanseniaspora</italic> genus (<italic toggle="yes">H. uvarum</italic> NRRL Y1614 and <italic toggle="yes">H. vineae</italic> NRRL Y17529, both of which are known to lack DNA photolyases (<xref rid="jkab250-B14" ref-type="bibr">Steenwyk <italic toggle="yes">et al.</italic> 2019</xref>)), and three <italic toggle="yes">Aspergillus</italic> species (<italic toggle="yes">A. niger</italic> CBS 513.88, <italic toggle="yes">A. fumigatus</italic> Af293, and <italic toggle="yes">A. flavus</italic> NRRL 3357). When estimating gene family number, we recommend lowering the score threshold to, for example, 25% of the best hit, which we have done here. In line with previous reports, we found that <italic toggle="yes">Hanseniaspora</italic> species lacked DNA photolyases whereas <italic toggle="yes">S. cerevisiae</italic>, <italic toggle="yes">C. albicans</italic>, and all <italic toggle="yes">Aspergillus</italic> species had one or two DNA photolyases. In contrast, proteins with Zinc finger domains are more abundant across all species with copies ranging from 16 (<italic toggle="yes">H. vineae</italic>) to 39 (<italic toggle="yes">A. flavus</italic>).</p>
    </sec>
  </sec>
  <sec>
    <title>Practical considerations</title>
    <p>The intended use of orthofisher is to help identify orthologous genes across species using accurate and sensitive pHMM-based searches. We encourage users to evaluate results produced by orthofisher using additional approaches (<italic toggle="yes">e.g.</italic>, phylogenetic inference) to infer precise relationships of orthology and paralogy among sequences. We note that orthofisher is not explicitly designed to identify a single-representative sequence if multiple isoforms encoded by one gene sequence are present in a proteome. Thus, we also suggest users collapse isoforms prior to or after orthofisher analysis following standard protocol in many transcriptomics studies.</p>
    <p>In summary, orthofisher is a command-line tool for automated identification and retrieval of genes of interest from genomic data. We anticipate orthofisher will be useful for evaluating genome completeness, performing phylogenomic inferences, estimating gene family size, and other analyses that rely on identification and retrieval of homologous genes from genomic data.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>orthofisher comes complete with comprehensive documentation (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://jlsteenwyk.com/orthofisher/" ext-link-type="uri">https://jlsteenwyk.com/orthofisher/</ext-link>) (last accessed: 2021-07-14), is freely available under the MIT license, and is available for download from GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/JLSteenwyk/orthofisher" ext-link-type="uri">https://github.com/JLSteenwyk/orthofisher</ext-link>) (last accessed: 2021-07-14), PyPi (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pypi.org/project/orthofisher/" ext-link-type="uri">https://pypi.org/project/orthofisher/</ext-link>) (last accessed: 2021-07-14), and the Anaconda Cloud (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://anaconda.org/jlsteenwyk/orthofisher" ext-link-type="uri">https://anaconda.org/jlsteenwyk/orthofisher</ext-link>) (last accessed: 2021-07-14). The proteomes, pHMMs, and outputs of orthofisher, BUSCO, and OrthoFinder are available through figshare (doi:<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="10.6084/m9.figshare.14399150" ext-link-type="doi">10.6084/m9.figshare.14399150</ext-link>).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>The authors thank members of the Rokas laboratory and two anonymous reviewers for useful feedback and discussion.</p>
    <sec>
      <title>Funding</title>
      <p>J.L.S. and A.R. were supported by the Howard Hughes Medical Institute through the James H. Gilliam Fellowships for Advanced Study program. A.R. was supported by the National Science Foundation (DEB-1442113 and DEB-2110404), the National Institutes of Health/National Institute of Allergy and Infectious Diseases (R56 AI146096), the Guggenheim Foundation, and the Burroughs Wellcome Fund.</p>
    </sec>
    <sec>
      <title>Conflicts of interest</title>
      <p>A.R. is a scientific consultant for LifeMine Therapeutics, Inc.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="jkab250-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH.</given-names></string-name></person-group><year>2015</year>. 
<article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source>. <volume>12</volume>:<fpage>59</fpage>â<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camacho</surname><given-names>C</given-names></string-name>, <string-name><surname>Coulouris</surname><given-names>G</given-names></string-name>, <string-name><surname>Avagyan</surname><given-names>V</given-names></string-name>, <string-name><surname>Ma</surname><given-names>N</given-names></string-name>, <string-name><surname>Papadopoulos</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>2009</year>. 
<article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname><given-names>PJA</given-names></string-name>, <string-name><surname>Antao</surname><given-names>T</given-names></string-name>, <string-name><surname>Chang</surname><given-names>JT</given-names></string-name>, <string-name><surname>Chapman</surname><given-names>BA</given-names></string-name>, <string-name><surname>Cox</surname><given-names>CJ</given-names></string-name></person-group>, <etal>et al</etal><year>2009</year>. 
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>. <volume>25</volume>:<fpage>1422</fpage>â<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darriba</surname><given-names>D</given-names></string-name>, <string-name><surname>Flouri</surname><given-names>T</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A.</given-names></string-name></person-group><year>2018</year>. 
<article-title>The state of software for evolutionary biology</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>:<fpage>1037</fpage>â<lpage>1046</lpage>.<pub-id pub-id-type="pmid">29385525</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><year>2011</year>. 
<article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comput Biol</source>. <volume>7</volume>:<fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>DM</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><year>2019</year>. 
<article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biol</source>. <volume>20</volume>:<fpage>238</fpage>.<pub-id pub-id-type="pmid">31727128</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>GabaldÃ³n</surname><given-names>T</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV.</given-names></string-name></person-group><year>2013</year>. 
<article-title>Functional and evolutionary implications of gene orthology</article-title>. <source>Nat Rev Genet</source>. <volume>14</volume>:<fpage>360</fpage>â<lpage>366</lpage>.<pub-id pub-id-type="pmid">23552219</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Stoeckert</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Roos</surname><given-names>DS.</given-names></string-name></person-group><year>2003</year>. 
<article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>. <source>Genome Res</source>. <volume>13</volume>:<fpage>2178</fpage>â<lpage>2189</lpage>.<pub-id pub-id-type="pmid">12952885</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B9">
      <mixed-citation publication-type="journal">Ye J, McGinnis S, Madden TL. 2006. BLAST: improvements for better sequence analysis. Nucleic Acids Res. 34:W6âW9.</mixed-citation>
    </ref>
    <ref id="jkab250-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangul</surname><given-names>S</given-names></string-name>, <string-name><surname>Mosqueiro</surname><given-names>T</given-names></string-name>, <string-name><surname>Abdill</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Duong</surname><given-names>D</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>K</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>Challenges and recommendations to improve the installability and archival stability of omics computational tools</article-title>. <source>PLoS Biol</source>. <volume>17</volume>:<fpage>e3000333</fpage>.<pub-id pub-id-type="pmid">31220077</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remm</surname><given-names>M</given-names></string-name>, <string-name><surname>Storm</surname><given-names>CEV</given-names></string-name>, <string-name><surname>Sonnhammer</surname><given-names>ELL.</given-names></string-name></person-group><year>2001</year>. 
<article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons</article-title>. <source>J Mol Biol</source>. <volume>314</volume>:<fpage>1041</fpage>â<lpage>1052</lpage>.<pub-id pub-id-type="pmid">11743721</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname><given-names>JL</given-names></string-name>, <string-name><surname>Buida</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Labella</surname><given-names>AL</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X-X</given-names></string-name></person-group>, <etal>et al</etal><year>2021</year>. 
<article-title>PhyKIT: a broadly applicable UNIX shell toolkit for processing and analyzing phylogenomic data</article-title>. <source>Bioinformatics</source>.</mixed-citation>
    </ref>
    <ref id="jkab250-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname><given-names>JL</given-names></string-name>, <string-name><surname>Buida</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X-X</given-names></string-name>, <string-name><surname>Rokas</surname><given-names>A.</given-names></string-name></person-group><year>2020</year>. 
<article-title>ClipKIT: a multiple sequence alignment trimming software for accurate phylogenomic inference</article-title>. <source>PLoS Biol</source>. <volume>18</volume>:<fpage>e3001007</fpage>.<pub-id pub-id-type="pmid">33264284</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steenwyk</surname><given-names>JL</given-names></string-name>, <string-name><surname>Opulente</surname><given-names>DA</given-names></string-name>, <string-name><surname>Kominek</surname><given-names>J</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X-X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>Extensive loss of cell-cycle and DNA repair genes in an ancient lineage of bipolar budding yeasts</article-title>. <source>PLoS Biol</source>. <volume>17</volume>:<fpage>e3000255</fpage>.<pub-id pub-id-type="pmid">31112549</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Train</surname><given-names>C-M</given-names></string-name>, <string-name><surname>Glover</surname><given-names>NM</given-names></string-name>, <string-name><surname>Gonnet</surname><given-names>GH</given-names></string-name>, <string-name><surname>Altenhoff</surname><given-names>AM</given-names></string-name>, <string-name><surname>Dessimoz</surname><given-names>C.</given-names></string-name></person-group><year>2017</year>. 
<article-title>Orthologous Matrix (OMA) algorithm 2.0: more robust to asymmetric evolutionary rates and more scalable hierarchical orthologous group inference</article-title>. <source>Bioinformatics</source>. <volume>33</volume>:<fpage>i75</fpage>â<lpage>i82</lpage>.<pub-id pub-id-type="pmid">28881964</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waterhouse</surname><given-names>RM</given-names></string-name>, <string-name><surname>Seppey</surname><given-names>M</given-names></string-name>, <string-name><surname>SimÃ£o</surname><given-names>FA</given-names></string-name>, <string-name><surname>Manni</surname><given-names>M</given-names></string-name>, <string-name><surname>Ioannidis</surname><given-names>P</given-names></string-name></person-group>, <etal>et al</etal><year>2018</year>. 
<article-title>BUSCO applications from quality assessments to gene prediction and phylogenomics</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>:<fpage>543</fpage>â<lpage>548</lpage>.<pub-id pub-id-type="pmid">29220515</pub-id></mixed-citation>
    </ref>
    <ref id="jkab250-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waterhouse</surname><given-names>RM</given-names></string-name>, <string-name><surname>Tegenfeldt</surname><given-names>F</given-names></string-name>, <string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>Zdobnov</surname><given-names>EM</given-names></string-name>, <string-name><surname>Kriventseva</surname><given-names>EV.</given-names></string-name></person-group><year>2013</year>. 
<article-title>OrthoDB: a hierarchical catalog of animal, fungal and bacterial orthologs</article-title>. <source>Nucleic Acids Res</source>. <volume>41</volume>:<fpage>D358</fpage>â<lpage>D365</lpage>.<pub-id pub-id-type="pmid">23180791</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
