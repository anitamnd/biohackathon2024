<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5384132</article-id>
    <article-id pub-id-type="publisher-id">1621</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1621-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pgltools: a genomic arithmetic tool suite for manipulation of Hi-C peak and other chromatin interaction data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Greenwald</surname>
          <given-names>William W.</given-names>
        </name>
        <address>
          <email>billgreenwald@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>He</given-names>
        </name>
        <address>
          <email>hel070@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Erin N.</given-names>
        </name>
        <address>
          <email>ens001@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benaglio</surname>
          <given-names>Paola</given-names>
        </name>
        <address>
          <email>pbenaglio@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nariai</surname>
          <given-names>Naoki</given-names>
        </name>
        <address>
          <email>nnariai@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Frazer</surname>
          <given-names>Kelly A.</given-names>
        </name>
        <address>
          <email>kafrazer@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Bioinformatics and Systems Biology, </institution><institution>University of California, San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, CA 92093 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Institute for Genomic Medicine, </institution><institution>University of California, San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, CA 92093 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Pediatrics and Rady Children’s Hospital, </institution><institution>University of California, San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, CA 92093 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>207</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>3</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Genomic interaction studies use next-generation sequencing (<bold>NGS</bold>) to examine the interactions between two loci on the genome, with subsequent bioinformatics analyses typically including annotation, intersection, and merging of data from multiple experiments. While many file types and analysis tools exist for storing and manipulating single locus NGS data, there is currently no file standard or analysis tool suite for manipulating and storing paired-genomic-loci: the data type resulting from “genomic interaction” studies. As genomic interaction sequencing data are becoming prevalent, a standard file format and tools for working with these data conveniently and efficiently are needed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>This article details a file standard and novel software tool suite for working with paired-genomic-loci data. We present the <bold>p</bold>aired-<bold>g</bold>enomic-<bold>l</bold>oci (<bold>PGL</bold>) file standard for genomic-interactions data, and the accompanying analysis tool suite “pgltools”: a cross platform, pypy compatible python package available both as an easy-to-use UNIX package, and as a python module, for integration into pipelines of paired-genomic-loci analyses.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Pgltools is a freely available, open source tool suite for manipulating paired-genomic-loci data. Source code, an in-depth manual, and a tutorial are available publicly at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/billgreenwald/pgltools">www.github.com/billgreenwald/pgltools</ext-link>, and a python module of the operations can be installed from PyPI via the PyGLtools module.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Hi-CChIA-PET</kwd>
      <kwd>Chromatin conformation capture</kwd>
      <kwd>Peak</kwd>
      <kwd>Paired-genomic-loci</kwd>
      <kwd>Tool suite</kwd>
      <kwd>Bedtools</kwd>
      <kwd>Genomic arithmetic</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000900</institution-id>
            <institution>California Institute for Regenerative Medicine</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CG1R-06673</award-id>
        <principal-award-recipient>
          <name>
            <surname>Frazer</surname>
            <given-names>Kelly A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HL107442</award-id>
        <principal-award-recipient>
          <name>
            <surname>Frazer</surname>
            <given-names>Kelly A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000062</institution-id>
            <institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DK105541</award-id>
        <principal-award-recipient>
          <name>
            <surname>Frazer</surname>
            <given-names>Kelly A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HG008118</award-id>
        <principal-award-recipient>
          <name>
            <surname>Frazer</surname>
            <given-names>Kelly A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Numerous experimental methodologies have been developed in the past decade to study 3D configurations of the human genome, including Hi-C and ChIA-PET [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. These “genomic interaction” data have provided key insights into the regulation of gene expression, and suggest that chromatin interactions are driven by discrete, yet spatially-associated, epigenetic features [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. File standards and tool suites have become essential to conduct efficient bioinformatics analyses; for example, single locus information can be encoded in the BED file format and manipulated using bedtools, enabling a wide variety of bioinformatics inquiries [<xref ref-type="bibr" rid="CR5">5</xref>]. However, it is currently challenging to fully interpret the biological impact of genomic interactions as tools do not yet exist to quickly and iteratively interrogate the extent to which both regions of paired loci are conserved across genomic datasets from diverse cell-types and contexts. While paired-genomic-loci data generated from these methodologies are widely available, the bioinformatics field has not yet developed either a file standard or analysis tools for their efficient manipulation.</p>
    <p>There are currently several file formats for paired-genomic-loci data, however, none of these file formats were designed to enable efficient annotation and data manipulation. Existing file formats include those that encode read count information such as the matrix and the triplet sparse matrix formats [<xref ref-type="bibr" rid="CR6">6</xref>], and others that encode the locations of paired segments and specialized metadata for particular pipelines, such as the HiFive ChromatinInteraction format [<xref ref-type="bibr" rid="CR7">7</xref>]. Although the matrix and triplet sparse matrix formats effectively communicate coverage depth across bins of the genome, they are restricted to fixed locus bin sizes, are not human-readable, and are cumbersome for genomic arithmetic. Additionally, while the ChromatinInteraction format, and the similarly structured bedtools bedpe format [<xref ref-type="bibr" rid="CR5">5</xref>], may appear to be suitable storage formats for integration into a genomic arithmetic pipeline, as the two loci can be written in any order within the file, programmatic manipulation is unnecessarily complicated. Finally, the triplet sparse matrix and ChromatinInteraction formats are both specialized for the specific programs for which they were designed. Thus, to facilitate genomic interaction data manipulation, allow for variable locus bin sizes within a single data set, and allow for flexible metadata important to paired-genomic-loci, a new file standard is needed.</p>
    <p>Numerous analysis tools exist to process, normalize, or call peaks from raw reads of paired-genomic-loci data [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], yet there is no software that performs efficient manipulation and genomic arithmetic, analogous to bedtools, for single locus data, hindering the process of annotating and comparing chromatin interactions. For example, bedtools does not provide operations for bedpe that analyze both loci simultaneously, and there are no tools for genomic arithmetic within HiFive. Furthermore, a tool for converting to the ChromatinInteraction format, or for converting from the triplet sparse matrix format to visualization formats, does not currently exist. An analysis tool suite that performs efficient manipulation and genomic arithmetic of paired-genomic-loci data would allow for more complete analyses of these datasets, and thus the potential to gain deeper biological insights about the 3D conformation of the human genome.</p>
    <p>Here we describe a new file standard for <bold>p</bold>aired-<bold>g</bold>enomic-<bold>l</bold>oci data, the PGL format, and an analysis tool suite, pgltools, for genomic interaction data storage and manipulation. The PGL format supports genomic interaction data, allows for appropriate metadata, and enables efficient data manipulation. Pgltools performs genomic arithmetic on PGL files such as comparing, merging, and intersecting two sets of paired-genomic-loci, as well as integrates BED files with PGL files. Finally, we provide functions to convert other genomic interaction file formats to PGL files, and convert PGL files to multiple different visualization formats. This analysis tool suite will allow for iterative bioinformatics analyses and visualization of genomic interaction data, facilitating discovery and collaboration within the genomic interaction field.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>Our goal was to create a file standard that can summarize the output from mapping and peak calling algorithms for chromatin interaction data derived from experiments, such as Hi-C or ChIA-PET, that is easily interpretable, shareable, and can be combined with current genomic annotation formats, such as the BED format. We first established a paired-genomic-loci file standard—the “PGL” file type— which represents each paired-genomic-loci as a single PGL entry in a human readable text file, with space in each entry for annotations, and then implemented an analysis tool suite for working with these files. Within “genomic interaction” data, the interactions between two loci (locus A and locus B) are captured—this “paired” information is preserved through the PGL file standard. PGL files require six columns in the following order: locus A chromosome, locus A start position, locus A end position, locus B chromosome, locus B start position, and locus B end position. Beyond the six columns, any user-defined annotations, such as interaction <italic>p</italic>-value or locus chromatin state, can be written. These annotations can be manipulated and utilized by the operations in PGLtools to gain insight into the relationship between multiple paired-genomic-loci. As annotations are unique to a file, headers can be given in files by preceding a line with “#.” Furthermore, PGL files are required to have each PGL entry written such that locus A comes before locus B based on chromosome number alphabetically (ex. chr1, chr10, chr15, chr22, chr7, chrX, chrY) and chromosome position numerically. This relationship, when combined with file sorting on each column sequentially, gives pgltools the ability to quickly merge and intersect PGL entries from PGL files. Operations for sorting PGL files, converting files to PGL files, and formatting PGL files for visualization with established programs, are also included in pgltools.</p>
    <p>Most pgltools operations utilize the same core overlap function to test for overlapping paired-genomic-loci within or between file(s). For single locus entries, such as those in sorted BED files, overlapping entries must be sequential: if entries 1 and 3 overlap, entry 2 must overlap both entries 1 and 3 (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). This property allows bedtools to limit of the number of features that must be compared for overlap, thus expediting analyses [<xref ref-type="bibr" rid="CR5">5</xref>]. However, in sorted PGL files, while locus A from multiple sequential entries can overlap, locus B may not overlap (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). The pgltools overlap function allows for this and quickly and efficiently finds consecutive and non-consecutive entries where both locus A and locus B are overlapping. It begins by comparing the first PGLs in both files, recording if an overlap occurred in both loci, and then advances to the next PGL in File 2. These comparisons continue until the PGL from File 2 does not overlap locus A from the PGL in File 1, at which point the algorithm begins comparing the next PGL from File 1 to the first possible overlapping PGL from File 2. This repeats until the ends of both files are reached. An in-depth flow chart of the overlap operation’s control flow, as well as how the first possible overlapping PGL from File 2 is determined, is shown in Fig. <xref rid="Fig1" ref-type="fig">1c</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Pgltools Implementation (<bold>a</bold>) An example of sorted, single locus bed file entries from a file sorted by start position. As entry 1 overlaps entry 3, entry 2 must also overlap entry 3. (<bold>b</bold>) A pictorial representation of PGL entries in a sorted PGL file where non-sequential PGL entries overlap. Loci are shown as blocks, with <italic>dashed lines</italic> connecting the paired-loci comprising a single entry. Both loci A and B in PGL entries 1 and 3 overlap, and both loci in PGL entries 2 and 4 overlap. (<bold>c</bold>) A flowchart of the overlap function shared between many operations in pgltools. File 2 has N-1 entries. File 2 is iterated by the File2-index i. File2[i] is a PGL entry for any 0 ≤ i &lt; N. Throughout the algorithm, PGL entries from File 2 must be checked multiple times. Therefore, to reduce the number of comparisons performed by pgltools, the Recheck Index is used to store the index at which the previous overlap iteration began. When the ends of both files are reached, the algorithm ends</p></caption><graphic xlink:href="12859_2017_1621_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>Pgltools is implemented in Python 2.7, and all operations have been tested with the pypy python compiler. As such, the UNIX package version of pgltools can be run either with CPython or pypy; the included UNIX wrapper will run pgltools through pypy if installed, or CPython if pypy is not installed. Utilizing pypy reduces memory consumption by approximately 25%, and decreases run times 5–7 fold. The pgltools suite can read from UNIX standard in, useful for stringing multiple pgltools commands together without needing to save the intermediate files, and writes to UNIX standard out, allowing it to be utilized in complex pipelines to speed up analysis of genomic interaction data. Pgltools is also available as a python module, PyGLtools, for use within pythonic pipelines, and can be installed from PyPI. As pgltools is written in Python 2.7, it is easily portable to any platform and poised for collaboration with the community.</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results and Discussion</title>
    <p>Table <xref rid="Tab1" ref-type="table">1</xref> includes a full list of pgltools operations and their default behavior. Visualizations of these operations are provided in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The pgltools <italic>intersect</italic> operation can be used to identify either the overlap, union, or uniqueness of PGL entries between two PGL files, while preserving or combining annotations during these analyses; for example, the number of overlapping bases at each locus from each PGL entry from two PGL files can be determined. The pgltools <italic>merge</italic> operation can be utilized to merge overlapping PGL entries, or PGL entries within a specified distance within a single PGL file. Summary statistics, such as the number of merged entries, can be obtained through command line arguments to the <italic>merge</italic> operation. To determine differential PGL entries between two PGL files, the <italic>subtract</italic> operation has been included to remove the parts of PGL entries present in one PGL file from those present in another. Once a set of PGL entries has been determined, it is common to filter these entries to a desired genomic region—the <italic>window</italic> operation can be used to filter based on either or both end(s) of the PGL entries in a PGL file. To interrogate questions regarding differential coverage depth of genomic interactions, such as genetic association with interaction intensity, we provide the <italic>samTopgl</italic> operation, which when utilized with the <italic>coverage</italic> operation, will find the number of reads from a sam file that overlap each PGL entry in a PGL file (though the operation is generalizable for any two PGL files). The <italic>closest</italic> operation is provided for finding the closest PGL entries between two PGL files. The <italic>expand</italic> operation can expand both loci by a given value. In addition, as single locus genomic metadata is often analyzed together with interaction data, such as presence of a coding region, epigenetic annotation, or motif locations, we provide the <italic>intersect1D</italic>, <italic>closest1D,</italic> and <italic>subtract1D</italic> operations for analysis on traditional BED files and PGL files. Finally, we include helper operations both for converting files to the PGL format, including <italic>formatbedpe</italic> to convert a bedpe file and <italic>formatTripSparse</italic> to convert triple sparse matrix files, and for converting from the PGL format to packages for visualization or further analysis, such as the <italic>conveRt</italic> operation to convert to a file readable by the GenomicInteractions R package [<xref ref-type="bibr" rid="CR10">10</xref>], <italic>browser</italic> for visualizing with the UCSC Genome Browser [<xref ref-type="bibr" rid="CR11">11</xref>], <italic>juiceBox</italic> for visualizing with JuiceBox [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], and <italic>condense</italic> and <italic>findLoops</italic> to create a BED file of either the discrete loci or interior regions of each PGL.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of operations provided in pgltools</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td>intersect</td><td>Find overlapping paired-genomic-loci from two PGL files</td></tr><tr><td>merge</td><td>Merge nearby paired-genomic-loci within a single file and produce a column containing summary statistics requested through passed parameters (-c and -o)</td></tr><tr><td>subtract</td><td>Find parts of paired-genomic-loci from a PGL file that do not overlap another PGL file</td></tr><tr><td>window</td><td>Filter a PGL file to a particular genomic region</td></tr><tr><td>samTopgl</td><td>Converts a sam file to a PGL file</td></tr><tr><td>coverage</td><td>Find the coverage of a PGL file on another PGL file; usually used to find the coverage of reads from a PGL file derived from a sam file on a set of PGLs. The paired-genomic-loci from file 2 only need to overlap the paired-genomic-loci from file 1.</td></tr><tr><td>closest</td><td>Find the closest paired-genomic-loci from a PGL file for each paired-genomic-loci in another PGL file</td></tr><tr><td>expand</td><td>Expand both loci by a given size</td></tr><tr><td>intersect1D</td><td>Find the paired-genomic-loci that overlap regions from a bed file</td></tr><tr><td>closest1D</td><td>Find the closest paired-genomic-loci to a set of regions from a bed file</td></tr><tr><td>subtract1D</td><td>Find the parts of paired-genomic-loci that do not overlap regions from a bed file</td></tr><tr><td>sort</td><td>Sorts a PGL file for use with other PGLtools operations</td></tr><tr><td>formatbedpe</td><td>Convert a bedpe-like file to a PGL file</td></tr><tr><td>formatTripSparse</td><td>Convert a triplet sparse matrix file set to a PGL file</td></tr><tr><td>conveRt</td><td>Formats the PGL file for use with the GenomicInteractions R package</td></tr><tr><td>browser</td><td>Format a PGL file to be viewed in the UCSC Genome Browser</td></tr><tr><td>juicebox</td><td>Format a PGL file to be viewed in juicebox</td></tr><tr><td>condense</td><td>Convert a PGL file to a BED file with two entries for each PGL entry.</td></tr><tr><td>findLoops</td><td>Convert a PGL file to a BED file with an entry containing the region from the start of anchor A to the stop of anchor B for intra-chromosomal PGLs, and an entry for each anchor for inter-chromosomal PGLs.</td></tr></tbody></table></table-wrap>
<fig id="Fig2"><label>Fig. 2</label><caption><p>The operations of pgltools. PGL entries from file one are shown in various shades of <italic>blue</italic>, PGL entries from file two are shown in <italic>orange</italic>, and windows are shown in <italic>yellow</italic> (see legend at bottom right). All resulting outputs are shown below <italic>dashed lines</italic>, with novel entries shown in <italic>green</italic> and original entries shown in their original color. (<bold>a</bold>) The intersect operation finds overlapping paired-genomic-loci between two PGL files and returns the overlapping regions. (<bold>b</bold>) The merge operation combines overlapping paired-genomic-loci within a single PGL file. (<bold>c</bold>) The subtract operation returns the PGL entries from file one with the PGL entries from file two removed. (<bold>d</bold>) The window operation returns the PGL entries that fall completely within a specified genomic region. (<bold>e</bold>) The coverage operation returns the number of PGL entries from file two that overlap each PGL entry in file one. (<bold>f</bold>) The closest operation returns the closest PGL entry from file two for each PGL entry in file one. (<bold>g</bold>) The intersect1D operation returns PGL entries from file one that overlap regions in a bed file. (<bold>h</bold>) The closest1D operation returns the closest region from a bed file for each PGL entry in file one. (<bold>i</bold>) The subtract1D operation returns the PGL entries from file one with the regions from a bed file removed</p></caption><graphic xlink:href="12859_2017_1621_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>By combining the operations within pgltools, one can quickly and easily interrogate biological functionality in the context of chromatin interaction data. For example, by combining the <italic>intersect1D</italic> and <italic>merge</italic> operations, it is possible to determine the different chromatin annotations for each locus of each PGL entry (which could then be further filtered to determine 3D interactions between chromatin states of interest, e.g. promoter-enhancer). Additionally, pgltools can be used to find overlaps between chromatin interactions and other types of paired data. For example, one could create a PGL file from a list of expression Quantitative Trait Loci (<bold>eQTLs</bold>) and their corresponding target genes (<bold>eGenes</bold>), and utilize the <italic>intersect</italic> operation to determine if any pairs of eQTL and eGenes fall within a chromatin interaction. Example pipelines for these scenarios can be found on the pgltools github.</p>
  </sec>
  <sec id="Sec4" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Pgltools is an open source software analysis tool suite for interacting with the PGL file standard for paired-genomic-loci. Pgltools can read from and writes to UNIX standard in and standard out, and can be run quickly in both CPython and pypy. A python module version, PyGLtools, is available for use within pythonic pipelines. The cross-platform nature of python poises pgltools for community contribution, and makes it easy to install and utilize.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>eQTLs</term>
        <def>
          <p>Expression quantitative trait loci</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>PGL</term>
        <def>
          <p>Paired-genomic-loci</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to acknowledge Anthony D. Schmitt for aiding in generating pre-published data for software development and unit testing.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>This work was supported in part by a California Institute for Regenerative Medicine grant [GC1R-06673 to KAF]; and National Institutes of Health grants [HG008118 to KAF, HL107442 to KAF, DK105541 to KAF, DK112155 to KAF and EY021237 to KAF]. These funding agencies played no role in the design or conclusions of this study.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p>Test datasets and software generated and analyzed during the current study are available in the pgltools repository at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/billgreenwald/pgltools">https://www.github.com/billgreenwald/pgltools</ext-link>, and a python module implementation (PyGLtools) can be downloaded from PyPI.</p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>WWG and HL conceived of the project. WWG wrote the code. HL and NN unit tested and wrote documentation. PB generated the data utilized for testing. KAF directed the project. WWG, HL, NN, ENS and KF wrote the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not Applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>Not Applicable.</p>
    </sec>
    <sec id="FPar7">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fullwood</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mulawadi</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Velkov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vega</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ariyaratne</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Bin</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Ooi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tennakoon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ChIA-PET tool for comprehensive chromatin interaction analysis with paired-end tag sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R22</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-2-r22</pub-id>
        <?supplied-pmid 20181287?>
        <pub-id pub-id-type="pmid">20181287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lieberman-Aiden E, Berkum NL Van, Williams L, Imakaev M, Ragoczy T, Telling A, Amit I, Lajoie BR, Sabo PJ, Dorschner MO, Sandstrom R, Bernstein B, Bender MA, Groudine M, Gnirke A, Stamatoyannopoulos J, Mirny LA. Comprehensive Mapping of Long-Range Interactions Reveals Folding Principles of the Human Genome. Science. 2009;326:289–94.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
        </person-group>
        <article-title>A 3D Map of the Human Genome at Kilobase Resolution Reveals Principles of Chromatin Looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Antosiewicz-Bourget</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajagopal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Diao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lobanenkov</surname>
            <given-names>VV</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Chromatin architecture reorganization during stem cell differentiation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <fpage>331</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14222</pub-id>
        <?supplied-pmid 25693564?>
        <pub-id pub-id-type="pmid">25693564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: A flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <?supplied-pmid 20110278?>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Servant N, Varoquaux N, Lajoie BR, Viara E, Chen C, Vert J, Heard E, Dekker J, Barillot E. HiC-Pro: an optimized and flexible pipeline for Hi-C data processing. Genome Biol. 2015;16:259.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Sauria MEG, Phillips-cremins JE, Corces VG, Taylor J. HiFive: a tool suite for easy and efficient HiC and 5C data analysis. Genome Biol. 2015;16:237.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Juicer Provides a One-Click System for Analyzing Tool Juicer Provides a One-Click System for Analyzing Loop-Resolution Hi-C Experiments</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id>
        <?supplied-pmid 27467249?>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Ay F, Bailey TL, Noble WS: Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts. Genome Res 2014:1–24. doi:10.1101/gr.160374.113</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmston</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ing-Simmons</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barešić</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>GenomicInteractions: An R/Bioconductor package for manipulating and investigating chromatin interaction data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>963</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-2140-x</pub-id>
        <?supplied-pmid 26576536?>
        <pub-id pub-id-type="pmid">26576536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>The Human Genome Browser at UCSC W</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Juicebox Provides a Visualization System for Hi-C Contact Maps with Unlimited Zoom Tool Juicebox Provides a Visualization System for Hi-C Contact Maps with Unlimited Zoom</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>99</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.07.012</pub-id>
        <?supplied-pmid 27467250?>
        <pub-id pub-id-type="pmid">27467250</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
