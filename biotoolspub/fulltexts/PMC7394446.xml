<?properties open_access?>
<?subarticle pcbi.1007504.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7394446</article-id>
    <article-id pub-id-type="pmid">32692749</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01801</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>DNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>DNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
            <subj-group>
              <subject>Alleles</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome Annotation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Bioassays and Physiological Analysis</subject>
          <subj-group>
            <subject>Biochemical Analysis</subject>
            <subj-group>
              <subject>Enzyme Assays</subject>
              <subj-group>
                <subject>Luciferase Assay</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>DNA-binding proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Regulatory Proteins</subject>
              <subj-group>
                <subject>Transcription Factors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayesian modelling of high-throughput sequencing assays with malacoda</article-title>
      <alt-title alt-title-type="running-head">Bayesian modelling of high-throughput sequencing assays with malacoda</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8888-946X</contrib-id>
        <name>
          <surname>Ghazi</surname>
          <given-names>Andrew R.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kong</surname>
          <given-names>Xianguo</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3040-7816</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Ed S.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8976-6410</contrib-id>
        <name>
          <surname>Edelstein</surname>
          <given-names>Leonard C.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7267-5398</contrib-id>
        <name>
          <surname>Shaw</surname>
          <given-names>Chad A.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Quantitative and Computational Biosciences, Baylor College of Medicine, Houston, Texas, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Cardeza Foundation for Hematologic Research, Thomas Jefferson University, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Molecular and Human Genetics, Baylor College of Medicine, Houston, Texas, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Carnegie Mellon University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>cashaw@bcm.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>7</issue>
    <elocation-id>e1007504</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Ghazi et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Ghazi et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007504.pdf"/>
    <abstract>
      <p>NGS studies have uncovered an ever-growing catalog of human variation while leaving an enormous gap between observed variation and experimental characterization of variant function. High-throughput screens powered by NGS have greatly increased the rate of variant functionalization, but the development of comprehensive statistical methods to analyze screen data has lagged. In the massively parallel reporter assay (MPRA), short barcodes are counted by sequencing DNA libraries transfected into cells and the cell’s output RNA in order to simultaneously measure the shifts in transcription induced by thousands of genetic variants. These counts present many statistical challenges, including overdispersion, depth dependence, and uncertain DNA concentrations. So far, the statistical methods used have been rudimentary, employing transformations on count level data and disregarding experimental and technical structure while failing to quantify uncertainty in the statistical model. We have developed an extensive framework for the analysis of NGS functionalization screens available as an R package called malacoda (available from <ext-link ext-link-type="uri" xlink:href="http://github.com/andrewGhazi/malacoda">github.com/andrewGhazi/malacoda</ext-link>). Our software implements a probabilistic, fully Bayesian model of screen data. The model uses the negative binomial distribution with gamma priors to model sequencing counts while accounting for effects from input library preparation and sequencing depth. The method leverages the high-throughput nature of the assay to estimate the priors empirically. External annotations such as ENCODE data or DeepSea predictions can also be incorporated to obtain more informative priors–a transformative capability for data integration. The package also includes quality control and utility functions, including automated barcode counting and visualization methods. To validate our method, we analyzed several datasets using malacoda and alternative MPRA analysis methods. These data include experiments from the literature, simulated assays, and primary MPRA data. We also used luciferase assays to experimentally validate several hits from our primary data, as well as variants for which the various methods disagree and variants detectable only with the aid of external annotations.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Genetic sequencing technology has progressed rapidly in the past two decades. Huge genomic characterization studies have resulted in a massive quantity of background information across the entire genome, including catalogs of observed human variation, gene regulation features, and computational predictions of genomic function. Meanwhile, new types of experiments use the same sequencing technology to simultaneously test the impact of thousands of mutations on gene regulation. While the design of experiments has become increasingly complex, the data analysis methods deployed have remained overly simplistic, often relying on summary measures that discard information. Here we present a statistical framework called <italic>malacoda</italic> for the analysis of massively parallel genomic experiments which is designed to incorporate prior information in an unbiased way. We validate our method by comparing our method to alternatives on simulated and real datasets, by using different types of assays that provide a similar type of information, and by closely inspecting an example experimental result that only our method detected. We also present the method’s accompanying software package which provides an end-to-end pipeline with a simple interface for data preparation, analysis, and visualization.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL128234</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8976-6410</contrib-id>
          <name>
            <surname>Edelstein</surname>
            <given-names>Leonard C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>CS, LE - R01HL128234, National Institutes of Health, <ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/">https://www.nih.gov/</ext-link> The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-07-31</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The advent of next generation sequencing (NGS) has generated an explosion of observed genetic variation in humans. Variants with unclear effects greatly outnumber those with severe impact. For example, the 1000 Genomes Project [<xref rid="pcbi.1007504.ref001" ref-type="bibr">1</xref>] has estimated that a typical human genome has roughly 150 protein-truncating variants, 11,000 peptide-sequence altering variants, and 500,000 variants falling into known regulatory regions. Simultaneously, genome-wide association studies (GWAS) have found strong statistical associations between thousands of noncoding variants and hundreds of human phenotypes [<xref rid="pcbi.1007504.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1007504.ref003" ref-type="bibr">3</xref>]. Traditional methods of assessing the regulatory impact of variants are slow and low-throughput: luciferase reporter assays require multiple replications of cloning individual genomic regions, transfection into cells, and measurement of output intensity.</p>
    <p>Massively Parallel Reporter Assays (MPRA), overviewed in <xref ref-type="fig" rid="pcbi.1007504.g001">Fig 1</xref>, were developed to assess simultaneously the transcriptional impact of thousands of genetic variants [<xref rid="pcbi.1007504.ref004" ref-type="bibr">4</xref>]. The simplest form of MPRA uses a carefully designed set of barcoded oligonucleotides containing roughly 150 base pairs of genomic context surrounding variants of interest. There are typically thousands of variants selected using preliminary evidence from GWAS, and there are usually ten to thirty replicates of each allele with unique, inert barcodes. The oligonucleotides are cloned into plasmids, making a complex library that is then transfected into cells. The cells use the library as genetic material and actively transcribe the inserts. Because the barcodes are preserved by transcription, counting the RNA products of each variant construct by re-identifying each barcode in the NGS product provides a direct measure of the transcriptional output of a given genetic variant. By designing the oligonucleotide library to contain multiple barcodes of both the reference and alternate alleles for each variant, one can statistically assess the transcription shift (TS) for each variant. MPRA can thus be used to identify functional driver variants among sets of statistically significant GWAS variants that are difficult to distinguish in observational studies because of linkage disequilibrium.</p>
    <fig id="pcbi.1007504.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007504.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Diagram of MPRA.</title>
        <p>MPRA simultaneously assess the transcription shift of thousands of variants. The diagram shows eight oligonucleotides for two variants (red and blue X’s) falling within different regions of genomic context (light red and light blue bars) with two barcodes for each allele of each variant. In practice the complexity and size of the oligonucleotide library is limited only by cost. A typical MPRA has tens to hundreds of thousands of oligonucleotides to assay thousands of variants. The oligonucleotides are cloned into a plasmid library in front of an inert ORF (brown). DNA sequencing of the plasmid library is used to count the input representation of each barcode, then RNA sequencing of the mRNA (green) is used to count the output RNA version of each barcode.</p>
      </caption>
      <graphic xlink:href="pcbi.1007504.g001"/>
    </fig>
    <p>MPRA have successfully identified many transcriptionally functional variants [<xref rid="pcbi.1007504.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007504.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1007504.ref007" ref-type="bibr">7</xref>], but the accompanying statistical analyses have been rudimentary. Initial studies focused on the computation of the “activity” for each barcode in each RNA sample. This involves averaging across depth-adjusted counts to compute a normalizing DNA factor for each barcode, then dividing depth-adjusted RNA counts by the DNA factor and taking the log of this ratio. Then a t-test is used to compare the activity measurements for each allele, followed by assay-wide multiple-testing corrections. The key limitations include ignoring systematic variation due to unknown DNA concentrations, compounded data transformation and summarization prior to modelling, and the failure to include the reservoir of prior data and biological knowledge concerning genes and genomic regions. The methods mpralm [<xref rid="pcbi.1007504.ref008" ref-type="bibr">8</xref>], MPRAscore [<xref rid="pcbi.1007504.ref009" ref-type="bibr">9</xref>], QuASAR-MPRA[<xref rid="pcbi.1007504.ref010" ref-type="bibr">10</xref>], and MPRAnalyze [<xref rid="pcbi.1007504.ref011" ref-type="bibr">11</xref>] are more recent methods, but they all suffer from some combination of common limitations: failure to model variation in input DNA concentrations, aggregation of data across barcodes, sequencing samples without modelling systematic sources of variation, and over-reliance on point estimates of dispersion that cause errors in transcription shift estimates.</p>
    <p>Other areas of genomic analysis have generated a wealth of information on genomic structure and function, frequently specific to particular genomic contexts and variants. For example, the ENCODE project [<xref rid="pcbi.1007504.ref012" ref-type="bibr">12</xref>] provides genome-wide ChIP-seq data on transcription factor binding profiles, histone marks, and DNA accessibility. Computational methods such as DeepSea [<xref rid="pcbi.1007504.ref013" ref-type="bibr">13</xref>] use machine learning to provide variant-specific predictions on chromatin effects. Genome-wide databases like ENCODE and computational predictors like DeepSea contain real information about variant effects, but a method for incorporating this information into a statistical framework for experimental analysis of variants has not been developed.</p>
    <p>We hypothesized that a structured, probabilistic modelling approach to high-throughput NGS screens such as MPRA would yield more accurate estimates of variant function while improving statistical sensitivity and specificity, particularly when incorporating prior information. This approach offers a flexible modelling system that can fit hierarchical model structures of count data while also directly accounting for experimental sources of variation. Our approach would also enable the integration of prior information and account for uncertainty in dispersion parameter estimates. These advantages offer significant improvements in statistical efficiency and provide opportunities for formulating systems-level hypotheses—for example, the impact of specific transcription factors—that are absent from other approaches. Here we present <italic>malacoda</italic>, an end-to-end Bayesian statistical framework that addresses gaps in the prior approaches while providing novel methods for incorporating prior information. The malacoda method focuses on MPRA but also has potential extension to a broad array of NGS-based high-throughput screens. We establish the superior performance of malacoda on MPRA compared to alternatives using simulation studies. We then apply the method to previously published findings to make new biological discoveries that we explore in the paper. We also apply malacoda to primary MPRA studies that we performed. We limit the analysis of our primary data to an examination of the inter-method consistency of effect size estimates in order to emphasize the potential of our statistical method. The barcode counts and cross-method effect size estimates for all of the results are included in <xref ref-type="supplementary-material" rid="pcbi.1007504.s005">S2 Data</xref>. To demonstrate the impact of malacoda for biologically relevant discovery, we analyzed previously published data by Ulirsch et al, and we identified the functional variant rs11865131 within the intron of the <italic>NPRL3</italic> gene; we validated this finding by luciferase assay. The results demonstrate that using malacoda we can discover biologically important findings that were missed by prior approaches. We have made the software available as an open source R package on GitHub.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Overview</title>
      <p>In malacoda we utilize a negative binomial model for NGS to consider barcode counts with empirically estimated gamma priors, and we explicitly model variation in the input DNA concentrations for each barcode. By default, the method marginally estimates the priors from the maximum likelihood estimates of each variant in the assay; the method also supports informative prior estimation by using external genomic annotations for each variant as weights. This approach enables disparate knowledge sources to inform the results in a principled, data-driven way. The probabilistic model underlying malacoda uses the NGS data directly without transformation, and it accounts for all known sources of experimental variation and uncertainty in model parameters. Finally, the method provides estimate shrinkage as a method for avoiding false positives.</p>
    </sec>
    <sec id="sec004">
      <title>Description of the statistical model</title>
      <p>MPRA data are composed of the counts of the barcoded DNA input from sequencing the plasmid library and the counts of the barcoded RNA outputs from sequencing the RNA content extracted from passaged cells. The DNA counts vary according to the sequencing depth of the sample as well as due to the inherent noise in library preparation. The RNA measurements also vary according to sequencing depth, but they are also affected by the DNA input concentration and the inherent transcription rate of their associated region of genomic context. <xref ref-type="fig" rid="pcbi.1007504.g002">Fig 2A</xref> shows a subset of a typical MPRA dataset, with two barcodes of each allele for two variants and several columns of counts. We find that typically MPRA are performed with four to six RNA sequencing replicates and a smaller number of DNA replicate samples. <xref ref-type="fig" rid="pcbi.1007504.g002">Fig 2B</xref> shows a simplified Kruschke diagram of the model underlying malacoda, using the mean-dispersion parameterization of the negative binomial. More explicitly,
<disp-formula id="pcbi.1007504.e001"><alternatives><graphic xlink:href="pcbi.1007504.e001.jpg" id="pcbi.1007504.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007504.e002"><alternatives><graphic xlink:href="pcbi.1007504.e002.jpg" id="pcbi.1007504.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007504.e003"><alternatives><graphic xlink:href="pcbi.1007504.e003.jpg" id="pcbi.1007504.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007504.e004"><alternatives><graphic xlink:href="pcbi.1007504.e004.jpg" id="pcbi.1007504.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007504.e005"><alternatives><graphic xlink:href="pcbi.1007504.e005.jpg" id="pcbi.1007504.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007504.e006"><alternatives><graphic xlink:href="pcbi.1007504.e006.jpg" id="pcbi.1007504.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
Where d<sub>s</sub> indicates the depth of a particular sequencing sample, μ<sub>DNA,bc</sub> indicates the unknown concentration of a particular barcode in the plasmid library, and μ<sub>allele</sub> indicates the effect of the genomic context of a given allele of a given variant. Parameters indexed by “bc” are vectors with an element for each barcode while those with the “allele” subscript contain two elements for the reference and alternate alleles. The shape α and rate β parameters of the Gamma priors are estimated empirically. Note that the mean of each negative binomial used to model a particular count observation is directly proportional to the sequencing depth of the sample from which that count observation arose. A more finely detailed walkthrough of the model and its implementation are available in section 1 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s001">S1 Appendix</xref>.</p>
      <fig id="pcbi.1007504.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007504.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>MPRA data and malacoda priors.</title>
          <p>A) The table shows a subset of our primary MPRA data. The highlighted cell containing 759 barcode counts is influenced both by the sequencing depth of its sample (blue column) and the unknown input DNA concentration of its barcode (red row). B) A simplified Kruschke diagram of the generative model underlying malacoda. After evaluating the joint posterior on all model parameters, a 95% posterior interval on a variant’s transcription shift (shaded area) may be used for a binary decision between “functional” or “non-functional”. This example TS posterior shows a negative shift that excludes zero, meaning the variant in question would be called as “functional”. C) A conceptual diagram demonstrating three prior types available in the malacoda framework. The marginal prior (left) weights all variants in the assay equally, while the grouped and conditional priors utilize informative annotations as weights in the prior estimation process.</p>
        </caption>
        <graphic xlink:href="pcbi.1007504.g002"/>
      </fig>
      <p>The negative binomial distribution is a natural choice for modelling NGS count data given its ability to accurately fit overdispersed observations frequently seen in sequencing data [<xref rid="pcbi.1007504.ref014" ref-type="bibr">14</xref>]. Briefly, the observed dispersion in NGS count data usually exceeds that expected from simpler binomial or Poisson models. We chose gamma distributions as priors for several reasons. They have the appropriate [0,∞) support, and for a non-negative random variable whose expectation and expected log exist, they are the maximum entropy distribution. Additionally, they are characterized by two parameters, which gives the prior estimation process enough flexibility to accurately fit the observed population of negative binomial estimates. Probabilistic modelling of the dispersion parameters is key as demonstrated by simulation in <xref ref-type="supplementary-material" rid="pcbi.1007504.s002">S2 Appendix</xref>. Allocating probability across a distribution of dispersion parameter values impacts the inference on the other parameters in the model, specifically the allele-level effects that the assay aims to evaluate. The practice of modelling dispersion parameters probabilistically helps avoid pitfalls found in methods that utilize point estimates of dispersion. This barcode-level count data model that quantifies the uncertainty on the dispersion parameters is a central contribution of the malacoda method.</p>
      <p>After computing the joint posterior on all model parameters, the posterior on transcription shift is computed as a generated quantity by taking the difference between log of μ<sub>allele</sub> for the alternate and reference alleles. We then compute the narrowest interval containing 95% of the posterior on TS (the highest density interval (HDI)) for each variant. The 95% HDI is used to make binary calls on whether a variant is functional or non-functional: if the interval excludes zero as a credible value, the variant is labelled as “functional”. We note here that 95% is an arbitrary threshold based on statistical convention and common values on the trade-off between sensitivity-specificity. Other common cutoffs such as 80% or 99% may be used. An optional “region of practical equivalence” may also be defined on a per-assay basis when there is particular interest in rejecting a null region of transcription shift values around zero [<xref rid="pcbi.1007504.ref015" ref-type="bibr">15</xref>].</p>
    </sec>
    <sec id="sec005">
      <title>Empirical priors</title>
      <p>The gamma priors are fit empirically using maximum likelihood estimation. Specifically, each variant-level model is fit first by maximizing the likelihood component of the malacoda model, then empirical gamma distributions are fit to those estimates for the means and dispersions of the DNA, reference RNA, and alternate RNA. This approach offers several benefits. First, it leverages the high-throughput nature of the assay. The full dataset of thousands of variants determines the prior, so the contribution from each individual variant is small. Secondly, it constrains the prior to be reasonable in the context of a given assay. Specific circumstances regarding library preparation, sequencer properties, cell culture conditions, and other unknown factors will cause the underlying statistical properties of each MPRA to be unique. A less informed, general-purpose prior, such as Gamma(shape = 0.001, rate = 0.001), would assign a considerable amount of probability density to unreasonable regions of parameter space. Empirical estimation ensures that the priors capture the reasonable range of values for each parameter while avoiding putting unwarranted density on extreme values [<xref rid="pcbi.1007504.ref016" ref-type="bibr">16</xref>]. Finally, by sharing information between variants, empirical priors provide estimate shrinkage. The prior effectively regularizes all parameter estimates, a behavior which is important in multi-parameter models with relatively little data per parameter. This regularizing effect acts as an alternative to <italic>post hoc</italic> multiple testing correction: rather than widening the confidence interval on the estimate of the transcription shift, an empirical prior shrinks the estimate of transcription shift towards the global average while leaving the width of the interval intact. This data-driven approach acts as a natural safeguard against the risk of false positives found in multiple testing scenarios while simultaneously moderating the reported effect sizes of variants that display extreme behavior by chance. The regularization effect of the empirical prior is demonstrated in section 6 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s003">S3 Appendix</xref>.</p>
      <p>In order to incorporate external knowledge, the malacoda method also allows users to provide informative annotations to supplement the analysis. <xref ref-type="fig" rid="pcbi.1007504.g002">Fig 2C</xref> contrasts the marginal prior (left) with two prior types that make use of external annotations. These priors use the information in the annotations by employing the principle that similarly annotated variants should perform similarly in the assay. When the annotations are simply a set of descriptive categories (for example predictions of likely benign, uncertain, or likely functional), the grouped prior (2C, center) simply fits a prior distribution within each subset. When the annotations are continuous values, the conditionally weighted (2C, right) prior employs an adaptive kernel smoothing process to estimate the prior. To estimate the prior for a single variant, it initializes a t-distribution kernel centered at the annotation of the variant in question, then gradually widens this kernel until the <italic>n</italic>-th most highly weighted variant (where <italic>n</italic> is a configurable tuning parameter defaulting to 100) has a weight of at least one percent of that of the most influential variant. This ensures that the weights used to estimate the conditional prior are not dominated by the nearest neighbor in annotation space. While the diagram in <xref ref-type="fig" rid="pcbi.1007504.g002">Fig 2C</xref> shows this for only a single informative annotation on the horizontal axis, the software allows for an arbitrary number of continuous predictors to be used.</p>
    </sec>
    <sec id="sec006">
      <title>Simulation and validation studies</title>
      <p>We took several approaches to validate and compare the malacoda method with alternatives. First, we simulated MPRA data across a realistic grid of parameters governing the fraction of truly functional variants, the number of variants in the assay, and the number of barcodes per allele. These simulations also modelled distinct sequencing samples, realistic variation in sequencing depth, and barcode failure during library preparation. We then compared malacoda to alternative methods including the t-test, mpralm, MPRAscore, QuASAR-MPRA, and MPRAnalyze. Across these simulations we compared performance metrics including area under the receiver operating characteristic curve (AUC), area under the precision-recall curve (AUPR) and estimate accuracy. The code used to generate these simulations is provided in sections 2 and 3 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s003">S3 Appendix</xref>. Secondly, we applied malacoda and alternative methods to real MPRA data from the Ulirsch dataset [<xref rid="pcbi.1007504.ref005" ref-type="bibr">5</xref>], using inter-method consensus as a performance metric. We repeated this using our own primary MPRA data from an assay performed in K562 cells inspecting 2666 variants related to platelet function. This assay utilized oligonucleotides with 150bp of genomic context and inert 14bp barcodes. The barcode counts from this assay are presented in <xref ref-type="supplementary-material" rid="pcbi.1007504.s005">S2 Data</xref>. In both cases we ran malacoda using both a marginal prior and a conditional prior informed by DeepSea predictions for DNase hypersensitivity in the relevant cell-type. Finally, we tested a subset of variants with luciferase reporter assays to assess consistency with MPRA estimates of variant function.</p>
    </sec>
    <sec id="sec007">
      <title>Computational methods and software</title>
      <p>Our method is available as an R package from github.com/andrewGhazi/malacoda. The package includes detailed installation instructions, extensive help documentation, an analysis walkthrough vignette, and implementations of traditional activity-based analysis methods. The statistical models are fit with Stan [<xref rid="pcbi.1007504.ref017" ref-type="bibr">17</xref>], which allows us to perform a fast first pass fit with Automatic Differentiation Variational Inference [<xref rid="pcbi.1007504.ref018" ref-type="bibr">18</xref>] and, if a narrow 80% posterior interval on TS excludes zero, to perform a final Markov Chain Monte Carlo (MCMC) fit with Stan’s No-U-Turn Sampler. This presents an effective balance between the speed of approximate variational inference and asymptotically exact estimation of parameters via MCMC for functional variants. By default, each variant is first checked with a variational first pass. Then, if the variant passes the posterior interval check, MCMC is performed with 4 chains using 200 warmup and 500 post-warmup samples per chain for a total of 2000 posterior samples. These default settings can refine the limits of the TS posterior interval with satisfactory precision within a short run time. While the adaptive Hamiltonian Monte Carlo provided by Stan can efficiently explore high-dimensional posteriors, any MCMC-based method has Monte Carlo error that makes estimate precision difficult in borderline situations—an additional digit of estimate precision requires 100 times as many MCMC samples. When using the 95% posterior interval to make a binary classification of functional or non-functional, variants on the borderline can require a large number of posterior samples to precisely refine the limits of the interval that is used to classify a variant as functional or non-functional. By default, malacoda checks to see if either edge of the 95% interval is close to zero, and if necessary, lengthens the MCMC chains in order to provide better precision in this scenario. A full walkthrough of the computational methods is provided in section 2 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s001">S1 Appendix</xref>.</p>
      <p>Our package also includes data processing functionality to extract barcodes from reads, filter barcodes by quality, and count barcodes from a set of FASTQ files through an application of the FASTX-Toolkit [<xref rid="pcbi.1007504.ref019" ref-type="bibr">19</xref>]. Through an interface with the FreeBarcodes package [<xref rid="pcbi.1007504.ref020" ref-type="bibr">20</xref>], the package can also decode sequencing errors in the barcodes of an assay that has been designed using our previous work, mpradesigntools [<xref rid="pcbi.1007504.ref021" ref-type="bibr">21</xref>]. In our experience this typically recaptures about 5% additional data with no additional cost beyond a line of code during the assay design process. The package also contains plotting functionality to help visualize the results of analyses.</p>
    </sec>
    <sec id="sec008">
      <title>Experimental methods</title>
      <p>In order to collect experimental measurements of the transcriptional impact of variants through means other than MPRA, we performed luciferase reporter assays on seventeen variants. Four were among the strongest signals detected in our MPRA, six were variants from our MPRA where the statistical methods disagreed, and seven were variants from the Ulirsch dataset [<xref rid="pcbi.1007504.ref005" ref-type="bibr">5</xref>] where the malacoda marginal and DeepSea-based [<xref rid="pcbi.1007504.ref013" ref-type="bibr">13</xref>] conditional prior model fits disagreed.</p>
      <p>150-200bp genomic DNA sequences flanking the variants were amplified by PCR using K562 lymphoblast (ATCC) genomic DNA as template, then cloned into PGL4.28 minimum promoter luciferase reporter vector (Promega) at NheI and HindIII sites. Counterpart SNP variants were generated by site-directed mutagenesis. All the constructs were validated by DNA sequencing. 3μg plasmid preparations were co-transfected with 0.5μg β-gal plasmid into 1x10<sup>6</sup> of K562 cells with Lipofectamine 2000 based on manufacturer's instructions. Each assay was repeated with 3 independent plasmid preparations. 24 hours post transfection, luciferase and β-gal were measured. Luciferase units were then normalized to β-gal values. These results are available in <xref ref-type="supplementary-material" rid="pcbi.1007504.s004">S1 Data</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <sec id="sec010">
      <title>Simulation studies</title>
      <p>We evaluated our simulation results in three ways. First, we examined the accuracy of transcription shift estimates. <xref ref-type="fig" rid="pcbi.1007504.g003">Fig 3A</xref> shows the results of analyzing one simulated dataset, with the true value of the simulation’s transcription shift plotted on the x-axis, with the model estimates on the y-axis. For each fit of each simulation using each analysis method, we analyzed accuracy using two metrics: standard deviation of estimates for truly non-functional variants at zero (vertical width of the grey boxplot, lower is better) and correlation with the true values for simulated functional variants with nonzero effects (off-center points, higher is better).</p>
      <fig id="pcbi.1007504.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007504.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Simulation results.</title>
          <p>A) The figure compares the TS values used to generate simulated data to TS estimates. Simulated MPRA assays use a varying fraction of variants that are truly non-functional (center). B) The average ROC curves used to assess the classification performance of each method across simulations with 3000 variants, 5% truly functional variants, and 10 barcodes per allele. The methods shown are malacoda (red), MPRAnalyze (orange), mpralm (green), QuASAR-MPRA (pink), MPRAscore (blue), and the t-test (purple) C) The average precision-recall curve for the same set of simulations D) Median performance metrics across multiple simulations under the same conditions as B.</p>
        </caption>
        <graphic xlink:href="pcbi.1007504.g003"/>
      </fig>
      <p>Second, we also computed area under the receiver operating characteristic curve (AUC) and area under the precision-recall curve (AUPR) in order to characterize the binary classification performance of each method. Bayesian methods such as malacoda explicitly do not consider a null hypothesis and therefore do not output p-values. In order to create an analogous quantity needed to compute the AUC and AUPR, we instead computed one minus the minimum HDI width necessary to include zero as a credible transcription shift value to distinguish true and false positives. This process is presented in detail in section 4.1 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s003">S3 Appendix</xref>. <xref ref-type="fig" rid="pcbi.1007504.g003">Fig 3B</xref> shows the ROC curves by method averaged over simulated assays with ten barcodes per allele, 5% truly functional variants, and 3000 variants. <xref ref-type="fig" rid="pcbi.1007504.g003">Fig 3C</xref> shows the precision-recall curves for the same simulations. <xref ref-type="fig" rid="pcbi.1007504.g003">Fig 3D</xref> shows that across all simulations with these characteristics, malacoda consistently showed the highest median AUC and AUPR, the highest correlation with the truth for functional variants, and the lowest standard deviation of estimates of truly non-functional variants. The last metric, “spread at zero”, particularly emphasizes the regularization effect, showing that while malacoda tends to produce the most accurate effects for functional variants, it can simultaneously provide the smallest estimates for truly non-functional variants. Other combinations of simulation parameters are shown in section 5 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s003">S3 Appendix</xref>, displaying similar patterns.</p>
      <p>In order to examine the performance of malacoda on real data, we applied the various methods to both the Ulirsch data [<xref rid="pcbi.1007504.ref005" ref-type="bibr">5</xref>] and to our own primary dataset. Unlike the case with simulations, the underlying true transcription shift values are not known. However, inter-method consensus can serve as a performance metric. Methods that utilize varying model structure will tend to make errors in different ways, so methods that consistently perform well will show higher correlation with alternatives than the correlations between the methods that perform poorly. Indeed, <xref ref-type="fig" rid="pcbi.1007504.g004">Fig 4</xref> shows that the other methods tend to correlate with malacoda better than each other. This occurs despite the expected non-linear relationship between regularized and unregularized models (i.e. between malacoda and the other alternatives). The fits based on malacoda’s marginal and conditional priors (first and second rows/columns) in both panels of <xref ref-type="fig" rid="pcbi.1007504.g004">Fig 4</xref> tend to correlate strongly because of the identical model structure paired with large spread of DeepSea predictions used in the prior estimation process. The conditional prior fit only deviates significantly from the marginal prior fit for variants with high DeepSea predictions.</p>
      <fig id="pcbi.1007504.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007504.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Inter-method consensus.</title>
          <p>A) A pairwise plot of TS estimate comparisons between methods in our primary MPRA dataset, showing that alternative methods generally agree with malacoda more than each other. Shaded values above the diagonal show the correlation values for the corresponding plot below the diagonal. Color below the diagonal indicates local density of points in over-plotted regions. B) A pairwise plot of TS estimates using both the marginal and DeepSea-based malacoda priors in the Ulirsch dataset, showing a similar outcome.</p>
        </caption>
        <graphic xlink:href="pcbi.1007504.g004"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Biological results</title>
      <p>The variants we tested with luciferase reporter assays were predominantly chosen from the set where malacoda’s marginal and conditional fits disagreed on functionality, not those variants showing the strongest effects. These discordant variants tended to have small effects and the noise between replicates tended to be comparable to the mean intensity ratio. Therefore, the number of variants tested was not enough to overcome the noise inherent to light intensity-based measurements and provide conclusive results on the accuracy of the various MPRA analysis methods. While we were able to recapitulate the transcriptional functionality of several variants, we did not have enough data to clearly demonstrate that any of the MPRA analysis methods outperform the others in terms of correlation with luciferase results. Nonetheless, <xref ref-type="supplementary-material" rid="pcbi.1007504.s007">S2 Fig</xref> shows that the various methods are consistent with MPRA-based estimates for variants with large shifts, providing further evidence that MPRA results are biologically realistic.</p>
      <p>We closely inspected a particular biological discovery to demonstrate malacoda’s ability to identify low-signal variants. One of the functional variants we identified with malacoda using the DeepSea-based conditional prior in the Ulirsch dataset [<xref rid="pcbi.1007504.ref005" ref-type="bibr">5</xref>] is rs11865131; this variant is identified by malacoda but not by any of the other methods after multiple testing corrections or with the marginal prior. The conditional prior is compared to the marginal prior in <xref ref-type="supplementary-material" rid="pcbi.1007504.s006">S1 Fig</xref>. We validated this variant is functional by luciferase assay in K562 cells with the results shown in <xref ref-type="fig" rid="pcbi.1007504.g005">Fig 5</xref>. The variant rs11865131 is in an intron within the <italic>NPRL3</italic> gene which encodes the Natriuretic Peptide Receptor Like 3 protein. <italic>NPRL3</italic> is part of the GTP-ase activating protein activity toward Rags [<xref rid="pcbi.1007504.ref022" ref-type="bibr">22</xref>] (GATOR1) complex. The GATOR1 complex inhibits mammalian target of rapamycin (<italic>MTOR</italic>) by inhibiting <italic>RRAGA</italic> function (reviewed in [<xref rid="pcbi.1007504.ref022" ref-type="bibr">22</xref>] <italic>MTOR</italic> signaling has been implicated in platelet aggregation and spreading in addition to aging associated venous thrombosis [<xref rid="pcbi.1007504.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1007504.ref024" ref-type="bibr">24</xref>]. Analysis of the rs11865131 locus with HaploReg [<xref rid="pcbi.1007504.ref025" ref-type="bibr">25</xref>] indicates that it colocalizes with ENCODE ChIP-Seq peaks for 36 bound proteins (predominantly transcription factors) in K562 erytholeukemia cells as well as containing enhancer histone epigenetic marks. Furthermore, this variant lies roughly one thousand base pairs away from the nearest exon-intron boundary, suggesting that it is unlikely to alter splicing of the NPRL3 transcript. Together, these data indicate that this is likely an important regulatory region. In addition to the heterologous K562 cell line, data from cultured megakaryocytes indicates that rs11865131 lies within <italic>RUNX1</italic> and <italic>SCL</italic> ChIP-Seq peaks, two well-studied megakaryopoietic transcription factors [<xref rid="pcbi.1007504.ref026" ref-type="bibr">26</xref>]. This agrees with our data that platelet <italic>NPRL3</italic> mRNA is positively associated with platelet count in healthy humans [<xref rid="pcbi.1007504.ref027" ref-type="bibr">27</xref>, <xref rid="pcbi.1007504.ref028" ref-type="bibr">28</xref>]. These data indicate that malacoda has identified a likely important regulatory region for megakaryocytes and platelets that was missed by other MPRA analysis methods.</p>
      <fig id="pcbi.1007504.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007504.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Luciferase validation results.</title>
          <p>A bar plot showing the difference in normalized luciferase intensity for both alleles of rs11865131 (p = 0.032). Black error bars indicate +/- one standard deviation.</p>
        </caption>
        <graphic xlink:href="pcbi.1007504.g005"/>
      </fig>
      <p>MCMC can be computationally expensive, so we measured the run times in our study. The computational performance was first evaluated using the default settings of the malacoda package which are set to strike a balance between speed and precision for exploratory analysis. These settings include the variational first pass, 200 warmup samples, four chains yielding a total of 2000 posterior samples, and adaptively increased chain lengths. This initial analysis run of 8251 variants from the Ulirsch dataset took 29 minutes when parallelized across 18 threads on two Intel Xeon X5675 3.07GHz processors. We compared this to a highly precise analysis run on the same dataset with no variational first pass and excessively long 50,000 iteration MCMC chains for all variants, which took fifteen hours with the same number of cores on the same processors. The correlation between posterior mean TS between these two runs was 0.981 for non-functional variants and 0.99996 for functional variants. This result, together with the MCMC diagnostics shown in section 2.4.2 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s001">S1 Appendix</xref>, demonstrates that the sampler used by our software is able to produce accurate estimates in a relatively short amount of time. Details of the computational methodology and results demonstrating convergence are presented in section 2.4 of <xref ref-type="supplementary-material" rid="pcbi.1007504.s001">S1 Appendix</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Discussion</title>
    <p>We developed a fully Bayesian framework for the analysis of NGS high-throughput screens with particular focus on MPRA studies. The method, called malacoda, is an advance in statistical and computational science that probabilistically incorporates all known sources of variation for these high throughput NGS screens. The method does a better job of identifying true positives in simulated data and performs well in empirical studies. We also showed that the method identified a previously overlooked functional variant in the <italic>NPRL3</italic> gene that has confirmatory evidence from a variety of other studies. Particular advantages of the method are accurate estimation of variant effects, the treatment of the dispersion parameter in both estimation and inference, and the potential to incorporate informative prior information.</p>
    <p>The functional discovery of the variant rs11865131 represents a demonstration of the power of the malacoda method to identify biologically important results missed by alternative methods. This variant lies in an intronic region of the gene <italic>NPRL3</italic>, meaning approaches focused on alterations to the gene’s protein code would overlook this regulatory variant. Multiple lines of evidence point to the biological relevance of this variant, including epigenetic and transcription factor binding data as well as evidence of association with platelet count in healthy humans.</p>
    <p>There are downsides to our method. First, Bayesian methods that estimate a joint posterior on many parameters by MCMC are significantly slower than optimization-based approaches. We took several approaches to mitigate this, utilizing Stan’s No-U-Turn Sampler and including options for first pass variational approximations, adaptive MCMC length, and parallelization. Together these features enable relatively fast model fitting. Second, our method does not account for uncertainty in our empirical prior estimation procedure [<xref rid="pcbi.1007504.ref016" ref-type="bibr">16</xref>]. Our R package includes a fully hierarchical model that adds an additional layer of hyperparameters in order to probabilistically model the gamma prior parameters at the same time as all of the variant-level parameters. This provides a joint posterior that models an entire MPRA dataset with a single MCMC fit. However, this model, featuring hundreds of thousands of parameters when used in the context of a typical MPRA, is presently too complex to fit in practice and was not used for the results presented in this work. Finally, our work is limited to MPRA performed in K562 cells, however there is nothing cell-type specific about the malacoda model. Our method can be used in MPRA performed in alternative cell-types so long as they follow the experimental structure outlined in the Methods section.</p>
    <p>It is worthwhile to discuss the most effective ways to utilize external annotations to estimate informative empirical priors. We encourage users to utilize information that was originally used in the assay’s variant selection process. For example, assays designed around inspecting specific transcription factors with varying biological context may want to use the targeted transcription factor as the group identifier in a grouped prior as in <xref ref-type="fig" rid="pcbi.1007504.g002">Fig 2C</xref>. Using information independent of the original design can also be helpful, as we have demonstrated through the use of a conditional prior based on DeepSea’s K562 DNase hypersensitivity predictions which helped to refine the inference on a low-signal variant, rs11865131. The malacoda package can utilize an arbitrary number of continuous annotations, so any set of relevant, independent annotations may be used. As long as the principle of “similarly annotated variants have similar outcomes in the assay” holds, using informative annotations can help refine the analysis. Nonetheless, it is difficult to accurately predict the transcription shift of a single variant <italic>a priori</italic>. Conditional priors that make strong predictions of functionality should be treated with caution. We encourage the users to utilize the prior visualization functionality included in the package to contrast annotation-based priors against a marginal prior. Future advances in machine learning models for predictive variant annotation will likely improve the performance of the informative empirical priors.</p>
    <p>It is desirable to identify an orthogonal gold-standard dataset to differentiate the accuracy of MPRA analysis approaches. Such an analysis would define an independent score of functionality for all variants, and then hits and non-hits from each MPRA analysis method could be compared for their concordance or correlation with this independent score. We attempted such an analysis using the Ulirsch dataset, ENCODE K562 bound protein levels, and DeepSea DNase hypersensitivity annotations. Unfortunately these analyses were inconclusive, showing no clear difference in annotation scores between analysis methods. There are at least two possible explanations for this difficulty. First, the noise present in both the MPRA and annotation data lowers the power to differentiate the methods. Secondly, there is misalignment between MPRA functionality and differential scoring in the annotation data. Both of these factors likely contribute to the negative result. We would postulate that if there were an idealized dataset showing high correspondence in variants that are potentially functionalizable by MPRA and simultaneously differentially scored in the orthogonal annotation data, then this hypothetical data could be used to compare the efficacy of the various MPRA analysis methods. At present, we know of no data source that would meet these requirements. While this limits our ability to quantify the performance of MPRA analysis methods, it speaks to the value of MPRA themselves. MPRA produce a unique biological signal that cannot be easily measured by other types of experiments or data.</p>
    <p>The statistical method and validation work presented in this article present many future directions in the statistical analysis of high-throughput sequencing assays. This article has focused primarily on the analysis of “typical” MPRA: two alleles per variant, in a single tissue type, with no other experimental perturbations. However, we have expanded the modelling capabilities of the software package beyond these limitations. Models tailored to more complicated experimental structures, such as arbitrary numbers of alleles per variant, multiple tissue types, or cell-culture perturbations, are also included with the package. We also have expanded the model framework included in the package to CRISPR screen modelling. In this CRISPR model, the counts of gRNAs targeting specific genes in survival/dropout screens can make use of an analogous negative binomial structure with similar empirical gamma priors. This opens the path to incorporating gene-level annotations into Bayesian CRISPR screen analysis.</p>
    <p>Sophisticated high-throughput assays are a central component to the future of genomics. Therefore, the statistical methods used for these data should be as efficient as possible, accounting for all sources of variation and quantifying the resulting uncertainty. Our software, malacoda, provides an end-to-end framework for the probabilistic analysis of MPRA data. Through our well-documented, easy-to-use R package, users can perform sequencing error correction and data pre-processing before executing a fully Bayesian analysis in as little as two lines of code. The method is capable of taking advantage of informative annotations through an adaptive empirical prior estimation. We hope that this work may act as a stepping stone towards further integrative, probabilistic analysis in the field of high-throughput genomics.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec013">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Model description, fitting, and diagnostics.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s002">
      <label>S2 Appendix</label>
      <caption>
        <title>Negative Binomial variance estimation.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s003">
      <label>S3 Appendix</label>
      <caption>
        <title>Simulation details and extended results.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s004">
      <label>S1 Data</label>
      <caption>
        <title>RData file of luciferase and primary MPRA results.</title>
        <p>An RData file that loads two objects: luc_results, a table of the luciferase results, and mpra_results, giving the primary data on MPRA counts for the variants tested with luciferaseF.</p>
        <p>(RDATA)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s004.RData">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s005">
      <label>S2 Data</label>
      <caption>
        <title>RData file of estimate comparisons and primary MPRA data.</title>
        <p>An RData file that contains three data frames: ulirsch_comparisons, primary_comparisons, and primary_mpra_data. The first two data frames are the data necessary to produce <xref ref-type="fig" rid="pcbi.1007504.g004">Fig 4</xref>. Each row corresponds to one variant, and each column corresponds to a given analysis method. The values in the table give the transcription shift estimates. The third data frame gives the barcode counts from our primary MPRA dataset with anonymized variant identifiers.</p>
        <p>(RDATA)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s005.RData">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s006">
      <label>S1 Fig</label>
      <caption>
        <title>Prior comparison plot for rs11865131.</title>
        <p>This figure compares the allelic priors for the RNA activity for both alleles of rs11865131. The blue line shows the marginal prior, the red line the conditional prior based on the DeepSea K562 DNase hypersensitivity prediction. Dotted lines show the prior means. Black tick marks show the RNA count observations adjusted for sequencing depth and DNA input. Because this variant tended to show higher than usual activity in both alleles, both priors shrink the activity considerably. Notably however, the conditional prior shrinks less than the marginal, particularly in the reference allele. The allele-specific difference in shrinkage is what allowed the conditional prior-based analysis to identify this variant as functional.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s007">
      <label>S2 Fig</label>
      <caption>
        <title>Luciferase versus MPRA estimates by method.</title>
        <p>A scatterplot demonstrates the relationship between luciferase-based estimates of TS against MPRA-based estimates from each MPRA analysis method.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007504.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007504.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>Abecasis</surname><given-names>GR</given-names></name>, <name><surname>Altshuler</surname><given-names>DM</given-names></name>, <name><surname>Durbin</surname><given-names>RM</given-names></name>, <name><surname>Bentley</surname><given-names>DR</given-names></name>, <name><surname>Chakravarti</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A global reference for human genetic variation</article-title>. <source>Nature</source> [Internet]. <year>2015</year>;<volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
<?supplied-pmid 26432245?><pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hindorff</surname><given-names>LA</given-names></name>, <name><surname>Sethupathy</surname><given-names>P</given-names></name>, <name><surname>Junkins</surname><given-names>HA</given-names></name>, <name><surname>Ramos</surname><given-names>EM</given-names></name>, <name><surname>Mehta</surname><given-names>JP</given-names></name>, <name><surname>Collins</surname><given-names>FS</given-names></name>, <etal>et al</etal><article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2009</year>;<volume>106</volume>(<issue>23</issue>):<fpage>9362</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0903103106</pub-id><?supplied-pmid 19474294?><pub-id pub-id-type="pmid">19474294</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Nishizaki</surname><given-names>SS</given-names></name>, <name><surname>Boyle</surname><given-names>AP</given-names></name>. <article-title>Mining the Unknown: Assigning Function to Noncoding Single Nucleotide Polymorphisms</article-title>. <source>Trends Genet</source> [Internet]. <year>2017</year>;<volume>33</volume>(<issue>1</issue>):<fpage>34</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1016/j.tig.2016.10.008</pub-id>
<?supplied-pmid 27939749?><pub-id pub-id-type="pmid">27939749</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Melnikov</surname><given-names>A</given-names></name>, <name><surname>Murugan</surname><given-names>A</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Tesileanu</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Rogov</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Systematic dissection and optimization of inducible enhancers in human cells using a massively parallel reporter assay</article-title>. <source>Nat Biotechnol</source> [Internet]. <year>2012</year>;<volume>30</volume>(<issue>3</issue>):<fpage>271</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2137</pub-id>
<?supplied-pmid 22371084?><pub-id pub-id-type="pmid">22371084</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ulirsch</surname><given-names>JC</given-names></name>, <name><surname>Nandakumar</surname><given-names>SK</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Giani</surname><given-names>FC</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Rogov</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Systematic functional dissection of common genetic variation affecting red blood cell traits</article-title>. <source>Cell</source> [Internet]. <year>2016</year>;<volume>165</volume>(<issue>6</issue>):<fpage>1530</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.048</pub-id>
<?supplied-pmid 27259154?><pub-id pub-id-type="pmid">27259154</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Tewhey</surname><given-names>R</given-names></name>, <name><surname>Kotliar</surname><given-names>D</given-names></name>, <name><surname>Park</surname><given-names>DS</given-names></name>, <name><surname>Liu</surname><given-names>B</given-names></name>, <name><surname>Winnicki</surname><given-names>S</given-names></name>, <name><surname>Reilly</surname><given-names>SK</given-names></name>, <etal>et al</etal><article-title>Direct identification of hundreds of expression-modulating variants using a multiplexed reporter assay</article-title>. <source>Cell</source> [Internet]. <year>2016</year>;<volume>165</volume>(<issue>6</issue>):<fpage>1519</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.027</pub-id>
<?supplied-pmid 27259153?><pub-id pub-id-type="pmid">27259153</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>SQ</given-names></name>, <name><surname>Myers</surname><given-names>CA</given-names></name>, <name><surname>Hughes</surname><given-names>AEO</given-names></name>, <name><surname>Byrne</surname><given-names>LC</given-names></name>, <name><surname>Flannery</surname><given-names>JG</given-names></name>, <name><surname>Corbo</surname><given-names>JC</given-names></name>. <article-title>Massively parallel cis-regulatory analysis in the mammalian central nervous system</article-title>. <source>Genome Res</source>. <year>2016</year>;<volume>26</volume>(<issue>2</issue>):<fpage>238</fpage>–<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1101/gr.193789.115</pub-id><?supplied-pmid 26576614?><pub-id pub-id-type="pmid">26576614</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Myint</surname><given-names>L</given-names></name>, <name><surname>Avramopoulos</surname><given-names>DG</given-names></name>, <name><surname>Goff</surname><given-names>LA</given-names></name>, <name><surname>Hansen</surname><given-names>KD</given-names></name>. <article-title>Linear models enable powerful differential activity analysis in massively parallel reporter assays</article-title>. <source>BMC Genomics</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1186/s12864-018-5379-1</pub-id><pub-id pub-id-type="pmid">30606130</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Niroula</surname><given-names>A</given-names></name>, <name><surname>Ajore</surname><given-names>R</given-names></name>, <name><surname>Nilsson</surname><given-names>B</given-names></name>. <article-title>MPRAscore: robust and non-parametric analysis of massively parallel reporter assays</article-title>. <source>Bioinformatics</source>. <year>2019</year>;(<month>7</month>):<fpage>1</fpage>–<lpage>3</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz591</pub-id><?supplied-pmid 31359027?><pub-id pub-id-type="pmid">31359027</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Kalita</surname><given-names>C. A.</given-names></name>, <name><surname>Moyerbrailean</surname><given-names>G. A.</given-names></name>, <name><surname>Brown</surname><given-names>C.</given-names></name>, <name><surname>Wen</surname><given-names>X.</given-names></name>, <name><surname>Luca</surname><given-names>F.</given-names></name>, &amp; <name><surname>Pique-Regi</surname><given-names>R.</given-names></name> (<year>2018</year>). <article-title>QuASAR-MPRA: Accurate allele-specific analysis for massively parallel reporter assays</article-title>. <source>Bioinformatics</source>, <volume>34</volume>(<issue>5</issue>), <fpage>787</fpage>–<lpage>794</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx598</pub-id>
<?supplied-pmid 29028988?><pub-id pub-id-type="pmid">29028988</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Ashuach</surname><given-names>T.</given-names></name>, <name><surname>Fischer</surname><given-names>D. S.</given-names></name>, <name><surname>Kreimer</surname><given-names>A.</given-names></name>, <name><surname>Ahituv</surname><given-names>N.</given-names></name>, <name><surname>Theis</surname><given-names>F. J.</given-names></name>, &amp; <name><surname>Yosef</surname><given-names>N.</given-names></name> (<year>2019</year>). <article-title>MPRAnalyze: Statistical framework for massively parallel reporter assays</article-title>. <source>Genome Biology</source>, <volume>20</volume>(<issue>1</issue>), <fpage>1</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1186/s13059-018-1612-0</pub-id><pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>EP</given-names></name>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2013</year>;<volume>489</volume>(<issue>7414</issue>):<fpage>57</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1038/nature11247.An</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>J</given-names></name>, <name><surname>Troyanskaya</surname><given-names>OG</given-names></name>. <article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title>. <source>(DeepSea). Nat Methods</source> [Internet]. <year>2015</year>;<volume>12</volume>(<issue>10</issue>):<fpage>931</fpage>–<lpage>4</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3547</pub-id>
<?supplied-pmid 26301843?><pub-id pub-id-type="pmid">26301843</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source> [Internet]. <year>2014</year>;<volume>15</volume>(<issue>12</issue>):<fpage>550</fpage>
<pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
<?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref015">
      <label>15</label>
      <mixed-citation publication-type="book"><name><surname>Kruschke</surname><given-names>J.</given-names></name><source>Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and Stan</source>. <edition designator="2">2nd ed</edition><publisher-loc>London</publisher-loc>: <publisher-name>Academic Press</publisher-name>; c<year>2015</year> P.<fpage>336</fpage>–<lpage>40</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref016">
      <label>16</label>
      <mixed-citation publication-type="book"><name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Carlin</surname><given-names>JB</given-names></name>, <name><surname>Stern</surname><given-names>HS</given-names></name>, <name><surname>Dunson</surname><given-names>DB</given-names></name>, <name><surname>Vehtari</surname><given-names>A</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <source>Bayesian Data Analysis</source>. <edition designator="3">Third Edition</edition><publisher-loc>Boca Raton, FL</publisher-loc>: <publisher-name>CRC Press</publisher-name>; <year>2013</year> p. <fpage>51</fpage>–<lpage>6</lpage>, p. 102–4.</mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Carpenter</surname><given-names>B</given-names></name>, <name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>MD</given-names></name>, <name><surname>Lee</surname><given-names>D</given-names></name>, <name><surname>Goodrich</surname><given-names>B</given-names></name>, <name><surname>Betancourt</surname><given-names>M</given-names></name>, <name><surname>Brubaker</surname><given-names>M</given-names></name>, <name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>P</given-names></name>, <name><surname>Riddell</surname><given-names>A</given-names></name>. <article-title>Stan: A probabilistic programming language</article-title>. <source>J Stat Softw</source>. <year>2017</year>;<volume>76</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Kucukelbir</surname><given-names>A</given-names></name>, <name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Ranganath</surname><given-names>R</given-names></name>, <name><surname>Tran</surname><given-names>D</given-names></name>. <article-title>Automatic Differentiation Variational Inference</article-title>. <source>J Mach Learn Res</source>. <year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>45</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1603.00788">https://arxiv.org/abs/1603.00788</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Assaf</surname><given-names>G</given-names></name>, <name><surname>Hannon</surname><given-names>GJ</given-names></name>. <source>FASTX-Toolkit</source> [Internet]. <year>2010</year> Available from: <ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/index.html">http://hannonlab.cshl.edu/fastx_toolkit/index.html</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hawkins</surname><given-names>JA</given-names></name>, <name><surname>Jones</surname><given-names>SK</given-names></name>, <name><surname>Finkelstein</surname><given-names>IJ</given-names></name>, <name><surname>Press</surname><given-names>WH</given-names></name>. <article-title>Indel-correcting DNA barcodes for high-throughput sequencing</article-title>. <source>Proc Natl Acad Sci</source> [Internet]. <year>2018</year>;<volume>115</volume>(<issue>27</issue>):<fpage>E6217</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1802640115</pub-id>
<?supplied-pmid 29925596?><pub-id pub-id-type="pmid">29925596</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Ghazi</surname><given-names>AR</given-names></name>, <name><surname>Chen</surname><given-names>ES</given-names></name>, <name><surname>Henke</surname><given-names>DM</given-names></name>, <name><surname>Madan</surname><given-names>N</given-names></name>, <name><surname>Edelstein</surname><given-names>LC</given-names></name>, <name><surname>Shaw</surname><given-names>CA</given-names></name>. <article-title>Design tools for MPRA experiments</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>15</issue>):<fpage>2682</fpage>–<lpage>3</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty150</pub-id><?supplied-pmid 30052913?><pub-id pub-id-type="pmid">30052913</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Shaw</surname><given-names>RJ</given-names></name>. <article-title>GATORs take a bite out of mTOR</article-title>. <source>Science</source>. <year>2013</year>;<volume>340</volume>(<issue>6136</issue>):<fpage>1056</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1126/science.1240315</pub-id><?supplied-pmid 23723225?><pub-id pub-id-type="pmid">23723225</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Aslan</surname><given-names>JE</given-names></name>, <name><surname>Tormoen</surname><given-names>GW</given-names></name>, <name><surname>Loren</surname><given-names>CP</given-names></name>, <name><surname>Pang</surname><given-names>J</given-names></name>, <name><surname>McCarty</surname><given-names>OJT</given-names></name>. <article-title>S6K1 and mTOR regulate Rac1-driven platelet activation and aggregation</article-title>. <source>Blood</source>. <year>2011</year>;<volume>118</volume>(<issue>11</issue>):<fpage>3129</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1182/blood-2011-02-331579</pub-id><?supplied-pmid 21757621?><pub-id pub-id-type="pmid">21757621</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Zhou</surname><given-names>X</given-names></name>, <name><surname>Fan</surname><given-names>X</given-names></name>, <name><surname>Xiao</surname><given-names>M</given-names></name>, <name><surname>Yang</surname><given-names>D</given-names></name>, <name><surname>Liang</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>MTORC1 promotes aging-related venous thrombosis in mice via elevation of platelet volume and activation</article-title>. <source>Blood</source>. <year>2016</year>;<volume>128</volume>(<issue>5</issue>):<fpage>615</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.1182/blood-2015-10-672964</pub-id><?supplied-pmid 27288518?><pub-id pub-id-type="pmid">27288518</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Ward</surname><given-names>LD</given-names></name>, <name><surname>Kellis</surname><given-names>M</given-names></name>. <article-title>HaploReg v4: Systematic mining of putative causal variants, cell types, regulators and target genes for human complex traits and disease</article-title>. <source>Nucleic Acids Research</source>. <year>2016</year>;<volume>44</volume>(<issue>D1</issue>), <fpage>D877</fpage>–<lpage>D881</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv1340</pub-id><?supplied-pmid 26657631?><pub-id pub-id-type="pmid">26657631</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Chacon</surname><given-names>D</given-names></name>, <name><surname>Beck</surname><given-names>D</given-names></name>, <name><surname>Perera</surname><given-names>D</given-names></name>, <name><surname>Wong</surname><given-names>JWH</given-names></name>, <name><surname>Pimanda</surname><given-names>JE</given-names></name>. <article-title>BloodChIP: A database of comparative genome-wide transcription factor binding profiles in human blood cells</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(<issue>D1</issue>):<fpage>172</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt1036</pub-id><?supplied-pmid 24185696?><pub-id pub-id-type="pmid">24185696</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Simon</surname><given-names>LM</given-names></name>, <name><surname>Edelstein</surname><given-names>LC</given-names></name>, <name><surname>Nagalla</surname><given-names>S</given-names></name>, <name><surname>Woodley</surname><given-names>AB</given-names></name>, <name><surname>Chen</surname><given-names>ES</given-names></name>, <name><surname>Kong</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Human platelet microRNA-mRNA networks associated with age and gender revealed by integrated plateletomics</article-title>. <source>Blood</source>. <year>2014</year>;<volume>123</volume>(<issue>16</issue>):<fpage>37</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1182/blood-2013-12-544692</pub-id><?supplied-pmid 24523238?><pub-id pub-id-type="pmid">24523238</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007504.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Edelstein</surname><given-names>LC</given-names></name>, <name><surname>Simon</surname><given-names>LM</given-names></name>, <name><surname>Montoya</surname><given-names>RT</given-names></name>, <name><surname>Holinstat</surname><given-names>M</given-names></name>, <name><surname>Chen</surname><given-names>ES</given-names></name>, <name><surname>Bergeron</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Racial differences in human platelet PAR4 reactivity reflect expression of PCTP and miR-376c</article-title>. <source>Nat Med</source> [Internet]. <year>2013</year>;<volume>19</volume>(<issue>12</issue>):<fpage>1609</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1038/nm.3385</pub-id>
<?supplied-pmid 24216752?><pub-id pub-id-type="pmid">24216752</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007504.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Methods Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lengauer, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lengauer, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Dec 2019</named-content>
    </p>
    <p>Dear Dr. Shaw,</p>
    <p>Thank you very much for submitting your manuscript 'Bayesian modelling of high-throughput sequencing assays with malacoda' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers thought that the method could be potentially useful but raised some substantial concerns about the manuscript as it currently stands. In particular, the details of the method description and evaluation approach should be further clarified. The data used in the study should be made available. It would also be important to put this work in the context of existing literature and highlight the advantages and limitations. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Jian Ma</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Summary:</p>
    <p>This manuscript presents malacoda, a Bayesian method for identifying alleles with significantly different abilities to activate gene expression in an MPRA. malacoda accounts for variation due to unknown DNA concentrations and allows for users to incorporate prior information about variants, properties that existing methods do not have. In addition, unlike previous methods, it does not summarize the data before modeling. The manuscript reports results from simulations that show that malacoda is able to detect functional variants with higher accuracy than previous methods across multiple numbers of bar-codes per allele, array sizes, and fractions of functional variants. The manuscript also shows that malacoda tends to agree more with other methods on real MPRA data than the other methods agree with each other. In addition, the manuscript presents luciferase assays that malacoda’s results for sixteen variants, including multiple functional variants that were not identified as functional by other methods. Overall, I think that malacoda is a useful tool for using MPRA data to determine if non-coding variants are functional that is likely to be widely used because it is more accurate than existing methods and a thorough description of how it works as well as code needed to run it have been made publicly available.</p>
    <p>Major Comments:</p>
    <p>1. Figure 3A makes me concerned that malacoda’s precision is not very high because a large percentage of the simulated variants with transcription shifts greater than zero seem to be non-functional. Figure 3D enhances this concern because many of the luciferase estimates near zero seem to correspond to MPRA estimates that are further from zero. The manuscript would be more convincing if the authors could show that malacoda had high precision or at least substantially higher precision than other methods. In addition, since Figures 3A and 3D do suggest that malacoda does not report any non-functional variants to have transcription shift &gt; 1.5, including the precision at different transcription shift cutoffs might also be helpful.</p>
    <p>2. The paper mentions primary MPRA data, but this data is never described in detail. If the data is new to this paper, then a description of the data, including how the tested sequences were selected, what MPRA protocol was used, and how the plasmids were constructed, needs to be added. If the data was taken from another publication, then that publication needs to be cited.</p>
    <p>3. The supplemental websites are extremely helpful. They provide many simulations that give readers intuition that is helpful in understanding the modeling decisions in this paper. They also help readers think about how much data would be needed to obtain good parameter estimates for the models in this paper. In addition, code is provided to generate the figures along with the packages needed to run the code, which enables readers to reproduce the figures and modify them in order to further improve their intuition.</p>
    <p>Minor Comments:</p>
    <p>Introduction:</p>
    <p>1. The value of malacoda is not that it is Bayesian but that it does not have the drawbacks of previous methods – ignoring variation due to unknown DNA concentrations, summarizing the data prior to modeling, and not accounting for relevant prior information. I would re-structure the final paragraph of the introduction to emphasize its strengths over existing methods instead of its Bayesian nature.</p>
    <p>Methods:</p>
    <p>1. In line 144, the second dot should be a comma.</p>
    <p>2. In lines 144-145, the reasons behind the definitions of the means for the negative binomial distribution were clear to me, but I am not sure if they would be clear to someone who has not thought about MPRAs before. It therefore might be useful to add a sentence explaining the reasons.</p>
    <p>3. The definition of “95% highest density interval on TS” in line 171 was not clear to me; it would be great if this could be clarified.</p>
    <p>4. The reason that the method for learning the gamma priors removes the need for post-hoc multiple testing correction, as claimed in line 193, was not clear to me. My understanding is that, even though all of the variants in the MPRA are used to learn the gamma priors, the effect of each variant on transcription is still tested separately, which would mean that multiple testing correction should still be required.</p>
    <p>5. If an existing software package was used for model fitting, then the package and settings that were used should be added.</p>
    <p>6. In the section on Simulation and Validation Studies, it would be great if a complete list the parameters used in the simulations could be provided (providing them as a supplemental table would be sufficient). If the supplemental websites contain every parameter used in the simulations, then directing the reader to the appropriate supplemental website should be sufficient.</p>
    <p>7. It would be great if the authors could also compare area under the precision-recall curve because there are probably more non-functional variants than functional variants, so high sensitivity and specificity does not guarantee high precision.</p>
    <p>8. In the section on Experimental Procedures, it would be helpful to add a description of the full experimental procedure for the new MPRA in this manuscript.</p>
    <p>9. In the section on Experimental Procedures, it would be helpful to direct readers to the supplemental file containing the variants tested in luciferase assays.</p>
    <p>Results:</p>
    <p>1. At the beginning of the section on Biological Results, it would be helpful to include an explanation of why the number of luciferase reporter assays was not enough to overcome the amount of noise inherent to light intensity-based measurements or provide a citation of a paper that explains this.</p>
    <p>2. Lines 294-296 state that the results from the luciferase assay are consistent with the MPRA estimates, but this seems to occur for only the largest transcription shifts. I think that this should be modified to say that the results are consistent for large transcription shifts.</p>
    <p>3. Figure 4 suggests that evaluations were done using DeepSea-based priors, but there is no description of these results other than that the effect of rs11865131 was found using the DeepSea based priors. Figure 4B suggests that the results using the DeepSea-based priors were highly correlated with those without the priors. It would be helpful to add a summary of these results to the Results section.</p>
    <p>4. The results provide evidence that rs11865131 is functional because it affects the activity of an intronic enhancer. The results about this variant would be more compelling if the authors added that this variant is not close to any exon-intron boundary, so it is unlikely to also affect splicing.</p>
    <p>5. It would be helpful to add a description of how the analysis of rs11865131 overlap with ChIP-seq peaks was done (For example, were all peaks or only reproducible peaks used? When there were datasets from multiple labs for a TF or histone modification, which dataset was used?) and what the TFs and histone modifications are whose peaks overlap it.</p>
    <p>6. If a luciferase assay was done for rs11865131, it would be helpful to add a description of the assay’s results in the Results section in addition to having them in a supplemental file.</p>
    <p>Discussion:</p>
    <p>1. The paper would be easier to follow if the description of how the models were fit was moved to the Methods section.</p>
    <p>2. The phrase “seemingly worthwhile” in line 334 should be defined.</p>
    <p>3. Line 342 mentions “an additional layer of hyper-parameters.” If these hyper-parameters were used to obtain the results in this paper, then a description of them should be added to the Methods section. If not, then it would be helpful to clarify that they are an option that the user can add but were not used to obtain this paper’s results.</p>
    <p>4. It is not clear how much the DeepSea priors helped for the MPRAs described in this study. It would be helpful to add a section to the Discussion that provides some guidance to users about when priors are likely to be helpful.</p>
    <p>Figures:</p>
    <p>1. According to Figure 3A, the transcription shift for many non-functional variants is higher than the transcription shift for functional variants. It may appear to be this way because the difference between the density of points at the origin and on other parts of the y-axis is not viewable by eye. Modifying this figure to show the difference in density would be helpful. One option is to use smaller points. Alternatively, another part of the figure could be made that zooms in on the y-axis.</p>
    <p>2. It would be helpful to add a panel to Figure 3 that illustrates how the results from malacoda are used to determine which variants are “functional.”</p>
    <p>3. It would be helpful to add precision recall curves to Figure 3 to help the reader understand how frequently variants that are called positives are false positives.</p>
    <p>4. It would be helpful to make the x- and y-axes the same scale in Figure 3D or add a line for y = x.</p>
    <p>5. It would be helpful to add an explanation of the plots on the diagonals of the plot tables in Figure 4.</p>
    <p>Supplement:</p>
    <p>1. In the Description of point estimates of variance parameters section, it would be helpful to add a description of how the curve between maximum log-likelihood estimates of means and variances is fit.</p>
    <p>2. In the Simulating variance parameter point estimates section, it would be helpful to add an explanation of why the chosen values are representative of the data from an MPRA or provide a citation of a paper that has such an explanation.</p>
    <p>3. In the Simulating variance parameter point estimates section, it would be helpful to add an explanation of why the maximum likelihood estimates are systematically lower than the true value.</p>
    <p>4. The NB likelihood surfaces section claims that the simulated draws described on the supplemental website “usually” allow for the true value. It was not clear to me why they do not always allow for the true value; in other words, I know that the true value will not always be drawn, but I am not sure why drawing the true value is not always possible.</p>
    <p>5. In the Effect on mean estimation section, the dotted and orange lines on the x-axis were confusing to me. I would recommend removing them.</p>
    <p>Reviewer #2: The authors presented a method and an R package called malacoda to model MPRA read count data with negative binomial distribution. The main contribution lies in modeling the mean and dispersion parameters as variables sampled from unknown gamma distribution. The paper is well written in general but there are some missing technical details. Major comments are below.</p>
    <p>1. Authors should describe the Bayesian model in much more detail as it is now in the manuscript</p>
    <p>a. One page 7, line 144 and 145, authors outlined the two generative NB models for DNA and RNA counts. Then they use Figure 2B to depict the hyperparameter of the gamma distributions that are used to model depath_s\\mu_{bc} and \\varphi_{DNA} for Counts_DNA. Similarly, another gamma distribution is used eto model depath_s\\mu_{bc}\\mu{allele} and \\varphi_{RNA} variables.</p>
    <p>b. Just the generative model itself is not fully described in the main text. What’s distribution of \\mu_{bc}? What’s the distribution of \\varphi_{RNA}? If some of them are gamma distributed, what are the hyperparameters of these gamma distributions? Fixed or also estimated? Etc etc. No detail described here whatsoever.</p>
    <p>c. The details on how the model is inferred is completely omitted. I understand the authors use out of the box optimizer Stan library to do the model fitting part. But that does not mean that there is no need to describe the necessary detail on the Bayesian inference.</p>
    <p>d. In particular, given that \\mu_{bc} is unknown and is both DNA and RNA NegBin model, how is the coordinate ascent work in the variational Bayesian and how is it sampled in the no-U-turn Hamiltonian Monte Carlo sampling?</p>
    <p>e. If variational Bayesian is used, what’s the proposed distribution?</p>
    <p>f. If Hamiltonian Monte Carlo sampling, what’s the leap frog steps? What’s the step size? How the parameters are sampled? Together (not tractable)? Or separately in what order?</p>
    <p>2. In Figure 3D, where authors used their in-house data to show malacoda, what’s the correlation across the 4 methods? It looks like malacoda is not better than the other 3 methods.</p>
    <p>3. For rs11865131, in page 14 line 299, what’s the prediction scores from the other methods? Why is the variant not identified by those methods but by malacoda?</p>
    <p>4. Page 14 line 306: How many such variants (i.e., rs11865131) exclusively identified by malacoda but not other methods? Can you count the number of ENCODE ChIP-seq peaks that each of the top 100 variants co-localize and compare them with the other 3 methods?</p>
    <p>5. Authors says their model takes 50,000 MCMC samples, do the model converge in the end? Please show the plot of joint posterior or Hamiltonian energy (since authors is using HMC sampler) as a function of iterations.</p>
    <p>6. Regarding more advanced prior, the authors should be aware that there are more advance supervised learning method that is train to predict MPRA signals using sequence features and epigenomic features. See this paper:</p>
    <p>a. Li, Y., Shi, A., Tewhey, R., Sabeti, P., Ernst, J., &amp; Kellis, M. (2017). Genome-wide regulatory model from MPRA data predicts functional regions, eQTLs, and GWAS hits. bioRxiv. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1101/110171">http://doi.org/10.1101/110171</ext-link></p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">21 Feb 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s008">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">malacoda_resubmission_letter.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007504.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Jian Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jian Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Mar 2020</named-content>
    </p>
    <p>Dear Dr. Shaw,</p>
    <p>Thank you very much for submitting your manuscript "Bayesian modelling of high-throughput sequencing assays with malacoda" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' additional comments. In particular, one of the reviewers thought that the revision has not adequately addressed the concerns. </p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I am impressed with the additional work that the authors have done to incorporate all of the reviewers’ feedback. The new version of the manuscript and the new appendix provide many helpful details that are necessary for fully understanding the presented computational and experimental work. In addition, the more comprehensive comparisons to previous methods and the new luciferase assay make me more convinced that malacoda is more effective than the previous methods described here at identifying alleles with differential ability to activate gene expression.</p>
    <p>I have one new major comment:</p>
    <p>1. I recently became aware of two relevant papers that the authors did night cite: Ashuach et al., Genome Biology, 2019 (<ext-link ext-link-type="uri" xlink:href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1787-z">https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1787-z</ext-link>) and Kalita et al., Bioinformatics, 2018 (<ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bioinformatics/article/34/5/787/4209990">https://academic.oup.com/bioinformatics/article/34/5/787/4209990</ext-link>). It would be great if the authors could add an explicit explanation of the key advantages of malacoda over the methods described in these papers or the key differences between the types of problems that malacoda and these methods are capable of solving. If these methods are solving the same problem as malacoda, it would be great if the authors could add comparisons to these methods.</p>
    <p>I have a few new minor comments:</p>
    <p>Introduction:</p>
    <p>1. In line 126, I would replace “wet bench” with “luciferase.”</p>
    <p>Appendices:</p>
    <p>1. The additional details in Appendix S1 are extremely informative for understanding exactly how malacoda works and how to run different parts of the method. malacoda seems to require the selection of multiple settings, including the number of warm-up samples, the number of samples per chain, and the total number of samples for MCMC. It would be great if the authors could add a description of how the recommended settings were selected.</p>
    <p>2. Appendix S2 provides a helpful explanation of why having a prior on φ in the negative binomial distribution has the potential be beneficial, but it was clear what if any part of example 6 was illustrating malacoda’s prior on φ. It would be great if this could be clarified.</p>
    <p>Reviewer #2: - It’d have been great if the authors were to describe what they have done to address my comments as opposed to just pointing me to a somewhere in the document. Especially, the changes are not highlighted relative to the original draft.</p>
    <p>- For example, in response to my comment 1 on the distributions of the model, authors pointed me to line 174-179, where there is no distribution specified there but rather lines 151-156 have some added distributions. Authors point me to “Section 1 of the new S1 Appendix” on the rest of my comments expecting me to find the answers myself.</p>
    <p>- For the variational Bayesian comments, the authors said “Stan’s variational interface with the R function rstan::vb(), …, former of these automatically transforms the parameters to the space of real numbers before using a Gaussian variational approximation.” How does the Gaussian approximation work on Negative Binomial? It may seems that my comments are too harsh. However, because this is a technical methodology paper, to me, the main contribution of this paper is on this detailed modeling.</p>
    <p>- If the authors go through this round of the review, I would like to see in their response the model details instead of pointing me to somewhere else in the documents.</p>
    <p>- For my comment 2, the correlation for malacoda is worse than the other two competitors (MPRAscore and even simple t-test). Authors said that this is not practically significant. But I thought the reason the authors show this scatter plot is to demonstrate that their method is better than other methods. Authors also said that “the assays shown were not selected to be representative of the most strongly functional variants”. But why not select the “representative of the most strongly functional variants” to test?</p>
    <p>- On my comment 4, authors show a table comparing the consistency between top 100 variant predicted by each method with ChIP-seq peaks. It seems MPRAscore once again does better than malacoda. Even t-test has better lower false positive rate and comparable true positive rate. This does not seem to support malacoda as the method of choice.</p>
    <p>- Comment 5 on 50,000 MCMC samples, instead of pointing to appendix, please add the plots in your response *if* the authors pass through this round.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">20 Apr 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s009">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">malacoda_resubmission_letter_2.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007504.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Jian Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jian Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 May 2020</named-content>
    </p>
    <p>Dear Dr. Shaw,</p>
    <p>Thank you very much for submitting your manuscript "Bayesian modelling of high-throughput sequencing assays with malacoda" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. Based on the reviewers' feedback, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days by addressing to the additional comments from the reviewers. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The changes that the authors have made to incorporate my and the other reviewers’ feedback have further improved the manuscript. I think that a major limitation of this manuscript is that there is little evaluation on real data other than in K562, an immortalized cancer cell line that is unlikely to be representative of any cell type in the human body. However, the ideal data for such evaluation does not exist, and the authors stated this limitation very clearly in the Discussion section, so I do not think that this limitation should hold back this manuscript from being published. I have come up with a few ideas that I have listed below that might help further demonstrate the value of malacoda relative to other methods. I also identified a few parts of the manuscript and github page that I would recommend further clarifying. Since the authors have made all of the code publicly available and provided details in their appendices about how to run malacoda, I think that malacoda could be come a widely used method for using MPRA data to identify putatively functional variants.</p>
    <p>I have one new major comment:</p>
    <p>1. I think that the paper would benefit tremendously from comparing malacoda to other methods on an additional real MPRA dataset. I recently became aware of a dataset that might be ideal for such a comparison: the dataset in Tewhey et al., Cell, 2016 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/27259153">https://www.ncbi.nlm.nih.gov/pubmed/27259153</ext-link>). Since there is substantial eQTL data from lymphoblastoid cell lines from datasets like Geuvadis, I think that additionally showing that the putatively functional variants that malacoda detects in this dataset are more likely to overlap with eQTLs (or SNPs in linkage disequilibrium with eQTLs) than those detected by other methods would make the value of malacoda relative to other methods more apparent.</p>
    <p>I have a few new minor comments:</p>
    <p>Response to other reviewer:</p>
    <p>1. The other reviewer brought up the important point that the putatively functional variants identified by MPRAscore are more likely to overlap ChIP-seq peaks than those identified by malacoda. The authors responded by comparing the DeepSEA DNase annotations between those variants across methods and evaluating the similarity between the annotations with a two-way ANOVA test. I found the description of the two-way ANOVA test a little confusing. My understanding is that the null hypothesis of the two-way ANOVA is that the means of the DeepSEA DNase scores are equal across methods. Thus, my understanding is that not rejecting the null hypothesis, does not imply that the null hypothesis is correct; it implies that the null hypothesis cannot be rejected. If the authors re-did the analysis on LCLs and found more overlap between putatively functional variants identified by malacoda than those identified by other methods, then I would not be as concerned about the ChIP-seq result. Alternatively, the authors could evaluate if the putatively functional variants identified by malacoda tend to be closer to TSS’s or closer to K562 DNase peak summits than those identified by other methods.</p>
    <p>Introduction:</p>
    <p>1. An exciting application of using MPRAs to identify putative functional variants is to help determine which of multiple variants in linkage disequilibrium that have all been associated with a disease are likely to be causal. I think that mentioning this near the beginning of the introduction might encourage more researchers to read the rest of the paper.</p>
    <p>2. In lines 101-102, I think that “transcription binding” should be replaced with “transcription factor binding.”</p>
    <p>3. In line 106, I would replace “has been unclear” with “has not been developed” (if that is accurate).</p>
    <p>Methods:</p>
    <p>1. In line 181, I would replace “learn” with “evaluate.”</p>
    <p>Results:</p>
    <p>1. The way that the p-values were computed was clear from the Appendix, but the way that the p-values were used to compute AUC and AUPR was not immediately intuitive to me. It would be helpful if this were described in more detail.</p>
    <p>Discussion:</p>
    <p>1. The Discussion section describes some extensions to malacoda that are available in the software package but are not described in detail or analyzed in this paper. I would recommend removing these and writing another paper about them that describes them in detail. Other researchers might be reluctant to use them if they do not have access to a clear explanation of how they work.</p>
    <p>Figures:</p>
    <p>1. The color-coding at the bottom of Figure 1 might be a little confusing to some readers because the red RNA could be interpreted as meaning that all of the RNA is coming from the first variant. I might instead make the RNA corresponding colors to the variant that produced it or make it similar to the brown color of the DNA that will get transcribed in the middle of the figure.</p>
    <p>Appendices:</p>
    <p>1. The code is generally easy to follow; removing the commented-out code would make some parts even easier to follow.</p>
    <p>github page:</p>
    <p>1. I think that a more detailed description of the inputs would make malacoda easier to use. Specifically, a description of the exact format of mpra_data would be helpful.</p>
    <p>2. I had trouble finding the help documentation on the github. It would be great if a link to it could be added in a prominent location.</p>
    <p>3. There seem to be some R scripts in the github that are not explained anywhere on the github. It would be great if a brief description of each R script could be added.</p>
    <p>Reviewer #2: Authors have addressed the technical concern and clarity comments that I have. Please add legends to Figure 3B and 3C.</p>
    <p>Also, Figure 3D median spear at zero is confusing. Authors should just add error bar to the bars displayed on the first three panels for median AUC, AUPR, non-zero correlation.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r006" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r006</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 2</article-title>
    </title-group>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Jun 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007504.s010">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">malacoda_letter_may.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007504.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r007" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r007</article-id>
    <title-group>
      <article-title>Decision Letter 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Jian Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jian Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj007" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Jun 2020</named-content>
    </p>
    <p>Dear Dr. Shaw,</p>
    <p>We are pleased to inform you that your manuscript 'Bayesian modelling of high-throughput sequencing assays with malacoda' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Lengauer</p>
    <p>Methods Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007504.r008" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007504.r008</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Jian Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jian Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj008" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007504" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">14 Jul 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01801R3 </p>
    <p>Bayesian modelling of high-throughput sequencing assays with malacoda</p>
    <p>Dear Dr Shaw,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
