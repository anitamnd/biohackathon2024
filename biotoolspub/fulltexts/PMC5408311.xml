<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5408311</article-id>
    <article-id pub-id-type="pmid">28319112</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.4227</article-id>
    <article-id pub-id-type="manuscript">nihpa855609</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate identification of single nucleotide variants in whole genome amplified single cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Xiao</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milholland</surname>
          <given-names>Brandon</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Moonsook</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maslov</surname>
          <given-names>Alexander Y.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vijg</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Genetics, Albert Einstein College of Medicine, Bronx, New York 10461, U.S.A</aff>
    <aff id="A2"><label>2</label>Department of Epidemiology &amp; Population Health, Albert Einstein College of Medicine, Bronx, New York 10461, U.S.A</aff>
    <aff id="A3"><label>3</label>Department of Ophthalmology &amp; Visual Sciences, Albert Einstein College of Medicine, Bronx, New York 10461, U.S.A</aff>
    <author-notes>
      <corresp id="FN1">Correspondence should be addressed to Jan Vijg (<email>jan.vijg@einstein.yu.edu</email>)</corresp>
      <fn id="FN2" fn-type="equal">
        <label>*</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>17</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <volume>14</volume>
    <issue>5</issue>
    <fpage>491</fpage>
    <lpage>493</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.4227-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Genome-wide, DNA mutation analysis in single cells is prone to artifacts associated with cell lysis and whole genome amplification. Here we addressed these issues by developing Single-Cell Multiple Displacement Amplification (SCMDA) and the single-cell variant caller, SCcaller. Validated by comparing SCMDA-amplified single cells with unamplified clones from the same population, the procedure provides a firm foundation for standardizing somatic mutation analysis in single-cell genomics.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P2">Analyzing genetic variants in single cells suffers from artifacts associated with whole genome amplification (WGA). Common artifacts result from cytosine deamination due to single cell lysis and DNA denaturation at elevated temperatures, resulting in artificial CG-&gt;TA transitions<sup><xref rid="R1" ref-type="bibr">1</xref></sup>. This could explain, for example, the great excess of such mutations found in single neurons<sup><xref rid="R2" ref-type="bibr">2</xref></sup> as compared to similar studies of unamplified neuronal clones<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. Amplification errors per se can be enriched through allelic amplification bias, a characteristic of multiple displacement amplification (MDA) - the most frequently used method for WGA from a single cell<sup><xref rid="R4" ref-type="bibr">4</xref></sup> - resulting in artifactual mutation calls (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1a,b</xref>). Here we report Single-Cell Multiple Displacement Amplification (SCMDA) and a single-cell variant caller (SCcaller), a validated protocol to accurately identify SNVs across the genome from a single cell after whole genome amplification.</p>
  <p id="P3">To address cytosine deamination artifacts, we single cell lysis and DNA denaturation is performed on ice using alkaline lysis. To compensate for the much lower effectiveness of cell lysis and DNA denaturation at low temperature we reconfigured MDA, significantly improving the annealing procedure for the hexamer primers (Methods). We then developed SCcaller, which corrects for local allelic amplification bias in SNV calling.</p>
  <p id="P4">We validated SCMDA and SCcaller by directly comparing SNVs between amplified single cells and unamplified clones derived from cells in the same population of early passage, human primary fibroblasts. We also sequenced SCMDA-amplified single cells and non-amplified clones derived from the same, early growing clone (~5 divisions; 20~30 single cells), reasoning that there should be significant overlap between the single cells and their kindred clone (<xref rid="F1" ref-type="fig">Fig 1a,b</xref>). Finally, we also included single cells after high-temperature lysis and DNA denaturation using a commercially available system (Methods) to confirm artifactual mutations induced through cytosine deamination at high temperature.</p>
  <p id="P5">Single cells, isolated using the CellRaft system (Methods, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2, 3</xref>) were subjected to SCMDA, library preparation and sequencing<sup><xref rid="R5" ref-type="bibr">5</xref></sup> (Methods, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1, 2</xref>). As a pre-screen to test for the relative uniformity of amplification we used real-time PCR at 8 specific loci and 66% of 44 cells passed our criteria (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>). Only cells from this group were sequenced. <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref> provides the sequencing statistics, showing that in the single cells on average 85% of the genome was sequenced with a depth of at least 5 reads, as compared to about 90% in the clones and bulk cell population. The genome-wide coverage uniformity of amplification after whole genome sequencing was evaluated using Lorenz plots (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). The results indicated that, as expected, the unamplified bulk DNA shows the least amount of bias; in addition, amplicon samples produced by SCMDA exhibited less bias than those produced by the commercial, high-temperature lysis system (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref>) or by other amplification protocols<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R7" ref-type="bibr">7</xref></sup>.</p>
  <p id="P6">For calling SNVs from the sequencing data, we first predicted the degree of local allelic amplification bias using heterozygous germline SNPs (hSNPs) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5a–c</xref>). Because MDA starts at random positions and elongates to several kilobases, it is possible to predict the degree of allelic bias at a particular locus by considering the degree of bias in neighboring hSNPs using kernel smoothing (Methods, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6 a–d</xref> &amp; <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref>). We designed SCcaller to adjust allelic amplification bias when estimating the likelihoods of three possibilities, i.e., artifact, heterozygous SNV, and homozygous SNV, for every candidate SNV locus (Methods, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref> &amp; <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8 a,b</xref>). A likelihood ratio test was used to distinguish real SNVs from artifacts under a certain significance level (α). Its null distribution, which corresponds to the amplification errors, was sampled from the input data. This input-specific null accounts for sample-specific amplification bias, sequencing depth and quality.</p>
  <p id="P7">We evaluated the accuracy of SCMDA and SCcaller using our kindred single cells and clone combination, because in this system real mutations should be present in both the single cells and the kindred clone (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). For germline SNP calling, SCcaller reached 90.1% sensitivity at a cost of 0.12 false positives (FPs) per million bp (<xref rid="F2" ref-type="fig">Fig. 2a,b</xref>). In comparison, Haplotypecaller from GATK<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, a commonly used SNP caller for bulk sequencing data, suffered from more than 7 times as many FPs, i.e., 0.87 FPs per million bp. SCcaller performed similarly on a published MDA-amplified single-cell data set from another laboratory<sup><xref rid="R2" ref-type="bibr">2</xref></sup> and significantly outperformed Haplotypecaller and Monovar<sup><xref rid="R9" ref-type="bibr">9</xref></sup> (<xref rid="F2" ref-type="fig">Fig. 2c</xref>; <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>).</p>
  <p id="P8">We then tested if SCcaller displayed the same unique feature of high specificity, i.e., a low rate of false positive calls, in identifying somatic SNVs using our kindred single cells and clone. We found that SCcaller has a much higher specificity (FDR: 0.308–0.393) than other callers, i.e., MuTect<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, VarScan<sup><xref rid="R11" ref-type="bibr">11</xref></sup> and Monovar<sup><xref rid="R9" ref-type="bibr">9</xref></sup> (FDR: 0.745–0.860), most likely by accounting for amplification errors (<xref rid="F2" ref-type="fig">Fig. 2d,e</xref>). Its sensitivity is either higher than that of the other callers (Monovar) or similar (MuTect and VarScan). Sixteen randomly picked SNVs called by SCcaller, were confirmed using Sanger sequencing of the kindred group versus bulk (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 5</xref>). Using another published single-cell data set obtained by MALBAC (Multiple Annealing and Looping-Based Amplification Cycles)<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, SCcaller reported more than two times higher overlapping somatic SNV calls in all kindred cells than Monovar, MuTect or VarScan (<xref rid="F2" ref-type="fig">Fig. 2f</xref>; <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Of note, the fraction of overlapping calls in this data set was very low (0.3%) as compared to what we obtained with SCMDA (65% on average), likely due to our highly optimized experimental protocol for somatic SNV detection. Hence, applied to different, independently published data sets SCcaller proved superior to other variant callers, including those specifically designed for single cell applications. Of note, SCcaller’s application is limited to genome regions of SNP heterozygosity (Methods).</p>
  <p id="P9">We then extended the somatic SNV detection by SCMDA and SCcaller from the kindred group to all our single cells and clones, comparing the results to those obtained using the commercial procedure with single cell lysis and denaturation at elevated temperature. As expected, in the latter case many more candidate somatic SNVs were detected than in those amplified using SCMDA: an average of 22,929 and 927 per cell, respectively, after adjusting for sequencing depth and coverage (<xref rid="F3" ref-type="fig">Fig. 3a</xref>). Almost all the somatic SNVs detected after high temperature denaturation were CG-&gt;TA transitions (<xref rid="F3" ref-type="fig">Fig. 3b</xref>), which is expected when they stem from cytosine deamination. The number of somatic SNVs identified using SCMDA, on average 927±371 (s.d.) per cell, was in the same range as the unamplified clones, on average 856±306 (s.d.) per cell. Of note, these results are also in the same range as previously reported for non-amplified single cell clones obtained through organoid formation (609 per organoid genome)<sup><xref rid="R12" ref-type="bibr">12</xref></sup>. The somatic SNVs identified using SCMDA had a very similar spectrum as the clones, with CG-&gt;TA mutations making up only 21.3% of all somatic SNVs (<xref rid="F3" ref-type="fig">Fig. 3b</xref>). Of note, the same spectra were obtained when using the other mutation callers (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 9</xref>). Hence, other callers detected artifacts rejected by SCcaller, but not specifically artifacts resulting from cytosine deamination. Hence, these combined results underscore the validity of SCMDA and SCcaller in providing both reliable mutation identification and reliable mutation spectra for whole genome-amplified single cells.</p>
  <p id="P10">The somatic SNVs identified in the human fibroblasts were distributed uniformly across the genome (<xref rid="F3" ref-type="fig">Fig. 3c</xref>), with a moderate depletion of mutations from functional sequence features, such as exons, DNase I hypersensitive sites and 3′ UTRs, similar to what was found for germline polymorphisms in the 1000 Genomes Project (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 10a</xref>). This is consistent with the presence, in actively proliferating fibroblasts, of considerable selection against deleterious mutations. Somatic SNVs were also depleted from genes expressed in human fibroblasts (<italic>P</italic>=0.016 one-tailed permutation test, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 10b</xref>), due to either selection or transcription coupled repair<sup><xref rid="R13" ref-type="bibr">13</xref></sup>.</p>
  <p id="P11">In summary, the validated single-cell whole genome sequencing procedure and variant caller developed allow for the first time to accurately determine the full complement of somatic mutations unique for a cell. This will greatly expand our capability to explore the landscapes of somatic mutagenesis in humans and other organisms, which hitherto was only possible by using clonal amplification, such as organoid technology. Clonal amplification requires extensive cell culture and essentially limits analysis to stem or progenitor cells. Single cell technology allows direct analysis of all types of cells, including postmitotic cells, such as neurons and muscle fibers. Of note, single cell clones are also likely to harbor mutations arising <italic>de novo</italic>. Indeed, each of the single cells in our kindred groups was found to harbor a unique set of mutations that are not necessarily artifacts. Hence, in contrast to organoid technology SCMDA provides a comprehensive assay to study the landscape of somatic mutagenesis in metazoa, including sub-clonal heterogeneity in both normal and tumor tissue. This will provide increased insight into the pathogenic role of somatic mutations in human aging and disease<sup><xref rid="R14" ref-type="bibr">14</xref></sup>.</p>
  <sec id="S1" specific-use="web-only">
    <title>Online Methods</title>
    <sec id="S2">
      <title>Cell culture</title>
      <p id="P12">Primary human dermal fibroblasts from a 6-year-old male were provided by Haeri Choi at Seoul National University, South Korea. Human dermal fibroblasts were grown at 37°C, 3% O<sub>2</sub>, 10% CO<sub>2</sub>, in low glucose DMEM medium containing 10% FBS, 100 IU ml<sup>−1</sup> penicillin, 100μg ml<sup>−1</sup> streptomycin, 2mM L-Glutamine and 1% MEM non-essential amino acids (Gibco).</p>
    </sec>
    <sec id="S3">
      <title>Preparing single cells</title>
      <p id="P13">We prepared single cells and clones using the CellRaft array (Cell Microsystems). Following the manufacturer’s instructions, we wetted the CellRaft array with medium before plating the cells. The CellRaft array was covered with a proprietary water-soluble biocompatible coating to prevent air bubble formation when adding liquid to the array. To wet the array, we added 2 ml of the cell culture medium to the array and waited for 3 minutes, then removed the medium; this process was repeated a total of three times.</p>
      <p id="P14">When cells grew to confluence in a 10-cm plate, we removed the medium, washed the cells with PBS, added 1 ml trypsin (Gibco) and incubated at 37°C for 5 minutes. After confirming that all cells were detached, we added 10 ml complete medium to stop trypsinization and transferred the cell solution to a 10-ml tube. Cells were centrifuged for 5 minutes at 1500 rpm. The supernatant was removed by aspiration and the cell pellet was resuspended in 10 ml fresh medium. This process was performed a total of two times to ensure the removal of cell debris prior to single cell isolation.</p>
      <p id="P15">The CellRaft array contains 12,000 individual sites, called “rafts”. To pick single cells, we counted cells with the Auto T4 Cellometer (Nexcelom Bioscience) and prepared about 5000 cells in 3 ml of medium. The cell solution was plated onto the CellRaft array and incubated at 37°C, 3% O<sub>2</sub>, 10% CO<sub>2</sub>. After 2–4 hours, the fibroblasts were elongated and firmly attached to the array. To remove floating cells (which were probably dead) and avoid contamination from potential cell debris and cell-free DNA in the medium, we removed the medium from the CellRaft array, washed the cells on the CellRaft array twice using 1 ml PBS and added 3 ml fresh complete media. Single rafts containing one cell (as observed by microscopy using a 10x objective, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref>) were transferred, using the magnetic wand supplied with the CellRaft system, into 0.2-ml PCR tubes containing 2.5 μl PBS. By observing the PCR tubes under a magnifying glass and the CellRaft array under a microscope before and after the transfer, we validated that there was only one cell in a tube (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref>). Tubes containing single rafts were frozen immediately on crushed dry ice and kept at −80°C until use. To validate that there was no contamination from cell-free DNA, we also picked empty rafts as negative controls in whole genome amplification (described in the section on SCMDA).</p>
    </sec>
    <sec id="S4">
      <title>Single cell clone and kindred cells</title>
      <p id="P16">To generate single cell clones, we used a modified version of the cloning protocol described previously<sup><xref rid="R15" ref-type="bibr">15</xref></sup>. Cells were first plated on the CellRaft array as described above. We kept track of rafts containing single cells using the coordinate markers on the CellRaft. Culturing conditions were the same as described in the cell culture section above, except that the FBS content of the medium was increased from 10% to 20%. Cells were checked for growth daily and medium changed every three days. When the single cell clones reached confluence on the raft, i.e. approximately 10–16 cells per raft, each single raft containing a clone was transferred to a well in a 96-well plate. Upon reaching confluence, the clones were transferred to 24-well plates, then 12-well plates, 6-well plates and 10-cm plates; medium containing 20% FBS was used until the cells were transferred to 12-well plates, at which point FBS supplementation was reduced to 10%.</p>
      <p id="P17">To generate kindred single cells and clone, we first grew cells to small clones, consisting of approximately 20–30 cells, after transfer to a 96-well plate. We then selected a clone and transferred all of its cells to another CellRaft array. Fifteen kindred cells were isolated from the small clone using the CellRaft system. The remaining cells from the clone were transferred into a well of 96-well plate and grown into a large clone as described above. We sequenced the unamplified DNA from the large clone and the amplified DNA of two of the cells isolated from the 20–30-cell stage clone.</p>
    </sec>
    <sec id="S5">
      <title>Single cell whole genome amplification by multiple displacement amplification, (SCMDA)</title>
      <p id="P18">Frozen single cells in PCR tubes were removed from storage at −80°C, quickly spun down by nano-centrifuge, and placed on ice. One μl Exo-Resistant Random Primer (final conc. 12 μM, Thermo Scientific) was then added, followed by 3 μl lysis buffer containing 400mM KOH, 100mM DTT and 10mM EDTA solution. Cell lysis and DNA denaturation was performed on ice for 10 minutes. Then, 3 μl of stop buffer, consisting of 400mM HCl and 600mM Tris-HCl solution (1M, pH7.5), was added to neutralize the lysis buffer, followed by 32 μl of master mix containing 30 μl of MDA reaction buffer and 2 μl of Phi29 polymerase (REPLI-g UltraFast Mini Kit, Qiagen). MDA was carried out in a total volume of 41.5 μl for 1.5 hours at 30°C, followed by an increase in the temperature to 65°C for 3 minutes to inactivate DNA polymerase. After amplification, samples were held at 4°C until purification. Amplified DNA was purified using AMPureXP-beads (Beckman Coulter) and the concentration was measured with the Qubit High Sensitivity dsDNA Kit (Invitrogen Life Science).</p>
      <p id="P19">As a positive control for the amplification, 1 ng of human genomic DNA in 2.5 μl PBS was also amplified and 2.5 μl of PBS without any template as a negative control. Meanwhile, empty rafts isolated from the CellRaft array were amplified and compared to the controls and single cells to exclude the possibility of contamination by cell-free DNA.</p>
      <p id="P20">High temperature single cell MDA (HighTemp MDA) was done using the REPLI-g Single Cell Kit (Qiagen). The key difference in the single cell lysis between this procedure and SCMDA is the temperature, i.e., 65°C for the HighTemp method and on ice for SCMDA. The low temperature used by the SCMDA method avoids heat-induced errors in DNA denaturation, mainly cytosine deamination (CG-&gt;TA) (<xref rid="F3" ref-type="fig">Fig. 3b</xref>).</p>
      <p id="P21">Unamplified DNA was extracted from clones using the Quick-gDNA Blood Miniprep Kit (ZYMO Research) and from bulk cell cultures using DNeasy Blood &amp; Tissue Kit (Qiagen).</p>
    </sec>
    <sec id="S6">
      <title>Library construction and whole genome sequencing</title>
      <p id="P22">PCR-free libraries were prepared using the Accel-NGS 2S DNA Library Kit (Swift Biosciences). Briefly, 2 μg input DNA was fragmented using Covaris, size-selected and purified using the MinElute Gel Extraction Kit (Qiagen). PCR-free libraries of the DNA from bulk cell populations was prepared using the KAPA LTP Library Preparation Kit (KAPA Biosystems) with Trueseq adapters (Illumina) by the Epigenomics Core at the Albert Einstein College of Medicine. For 3 of the 4 single cell clones (C1, C2 and C3), libraries were prepared by the New York Genome Center (New York, NY). The libraries were sequenced on the Illumina HiSeq 2500, with 2×100 bp or 2×250 bp paired-end reads by the Epigenomics Core at Albert Einstein College of Medicine or the Illumina HiSeq X Ten with 2×150 bp paired-end reads by the New York Genome Center (New York, NY) (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>).</p>
    </sec>
    <sec id="S7">
      <title>Sequence alignment</title>
      <p id="P23">Raw sequence reads were adapter and quality trimmed using Trim Galore (version 0.3.7), and aligned to human reference genome build 37 using BWA MEM (version 0.7.10)<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. After deduplication, the initial mapped reads were indel realigned based on known indels from the 1000 Genomes Project (Phase I)<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, and base quality score recalibrated based on known indels from the 1000 Genomes Project (Phase I) and SNVs from dbSNP (build 144) using GATK (version 3.4.46)<sup><xref rid="R8" ref-type="bibr">8</xref></sup>.</p>
    </sec>
    <sec id="S8">
      <title>SCcaller: estimating allelic bias</title>
      <p id="P24">We used the Nadaraya-Watson kernel-weighted average to estimate the fraction of reads carrying the genotype with more supporting reads (i.e. the major allele fraction, denoted as <italic>θ</italic>) as a result of allelic bias at genome position <italic>x<sub>0</sub></italic>,</p>
      <p id="P25"><disp-formula id="FD1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>i</italic> denotes heterozygote germline SNPs (hSNPs) from the single cell. We implemented a module in SCcaller to query these hSNPs from a single cell comparing to either a database, e.g. dbSNP, or, preferably, hSNPs called from the bulk cell population. Of note, this list of hSNPs does not have to be precise because bias estimation is a robust procedure and hSNPs are re-called and confirmed together with all the other SNVs in the variant calling step. <italic>λ</italic> denotes half of the window width for smoothing. We recommend <italic>λ</italic>=10,000 for MDA-based protocols, which balances prediction accuracy and coverage. The kernel <italic>K</italic> is defined using the Epanechnikov quadratic kernel,</p>
      <p id="P26"><disp-formula id="FD2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mspace width="0.16667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> in which function <italic>D</italic> is defined as,</p>
      <p id="P27"><disp-formula id="FD3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16667em"/><mml:mo>∣</mml:mo><mml:mi>t</mml:mi><mml:mo>∣</mml:mo><mml:mspace width="0.16667em"/><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="italic">otherwise</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula> in <italic>D</italic>(<italic>t</italic>), <italic>t</italic> refers to the argument of the function <italic>D</italic>.</p>
      <p id="P28">To test the accuracy of the prediction, we performed <italic>leave-100-out</italic> cross-validations and 10-fold cross-validations on hSNPs from a randomly selected region chr1:100,000,000–110,000,000. In the <italic>leave-100-out</italic> cross-validations we randomly partitioned the hSNPs into subgroups, each with 100 hSNPs. For each subgroup, we predicted the bias of the 100 hSNPs using hSNPs from the other subgroups. In the 10-fold cross-validations, we randomly partitioned the hSNPs into 10 subgroups with equal numbers of hSNPs. For each subgroup, we predicted the bias of the hSNPs using hSNPs from the other 9 subgroups. The strong correlation between prediction and observation (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6</xref> and <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref>) indicates high accuracy of the bias estimation.</p>
    </sec>
    <sec id="S9">
      <title>SCcaller: variant calling</title>
      <p id="P29">Let “ref” denote the reference allele and “alt” denote the alternative allele. To call the genotype for a single cell, we evaluated the data for a given candidate SNV using three models: (i) model <italic>H<sub>0</sub></italic>: genotype ref/ref - no variant is present at the site and all alternative bases are a result of amplification errors; (ii) model <italic>H<sub>1</sub></italic>: genotype ref/alt - a heterozygous SNV; (iii) model <italic>H<sub>2</sub></italic>: genotype alt/alt - a homozygous SNV. We also took sequencing errors (Phred quality score) into account. Assuming that sequencing errors are independent across reads, we calculated the likelihood of each model using</p>
      <p id="P30"><disp-formula id="FD4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∏</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>j</italic> denotes a read covering the site, <italic>b</italic> denotes the called bases, <italic>e</italic> denotes error rate transformed from the Phred quality score, <italic>r</italic> ∈ {A,C,G,T} denotes the reference genotype, and <italic>m</italic> ∈ {A,C,G,T} denotes the alternative genotype in the data. And <italic>F<sub>k</sub></italic> is defined as</p>
      <disp-formula id="FD5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mi>F</mml:mi>
              <mml:mi>k</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>θ</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mi>θ</mml:mi>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>f</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:msub>
                        <mml:mi>H</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mn>1</mml:mn>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>f</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:msub>
                        <mml:mi>H</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p id="P31">For H<sub>1</sub> and H<sub>2</sub>, let the estimated variant allele fraction <italic>f</italic> be,</p>
      <disp-formula id="FD6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>f</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>θ</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>f</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">observing</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">more</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">variant</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">reads</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>θ</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>f</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">observing</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">more</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">reference</mml:mi>
                      <mml:mspace width="0.16667em"/>
                      <mml:mi mathvariant="italic">reads</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p id="P32">Following Cibulskis et al<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, we assumed each type of substitution error in sequencing has an equal probability of occurring, <italic>e/3</italic>: 
<disp-formula id="FD7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16667em"/><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16667em"/><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p id="P33">In H<sub>0</sub>, to account for amplification errors, we set,</p>
      <disp-formula id="FD8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>f</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mstyle displaystyle="false">
              <mml:mfrac bevelled="true">
                <mml:mn>1</mml:mn>
                <mml:mn>8</mml:mn>
              </mml:mfrac>
            </mml:mstyle>
            <mml:mo>×</mml:mo>
            <mml:mi>θ</mml:mi>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p id="P34">This is because with a diploid genome, there are a total of 4 DNA strands in a cell. Errors that occur at the first round of amplification, which are the artifacts most difficult to filter out, will ideally be found in 1/8 of the reads (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1</xref>).</p>
      <p id="P35">We further estimated a null distribution of artifacts using depth and quality from single cell sequencing data itself, and selected criteria η, corresponding to certain α values (0.01 and 0.05 are both reported). This procedure is based on a likelihood ratio test that rejects H<sub>0</sub> in favor of H<sub>1</sub> when,</p>
      <p id="P36"><disp-formula id="FD9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:math></disp-formula> where,</p>
      <disp-formula id="FD10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi mathvariant="normal">Λ</mml:mi>
            <mml:mo>≤</mml:mo>
            <mml:mi>η</mml:mi>
            <mml:mo>∣</mml:mo>
            <mml:msub>
              <mml:mi>H</mml:mi>
              <mml:mn>0</mml:mn>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi mathvariant="normal">α</mml:mi>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p id="P37">In addition, we also designed the SCcaller to calculate the likelihoods of sequencing errors following Cibulskis et al<sup><xref rid="R10" ref-type="bibr">10</xref></sup>.</p>
    </sec>
    <sec id="S10">
      <title>SCcaller: application</title>
      <p id="P38">SCcaller (v1.0) was used for calling SNVs as follows. The bam file of a single cell was mpileuped for each autosome separately using samtools (v1.3, options -C50 -r chr -Osf referencegenome.fa). To estimate allelic bias in the amplification, hSNPs in the single cell were identified by querying dbSNP (build 144) using option -a hsnp of SCcaller. Next, using option -a varcall in SCcaller, likelihoods of the three models described in the previous section were calculated for all positions in the genome covered by ≥1 reads that differ from the reference genome. Then, using option -a cutoff in SCcaller, <italic>η</italic> corresponding to α=0.01 was estimated. This cutoff was used to separate real SNVs from amplification artifacts. In addition, SNVs overlapping with indel reads were filtered out. Finally, we queried all SNVs identified in the whole genome sequence of the bulk cell population. SNVs without variant supporting reads, do not overlap with indel reads and have ≥20 wild type reads in the bulk, without overlap with dbSNP, are considered as somatic SNVs.</p>
    </sec>
    <sec id="S11">
      <title>Potential caveats in using SCcaller</title>
      <p id="P39">Of note, there are areas of the genome in which SCcaller cannot overcome amplification bias. Those regions include all areas that are haploid, such as the Y chromosome and the X chromosome in males, and other haploid regions, as well as amplified regions. Of note, the amplification products of MDA are generally long, i.e., typically over 10 kb, and not many artifacts will be missed. In the SCcaller, we implemented parameters for lengths of neighboring regions, which can also be specified by the user. With a default setting of 10 kb on both sides of the SNV, 90.5% of total candidate variants (approximately 90% of genomic regions) is covered. Bias of uncovered regions is by default set to the genome wide average (θ=0.75) and can also be specified by the user.</p>
    </sec>
    <sec id="S12">
      <title>Statistical analysis</title>
      <p id="P40">Statistic tests, such as permutations and t tests, were performed using R (version 3.3.2) and Microsoft Office Excel (2013) respectively. Statistics of SCcaller are described above and coded in Python (version 2.7).</p>
    </sec>
    <sec id="S13">
      <title>Public single cell data</title>
      <p id="P41">Single cell sequencing data from MDA-amplified (previous MDA method) neurons (Brain A)<sup><xref rid="R2" ref-type="bibr">2</xref></sup> and MALBAC-amplified cancer cells<sup><xref rid="R7" ref-type="bibr">7</xref></sup> were downloaded from SRA databases under accession numbers, SRR2141560 to SRR2141570 (previous MDA, 10 single neurons and 1 bulk), SRX204116, SRX202787, SRX202978 and SRX204744 (MALBAC, 3 kindred single cells and 1 bulk). Analysis and variant calling were as described for our SCMDA and HighTemp MDA datasets.</p>
    </sec>
    <sec id="S14">
      <title>Code availability</title>
      <p id="P42">SCcaller is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/biosinodx/SCcaller">https://github.com/biosinodx/SCcaller</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S15">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS855609-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d36e1366" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS855609-supplement-2.doc" orientation="portrait" xlink:type="simple" id="d36e1370" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>3</label>
      <media xlink:href="NIHMS855609-supplement-3.pdf" orientation="portrait" xlink:type="simple" id="d36e1374" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>4</label>
      <media xlink:href="NIHMS855609-supplement-4.zip" orientation="portrait" xlink:type="simple" id="d36e1378" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S16">
    <p>This research was supported by NIH (grants AG017242, AG047200, and AG038072 to J.V.) and the Glenn Foundation for Medical Research (J.V.).</p>
  </ack>
  <fn-group>
    <fn id="FN3">
      <p>
        <bold>Accession Codes</bold>
      </p>
      <p>Primary accessions: Sequence Read Archive SRP067062.</p>
    </fn>
    <fn id="FN4">
      <p>
        <bold>Data Availability Statement</bold>
      </p>
      <p>All sequencing data are available from the NCBI Sequence Read Archive under accession number SRP067062.</p>
    </fn>
    <fn id="FN5" fn-type="con">
      <p>
        <bold>Author contributions</bold>
      </p>
      <p>J.V., L.Z., and X.D. conceived this study and designed the experiments. L.Z., B.M. and M.L. performed the experiments. X.D. developed the software. X.D. and T.W. analyzed the data. J.V., X.D., L.Z., B.M. T.W. and A.M. wrote the manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN6">
      <p>
        <bold>Competing financial interests</bold>
      </p>
      <p>X.D., L.Z., M.L., A.M. and J.V. are co-founders of SingulOmics Corp.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fryxell</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Zuckerkandl</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Cytosine deamination plays a primary role in the evolution of mammalian isochores</article-title>
        <source>Molecular biology and evolution</source>
        <volume>17</volume>
        <fpage>1371</fpage>
        <lpage>1383</lpage>
        <year>2000</year>
        <pub-id pub-id-type="pmid">10958853</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lodato</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutation in single human neurons tracks developmental and transcriptional history</article-title>
        <source>Science (New York, NY)</source>
        <volume>350</volume>
        <fpage>94</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aab1785</pub-id>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hazen</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Complete Genome Sequences, Unique Mutational Spectra, and Developmental Potency of Adult Neurons Revealed by Cloning</article-title>
        <source>Neuron</source>
        <volume>89</volume>
        <fpage>1223</fpage>
        <lpage>1236</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2016.02.004</pub-id>
        <year>2016</year>
        <pub-id pub-id-type="pmid">26948891</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lasken</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Genomic DNA amplification by the multiple displacement amplification (MDA) method</article-title>
        <source>Biochemical Society transactions</source>
        <volume>37</volume>
        <fpage>450</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1042/bst0370450</pub-id>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19290880</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gundry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Maqbool</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Vijg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Direct, genome-wide assessment of DNA mutations in single cells</article-title>
        <source>Nucleic acids research</source>
        <volume>40</volume>
        <fpage>2032</fpage>
        <lpage>2040</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr949</pub-id>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22086961</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Uniform and accurate single-cell sequencing based on emulsion whole-genome amplification</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <volume>112</volume>
        <fpage>11923</fpage>
        <lpage>11928</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1513988112</pub-id>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26340991</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide detection of single-nucleotide and copy-number variations of a single human cell</article-title>
        <source>Science (New York, NY)</source>
        <volume>338</volume>
        <fpage>1622</fpage>
        <lpage>1626</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1229164</pub-id>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome research</source>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Monovar: single-nucleotide variant detection in single cells</article-title>
        <source>Nature methods</source>
        <volume>13</volume>
        <fpage>505</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3835</pub-id>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27088313</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title>
        <source>Nature biotechnology</source>
        <volume>31</volume>
        <fpage>213</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2514</pub-id>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>
        <source>Genome research</source>
        <volume>22</volume>
        <fpage>568</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behjati</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome sequencing of normal cells reveals developmental lineages and mutational processes</article-title>
        <source>Nature</source>
        <volume>513</volume>
        <fpage>422</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13448</pub-id>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25043003</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanawalt</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Spivak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Transcription-coupled DNA repair: two decades of progress and surprises</article-title>
        <source>Nature reviews. Molecular cell biology</source>
        <volume>9</volume>
        <fpage>958</fpage>
        <lpage>970</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm2549</pub-id>
        <year>2008</year>
        <pub-id pub-id-type="pmid">19023283</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gundry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vijg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Direct mutation analysis by high-throughput sequencing: from germline to low-abundant, somatic variants</article-title>
        <source>Mutation research</source>
        <volume>729</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/mrfmmm.2011.10.001</pub-id>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22016070</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falanga</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human dermal fibroblast clones derived from single cells are heterogeneous in the production of mRNAs for alpha 1(I) procollagen and transforming growth factor-beta 1</article-title>
        <source>The Journal of investigative dermatology</source>
        <volume>105</volume>
        <fpage>27</fpage>
        <lpage>31</lpage>
        <year>1995</year>
        <pub-id pub-id-type="pmid">7615971</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>
        <source>Nature</source>
        <volume>491</volume>
        <fpage>56</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11632</pub-id>
        <year>2012</year>
        <pub-id pub-id-type="pmid">23128226</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Experimental design for validating SNV identification in SCMDA-amplified single cells</title>
      <p>(<bold>a</bold>) To allow validation for accurate single cell amplification and variant calling, whole genome sequencing (WGS) was performed on (1) four single cells amplified using SCMDA (red); (2) two cells amplified using SCMDA and their non-amplified kindred clone (yellow); (3) three additional, unamplified clones (blue); and (4) two single cells amplified after high temperature lysis (grey). Cell / clone IDs are included in the Figure. (<bold>b</bold>) The kindred cells and clone are expected to have identical genotypes, including both germline and somatic SNVs. Candidate SNVs identified in both clone and single cells are true positives (TPs). Those found in neither of the cells but only in the clone are false negatives (FNs). Variants found only in one cell are considered false positives (FPs). See <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref> for details. These are conservative assumptions and do not take into account possible <italic>de novo</italic> mutations in the kindred clone or single cells arising after their divergence. Of note, such events would increase sensitivity and specificity.</p>
    </caption>
    <graphic xlink:href="nihms855609f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Accuracy of SCcaller in single cell SNV calling</title>
      <p>Sensitivity and FP rate of germline SNP calling in cell IL11 (<bold>a</bold>) and IL12 (<bold>b</bold>). Sensitivity (y-axis) was defined as the ratio of TPs to FNs plus TPs. FP rate per MB on the x-axis is the number of FPs per million bp. Default cutoff (x) refers to α=0.01 by SCcaller. (<bold>c</bold>) Germline SNP calling using SCcaller was compared with Monovar and Haplotypecaller in a dataset from Lodato et al.<sup><xref rid="R2" ref-type="bibr">2</xref></sup>. On the x-axis, the number of artifacts was approximated as the number of SNVs unique to one cell (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). Since these unique SNVs also include real somatic SNVs, this approximation is the upper-bound of the number of artifacts. SCcaller suffered from the smallest number of false positives (&lt;1,000 per cell), as compared to Haplotypecaller (&gt;30,000 per cell) and Monovar (&gt;5,000 per cell). For somatic SNV calling, SCcaller was compared with MuTect, VarScan and Monovar in cell IL11 (<bold>d</bold>) and IL12 (<bold>e</bold>). FDR was defined as the ratio of FPs to TPs plus FPs. TPs and FPs were derived from the kindred clone experiment (<xref rid="F1" ref-type="fig">Fig. 1b</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). (<bold>f</bold>) Fraction of overlapping somatic SNVs called from MALBAC kindred single cells (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>)<sup><xref rid="R7" ref-type="bibr">7</xref></sup>. SNPs and SNVs were called in regions with ≥20 sequencing depth. The error bars indicate standard deviations.</p>
    </caption>
    <graphic xlink:href="nihms855609f2"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>Frequency, spectrum and distribution of somatic SNVs</title>
      <p>(<bold>a</bold>) Number of somatic SNVs per cell after correction for sequence depth and coverage (<xref rid="SD3" ref-type="supplementary-material">Supplementary Note</xref>). (<bold>b</bold>) Spectrum of somatic SNVs. In a) and b), the error bars indicate standard deviations, and n=4, 6 and 2 for the clones, SCMDA and HighTemp MDA respectively. (<bold>c</bold>) Genome distribution of somatic SNVs identified. Each row indicates one single cell or clone and each dot represents a somatic SNV. Smaller numbers of somatic SNVs were identified in IL4 and IL5 due to lower sequencing depth (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref>).</p>
    </caption>
    <graphic xlink:href="nihms855609f3"/>
  </fig>
</floats-group>
