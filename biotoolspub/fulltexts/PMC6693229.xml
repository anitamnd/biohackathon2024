<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6693229</article-id>
    <article-id pub-id-type="publisher-id">3017</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3017-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Guide for library design and bias correction for large-scale transcriptome studies using highly multiplexed RNAseq methods</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7581-5157</contrib-id>
        <name>
          <surname>Katayama</surname>
          <given-names>Shintaro</given-names>
        </name>
        <address>
          <email>shintaro.katayama@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Skoog</surname>
          <given-names>Tiina</given-names>
        </name>
        <address>
          <email>tiina.skoog@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Söderhäll</surname>
          <given-names>Cilla</given-names>
        </name>
        <address>
          <email>cilla.soderhall@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Einarsdottir</surname>
          <given-names>Elisabet</given-names>
        </name>
        <address>
          <email>elisabet.einarsdottir@scilifelab.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krjutškov</surname>
          <given-names>Kaarel</given-names>
        </name>
        <address>
          <email>kaarel.krjutshkov@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kere</surname>
          <given-names>Juha</given-names>
        </name>
        <address>
          <email>juha.kere@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0626</institution-id><institution-id institution-id-type="GRID">grid.4714.6</institution-id><institution>Department of Biosciences and Nutrition, </institution><institution>Karolinska Institutet, </institution></institution-wrap>14183 Huddinge, Sweden </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0626</institution-id><institution-id institution-id-type="GRID">grid.4714.6</institution-id><institution>Department of Women’s and Children’s Health, </institution><institution>Karolinska Institutet, </institution></institution-wrap>17177 Stockholm, Sweden </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0410 2071</institution-id><institution-id institution-id-type="GRID">grid.7737.4</institution-id><institution>Folkhälsan Institute of Genetics, and Molecular Neurology Research Program, </institution><institution>University of Helsinki, </institution></institution-wrap>00014 Helsinki, Finland </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.487355.8</institution-id><institution>Competence Centre on Health Technologies, </institution></institution-wrap>50410 Tartu, Estonia </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2322 6764</institution-id><institution-id institution-id-type="GRID">grid.13097.3c</institution-id><institution>School of Basic and Medical Biosciences, </institution><institution>King’s College London, Guy’s Hospital, </institution></institution-wrap>London, SE1 9RT UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>418</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Standard RNAseq methods using bulk RNA and recent single-cell RNAseq methods use DNA barcodes to identify samples and cells, and the barcoded cDNAs are pooled into a library pool before high throughput sequencing. In cases of single-cell and low-input RNAseq methods, the library is further amplified by PCR after the pooling. Preparation of hundreds or more samples for a large study often requires multiple library pools. However, sometimes correlation between expression profiles among the libraries is low and batch effect biases make integration of data between library pools difficult.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We investigated 166 technical replicates in 14 RNAseq libraries made using the STRT method. The patterns of the library biases differed by genes, and uneven library yields were associated with library biases. The former bias was corrected using the NBGLM-LBC algorithm, which we present in the current study. The latter bias could not be corrected directly, but could be solved by omitting libraries with particularly low yields. A simulation experiment suggested that the library bias correction using NBGLM-LBC requires a consistent sample layout. The NBGLM-LBC correction method was applied to an expression profile for a cohort study of childhood acute respiratory illness, and the library biases were resolved.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The R source code for the library bias correction named NBGLM-LBC is available at <ext-link ext-link-type="uri" xlink:href="https://shka.github.io/NBGLM-LBC">https://shka.github.io/NBGLM-LBC</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://shka.bitbucket.io/NBGLM-LBC">https://shka.bitbucket.io/NBGLM-LBC</ext-link>. This method is applicable to correct the library biases in various studies that use highly multiplexed sequencing-based profiling methods with a consistent sample layout with samples to be compared (e.g., “cases” and “controls”) equally distributed in each library.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-3017-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Gene expression</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Transcriptome</kwd>
      <kwd>Library bias correction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004047</institution-id>
            <institution>Karolinska Institutet</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2013fobi38282</award-id>
        <award-id>2014fobi41753</award-id>
        <award-id>2016fobi50455</award-id>
        <principal-award-recipient>
          <name>
            <surname>Katayama</surname>
            <given-names>Shintaro</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>FP7</institution>
        </funding-source>
        <award-id>309329</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kere</surname>
            <given-names>Juha</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KAW2015.0096</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kere</surname>
            <given-names>Juha</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">RNA sequencing (RNAseq) utilizing next generation sequencers has allowed for rapid and comprehensive expression profiling. Due to the reduction of required RNA amount and increasing multiplexity in RNAseq libraries, RNAseq is increasingly used also for large-scale cohort studies based on bulk tissues, as well as tissue complexity studies even at the single-cell scale. However, large-scale studies often require sample processing as multiple libraries, resulting in the risk of batch effect bias. As an example, using our published RNAseq protocol [<xref ref-type="bibr" rid="CR1">1</xref>], we include up to 48 samples in one library using barcode sequences for multiplexing, processing typically up to four libraries in 3 days, and larger studies often require even more libraries. After sequencing and preprocessing, we sometimes observe a library bias – for example, reference samples in two different libraries may cluster apart by the libraries. Similar issues, especially in studies using single-cell RNAseq methods [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>], have been recently reported. Therefore, further investigation of the sources of library bias, development of correction methods, and guidelines for a bias-tolerant experiment design are required. In this report, we investigated library biases using 166 technical replicates distributed over 14 libraries. We developed a bias correction method named NBGLM-LBC, and suggest library design guidelines, applicable to many large-scale RNAseq studies.</p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Preparation of reference RNAs</title>
      <p id="Par9">The present study was based on reference samples in two projects: one performed with BEAS-2B cells, a human bronchial epithelial cell line, and the other with THP-1 cells, a human monocytic cell line. The cells were obtained from the American Type Culture Collection. For RNA extraction, 0.5 × 10<sup>6</sup> BEAS-2B cells or 1.0 × 10<sup>6</sup> THP-1 cells were seeded on 12-well plates 48 h/24 h before extraction, respectively. The cells were washed twice with ice-cold Phosphate Buffered Saline (PBS) and lysed with 350 μl of Buffer RLT Plus supplemented with β-mercaptoethanol (AllPrep DNA/RNA/miRNA Universal Kit, Qiagen, Hilden, Germany). The lysates were homogenized and the total RNA was extracted according to manufacturer’s instructions. The quality and quantity of the total RNA samples were checked by NanoDrop (ThermoFisher, Carlsbad, CA) and Qubit (ThermoFisher) instruments. RNA integrity was measured by Bioanalyzer with an Agilent RNA 6000 Nano kit (Agilent Technologies, Santa Clara, CA). The RNA samples were used for sequencing by single-cell tagged reverse transcription (STRT) RNAseq method.</p>
    </sec>
    <sec id="Sec4">
      <title>Preparation and sequencing of STRT libraries</title>
      <p id="Par10">High-quality RNA samples were diluted to 10 ng/μl based on Qubit fluorometer (ThermoFisher) measurements. Illumina-compatible RNA-seq libraries were prepared according to our published STRT protocol [<xref ref-type="bibr" rid="CR1">1</xref>] using 10 PCR cycles. The ready library QC was performed by TapeStation DNA HS1000 assay (Agilent Technologies) and quantified by qPCR-based KAPA Library Quantification Kit (KK4835, KAPA Biosystems, Cape Town, South Africa). Sequencing was performed using Illumina’s HiSeq 2000 instrument (Illumina, San Diego, CA) according to [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Preprocessing of STRT sequencing results</title>
      <p id="Par11">The sequenced STRT raw reads were processed by STRTprep [<xref ref-type="bibr" rid="CR1">1</xref>], v3dev branch b866538 commit at <ext-link ext-link-type="uri" xlink:href="https://github.com/shka/STRTprep/tree/v3dev">https://github.com/shka/STRTprep/tree/v3dev</ext-link>. In brief, the reads were demultiplexed by the barcode sequences, and the best quality reads among redundant reads were selected. The nonredundant reads were aligned to hg19 human reference genome sequences, ERCC spike-in sequences and human ribosomal DNA unit (GenBank: U13369) with RefSeq [<xref ref-type="bibr" rid="CR5">5</xref>] transcript alignments as a guide of exon junctions, by TopHat2 [<xref ref-type="bibr" rid="CR6">6</xref>] with bowtie1 [<xref ref-type="bibr" rid="CR7">7</xref>]. Uniquely mapped reads within (i) the 5′-UTR or the proximal upstream (up to 500 bp) of the RefSeq protein coding genes, and (ii) within the first 50 bp of spike-in sequences, were counted.</p>
    </sec>
    <sec id="Sec6">
      <title>Statistics and figures</title>
      <p id="Par12">All statistics and figures were performed in R (version 3.5.1 on macOS 10.13), and the core source code is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Spike-in normalization was based on the sum of spike-in reads as in [<xref ref-type="bibr" rid="CR8">8</xref>]. Quantile normalization [<xref ref-type="bibr" rid="CR9">9</xref>] via the preprocessCore package at <ext-link ext-link-type="uri" xlink:href="https://github.com/bmbolstad/preprocessCore">https://github.com/bmbolstad/preprocessCore</ext-link> and VST normalization [<xref ref-type="bibr" rid="CR10">10</xref>] were done after adding 1 to all reads to avoid log<sub>2</sub>(0). The sum of all counts per sample was used as the mapped depth for RPM normalization [<xref ref-type="bibr" rid="CR11">11</xref>]. Half of the minimum expression level was added to all before log<sub>2</sub> transformation for spike-in and RPM normalized levels, to avoid log<sub>2</sub>(0). Hierarchical clustering of the Spearman correlation matrix and the corresponding plots were made using a heatmap function in the NMF package [<xref ref-type="bibr" rid="CR12">12</xref>]; non-log normalized levels with zero-expression masking (by NA) were applied for calculation of the Spearman correlation matrix. Principal component analysis (PCA) and the corresponding plots were produced using the factoextra package at <ext-link ext-link-type="uri" xlink:href="http://www.sthda.com/english/rpkgs/factoextra">http://www.sthda.com/english/rpkgs/factoextra</ext-link>; log<sub>2</sub> normalized levels were applied. Genes with biological variation (fluctuated genes) in the GEWAC dataset had a significantly higher gene-to-spike-in ratio in the squared coefficient of variation, described in Supplementary Text S1 of [<xref ref-type="bibr" rid="CR1">1</xref>]; for the definition of fluctuated genes, see [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Implementation</title>
      <p id="Par13">NBGLM-LBC is developed for correction of library bias in large-scale RNAseq experiments. It is implemented in R, and requires the “MASS” and “parallel” core packages. The source code and documentation are available at <ext-link ext-link-type="uri" xlink:href="https://shka.github.io/NBGLM-LBC">https://shka.github.io/NBGLM-LBC</ext-link> under the MIT license; the site is mirrored at <ext-link ext-link-type="uri" xlink:href="https://shka.bitbucket.io/NBGLM-LBC">https://shka.bitbucket.io/NBGLM-LBC</ext-link>. A read count matrix before normalization (rows are genes, and columns are samples), a vector of sequencing depths, and a factor of libraries are given for the function named “library_bias_correction”. Optionally, multiple CPU cores can be allocated, to speed up the analysis. NBGLM-LBC estimates regression lines between the raw read count and the sequencing depths per library in each gene based on the negative binomial distribution, and then corrects the library biases by making intercepts of the regression lines equivalent based on the assumption that average levels per library are equivalent between libraries; the statistical background of this implementation is explained in the Results section. The output is a corrected count matrix. After the correction, another traditional normalization method will be required for the downstream analysis.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Definition and investigation of library bias</title>
      <p id="Par14">The present study was based on reference samples in two projects: one performed with BEAS-2B cells, a human bronchial epithelial cell line, and the other with THP-1 cells, a human monocytic cell line. We used STRT RNAseq [<xref ref-type="bibr" rid="CR1">1</xref>] for both projects, using 10 ng of total RNA per sample. A reference sample (total RNA from one aliquot of untreated BEAS-2B and THP-1 cells, respectively) for each project was put into 99 wells over eight STRT libraries for BEAS-2B, and 67 wells over six libraries for THP-1 as technical replicates (out of 360 and 271 samples, respectively; Additional file <xref rid="MOESM2" ref-type="media">2</xref>); there were samples with specific treatments and their controls in the other wells. As with most highly multiplexed RNAseq methods, these samples were barcoded and amplified per sample, followed by pooling and amplification per library. In one experiment, a maximum of four parallel libraries were made by the same experienced laboratory engineer, and all libraries were sequenced to the same depth, three Illumina HiSeq 2000 lanes per library (Table <xref rid="Tab1" ref-type="table">1</xref>). After preprocessing to deconvolute the samples to raw sequences, there were at least one million total reads for all the replicates, and there was no significant RNA degradation in any sample (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). The processed raw reads (Additional files <xref rid="MOESM3" ref-type="media">3</xref> and <xref rid="MOESM4" ref-type="media">4</xref>) were used for the downstream analysis.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The history of library preparation and sequencing for investigation of the library biases</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Library</th><th colspan="3">Library synthesis (date)</th><th colspan="4">Sequencing (flowcell:lane)</th></tr><tr><th>Project</th><th>ID</th><th>RNA into capture plate</th><th>Started</th><th>Finished</th><th>Quantity (nM)</th><th>1st</th><th>2nd</th><th>3rd</th></tr></thead><tbody><tr><td>BEAS</td><td>a</td><td>2015/12/30</td><td>2016/01/04</td><td>2016/01/07</td><td>0.50</td><td>A:6</td><td>B:1</td><td>C:1</td></tr><tr><td>BEAS</td><td>b</td><td>2015/12/30</td><td>2016/01/04</td><td>2016/01/07</td><td>0.26</td><td>A:7</td><td>B:2</td><td>C:2</td></tr><tr><td>BEAS</td><td>c</td><td>2015/12/30</td><td>2016/01/04</td><td>2016/01/07</td><td>1.71</td><td>A:8</td><td>B:3</td><td>C:3</td></tr><tr><td>BEAS</td><td>d</td><td>2015/12/30</td><td>2016/01/04</td><td>2016/01/07</td><td>0.82</td><td>B:4</td><td>C:4</td><td>D:5</td></tr><tr><td>BEAS</td><td>e</td><td>2015/12/30</td><td>2016/01/08</td><td>2016/01/11</td><td>1.11</td><td>B:5</td><td>C:5</td><td>D:6</td></tr><tr><td>BEAS</td><td>f</td><td>2015/12/30</td><td>2016/01/08</td><td>2016/01/11</td><td>1.10</td><td>B:6</td><td>C:6</td><td>D:7</td></tr><tr><td>BEAS</td><td>g</td><td>2015/12/30</td><td>2016/01/08</td><td>2016/01/11</td><td>1.01</td><td>B:7</td><td>C:7</td><td>D:8</td></tr><tr><td>BEAS</td><td>h</td><td>2015/12/30</td><td>2016/01/08</td><td>2016/01/11</td><td>1.40</td><td>B:8</td><td>C:8</td><td>E:1</td></tr><tr><td>THP1</td><td>a</td><td>2015/12/04</td><td>2015/12/07</td><td>2015/12/09</td><td>1.50</td><td>A:1</td><td>F:3</td><td>G:2</td></tr><tr><td>THP1</td><td>b</td><td>2015/12/04</td><td>2015/12/07</td><td>2015/12/09</td><td>2.10</td><td>A:2</td><td>F:4</td><td>G:3</td></tr><tr><td>THP1</td><td>c</td><td>2015/12/04</td><td>2015/12/08</td><td>2015/12/10</td><td>2.00</td><td>F:5</td><td>G:4</td><td>G:5</td></tr><tr><td>THP1</td><td>d</td><td>2015/12/04</td><td>2015/12/08</td><td>2015/12/10</td><td>1.90</td><td>A:3</td><td>F:6</td><td>G:6</td></tr><tr><td>THP1</td><td>e</td><td>2015/12/07</td><td>2015/12/08</td><td>2015/12/10</td><td>2.90</td><td>A:4</td><td>F:7</td><td>G:7</td></tr><tr><td>THP1</td><td>f</td><td>2015/12/07</td><td>2015/12/08</td><td>2015/12/10</td><td>2.70</td><td>A:5</td><td>F:8</td><td>G:8</td></tr></tbody></table></table-wrap></p>
      <p id="Par15">Although the reference samples were technical replicates of the same RNA, hierarchical clustering as well as PCA grouped the samples by the libraries (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and b). This is the “library bias” that we are investigating in this report. The library bias remained despite using spike-in [<xref ref-type="bibr" rid="CR8">8</xref>], quantile [<xref ref-type="bibr" rid="CR9">9</xref>], RPM [<xref ref-type="bibr" rid="CR11">11</xref>] or VST [<xref ref-type="bibr" rid="CR10">10</xref>] normalization methods (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S1 &amp; S2). Amplification bias should be independent of the library bias, as we are using UMIs [<xref ref-type="bibr" rid="CR14">14</xref>] in this STRT protocol. In the BEAS-2B libraries, <italic>CCDC85B</italic> and <italic>RRM2</italic> were the most biased genes because of their high contribution to the principal components (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). The biases between libraries were more than 16-fold, and the patterns were different between the biased genes (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>; <italic>CCDC85B</italic> was high in BEASb and d libraries, while <italic>RRM2</italic> was high in BEASh), but the patterns were conserved in the normalization methods (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S3). Therefore, an additional correction should be applied for each gene before the normalization.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Biases between BEAS-2B libraries. <bold>a</bold> Spearman correlation coefficients between the 99 technical replicates over 8 libraries and the similarities; the color scheme for representation of the libraries is common also for the following panels. <bold>b</bold> PCA on VST [<xref ref-type="bibr" rid="CR10">10</xref>] normalized expression levels of the replicates. <bold>c</bold> The top 5 contributing genes to the dimensions. Red dashed lines correspond to the expected value if the contributions are uniform. <bold>d</bold> The normalized levels of <italic>CCDC85B</italic> and <italic>RRM2</italic></p></caption><graphic xlink:href="12859_2019_3017_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Implementation of a library bias correction method, NBGLM-LBC</title>
      <p id="Par16">While investigating possible correction methods, we found that the raw read counts and the sequencing depth were correlated in each library, but the regressions differed between the libraries (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, top). Therefore, the library bias of each gene can be reduced by (i) calculating a linear approximation between the depths and the raw counts in each library, and (ii) transforming the raw counts to approximations which overlap each other (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, bottom). Based on this approach, a library bias correction method using a generalized linear model of the negative binomial family with a logarithmic link, named NBGLM-LBC, was implemented. After the library bias correction (Additional files <xref rid="MOESM6" ref-type="media">6</xref> &amp; <xref rid="MOESM7" ref-type="media">7</xref>), overall correlation coefficients between the replicates were much improved (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S4) for both reference types (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S5), and the replicates were more similar (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S6) in the four normalization methods (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S7). However, even after correction, the BEASb library tended to be an outlier (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and c). This library was characterized by (i) the lowest number of processed reads (TOTAL_READS in Additional file <xref rid="MOESM2" ref-type="media">2</xref>) due to the highest sequence redundancy according to the UMIs (REDUNDANCY in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Additional file <xref rid="MOESM2" ref-type="media">2</xref>), (ii) the lowest library quantity (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Table <xref rid="Tab1" ref-type="table">1</xref>; the quantity tends to negatively correlate to the redundancy), and (iii) the lowest mapping rate to protein coding genes (CODING_RATE in Fig. <xref rid="Fig2" ref-type="fig">2d</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>), suggesting low performance of the reverse transcriptase, or high contamination of reads derived from non-mRNAs, during BEASb library synthesis. In contrast, library biases between all THP-1 libraries were well corrected (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S6 bottom). The THP-1 library quantities were very similar, supporting their importance for the effectiveness of the correction (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S8 bottom). In summary, although it was difficult to recover libraries with problems in the library synthesis, NBGLM-LBC reduced the library biases which we observed in technical replicates of the large experiments.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Library bias correction to the BEAS-2B libraries. <bold>a</bold> Correlation between the sequencing depths (x-axis) and the raw read counts (y-axis) of <italic>CCDC85B</italic> (left) and <italic>RRM2</italic> (right) before (top) and after NBGLM-LBC (bottom); solid lines were the linear regressions, and the transparent bands were the 95% prediction intervals. <bold>b</bold> Spearman correlation coefficients between the replicates after NBGLM-LBC. <bold>c</bold> PCA on VST normalized expression levels after the library bias correction. <bold>d</bold> Relation between the library quantity (x-axis of the left panel), proportions of mapped reads on protein coding genes (x-axis of the right panel), and the library redundancy (y-axis)</p></caption><graphic xlink:href="12859_2019_3017_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Simulations suggested that consistent sample layout is required for NBGLM-LBC</title>
      <p id="Par17">In actual studies, we typically compare groups of samples to find differences between them. To evaluate whether NBGLM-LBC is applicable to more common study designs, we tested the method on artificially perturbed expression profiles. The artificial profiles were made for the BEAS-2B libraries by choosing half of the samples as “case” samples. The raw counts of 10% of genes in the case samples were increased twofold, and another 10% of the genes were decreased twofold (Fig. <xref rid="Fig3" ref-type="fig">3</xref> top). When we set half of the samples in each library as “case” samples and half as “controls” (hereafter called “consistent sample layout”), PCA after NBGLM-LBC showed evident differences between control and the case samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref> left). This is expected, as the fold differences between the cases and the controls in each library are conserved – NBGLM-LBC finds regression lines between the cases and the controls in each library, and applies the same transformation to both sample types in same library. On the contrary, when each library only has either “case” samples or “controls” (here called “inconsistent sample layout”), NBGLM-LBC neutralized the differences between the cases and the controls (Fig. <xref rid="Fig3" ref-type="fig">3</xref> right). This is due to NBGLM-LBC transforming regression lines of the case and control libraries so they overlap. The simulation thus suggests that NBGLM-LBC requires a sample layout where both cases and controls are equally present in each library.
<fig id="Fig3"><label>Fig. 3</label><caption><p>NBGLM-LBC required consistent sample layout. Tables (top) are sample layouts of two simulation datasets. A consistent sample layout (left) is defined as the number of control samples and case samples in each library being almost the same, while in an inconsistent sample layout (right) each library has either control or case samples. Panels (bottom) are PCAs on VST normalized expression levels before (left in each sample layout) and after (right in each sample layout) NBGLM-LBC</p></caption><graphic xlink:href="12859_2019_3017_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Application case – NBGLM-LBC for a large-scale leukocyte expression profile</title>
      <p id="Par18">GEWAC (Gene Expression in Wheezing and Asthmatic Children) is a study of childhood acute respiratory illness [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. A leukocyte expression profile using STRT RNAseq [<xref ref-type="bibr" rid="CR1">1</xref>] with 80 ng of total RNAs and GlobinLock [<xref ref-type="bibr" rid="CR17">17</xref>] was performed in patients and healthy volunteers. We arranged the same numbers of the controls and the cases in all eight libraries as much as possible, to obtain a consistent sample layout. In unsupervised hierarchical clustering of 2516 fluctuated protein coding genes, library 5 and libraries 7 + 8 tended to cluster together (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The library biases were observed also in PCA (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The quantity of the libraries and the CODING_RATE were exceptionally low in library 5, and the redundancy of library 5 was higher than the others (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). We therefore decided to exclude library 5, and applied NBGLM-LBC to the raw counts before normalization and the downstream analysis. Although the major variation between CASE1 samples and the others (at the first branch) was still evident even after the correction, clusters of the library 5 and the libraries 7 + 8 disappeared (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). Therefore, down-stream analysis using the corrected expression profile is less influenced by the library biases. For example, to detect correlating gene modules, and to relate the modules to clinical traits, the biases must be minimized before WGCNA [<xref ref-type="bibr" rid="CR18">18</xref>].
<fig id="Fig4"><label>Fig. 4</label><caption><p>Library biases and the correction in GEWAC study. <bold>a</bold> Hierarchical clustering of GEWAC subjects using the leukocyte expression profile without the library bias correction. Upper bar below tree represents the libraries, and lower bar represents the sample types. <bold>b</bold> PCA of the expression profile without the library bias correction. <bold>c</bold> Relation between the library quantity (x-axis of the left panel), proportions of mapped reads on protein coding genes (x-axis of the right panel), and the library redundancy (y-axis). <bold>d</bold> Hierarchical clustering of GEWAC subjects using the leukocyte expression profile with the library bias correction. The upper bar below tree represents the libraries, the lower bar represents the sample types</p></caption><graphic xlink:href="12859_2019_3017_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Conclusions</title>
    <p id="Par19">The NBGLM-LBC method described here can correct library biases which cannot be corrected by more traditional normalization methods. A consistent sample layout for all libraries in a study is required for the library bias correction by NBGLM-LBC. This is similar to “a balanced study design” proposed by Tung and collaborators [<xref ref-type="bibr" rid="CR4">4</xref>]. Several library-bias tolerant statistics have been reported previously, such as SAM [<xref ref-type="bibr" rid="CR19">19</xref>] with block permutations as an example of a bias-tolerant differential expression test. However, the proposed correction method enables various traditional statistical approaches, e.g., hierarchical clustering, PCA, WGCNA or unsupervised clustering of scRNAseq data (reviewed in [<xref ref-type="bibr" rid="CR20">20</xref>]). Moreover, we can test differential expression using the corrected read counts (but without normalization) by various test methods, e.g., DESeq [<xref ref-type="bibr" rid="CR10">10</xref>] or SAMstrt [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par20">The NBGLM-LBC is potentially applicable also to other studies using highly multiplexed RNAseq methods for single-cells or low-input samples by equivolume pooling of barcoded cDNAs and amplification of the pool. Moreover, it may also be worth applying NBGLM-LBC to other sequencing-based profiling methods (e.g. short-RNAseq or ChIPseq), where significant library biases may be seen. Studies based on lower multiplexity (e.g. 6-plex) or equimolar pooling as performed in several large-input RNAseq protocols, are less likely to benefit from NBGLM-LBC, due to the smaller number of samples per library, or lower variation of the sequence depth between the samples. UMIs are useful for reducing amplification bias [<xref ref-type="bibr" rid="CR14">14</xref>], but are alone likely not sufficient to reduce library bias. Redundancy, which can be estimated by UMIs, was associated with the library quality, but we can find the redundancy only after sequencing. Therefore, one practical thing to highlight is that measurement of library quantity before sequencing is an important checkpoint. Exceptionally low-quantity libraries in a study should be discarded even if they initially appear to be adequate for sequencing, as the sequence data quality is likely to be insufficient for the expression analysis.</p>
  </sec>
  <sec id="Sec14">
    <title>Availability and requirements</title>
    <p id="Par21">Project name: NBGLM-LBC.</p>
    <p id="Par22">Project home page: <ext-link ext-link-type="uri" xlink:href="https://shka.github.io/NBGLM-LBC">https://shka.github.io/NBGLM-LBC</ext-link> (mirrored at <ext-link ext-link-type="uri" xlink:href="https://shka.bitbucket.io/NBGLM-LBC">https://shka.bitbucket.io/NBGLM-LBC</ext-link>).</p>
    <p id="Par23">Operating system: Platforms supporting the fork system call (ex. Linux or macOS).</p>
    <p id="Par24">Programming language: R (version 3.0 or higher).</p>
    <p id="Par25">License: MIT.</p>
    <p id="Par26">Any restrictions to use by non-academics: No.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3017_MOESM1_ESM.r">
            <label>Additional file 1:</label>
            <caption>
              <p>Sample script. This script demonstrates the library bias correction by NBGLM-LBC, performs the simulation experiments for Fig. <xref rid="Fig3" ref-type="fig">3</xref>, and draws Figs. <xref rid="Fig1" ref-type="fig">1b</xref>, <xref rid="Fig2" ref-type="fig">2a, c</xref> and <xref rid="Fig3" ref-type="fig">3</xref> bottoms. Before running this script using R, LBC-additionalFile2.txt (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) and LBC-additionalFile3.txt (Additional file <xref rid="MOESM3" ref-type="media">3</xref>) must be placed within the working directory, and the preprocessCore, DESeq2 and factoextra packages must be installed. (R 10 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3017_MOESM2_ESM.txt">
            <label>Additional file 2:</label>
            <caption>
              <p>Layout of reference samples and the qualities. There are seven quality measures provided in the STRTprep pipeline; (i) TOTAL_READS is a read count after the redundant read exclusion based on UMI; (ii) REDUNDANCY is redundancy based on UMI; (iii) MAPPED_RATE is the rate of mapped reads; (iv) SPIKEIN_5END_RATE is the 5′-end capture rate of spike-in molecules; (v) CODING_5END_RATE is the 5′-end capture rate of protein coding genes; (vi) CODING_READS is reads that were aligned to exons of protein coding genes; and (vii) CODING_RATE is calculated by CODING_READS/(TOTAL_READS*MAPPED_RATE). See also detailed instruction at <ext-link ext-link-type="uri" xlink:href="https://github.com/shka/STRTprep/blob/v3dev/doc/result.md#outbygenesamples_allcsv">https://github.com/shka/STRTprep/blob/v3dev/doc/result.md#outbygenesamples_allcsv</ext-link>. (TXT 16 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_3017_MOESM3_ESM.txt">
            <label>Additional file 3:</label>
            <caption>
              <p>Raw read counts of BEAS-2B libraries before the library bias correction (TXT 3580 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_3017_MOESM4_ESM.txt">
            <label>Additional file 4:</label>
            <caption>
              <p>Raw read counts of THP-1 libraries before the library bias correction (TXT 2541 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_3017_MOESM5_ESM.pdf">
            <label>Additional file 5:</label>
            <caption>
              <p><bold>Figure S1.</bold> Spearman correlation coefficients between the technical replicates of normalized expression levels by four different normalization methods and the libraries. <bold>Figure S2.</bold> PCA of the BEAS-2B technical replicates of normalized expression levels by four different normalization methods. <bold>Figure S3.</bold> Normalized expression levels by the four different normalization methods, and the ranks, of three library-biased genes. <bold>Figure S4.</bold> Pairwise comparison of raw read counts and the Spearman correlation coefficients before and after the library bias correction. <bold>Figure S5.</bold> Spearman correlation coefficients between the technical replicates of the normalized expression levels before and after the library bias correction. <bold>Figure S6.</bold> PCA of the technical replicates of the spike-in normalized expression levels before and after the library bias correction. <bold>Figure S7.</bold> PCA of normalized expression levels of the BEAS-2B technical replicates by four different normalization methods, before and after the library bias correction. <bold>Figure S8.</bold> Quantity of the library before sequencing, and REDUNDANCY and CODING_RATE after the sequencing. (PDF 2469 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_3017_MOESM6_ESM.txt">
            <label>Additional file 6:</label>
            <caption>
              <p>Raw read counts of BEAS-2B libraries after the library bias correction (TXT 3574 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2019_3017_MOESM7_ESM.txt">
            <label>Additional file 7:</label>
            <caption>
              <p>Raw read counts of THP-1 libraries after the library bias correction (TXT 2536 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GEWAC</term>
        <def>
          <p id="Par4">Gene Expression in Wheezing and Asthmatic Children</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par5">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>STRT</term>
        <def>
          <p id="Par6">Single-cell tagged reverse transcription</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p id="Par7">Unique molecular identifier</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Mrs. Ingegerd Fransson for expert help with the library preparation. The reference RNAs were kind gifts from Prof. Bengt Fadeel, Dr. Audrey Gallud (THP-1 cells), Prof. Hannu Norppa and Dr. Gerard Vales Segura (BEAS-2B cells). This study was performed on resources provided by SNIC through the Uppsala Multidisciplinary Center for Advanced Computational Science (UPPMAX) under project b2014069.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SK contributed conception, design of the work, analysis, interpretation of the data, creation of software in this work and drafted the manuscript. TS, CS, EE, KK and JK contributed to acquisition of the expression data. All the authors reviewed and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by Karolinska Institutet Research Foundations Grants and the Knut and Alice Wallenberg Foundation; the European Commission funded the NANOSOLUTIONS project, the Swedish Heart-Lung Foundation, Stiftelsen Sven Jerrings fond and the Centre for Allergy Research at Karolinska Institutet for acquisition of the expression data. No specific funding for the other roles.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code, the documentation and sample code for NBGLM-LBC are included in the project home page and Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The count data before and after the library bias correction (for Table <xref rid="Tab1" ref-type="table">1</xref>, Figs. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, Additional files <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM5" ref-type="media">5</xref>) are in Additional files <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM6" ref-type="media">6</xref> and <xref rid="MOESM7" ref-type="media">7</xref>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par27">The GEWAC study protocol (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) was approved by the Regional Ethics Committee of Karolinska Institutet, Stockholm (Dnr 2008/378–31/4 and 2014/399–31/3), and written informed consent was obtained from parents and/or legal guardians.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par28">Written informed consent for the GEWAC study (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) was obtained from parents and/or legal guardians.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par29">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krjutškov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saare</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vera-Rodriguez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lubenets</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Samuel</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis of endometrial tissue</article-title>
        <source>Hum Reprod</source>
        <year>2016</year>
        <volume>31</volume>
        <fpage>844</fpage>
        <lpage>853</lpage>
        <pub-id pub-id-type="doi">10.1093/humrep/dew008</pub-id>
        <pub-id pub-id-type="pmid">26874359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Hicks SC, Townes FW, Teng M, Irizarry RA. Missing data and technical variability in single-cell RNA- sequencing experiments. bioRxiv Cold Spring Harbor Laboratory; 2015;:025528.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Overcoming confounding plate effects in differential expression analyses of single-cell RNA-seq data</article-title>
        <source>Biostatistics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>451</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxw055</pub-id>
        <pub-id pub-id-type="pmid">28334062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Blischak</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Burnett</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>39921</fpage>
        <pub-id pub-id-type="doi">10.1038/srep39921</pub-id>
        <pub-id pub-id-type="pmid">28045081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R36</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id>
        <pub-id pub-id-type="pmid">23618408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Töhönen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kere</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SAMstrt: statistical test for differential expression in single-cell transcriptome with spike-in normalization</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2943</fpage>
        <lpage>2945</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt511</pub-id>
        <pub-id pub-id-type="pmid">23995393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Astrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title>
        <source>Bioinformatics.</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>185</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.185</pub-id>
        <pub-id pub-id-type="pmid">12538238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawaji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kasukawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fukuda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CAGE basic/analysis databases: the CAGE resource for comprehensive promoter analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D632</fpage>
        <lpage>D636</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj034</pub-id>
        <pub-id pub-id-type="pmid">16381948</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A flexible R package for nonnegative matrix factorization</article-title>
        <source>BMC Bioinformatics BioMed Central</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>367</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kołodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kivioja</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vähärautio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bonke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>72</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stenberg-Hammar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niespodziana</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Söderhäll</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cabauatan</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Konradsen</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rhinovirus-specific antibody responses in preschool children with acute wheeze reflect severity of respiratory symptoms</article-title>
        <source>Allergy.</source>
        <year>2016</year>
        <volume>71</volume>
        <fpage>1728</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1111/all.12991</pub-id>
        <pub-id pub-id-type="pmid">27444786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stenberg Hammar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hedlin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Konradsen</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Nordlund</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kull</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Giske</surname>
            <given-names>CG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Subnormal levels of vitamin D are associated with acute wheeze in young children</article-title>
        <source>Acta Paediatr</source>
        <year>2014</year>
        <volume>103</volume>
        <fpage>856</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="doi">10.1111/apa.12666</pub-id>
        <pub-id pub-id-type="pmid">24766450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krjutškov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Roost</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Einarsdottir</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jouhilahti</surname>
            <given-names>E-M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Globin mRNA reduction for whole-blood transcriptome sequencing</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>31584</fpage>
        <pub-id pub-id-type="doi">10.1038/srep31584</pub-id>
        <pub-id pub-id-type="pmid">27515369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>WGCNA: an R package for weighted correlation network analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>559</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id>
        <pub-id pub-id-type="pmid">19114008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>VG</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5116</fpage>
        <lpage>5121</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id>
        <pub-id pub-id-type="pmid">11309499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet Nature Publishing Group</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
