<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.2.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art520.dtd?>
<?SourceDTD.Version 5.2.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<?origin publisher?>
<?FILEmeta_YMETH3308 xml ?>
<?FILEmain xml ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Methods</journal-id>
    <journal-title-group>
      <journal-title>Methods (San Diego, Calif.)</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1046-2023</issn>
    <issn pub-type="epub">1095-9130</issn>
    <publisher>
      <publisher-name>Academic Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3969109</article-id>
    <article-id pub-id-type="publisher-id">S1046-2023(13)00418-0</article-id>
    <article-id pub-id-type="doi">10.1016/j.ymeth.2013.10.015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Hyb: A bioinformatics pipeline for the analysis of CLASH (crosslinking, ligation and sequencing of hybrids) data<sup><xref ref-type="fn" rid="d32e1012">☆</xref></sup></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Travis</surname>
          <given-names>Anthony J.</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moody</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref rid="af015" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Helwak</surname>
          <given-names>Aleksandra</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tollervey</surname>
          <given-names>David</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kudla</surname>
          <given-names>Grzegorz</given-names>
        </name>
        <email>gkudla@gmail.com</email>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
    </contrib-group>
    <aff id="af005"><label>a</label>Wellcome Trust Centre for Cell Biology, University of Edinburgh, Edinburgh, Scotland, United Kingdom</aff>
    <aff id="af010"><label>b</label>Institute of Biological and Environmental Sciences, University of Aberdeen, Aberdeen, Scotland, United Kingdom</aff>
    <aff id="af015"><label>c</label>MRC Human Genetics Unit, Institute of Genetics and Molecular Medicine, University of Edinburgh, Edinburgh, Scotland, United Kingdom</aff>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author. <email>gkudla@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>2</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="ppub">.-->
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2014</year>
    </pub-date>
    <volume>65</volume>
    <issue>3</issue>
    <fpage>263</fpage>
    <lpage>273</lpage>
    <permissions>
      <copyright-statement>© 2013 The Authors</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Associations between proteins and RNA–RNA duplexes are important in post-transcriptional regulation of gene expression. The CLASH (Cross-linking, Ligation and Sequencing of Hybrids) technique captures RNA–RNA interactions by physically joining two RNA molecules associated with a protein complex into a single chimeric RNA molecule. These events are relatively rare and considerable effort is needed to detect a small number of chimeric sequences amongst millions of non-chimeric cDNA reads resulting from a CLASH experiment. We present the “hyb” bioinformatics pipeline, which we developed to analyse high-throughput cDNA sequencing data from CLASH experiments. Although primarily designed for use with AGO CLASH data, hyb can also be used for the detection and annotation of chimeric reads in other high-throughput sequencing datasets. We examined the sensitivity and specificity of chimera detection in a test dataset using the BLAST, BLAST+, BLAT, pBLAT and Bowtie2 read alignment programs. We obtained the most reliable results in the shortest time using a combination of preprocessing with Flexbar and subsequent read-mapping using Bowtie2. The “hyb” software is distributed under the GNU GPL (General Public License) and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/gkudla/hyb" id="ir0005">https://github.com/gkudla/hyb</ext-link>.</p>
    </abstract>
    <kwd-group>
      <title>Keywords</title>
      <kwd>CLASH</kwd>
      <kwd>RNA–RNA interactions</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>High-throughput sequencing</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p>RNA molecules are abundant in all living cells, but, like football fans around the world, they never walk alone. Protein–RNA binding is essential for the biological function of most RNAs, and proteins accompany RNAs throughout their life cycle, from synthesis and processing to transport and degradation. Likewise, inter- or intra-molecular RNA–RNA interactions are fundamental to many processes including splicing, translation, and gene regulation. In particular, post-transcriptional regulation of gene expression mediated by miRNA molecules that base-pair with their RNA targets has been the focus of intense research efforts in recent years <xref rid="b0005" ref-type="bibr">[1]</xref>. Other regulatory mechanisms that depend on RNA–RNA interactions include silencing of transposons by piRNAs <xref rid="b0010" ref-type="bibr">[2]</xref>, Staufen-mediated decay of mRNAs <xref rid="b0015" ref-type="bibr">[3]</xref>, and gene regulation mediated by sRNAs in bacteria <xref rid="b0020" ref-type="bibr">[4]</xref>.</p>
    <p>The development of CLIP (Crosslinking and Immunoprecipitation) <xref rid="b0025 b0030" ref-type="bibr">[5,6]</xref> has allowed mapping of the RNA interactomes for a variety of proteins. Several of these proteins form tripartite protein–RNA–RNA complexes, and the profiling of protein–RNA interactions can provide useful information about the corresponding RNA–RNA pairing. For example, transcriptome-wide analysis of AGO–RNA interactions in human and mouse cells has led to the discovery of many putative miRNA binding sites, a number of which could be confirmed experimentally <xref rid="b0035 b0040 b0045" ref-type="bibr">[7–9]</xref>. Furthermore, recent CLIP studies identified various noncanonical types of interaction, such as the G-bulge sites that accounted for more than 15% of all AGO–miRNA interactions in the mouse brain <xref rid="b0050" ref-type="bibr">[10]</xref>. However, the discovery of non-canonical interactions by CLIP is complicated by the fact that the identity of interacting partners is not observed directly and needs to be inferred bioinformatically.</p>
    <p>We have recently described CLASH (crosslinking, ligation and sequencing of hybrids), a method for transcriptome-wide analysis of RNA–RNA interactions <xref rid="b0055 b0060" ref-type="bibr">[11,12]</xref>. CLASH relies on purification of RNA–RNA duplexes bound to a protein of choice, ligation between the two strands of RNA duplexes to form chimeric RNAs, reverse transcription of these chimeric RNAs, high-throughput sequencing of the resulting cDNAs, and bioinformatic analysis of the sequence data to call and annotate chimeric reads. CLASH has many experimental steps in common with the CLIP and CRAC methods, but it is optimized for recovery of RNA–RNA duplexes. Here we describe the bioinformatic methods we have developed to carry out the analysis of sequencing data from CLASH experiments. We also present “hyb”, a set of command line tools that implements our approach for Unix/Linux-based computer systems. A detailed experimental protocol of CLASH will be published elsewhere (Helwak and Tollervey, in preparation).</p>
    <p>Whilst primarily designed for the analysis of AGO CLASH data, our programs can also be used to identify chimeric reads in other applications of CLASH, as well as for the analysis of CRAC, CLIP, and RNA-Seq data. The precise interpretation of the chimeras will depend on the dataset under consideration. For example, analysis of chimeric reads in RNA-Seq experiments has recently been used to identify a novel class of RNAs with regulatory potential, the circRNAs <xref rid="b0065 b0070" ref-type="bibr">[13,14]</xref>, and most of these circRNAs can be recovered by hyb.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Overview of the method</title>
    <p>In a CLASH experiment, interacting RNA molecules are partially digested, ligated to each other at one end, ligated to 5′ and 3′ linkers, respectively at their other end, and then subjected to single-end high-throughput sequencing. The resulting reads contain, in the following order: part of the 5′ linker, the cDNA insert, and part or all of the 3′ linker (<xref rid="f0005" ref-type="fig">Fig. 1</xref>a). Our bioinformatics pipeline begins by preprocessing the reads: removing linker sequences, quality filtering the data, and collapsing identical reads to speed up the computationally intensive downstream analyses (<xref rid="f0005" ref-type="fig">Fig. 1</xref>b).</p>
    <p>After preprocessing, we use local alignment tools to map the reads to a custom database of transcript sequences or to the genomic sequence of the organism concerned. Reads with two non-contiguous matches to the database are identified as chimeras, whereas reads mapped contiguously are discarded. Mapping reads to transcript sequences, rather than to the genome, makes it easier to reject chimeric cDNAs generated by natural splicing events, because spliced cDNAs from mature mRNAs will generally be mapped contiguously to known mRNA transcripts.</p>
    <p>After the chimeras are called, we fold them computationally to predict the exact pattern of basepairing between the interacting RNA molecules. Although folding algorithms cannot accurately predict the structures of long RNA molecules, they are nevertheless reliable in predicting interactions between short fragments of RNA, such as those identified by CLASH. We then use the folding predictions to annotate and classify the RNA–RNA interactions recovered.</p>
  </sec>
  <sec id="s0015">
    <label>3</label>
    <title>CLASH data analysis</title>
    <sec id="s0020">
      <label>3.1</label>
      <title>Prerequisites</title>
      <p>
        <table-wrap id="t0005" position="float">
          <table frame="hsides" rules="groups">
            <tbody>
              <tr>
                <td>(a)</td>
                <td>cDNA sequencing data in FASTQ or FASTA format.</td>
              </tr>
              <tr>
                <td>(b)</td>
                <td>DNA sequence of the 3′ linker used.</td>
              </tr>
              <tr>
                <td>(c)</td>
                <td>DNA sequences of 5′ barcodes, if present.</td>
              </tr>
              <tr>
                <td>(d)</td>
                <td>Database of relevant transcript sequences, or genomic sequence. A human transcript sequence database is included in our distribution. Transcript sequences can be conveniently downloaded from the Ensembl Biomart or from other specialist repositories such as mirBase or genomic tRNA database.</td>
              </tr>
              <tr>
                <td>(e)</td>
                <td>Computer with a Unix or Linux-based operating system conforming to POSIX (Portable Operating System Interface). The “hyb” pipeline was implemented under Bio-Linux 7 (based on 64-Bit Ubuntu 12.04 LTS) <xref rid="b0075" ref-type="bibr">[15]</xref>.</td>
              </tr>
              <tr>
                <td>(f)</td>
                <td>External dependencies. In addition to the internal programs developed as part of hyb, external programs are required to run the complete hyb pipeline. The complete list of dependencies is shown in <xref rid="t0015" ref-type="table">Table 1</xref>, and the minimum requirements are: an adapter trimming program (FASTX toolkit or flexbar) <xref rid="b0080 b0085" ref-type="bibr">[16,17]</xref>, a read aligner (for example, bowtie2 or blast) <xref rid="b0090 b0095" ref-type="bibr">[18,19]</xref>, and an RNA folding program (UNAFold hybrid-min, or vienna RNAup) <xref rid="b0100 b0105" ref-type="bibr">[20,21]</xref>. Many of these programs are pre-installed and supported by Bio-Linux.</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="s0025">
      <label>3.2</label>
      <title>Preprocessing reads</title>
      <sec id="s0030">
        <label>3.2.1</label>
        <title>Trimming of 5′ adapter sequences</title>
        <p>Depending on the experimental design, 5′ linkers may contain a variable-length barcode for sample multiplexing and a random nucleotide prefix for monitoring of PCR amplification artefacts (<xref rid="f0010" ref-type="fig">Fig. 2</xref>). We trim the 5′ barcode allowing for 0 (default) or 1 nucleotide substitutions and no indels. Our program builds a lookup table of all the 5′ ends of reads compatible with the presence of a barcode, and then it performs one sub-string extraction and no string comparisons for each read. This allows us to process as many as 13 million reads per minute on a single CPU core. The multiplexing part of the 5′ barcode is used to split the input FASTQ format file into separate files for each sample, but is then discarded. The random part of the 5′ barcode is appended to the sequence identifiers in the FASTQ header of each read for future reference. This part of analysis can be skipped if no 5′ barcodes have been used. Typical usage for demultiplexing as a separate step is:<disp-quote><p>hyb demultiplex in=data.fastq code=barcodes.txt</p></disp-quote>where: <disp-quote><p>in=file (or in=file.gz) contains FASTQ format reads; code=file contains barcodes used to multiplex samples. "hyb" commands are normally entered on one line, but long commands can be continued onto the next line using a '\' escape character at the end of a line. The escape characters are omitted from the printed examples.</p></disp-quote></p>
      </sec>
      <sec id="s0035">
        <label>3.2.2</label>
        <title>Trimming of 3′ adapter sequences and quality filtering of reads</title>
        <p>In a typical CLASH library, many of the recovered RNA fragments are shorter than the read length, resulting in part or all of the 3′ linker sequence to be included in the reads. Accurate 3′ linker removal is important to prevent mapping errors, but overly permissive criteria for linker recognition may result in the loss of <italic>bona fide</italic> genomic sequences. We have tested two linker trimming programs, flexbar and fastx-clipper, and we adopted flexbar as default. Following 3′ linker trimming, we filter the reads by insert length and by nucleotide qualities. The “preprocess” task runs this part of the analysis:<disp-quote><p>hyb preprocess qc=flexbar trim=30 len=17</p><p>in=data.fastq</p></disp-quote>where: <disp-quote><p>qc=flexbar selects Flexbar preprocessing; trim=30 trims reads from 3’ end to Phred Qual=30; len=17 specifies minimum read-length 17.</p></disp-quote></p>
      </sec>
      <sec id="s0040">
        <label>3.2.3</label>
        <title>Removal of PCR duplicates</title>
        <p>The complexity of CLASH libraries typically ranges from a few hundred thousand to a few million cDNA molecules <xref rid="b0055" ref-type="bibr">[11]</xref>. Following cDNA synthesis, the libraries are amplified by PCR and then sequenced, often yielding tens or hundreds of millions of reads. If the number of reads is larger than library complexity, many cDNA molecules will be sequenced multiple times. To remove potential PCR duplicates and speed up downstream analysis, we collapse identical reads while retaining information about the numbers of reads collapsed. Numbers of collapsed reads are appended to the sequence identifiers (<xref rid="f0010" ref-type="fig">Fig. 2</xref>). The random barcode prefixes are used to distinguish artificial PCR duplicates from mRNA fragments naturally present in the library in multiple copies. Counts of these random barcodes, if present, are also encoded in sequence identifiers of collapsed reads (<xref rid="f0010" ref-type="fig">Fig. 2</xref>). The reads are collapsed as part of the “preprocess” task described above. The “check” task uses the preprocessing results to analyse length distributions of uncollapsed and collapsed reads:<disp-quote><p>hyb check in=data.fastq</p></disp-quote></p>
      </sec>
    </sec>
    <sec id="s0045">
      <label>3.3</label>
      <title>Mapping reads and calling chimeras</title>
      <sec id="s0050">
        <label>3.3.1</label>
        <title>Mapping of reads</title>
        <p>In the previously published analyses, we used the blastall program to find high-scoring local matches between the reads and a database of transcript sequences <xref rid="b0055 b0060" ref-type="bibr">[11,12]</xref>. In hyb, we implemented additional options for mapping reads using blastn (the C++ based distribution of blast), blat, pblat (parallel blat), and bowtie2. By default, hyb uses bowtie2 with the --local option to map reads against a precompiled database of human transcript sequences, included in the distribution. To create mapping databases based on a custom FASTA file, the following command may be used:<disp-quote><p>make_hyb_db genome.fasta</p></disp-quote></p>
        <p>The default location of the reference database is specified by the HYB_DB environment variable, as described in Section <xref rid="s0085" ref-type="sec">3.7</xref>. Reads can be mapped to transcriptome or genomic databases, but mapping to the genome yields a large background of chimeric reads formed by splicing, which need to be distinguished from chimeras formed by RNA–RNA ligations during the CLASH procedure. By default, hyb assumes that reads are mapped against a transcript database, and it rejects reads mapped in the antisense orientation. To accept antisense reads when mapping to a genomic sequence database, the “anti=1” option has to be set on the command line. The default sets of mapping parameters are listed in <xref rid="t0020" ref-type="table">Table 2</xref>. The “detect” task performs the mapping and the chimera calling described below:<disp-quote><p>hyb detect align=bowtie2 in=data.fastq db=hOH7</p></disp-quote>where: <disp-quote><p>align=bowtie2 sets the read aligner to bowtie2; db=hOH7 selects the hOH7 Bowtie2 database.</p></disp-quote></p>
      </sec>
      <sec id="s0055">
        <label>3.3.2</label>
        <title>Identifying candidate chimeric reads</title>
        <p>To call chimeras, we examine local matches between each read and the reference database, starting with the highest-scoring hits. We record the top-scoring match, all matches with the same mapping score as the top match, and all matches for which the gap or overlap with the previously matched area of the read is at most 4 nucleotides (default). We then identify as candidate chimeras all pairs of recorded matches with at most 4 nucleotides gap or overlap. This procedure rejects any reads with a contiguous full-length match to the database, since the overlap criterion would not be met for such reads. Short gaps or overlaps are allowed: gaps can represent post-transcriptional modification of one of the interaction partners (e.g., oligoadenylation), whereas overlaps frequently occur if one or more nucleotides in the middle of the read can be mapped to either chimeric fragment. We found that the small ambiguity in ligation sites identified, which results from such overlaps, is well tolerated and does not influence downstream analysis.</p>
      </sec>
      <sec id="s0060">
        <label>3.3.3</label>
        <title>Calling chimeric reads</title>
        <p>The procedure above yields a list of all chimera calls compatible with the read sequence. To uniquely call each chimera, we apply a series of filters and selection criteria to this list. We select the best chimera call in the list, by considering, in turn, (1) the sum of the mapping scores of both fragments of the chimera; (2) optionally, the classes of transcripts to which the read was mapped (to prioritize miRNA–mRNA calls in the case of AGO-mediated interactions), and (3) the total number of reads mapped to each of the transcripts that form the chimera. Mapping reads to a transcript database sometimes results in ambiguous assignment to several transcripts, usually originating from the same locus. To resolve the ambiguity, we rank transcripts by the total number of mapped reads, to create an alignment reference file. We then use this reference to assign ambiguous reads to the transcript with the largest number of mapped reads. To generate consistent chimera calls across a set of related experiments, we rank transcripts according to the total number of reads across all experiments, using a common alignment reference file. The following command line illustrates the available options for identifying chimera candidates and calling chimeras:<disp-quote><p>hyb detect type=all pref=none hval=0.1 hmax=10</p><p>gmax=4 in=data.fastq db=hOH7</p></disp-quote>where: <disp-quote><p>type=all sets the search for chimeras in all classes of transcripts; pref=none do not prioritize miRNA–mRNA (mim) hybrids; hval=0.1 sets threshold e-value for hybrid fragments; hmax=10 sets maximum number of mapped locations of hybrid bits; gmax=4 sets maximum length of gap/overlap between hybrid bits.</p></disp-quote></p>
        <p>For a test input file with 31 million reads (9 million unique reads), including &gt;400,000 chimeras, the chimera-calling part of the analysis takes approximately 12 min on a single CPU core, and it uses 45 MB of memory, when run with default parameters.</p>
      </sec>
      <sec id="s0065">
        <label>3.3.4</label>
        <title>Bioinformatic extension of chimeric reads</title>
        <p>At the last stage of chimera calling, for miRNA-target chimeras, we optionally extend the miRNA fragment to cover the entire miRNA sequence retrieved from our custom database, and we extend target coordinates by 25 nucleotides to make sure that the entire interaction site is included within the called region. This type of adjustment improves chimera calls for sequencing reads that do not cover the entire length of the chimeric cDNA. The same adjustment was used in the original AGO1 CLASH study <xref rid="b0055" ref-type="bibr">[11]</xref>.<disp-quote><p>hyb detect type=mim pref=mim in=data.fastq db=hOH7</p></disp-quote>where: type=mim sets the search for miRNA–mRNA (mim) hybrids and bioinformatically extend miRNA and mRNA fragments; pref=mim prioritize miRNA-mRNA (mim) hybrids.</p>
        <p>Finally, all chimeras are written to a “.hyb” file, our gff-related format that contains sequence identifiers, read sequences, 1-based mapping coordinates, and annotation information for each chimera (<xref rid="t0025" ref-type="table">Table 3</xref>).</p>
      </sec>
    </sec>
    <sec id="s0070">
      <label>3.4</label>
      <title>In silico folding and merging of chimeras</title>
      <p>We use the mapped coordinates of chimeras to extract the corresponding transcript or genomic sequences, and we use these sequences for RNA folding analysis. We fold transcript sequences extracted from a database, rather than read sequences, because reads may contain crosslinking-induced substitutions and deletions <xref rid="b0110 b0115 b0120" ref-type="bibr">[22–24]</xref>, which are not relevant for in vivo folding of RNA.</p>
      <p>We use UNAFold hybrid-min with default parameters to fold RNA, and we convert the hybrid-min outputs to the commonly used dot-bracket notation, as defined in the Vienna RNA package. Optionally, the RNAup program from the Vienna package can be used for chimera folding. The dot-bracket file is then annotated with RNA sequences and coordinates to facilitate subsequent analysis.</p>
      <p>Overlapping chimeras are then merged, similar to the bedtools merge operation <xref rid="b0125" ref-type="bibr">[25]</xref>, except that an overlap between both fragments of the two chimeras is required for merging the chimeras. This results in a list of RNA–RNA interactions, each annotated with the number of supporting chimeric reads, identifiers of supporting reads, and average folding energy. The “analyse” task runs this part of the analysis:<disp-quote><p>hyb analyse fold=UNAfold in=data.fastq db=hOH7</p></disp-quote>where: <disp-quote><p>fold=UNAfold sets hybrid-min as the RNA folding program.</p></disp-quote></p>
    </sec>
    <sec id="s0075">
      <label>3.5</label>
      <title>Running the entire analysis as a single command</title>
      <p>Each of the example “hyb” commands above can be executed separately or as one command-line for a single sample. For example the following command runs the entire analysis for a non-multiplexed dataset:<disp-quote><p>hyb preprocess qc=flexbar trim=30 len=17 min=4 check</p><p>detect align=bowtie2 word=11 analyse fold=UNAfold</p><p>in=data.fastq db=hOH7 id=bow_flex_UNA</p></disp-quote></p>
      <p>Hyb evaluates at runtime which tasks need to be performed for a given analysis, and it uses default parameter values where needed. The same analysis as above can be run using the minimal command line below:<disp-quote><p>hyb analyse in=data.fastq db=hOH7</p></disp-quote></p>
      <p>It is possible to run the entire “hyb” pipeline on a multiplexed sample file using the barcode file to identify each sample, as follows:<disp-quote><p>hyb demultiplex code=barcodes.txt preprocess</p><p>qc=flexbar trim=30 len=17 min=4 check detect</p><p>align=bowtie2 word=11 analyse fold=UNAfold</p><p>in=data.fastq db=hOH7</p></disp-quote></p>
      <p>It is also possible to reuse the mapping data from a previous run of hyb, and run only the chimera calling part of the pipeline:<disp-quote><p>hyb analyse in=data_comp_hOH7.blast format=blast</p><p>align=none id=new</p></disp-quote></p>
    </sec>
    <sec id="s0080">
      <label>3.6</label>
      <title>Further analysis of chimeras</title>
      <p>The main outputs of hyb are: a file with coordinates of all the chimeras (“.hyb”), a file with the folding analysis of chimeras (“.viennad”), and a number of intermediate files that can be used when re-running parts of the pipeline with varying parameters, and for troubleshooting. Output file formats are described in the hyb documentation. The output files can be used to further analyse the patterns of RNA–RNA interactions. For example, in a previous study, we have used information from the “viennad” files for clustering of miRNA–mRNA interactions, and the information from the “hyb” files to analyse the sequence motifs found in the targets of particular miRNAs <xref rid="b0055" ref-type="bibr">[11]</xref>.</p>
      <p>To facilitate downstream analyses, we provide several standalone scripts: hyb_merge for clustering chimeras, hyb2gff for converting a “hyb” file to the commonly used “gff” format (splitting each chimera into two entries), and enst2genome for converting from transcript to genomic coordinates. We refer the reader to the hyb documentation for additional information about these scripts.</p>
    </sec>
    <sec id="s0085">
      <label>3.7</label>
      <title>Configuring environment variables</title>
      <p>The execution of hyb can be configured using ‘environment’ variables in the Unix/Linux interactive command-line ‘shell’ (e.g., “bash”) used to invoke the program. By default, hyb sets the environment variables internally, relative to the directory “HYB_HOME” where hyb has been installed. For example, the default location for hyb data files is “HYB_DATA” and the directory containing all the alignment databases is “HYB_DATA/db”. If a user prefers to use their own database “my_db” in their own folder “my_db_dir”, they can override the defaults using e.g.:<disp-quote><p>HYB_DB=~/my_db_dir hyb in=reads.txt db=my_db</p><p>id=my_analysis analyse</p></disp-quote></p>
      <p>In this case, the “HYB_DB” variable is only set for a single hyb run as specified on the command-line. The environment variable can also be ‘exported’ to the shell environment for all hyb runs done during the same login session using e.g.:<disp-quote><p>export HYB_DB=~/my_db_dir</p><p>hyb in=reads.txt db=my_db id=my_analysis analyse</p></disp-quote></p>
      <p>Alternatively, the hyb environment variables can be set automatically by adding the ‘export’ statements to a start-up file that is read at by the shell at login (e.g., .profile when using “bash” under Bio-Linux). A full list of the environment variables is available in the hyb documentation and can be obtained after installing hyb using the Linux “man” command:<disp-quote><p>man hyb</p></disp-quote></p>
    </sec>
    <sec id="s0090">
      <label>3.8</label>
      <title>Implementation</title>
      <p>Hyb is implemented as an executable ‘Makefile’ that orchestrates the execution of a number of internal and external programs such as the read aligners and RNA folding software. Internal scripts are written in Perl, Python and Awk. Although designed for managing the compilation of computer software from large and complicated source-code contained in many different files, GNU make is well-suited to the requirements of bioinformatics analysis, which involves the manipulation of large text files and their transformation into other formats. Many bioinformaticians are familiar with software development and routinely use Makefiles, which capture the provenance of their analysis. Makefiles consist of goals (or tasks) and rules about how to create one file from another according to its dependencies or prerequisites. The hyb pipeline was developed as a Makefile and could be invoked using the GNU “make” command:<disp-quote><p>make -f hyb</p></disp-quote></p>
      <p>To create an executable Makefile, the following line was used as the first line in a plain-text file:<disp-quote><p>#!/usr/bin/make -rRf</p></disp-quote></p>
      <p>This invokes make with no built-in rules (-r) or built-in variables (-R) on the current script file (-f). The rest of the script is a conventional Makefile, but it is not necessary to invoke make explicitly on the command-line to run it. Although a minor change from the way that Makefiles are conventionally used, this makes hyb considerably more flexible and easier to parameterise.</p>
      <p>Make has been used in other bioinformatics pipelines. For example, the “PredictProtein” server <xref rid="b0130" ref-type="bibr">[26]</xref> invokes Make programmatically by a Perl driver script to process jobs submitted via a web GUI interface. This is done primarily because make is able to utilise the available server resources efficiently by evaluating a dependency graph according to rules specified in the Make programming language and running any independent tasks it identifies concurrently. In addition, Make will minimise the amount of unnecessary work by tracking the time and date stamps of dependencies. This has been used to great effect in the parallel short-read assembler “ABySS” <xref rid="b0135" ref-type="bibr">[27]</xref>. The ABySS paired-end assembler is, in fact, and executable Makefile.</p>
    </sec>
  </sec>
  <sec id="s0095">
    <label>4</label>
    <title>Parameter optimization</title>
    <sec id="s0100">
      <label>4.1</label>
      <title>General considerations</title>
      <p>We used the published AGO1 CLASH data <xref rid="b0055" ref-type="bibr">[11]</xref>, available on GEO as GSE50452, to benchmark hyb and establish parameter sets that maximize the total number of interactions recovered, minimize recovery of false positive miRNA–mRNA interactions, and reduce the overall time of analysis. In the context of our analysis, false positives might arise both from calling of non-chimeric reads as chimeric, and from the recovery of chimeric reads that do not represent RNA–RNA interactions. The latter could result, for example, from splicing, trans-splicing, reverse transcriptase template switching, or chromosomal rearrangements. Because it was difficult to obtain a representative dataset of true positive interactions, we adopted a computational approach to distinguish true from false positives. Specifically, we assume that true positive miRNA–mRNA interactions can be distinguished from false positives by the following characteristics:<table-wrap id="t0010" position="float"><table frame="hsides" rules="groups"><tbody><tr><td>(1)</td><td>Average predicted folding energy of chimeras (stronger folding expected in true positives);</td></tr><tr><td>(2)</td><td>Fraction of miRNA–mRNA chimeras with seed match between miRNA and mRNA (larger fraction expected in true positives).</td></tr><tr><td>(3)</td><td>Fraction of chimeras with no gap or overlap between the two fragments (larger fraction expected in true positives).</td></tr><tr><td>(4)</td><td>Upregulation of the target mRNA following experimental depletion of the corresponding miRNA.</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="s0105">
      <label>4.2</label>
      <title>Recovery of simulated fusion and nonfusion reads</title>
      <p>We constructed an in silico microRNA–mRNA fusion dataset to evaluate the performance of hyb. 10,000 30-nucleotide segments of mature mRNAs were extracted from Refseq and concatenated with mature microRNA sequences from miRBase. 84–91% of chimeras were recovered by hyb using default parameters depending on the aligner used. Blastn recovered the fewest, and pblat the most chimeras. Most reads not recovered were seen to align to more than 10 entries so were excluded by hyb; this is due to multiple transcripts for some genes being present in the database. Additionally, several mRNA fragments had sequences flanking the breakpoint which matched the end of the microRNA they were concatenated to, giving the alignments a larger overlap than allowed by hyb with default settings.</p>
      <p>Conversely, when 50-nucleotide segments of mature mRNAs from Refseq were analysed, no chimeras were called. This was expected, since the 50-nucleotide segments are mapped contiguously to mRNA sequences in the database.</p>
    </sec>
    <sec id="s0110">
      <label>4.3</label>
      <title>Optimization of preprocessing parameters</title>
      <p>We first aimed to establish optimal parameters for read preprocessing by comparing two read trimming programs (fastx-clipper and flexbar), with a range of 3′ adapter (linker) length and base quality thresholds. Flexbar with a 4-nucleotide linker length cutoff and base quality cutoffs between 0 and 30 gave reliable results. Fewer chimeras were recovered using fastx-clipper with low linker length cutoffs (<xref rid="f0015" ref-type="fig">Fig. 3</xref>), probably because transcript sequences were mis-identified as linkers and truncated. Conversely, up to ten percent more chimeras were found when the linker removal step was omitted. However, such excess chimeras were typically incorrect, as evidenced by their significantly weaker predicted folding (not shown), and by the fact that mapped regions of such chimeras frequently extended into the linker. Incorrect chimeras were also observed when the linker removal criteria were too stringent. Trimming reads to remove low-quality bases at the end reduced the numbers of chimeras by a few percent, but it did not increase the mean folding energy of chimeras detected.</p>
    </sec>
    <sec id="s0115">
      <label>4.4</label>
      <title>Optimization of mapping parameters</title>
      <p>The choice of the mapping program had a large effect on the time of analysis (<xref rid="f0020" ref-type="fig">Fig. 4</xref>). For a test dataset of ∼34 million reads, including ∼100 thousand chimeras, total hyb analysis times ranged from less than one hour to 15 h in wall-clock time. Bowtie2 was the fastest mapping program, followed by pblat, whereas blastn and blastall were slowest. However, blastn and blastall each recovered 5–10% more chimeras than bowtie2. To check whether the choice of mapping program affected the reliability of chimeras, we performed more detailed analyses of the chimeras recovered with each program. The distributions of folding energies and counts of seed-mediated interactions were similar for all programs tested (<xref rid="f0025" ref-type="fig">Fig. 5</xref>a, b). All the programs identified similar sets of chimeras, and the majority of chimeras were identified by each of the mapping programs (<xref rid="f0025" ref-type="fig">Fig. 5</xref>c, d). When compared to the other read aligners, blat yielded slightly more chimeras with no gap or overlap between the two fragments, suggesting that it may be the method of choice when precise identification of ligation sites is required (not shown).</p>
      <p>We also tested how the choice of mapping program influenced the degree to which the targets recovered for individual miRNAs are upregulated upon miRNA inhibition. We used two miRNA inhibition datasets: one with simultaneous depletion of 25 miRNAs <xref rid="b0040" ref-type="bibr">[8]</xref> and one with depletion of miR-92a <xref rid="b0055" ref-type="bibr">[11]</xref>. In each of the miRNA inhibition datasets, targets recovered by bowtie2 appeared to be most strongly upregulated, albeit the difference with the other programs is not statistically significant. However, cutoff e-value has an effect in this test (see below).</p>
    </sec>
    <sec id="s0120">
      <label>4.5</label>
      <title>Optimization of chimera calling parameters</title>
      <p>We tested the impact of chimera calling options on the number and reliability of interactions recovered. Reliability was estimated from average folding energy, proportion of seed interactions, proportion of chimeras in which both fragments were directly adjacent in the read, and the extent of target upregulation upon mRNA depletion. Of all the parameters examined, the chimera e-value threshold (hval) had the largest effect (<xref rid="f0030" ref-type="fig">Fig. 6</xref>). Chimeras recovered with hval &lt; 0.01 scored consistently higher than chimeras recovered with lower stringency. However, the number of chimeras recovered was lower by 20% with hval = 0.01, as compared to hval = 0.1. The optimum allowed gap or overlap between chimera fragments (gmax) appeared to be between 2 and 4. Lower or higher values tended to decrease the number of chimeras or decrease their reliability. Surprisingly, a cutoff of gmax = 0 also resulted in a lower fraction of seed interactions and lower upregulation of inferred targets. Disabling the mRNA–miRNA chimera preference decreased the number of called chimeras by 6%, but it did not consistently improve chimera quality. Disabling the preference of abundantly recovered transcripts (Section <xref rid="s0060" ref-type="sec">3.3.3</xref>) had no effect on the number or quality of chimeras.</p>
    </sec>
    <sec id="s0125">
      <label>4.6</label>
      <title>Influence of read and insert lengths</title>
      <p>Applying hyb to the data from Helwak et al. <xref rid="b0055" ref-type="bibr">[11]</xref>, we noticed that the same cDNA library (E4) yields a much larger fraction of chimeras when sequenced with 100 nucleotide-long reads than with 55-nt reads. This prompted us to examine the effect of RNA insert length on the recovery of chimeras. As expected, very few chimeras can be found in cDNAs of 35 nt or shorter, and the fraction of chimeras increases to more than ten percent when inserts of 80 nt or longer are considered (<xref rid="f0035" ref-type="fig">Fig. 7</xref>). The fraction of miRNA–mRNA chimeras among all reads also increases steadily with RNA insert length. We therefore recommend using 40 nt as minimum RNA insert length and 75 nt as the minimum read length in CLASH experiments.</p>
    </sec>
    <sec id="s0130">
      <label>4.7</label>
      <title>Mapping chimeras with TopHat2 fusion</title>
      <p>We compared hyb with the TopHat2 fusion-search algorithm, the most widely used tool for detecting fusion transcripts due to chromosomal rearrangements <xref rid="b0140" ref-type="bibr">[28]</xref>. TopHat2’s fusion-search utilises Bowtie2, first storing initially unmapped reads which cannot be aligned to the genome end-to-end. These reads are cut into segments (default 25 bp), and individually aligned to the genome end-to-end. Reads with segments mapping to separate chromosomes, or further than 100 kb apart on the same chromosome are used to find the exact fusion point and create ‘spliced fusion contigs’. The initially unmapped reads are then re-aligned to these spliced fusion contigs with fusions being called if at least one alignment is spanning the read. We applied TopHat2 fusion-search to the E4 dataset from Helwak et al. <xref rid="b0055" ref-type="bibr">[11]</xref> using segment lengths of 20 bp aligning to the human genome hg19. This identified 8231 microRNA–mRNA hybrids, in silico folding of which found the mean folding energy to be −10.3 kcal/mol, as compared with −8.7 kcal/mol with the miRNA–mRNA pairs were randomly re-associated (shuffled). By contrast, the mean folding energy of chimeras recovered with hyb was much lower: −18.2 kcal/mol from 13,493 hybrids (<xref rid="f0040" ref-type="fig">Fig. 8</xref>). This suggests that Tophat2 fusion identifies many chimeras that do not originate from RNA–RNA interactions. We hypothesize that many microRNA-containing reads are not aligned when Tophat2 cuts reads to fixed length segments followed by end-to-end mapping.</p>
    </sec>
  </sec>
  <sec id="s0135">
    <label>5</label>
    <title>Application of hyb to CRAC, CLIP and RNA-Seq data</title>
    <p>Chimeric reads corresponding to <italic>bona fide</italic> RNA–RNA interactions have previously been found in sequencing data generated by CRAC <xref rid="b0060" ref-type="bibr">[12]</xref>. Although CRAC was not explicitly designed to ligate RNA–RNA hybrids and generate chimeras, we believe that chimeric RNAs are formed fortuitously during the 3′ linker addition step. This raises the question whether CLIP-Seq datasets might also contain chimeras indicative of RNA–RNA interaction. We have examined four AGO CLIP-Seq datasets <xref rid="b0035 b0040 b0045 b0065" ref-type="bibr">[7–9,13]</xref>, and found very few examples of microRNA–mRNA chimeras. There are several possible explanations why almost no chimeric reads are found in the CLIP-Seq data we analysed. First, reads used in each of the CLIP datasets are only 32–39 nt in length, which might preclude the identification of chimeras. Second, some CLIP protocols include polyacrylamide gel purification of AGO–RNA complexes before linker ligation. Non-crosslinked RNAs will most likely be lost during electrophoresis, transfer to nitrocellulose membrane, or proteinase K treatment of the membrane. Any of these events would result in the loss of RNA–RNA duplexes before chimeras can be formed. By contrast, in CRAC and CLASH protocols ligation precedes electrophoresis, making it possible to recover RNA–RNA duplexes as chimeric sequences.</p>
    <p>In principle, hyb can also be applied to RNA-Seq data, and our initial analyses recovered significant numbers of chimeric sequences in RNA-Seq datasets. To assess the biological significance of such chimeras, we applied hyb to RNA-Seq data from HEK293 cells, used previously to discover circular RNAs <xref rid="b0065" ref-type="bibr">[13]</xref>. Memczak et al. used an algorithm which identified head-to-tail (acceptor site followed by donor site) splice junctions by taking 20 bp from the termini of unaligned reads to map independently and screen for unique mappings which could be extended to cover the read with the breakpoint flanked by canonical splice sites. We applied hyb with alignment by blastall to reads annotated by Memczak et al. as covering 239 head-to-tail splice junctions. Aligning to the genome we identified 190 of these circular RNAs at the same location as Memczak et al. However, in aligning to our transcriptome database we identified reads corresponding to 32 circular RNAs which aligned to a transcript variant along at least 65-nucleotides of the 80-nucleotide read, such that the remaining read fragment could not be uniquely mapped. This suggests that some of the 239 candidate circular RNAs were variants of alternative splicing. Of the 26 circRNAs not identified as hybrid reads or seen with alignments across &gt;65 nt, 5 were excluded due to gaps of &gt;4 nucleotides between the alignments and the remaining 21 had better scoring individual alignments than each of those which would form a hybrid, and are therefore not called by hyb. We conclude that hyb can be used to reliably identify chimeric reads in CLASH, as well as in other next-generation sequencing datasets.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Filipowicz</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>S.N.</given-names>
          </name>
          <name>
            <surname>Sonenberg</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <source>Nat. Rev. Genet.</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>102</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="pmid">18197166</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Aravin</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Brennecke</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <source>Science</source>
        <volume>318</volume>
        <year>2007</year>
        <fpage>761</fpage>
        <lpage>764</lpage>
        <pub-id pub-id-type="pmid">17975059</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Maquat</surname>
            <given-names>L.E.</given-names>
          </name>
        </person-group>
        <source>Nature</source>
        <volume>470</volume>
        <year>2011</year>
        <fpage>284</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="pmid">21307942</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Aiba</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <source>Curr. Opin. Microbiol.</source>
        <volume>10</volume>
        <year>2007</year>
        <fpage>134</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="pmid">17383928</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Licatalosi</surname>
            <given-names>D.D.</given-names>
          </name>
          <name>
            <surname>Mele</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fak</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Ule</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kayikci</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chi</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T.A.</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Blume</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>R.B.</given-names>
          </name>
        </person-group>
        <source>Nature</source>
        <volume>456</volume>
        <year>2008</year>
        <fpage>464</fpage>
        <lpage>469</lpage>
        <pub-id pub-id-type="pmid">18978773</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Ule</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>K.B.</given-names>
          </name>
          <name>
            <surname>Ruggiu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mele</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ule</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>R.B.</given-names>
          </name>
        </person-group>
        <source>Science</source>
        <volume>302</volume>
        <year>2003</year>
        <fpage>1212</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="pmid">14615540</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Chi</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Zang</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Mele</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>R.B.</given-names>
          </name>
        </person-group>
        <source>Nature</source>
        <volume>460</volume>
        <year>2009</year>
        <fpage>479</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="pmid">19536157</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Hafner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Landthaler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Burger</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Khorshid</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hausser</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Berninger</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Rothballer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ascano</surname>
            <given-names>M.</given-names>
            <suffix>Jr.</suffix>
          </name>
          <name>
            <surname>Jungkamp</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Munschauer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ulrich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wardle</surname>
            <given-names>G.S.</given-names>
          </name>
          <name>
            <surname>Dewell</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tuschl</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <source>Cell</source>
        <volume>141</volume>
        <year>2010</year>
        <fpage>129</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">20371350</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>A.G.</given-names>
          </name>
          <name>
            <surname>Bhutkar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>G.X.</given-names>
          </name>
          <name>
            <surname>Bosson</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>P.A.</given-names>
          </name>
        </person-group>
        <source>Nat. Struct. Mol. Biol.</source>
        <volume>18</volume>
        <year>2011</year>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">21258322</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Chi</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>R.B.</given-names>
          </name>
        </person-group>
        <source>Nat. Struct. Mol. Biol.</source>
        <volume>19</volume>
        <year>2012</year>
        <fpage>321</fpage>
        <lpage>327</lpage>
        <pub-id pub-id-type="pmid">22343717</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Helwak</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kudla</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Dudnakova</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Tollervey</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <source>Cell</source>
        <volume>153</volume>
        <year>2013</year>
        <fpage>654</fpage>
        <lpage>665</lpage>
        <pub-id pub-id-type="pmid">23622248</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Kudla</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Granneman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Beggs</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Tollervey</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>108</volume>
        <year>2011</year>
        <fpage>10010</fpage>
        <lpage>10015</lpage>
        <pub-id pub-id-type="pmid">21610164</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Memczak</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Jens</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Elefsinioti</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Torti</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Krueger</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rybak</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Maier</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Mackowiak</surname>
            <given-names>S.D.</given-names>
          </name>
          <name>
            <surname>Gregersen</surname>
            <given-names>L.H.</given-names>
          </name>
          <name>
            <surname>Munschauer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Loewer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ziebold</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Landthaler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kocks</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>le Noble</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <source>Nature</source>
        <volume>495</volume>
        <year>2013</year>
        <fpage>333</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="pmid">23446348</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>T.B.</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>T.I.</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>B.H.</given-names>
          </name>
          <name>
            <surname>Bramsen</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Finsen</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Damgaard</surname>
            <given-names>C.K.</given-names>
          </name>
          <name>
            <surname>Kjems</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <source>Nature</source>
        <volume>495</volume>
        <year>2013</year>
        <fpage>384</fpage>
        <lpage>388</lpage>
        <pub-id pub-id-type="pmid">23446346</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Field</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Houten</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Swan</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Thurston</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <source>Nat. Biotechnol.</source>
        <volume>24</volume>
        <year>2006</year>
        <fpage>801</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="pmid">16841067</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <mixed-citation publication-type="other" id="h0080">S. Andrews, &lt;http://www.bioinformatics.babraham.ac.uk/projects/fastqc/&gt;, 2010.</mixed-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Dodt</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Roehr</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Dieterich</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <source>MDPI Biol.</source>
        <volume>1</volume>
        <year>2012</year>
        <fpage>895</fpage>
        <lpage>905</lpage>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <source>Nat. Methods</source>
        <volume>9</volume>
        <year>2012</year>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E.W.</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D.J.</given-names>
          </name>
        </person-group>
        <source>J. Mol. Biol.</source>
        <volume>215</volume>
        <year>1990</year>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Markham</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <source>Methods Mol. Biol.</source>
        <volume>453</volume>
        <year>2008</year>
        <fpage>3</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="pmid">18712296</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Honer Zu Siederdissen</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tafer</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>P.F.</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>I.L.</given-names>
          </name>
        </person-group>
        <source>Algorithms Mol. Biol.</source>
        <volume>6</volume>
        <year>2011</year>
        <fpage>26</fpage>
        <pub-id pub-id-type="pmid">22115189</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Granneman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kudla</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Petfalski</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Tollervey</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>106</volume>
        <year>2009</year>
        <fpage>9613</fpage>
        <lpage>9618</lpage>
        <pub-id pub-id-type="pmid">19482942</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Wlotzka</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Kudla</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Granneman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tollervey</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <source>EMBO J.</source>
        <volume>30</volume>
        <year>2011</year>
        <fpage>1790</fpage>
        <lpage>1803</lpage>
        <pub-id pub-id-type="pmid">21460797</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>R.B.</given-names>
          </name>
        </person-group>
        <source>Nat. Biotechnol.</source>
        <volume>29</volume>
        <year>2011</year>
        <fpage>607</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="pmid">21633356</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>I.M.</given-names>
          </name>
        </person-group>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <year>2010</year>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Rost</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Yachdav</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <source>Nucleic Acids Res.</source>
        <volume>32</volume>
        <year>2004</year>
        <fpage>W321</fpage>
        <lpage>W326</lpage>
        <pub-id pub-id-type="pmid">15215403</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>S.D.</given-names>
          </name>
          <name>
            <surname>Schein</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Birol</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <source>Genome Res.</source>
        <volume>19</volume>
        <year>2009</year>
        <fpage>1117</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <source>Genome Biol.</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>R72</fpage>
        <pub-id pub-id-type="pmid">21835007</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <mixed-citation publication-type="other" id="h0145">J.C. Oliveros, &lt;<ext-link ext-link-type="uri" xlink:href="http://bioinfogp.cnb.csic.es/tools/venny/index.html/" id="ir0080">http://bioinfogp.cnb.csic.es/tools/venny/index.html</ext-link>/&gt;, 2007.</mixed-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <mixed-citation publication-type="other" id="h0165">A.H. Gordon, G.J. Hannon, &lt;<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/" id="ir0085">http://hannonlab.cshl.edu/fastx_toolkit</ext-link>/&gt;, 2010.</mixed-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <source>Genome Res.</source>
        <volume>12</volume>
        <year>2002</year>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <mixed-citation publication-type="other" id="h0160">M. Wang, &lt;<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/pblat/" id="ir0090">http://code.google.com/p/pblat</ext-link>/&gt;, 2012.</mixed-citation>
    </ref>
  </ref-list>
  <ack id="ak005">
    <title>Acknowledgments</title>
    <p>A.J.T. was supported by the <funding-source id="gp005">BBSRC</funding-source> Grant BB/J001279/1 awarded to D.T. and Amy Buck. J.M. and G.K. were supported by the <funding-source id="gp010">Wellcome Trust</funding-source> Grant 097383 to G.K., and A.H. and D.T. were supported by the Wellcome Trust Grant 077248 to D.T. Research in the Kudla lab is supported by the MRC. The authors gratefully acknowledge discussions with Sander Granneman and Amy Buck.</p>
  </ack>
  <fn-group>
    <fn id="d32e1012">
      <label>☆</label>
      <p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f0005">
    <label>Fig. 1</label>
    <caption>
      <p>Schematic of CLASH experiment and hyb analysis pipeline.</p>
    </caption>
    <graphic xlink:href="gr1"/>
  </fig>
  <fig id="f0010">
    <label>Fig. 2</label>
    <caption>
      <p>Processing of 5′ barcodes. The multiplexing parts of barcodes are used to split input data into appropriate files, whereas the random parts of barcodes are used to monitor PCR amplification artefacts. The sequence identifiers (FASTA headers) of collapsed reads are in the format “<italic>K</italic>-<italic>L</italic>_<italic>M</italic>”, where <italic>K</italic> is the frequency rank of the sequence in the input file, <italic>L</italic> is the number of unique random barcodes associated with the sequence, and <italic>M</italic> is the number of times the sequence has been found in the input file. When 5′ barcodes are absent, the identifiers of collapsed reads are in the format “<italic>K</italic>_<italic>M</italic>”.</p>
    </caption>
    <graphic xlink:href="gr2"/>
  </fig>
  <fig id="f0015">
    <label>Fig. 3</label>
    <caption>
      <p>Benchmarking of preprocessing and mapping parameters. Numbers of miRNA–mRNA chimeras recovered from the E6 test dataset (from Ref. <xref rid="b0055" ref-type="bibr">[11]</xref>) as a function of preprocessing and mapping parameters. The following parameters were explored: the choice of adapter trimming program (flexbar or fastx-clipper), the choice of mapping program (blastall, blastn, blat, pblat, bowtie2), the base quality threshold (0, 10, 20, or 30), and linker length threshold (4, or 0 which indicates no linker trimming).</p>
    </caption>
    <graphic xlink:href="gr3"/>
  </fig>
  <fig id="f0020">
    <label>Fig. 4</label>
    <caption>
      <p>Effects of preprocessing and mapping parameters on analysis times. Data and parameter choices as in <xref rid="f0015" ref-type="fig">Fig. 3</xref>.</p>
    </caption>
    <graphic xlink:href="gr4"/>
  </fig>
  <fig id="f0025">
    <label>Fig. 5</label>
    <caption>
      <p>Characteristics of chimeras recovered as a function of the mapping program used. (a) Distribution of folding energies of miRNA–mRNA chimeras identified with blastall, blastn, blat, and bowtie2. (b) Types of RNA–RNA interactions recovered with each mapping program. (c) Numbers of chimeras recovered with different combinations of mapping programs, analysed with VENNY <xref rid="b0145" ref-type="bibr">[29]</xref>. A total of 12762 interactions are found with all four mapping programs, whereas 21537 interactions are found with at least one of the programs. (d) Fractions of chimeras recovered with one or more, two or more, three or more, and four mapping programs, respectively. Analyses were performed on dataset E4 (Ref. <xref rid="b0055" ref-type="bibr">[11]</xref>), with the following parameters: trim = 0 filt = 0 min = 4 len = 17.</p>
    </caption>
    <graphic xlink:href="gr5"/>
  </fig>
  <fig id="f0030">
    <label>Fig. 6</label>
    <caption>
      <p>Benchmarking of chimera-calling options. Dataset E4 was analysed with default parameter values, except for the indicated options, which were individually changed. The resulting chimera counts and quality parameters are reported. The percent log2 transcript enrichment values used in the bottom panel are from <xref rid="b0040" ref-type="bibr">[8]</xref>.</p>
    </caption>
    <graphic xlink:href="gr6"/>
  </fig>
  <fig id="f0035">
    <label>Fig. 7</label>
    <caption>
      <p>Numbers of chimeric and non-chimeric reads as a function of read length. Dataset E4 was analysed with default parameters.</p>
    </caption>
    <graphic xlink:href="gr7"/>
  </fig>
  <fig id="f0040">
    <label>Fig. 8</label>
    <caption>
      <p>Comparison of hyb and tophat fusion. Distribution of folding energies of miRNA–mRNA chimeras recovered with hyb, tophat fusion, and in randomly re-associated miRNA–mRNA pairs from the tophat fusion analysis.</p>
    </caption>
    <graphic xlink:href="gr8"/>
  </fig>
  <table-wrap id="t0015" position="float">
    <label>Table 1</label>
    <caption>
      <p>External dependencies of the hyb pipeline.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th>Package name</th>
          <th>Reference</th>
          <th>URL</th>
          <th>Programs used</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="3">FASTX Toolkit</td>
          <td rowspan="3">
            <xref rid="b0150" ref-type="bibr">[30]</xref>
          </td>
          <td rowspan="3">
            <ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/" id="ir0030">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>
          </td>
          <td>Fastq_quality_trimmer</td>
        </tr>
        <tr>
          <td>Fastq_quality_filter</td>
        </tr>
        <tr>
          <td>Fastx_clipper</td>
        </tr>
        <tr>
          <td>Flexbar</td>
          <td>
            <xref rid="b0085" ref-type="bibr">[17]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/flexbar/" id="ir0035">http://sourceforge.net/projects/flexbar/</ext-link>
          </td>
          <td>Flexbar</td>
        </tr>
        <tr>
          <td>FastQC</td>
          <td>
            <xref rid="b0080" ref-type="bibr">[16]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" id="ir0040">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>
          </td>
          <td>Fastqc</td>
        </tr>
        <tr>
          <td rowspan="2">BLAST</td>
          <td rowspan="2">
            <xref rid="b0095" ref-type="bibr">[19]</xref>
          </td>
          <td rowspan="2">
            <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/guide/data-software/" id="ir0045">http://www.ncbi.nlm.nih.gov/guide/data-software/</ext-link>
          </td>
          <td>Blastall (legacy BLAST)</td>
        </tr>
        <tr>
          <td>Blastn (BLAST+)</td>
        </tr>
        <tr>
          <td>BLAT</td>
          <td>
            <xref rid="b0155" ref-type="bibr">[31]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://users.soe.ucsc.edu/~kent/src/blatSrc35.zip" id="ir0050">http://users.soe.ucsc.edu/~kent/src/blatSrc35.zip</ext-link>
          </td>
          <td>Blat</td>
        </tr>
        <tr>
          <td>PBLAT</td>
          <td>
            <xref rid="b0160" ref-type="bibr">[32]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/pblat/" id="ir0055">http://code.google.com/p/pblat/</ext-link>
          </td>
          <td>Pblat</td>
        </tr>
        <tr>
          <td>Bowtie2</td>
          <td>
            <xref rid="b0090" ref-type="bibr">[18]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://bowtie-bio.sourceforge.net/bowtie2/" id="ir0060">http://bowtie-bio.sourceforge.net/bowtie2/</ext-link>
          </td>
          <td>Bowtie2</td>
        </tr>
        <tr>
          <td>Unafold</td>
          <td>
            <xref rid="b0100" ref-type="bibr">[20]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://mfold.rna.albany.edu/" id="ir0065">http://mfold.rna.albany.edu/</ext-link>
          </td>
          <td>Hybrid-min</td>
        </tr>
        <tr>
          <td>Vienna</td>
          <td>
            <xref rid="b0105" ref-type="bibr">[21]</xref>
          </td>
          <td>
            <ext-link ext-link-type="uri" xlink:href="http://www.tbi.univie.ac.at/~ronny/RNA/RNAup.html" id="ir0070">http://www.tbi.univie.ac.at/~ronny/RNA/RNAup.html</ext-link>
          </td>
          <td>RNAup</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="t0020" position="float">
    <label>Table 2</label>
    <caption>
      <p>Default settings used for read alignment.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th>Program</th>
          <th>Command line arguments</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Blastall</td>
          <td>-p blastn -W 11 -e 0.1 -m 8</td>
        </tr>
        <tr>
          <td>Blastn</td>
          <td>-Evalue 0.1 -num_threads 16 -word_size 11 -outfmt 6</td>
        </tr>
        <tr>
          <td>Blat</td>
          <td>-Stepsize = 5 -tileSize = 11 -minScore = 15 -out = blast8</td>
        </tr>
        <tr>
          <td>Pblat</td>
          <td>-Stepsize = 5 -tileSize = 11 -minScore = 15 -out = blast8</td>
        </tr>
        <tr>
          <td>Bowtie2</td>
          <td>-D 20 -R 3 -N 0 -L 16 -k 20 --local -i S,1,0.50 --score-min L,18,0 --ma 1 --np 0 --mp 2,2 --rdg 5,1 --rfg 5,1</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="t0025" position="float">
    <label>Table 3</label>
    <caption>
      <p>Example .hyb dataset.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <tbody>
        <tr>
          <td>44480_39</td>
          <td>TGAGGTAG...</td>
          <td align="char">−12.1</td>
          <td>let-7b</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>ACTB</td>
          <td align="char">22</td>
          <td align="char">44</td>
          <td align="char">1614</td>
          <td align="char">1636</td>
          <td align="char">4e-05</td>
        </tr>
        <tr>
          <td>72356_23</td>
          <td>TGAGGTAG...</td>
          <td align="char">−21.2</td>
          <td>let-7a</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>CCNB2</td>
          <td align="char">23</td>
          <td align="char">49</td>
          <td align="char">399</td>
          <td align="char">425</td>
          <td align="char">2e-07</td>
        </tr>
        <tr>
          <td>77750_22</td>
          <td>ACTCTGTC...</td>
          <td align="char">−21.2</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">27</td>
          <td align="char">1882</td>
          <td align="char">1908</td>
          <td align="char">2e-07</td>
          <td>let-7a</td>
          <td align="char">28</td>
          <td align="char">49</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>160269_10</td>
          <td>TCCAACCT...</td>
          <td align="char">−18.7</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">20</td>
          <td align="char">1888</td>
          <td align="char">1907</td>
          <td align="char">0.003</td>
          <td>let-7a</td>
          <td align="char">21</td>
          <td align="char">42</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>175997_9</td>
          <td>TGAGGTAG...</td>
          <td align="char">−23</td>
          <td>let-7b</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">3e-04</td>
          <td>BAZ1B</td>
          <td align="char">23</td>
          <td align="char">60</td>
          <td align="char">916</td>
          <td align="char">953</td>
          <td align="char">8e-14</td>
        </tr>
        <tr>
          <td>176006_9</td>
          <td>TGAGGTAG...</td>
          <td align="char">−16.8</td>
          <td>let-7a</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>WIPI2</td>
          <td align="char">21</td>
          <td align="char">47</td>
          <td align="char">2704</td>
          <td align="char">2730</td>
          <td align="char">2e-07</td>
        </tr>
        <tr>
          <td>180999_9</td>
          <td>GTGAGGTA...</td>
          <td align="char">−12.1</td>
          <td>let-7a</td>
          <td align="char">2</td>
          <td align="char">21</td>
          <td align="char">1</td>
          <td align="char">20</td>
          <td align="char">0.003</td>
          <td>ZNF629</td>
          <td align="char">22</td>
          <td align="char">47</td>
          <td align="char">3264</td>
          <td align="char">3289</td>
          <td align="char">8e-07</td>
        </tr>
        <tr>
          <td>193821_9</td>
          <td>AATTCCCC...</td>
          <td align="char">−14.2</td>
          <td>ARPP19</td>
          <td align="char">1</td>
          <td align="char">26</td>
          <td align="char">4702</td>
          <td align="char">4727</td>
          <td align="char">8e-07</td>
          <td>let-7b</td>
          <td align="char">27</td>
          <td align="char">48</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>199610_8</td>
          <td>TCTGTCCA...</td>
          <td align="char">−21.2</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">24</td>
          <td align="char">1884</td>
          <td align="char">1907</td>
          <td align="char">1e-05</td>
          <td>let-7a</td>
          <td align="char">25</td>
          <td align="char">46</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>211629_8</td>
          <td>CTCTGTCC...</td>
          <td align="char">−21.2</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">25</td>
          <td align="char">1883</td>
          <td align="char">1907</td>
          <td align="char">3e-06</td>
          <td>let-7a</td>
          <td align="char">26</td>
          <td align="char">47</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>220663_8</td>
          <td>AGCCACCA...</td>
          <td align="char">−16</td>
          <td>BAG4</td>
          <td align="char">1</td>
          <td align="char">41</td>
          <td align="char">546</td>
          <td align="char">586</td>
          <td align="char">1e-15</td>
          <td>let-7b</td>
          <td align="char">42</td>
          <td align="char">63</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">3e-04</td>
        </tr>
        <tr>
          <td>220664_8</td>
          <td>AGCCACCA...</td>
          <td align="char">−17.8</td>
          <td>NME4</td>
          <td align="char">1</td>
          <td align="char">29</td>
          <td align="char">724</td>
          <td align="char">752</td>
          <td align="char">1e-08</td>
          <td>let-7b</td>
          <td align="char">30</td>
          <td align="char">51</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>221833_8</td>
          <td>ACTCTGTC...</td>
          <td align="char">−21.2</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">26</td>
          <td align="char">1882</td>
          <td align="char">1907</td>
          <td align="char">8e-07</td>
          <td>let-7a</td>
          <td align="char">27</td>
          <td align="char">48</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>224142_8</td>
          <td>AATCCACA...</td>
          <td align="char">−17.6</td>
          <td>IPO7</td>
          <td align="char">1</td>
          <td align="char">26</td>
          <td align="char">2519</td>
          <td align="char">2544</td>
          <td align="char">8e-07</td>
          <td>let-7b</td>
          <td align="char">27</td>
          <td align="char">48</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>226595_8</td>
          <td>AAACCAGA...</td>
          <td align="char">−18.3</td>
          <td>SNUPN</td>
          <td align="char">1</td>
          <td align="char">21</td>
          <td align="char">663</td>
          <td align="char">683</td>
          <td align="char">7e-04</td>
          <td>let-7c</td>
          <td align="char">22</td>
          <td align="char">43</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>228636_7</td>
          <td>TTCCAATA...</td>
          <td align="char">−16</td>
          <td>LTA4H</td>
          <td align="char">1</td>
          <td align="char">28</td>
          <td align="char">655</td>
          <td align="char">682</td>
          <td align="char">6e-08</td>
          <td>let-7a</td>
          <td align="char">29</td>
          <td align="char">50</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
        <tr>
          <td>231753_7</td>
          <td>TGAGGTAG...</td>
          <td align="char">−22.2</td>
          <td>let-7b</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>TSPAN3</td>
          <td align="char">23</td>
          <td align="char">49</td>
          <td align="char">1175</td>
          <td align="char">1201</td>
          <td align="char">2e-07</td>
        </tr>
        <tr>
          <td>231779_7</td>
          <td>TGAGGTAG...</td>
          <td align="char">−18.9</td>
          <td>let-7e</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>NCBP1</td>
          <td align="char">22</td>
          <td align="char">48</td>
          <td align="char">1657</td>
          <td align="char">1683</td>
          <td align="char">2e-07</td>
        </tr>
        <tr>
          <td>231783_7</td>
          <td>TGAGGTAG...</td>
          <td align="char">−21.6</td>
          <td>let-7e</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
          <td>RPL27A</td>
          <td align="char">20</td>
          <td align="char">40</td>
          <td align="char">1334</td>
          <td align="char">1354</td>
          <td align="char">7e-04</td>
        </tr>
        <tr>
          <td>236865_7</td>
          <td>TCCAACCT...</td>
          <td align="char">−18.7</td>
          <td>EIF2C1</td>
          <td align="char">1</td>
          <td align="char">21</td>
          <td align="char">1888</td>
          <td align="char">1908</td>
          <td align="char">7e-04</td>
          <td>let-7a</td>
          <td align="char">22</td>
          <td align="char">43</td>
          <td align="char">1</td>
          <td align="char">22</td>
          <td align="char">2e-04</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>Column 1, unique sequence identifier.</p>
        <p>Column 2, read sequence (truncated here for clarity).</p>
        <p>Column 3, predicted binding energy in kcal/mol.</p>
        <p>Columns 4–9, mapping information for first fragment of read: name of matched transcript, coordinates in read, coordinates in transcript, mapping score.</p>
        <p>Columns 10–15, mapping information for second fragment of read.</p>
        <p>Column 16 (optional, not shown here), list of annotations in the format: “feature1=value1; feature2=value2;..."</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
