<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805580</article-id>
    <article-id pub-id-type="pmid">36440922</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac752</article-id>
    <article-id pub-id-type="publisher-id">btac752</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AptaMat: a matrix-based algorithm to compare single-stranded oligonucleotides secondary structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Binet</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Université de technologie de Compiègne, UPJV, CNRS, Enzyme and Cell Engineering, Centre de recherche Royallieu, CS 60 319 - 60 203, Compiègne Cedex</institution>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Avalle</surname>
          <given-names>Bérangère</given-names>
        </name>
        <aff><institution>Université de technologie de Compiègne, UPJV, CNRS, Enzyme and Cell Engineering, Centre de recherche Royallieu, CS 60 319 - 60 203, Compiègne Cedex</institution>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Dávila Felipe</surname>
          <given-names>Miraine</given-names>
        </name>
        <aff><institution>Université de technologie de Compiègne, LMAC (Laboratory of Applied Mathematics of Compiègne), CS 60 319 - 60 203, Compiègne Cedex</institution>, <country country="FR">France</country></aff>
        <xref rid="btac752-cor1" ref-type="corresp"/>
        <!--miraine.davila-felipe@utc.fr-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4524-1137</contrib-id>
        <name>
          <surname>Maffucci</surname>
          <given-names>Irene</given-names>
        </name>
        <aff><institution>Université de technologie de Compiègne, UPJV, CNRS, Enzyme and Cell Engineering, Centre de recherche Royallieu, CS 60 319 - 60 203, Compiègne Cedex</institution>, <country country="FR">France</country></aff>
        <xref rid="btac752-cor1" ref-type="corresp"/>
        <!--irene.maffucci@utc.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac752-cor1">To whom correspondence should be addressed. Email: <email>irene.maffucci@utc.fr</email> or <email>miraine.davila-felipe@utc.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-28">
      <day>28</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac752</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac752.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Comparing single-stranded nucleic acids (ssNAs) secondary structures is fundamental when investigating their function and evolution and predicting the effect of mutations on their structures. Many comparison metrics exist, although they are either too elaborate or not sensitive enough to distinguish close ssNAs structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In this context, we developed AptaMat, a simple and sensitive algorithm for ssNAs secondary structures comparison based on matrices representing the ssNAs secondary structures and a metric built upon the Manhattan distance in the plane. We applied AptaMat to several examples and compared the results to those obtained by the most frequently used metrics, namely the Hamming distance and the RNAdistance, and by a recently developed image-based approach. We showed that AptaMat is able to discriminate between similar sequences, outperforming all the other here considered metrics. In addition, we showed that AptaMat was able to correctly classify 14 RFAM families within a clustering procedure.</p>
      </sec>
      <sec id="s4">
        <title>Availability and implementation</title>
        <p>The python code for AptaMat is available at <ext-link xlink:href="https://github.com/GEC-git/AptaMat.git" ext-link-type="uri">https://github.com/GEC-git/AptaMat.git</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Centre National de la Recherche Scientifque</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministère de l’Enseignement Supérieur et de la Recherche</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union and FEDER</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-stranded nucleic acids (ssNAs) are interesting molecules from both a biological and a biotechnological point of view. On one side, RNA is fundamental for protein synthesis, and it has cellular structural, functional and regulatory roles. On the other side, both RNA and single-stranded DNA, in the form of aptamers, can be exploited as therapeutic or diagnostic tools or as biosensors (<xref rid="btac752-B26" ref-type="bibr">Kulabhusan <italic toggle="yes">et al.</italic>, 2020</xref>). Aptamers are, indeed, short single-stranded oligonucleotides able to bind a large variety of molecular targets with high specificity and dissociation constants in the nano- to picomolar range by adopting specific conformations (<xref rid="btac752-B27" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac752-B33" ref-type="bibr">Nimjee <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>SsNAs function highly depends on their secondary (i.e. their base pairing pattern) and tertiary (i.e. their 3D organization) structures (<xref rid="btac752-B27" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac752-B32" ref-type="bibr">Mustoe <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac752-B33" ref-type="bibr">Nimjee <italic toggle="yes">et al.</italic>, 2017</xref>), thus the computational prediction of these two levels of organization can help to understand ssNAs roles and interactions with other molecules. The prediction of the ssNAs secondary structures often precedes and guides the 3D modeling step and many tools have been developed at this scope (<xref rid="btac752-B14" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic>, 2008b</xref>; <xref rid="btac752-B36" ref-type="bibr">Sato <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btac752-B40" ref-type="bibr">Zuker, 2003</xref>). The resulting output is usually a graphical representation of the predicted secondary structure (<xref rid="btac752-F1" ref-type="fig">Fig. 1c</xref>) and/or its dot-bracket notation (<xref rid="btac752-F1" ref-type="fig">Fig. 1b</xref>), which consists in a string of the same length as the sequence based on an alphabet of three characters: {‘.’, ‘(“,”)’}. The symbol ‘.’ indicates that the nucleotide in the corresponding position is unpaired, while ‘(“and”)’ correspond to the opening and closing positions of a base pair (BP), respectively.</p>
    <fig position="float" id="btac752-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Example of representations of the secondary structure of sequence (<bold>a</bold>): dot-bracket notation (<bold>b</bold>), graphical representation realized with VARNA (<xref rid="btac752-B7" ref-type="bibr">Darty <italic toggle="yes">et al.</italic>, 2009</xref>) (<bold>c</bold>) and full tree representation (<bold>d</bold>)</p>
      </caption>
      <graphic xlink:href="btac752f1" position="float"/>
    </fig>
    <p>The comparison of ssNAs secondary structures is a task of considerable importance. Comparing ssNAs structures can help to study the function and evolution of ssNAs, to design nucleotide sequences that fold into a given secondary structure, facing the task of inverse folding, in order to optimize ssNAs properties, but also to guide the computational detection of new non-coding RNAs (<xref rid="btac752-B6" ref-type="bibr">Churkin <italic toggle="yes">et al.</italic>, 2018</xref>). In addition, ssNAs structures comparison can assist the prediction of mutations that can cause a conformational rearrangement (<xref rid="btac752-B2" ref-type="bibr">Barash and Churkin, 2011</xref>). Therefore, different algorithms have been developed at this scope (see <xref rid="btac752-B13" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic> (2008a</xref>) for a review). Briefly, these can be classified in algorithms (i) based on the minimum free energy (<xref rid="btac752-B38" ref-type="bibr">Washietl <italic toggle="yes">et al.</italic>, 2005</xref>), (ii) based on a single structure (<xref rid="btac752-B8" ref-type="bibr">Flamm <italic toggle="yes">et al.</italic>, 2001</xref>; <xref rid="btac752-B9" ref-type="bibr">Fontana <italic toggle="yes">et al.</italic>, 1993</xref>; <xref rid="btac752-B31" ref-type="bibr">Moulton <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="btac752-B37" ref-type="bibr">Shapiro <italic toggle="yes">et al.</italic>, 1988</xref>) and (iii) considering the whole folding space (<xref rid="btac752-B4" ref-type="bibr">Bonhoeffer <italic toggle="yes">et al.</italic>, 1993</xref>; <xref rid="btac752-B12" ref-type="bibr">Giegerich <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btac752-B20" ref-type="bibr">Hofacker <italic toggle="yes">et al.</italic>, 1994</xref>). Among them, the most frequently applied are those working on single structures, such as the Hamming distance (<xref rid="btac752-B17" ref-type="bibr">Hamming, 1950</xref>), the BP distance and the RNAdistance algorithm implemented in the Vienna package (<xref rid="btac752-B19" ref-type="bibr">Hofacker, 2003</xref>). The Hamming distance allows the comparison of two strings of the same length by counting the number of positions with different symbols. It is one of the simplest metrics used in the context of ssNAs, and it is usually calculated by counting the number of positions with different nucleotides (<xref rid="E3" ref-type="disp-formula">Equation 3</xref>). It can be adapted to strings in the dot-bracket notation, which is more suitable for secondary structures comparison. Conversely, the default RNAdistance implemented in the Vienna package is based on the comparison of ssNAs secondary structures represented as ordered rooted trees in a full resolution (<xref rid="btac752-F1" ref-type="fig">Fig. 1d</xref>) (<xref rid="btac752-B14" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic>, 2008b</xref>). Besides this default approach, the Vienna package offers the possibility to compare ssNA structures by either a rooted tree editing comparison of homeomorphically irreducible trees (HIT), weighted coarse-grained trees and coarse-grained trees or by a comparison of the HIT, coarse-grained or weighted coarse-grained structure strings. In addition, the Vienna RNAdistance can also compute the BP distance, which counts the total number of BPs that occur in one of the structures, but not in the other one (<xref rid="btac752-B14" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic>, 2008b</xref>).</p>
    <p>However, all the previously cited metrics sometimes fail in finding differences between secondary structures as shown in the example of <xref rid="btac752-F2" ref-type="fig">Figure 2</xref> adapted from <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref>, where the Hamming distance, the default RNAdistance (‘f’), and the BP distance cannot capture the differences between structures (b), (c) or (d) and the reference structure (a). Indeed, the Hamming distance only considers the total number of matching positions, without taking into account the correlations between the opening and closing positions, which are characteristic for the structure. Similarly, the BP distance counts the number of mismatching BPs, which might be the same, although the structures clearly have different distances from a reference, as in <xref rid="btac752-F2" ref-type="fig">Figure 2</xref>. On the other hand, RNAdistance works with a tree representation that, even at full resolution (i.e. without any loss of information with regard to the dot-bracket notation), might lead to an equivalent cost in the tree editing operations for structures that seem to have a different degree of proximity to the reference one. This is illustrated in <xref rid="btac752-F2" ref-type="fig">Figure 2</xref>, and the details about the computation of RNAdistance can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>. In addition, the RNAdistance between two structures is highly dependent on the chosen computing option, as it can be seen when analyzing the structures of <xref rid="btac752-F2" ref-type="fig">Figure 2</xref>.</p>
    <fig position="float" id="btac752-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Reference (<bold>a</bold>) and alternative (<bold>b</bold>, <bold>c</bold> and <bold>d</bold>) structures for ssNA 1. The Hamming, RNAdistance with the different options, BP, DoPloCompare, AptaMat distances and the RBP scores (with <italic toggle="yes">t</italic> = 1, 5 and 10) are computed using structure (a) as reference</p>
      </caption>
      <graphic xlink:href="btac752f2" position="float"/>
    </fig>
    <p>Efforts have been done to solve the sensitivity issue of the above-mentioned metrics. For example, a relaxed BP (RBP) score has been developed to increase the ability of the BP distance in comparing ssNAs secondary structures (<xref rid="btac752-B1" ref-type="bibr">Agius <italic toggle="yes">et al.</italic>, 2010</xref>) by introducing a relaxation parameter. However, the greater flexibility of the RBP score as compared to the standard BP distance might not be enough to capture differences between the structures as shown in the example in <xref rid="btac752-F2" ref-type="fig">Figure 2</xref>.</p>
    <p>Other interesting approaches based on image processing, such as DoPloCompare (<xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic>, 2009</xref>), have been developed with a similar goal. These approaches consist in representing the secondary structures of the two compared ssNAs as dotplots and then processing them as images in order to measure the distance between the two structures. The use of dotplots allows taking into account the BPs’ relative positions and it provides a finer description of the ssNA structure than RNAdistance (<xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic>, 2009</xref>). However, this approach can be laborious and sometimes it fails in finding the expected trend when comparing multiple structures to a reference one, as we will see later. Indeed, although the image processing approach is a novelty in the field, the proposed metrics use a combination of geometrical distance and histogram correlations that might hinder the nature of the proximity between the compared structures. Moreover, DoPloCompare seems to be not symmetric, which is an important requirement for many applications.</p>
    <p>Although there exist several other approaches to compare secondary structures, to our knowledge, none of them satisfy the desired properties: (i) simple in terms of results interpretation; (ii) easy to implement and to manipulate; (iii) exploitable for the comparison of pairs of structures, but also of multiple structures to a reference one, and, most of all and (iv) sensitive, in order to properly differentiate particularly close structures. Therefore, we developed a new algorithm, called AptaMat, which solves the issues of both the single structure-based and the image-based approaches. Briefly, AptaMat takes as input the aligned secondary structures of two ssNAs (<italic toggle="yes">S<sub>A</sub></italic> and <italic toggle="yes">S<sub>B</sub></italic>) of length <italic toggle="yes">L</italic> in the dot-bracket notation and creates for each of them a matrix of size <italic toggle="yes">L </italic>×<italic toggle="yes"> L</italic>, comparable to a dotplot with 1 and 0 instead of dots and blank cells, respectively. Indeed, the (<italic toggle="yes">i</italic>,<italic toggle="yes">j</italic>)th entry of the matrix is either equal to 1 if the nucleotide in position <italic toggle="yes">i</italic> is paired with the nucleotide in position <italic toggle="yes">j</italic> or 0 if the nucleotides in positions <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> are not paired or in presence of a gap. For each BP of each structure, we find the closest BP on the other structure using the Manhattan distance between points in the plane. The distances between all the closest pairs are summed up, the number of introduced gaps is added and the resulting sum is normalized by the total number of cells containing 1 in both matrices, in order to find the final AptaMat distance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>). A weighted AptaMat distance can also be computed to consider simultaneously multiple alternative conformations.</p>
    <p>We applied our approach to (i) five examples taken from the work by <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> to make a direct comparison with the Hamming distance, RNAdistance and DoPloCompare and (ii) to five structures of aptamers taken from the Protein Data Bank (<xref rid="btac752-B3" ref-type="bibr">Berman <italic toggle="yes">et al.</italic>, 2000</xref>). The obtained results show that AptaMat is able to properly compare ssNAs secondary structures and to well discriminate among different structures. Finally, AptaMat also showed a good performance in clustering RNA structures according to their belonging RFAM families.</p>
    <p>The python code implementing AptaMat is available on GitHub at <ext-link xlink:href="https://github.com/GEC-git/AptaMat.git" ext-link-type="uri">https://github.com/GEC-git/AptaMat.git</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 AptaMat algorithm</title>
      <p>The AptaMat algorithm has been developed for the comparison and quantification of the differences between aligned structures of pairs of ssNAs, with the alignment being of length <italic toggle="yes">L</italic>.</p>
      <p>The algorithm takes as input the two pairwise aligned structures written in the dot-bracket notation, with one structure considered as reference. Starting from each input dot-bracket string a square matrix of <italic toggle="yes">L </italic>×<italic toggle="yes"> L</italic> in size is created, where each matrix cell (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) corresponds to the position <italic toggle="yes">i</italic> of a nucleotide of the sequence relative to another position <italic toggle="yes">j</italic> of the same sequence. Therefore, each cell (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) contains either 1, if the nucleotide in position <italic toggle="yes">i</italic> is involved in a BP with the nucleotide in position <italic toggle="yes">j</italic>, or 0 if not. Cells corresponding to positions with gaps contain 0 as well. The resulting matrices can be assimilated to dotplots, with 1 instead of a dot and 0 instead of blank cells. Although very simple, this representation allows taking into account the relative position of the BPs in the ssNA sequence, thus retaining a more complete structural information as compared to the dot-bracket notation. The python implementation of AptaMat allows performing the structures alignment internally, by calling the RNAlign2D (<xref rid="btac752-B39" ref-type="bibr">Woźniak <italic toggle="yes">et al.</italic>, 2021</xref>) structure alignment tool. Alternatively, the user can provide his/her own alignment.</p>
      <p>For the clarity of the algorithm description, we will call matrix <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the one containing the information regarding the reference structure and matrix <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the one storing the information of the structure we want to compare to the reference one. We want to define a distance between these matrices that reflects the proximity between cells containing 1 in both of them, i.e. those indicating a BP. For this purpose, each matrix is embedded in the plane in the following way: each (<italic toggle="yes">i, j</italic>)th entry that is equal to 1 is assimilated to the point with coordinates <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Hence, to a matrix representing a secondary structure we associate a set of points in the plane with coordinates in <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Moreover, since both matrices are symmetrical, we consider only the entries below the diagonal. More precisely, let <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be the set of points corresponding with structure <italic toggle="yes">S<sub>A</sub></italic>. The set <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is defined analogously. A natural way to measure the distance between the BPs in the compared structures is to measure the distance between sets <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. At this scope, any distance between compact sets of points in <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> could be appropriate for the method (e.g. Haussdorf distance, <xref rid="btac752-B22" ref-type="bibr">Huttenlocher <italic toggle="yes">et al.</italic>, 1993</xref>). At the moment, AptaMat algorithm implements a metric based on the Manhattan distance, which was chosen for its simplicity, as it is expressed as the sum of the absolute differences between the coordinates of the compared points (<xref rid="btac752-B25" ref-type="bibr">Krause, 1988</xref>). However, other distances can be easily implemented.</p>
      <p>In AptaMat, for each point <italic toggle="yes">P</italic> in <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> we find the Manhattan distance to its nearest neighbor in <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and vice versa. In order to handle all the differences between the structures, it is important to consider the distance in both directions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>). Indeed, both structures do not have necessarily the same number of BPs. As a consequence, the distances in the two directions might not be the same and, more importantly, some BPs might be excluded from the comparison. Therefore, considering only the distances in one direction might be source of mistakes. Then, the shortest distances between <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sets are summed up. The insertion of gaps within the alignment will determine the increase of the distance between two points, therefore we introduced a gap cost of 1 as indicated in <xref rid="E1" ref-type="disp-formula">Eq. 1</xref>. Finally, the obtained distance is normalized by the total number of BPs in structures <italic toggle="yes">S<sub>A</sub></italic> and <italic toggle="yes">S<sub>B</sub></italic>, since some distances might emerge twice in the calculation. Notice that this sort of normalization gives a more important weight to BPs in common between the two compared structures. The AptaMat distance, denoted by <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is, therefore, defined as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>Man</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>Man</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where, for any given point <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and any finite subset <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, we denote by <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:math></inline-formula> the cardinal of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula>, and by <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>Man</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the Manhattan distance from <italic toggle="yes">P</italic> to its nearest neighbor in <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula>. Finally, <italic toggle="yes">N<sub>G</sub></italic> denotes the number of gaps in the alignment.</p>
      <p>We can easily check that <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is symmetric, and it is equal to 0 only when both structures are identical. In the light of this, the more the AptaMat distance is close to 0 the more the two compared structures are similar, independently of their length.</p>
      <p>Because of their intrinsic flexibility, ssNAs can experimentally adopt many conformations, leading to an ensemble of structures (<xref rid="btac752-B11" ref-type="bibr">Ganser <italic toggle="yes">et al.</italic>, 2019</xref>). To take this into account, AptaMat, with the option ‘ – <italic toggle="yes">ensemble</italic>’, allows taking as input an ensemble of <italic toggle="yes">n</italic> structures <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and their associated weights <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, which can be derived from either experimental data or prediction tools. In this case, the weighted AptaMat distance is calculated as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.2 Test set preparation</title>
      <p>In order to confront AptaMat to the most used metrics for ssNAs comparison, we built a test set of 10 ssNA with known structures: five taken from the work by <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> and five taken from the PDB database (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The selected ssNA have different lengths (20–127 nucleotides) and different secondary structures, containing stems, hairpin/stem loops, bulges, internal loops and junctions. For each sequence, the reference secondary structure in the dot-bracket notation was either taken from <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> or extrapolated using ×3dna-dssr (<xref rid="btac752-B28" ref-type="bibr">Lu and Olson, 2003</xref>) and then used as the reference structure. In addition, for each sequence, two or more alternative structures were used to perform the comparison. The alternative structures for the examples taken from <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> were obtained from the same article, while for those taken from the PDB database we used six different ssNA secondary structure prediction tools, namely Mfold (<xref rid="btac752-B40" ref-type="bibr">Zuker, 2003</xref>), LinearFold (<xref rid="btac752-B21" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2019</xref>), CentroidFold (<xref rid="btac752-B16" ref-type="bibr">Hamada <italic toggle="yes">et al.</italic>, 2009</xref>), RNAfold (<xref rid="btac752-B14" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic>, 2008b</xref>), RNAstructure (<xref rid="btac752-B35" ref-type="bibr">Reuter and Mathews, 2010</xref>) and MC-Fold (<xref rid="btac752-B34" ref-type="bibr">Parisien and Major, 2008</xref>) to obtain at least two different secondary structures for each ssNA. This was achieved when the prediction tools were not able to correctly predict the secondary structure of the processed sequences.</p>
    </sec>
    <sec>
      <title>2.3 Comparison methods</title>
      <p>We compared AptaMat to some of the most used methods of ssNAs secondary structures comparison: the Hamming distance (<xref rid="btac752-B17" ref-type="bibr">Hamming, 1950</xref>), the BP distance and RNAdistance from the ViennaRNA package (<xref rid="btac752-B19" ref-type="bibr">Hofacker, 2003</xref>). The first computes the distance between two ssNAs structures of same length <italic toggle="yes">L</italic>, by calculating
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>Hamming</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>diff</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>diff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of unmatched positions between the two strings corresponding to the dot-bracket notation of the compared structures.</p>
      <p>In order to compute the BP distance, which counts the total number of BPs occurring in one structure but not in the other, we used the option ‘P’ of the Vienna RNAdistance tool. In addition, when the BP distance could not capture the differences between the considered structures, we also computed the RBP distance as described in <xref rid="btac752-B1" ref-type="bibr">Agius <italic toggle="yes">et al.</italic> (2010)</xref> with <italic toggle="yes">t</italic> set to 1, 5 and 10, since the authors suggest that <italic toggle="yes">t</italic> values between 0.05 and 20 provide good results.</p>
      <p>The Vienna implementation of RNAdistance allows computing the distance between two ssNA structures in multiple ways depending on the chosen option. The default RNAdistance implemented in the Vienna package (parameter ‘f’) computes the distance between two ssNAs structures by representing them as ordered rooted trees. At full resolution, this representation is deducible from the dot-bracket notation by assigning each unpaired nucleotide to a leaf and each BP to an internal node, as shown in <xref rid="btac752-F1" ref-type="fig">Figure 1d</xref>. In order to calculate the distance between two trees, the tree editing approach is used, which consists in a series of edit operations (deletion, insertion or mutation of a node), to which a cost is assigned and that allow to transform a tree <italic toggle="yes">T<sub>A</sub></italic> into a tree <italic toggle="yes">T<sub>B</sub></italic>. The resulting distance <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>RNA</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to the minimal total cost of the series of operations allowing to transform one tree into the other. The tree editing comparison is also used when parameters ‘h’, ‘w’ and ‘c’ are chosen, i.e. when the ssNAs structures are represented as HIT, weighted coarse-grained or coarse-grained trees, respectively. As an alternative to the tree editing comparison, Vienna RNAdistance offers the possibility to make a string comparison after the conversion of the dotbracket structure to a string indicating structural elements, such as paired or unpaired bases, or hairpins and bulges, depending on the type of the coarse grain representation (parameters ‘F’, ‘H’, ‘W’ and ‘C’).</p>
      <p>In addition, for the structures taken from <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), we included in the benchmark of AptaMat the comparison with the algorithm DoPloCompare, which uses an approach based on image processing to measure the distance between two ssNAs secondary structures. This algorithm has been selected for comparison with AptaMat because of its higher sensitivity as compared to the Hamming distance and RNAdistance (<xref rid="btac752-F2" ref-type="fig">Fig. 2</xref>), and because it is based on the dotplot diagrams of the compared structures, as AptaMat. The distance grade proposed in this algorithm to compare two structures <italic toggle="yes">S<sub>A</sub></italic> and <italic toggle="yes">S<sub>B</sub></italic> can be defined as
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>DoPloCompare</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Dist</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">Corr</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">Dist</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> term corresponds to the geometrical distance from the points in the dotplot diagram of structure <italic toggle="yes">S<sub>A</sub></italic> (reference) to the dotplot diagram of structure <italic toggle="yes">S<sub>B</sub></italic> (alternative). The <italic toggle="yes">Corr</italic> term is related to the cross-correlation between histogram vectors built from the dotplot diagrams of both structures by adding the number of points in four different directions (X, Y, diagonal and anti-diagonal). Although the <italic toggle="yes">Dist</italic> term in DoPloCompare is somehow similar to AptaMat, it does not seem to be symmetrically defined, and hence it does not take into account the number of BPs in the alternative structure. On the other hand, the <italic toggle="yes">Corr</italic> term accounts for the similarity in the order and number of elements that both structures contain, even if the BPs involved in these elements are not the same in structures <italic toggle="yes">S<sub>A</sub></italic> and <italic toggle="yes">S<sub>B</sub></italic>.</p>
    </sec>
    <sec>
      <title>2.4 Clustering</title>
      <p>To fully challenge AptaMat, we evaluated its classification ability by applying a clustering approach on RNA structures belonging to different RFAM families (<xref rid="btac752-B3" ref-type="bibr">Berman <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="btac752-B24" ref-type="bibr">Kalvari <italic toggle="yes">et al.</italic>, 2021</xref>). To avoid the potential bias induced by the secondary structure prediction method, we selected among the RFAM families those having more than 10 complete experimental 3D structures (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> for a complete list of the retained RNAs), and we verified the absence of structural issues within their 3D structures. For families with more than 30 complete structures, we randomly chose 30 structures in order to have a balanced dataset. For the other families, we kept all the available structures. The resulting dataset consists in 14 RFAM families and 291 sequences. Finally, we computed the dot-bracket notation of each selected RNA secondary structure using ×3dna-dssr (<xref rid="btac752-B28" ref-type="bibr">Lu and Olson, 2003</xref>).</p>
      <p>The clustering was performed using the affinity propagation method (<xref rid="btac752-B10" ref-type="bibr">Frey and Dueck, 2007</xref>). For a set <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">N</italic> secondary structures, this method takes as input an affinity matrix <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>Affinity</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, defined as
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>AM</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>built by computing the AptaMat distance for each pair of secondary structures. The scale parameter <italic toggle="yes">σ</italic> has been determined using Caliñski and Harabasz index (<xref rid="btac752-B5" ref-type="bibr">Caliñski and Harabasz, 1974</xref>) to optimize the clustering quality. Successively, an exchange of real-valued messages between data points is performed until a high-quality ensemble of representative examples and, thus, the corresponding clusters, gradually emerge. An advantage of this clustering method is that it does not need to fix the number of clusters, since an appropriate one is defined as a function of the submitted data.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 AptaMat as compared to currently used metrics</title>
      <p>We used AptaMat to measure the distance between pairs of secondary structures for the ssNAs reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, and we compared the AptaMat distance with the Hamming distance, the BP distance and RNAdistance with the different available options. Among the selected structures, for ssNAs 2 and 7 (<xref rid="btac752-F3" ref-type="fig">Figs 3</xref> and <xref rid="btac752-F5" ref-type="fig">5</xref>) the Hamming distance, the default RNAdistance, BP distance and AptaMat distance between the alternative secondary structures and the reference one follow the same trend. In addition, the distance trend is also correctly predicted for ssNAs 4 and 5 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6 and S7</xref>) by using either the Hamming distance, the default RNAdistance, or AptaMat distance. This shows the coherence between our method and the most used distance metrics when there is a clear difference between the compared secondary structures in terms of both dot-bracket notation and the trees used to calculate RNAdistance. However, concerning this latter metric, it is worth noticing that, depending on the chosen RNAdistance option, the results might differ in terms of the trend and the values obtained for some ssNAs (<xref rid="btac752-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S4–S12</xref>).</p>
      <p>We discuss here the results for ssNA 7 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, <xref rid="btac752-F3" ref-type="fig">Fig. 3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>), for which we could gather three different alternative structures, allowing a more extensive analysis. The distances from the reference structure (a) progressively increase going from the alternative structure (b), obtained by RNAstructure (<xref rid="btac752-B35" ref-type="bibr">Reuter and Mathews, 2010</xref>) to (d), obtained by RNAfold (<xref rid="btac752-B14" ref-type="bibr">Gruber <italic toggle="yes">et al.</italic>, 2008b</xref>). Indeed, the reference secondary structure (a) made of a stem, a multi-branched loop, a bulge and two hairpin/stem loops is progressively lost. The alternative structure (b) is close to the reference: instead of the original G9-C20 BP, it has a BP between C7 and G17 and one between A8 and T18. This difference of 3 BPs leads to the transformation of the bulge in an internal loop and the reduction of the width of the multi-branched loop. Structure (c) has a much wider multi-branched loop because of the loss of 5 BPs, which also shortens the two hairpin/stem loops, with one of them becoming a bulge. Finally, structure (d) only conserves 2 hairpin/stem loops and the bulge but they do not involve the same positions as in the reference, for a total of 16 different BPs. In this case, all but the RNAdistance ‘W’ option (i.e. weighted coarse-grained structure translation followed by the string comparison) provided the same trend, although with different distance values.</p>
      <fig position="float" id="btac752-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>ssNA 7 shows the ability of AptaMat in comparing ssNAs secondary structures. The Hamming distance, the default RNAdistance, the BP distance and AptaMat indicate that the alternative structures (<bold>b</bold>), (<bold>c</bold>) and (<bold>d</bold>) are progressively farther from the reference secondary structure (<bold>a</bold>). For details about the results of the different RNAdistance options, we refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S2</xref></p>
        </caption>
        <graphic xlink:href="btac752f3" position="float"/>
      </fig>
      <p>However, sometimes the structural differences between two ssNAs are quite subtle and the Hamming distance, the BP distance and RNAdistance are not able to discriminate between structures. A striking example is represented by ssNA 1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="btac752-F2" ref-type="fig">Fig. 2</xref>), which has been taken from <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref>. This toy example is not based on the analysis of a proper ssNA sequence but it focuses directly on structures. As shown in <xref rid="btac752-F2" ref-type="fig">Figure 2</xref>, the three structures compared to the reference differ from this latter and one from another. The three alternative structures have an additional bulge, which becomes progressively wider from structure (b) to structure (d) since the third BP progressively shifts towards the 5’ end. Nevertheless, the Hamming distance predicts the same distance to the reference for the three alternative structures since it counts the number of mismatches between the dot-bracket strings to compare regardless of the position of the nucleotides involved in BPs. As a result, any information about the structure is lost and different secondary structures with the same number of mismatching positions as compared to a reference structure will have the same Hamming distance from it. In ssNA 1 all the alternative structures have 2 mismatching positions, which, leading to a Hamming distance of 0.10 in all the cases. Similarly, the BP distance counts the number of different BPs between the two compared structures, which are 2 in all the comparisons of the alternative structures to the reference one. Even the inclusion of the relaxation term of the RBP score (<italic toggle="yes">t</italic> = 1, 5 or 10) does not allow the distinction between the different structures, giving a score of 1 for the three cases.</p>
      <p>For what concerns RNAdistance, the structures of <xref rid="btac752-F2" ref-type="fig">Figure 2</xref> are considered to be equivalent, although with varying distances values, when using a full structure or a coarse-grained representation followed by either a string or a tree editing comparison (options ‘f’, ‘F, ‘c’ and ‘C’). Indeed, although RNAdistance takes into account the correlation between opening and closing positions of the dot-bracket strings, it might happen that the series of editing operations of two comparisons have an equivalent weight leading to the same RNAdistance, as it occurs in the example of <xref rid="btac752-F2" ref-type="fig">Figure 2</xref> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for the details). Conversely, options ‘h’ and ‘H’, which are based on the HIT structure translation followed by rooted tree editing and string comparison, respectively, indicate that structures (b) and (d) are equally distant from structure (a), while structure (c) is farther (option ‘h’) or closer (option ‘H’) to structure (a) as compared to the other two. Option ‘W’ gives the opposite trend as the expected one and the only option providing the right trend is ‘w’, which consists in the weighted coarse-grained structure translation followed by the rooted tree editing comparison. Therefore, it appears clear that the choice of the appropriate RNAdistance option is non-trivial since it is strongly system dependent. On the opposite, both AptaMat and DoPloCompare are able to correctly and straightforwardly calculate the distance trend, with the first alternative structure being the closest to the reference and the third alternative structure being the farthest.</p>
      <p>The more realistic examples corresponding to ssNAs 3, 6, 9 and 10 also show the limits of the currently used metrics as compared to AptaMat (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5, S8, S11, S12</xref> and <xref rid="btac752-F4" ref-type="fig">Figure 4</xref>). As mentioned before, the Hamming and BP distances will be the same if the alternative structures have the same number of mismatching positions and BPs, respectively, as compared to the reference one. However, depending on the number and the position of the mismatches, the structural difference might become highly relevant and lead to wrong conclusions about the similarity of a structure to a reference one. We discuss here ssNA 10, which highlights the issues arising from the Hamming distance, the BP distance and RNAdistance in a unique example. ssNA10 is a DNA aptamer, called pL1, binding to the Plasmodium vivax LDH, whose structure is described in the 5HRU PDB and consists in 4 base pairs followed by a bulge and a hairpin/stem loop (<xref rid="btac752-F4" ref-type="fig">Fig. 4</xref>). Noteworthy, the bulge and, at minor extent, the hairpin/stem loop are implicated in the interaction with LDH. When the pL1 sequence is submitted to Mfold using a percent suboptimality of 100, in order to retrieve the maximum number of predicted structures, we obtained the alternative structures (b)–(e), with the former being the one corresponding to the one with the lowest ΔG (−3.50 kcal/mol) and the latter the one with the highest ΔG (−0.99 kcal/mol). When computing the distance of these alternative structures from the experimental one (reference structure (a)), all the considered metrics correctly indicate that structure (c) is the closest to the reference, since it only misses one base pair involving the 5′ and 3′ ends. The other alternative structures (e), (d) and (b) are progressively more distant from the experimental reference structure. Indeed, although it loses the four initial base pairs, structure (e), maintains the bulge, even if it is shorter than the one in the reference structure, and the hairpin/stem loop. Structure (d) misses the 4 base pairs, maintains the hairpin/stem loop, and it has a small internal loop instead of the bulge. Finally, structure (b) has only the hairpin/stem loop and it does not have the bulge or even an internal loop which would be needed for the interaction with the partner protein. This trend is correctly showed by AptaMat, while the Hamming distance and the default RNAdistance do not capture any differences from the reference structure for the alternative structures (b), (d) and (e). Only the RNAdistance options ’w’ and ’H’ do it in the expected way (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). The BP distance wrongly indicates that structures (d) and (e) have the same distance from the experimental structure, and, more importantly, structure (b) is suggested to be closer to the reference than structures (d) and (e). The inclusion of a relaxation parameter <italic toggle="yes">t</italic> (<italic toggle="yes">t </italic>=<italic toggle="yes"> </italic>1, 5 or 10) within the RBP score does not lead to capture the expected differences (<xref rid="btac752-F4" ref-type="fig">Fig. 4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>).</p>
      <fig position="float" id="btac752-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Reference (<bold>a</bold>) and alternative structures (<bold>b</bold>), (<bold>e</bold>) for ssNA 10. The Hamming distance, the default RNAdistance, BP distance, RBP score (with <italic toggle="yes">t </italic>=<italic toggle="yes"> </italic>1) and AptaMat are computed using structure (a) as reference. For details about the results of the different RNAdistance options, we refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S2</xref></p>
        </caption>
        <graphic xlink:href="btac752f4" position="float"/>
      </fig>
      <p>AptaMat is also able to establish a more meaningful ranking of the alternative secondary structures in terms of distance from the reference as compared to the Hamming distance, the BP distance and the default RNAdistance in all the examples herein presented. This is important when investigating the effect of sequence mutations on the ssNAs secondary structure. In this context, ssNAs 3, 5, 6, 8 and 9 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) show the limits of these methods as compared to AptaMat. Here we focus our discussion on ssNA 6, which has more alternative structures than ssNAs 3, 5 and 9, and more subtle modifications than ssNA 8. Thus, this example offers the possibility to deeply explore the differences between the considered metrics. ssNA 6 (PDB ID: 1NGO) has a simple hairpin/stem loop structure (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). The alternative structure (b) obtained by CentroidFold is correctly considered by the used metrics as the closest to the experimental structure (Hamming distance = 0.074, default RNAdistance = 2, BP distance = 2, and AptaMat = 0.091). AptaMat then indicates that the alternative structure (d) obtained by MC-Fold is closer to the reference (AptaMat distance = 0.20) than the alternative structure (c) obtained by RNAfold (AptaMat distance = 0.22), since the former only misses two pairs of bases (T5-G23 and T6-G22) while maintaining the overall structure. Conversely, structure (c) has two additional base pairs that lead to the loss of the characteristic loop of 1NGO (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). On the opposite, the Hamming distance fails in finding this difference, and the default RNAdistance suggests the opposite trend, with structures (c) and (d) having an RNAdistance of 6 and 8, respectively. It is worth noticing that none of the RNAdistance modes is able to correctly capture the expected trend (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). In this context, the BP distance also fails in doing so: although indicating that structure (c) is the farthest from structure (a), it cannot distinguish between structures (b) and (d). The use of the relaxed RBP score does not change the situation here.</p>
      <p>Similar conclusions are applicable to ssNA 3 and 8 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5 and S10</xref>), though for this latter the BP distance succeeds in finding the right trend. For ssNAs 5 and 9 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S7 and S11</xref>) the Hamming and the BP distances indicate an opposite and inadequate ranking of the two alternative structures because of the different number of mismatches.</p>
      <p>The overall better performance of AptaMat in ranking the alternative secondary structures in terms of distance from a reference, as compared to the Hamming distance, the BP distance or RBP score, and RNAdistance, is particularly evident for structures that are close to the reference one, which turn out to be more difficult to properly rank. The ability of AptaMat in doing so is due to the higher weight given by our algorithm to the relative position of the base pairs. This leads to focus on the global secondary structure more than on the local differences from the reference secondary structure. As previously mentioned, this is of particular importance for the comparison of ssNAs, since their function highly depends on their global 3D structure and only to a minor extent on local sequence information.</p>
      <p>In addition, together with the better performance shown here as compared to the other discussed metrics, AptaMat has the advantage of being easily applicable since there is no need to choose any parameter as for RNAdistance or the RBP score. Moreover, it can be used for the comparison of sequences with different lengths, which is not possible for the Hamming distance and it is not recommended for the BP or RBP distances. Finally, thanks to the use of dotplots to describe the structural information, and contrary to RNAdistance, AptaMat allows the handling of pseudo-knots.</p>
      <p>The analysis of the alternative structures ranking relative to the reference structure highlight the limits of DoPloCompare as compared to AptaMat. SsNAs 2, 4 and 5 (<xref rid="btac752-F5" ref-type="fig">Fig. 5</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6 and S7</xref>) have a DoPloCompare trend opposite not only to AptaMat but also to the Hamming distance and RNAdistance. We argue that this is due to the <italic toggle="yes">Corr</italic> term in DoPloCompare, which, as we mentioned before, accounts for the similarities in the number and order of the elements (stems, loops, etc.) in the compared structures. In the three previous examples, the structures that are found to be closer to the reference one are those having a more similar number of elements, despite the fact that the base pairs involved in these elements are not the same. For example, if we consider ssNA 2 (<xref rid="btac752-F5" ref-type="fig">Fig. 5</xref>), we can clearly see that the alternative structures (b) and (c) are both structurally far from the reference structure (a). However, the structure (b) is closer to the reference (a) (Hamming distance = 0.15, default RNAdistance = 24, BP distance = 3 and AptaMat = 6.35) than the alternative structure (c) (Hamming distance = 0.41, default RNAdistance = 26, BP distance = 14 and AptaMat = 7.50), as correctly indicated by the Hamming distance, the default RNAdistance, the BP distance and AptaMat. Indeed, structure (b) maintains the secondary structure of the reference except for 3 missing base pairs (G28-C37, G29-C36 and C30-G35), while structure (c) has four additional base pairs (C5-G39, C6-G38, C12-G27, U13-G26), leading to a significant change in the global structure. DoPloCompare indicates that this latter structure is closer to the reference (DoPloCompare = 0.12) than structure (b) (DoPloCompare = 0.13), because structure (c) has two hairpin/stem loops and an internal loop as structure (a), while structure (b) only has a hairpin/stem loop and an internal loop. However, the global structure (c) differs from those in structure (a), because of a different base pairs pattern. In addition, the DoPloCompare scores are close to 0, suggesting a high similarity of the alternative structures to the reference one, which is clearly not the case as indicated by the other metrics. Similar observations can be done for ssNAs 4 and 5 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6 and S7</xref>). Furthermore, looking at the DoPloCompare scores obtained for ssNAs 1–5, it seems that they depend on the sequence length: although the alternative structures of ssNAs 1 (<xref rid="btac752-F2" ref-type="fig">Fig. 2</xref>) are globally close to the reference one, they show a DoPloCompare score which is higher than those obtained for ssNAs 2–5, where the alternative structures are very far from the reference, as also showed by the default RNAdistance and AptaMat.</p>
      <fig position="float" id="btac752-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Reference (<bold>a</bold>) and alternative structures (<bold>b</bold>) and (<bold>c</bold>) for ssNA 2. The Hamming distance, the default RNAdistance, BP distance, RBP score (with <italic toggle="yes">t </italic>=<italic toggle="yes"> </italic>1) and AptaMat are computed using structure (a) as reference. For details about the results of the different RNAdistance options, we refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S2</xref></p>
        </caption>
        <graphic xlink:href="btac752f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Considering structural ensembles within AptaMat</title>
      <p>Because of the high flexibility of ssNAs, it is not unusual to have an ensemble of possible foldings (<xref rid="btac752-B11" ref-type="bibr">Ganser <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac752-B18" ref-type="bibr">Herschlag <italic toggle="yes">et al.</italic>, 2015</xref>) for a given ssNA sequence, each having a different associated weight. This can change as a function of the experimental conditions (ions concentration, pH, temperature, …) or in the presence of a molecule recognized by the ssNA (ligand) (<xref rid="btac752-B15" ref-type="bibr">Haller <italic toggle="yes">et al.</italic>, 2011</xref>). Therefore, it might be interesting not only to independently compare each alternative structure to a reference one but also to consider simultaneously the whole conformational ensemble and its associated distribution when performing the comparison to a reference structure. This can be done within AptaMat by specifying the option ‘ – <italic toggle="yes">ensemble</italic>’, which allows the computation of the AptaMat distance according to <xref rid="E2" ref-type="disp-formula">Equation 2</xref>, after having provided the alternative structures and the associated weights. The reference structure might be a consensus structure or it can be the experimental structure to which predicted co- or suboptimal structures can be compared to evaluate the reliability of the prediction, as for ssNA 10. Alternatively, the reference structure can be the most probable ssNA structure obtained by changing the experimental conditions, which will allow the study of the effect of the resulting conformational changes by taking into account the whole structural ensemble. For example, experimental data on the transactivation response (TAR) RNA of the HIV-1 transactivator protein TAT showed that it can adopt different similar conformations in the absence of a ligand (PDB code 1ANR, <xref rid="btac752-T1" ref-type="table">Table 1</xref>). Conversely, when TAR binds a peptide mimicking the TAT protein (PDB code 2KDQ), only one conformation is sampled. We applied both the default and the weighted AptaMat algorithm, using the peptide-bound structure as a reference and we used as weights the relative frequencies of each conformation. <xref rid="btac752-T1" ref-type="table">Table 1</xref> reports the obtained results. The weighted AptaMat distance of the ligand-free conformational ensemble from the peptide-bound structure is 0.16, indicating minor conformational changes. Moreover, looking at the individual AptaMat distances, we can observe that, among the alternative structures, the third one (weight = 0.15) is identical to the peptide-bound structure. Thus, it seems that the presence of the ligand stabilizes a minor conformation of the ligand-free structural ensemble. In addition, the most probable ligand-free conformation is the closest to the reference one, suggesting that only a small conformation change occurs.</p>
      <table-wrap position="float" id="btac752-T1">
        <label>Table 1.</label>
        <caption>
          <p>Comparison of the ligand-free structural ensemble of the TAR RNA to the peptide-bound TAR RNA structure</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">No.</th>
              <th rowspan="1" colspan="1">Structure</th>
              <th rowspan="1" colspan="1">Counts<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></th>
              <th rowspan="1" colspan="1">Weight</th>
              <th rowspan="1" colspan="1">AptaMat</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">(((((….((((……)))).)))))</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">0.45</td>
              <td rowspan="1" colspan="1">0.10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">.((((….((((……)))).)))).</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">0.25</td>
              <td rowspan="1" colspan="1">0.22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">((((((…((((……))))))))))</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">0.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">.((((…..(((……)))..)))).</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">0.35</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">((((……((((…).)))…))))</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">0.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">.(((((…((((……))))))))).</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">0.10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Weighted AptaMat</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.16</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: ((((((…((((……)))))))))), from PDB code 2KDQ.</p>
          </fn>
          <fn id="tblfn2">
            <label>a</label>
            <p>Out of 20, from PDB code 1ANR.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.3 Clustering RNAs from RFAM families</title>
      <p>In order to further challenge AptaMat, we tested its ability in clustering sequences belonging to different RFAM families. We considered only RFAM families with experimental 3D structures to avoid a bias related to the secondary structure prediction, even if we might end up with incomplete structures, because of missing residues at the extremities, generating subclusters. For families having a high number of experimental structures available, such as tRNA and the bacterial small subunit ribosomal RNA, we randomly selected 30 structures. In addition, we discarded the families with less than 10 available structures. The final dataset consisted in 291 structures and 14 RFAM families (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). We used the affinity propagation method (<xref rid="btac752-B10" ref-type="bibr">Frey and Dueck, 2007</xref>) to perform the clustering (see Section 2 for further details), since it does not need to preliminary fix the number of clusters. To quantitatively evaluate the results we computed the silhouette score, which indicates the separation between clusters and which assumes values between −1 and 1, with higher values coming from well-distinguishable clusters and lower values from difficult-to-separate clusters. We also computed the clustering accuracy, calculated as the sum of the diagonal elements of the confusion matrix divided by the total number of sequences, and the adjusted random score, which allows the determination of the similarity between clusters. The obtained silhouette, adjusted random scores and accuracy are of 0.55, 0.84 and 0.82, respectively, indicating the good quality of the clustering.</p>
      <p><xref rid="btac752-F6" ref-type="fig">Figure 6</xref> shows the results of the clustering as a confusion matrix. As it can be seen, the clustering using AptaMat distance is globally able to recover the expected subdivision within the different RFAM families. For 8 out of the 14 RFAM families, namely the bacterial small subunit (SSU) rRNA, 5S rRNA, tRNA, glmS activated ribozyme, U6 spliceosomal RNA, TPP riboswitch, purine riboswitch and SAM riboswitch a unique cluster is identified. In addition 13 out of 17 clusters are independent, i.e. they are not shared between different families. It should be noticed that the structures for the bacterial SSU rRNA are not complete (about 1000 versus the expected 1500 nucleotides) and the related cluster 0 includes not only the bacterial SSU rRNA but also most of the archaeal SSU rRNA structures, since in both cases this ribosomal subunit corresponds to the 16S rRNA. The only two archaeal SSU rRNA structures not included in cluster 0, but isolated in cluster 17, correspond to the whole 16S rRNA. For the other families, we can clearly distinguish a major cluster and one or more minor clusters, whose presence can be easily explained. More in detail, for the 5.8S rRNA family, most of the structures belong to the unique cluster 4. The two structures belonging to cluster 6 (2WWB chain D and 2WWA chain D) are significantly shorter (about 60 nucleotides), probably because of the experimental structural resolution, making them closer to the cluster grouping the TPP riboswitch. Cluster 16 contains 3 5.8S rRNA from <italic toggle="yes">Drosophila melanogaster</italic>, which has a shorter 5.8S rRNA (123 nucleotides) as compared to other species and a human 5.8S rRNA with multiple missing residues at both the 3′ and 5′ ends, leading to a significantly shorter sequence. The glycine riboswitch family is split into two clusters (9 and 14), with cluster 9 containing only the synthetic domain II of the riboswitch, while cluster 14 contains a more complete structure from different species. The U5 spliceosomal RNA family is split in 3 clusters: two major unique clusters (11 and 13), whose separation depends on the presence of multiple missing nucleotides at both the 5′ and 3′ extremities for the structures of cluster 11, and a minor one (cluster 8), which corresponds to the purine riboswitch family cluster. In this cluster, we found the U5 spliceosomal RNA from <italic toggle="yes">Saccharomyces cerevisiae</italic> which has an unusual insertion in its sequence (<xref rid="btac752-B30" ref-type="bibr">Mitrovich and Guthrie, 2007</xref>). As expected, we observed that the eukaryotic large subunit (LSU) rRNA family available structures do not describe the whole LSU rRNA, but either part of the 25S or 26S rRNA (cluster 10), or part of 28S rRNA (cluster 15). In addition, clusters 8 and 14 contain two LSU rRNA chains of a highly atypical <italic toggle="yes">Euglena gracilis</italic> rRNA (<xref rid="btac752-B29" ref-type="bibr">Matzov <italic toggle="yes">et al.</italic>, 2020</xref>) (6ZJ3 chains LB and LC, respectively). Finally, the bacterial small recognition particle RNA (SRP RNA) is divided into cluster 12 containing only 4.5S RNA, cluster 1 containing 7S.S RNA, which cannot be distinguished from the 5S RNA, and cluster 6, corresponding to the TPP riboswitch, which also contains a 7S.S RNA from <italic toggle="yes">Methanocaldococcus jannaschii</italic>.</p>
      <fig position="float" id="btac752-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Graphical representation of the clustering performed on selected structures belonging to 14 RFAM families by using AptaMat as distance metric and the affinity propagation as clustering algorithm. The number of structures contained in each cluster is indicated in the cluster square. The color gradient corresponds to the occupancy of each cluster</p>
        </caption>
        <graphic xlink:href="btac752f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Being able to compare ssNAs secondary structures is fundamental to understand the function and evolution of this kind of biomolecules, to design ssNAs with a desired secondary structure or even to predict the conformational effects of sequence mutations. To that extent, in this work we present AptaMat, a new matrix-based algorithm capable of comparing pairs of aligned ssNAs secondary structures, with <italic toggle="yes">L</italic> being the alignment length. The alignment can be performed both externally or internally (with RNAlign2D). AptaMat then takes as input the two aligned ssNAs structures in the dot-bracket notation and, for each of them, creates a matrix of size <italic toggle="yes">L </italic>×<italic toggle="yes"> L</italic>, named <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)th entry of the matrix is either equal to 1 if the nucleotide in position <italic toggle="yes">i</italic> is paired with the nucleotide in position <italic toggle="yes">j</italic> or 0 if the nucleotides in positions <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> are not paired or in presence of a gap. Then, for each <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> such that <italic toggle="yes">a<sub>ij</sub></italic> = 1, the Manhattan distance to the closest entry equal to 1 in matrix <italic toggle="yes">B</italic>, and vice versa, is calculated. The distances between all the closest pairs are summed up and a cost of 1 is associated to each gap. Finally, the normalization by the total number of cells containing 1 in both matrices is performed, leading to AptaMat distance.</p>
    <p>We compared AptaMat to some of the most used metrics for ssNAs secondary structures comparison, namely the Hamming distance, the BP distance, the relaxed RBP score, the different options of RNAdistance and a more recent approach based on image processing, DoPloCompare, by <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref>. In order to do this, we chose five structures taken from the examples reported in the work by <xref rid="btac752-B23" ref-type="bibr">Ivry <italic toggle="yes">et al.</italic> (2009)</xref> and five structures taken from the PDB database.</p>
    <p>We showed that AptaMat is able to properly distinguish between different structures, presenting a higher sensitivity and a more adequate ssNAs structures ranking ability as compared to the other considered metrics. Moreover, it is easy to interpret, it can deal with sequences of different lengths, or the presence of pseudoknots, and it is less affected by the ssNA length than the other considered metrics. Additionally, AptaMat is easy to implement and to manipulate. Indeed, we plan to extend its usage to peculiar structures, such as G-quadruplex, which represent a challenging task in nucleic acids modeling. Finally, we used the AptaMat distance as a metric within a clustering study of 291 structures belonging to 14 RFAM families, and we showed its ability to correctly recover the different RFAM families and to detect species peculiarities. These results suggest that AptaMat could also be potentially used for ssNAs sequences annotation, one of the most relevant and challenging bioinformatics tasks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac752_Supplementary_Data</label>
      <media xlink:href="btac752_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by <italic toggle="yes">Centre National de la Recherche Scientifque</italic>, by <italic toggle="yes">Ministère de l’Enseignement Supérieur et de la Recherche</italic> and by the European Union and FEDER (<italic toggle="yes">Fonds Européens de Développement Régional</italic>).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The python code for AptaMat is available at <ext-link xlink:href="https://github.com/GEC-git/AptaMat.git" ext-link-type="uri">https://github.com/GEC-git/AptaMat.git</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac752-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Agius</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Comparing RNA secondary structures using a relaxed base-pair score</article-title>. <source>RNA</source>, <volume>16</volume>, <fpage>865</fpage>–<lpage>878</lpage>.<pub-id pub-id-type="pmid">20360393</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barash</surname><given-names>D.</given-names></string-name>, <string-name><surname>Churkin</surname><given-names>A.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Mutational analysis in RNAs: comparing programs for RNA deleterious mutation prediction</article-title>. <source>Brief. Bioinformatics</source>, <volume>12</volume>, <fpage>104</fpage>–<lpage>114</lpage>.<pub-id pub-id-type="pmid">21422070</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>The protein data bank</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonhoeffer</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>1993</year>) <article-title>RNA multi-structure landscapes - a study based on temperature dependent partition functions</article-title>. <source>Eur. Biophys. J</source>., <volume>22</volume>, <fpage>13</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">7685689</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caliñski</surname><given-names>T.</given-names></string-name>, <string-name><surname>Harabasz</surname><given-names>J.</given-names></string-name></person-group> (<year>1974</year>) <article-title>A dendrite method foe cluster analysis</article-title>. <source>Commun. Stat</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Churkin</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Design of RNAs: comparing programs for inverse RNA folding</article-title>. <source>Brief. Bioinformatics</source>, <volume>19</volume>, <fpage>350</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">28049135</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darty</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>VARNA: interactive drawing and editing of the RNA secondary structure</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1974</fpage>–<lpage>1975</lpage>.<pub-id pub-id-type="pmid">19398448</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Flamm</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2001</year>) <article-title>Design of multistable RNA molecules</article-title>. <source>RNA</source>, <volume>7</volume>, <fpage>254</fpage>–<lpage>265</lpage>.<pub-id pub-id-type="pmid">11233982</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fontana</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>1993</year>) <article-title>Statistics of RNA secondary structures</article-title>. <source>Biopolymers</source>, <volume>33</volume>, <fpage>1389</fpage>–<lpage>1404</lpage>.<pub-id pub-id-type="pmid">7691201</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frey</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Dueck</surname><given-names>D.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Clustering by passing messages between data points</article-title>. <source>Science</source>, <volume>315</volume>, <fpage>972</fpage>–<lpage>976</lpage>.<pub-id pub-id-type="pmid">17218491</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ganser</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The roles of structural dynamics in the cellular functions of RNAs</article-title>. <source>Nat. Rev. Mol. Cell Biol</source>., <volume>20</volume>, <fpage>474</fpage>–<lpage>489</lpage>.<pub-id pub-id-type="pmid">31182864</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giegerich</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2004</year>) <article-title>Abstract shapes of RNA</article-title>. <source>Nucleic Acids Res</source>., <volume>32</volume>, <fpage>4843</fpage>–<lpage>4851</lpage>.<pub-id pub-id-type="pmid">15371549</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gruber</surname><given-names>A.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2008a</year>) <article-title>Strategies for measuring evolutionary conservation of RNA secondary structures</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>122</fpage>.<pub-id pub-id-type="pmid">18302738</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gruber</surname><given-names>A.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2008b</year>) <article-title>The Vienna RNA websuite</article-title>. <source>Nucleic Acids Res</source>., <volume>36</volume>, <fpage>W70</fpage>–<lpage>W74</lpage>.<pub-id pub-id-type="pmid">18424795</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>The dynamic nature of RNA as key to understanding riboswitch mechanisms</article-title>. <source>Acc. Chem. Res</source>., <volume>44</volume>, <fpage>1339</fpage>–<lpage>1348</lpage>.<pub-id pub-id-type="pmid">21678902</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamada</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Prediction of RNA secondary structure using generalized centroid estimators</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>465</fpage>–<lpage>473</lpage>.<pub-id pub-id-type="pmid">19095700</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamming</surname><given-names>R.W.</given-names></string-name></person-group> (<year>1950</year>) <article-title>Error detecting and error correcting codes</article-title>. <source>Bell Syst. Techn. J</source>., <volume>29</volume>, <fpage>147</fpage>–<lpage>160</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herschlag</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>From static to dynamic: the need for structural ensembles and a predictive model of RNA folding and function</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>30</volume>, <fpage>125</fpage>–<lpage>133</lpage>.<pub-id pub-id-type="pmid">25744941</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofacker</surname><given-names>I.L.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Vienna RNA secondary structure server</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>3429</fpage>–<lpage>3431</lpage>.<pub-id pub-id-type="pmid">12824340</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofacker</surname><given-names>I.L.</given-names></string-name></person-group><etal>et al</etal> (<year>1994</year>) <article-title>Fast folding and comparison of RNA secondary structures</article-title>. <source>Monatsh. Chem</source>., <volume>125</volume>, <fpage>167</fpage>–<lpage>188</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>LinearFold: linear-time approximate RNA folding by 5’-to-3’ dynamic programming and beam search</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i295</fpage>–<lpage>i304</lpage>.<pub-id pub-id-type="pmid">31510672</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huttenlocher</surname><given-names>D.P.</given-names></string-name></person-group><etal>et al</etal> (<year>1993</year>) <article-title>Comparing images using the hausdorff distance</article-title>. <source>IEEE Trans. Pattern Anal. Machine Intell</source>., <volume>15</volume>, <fpage>850</fpage>–<lpage>863</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivry</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>An image processing approach to computing distances between RNA secondary structures dot plots</article-title>. <source>Algorithms Mol. Biol</source>., <volume>4</volume>, <fpage>4</fpage>.<pub-id pub-id-type="pmid">19203377</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kalvari</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>192</fpage>–<lpage>200</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Krause</surname><given-names>E.</given-names></string-name></person-group> (<year>1988</year>) <source>Taxicab Geometry: An Adventure in Non-Euclidean Geometry</source>, Vol. <volume>72</volume>. <publisher-name>Dover Publications, New York</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btac752-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kulabhusan</surname><given-names>P.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Current perspectives on aptamers as diagnostic tools and therapeutic agents</article-title>. <source>Pharmaceutics</source>, <volume>12</volume>, <fpage>646</fpage>–<lpage>623</lpage>.<pub-id pub-id-type="pmid">32659966</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Nucleic acid aptamers for molecular diagnostics and therapeutics: advances and perspectives</article-title>. <source>Angew. Chem. Int. Ed</source>., <volume>60</volume>, <fpage>2221</fpage>–<lpage>2231</lpage>.</mixed-citation>
    </ref>
    <ref id="btac752-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Olson</surname><given-names>W.K.</given-names></string-name></person-group> (<year>2003</year>) <article-title>3DNA: a software package for the analysis, rebuilding and visualization of three-dimensional nucleic acid structures</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>5108</fpage>–<lpage>5121</lpage>.<pub-id pub-id-type="pmid">12930962</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matzov</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Cryo-EM structure of the highly atypical cytoplasmic ribosome of <italic toggle="yes">Euglena gracilis</italic></article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>11750</fpage>–<lpage>11761</lpage>.<pub-id pub-id-type="pmid">33091122</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitrovich</surname><given-names>QM</given-names></string-name>, <string-name><surname>Guthrie</surname><given-names>C.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Evolution of small nuclear RNAs in <italic toggle="yes">S. cerevisiae</italic>, <italic toggle="yes">C. albicans</italic>, and other hemiascomycetous yeasts</article-title>. <source>RNA</source>, <volume>13</volume>, <fpage>2066</fpage>–<lpage>2080</lpage>.<pub-id pub-id-type="pmid">17956975</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moulton</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Metrics on RNA secondary structures</article-title>. <source>J. Comput. Biol</source>., <volume>7</volume>, <fpage>277</fpage>–<lpage>292</lpage>.<pub-id pub-id-type="pmid">10890402</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mustoe</surname><given-names>A.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Hierarchy of RNA functional dynamics</article-title>. <source>Annu. Rev. Biochem</source>., <volume>83</volume>, <fpage>441</fpage>–<lpage>466</lpage>.<pub-id pub-id-type="pmid">24606137</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nimjee</surname><given-names>S.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Aptamers as therapeutics</article-title>. <source>Annu. Rev. Pharmacol. Toxicol</source>., <volume>57</volume>, <fpage>61</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">28061688</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M.</given-names></string-name>, <string-name><surname>Major</surname><given-names>F.</given-names></string-name></person-group> (<year>2008</year>) <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>. <source>Nature</source>, <volume>452</volume>, <fpage>51</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">18322526</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reuter</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Mathews</surname><given-names>D.H.</given-names></string-name></person-group> (<year>2010</year>) <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>129</fpage>–<lpage>129</lpage>.<pub-id pub-id-type="pmid">20230624</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sato</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>CentroidFold: a web server for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>W277</fpage>–<lpage>W280</lpage>.<pub-id pub-id-type="pmid">19435882</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shapiro</surname><given-names>B.A.</given-names></string-name></person-group> (<year>1988</year>) <article-title>An algorithm for comparing multiple RNA secondary structures</article-title>. <source>Comput. Appl. Biosci</source>., <volume>4</volume>, <fpage>387</fpage>–<lpage>393</lpage>.<pub-id pub-id-type="pmid">2458170</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Washietl</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <article-title>Fast and reliable prediction of noncoding RNAs</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>2454</fpage>–<lpage>2459</lpage>.<pub-id pub-id-type="pmid">15665081</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Woźniak</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>RNAlign2D: a rapid method for combined RNA structure and sequence-based alignment using a pseudo-amino acid substitution matrix</article-title>. <source>BMC Bioinformatics</source>, <volume>22</volume>, <fpage>504</fpage>.<pub-id pub-id-type="pmid">34656080</pub-id></mixed-citation>
    </ref>
    <ref id="btac752-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zuker</surname><given-names>M.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Mfold web server for nucleic acid folding and hybridization prediction</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>3406</fpage>–<lpage>3415</lpage>.<pub-id pub-id-type="pmid">12824337</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
