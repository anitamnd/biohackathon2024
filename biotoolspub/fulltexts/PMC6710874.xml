<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6710874</article-id>
    <article-id pub-id-type="publisher-id">1791</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1791-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaCarvel: linking assembly graph motifs to biological variants</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ghurye</surname>
          <given-names>Jay</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Treangen</surname>
          <given-names>Todd</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fedarko</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3285-6754</contrib-id>
        <name>
          <surname>Hervey</surname>
          <given-names>W. Judson</given-names>
          <suffix>IV</suffix>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9617-5304</contrib-id>
        <name>
          <surname>Pop</surname>
          <given-names>Mihai</given-names>
        </name>
        <address>
          <email>mpop@umd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0941 7177</institution-id><institution-id institution-id-type="GRID">grid.164295.d</institution-id><institution>Department of Computer Science, </institution><institution>University of Maryland, </institution></institution-wrap>College Park, MD USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0941 7177</institution-id><institution-id institution-id-type="GRID">grid.164295.d</institution-id><institution>Center for Bioinformatics and Computational Biology, </institution><institution>University of Maryland, </institution></institution-wrap>College Park, MD USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8278</institution-id><institution-id institution-id-type="GRID">grid.21940.3e</institution-id><institution>Department of Computer Science, </institution><institution>Rice University, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0591 0193</institution-id><institution-id institution-id-type="GRID">grid.89170.37</institution-id><institution>Center for Bio/Molecular Science &amp; Engineering, </institution><institution>United States Naval Research Laboratory, </institution></institution-wrap>Washington, DC, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>174</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Reconstructing genomic segments from metagenomics data is a highly complex task. In addition to general challenges, such as repeats and sequencing errors, metagenomic assembly needs to tolerate the uneven depth of coverage among organisms in a community and differences between nearly identical strains. Previous methods have addressed these issues by smoothing genomic variants. We present a variant-aware metagenomic scaffolder called MetaCarvel, which combines new strategies for repeat detection with graph analytics for the discovery of variants. We show that MetaCarvel can accurately reconstruct genomic segments from complex microbial mixtures and correctly identify and characterize several classes of common genomic variants.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1791-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenomics</kwd>
      <kwd>Variant detection</kwd>
      <kwd>Scaffolding</kwd>
      <kwd>Assembly</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI100947</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pop</surname>
            <given-names>Mihai</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009917</institution-id>
            <institution>U.S. Naval Research Laboratory</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HASI</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hervey</surname>
            <given-names>W. Judson</given-names>
            <suffix>IV</suffix>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Sequencing of DNA directly extracted from microbial communities (metagenomics) has emerged as a key tool in the exploration of the role microbes play in human and environmental health. Large-scale studies enabled by metagenomic methods, such as MetaHIT [<xref ref-type="bibr" rid="CR1">1</xref>] and the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="CR2">2</xref>], have cataloged the complex microbial communities associated with the human body and have demonstrated their importance to human health. By eliminating the need for culturing, metagenomic sequencing has made it possible to explore a broader range of the microbes inhabiting our world and has led to the discovery of novel organisms and genes from complex samples [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par3">Despite promising initial results, the reconstruction of the entire or even partial organisms from complex microbial mixtures remains a tremendous challenge. The assembly of metagenomic sequences is confounded by several factors: (i) uneven abundance of the different organisms found in a sample, (ii) genomic variation between closely related organisms, (iii) conserved genomic regions shared by distantly related genomes (inter-genomic repeats), and (iv) repetitive DNA within a single genome (intra-genomic repeats). All but the latter challenges are unique to metagenomic data and have not been the target of research until very recently.</p>
    <p id="Par4">Several genome assembly tools designed explicitly for metagenomic data have been developed in recent years. Among the most widely used are metaSPAdes [<xref ref-type="bibr" rid="CR7">7</xref>] and MEGAHIT [<xref ref-type="bibr" rid="CR8">8</xref>]; however, many other tools have been developed including MetaVelvet [<xref ref-type="bibr" rid="CR9">9</xref>], IDBA-UD [<xref ref-type="bibr" rid="CR10">10</xref>], Ray Meta [<xref ref-type="bibr" rid="CR11">11</xref>], and Omega [<xref ref-type="bibr" rid="CR12">12</xref>]. These tools effectively address the uneven coverage of metagenomic datasets, but virtually all of them “smooth out” small differences between co-occurring strains of organisms in order to enable the reconstruction of longer genomic segments from the mixture. Furthermore, the output of the assemblers is simply a collection of linear segments (contigs) that lacks the connection between the segments originating from the same organism. As a result, additional analyses are necessary to discover information about the adjacency of genomic segments (e.g., operon structure in bacteria), or large-scale genomic variants between co-occurring microbial strains. The latter information is of particular research interest in microbial ecology, for example, in the context of the lateral gene transfer [<xref ref-type="bibr" rid="CR13">13</xref>] or understanding how genomic heterogeneity contributes to the stability of microbial communities [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par5">The study of genomic variants in microbial communities is of considerable interest, and a number of computational tools have been developed to discover this information. The approaches are primarily based on read alignments to either complete genomes, as performed for example by metaSNV [<xref ref-type="bibr" rid="CR15">15</xref>] and MIDAS [<xref ref-type="bibr" rid="CR16">16</xref>], or against conserved genes, as performed by ConStrains [<xref ref-type="bibr" rid="CR17">17</xref>] and StrainPhlan [<xref ref-type="bibr" rid="CR18">18</xref>]. Strain variants can also be discovered directly from the output of the assembler, as done, for example, for diploid genomes through a colored de Bruijn graph approach [<xref ref-type="bibr" rid="CR19">19</xref>], or in metagenomic data through the use of the SPQR tree data structure [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par6">The discovery of genomic variants from assembly relies on the information contained in an assembly graph—a representation of the ambiguity in the reconstruction of the genome or metagenome. While many assemblers can output this information, an assembly graph can also be constructed post-assembly by linking together genomic contigs through the information provided by paired reads or other sources of information, using a computational process called scaffolding. While most existing genome and metagenome assemblers [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] contain dedicated scaffolding modules [<xref ref-type="bibr" rid="CR22">22</xref>], the output of these tools comprises linear paths that ignore the presence of genomic variants. An exception is stand-alone scaffolders such as Bambus 2 [<xref ref-type="bibr" rid="CR23">23</xref>] or Marygold [<xref ref-type="bibr" rid="CR20">20</xref>] that explicitly retain ambiguity in the assembly graph and use graph analyses to characterize specific genome variants.</p>
    <p id="Par7">Here we describe a new metagenomic scaffolding package called MetaCarvel, a tool that substantially improves upon the algorithms implemented in Bambus 2 and MaryGold. We show that MetaCarvel generates more contiguous and accurate scaffolds than one of the best performing stand-alone scaffolders, OPERA-LG [<xref ref-type="bibr" rid="CR24">24</xref>], as shown by a recent study [<xref ref-type="bibr" rid="CR25">25</xref>]. We also demonstrate that MetaCarvel is able to accurately detect a number of genomic variants, including regions with divergent sequence, insertion/deletion events, and interspersed repeats. MetaCarvel is released under the MIT open source license and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/MetaCarvel">https://github.com/marbl/MetaCarvel</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par8">Below we demonstrate and evaluate the performance of MetaCarvel by relying on a mixture of synthetic and real metagenomic datasets. We rely on mixtures of <italic>Acinetobacter baumanii</italic> strains sequenced as part of surveillance of a healthcare institution [<xref ref-type="bibr" rid="CR26">26</xref>] to reveal the impact of heterogeneity on the quality of genome assemblies and to demonstrate that MetaCarvel can detect regions of high sequence divergence. The ability of MetaCarvel to detect insertion/deletion events is determined within a mixture of sequencing data derived from two <italic>Escherichia coli</italic> strains—organism characterized by the extensive horizontal transfer of genes, while <italic>Yersinia pestis</italic>, due to its well-characterized repertoire of genomic repeats, provides a good test case for MetaCarvel’s ability to detect repeats. Two synthetic datasets are used to evaluate the performance of MetaCarvel on more complex communities where the sequence of all the organisms in the mixture are known—the MBARC-26 dataset representing real sequencing data of a synthetic mixture of cells [<xref ref-type="bibr" rid="CR27">27</xref>] and the simulated dataset created by the CAMI project [<xref ref-type="bibr" rid="CR28">28</xref>]. Finally, we present the results obtained by analyzing real metagenomics datasets from the Human Microbiome Project [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <sec id="Sec3">
      <title>Effect of microbial mixtures on scaffolding</title>
      <p id="Par9">We compared the performance of MetaCarvel to that of OPERA-LG [<xref ref-type="bibr" rid="CR24">24</xref>], using both single genomes and an increasingly complex mixture of genomes. We used reads from five different strains of <italic>Acinetobacter baumanii</italic> (NCBI Short Read Archive accessions SRR1008889, SRR1030406, SRR1019232, SRR1030403, and SRR1030473) and assembled them using both MEGAHIT [<xref ref-type="bibr" rid="CR8">8</xref>] and metaSPAdes [<xref ref-type="bibr" rid="CR7">7</xref>]. We chose <italic>Acinetobacter baumanii</italic> due to the availability of a high-quality reference and high-quality assemblies of multiple strains in public databases. These specific strains were selected because their assemblies were of high and similar quality and because they diverged sufficiently from each other to reveal the impact of strain variants on the quality of assembly and scaffolding.</p>
      <p id="Par10">To simulate the impact on scaffolding performance of increasing levels of genome heterogeneity among closely related organisms, we created increasingly complex mixtures comprising from one to five genomes. We aligned the paired reads to the resulting assemblies and used MetaCarvel and OPERA-LG to perform scaffolding. As expected, as more genomes are added to the mixture, the quality of the assembly degrades and so does the quality of the resulting scaffolds (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). Even in the case of the assembly of a single genome, scaffolding with MetaCarvel improves contiguity, albeit by only a small amount (13.31 kbp contig NG50 vs.18.51 kbp scaffold NG50 using MEGAHIT and 16.96 kbp contig NG50 vs. 18.99 kbp scaffold NG50 using metaSPAdes). The contiguity of the scaffolds generated by MetaCarvel substantially improves over the original assembly for the more complex samples. When compared to metaSPAdes scaffolds (generated using the scaffolding module built within this assembler), MetaCarvel’s scaffold contiguity was at least as good as metaSPAdes scaffolds for all mixtures (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The contiguity of the scaffolds degrades slower than that of the scaffolds generated by OPERA-LG even as the contiguity of the underlying contigs created by MEGAHIT and metaSPAdes degrades rapidly with the increase in complexity of the mixture.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Scaffold statistics for <italic>Acinetobacter baumannii</italic> strain mixtures. <bold>a</bold> NG50 statistics when MEGAHIT contig assembly was used as an input for scaffolding methods. <bold>b</bold> NG50 statistics when metaSPAdes contig assembly was used as in input for scaffolding methods. metaSPAdes(S) denotes the scaffolds generated by inbuilt scaffolding module of metaSPAdes. The percentage of reads aligned concordantly when <bold>c</bold> MEGAHIT assembly was used as an input and when <bold>d</bold> metaSPAdes assembly was used as an input. <bold>e</bold> Number of bubbles detected by MetaCarvel for different input assemblies. <bold>f</bold> The count of different types of variants in <italic>Acinetobacter</italic> strain mixtures. Complex bubbles denote all the bubbles containing five or more nodes</p></caption><graphic xlink:href="13059_2019_1791_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par11">To measure the correctness of the assemblies, we computed the number of mate pairs mapped concordantly, that is, the mate pairs whose two ends are properly oriented with respect to each other and the distance between the paired reads is within the insert size limit implied by the library. This measure is correlated with assembly quality as misassemblies, or fragmented contigs and scaffolds, result in unmapped reads and discordant mate pairs. For all the mixtures and both assemblers, MetaCarvel scaffolds had the highest number of concordant mate pairs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d).</p>
      <p id="Par12">As the number of genomes in a mixture increased so did the number of genomic variants detected by MetaCarvel (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). The number of variants detected by MetaCarvel increased when adding more genomes to the mixture (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f) across all the categories of features identified by the software: repeats, three-node bubbles (insertions/deletions), four-node bubbles (strain variations), and complex rearrangements (five or more node bubbles). A sample pattern of variation is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. In this example, the parallel contigs differed by about 3% nucleotide identity, a value larger than the amount of error tolerated by the assemblers. We observed that the number of variants detected by MetaCarvel was much higher when using MEGAHIT assemblies compared to metaSPAdes. However, the contiguity of scaffolds generated with metaSPAdes was higher than that of scaffolds relying on MEGAHIT.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Variants detected in one of the components of <italic>Acinetobacter baumanii</italic> scaffold graph. In this component, we find all the non-terminal nodes in a bubble are more than 97% identical to each other and originate from two different strains of <italic>Acinetobacter baumannii</italic> genome</p></caption><graphic xlink:href="13059_2019_1791_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Detection of regions with high sequence variation</title>
      <p id="Par13">To evaluate the accuracy of sequence variants (four-node bubbles, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) detected by MetaCarvel, we used reads from two strains of <italic>Acinetobacter baumannii</italic> genome that are distantly related (SRR1171982 and SRR1200567) [<xref ref-type="bibr" rid="CR26">26</xref>]. We co-assembled the reads with MEGAHIT and ran MetaCarvel’s variant detection on the resulting assembly. We aligned the contigs to the <italic>Acinetobacter baumannii</italic> 1656-2 reference genome sequence (NCBI ID: NC_017162). The contigs which aligned at a same position in the reference genome were inferred to have originated from the true variants. MetaCarvel detected 191 variants in this graph, among which 184 overlapped with variants identified by alignment to the reference genome. In the remaining 7 variants which could not be validated using the strain 1656-2, the contigs from these variants were perfectly aligned to <italic>Acinetobacter baumannii</italic> strain AR_0078, <italic>Acinetobacter baumannii</italic> strain XH731, and <italic>Acinetobacter baumannii</italic> strain 15A34. For the remaining bubbles, the contigs in those bubbles did not align to any known strain of <italic>Acinetobacter baumannii</italic> with high identity, suggesting possible misassemblies. We also performed a similar analysis on a mixture of <italic>Escherichia coli</italic> K12 and <italic>Escherichia coli</italic> O83:H1 genomes. In this case, to flag a true variation, we check if contigs in a bubble are aligned to both the strains with high identity over at least 95% of their length. With this definition, 28 of 31 bubbles found by MetaCarvel matched actual variants, implying 90.3% precision.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Different types of motifs detected by MetaCarvel. <bold>a</bold> Four-node bubbles denote the variation between very similar sequences. They can result in the graph due to the species with very high sequence similarity. <bold>b</bold> Three-node bubbles potentially represent gene gain/loss events and horizontal gene transfers. They are formed due to the insertion or deletion of chunks between two otherwise similar genomes. <bold>c</bold> Interspersed repeats in the graph are denoted by the nodes with high centrality and usually tangle the graph</p></caption><graphic xlink:href="13059_2019_1791_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Accuracy of detecting insertions and deletions</title>
      <p id="Par14">To verify the accuracy of detecting insertion and deletions, we used MEGAHIT to co-assemble reads from two strains of <italic>Escherichia coli</italic> for which fully complete reference sequences are available: <italic>Escherichia coli</italic> K12 (NCBI sequence read archive accession: ERR022075) and <italic>Escherichia coli</italic> O83:H1 (NCBI sequence read archive accession: SRR6512538). We scaffolded the resulting assembly using MetaCarvel and flagged as predicted insertion/deletion events the three-node bubbles (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>b) found within the resulting scaffolds. To characterize the true insertion and deletion events between these two <italic>Escherichia coli</italic> genomes, we aligned them to each other using NUCmer and extracted the regions flagged as “GAP” by the <italic>dnadiff</italic> utility from the MUMmer package [<xref ref-type="bibr" rid="CR29">29</xref>]. We determined that a three-node bubble represented a true insertion/deletion event if the middle contig of the variant aligned within one of these regions. Of 126 three-node bubbles detected by MetaCarvel, 81 were found concordant with the insertion/deletion events identified by MUMmer (64.2% precision). A total of 194 contigs aligned to gap regions within the <italic>E</italic>. <italic>coli</italic> genomes, implying a specificity of 73.1%. Some of the false negatives (32) were due to the parameters used in MetaCarvel to eliminate low-quality edges in the graph, while the remaining false negatives were due to the fact that the insertion/deletion event coincided with other genomic phenomena, leading to a graph motif that was inconsistent with our definition of a three-node bubble.</p>
    </sec>
    <sec id="Sec6">
      <title>Effectiveness in detecting repeats</title>
      <p id="Par15">To determine the accuracy of interspersed repeat detection (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), we used reads from <italic>Yersinia pestis</italic> CO92 genome (Genebank ID: AL590842.1) as this genome has well characterized interspersed repeats [<xref ref-type="bibr" rid="CR30">30</xref>]. We assembled the reads (SRA ID: SRR069183) using MEGAHIT and then scaffolded the assembly with MetaCarvel. To define a ground truth, we aligned the contigs to the <italic>Yersinia pestis</italic> genome using NUCmer [<xref ref-type="bibr" rid="CR29">29</xref>] (with --maxmatch option) and flagged as repeats all contigs aligned at more than one location with at least 95% identity and 95% alignment length. The precision and recall of MetaCarvel’s repeat detection algorithm were 14.86% and 71.73% respectively. We compared this result to the algorithm used in OPERA-LG which detects repeats using sequence coverage alone (contigs with 1.5 times the average coverage of the genome are flagged as repeats). Within the same assembly of <italic>Yersinia pestis</italic>, OPERA-LG’s repeat finding approach has precision and recall of 9.06% and 67.39%, respectively (Table <xref rid="Tab1" ref-type="table">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of the accuracy of repeat detection in MetaCarvel and OPERA-LG on different datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Method</th><th>True repeats</th><th>Predicted repeats</th><th>True positives</th><th>False positives</th><th>True negatives</th><th>False negatives</th><th>Precision (%)</th><th>Recall (%)</th></tr></thead><tbody><tr><td rowspan="2"><italic>Yersinia pestis</italic></td><td>OPERA-LG</td><td>46</td><td>353</td><td>31</td><td>322</td><td>904</td><td>15</td><td>9.06</td><td>67.39</td></tr><tr><td>MetaCarvel</td><td>46</td><td>222</td><td>33</td><td>189</td><td>1037</td><td>13</td><td>14.86</td><td>71.73</td></tr><tr><td rowspan="2">MBARC-26</td><td>OPERA-LG</td><td>532</td><td>771</td><td>356</td><td>415</td><td>21,215</td><td>176</td><td>47.34</td><td>66.91</td></tr><tr><td>MetaCarvel</td><td>532</td><td>454</td><td>438</td><td>16</td><td>21,614</td><td>94</td><td>96.47</td><td>85.33</td></tr><tr><td rowspan="2">CAMI (M)</td><td>OPERA-LG</td><td>3809</td><td>4568</td><td>2989</td><td>1579</td><td>154,936</td><td>820</td><td>65.43</td><td>78.74</td></tr><tr><td>MetaCarvel</td><td>3809</td><td>4301</td><td>3317</td><td>984</td><td>155,531</td><td>492</td><td>77.12</td><td>87.08</td></tr><tr><td rowspan="2">CAMI (H)</td><td>OPERA-LG</td><td>12,666</td><td>27,625</td><td>7078</td><td>20,547</td><td>1,157,503</td><td>5558</td><td>25.62</td><td>56.01</td></tr><tr><td>MetaCarvel</td><td>12,666</td><td>9219</td><td>7266</td><td>1953</td><td>1,176,067</td><td>5400</td><td>78.81</td><td>57.36</td></tr></tbody></table></table-wrap></p>
      <p id="Par16">Further, we assessed MetaCarvel’s repeat detection accuracy on a synthetic metagenomic dataset (MBARC-26) described in Singer et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. This dataset (MBARC-26) consists of a mixture of 23 bacterial and three archaeal stains, across 10 different phyla and 14 classes, as well as a wide range of GC and repeat content. We assembled the reads using MEGAHIT, and the resulting contigs were aligned to the reference genomes using NUCmer (with --maxmatch option). In this case, the precision and recall of MetaCarvel’s repeat detection were 96.47% and 85.33%, respectively, compared to 47.34% and 66.91% for OPERA-LG (Table <xref rid="Tab1" ref-type="table">1</xref>). The repeats missed by MetaCarvel had inconsistent read alignments and hence were not part of the scaffold graph. Of the 16 false positives obtained from MetaCarvel, 8 of them were marked with “high coverage node” as one of the features and 3 of them were marked based on high betweenness centrality (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section for details).</p>
    </sec>
    <sec id="Sec7">
      <title>Evaluation of scaffold quality using synthetic datasets</title>
      <p id="Par17">We evaluated MetaCarvel’s scaffold quality on the MBARC-26 dataset [<xref ref-type="bibr" rid="CR27">27</xref>]. Due to the high depth of sequencing coverage and relatively low complexity of the mixture, the assembly of the full dataset resulted in large contigs and few opportunities for scaffolding algorithms to improve contiguity. Only 0.051% of mate pairs spanned the gap between contigs, thereby not providing linking information for scaffolding. To provide a more challenging situation, we downsampled the total number of reads 1000-fold. We assembled the downsampled data using MEGAHIT with default parameters. To derive linkages between contigs based on mate pair information, we aligned the reads to the assembled contigs using bowtie2 (with parameters -end-to-end -p 12) [<xref ref-type="bibr" rid="CR31">31</xref>]. We then used MetaCarvel and OPERA-LG to scaffold these assemblies. Since we know the reference genome sequences for this dataset, we could use metaQUAST [<xref ref-type="bibr" rid="CR32">32</xref>] to assess the accuracy of the resulting scaffolds. As seen in Table <xref rid="Tab1" ref-type="table">1</xref>, MetaCarvel had fewer misassemblies and better contiguity than OPERA-LG, even in this relatively simple community.</p>
      <p id="Par18">We also assembled the data using metaSPAdes (with default parameters), an assembler specifically developed for metagenomic data that also includes a scaffolding module. We scaffolded metaSPAdes contigs with MetaCarvel and OPERA-LG and used metaQUAST to evaluate scaffold accuracy. As seen in Table <xref rid="Tab2" ref-type="table">2</xref>, the number of misassemblies in MetaCarvel scaffolds was lower than that in OPERA-LG but higher than that in metaSPAdes scaffolds. MetaSPAdes scaffolds had fewer misassemblies because their scaffolding module is tightly coupled with the assembly module, hence uses more information obtained from the assembly graph to generate scaffolds. The contiguity of MetaCarvel scaffolds was better than that of both metaSPAdes and OPERA-LG scaffolds.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of MetaCarvel with OPERA-LG on a synthetic metagenomics datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Method</th><th>Number of scaffolds</th><th>Assembly size (Mbp)</th><th>Misassemblies</th><th>Largest scaffold (kbp)</th><th>Scaffolds &gt; 50 kbp</th><th>Length at 1 Mbp (kbp)</th><th>Length at 10 Mbp (kbp)</th><th>Length at 50 Mbp (kbp)</th></tr></thead><tbody><tr><td rowspan="5">MBARC-26</td><td>MEGAHIT + OPERA-LG</td><td>22,597</td><td>87.5</td><td>207</td><td>473.2</td><td>180</td><td>319.2</td><td>97.0</td><td>2.3</td></tr><tr><td>MEGAHIT + MetaCarvel</td><td>19,879</td><td>88.0</td><td>99</td><td>287.3</td><td>177</td><td>287.3</td><td>154.3</td><td>9.1</td></tr><tr><td>metaSPAdes + OPERA-LG</td><td>4931</td><td>98.7</td><td>148</td><td>2331.2</td><td>412</td><td>2055.2</td><td>944.0</td><td>177.1</td></tr><tr><td>metaSPAdes + MetaCarvel</td><td>5137</td><td>99.8</td><td>68</td><td>199.1</td><td>298</td><td>1810.2</td><td>1125.0</td><td>199.4</td></tr><tr><td>metaSPAdes scaffolds</td><td>5333</td><td>98.3</td><td>55</td><td>199.1</td><td>410</td><td>1810.2</td><td>925.6</td><td>158.3</td></tr><tr><td rowspan="2">CAMI medium</td><td>MEGAHIT + OPERA-LG</td><td>157,389</td><td>271.7</td><td>1669</td><td>854.1</td><td>527</td><td>825.4</td><td>404.6</td><td>73.1</td></tr><tr><td>MEGAHIT + MetaCarvel</td><td>158,340</td><td>271.5</td><td>1793</td><td>854.1</td><td>520</td><td>825.4</td><td>418.2</td><td>74.5</td></tr><tr><td rowspan="2">CAMI high</td><td>MEGAHIT + OPERA-LG</td><td>1,188,757</td><td>1121.8</td><td>23,224</td><td>613.6</td><td>824</td><td>581.5</td><td>299.8</td><td>96.6</td></tr><tr><td>MEGAHIT + MetaCarvel</td><td>1,185,065</td><td>1121.2</td><td>22,401</td><td>1089.6</td><td>847</td><td>613.6</td><td>304.5</td><td>101.8</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec8">
      <title>Evaluation using CAMI-simulated metagenome datasets</title>
      <p id="Par19">To further test the accuracy of MetaCarvel on complex simulated communities, we used the data for medium and high complexity metagenome communities released in CAMI challenge [<xref ref-type="bibr" rid="CR28">28</xref>]. We assembled the reads in these datasets using MEGAHIT and used MetaCarvel and OPERA-LG for scaffolding. We were not able to run metaSPAdes on either of these datasets as the memory requirement exceeded 150 Gb. We used the reference genomes provided by the CAMI consortium to evaluate scaffold accuracy. On both medium and high complexity datasets, we observed that MetaCarvel’s repeat classification accuracy was better than OPERA-LG, although the recall was low for detecting repeats in the high complexity dataset (Table <xref rid="Tab1" ref-type="table">1</xref>). In the medium complexity dataset, the contiguity was similar for OPERA-LG and MetaCarvel with the number of misassemblies lower for OPERA-LG (Table <xref rid="Tab2" ref-type="table">2</xref>). In the high complexity dataset, MetaCarvel scaffolds were more contiguous with fewer misassemblies than OPERA-LG. This evaluation shows that MetaCarvel’s repeat detection and scaffolding works better on complex metagenomic communities than OPERA-LG.</p>
    </sec>
    <sec id="Sec9">
      <title>Evaluation using real metagenomics data</title>
      <p id="Par20">We tested the effectiveness of MetaCarvel on four samples from the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="CR2">2</xref>]. We chose two stool samples (SRS020233, SRS049959), one supragingival plaque sample (SRR2241598), and a posterior fornix sample (SRS024310). The stool samples represent complex communities and have high depths of sequencing coverage and the plaque sample has lower complexity but relatively high coverage, while the posterior fornix has a lower depth of coverage due to the high level of host contamination (more than 80% human DNA) [<xref ref-type="bibr" rid="CR2">2</xref>]. Table <xref rid="Tab3" ref-type="table">3</xref> shows the comparison of different scaffolding approaches on these samples. Since the composition of these samples is unknown, we could not use reference-based methods to evaluate scaffold accuracy. Instead we computed the number of mate pairs that map concordantly to the resulting scaffold. For all the samples, MetaCarvel had a higher number of concordant mate pairs compared to OPERA-LG when the MEGAHIT assembly was used. Even when scaffolding metaSPAdes assemblies, MetaCarvel had the highest number of concordant mate pairs. Also, the total number of concordant mate pairs was higher for both OPERA-LG and MetaCarvel scaffolds when using the MEGAHIT assembly compared to the metaSPAdes assembly as an input. Since a metagenomic assembly does not have a known total genome size, the use of measures such as N50 and NG50 (commonly used for comparing the contiguity of isolate genome assemblies) is not appropriate. To assess the contiguity of scaffolds in a way that can be compared across assemblies of a dataset, we first sort the scaffolds in decreasing order of their lengths. Then, we start adding the lengths of scaffolds until a particular target length is reached (1 Mbp, 10 Mbp, and 50 Mbp in our case). The length of the scaffold at which the total sum of the length-sorted scaffolds exceeded the target length becomes the statistic to assess contiguity of the scaffolds. In other words, “size at 10 Mbp” represents the longest length <italic>L</italic> such that the sum of all scaffold lengths longer than <italic>L</italic> adds up to 10 Mbp or above. In most cases, MetaCarvel scaffolds had the highest contiguity. Particularly, the best results were obtained by scaffolding with MetaCarvel the contigs that were generated by metaSPAdes. The high contiguity and the high number of concordant mate pairs in MetaCarvel scaffolds can be attributed to its ability to resolve the bubbles in the connected components and generate the scaffolds which pass through the bubbles, whereas OPERA-LG broke the scaffolds where there was a boundary between a variant and a linear path (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). As a result, the mate pairs spanning these junctions were not explained by OPERA-LG scaffolds.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of reference-free assembly statistics for real metagenomic datasets generated in the HMP project </p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Method</th><th>#Scaffolds</th><th>Assembly size (Mbp)</th><th>#Scaffolds &gt; 50 kbp</th><th>Largest scaffold (kbp)</th><th>#Concordant mate pairs</th><th>Length at 1 Mbp (kbp)</th><th>Length at 10 Mbp (kbp)</th><th>Length at 50 Mbp (kbp)</th></tr></thead><tbody><tr><td rowspan="5">SRS049959</td><td>OPERA-LG</td><td>198,206</td><td>273.2</td><td>473</td><td>530.1</td><td>97,428,296 (82.1%)</td><td>258.6</td><td>126.3</td><td>38.9</td></tr><tr><td>MetaCarvel</td><td>108,437</td><td>277.0</td><td>487</td><td>518.2</td><td>98,107,950 (85.5%)</td><td>356.7</td><td>154.1</td><td>39.5</td></tr><tr><td>metaSPAdes</td><td>98,318</td><td>268.3</td><td>489</td><td>476.5</td><td>91,870,816 (80.0%)</td><td>422.8</td><td>164.1</td><td>44.8</td></tr><tr><td>OPERA-LG (M)</td><td>97,486</td><td>267.7</td><td>518</td><td>476.5</td><td>91,948,044 (80.1%)</td><td>405.1</td><td>162.2</td><td>47.0</td></tr><tr><td>MetaCarvel (M)</td><td>98,073</td><td>268.1</td><td>492</td><td>868.8</td><td>92,183,496 (80.3%)</td><td>749.8</td><td>211.0</td><td>49.2</td></tr><tr><td rowspan="5">SRS020233</td><td>OPERA-LG</td><td>128,250</td><td>279.8</td><td>393</td><td>381.6</td><td>91,464,778 (84.9%)</td><td>286.5</td><td>139.7</td><td>35.4</td></tr><tr><td>MetaCarvel</td><td>141,438</td><td>282.5</td><td>421</td><td>430.2</td><td>92,077,670 (86.9%)</td><td>368.6</td><td>154.3</td><td>37.8</td></tr><tr><td>metaSPAdes</td><td>122,613</td><td>279.6</td><td>437</td><td>573.8</td><td>91,577,014 (85.9%)</td><td>351.9</td><td>163.9</td><td>40.9</td></tr><tr><td>OPERA-LG (M)</td><td>122,143</td><td>279.9</td><td>459</td><td>573.8</td><td>91,622,740 (85.3%)</td><td>372.1</td><td>158.3</td><td>42.4</td></tr><tr><td>MetaCarvel (M)</td><td>122,776</td><td>280.8</td><td>471</td><td>587.2</td><td>91,840,800 (85.3%)</td><td>584.7</td><td>187.1</td><td>44.7</td></tr><tr><td rowspan="5">SRR2241511</td><td>OPERA-LG</td><td>631</td><td>284.4</td><td>5</td><td>962.9</td><td>12,618,990 (83.9%)</td><td>19.3</td><td>NA</td><td>NA</td></tr><tr><td>MetaCarvel</td><td>533</td><td>285.9</td><td>6</td><td>126.1</td><td>12,665,752 (84.2%)</td><td>27.7</td><td>NA</td><td>NA</td></tr><tr><td>metaSPAdes</td><td>774</td><td>334.5</td><td>4</td><td>570.3</td><td>13,838,686 (91.0%)</td><td>20.6</td><td>NA</td><td>NA</td></tr><tr><td>OPERA-LG (M)</td><td>733</td><td>334.3</td><td>6</td><td>124.9</td><td>12,875,136 (85.6%)</td><td>20.9</td><td>NA</td><td>NA</td></tr><tr><td>MetaCarvel (M)</td><td>652</td><td>335.4</td><td>11</td><td>126.3</td><td>12,910,216 (85.9%)</td><td>37.74</td><td>NA</td><td>NA</td></tr><tr><td rowspan="5">SRR2241598</td><td>OPERA-LG</td><td>60,601</td><td>117.6</td><td>75</td><td>217.4</td><td>19,423,228 (51.6%)</td><td>148.3</td><td>35.1</td><td>4.1</td></tr><tr><td>MetaCarvel</td><td>56,503</td><td>119.1</td><td>100</td><td>319.2</td><td>20,047,708 (54.0%)</td><td>184.2</td><td>46.6</td><td>5.7</td></tr><tr><td>metaSPAdes</td><td>48,403</td><td>113.6</td><td>102</td><td>417.4</td><td>16,771,928 (45.2%)</td><td>206.9</td><td>46.5</td><td>6.2</td></tr><tr><td>OPERA-LG (M)</td><td>43,908</td><td>109.4</td><td>105</td><td>282.9</td><td>16,749,600 (45.1%)</td><td>206.9</td><td>47.9</td><td>6.6</td></tr><tr><td>MetaCarvel (M)</td><td>42,927</td><td>110.2</td><td>190</td><td>417.4</td><td>16,893,882 (45.5%)</td><td>336.43</td><td>97.5</td><td>8.7</td></tr></tbody></table><table-wrap-foot><p>For the concordant mate pairs, the number in the parenthesis denotes the percentage of total read pairs mapped concordantly to scaffolds. In methods, (M) denotes scaffolds generated using metaSPAdes contigs as input to MetaCarvel and OPERA-LG</p></table-wrap-foot></table-wrap>
<fig id="Fig4"><label>Fig. 4</label><caption><p>A component in the scaffold graph for the HMP stool sample. The highlighted nodes in the graph denote the path taken by MetaCarvel to generate the scaffold in this component, and the red lines denote the scaffolds generated by OPERA-LG. It can be observed that at the boundaries of the regions of variation, OPERA-LG breaks scaffolds thereby not using the information provided by the paired-end reads to generate contiguous and accurate scaffolds</p></caption><graphic xlink:href="13059_2019_1791_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Effect of sequencing coverage on metagenome scaffolding</title>
      <p id="Par21">To assess the impact of sequencing depth on the scaffolding algorithm, we downsampled the synthetic mock community dataset MBARC-26 [<xref ref-type="bibr" rid="CR27">27</xref>] to a range of total number of reads between 2 million and 14 million and used the resulting assemblies as input for OPERA-LG, MetaCarvel, and metaSPAdes. Note that the input assembly for OPERA-LG and MetaCarvel was generated using MEGAHIT, while metaSPAdes scaffolds were generated using the built-in scaffolding module. As expected, at low depths of coverage, the contig and scaffold contiguity was poor but improved as more reads were added (Table <xref rid="Tab4" ref-type="table">4</xref>).
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance comparison of different scaffolders based on varying the sequencing depth on the MBARC-26 dataset. </p></caption><table frame="hsides" rules="groups"><thead><tr><th>Input size (millions of reads)</th><th>Metric</th><th>No. of scaffolds</th><th>Length at 1 Mbp (bp)</th><th>Length at 10 Mbp (bp)</th><th>Length at 50 Mbp (bp)</th><th>CPU time</th><th>Peak memory (GB)</th></tr></thead><tbody><tr><td rowspan="3">2</td><td>OPERA-LG</td><td>29,831</td><td>988,539</td><td>90,227</td><td>719</td><td>44 s</td><td>2.2</td></tr><tr><td>metaSPAdes</td><td>61,592</td><td>594,287</td><td>92,217</td><td>783</td><td>NA</td><td>8.2</td></tr><tr><td>MetaCarvel</td><td>29,883</td><td>699,981</td><td>90,014</td><td>718</td><td>58 s</td><td>2.1</td></tr><tr><td rowspan="3">4</td><td>OPERA-LG</td><td>22,952</td><td>1,257,853</td><td>168,019</td><td>4393</td><td>2 min 16 s</td><td>2.8</td></tr><tr><td>metaSPAdes</td><td>49,199</td><td>1,635,634</td><td>190,132</td><td>3823</td><td>NA</td><td>10.1</td></tr><tr><td>MetaCarvel</td><td>23,003</td><td>1,257,853</td><td>168,390</td><td>4374</td><td>2 min 48 s</td><td>3</td></tr><tr><td rowspan="3">8</td><td>OPERA-LG</td><td>21,866</td><td>1,257,855</td><td>393,755</td><td>34,351</td><td>3 min 13 s</td><td>4</td></tr><tr><td>metaSPAdes</td><td>39,460</td><td>1,635,634</td><td>190,132</td><td>31,823</td><td>NA</td><td>14.3</td></tr><tr><td>MetaCarvel</td><td>23,003</td><td>1,223,449</td><td>423,739</td><td>32,331</td><td>3 min 47 s</td><td>3.8</td></tr><tr><td rowspan="3">10</td><td>OPERA-LG</td><td>21,413</td><td>1,257,855</td><td>402,996</td><td>50,874</td><td>8 min 01 s</td><td>5</td></tr><tr><td>metaSPAdes</td><td>35,754</td><td>1,635,634</td><td>478,925</td><td>52,165</td><td>NA</td><td>22.5</td></tr><tr><td>MetaCarvel</td><td>21,033</td><td>1,332,109</td><td>418,821</td><td>49,839</td><td>10 min 41 s</td><td>5.2</td></tr><tr><td rowspan="3">14</td><td>OPERA-LG</td><td>18,370</td><td>1,461,964</td><td>676,339</td><td>72,581</td><td>14 min 08 s</td><td>8.1</td></tr><tr><td>metaSPAdes</td><td>29,298</td><td>1,635,789</td><td>668,856</td><td>78,337</td><td>NA</td><td>28.1</td></tr><tr><td>MetaCarvel</td><td>18,281</td><td>1,463,318</td><td>686,311</td><td>73,522</td><td>13 min 14 s</td><td>7.4</td></tr></tbody></table><table-wrap-foot><p>The runtime for metaSPAdes is not mentioned (marked NA) since we cannot separate the assembly from the scaffolding steps. Maximum contig size is the same for OPERA-LG and MetaCarvel because the same input assembly was used as input to them</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>Computational requirements of MetaCarvel</title>
      <p id="Par22">The computational requirements of MetaCarvel mainly depend on the size of the assembly graph, specifically the number of contigs in the assembly and the number of links between these contigs. The input assembly for the MBARC-26 dataset (~ 20 million reads) had 19,326 contigs, and its scaffolding required peak memory of 8.2 GB with the CPU runtime of 18 min. For the scaffolding of stool sample (SRS049959, ~ 54 million reads), the number of contigs in the input assembly was 214,985 and its scaffolding required peak memory of 38.7 GB and CPU runtime of 88 min. Table <xref rid="Tab4" ref-type="table">4</xref> lists the runtime and memory requirements for scaffolding with different number of reads. The runtime and memory requirements increase as a greater number of reads are used. The growth is supra-linear because the runtime of scaffolding algorithm mainly depends on the number of edges in the scaffold graph, which can grow quadratically in the worst case. The runtime and memory requirements for OPERA-LG and MetaCarvel were comparable for all the sequencing coverages.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par23">We described a stand-alone metagenomics variant detection and scaffolding method MetaCarvel and showed its effectiveness on synthetic and real metagenomics datasets of varying complexity. Unlike most of the existing scaffolders which only output linearized sequences of scaffolds, MetaCarvel outputs a list of variants along with the graph used to call variants. This information can help biologists to explore interesting graph patterns within the assembly and investigate the biological implications of the corresponding genomic variants.</p>
    <p id="Par24">To allow a quantitative evaluation of variant detection, we focused our validation on simple types of genomic variants that involve three or four contigs. MetaCarvel does detect more complex variants, which are, however, difficult to validate in an automated fashion. This functionality sets MetaCarvel apart from other tools available for identifying strain variants in microbial communities, tools which primarily rely on reference genomes or conserved genes to characterize microbial strains. The approach taken by MetaCarvel is complementary to approaches based on marker genes, such as StrainPhlAn [<xref ref-type="bibr" rid="CR18">18</xref>]. The combination of the two approaches represents a promising direction for future research, leading to effective approaches for characterizing novel genomic fragments while placing them within the context of the fine grained taxonomic information derived from marker genes.</p>
    <p id="Par25">The effectiveness of the approach implemented in MetaCarvel critically depends on the data available to the scaffolding module. Note that the lack of contiguity manifests due to two reasons: (i) lack of contiguity in the assembly used as an input to the scaffolding algorithm and (ii) lack of linking information available for scaffolding algorithms to join contigs into scaffolds. MetaCarvel can only detect variants if the corresponding contigs are covered at high enough depth and if mate pairs or other information provide links between adjacent contigs. The analysis is also greatly improved if the underlying assembly is conservative—assemblers that aggressively attempt to “smooth out” genomic variants in order to obtain long genomic contigs end up removing exactly the information that MetaCarvel is designed to detect. We, thus, suggest that scientists interested in strain variation explore multiple assemblies of datasets, using different metagenomic assemblers run with different parameter choices, rather than relying on published assemblies or using the most popular assembler run with default parameters.</p>
    <p id="Par26">&gt;Beyond the choice of parameters for the assembler used to generate the input to MetaCarvel, users can also control the number of links required to construct an edge between adjacent contigs. If this threshold is low, the graph can have many spurious edges, leading to longer runtime, reducing the accuracy of repeat detection, and complicating variant discovery. If this threshold is high, the graph becomes disconnected leading to a degraded ability to discover variants, and low scaffold contiguity. Although the repeat detection procedure used in MetaCarvel does not expose any parameters to the end user, its accuracy depends on the number of features that provide evidence of contig’s repetitiveness—features that are also related to the density of links in the scaffold graphs.</p>
    <p id="Par27">In closing, we would like to stress that the study of strain variation within microbial communities is in its infancy, in no small part due to the relative dearth of appropriate datasets and analytic tools. Tools such as MetaCarvel, StrainPhlAn, and others are just a first step towards the development of an effective toolkit for the discovery and characterization of genomic variants. Of particular interest will be the development of approaches able to infer the functional implications of strain variants, ultimately leading to a better understanding of the principles underlying microbial adaptation and community structure.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <p id="Par28">MetaCarvel operates as a series of discrete steps that construct and progressively refine a graph linking together assembled contigs with the information provided by mate pair or paired-end reads (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Currently, we determine the links between contigs by remapping the paired reads to an assembly constructed by a metagenomic assembler. This step is necessary as current assemblers do not provide information about the placement of individual reads within the assembled contigs. When such information is available, MetaCarvel can directly use it, currently accepting the information in SAM/BAM formats.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Overview of the MetaCarvel pipeline: First, reads are aligned to assembled contigs. Using these alignments, a scaffold graph is constructed by bundling the link implying same contig orientation. In this graph, repeats are identified and removed. In the repeat removed scaffold graph, first variants are detected, and variant-aware contig layout is performed to generate final scaffolds. The output of the MetaCarvel pipeline is the sequences for scaffolds and the list of variants found in the scaffold graph</p></caption><graphic xlink:href="13059_2019_1791_Fig5_HTML" id="MO5"/></fig></p>
    <sec id="Sec14">
      <title>Contig graph construction</title>
      <p id="Par29">MetaCarvel begins by aligning paired-end reads to assembled contigs using a standard short read aligner such as BWA [<xref ref-type="bibr" rid="CR33">33</xref>] or bowtie2 [<xref ref-type="bibr" rid="CR31">31</xref>]. The reads are aligned in a single end mode to avoid biasing alignments based on the pre-specified library insert size. Rather, the library size is recomputed by MetaCarvel and errors in read pairing are identified during the scaffolding process. Using the alignments of reads to contigs, a contig graph is created where the nodes are contigs and edges between adjacent contigs indicated that one or more paired-end reads span the gap between the corresponding contigs. We first re-estimate the library size (mean and standard deviation) by considering pairs where both reads in the pair are aligned to the same contig. To account for divergent estimates of the distance between adjacent contigs, we compute the maximal set of links that are consistent with each other and that imply a similar distance. Finding such a set of consistent links is equivalent to finding a maximal clique in an interval graph as described in [<xref ref-type="bibr" rid="CR34">34</xref>]. Once the set of mutually consistent links is identified, they are “bundled” into a single representative link. The mean and standard deviation for this link is computed using a method described in Huson et al. [<xref ref-type="bibr" rid="CR35">35</xref>]. The weight of this link is given by the number of read pairs which were bundled while constructing the link. Bundling of links gives a single value for mean and standard deviation for the implied distance between a pair of contigs.</p>
    </sec>
    <sec id="Sec15">
      <title>Repeat identification</title>
      <p id="Par30">To avoid the ambiguities caused by genomic repeats during scaffolding, we first identify repetitive contigs and remove them from the contig graph along with all the edges incident on them. We use several properties of the graph and contigs to determine the contigs that could confound the scaffolding process [<xref ref-type="bibr" rid="CR36">36</xref>]. First, we calculate the sequencing coverage and degree for all the contigs in the graph. Then, we assign a unique orientation to each contig in the graph using an algorithm described in more detail in the next section. This algorithm removes edges from the graph that prevents the assignment of a consistent orientation to contigs. For example, if a contig is assigned the forward orientation, then all the links implying the reverse orientation are removed. For each contig, we count the number of invalidated edges. We also flag links in the contig graph that connect contigs with significantly different depths of coverage. We track how many such “skewed” links are incident on each contig. A more detailed description of how these features are computed can be found here [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
      <p id="Par31">For each of the features described above (depth of coverage, node degree, incident edges invalidated during the orientation phase, skewed edges), we flag the contigs that occur within the upper quartile among all contigs. Any contig that is flagged according to at least three of the criteria listed above is marked as a repeat and removed. After removing these contigs, we also remove contigs with a high betweenness centrality measure (the number of shortest paths passing through a node in a graph) [<xref ref-type="bibr" rid="CR37">37</xref>]—specifically the contigs that have a betweenness centrality higher by more than 3 standard deviations from the mean betweenness centrality for the assembly graph. Since the computation of betweenness centrality is computationally expensive (<italic>O</italic>(<italic>N</italic><sup>3</sup>) for <italic>N</italic> contigs), we use an approximation algorithm [<xref ref-type="bibr" rid="CR38">38</xref>] which runs in linear time, thereby scaling to large graphs obtained from the complex metagenomic samples. The impact of the node removal on the structure of the scaffolding graph is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.
<fig id="Fig6"><label>Fig. 6</label><caption><p>The impact of repeat detection and variant discovery on the scaffolding graph. <bold>a</bold> A scaffolding graph containing a four-node bubble (highlighted by a box) and a repeat (node shaded black). <bold>b</bold> After the removal of the repeat, the graph becomes disconnected, simplifying the discovery of variants (the collapsed four-node bubble is shown as an elongated hexagon) and simple chains of contigs (the remaining two edges in the graph)</p></caption><graphic xlink:href="13059_2019_1791_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Orientation</title>
      <p id="Par32">The contig graph is bidirected because each contig in the graph can originate from either forward or reverse DNA strand. To make this graph directed, we need to assign a unique orientation to each contig. The edges in the graph are of two types: “same” when adjacent contigs have the same orientation and “different”, otherwise. If the graph has a cycle that contains an odd number of “different” edges, then it is impossible to assign a consistent orientation to contigs in that cycle without discarding at least one edge from the cycle. Our objective is to minimize the number of edges to be removed from the graph in order to allow a consistent orientation for all contigs. Finding such a minimum set is equivalent to finding a maximal bipartite subgraph—an NP-Hard problem [<xref ref-type="bibr" rid="CR39">39</xref>]. We use the greedy algorithm described in Kelecioglu et al. [<xref ref-type="bibr" rid="CR40">40</xref>] that achieves a two-factor approximation and runs in <italic>O</italic>(<italic>V + E</italic>) time (<italic>V</italic>—the number of contigs, <italic>E</italic>—the number of edges connecting these contigs). Briefly, we assign an arbitrary orientation (forward or reverse) to a starting contig, then proceed to orient all contigs adjacent to it. While assigning an orientation to a contig, we pick an orientation in such a way that it agrees with the majority of its already oriented neighbors (in terms of edge weights supporting that orientation). Once we assign an orientation to a contig, we invalidate any links that disagree with the chosen orientation. We continue in a breadth-first manner and assign an orientation to all the contigs.</p>
    </sec>
    <sec id="Sec17">
      <title>Graph simplification and variant detection</title>
      <p id="Par33">A typical metagenomic sample contains closely related genomes or closely related strains of the same organism which result in a complex bubble-like pattern in the graph. Identifying complex variants in the graph takes exponential time in the number of nodes, thereby making variant identification extremely slow on large and complex metagenomics samples. To identify variants in the graph efficiently, we first decompose the oriented contig graph into its biconnected components using the Hopcroft-Tarjan algorithm [<xref ref-type="bibr" rid="CR41">41</xref>]. This algorithm takes <italic>O</italic>(<italic>V+ E</italic>) time. We further decompose each biconnected component into triconnected components by computing SPQR tree data structures [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. The SPQR tree for a graph denotes a hierarchical decomposition of biconnected components of a graph into its triconnected components. We use the implementation of SPQR trees provided in the Open Graph Drawing Framework (OGDF) [<xref ref-type="bibr" rid="CR44">44</xref>] which runs in linear time <italic>O</italic>(<italic>V + E</italic>). Since the SPQR tree data structure is only defined for undirected graphs, we need to check whether the components identified within the tree are consistent with the orientation of the edges of the assembly graph. We rely on the algorithm used in Marygold [<xref ref-type="bibr" rid="CR20">20</xref>]: for each graph component identified between a pair of separation nodes within the SPQR tree, we check that all paths starting at the source node can reach the sink node of the component using a directed path. Components that fail this check are eliminated from further consideration. Once valid source-sink pairs and variants are identified, each component (complex graph “bubble”) is collapsed into a supernode. The incoming and outgoing edges from the source and sink respectively for the variants are assigned to its supernode. This simplifies the graph structure by a large extent thereby masking the complexities caused by the variants in the sample.</p>
      <p id="Par34">The graph components we identify are also reported by MetaCarvel as putative strain variants, allowing further analysis. From among the patterns identified, we have focused the analysis in this paper on three simple patterns (refer to Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
      <sec id="Sec18">
        <title>Three-node bubbles</title>
        <p id="Par35">Three-node bubbles in the graph correspond to putative gene gain/loss events in the genome, hence, are important from the biological point of view. These bubbles can be easily found from the validated bubbles of size 3.</p>
      </sec>
      <sec id="Sec19">
        <title>Four-node bubbles</title>
        <p id="Par36">Four-node bubbles correspond to putative variation between the genomes of related strains within a sample. Like three-node bubbles, they can also be easily characterized within the validated bubbles obtained during the bubble collapsing step.</p>
      </sec>
      <sec id="Sec20">
        <title>Interspersed repeats</title>
        <p id="Par37">Interspersed repeats are natively detected and flagged by the repeat detection procedure described above.</p>
      </sec>
    </sec>
    <sec id="Sec21">
      <title>Generation of linear scaffolds</title>
      <p id="Par38">Once we simplify the graph by collapsing bubbles into supernodes, we generate the scaffold sequences through a linear traversal of the graph. We first create an auxiliary graph G’(V’,E’) from the original graph G(V,E), as follows. We create two nodes for each contig, one for the 5′ end and one for the 3′ end, connected by an edge that matches the orientation of the corresponding contig. The edge weights for E’ is the bundle sizes (number of mate pairs supporting that edge). The edges between the 5′ and 3′ ends of same contigs are not added at this stage. We then compute a weighted maximal matching [<xref ref-type="bibr" rid="CR45">45</xref>] in G’. After we compute a weighted maximal matching, we remove nodes and edges present in that matching and repeat the matching process on the remaining nodes and edges until all nodes in G’ are matched. In each maximal matching, we add edges between the 5′ and 3′ ends of each contig present in that matching. This defines a unique linear path in G’ and spells out a scaffold. We note that supernodes (collapsed regions of strain variation) can be part of the linear path constructed from the scaffold graph. Since each variant is a directed acyclic graph (DAG), we compute the highest weighted path from source to sink within each supernode using a dynamic programming algorithm. This path is then merged within the global linear path to define the linearized scaffold. For each supernode, we also output additional source to sink paths as alternate variants by iteratively removing edges that were previously reported.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1791_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>Review history. (DOCX 22 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Review history</title>
    <p>The review history is available as Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MP, TT, and JG designed the study. JG developed the code and ran the experiments. All authors analyzed the results and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The research was supported by the Department of Defense’s High Performance Computing Modernization Program Application Software Initiative (HASI) by the Department of the Army. Research was conducted through a cooperative agreement between the Naval Research Laboratory (NRL) and the University of Maryland via a HASI award to WJH. The opinions and assertions contained herein are those of the authors and are not to be construed as those of the U.S. Navy, military service at large or U.S. Government.</p>
    <p>JC, TT, MF, and MP were supported in part by the US NIH award R01-AI-100947.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All the data used for validation is publicly available and downloaded from NCBI databases [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. The source code describing our methods is freely available under the MIT license at Github [<xref ref-type="bibr" rid="CR46">46</xref>] and Zenodo [<xref ref-type="bibr" rid="CR47">47</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par39">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par40">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par41">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burgdorf</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Manichanh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pons</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Levenez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>59</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08821</pub-id>
        <pub-id pub-id-type="pmid">20203603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Abubucker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Badger</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Chinwalla</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>FitzGerald</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>RS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure, function and diversity of the healthy human microbiome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>207</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11234</pub-id>
        <pub-id pub-id-type="pmid">22699609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hess</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Chokhawala</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic discovery of biomass-degrading genes and genomes from cow rumen</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>331</volume>
        <fpage>463</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1200387</pub-id>
        <pub-id pub-id-type="pmid">21273488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nealson</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics and the global ocean survey: what’s in it for us, and why should we care?</article-title>
        <source>ISME J</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>185</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2007.43</pub-id>
        <pub-id pub-id-type="pmid">18043628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mackelprang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Waldrop</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>DeAngelis</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Chavarria</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Blazewicz</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic analysis of a permafrost microbial community reveals a rapid response to thaw</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>480</volume>
        <fpage>368</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10576</pub-id>
        <pub-id pub-id-type="pmid">22056985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The metagenomics of soil</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>470</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1160</pub-id>
        <pub-id pub-id-type="pmid">15931165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meleshko</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>824</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id>
        <pub-id pub-id-type="pmid">28298430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sadakane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1674</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id>
        <pub-id pub-id-type="pmid">25609793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Afiahayati</surname>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MetaVelvet-SL: an extension of the Velvet assembler to a de novo metagenomic assembler utilizing supervised learning</article-title>
        <source>DNA Res</source>
        <year>2015</year>
        <volume>22</volume>
        <fpage>69</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1093/dnares/dsu041</pub-id>
        <pub-id pub-id-type="pmid">25431440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1420</fpage>
        <lpage>1428</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts174</pub-id>
        <pub-id pub-id-type="pmid">22495754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Godzaridis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Laviolette</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Corbeil</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ray Meta: scalable de novo metagenome assembly and profiling</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R122</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-12-r122</pub-id>
        <pub-id pub-id-type="pmid">23259615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haider</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Bushnell</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Omega: an overlap-graph de novo assembler for metagenomics</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2717</fpage>
        <lpage>2722</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu395</pub-id>
        <pub-id pub-id-type="pmid">24947750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ochman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Groisman</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>405</volume>
        <fpage>299</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1038/35012500</pub-id>
        <pub-id pub-id-type="pmid">10830951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>De Meester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lenzi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McElroy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Buckling</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Local adaptation of a bacterium is as important as its presence in structuring a natural microbial community</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>12453</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms12453</pub-id>
        <pub-id pub-id-type="pmid">27501868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costea</surname>
            <given-names>PI</given-names>
          </name>
          <name>
            <surname>Munch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Paoli</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>metaSNV: a tool for metagenomic strain level analysis</article-title>
        <source>PLoS One</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0182392</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0182392</pub-id>
        <pub-id pub-id-type="pmid">28753663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rodriguez-Mueller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Garud</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>An integrated metagenomics pipeline for strain profiling reveals novel patterns of bacterial transmission and biogeography</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>1612</fpage>
        <lpage>1625</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.201863.115</pub-id>
        <pub-id pub-id-type="pmid">27803195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siljander</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Knip</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>ConStrains identifies microbial strains in metagenomic datasets</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>1045</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3319</pub-id>
        <pub-id pub-id-type="pmid">26344404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Truong</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Tett</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pasolli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Microbial strain-level population structure and genetic diversity from metagenomes</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>626</fpage>
        <lpage>638</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.216242.116</pub-id>
        <pub-id pub-id-type="pmid">28167665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>226</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.1028</pub-id>
        <pub-id pub-id-type="pmid">22231483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nijkamp</surname>
            <given-names>J. F.</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>M. J. T.</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Exploring variation-aware contig graphs for (comparative) metagenomics using MaryGold</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>22</issue>
        <fpage>2826</fpage>
        <lpage>2834</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt502</pub-id>
        <pub-id pub-id-type="pmid">24058058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-18</pub-id>
        <pub-id pub-id-type="pmid">23587118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>Jason R.</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>Sergey</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>Granger</given-names>
          </name>
        </person-group>
        <article-title>Assembly algorithms for next-generation sequencing data</article-title>
        <source>Genomics</source>
        <year>2010</year>
        <volume>95</volume>
        <issue>6</issue>
        <fpage>315</fpage>
        <lpage>327</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2010.03.001</pub-id>
        <pub-id pub-id-type="pmid">20211242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bambus 2: scaffolding metagenomes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2964</fpage>
        <lpage>2971</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr520</pub-id>
        <pub-id pub-id-type="pmid">21926123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chia</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>OPERA-LG: efficient and exact scaffolding of large, repeat-rich eukaryotic genomes with performance guarantees</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>102</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0951-y</pub-id>
        <pub-id pub-id-type="pmid">27169502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandric</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Knyazev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zelikovsky</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Repeat-aware evaluation of scaffolding tools</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2530</fpage>
        <lpage>2537</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty131</pub-id>
        <pub-id pub-id-type="pmid">29547882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Daugherty</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Nagaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Rasko</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Use of comparative genomics to characterize the diversity of Acinetobacter baumannii surveillance isolates in a health care institution</article-title>
        <source>Antimicrob Agents Chemother</source>
        <year>2016</year>
        <volume>60</volume>
        <fpage>5933</fpage>
        <lpage>5941</lpage>
        <pub-id pub-id-type="doi">10.1128/AAC.00477-16</pub-id>
        <pub-id pub-id-type="pmid">27458211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Andreopoulos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bowers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deshpande</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chiniquy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ciobanu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klenk</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Zane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Daum</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next generation sequencing data of a defined microbial mock community</article-title>
        <source>Sci Data</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>160081</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.81</pub-id>
        <pub-id pub-id-type="pmid">27673566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Sczyrba A, Hofmann P, Belmann P, Koslicki D, Janssen S, Droge J, Gregor I, Majda S, Fiedler J, Dahms E, et al. Critical assessment of metagenome interpretation-a benchmark of metagenomics software. Nat Methods. 2017;14(11):1063–71.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Smoot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Versatile and open software for comparing large genomes</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R12</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id>
        <pub-id pub-id-type="pmid">14759262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Gregorio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Silvestro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Petrillo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carlomagno</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Di Nocera</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>Enterobacterial repetitive intergenic consensus sequence repeats in yersiniae: genomic organization and functional properties</article-title>
        <source>J Bacteriol</source>
        <year>2005</year>
        <volume>187</volume>
        <fpage>7945</fpage>
        <lpage>7954</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.187.23.7945-7954.2005</pub-id>
        <pub-id pub-id-type="pmid">16291667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mikheenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MetaQUAST: evaluation of metagenome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1088</fpage>
        <lpage>1090</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv697</pub-id>
        <pub-id pub-id-type="pmid">26614127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kosack</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical scaffolding with Bambus</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>149</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1536204</pub-id>
        <pub-id pub-id-type="pmid">14707177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>The greedy path-merging algorithm for sequence assembly</article-title>
        <source>Proceedings of the Fifth Annual International Conference on Computational Biology (RECOMB)</source>
        <year>2001</year>
        <fpage>157</fpage>
        <lpage>163</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Ghurye J, Pop M. Better identification of repeats in metagenomic scaffolding. In: Frith M, Storm Pedersen NC, editors. Algorithms in bioinformatics: 16th International Workshop, WABI 2016, Aarhus, Denmark, August 22–24, 2016 Proceedings. Cham: Springer International Publishing; 2016. p. 174–84. <ext-link ext-link-type="uri" xlink:href="https://link.springer.com/chapter/10.1007/978-3-319-43681-4_14#citeas">https://link.springer.com/chapter/10.1007/978-3-319-43681-4_14#citeas</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brandes</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>A faster algorithm for betweenness centrality</article-title>
        <source>J Math Sociol</source>
        <year>2001</year>
        <volume>25</volume>
        <fpage>163</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1080/0022250X.2001.9990249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riondato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kornaropoulos</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Fast approximation of betweenness centrality through sampling</article-title>
        <source>Data Min Knowl Disc</source>
        <year>2016</year>
        <volume>30</volume>
        <fpage>438</fpage>
        <lpage>475</lpage>
        <pub-id pub-id-type="doi">10.1007/s10618-015-0423-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Garey</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <source>Computers and intractability</source>
        <year>1979</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>W. H. Freeman and Company</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kececioglu</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial algorithms for DNA sequence assembly</article-title>
        <source>Algorithmica</source>
        <year>1995</year>
        <volume>13</volume>
        <fpage>7</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01188580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hopcroft</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tarjan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Algorithm 447: efficient algorithms for graph manipulation</article-title>
        <source>Commun ACM</source>
        <year>1973</year>
        <volume>16</volume>
        <fpage>372</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1145/362248.362272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Battista</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tamassia</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>On-line maintenance of triconnected components with SPQR-trees</article-title>
        <source>Algorithmica</source>
        <year>1996</year>
        <volume>15</volume>
        <fpage>302</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01961541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gutwenger</surname>
            <given-names>Carsten</given-names>
          </name>
          <name>
            <surname>Mutzel</surname>
            <given-names>Petra</given-names>
          </name>
        </person-group>
        <article-title>A Linear Time Implementation of SPQR-Trees</article-title>
        <source>Graph Drawing</source>
        <year>2001</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>77</fpage>
        <lpage>90</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Chimani M, Gutwenger C, Juenger M, Klau G, Klein C, Mutzel P. Open graph drawing framework (OGDF). In: Handbook of Graph Drawing and Visualization. CRC Press; 2013. p. 543-69.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galil</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Micali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gabow</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>An O(EV\logV) algorithm for finding a maximal weighted matching in general graphs</article-title>
        <source>SIAM J Comput</source>
        <year>1986</year>
        <volume>15</volume>
        <fpage>120</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1137/0215009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Ghurye J, Treangen T, Fedarko M, Hervey WJ IV, Pop M. MetaCarvel: linking assembly graph motifs to biological variants. Github. 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/MetaCarvel">https://github.com/marbl/MetaCarvel</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Ghurye J, Treangen T, Fedarko M, Hervey WJ IV, Pop M. MetaCarvel: linking assembly graph motifs to biological variants. Zenodo. 2019. 10.5281/zenodo.3360985.</mixed-citation>
    </ref>
  </ref-list>
</back>
