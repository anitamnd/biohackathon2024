<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ2207 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 pdf ?>
<?FILEmmc3 xlsx ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10371765</article-id>
    <article-id pub-id-type="pii">S2001-0370(23)00243-X</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2023.07.009</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PreCanCell: An ensemble learning algorithm for predicting cancer and non-cancer cells from single-cell transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au0005">
        <name>
          <surname>Yang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">a</xref>
        <xref rid="aff0010" ref-type="aff">b</xref>
        <xref rid="aff0015" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author" id="au0010">
        <name>
          <surname>Yan</surname>
          <given-names>Qiyu</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">a</xref>
        <xref rid="aff0010" ref-type="aff">b</xref>
        <xref rid="aff0015" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author" id="au0015">
        <name>
          <surname>Long</surname>
          <given-names>Rongzhuo</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">a</xref>
        <xref rid="aff0010" ref-type="aff">b</xref>
        <xref rid="aff0015" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author" id="au0020">
        <name>
          <surname>Liu</surname>
          <given-names>Zhixian</given-names>
        </name>
        <email>liuzhixian@njmu.edu.cn</email>
        <xref rid="aff0020" ref-type="aff">d</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au0025">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaosheng</given-names>
        </name>
        <email>xiaosheng.wang@cpu.edu.cn</email>
        <xref rid="aff0005" ref-type="aff">a</xref>
        <xref rid="aff0010" ref-type="aff">b</xref>
        <xref rid="aff0015" ref-type="aff">c</xref>
        <xref rid="cor2" ref-type="corresp">⁎⁎</xref>
      </contrib>
      <aff id="aff0005"><label>a</label>Biomedical Informatics Research Lab, School of Basic Medicine and Clinical Pharmacy, China Pharmaceutical University, Nanjing 211198, China</aff>
      <aff id="aff0010"><label>b</label>Cancer Genomics Research Center, School of Basic Medicine and Clinical Pharmacy, China Pharmaceutical University, Nanjing 211198, China</aff>
      <aff id="aff0015"><label>c</label>Big Data Research Institute, China Pharmaceutical University, Nanjing 211198, China</aff>
      <aff id="aff0020"><label>d</label>Jiangsu Cancer Hospital, Jiangsu Institute of Cancer Research, The Affiliated Cancer Hospital of Nanjing Medical University, Nanjing, Jiangsu Province, China</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author. <email>liuzhixian@njmu.edu.cn</email></corresp>
      <corresp id="cor2"><label>⁎⁎</label>Corresponding author at: Biomedical Informatics Research Lab, School of Basic Medicine and Clinical Pharmacy, China Pharmaceutical University, Nanjing 211198, China. <email>xiaosheng.wang@cpu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>21</volume>
    <fpage>3604</fpage>
    <lpage>3614</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 The Authors</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab0010">
      <p>We propose PreCanCell, a novel algorithm for predicting malignant and non-malignant cells from single-cell transcriptomes. PreCanCell first identifies the differentially expressed genes (DEGs) between malignant and non-malignant cells commonly in five common cancer types-associated single-cell transcriptome datasets. The five common cancer types include renal cell carcinoma (RCC), head and neck squamous cell carcinoma (HNSCC), melanoma, lung adenocarcinoma (LUAD), and breast cancer (BC). With each of the five datasets as the training set and the DEGs as the features, a single cell is classified as malignant or non-malignant by <italic>k</italic>-NN (<italic>k</italic> = 5). Finally, the single cell is determined as malignant or non-malignant by the majority vote of the five <italic>k</italic>-NN classification results. We tested the predictive performance of PreCanCell in 19 single-cell datasets, and reported classification accuracy, sensitivity, specificity, balanced accuracy (the average of sensitivity and specificity) and the area under the receiver operating characteristic curve (AUROC). In all these datasets, PreCanCell achieved above 0.8 accuracy, sensitivity, specificity, balanced accuracy and AUROC. Finally, we compared the predictive performance of PreCanCell with that of seven other algorithms, including CHETAH, SciBet, SCINA, scmap-cell, scmap-cluster, SingleR, and ikarus. Compared to these algorithms, PreCanCell displays the advantages of higher accuracy and simpler implementation. We have developed an R package for the PreCanCell algorithm, which is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/WangX-Lab/PreCanCell" id="ir0015">https://github.com/WangX-Lab/PreCanCell</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="ab0015">
      <title>Graphical Abstract</title>
      <p>
        <fig id="fig0035" position="anchor">
          <alt-text id="at0040">ga1</alt-text>
          <graphic xlink:href="ga1"/>
        </fig>
      </p>
    </abstract>
    <abstract abstract-type="author-highlights" id="ab0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="li0005">
          <list-item id="u0005">
            <label>•</label>
            <p id="p0005">PreCanCell is an algorithm for predicting cancer and non-cancer cells from single-cell transcriptomes.</p>
          </list-item>
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">PreCanCell is a simple and effective ensemble learning algorithm.</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">PreCanCell uses well-annotated and high-quality cancer single-cell transcriptomes as the training set.</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">PreCanCell does not require users to provide gene markers and training or reference datasets.</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">PreCanCell displays better performance in predicting cancer and non-cancer cells than most established algorithms.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <kwd-group id="keys0005">
      <title>Keywords</title>
      <kwd>Ensemble learning algorithm</kwd>
      <kwd>Single-cell transcriptomes</kwd>
      <kwd>Cancer and non-cancer cells</kwd>
      <kwd>Tumor marker genes</kwd>
      <kwd>Non-tumor marker genes</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0035">Single-cell RNA sequencing (scRNA-seq) has been widely utilized to characterize transcriptomic profile of single cells <xref rid="bib1" ref-type="bibr">[1]</xref>. With the emergence of a huge amount of single-cell transcriptomic data generated by scRNA-seq, accurate identification of cell types has become one of the most important and challenging issues in scRNA-seq data analysis <xref rid="bib2" ref-type="bibr">[2]</xref>. There are two classes of approaches for cell type identification: unsupervised and supervised methods. The unsupervised method identifies cell types by clustering cells based on their gene expression profiles without labeled data <xref rid="bib3" ref-type="bibr">[3]</xref>, while the supervised method infers the identity of each cell by learning of training data with cell type annotation <xref rid="bib4" ref-type="bibr">[4]</xref>. The unsupervised method is effective in uncovering novel cell populations and in mapping cells from whole organs or organisms <xref rid="bib5" ref-type="bibr">[5]</xref>, <xref rid="bib6" ref-type="bibr">[6]</xref>. Nevertheless, the cell type annotation with the unsupervised method is often labor-intensive with increased number of cells and samples as it involves manual examination of cluster-specific marker genes. In contrast, the supervised method can fast and automatically annotate cell types by predicting the identity of individual cells. Some commonly used algorithms for identifying cell types included CHETAH <xref rid="bib7" ref-type="bibr">[7]</xref>, SciBet <xref rid="bib8" ref-type="bibr">[8]</xref>, SCINA <xref rid="bib9" ref-type="bibr">[9]</xref>, scmap-cell <xref rid="bib10" ref-type="bibr">[10]</xref>, scmap-cluster <xref rid="bib10" ref-type="bibr">[10]</xref>, SingleR <xref rid="bib11" ref-type="bibr">[11]</xref> and ikarus <xref rid="bib12" ref-type="bibr">[12]</xref>, where CHETAH, SciBet, scmap-cell, scmap-cluster, SingleR and ikarus are supervised methods, while SCINA is a semi-supervised method. CHETAH annotates cell types by hierarchical classification based on the expression profile of feature genes <xref rid="bib7" ref-type="bibr">[7]</xref>. SciBet employs the multinomial-distribution model and maximum likelihood estimation to identify cell types <xref rid="bib8" ref-type="bibr">[8]</xref>. The scmap-cell algorithm assigns cell types by the <italic>k</italic>-nearest-neighbor (<italic>k</italic>-NN) classification based on cosine similarity measure <xref rid="bib10" ref-type="bibr">[10]</xref>, and scmap-cluster classifies a cell based on the greatest similarity between the cell and each cluster centroid or cell <xref rid="bib10" ref-type="bibr">[10]</xref>. SingleR infers cellular identity based on reference transcriptomic datasets of pure cell types by Spearman correlation <xref rid="bib11" ref-type="bibr">[11]</xref>. The ikarus algorithm employs a logistic regression classifier along with adaptive network propagation to identify cell types <xref rid="bib12" ref-type="bibr">[12]</xref>. SCINA assigns cell types by the expectation-maximization model based on the expression profile of user-defined markers <xref rid="bib9" ref-type="bibr">[9]</xref>.</p>
    <p id="p0040">Single-cell transcriptome analysis has been widely employed in investigating various human diseases, particularly in cancer <xref rid="bib13" ref-type="bibr">[13]</xref>, <xref rid="bib14" ref-type="bibr">[14]</xref>, <xref rid="bib15" ref-type="bibr">[15]</xref>, <xref rid="bib16" ref-type="bibr">[16]</xref>, <xref rid="bib17" ref-type="bibr">[17]</xref>. A prominent task in downstream analysis of cancer single-cell transcriptomes is how to accurately distinguish malignant (or cancerous) from non-malignant cells. A basic principle to resolve this issue is based on the abnormal copy number profile, namely aneuploid, displayed in malignant cells <xref rid="bib18" ref-type="bibr">[18]</xref>. Many algorithms have recently been developed to infer copy number alteration (CNA) profiles from transcriptome data to distinguish malignant from non-malignant cells <xref rid="bib19" ref-type="bibr">[19]</xref>, <xref rid="bib20" ref-type="bibr">[20]</xref>, <xref rid="bib21" ref-type="bibr">[21]</xref>. Usually, to perform better inference, these algorithms require sufficient reference information, e.g., aligned BAM files from normal samples. Another class of algorithms to infer malignant and non-malignant cells from transcriptome data are using gene markers for specific cancer types to determine whether a cell is malignant or benign <xref rid="bib15" ref-type="bibr">[15]</xref>, <xref rid="bib22" ref-type="bibr">[22]</xref>.</p>
    <p id="p0045">With a dramatic increase of well-annotated cancer single-cell transcriptomes to date, using the supervised method to infer malignant and non-malignant cells by learning these data may greatly improve the predictive performance. Based on this idea, this study proposed a novel algorithm, termed PreCanCell, for predicting malignant and non-malignant cells from single-cell transcriptomes. We first identified the differentially expressed genes (DEGs) between malignant and non-malignant cells commonly in five cancer single-cell transcriptome datasets. These datasets were associated with several common cancer types, including renal cell carcinoma (RCC), head and neck squamous cell carcinoma (HNSCC), melanoma, lung adenocarcinoma (LUAD), and breast cancer (BC). The number of malignant cells in each of the five datasets is relatively large, with the proportion &gt; 10 %. Using these DEGs as features and the five cancer single-cell transcriptome datasets as the training set, PreCanCell predicts a single cell as malignant or non-malignant based on its gene expression profiles with the <italic>k</italic>-NN (<italic>k</italic> = 5) classifier. We compared PreCanCell with seven other algorithms in several predictive performance, including accuracy, sensitivity, specificality, balanced accuracy (the average of sensitivity and specificity) and the area under the receiver operating characteristic curve (AUROC). We also analyzed correlations of these DEGs with various cancer-related molecular and clinical features in pan-cancer. This study provides a simple but effective method for identifying malignant and non-malignant cells, and a set of reliable cancer and non-cancer marker genes inferred from single cell transcriptomes.</p>
  </sec>
  <sec id="sec0010">
    <label>2</label>
    <title>Methods</title>
    <sec id="sec0015">
      <label>2.1</label>
      <title>Data acquisition and preprocessing</title>
      <p id="p0050">We collected 16 publicly available scRNA-seq datasets, which were gene expression profiles of 663,760 cells. These datasets covered 11 cancer types, including RCC (T1_RCC), HNSCC (T2_HNSCC), melanoma (T3_Melanoma and P11_Melanoma), LUAD (T4_LUAD), BC (T5_BC and P1_BC), basal cell carcinoma (BCC) (P2_BCC), hepatocellular carcinoma (HCC) (P3_HCC and P6_HCC), synovial sarcoma (SyS) (P4_SyS and P5_SyS), glioblastoma (GBM) (P7_GBM and P10_GBM), pancreatic ductal adenocarcinoma (PDAC) (P8_PDAC), and metastatic castration-resistant prostate cancer (mCRPC) (P9_mCRPC). Among the 16 datasets, T1_RCC, T2_HNSCC, T3_Melanoma, T4_LUAD, and T5_BC were the training set, and the others were test sets. In addition, we obtained a scRNA-seq dataset for pan-cancer cell lines (<ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0025">GSE157220</ext-link>) and a scRNA-Seq dataset for immune cells across health human tissues (<ext-link ext-link-type="uri" xlink:href="astm:GSE126030" id="ir0030">GSE126030</ext-link>) from the NCBI gene expression omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/" id="ir0035">https://www.ncbi.nlm.nih.gov/geo/</ext-link>). Furthermore, we generated a synthetic scRNA-seq dataset by merging <ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0040">GSE157220</ext-link> and <ext-link ext-link-type="uri" xlink:href="astm:GSE126030" id="ir0045">GSE126030</ext-link>. For cell type annotation, we adopted original methods provided by these datasets-associated publications as ground truth. For all datasets, we performed quality control of reads and cells following the quality control steps described in the original publications. After data quality control, we performed normalization of gene expression values using the following methods. For full-length transcriptome data, gene expression levels were quantified as: <italic>E</italic><sub><italic>i,j</italic></sub>
<italic>=</italic> log<sub>2</sub>(<italic>TPM</italic><sub><italic>i,j</italic></sub>/10 + 1), where <italic>TPM</italic><sub><italic>i,j</italic></sub> refers to transcript-per-million of gene <italic>i</italic> in cell <italic>j</italic>. For unique molecular identifier (UMI) data, we normalized gene expression values using the “NormalizeData()” function in the R package “Seurat” (v4.0.6) <xref rid="bib23" ref-type="bibr">[23]</xref> with the default parameters. Namely, the UMI count of each cell was normalized by size-factor 10,000 and then log(<italic>x</italic> + 1) transformation.</p>
      <p id="p0055">To analyze correlations of the DEGs with cancer-related molecular and clinical features in pan-cancer, we downloaded RNA-seq gene expression profiling (RSEM normalized) and clinical data for 33 TCGA cancer types from the genomic data commons data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/" id="ir0050">https://portal.gdc.cancer.gov/</ext-link>). We downloaded microarray (Affymetrix Human Genome U219 array) gene expression profiling data for 962 human cancer cell lines and their drug sensitivities (IC50 values) to 265 compounds from the Genomics of Drug Sensitivity in Cancer (GDSC) project (<ext-link ext-link-type="uri" xlink:href="https://www.cancerrxgene.org/downloads" id="ir0055">https://www.cancerrxgene.org/downloads</ext-link>). In addition, we downloaded data of RNA-seq gene expression profiling (RSEM normalized) in 1033 cancer cell lines and 51 normal cell lines from the Cancer Cell Line Encyclopedia (CCLE) project (<ext-link ext-link-type="uri" xlink:href="https://depmap.org/portal/download/" id="ir0060">https://depmap.org/portal/download/</ext-link>). All RNA-seq gene expression values (<italic>x</italic>) were transformed by log<sub>2</sub>(<italic>x</italic> + 1) before subsequent analyses. A summary of the datasets used in this study is shown in <xref rid="sec0095" ref-type="sec">Supplementary Table S1</xref>.</p>
    </sec>
    <sec id="sec0020">
      <label>2.2</label>
      <title>Identification of DEGs between malignant and non-malignant cells</title>
      <p id="p0060">For each training dataset, we identified DEGs between malignant and non-malignant cells. We obtained the DEGs based on the following criteria. First, the gene expression difference between malignant and non-malignant cells was statistically significant if the adjusted Wilcoxon rank-sum test <italic>P</italic>-value &lt; 0.05 by the Bonferroni correction. Second, for a differentially expressed gene, if it was expressed in at least 10 % of malignant cells and had a mean expression fold change of &gt; 0.25 (malignant versus non-malignant cells, log scale), it was defined as an upregulated gene in malignant cells; if it was expressed in at least 10 % of non-malignant cells and had a mean expression fold change of &gt; 0.25 (non-malignant versus malignant cells, log scale), it was defined as an upregulated gene in non-malignant cells. Finally, to credibly identify marker genes for malignant and non-malignant cells, we obtained the gene set, which was the intersection of the upregulated genes in malignant cells identified in each of the five training datasets; this gene set was defined as tumor marker genes (TMGs). The intersection of the upregulated genes in non-malignant cells identified in each of the five training datasets was defined as non-tumor marker genes (NMGs). The DEGs were the set of genes in TMGs or NMGs. We performed the differential gene expression analysis with the function “FindMarkers()” in the R package “Seurat” (v4.0.6).</p>
    </sec>
    <sec id="sec0025">
      <label>2.3</label>
      <title>Classifier development and evaluation</title>
      <p id="p0065">The prediction model PreCanCell utilizes the DEGs as features to predict malignant and non-malignant cells. Before the development and evaluation of classifier, all gene expression values are scaled to the range [0,1] by min-max normalization in each dataset. That is, for each original gene expression value <italic>x</italic>, we scale it as follows:<disp-formula id="eqn0005"><italic>x</italic><sub><italic>scaled</italic></sub> = (<italic>x</italic> − <italic>min</italic>(<italic>x</italic>))/(<italic>max</italic>(<italic>x</italic>) − <italic>min</italic>(<italic>x</italic>)),</disp-formula>where <italic>min</italic>(<italic>x</italic>) and <italic>max</italic>(<italic>x</italic>) denote the minimum value and maximum value of gene expression across all single cells, respectively. With the DEGs as features and <italic>k</italic>-NN (<italic>k</italic> = 5) as the classifier, PreCanCell first predicted malignant and non-malignant cells in each training dataset and reported 10-fold cross-validation results. Next, PreCanCell predicted malignant and non-malignant cells in each test set. In the test set prediction, PreCanCell employs the ensemble learning algorithm. That is, PreCanCell predicts a single cell as malignant or non-malignant with the DEGs as features and <italic>k</italic>-NN (<italic>k</italic> = 5) as the classifier based on each of the five training datasets, and finally assigns the cell by the majority vote of five classification results. The classification accuracy, sensitivity, specificity, balanced accuracy and AUROC were reported.</p>
    </sec>
    <sec id="sec0030">
      <label>2.4</label>
      <title>Evaluation of immune score, stromal score, tumor purity, proliferation score, and intratumor heterogeneity (ITH) score of tumor bulks</title>
      <p id="p0070">We utilized the ESTIMATE algorithm <xref rid="bib24" ref-type="bibr">[24]</xref> to evaluate the immune score, stromal score, and tumor purity for each TCGA tumor sample based on its gene expression profiles. The immune score, stromal score, and tumor purity represent the immune infiltration level, stromal content, and proportion of tumor cells in the tumor bulk. In addition, we used the single-sample gene-set enrichment analysis (ssGSEA) <xref rid="bib25" ref-type="bibr">[25]</xref> to assess the proliferation score of a tumor based on the expression profiles of the proliferation marker genes <xref rid="bib26" ref-type="bibr">[26]</xref> in the tumor. We utilized the DITHER algorithm <xref rid="bib27" ref-type="bibr">[27]</xref> to measure ITH. DITHER scores ITH based on both profiles of somatic mutations and copy number alterations in the tumor.</p>
    </sec>
    <sec id="sec0035">
      <label>2.5</label>
      <title>Survival analysis</title>
      <p id="p0075">For each cancer type from the TCGA project, we used the median expression levels of TMGs and NMGs as the cut-off value to subgroup samples into low-expression (&lt; median) and high-expression (&gt; median) classes. We employed the Kaplan–Meier (KM) model <xref rid="bib28" ref-type="bibr">[28]</xref> to compare survival prognosis between two classes of samples. KM curves were used to display survival time differences, whose significance was evaluated by the log-rank test. We implemented survival analyses with the function “survfit()” in the R package “survival.”.</p>
    </sec>
    <sec id="sec0040">
      <label>2.6</label>
      <title>Statistical analysis</title>
      <p id="p0080">In comparisons of the expression levels of TMGs and NMGs between two classes of samples, we used two-tailed Student’s <italic>t</italic> tests. We used the false discovery rate (FDR), which was evaluated by the Benjamini-Hochberg method <xref rid="bib29" ref-type="bibr">[29]</xref>, to adjust for <italic>P</italic>-values in multiple tests. In evaluating correlations between the expression levels of TMGs and NMGs and other variables, we utilized Spearman correlations and reported correlation coefficients (<italic>ρ</italic>) and <italic>P</italic>-values.</p>
    </sec>
    <sec id="sec0045">
      <label>2.7</label>
      <title>Comparisons among different algorithms</title>
      <p id="p0085">We compared the predictive performance (AUROC, accuracy and balanced accuracy) between PreCanCell and seven other algorithms, including CHETAH <xref rid="bib7" ref-type="bibr">[7]</xref>, SciBet <xref rid="bib8" ref-type="bibr">[8]</xref>, SCINA <xref rid="bib9" ref-type="bibr">[9]</xref>, scmap-cell <xref rid="bib10" ref-type="bibr">[10]</xref>, scmap-cluster <xref rid="bib10" ref-type="bibr">[10]</xref>, SingleR <xref rid="bib11" ref-type="bibr">[11]</xref> and ikarus <xref rid="bib12" ref-type="bibr">[12]</xref>. Among them, CHETAH, SciBet, SCINA, scmap-cell, scmap-cluster and SingleR were implemented with the R package, and ikarus was implemented with the python package. We ran these tools with the input of normalized scRNA-seq data and with default parameters, except for specific parameters: “allow_unknown = 0” in SCINA and “thresh = 0” in CHETAH. More methodological details for these algorithms are described in <xref rid="sec0095" ref-type="sec">Supplementary Table S3</xref>. Two algorithms, namely SingleR and PreCanCell, were implemented with multiple workers for parallel execution to evaluate their computational resources. The maximum CPU usage (%), maximum memory usage (%) and running time (seconds) were reported for each algorithm in each of the 11 test sets. The CPU usage (%) represents the share of CPU time used by the process since the last update, and the memory usage (%) the share of physical memory used by the process. The running time indicates the time from the start to the end of running a task.</p>
    </sec>
  </sec>
  <sec id="sec0050">
    <label>3</label>
    <title>Results</title>
    <p id="p0090">PreCanCell is a method for distinguishing between malignant and non-malignant cells based on their gene expression profiles. This method first identifies the DEGs between malignant and non-malignant cells in common in five single-cell transcriptome datasets (<xref rid="tbl0005" ref-type="table">Table 1</xref>). With each of the five single-cell transcriptome datasets as the training set and the DEGs as the features, a single cell is classified as malignant or non-malignant based on its gene expression profile by the <italic>k</italic>-NN (<italic>k</italic> = 5) classifier. Finally, the single cell is classified by the majority vote of the five <italic>k</italic>-NN classification results. <xref rid="fig0005" ref-type="fig">Fig. 1</xref> is a schematic illustration of PreCanCell. This algorithm has been developed into a R package for public use, which is available at Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/WangX-Lab/PreCanCell" id="ir0065">https://github.com/WangX-Lab/PreCanCell</ext-link>). Here we first analyzed correlations between these DEGs’ expression and cancer-related molecular and clinical features in pan-cancer and in individual cancer types. Next, we reported the predictive performance of PreCanCell in 16 datasets. Finally, we compared the predictive performance of PreCanCell with that of seven other algorithms.<table-wrap position="float" id="tbl0005"><label>Table 1</label><caption><p>Differentially expressed genes (DEGs) between malignant and non-malignant cells commonly in five cancer single-cell transcriptome datasets.</p></caption><alt-text id="at0035">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th>DEGs</th><th>Gene symbol</th></tr></thead><tbody><tr><td>upregulated genes in malignant cells<break/>(TMGs)</td><td><italic>SERINC2, PTPRF, S100A16, EFNA1, SOX4, PERP, HSPB1, ASPH, LAPTM4B, BNIP3, EPS8L2, CCND1, CTTN, KRT18, CKAP4, CKB, SEMA4B, TNFRSF12A, CRNDE, GCSH, DMKN, SDC4, CDC42EP1, HOOK2, TMEM54, UGDH, TFG, FLNB, ENO1, P4HB, S100A10, TRIP6, SCD, TMEM9, SPR, TM4SF1, MIF, ARPC1A, HIST1H1C, HDGF, POLD2, AHCY, PAFAH1B3, POP7, NHP2, PDIA4, CKS1B, ALDOA, LTBR, TMEM141, PSMB5, WDR34, HSBP1L1, AP1S1, PDCD5, NDUFB4, H1F0, HSBP1, TPI1, CTNND1, SEC61G, SPINT1, AGPAT2, LGALS3BP, POLR2I, UQCRQ, TIMM13, NDUFC1, COX6C, SNRPE, NDUFB9, PRDX5, ANXA2</italic></td></tr><tr><td>upregulated genes in non-malignant cells<break/>(NMGs)</td><td><italic>TNFRSF1B, CD52, LAPTM5, CD53, CD2, CTSS, S100A4, RCSD1, RGS1, PTPRC, ZFP36L2, CXCR4, ARHGAP15, CYTIP, WIPF1, HCLS1, GZMA, HLA-A, HLA-E, HLA-C, HLA-B, GPSM3, HLA-DQA1, HLA-DPB1, IKZF1, GIMAP4, SLA, SRGN, LSP1, CTSW, UCP2, CD69, ARHGDIB, BIN2, GLIPR1, ALOX5AP, LCP1, EVL, B2M, CORO1A, CYBA, ACAP1, EVI2B, EVI2A, CCL5, CCL4, FMNL1, DDX5, CD7, MYO1F, FXYD5, HCST, GMFG, CD37, NKG7, CST7, STK4, SAMSN1, ITGB2, PIK3IP1, TMSB4X, IL2RG, CALM1, ABI3, GIMAP7, CD3D, TRAF3IP3, RHOG, CD247, IL10RA, LCK, PSMB9, FNBP1, CD3E, STK17B, FGL2, PPP1R18, RGS2, CD4, ARL6IP5, GPR65, FERMT3, LCP2, GPR183, BTG1, RHOH, ANKRD44, DUSP2, PTPN7, SEPT6, LYZ, TBC1D10C, DOK2, PARVG, AKNA, GLIPR2, FYN, SMAP2, CREM, CD96, PRDM1, ENTPD1, GZMK, ITM2A, CD3G, HIF1A, EEF1A1, LTB, DOCK8, CLEC2D, PSME1, FOXP1, SELPLG, RUNX3, RILPL2, PTPN22, PTPN6, SYTL3, STAT4, PTGER4, IL16, RASSF5, CD27, FLI1, CD8A, TAGAP, APBB1IP, NCF4, PPP2R5C, STX11, DEF6, ARHGAP9, RASAL3, SASH3, INPP5D, EPSTI1, LIPA, RGCC, PSMB10, RGS19, CTSC, ARID5A, ETS1, LPXN, SPOCK2, TCF4, STK17A, CCND2, SERPINB9, AKAP13, SH2D1A, CD74, ARHGEF1, IL7R, TNFAIP3, MFNG, ZNF331, SH2D2A, CARD8, ISG20, CSK, CNOT6L, USP15, ARHGAP4, PIM1, PPM1K, DAZAP2, SRSF5, ZFP36, AAK1, TERF2IP, JUNB, PLK3, FGFR1OP2, NFKBIA, ICAM3, ARL4C, SKAP1, IRF1, ANXA6, G3BP2, TNFAIP8, GALM, CFD, SEPT1, CCDC85B</italic></td></tr></tbody></table></table-wrap><fig id="fig0005"><label>Fig. 1</label><caption><p>A schematic illustration of the algorithm PreCanCell.</p></caption><alt-text id="at0005">Fig. 1</alt-text><graphic xlink:href="gr1"/></fig></p>
    <sec id="sec0055">
      <label>3.1</label>
      <title>The DEGs have significant associations with cancer-related molecular and clinical features in pan-cancer</title>
      <p id="p0095">The DEGs included 73 TMGs and 186 NMGs. We defined the expression level of a gene set in a sample as the average expression level of all genes in the gene set. Notably, compared to normal controls, TMGs displayed significantly higher expression levels in TCGA pan-cancer (<italic>P</italic> = 2.22 × 10<sup>−39</sup>) and in 25 of the 30 individual cancer types with normal sample’s size not less than five (FDR &lt; 0.05) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>A). Moreover, TMGs were significantly upregulated in 16 of 21 types of cancer cell lines analyzed versus normal controls (FDR &lt; 0.05) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>B). In addition, TMGs showed significant positive expression correlations with tumor purity in pan-cancer and in 18 individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>C). The expression of TMGs correlated positively with proliferation scores in pan-cancer and in 20 individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>D). Furthermore, the expression of TMGs correlated positively with ITH scores in pan-cancer and in 19 individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>E). These results collectively support that the TMGs we identified are authentic markers of cancer cells. Furthermore, we observed that the tumors with high expression (&gt; median) of TMGs had significantly worse prognosis than the tumors with low expression (&lt; median) of TMGs in pan-cancer (log-rank test, <italic>P</italic> = 0, 3.1 × 10<sup>−15</sup>, 2.9 × 10<sup>−9</sup> and 7.2 × 10<sup>−11</sup> for overall survival (OS), disease-specific survival (DSS), progression-free interval (PFI) and disease-free interval (DFI), respectively) (<xref rid="fig0010" ref-type="fig">Fig. 2</xref>F). In addition, in 11 individual cancer types, the tumors highly expressing (&gt; median) TMGs had significantly lower OS and/or disease-free survival (DFS) rates than the tumors lowly expressing (&lt; median) TMGs (<italic>P</italic> &lt; 0.05) (<xref rid="sec0095" ref-type="sec">Supplementary Fig. S1</xref>). Again, these results support the role of cancer markers of the TMGs.<fig id="fig0010"><label>Fig. 2</label><caption><p><bold>Correlations between the expression of tumor marker genes (TMGs) and molecular and clinical features in pan-cancer. A</bold> TMGs showing significantly higher expression levels in TCGA pan-cancer and in 25 individual cancer types than in normal controls. <bold>B</bold> TMGs showing significantly higher expression levels in 16 types of cancer cell lines than in normal controls. <bold>C–E</bold> TMGs having significant positive expression correlations with tumor purity, proliferation scores, and intratumor heterogeneity (ITH) scores in pan-cancer and in multiple individual cancer types. <bold>F</bold> The tumors with higher expression (&gt; median) of TMGs displaying significantly worse prognosis than the tumors with lower expression (&lt; median) of TMGs in pan-cancer. Student’s <italic>t</italic> test FDR are shown in <bold>A</bold> and <bold>B</bold>, with * FDR &lt; 0.05, ** FDR &lt; 0.01<italic>,</italic> *** FDR &lt; 0.001. Spearman correlation coefficients <italic>(ρ</italic>) and <italic>P</italic>-values are shown in <bold>C–E</bold>, with *<italic>P</italic> &lt; 0<italic>.</italic>05, **<italic>P</italic> &lt; 0.01, ***<italic>P</italic> &lt; 0.001. Log-rank test <italic>P</italic>-values are shown in <bold>F</bold>.</p></caption><alt-text id="at0010">Fig. 2</alt-text><graphic xlink:href="gr2"/></fig></p>
      <p id="p0100">On the contrary to TMGs, NMGs showed significantly lower expression levels in 18 types of cancer cell lines compared to normal controls (FDR &lt; 0.05) (<xref rid="fig0015" ref-type="fig">Fig. 3</xref>A). The expression of NMGs had strong negative correlations with tumor purity in pan-cancer and in all 33 individual cancer types (<italic>ρ</italic> &lt; − 0.70) (<xref rid="fig0015" ref-type="fig">Fig. 3</xref>B), while it showed strong positive correlations with immune scores in pan-cancer and in all 33 individual cancer types (<italic>ρ</italic> ≥ 0.89) (<xref rid="sec0095" ref-type="sec">Supplementary Fig. S2A</xref>). Moreover, NMGs displayed significant positive correlations with stromal scores in pan-cancer and in most individual cancer types (<italic>P</italic> &lt; 0.001; <italic>ρ</italic> &gt; 0.27) (<xref rid="sec0095" ref-type="sec">Supplementary Fig. S2B</xref>). These results are justified since NMGs are significantly upregulated in non-malignant cells, which involves immune and stromal cells. As opposed to TMGs, NMGs displayed significant negative expression correlations with proliferation scores in 22 individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0015" ref-type="fig">Fig. 3</xref>C). The expression of NMGs correlated negatively with ITH scores in pan-cancer and in 29 individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0015" ref-type="fig">Fig. 3</xref>D). Taken together, these results support that the NMGs are markers of non-cancer cells. Notably, the tumors with high expression (&gt; median) of NMGs had significantly higher OS and/or DFS rates than the tumors with low expression (&lt; median) of them in seven individual cancer types (<italic>P</italic> &lt; 0.05) (<xref rid="fig0015" ref-type="fig">Fig. 3</xref>E).<fig id="fig0015"><label>Fig. 3</label><caption><p><bold>Correlations between the expression of non-tumor marker genes (NMGs) and molecular and clinical features in pan-cancer. A</bold> NMGs showing significantly lower expression levels in 18 types of cancer cell lines than in normal controls. <bold>B–D</bold> NMGs having significant negative expression correlations with tumor purity, proliferation scores, and intratumor heterogeneity (ITH) scores in pan-cancer and in multiple individual cancer types. <bold>E</bold> The tumors with higher expression (&gt; median) of NMGs displaying significantly better overall and/or disease-free survival prognosis than the tumors with lower expression (&lt; median) of NMGs in seven cancer types. Student’s <italic>t</italic> test FDR are shown in A, with * FDR &lt; 0.05, ** FDR &lt; 0.01<italic>,</italic> *** FDR &lt; 0.001. Spearman correlation coefficients <italic>(ρ</italic>) and <italic>P</italic>-values are shown in <bold>B–D</bold>, with *<italic>P</italic> &lt; 0<italic>.</italic>05, **<italic>P</italic> &lt; 0.01, ***<italic>P</italic> &lt; 0.001. Log-rank test <italic>P</italic>-values are shown in <bold>E</bold>.</p></caption><alt-text id="at0015">Fig. 3</alt-text><graphic xlink:href="gr3"/></fig></p>
      <p id="p0105">We further analyzed correlations between the expression of DEGs and drug sensitivity (IC50 values) in cancer cell lines using the data from the Genomics of Drug Sensitivity in Cancer (GDSC) project (<ext-link ext-link-type="uri" xlink:href="https://www.cancerrxgene.org" id="ir0070">https://www.cancerrxgene.org</ext-link>). Interestingly, among 265 compounds tested in cancer cell lines, the expression of TMGs showed significant positive correlations with IC50 values in 212 (80 %) compounds, and the expression of NMGs had significant negative correlations with IC50 values in 232 (88 %) compounds (FDR &lt; 0.05) (<xref rid="fig0020" ref-type="fig">Fig. 4</xref> and <xref rid="sec0095" ref-type="sec">Supplementary Table S2</xref>). These results indicate that upregulation of TMGs is associated with reduced drug sensitivity and that upregulation of NMGs is associated with increased drug sensitivity in cancer.<fig id="fig0020"><label>Fig. 4</label><caption><p><bold>Spearman correlations between the expression of TMGs and NMGs and IC50 values of 265 compounds in cancer cell lines.</bold> The significant positive and negative correlations (FDR &lt; 0.05) are indicated in red and blue, respectively. Among 265 compounds tested in cancer cell lines, the expression of TMGs shows significant positive correlations with IC50 values in 212 compounds highlighted in red, and the expression of NMGs has significant negative correlations with IC50 values in 232 compounds highlighted in blue.</p></caption><alt-text id="at0020">Fig. 4</alt-text><graphic xlink:href="gr4"/></fig></p>
    </sec>
    <sec id="sec0060">
      <label>3.2</label>
      <title>PreCanCell can accurately classify malignant and non-malignant cells in various cancer types</title>
      <p id="p0110">We first tested the predictive performance of the <italic>k</italic>-NN classifier with the DEGs as features in the five training datasets. In each of the five training datasets, the 10-fold cross-validation accuracy, sensitivity, specificality, balanced accuracy (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>A), and AUROC (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>B) were all greater than 0.90. The high predictive performance in the training datasets was expected since the predicted datasets were involved in feature selection. We further tested the PreCanCell algorithm in 11 independent test sets. These test sets were single-cell transcriptome datasets for BC, BCC, HCC, SyS, GBM, PDAC, mCRPC and melanoma, respectively. Among the 11 test sets, the prediction accuracy was more than 0.90 in seven datasets and between 0.80 and 0.90 in three datasets (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>C); the balanced accuracy was greater than 0.80 in all the 11 test sets and more than 0.90 in six test sets. The sensitivity was greater than 0.80 in nine test sets and more than 0.90 in seven test sets; the specificity was greater than 0.80 in all the 11 test sets and more than 0.90 in seven test sets. Finally, the AUROC was greater than 0.80 in eight test sets and more than 0.90 in six test sets. Of note, PreCanCell showed superior predictive performance not only in the test sets whose cancer type was involved in the training set, but also in the test sets whose cancer type was not involved in the training set, such as BCC, HCC, SyS, GBM, PDAC and mCRPC (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>C). Taken together, these results suggest excellent performance of PreCanCell in classifying malignant and non-malignant cells in various cancer types.<fig id="fig0025"><label>Fig. 5</label><caption><p><bold>Predictive performance of the PreCanCell algorithm. A, B</bold> The predictive performance of the <italic>k</italic>-NN (<italic>k</italic> = 5) classifier with the TMGs and NMGs as features in the five training datasets. In each of the five training datasets, the 10-fold cross-validation accuracy, sensitivity, specificality, balanced accuracy, and AUROC are shown. <bold>C</bold> Heatmap showing the predictive performance of PreCanCell in 11 test sets. <bold>D</bold> The predictive performance of PreCanCell in three datasets, which were composed of solely malignant cells (<ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0005">GSE157220</ext-link>), solely normal cells (<ext-link ext-link-type="uri" xlink:href="astm:GSE126330" id="ir0010">GSE126330</ext-link>), and both malignant and normal cells, respectively. <bold>E</bold> The voting ratios of cancer or non-cancer cells by the five base <italic>k</italic>-NN classifiers in each dataset. Frequency represents the voting ratio of the five base classifiers predicting a cell as malignant or non-malignant.</p></caption><alt-text id="at0025">Fig. 5</alt-text><graphic xlink:href="gr5"/></fig></p>
      <p id="p0115">We further tested PreCanCell using three additional datasets, which were composed of solely malignant cells, solely normal cells, and both malignant and normal cells, respectively. In the dataset <ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0075">GSE157220</ext-link> only containing malignant cells, 222 out of 53,513 cancer cells were predicted as normal cells, with a false negative rate of 0.0041 (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>D). In the dataset <ext-link ext-link-type="uri" xlink:href="astm:GSE126030" id="ir0080">GSE126030</ext-link> only containing normal cells, 566 out of 63,861 normal cells were predicted as cancer cells, with a false positive rate of 0.0089. The third synthetic dataset was created by artificially combining <ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0085">GSE157220</ext-link> and <ext-link ext-link-type="uri" xlink:href="astm:GSE126030" id="ir0090">GSE126030</ext-link>. In this dataset, PreCanCell also achieved high predictive performance, with 0.995 accuracy, 0.998 sensitivity, 0.993 specificality, 0.995 balanced accuracy and 0.995 AUROC.</p>
      <p id="p0120">PreCanCell is an ensemble algorithm that uses the majority voting principle. To observe how agreeable the five base classifiers, we recorded the classification results of each base classifier in each dataset (<xref rid="fig0025" ref-type="fig">Fig. 5</xref>E). In P6_HCC, P11_Melanoma, <ext-link ext-link-type="uri" xlink:href="astm:GSE157220" id="ir0095">GSE157220</ext-link>, <ext-link ext-link-type="uri" xlink:href="astm:GSE126030" id="ir0100">GSE126030</ext-link> and the synthetic dataset, the five base classifiers displayed a high agreement in predicting malignant and non-malignant cells. Accordingly, PreCanCell achieved better predictive performance in these datasets. In contrast, in P4_SyS, P7_GBM and P10_GBM, the five base classifiers achieved relatively inconsistent results, and thus PreCanCell showed relatively poorer performance.</p>
    </sec>
    <sec id="sec0065">
      <label>3.3</label>
      <title>PreCanCell achieves better predictive performance than most other algorithms</title>
      <p id="p0125">We compared the predictive performance (AUROC, accuracy and balanced accuracy) of PreCanCell with seven other algorithms in predicting malignant and non-malignant cells in the 11 test sets (<xref rid="fig0030" ref-type="fig">Fig. 6</xref>A). These algorithms included CHETAH <xref rid="bib7" ref-type="bibr">[7]</xref>, SciBet <xref rid="bib8" ref-type="bibr">[8]</xref>, SCINA <xref rid="bib9" ref-type="bibr">[9]</xref>, scmap-cell <xref rid="bib10" ref-type="bibr">[10]</xref>, scmap-cluster <xref rid="bib10" ref-type="bibr">[10]</xref>, SingleR <xref rid="bib11" ref-type="bibr">[11]</xref> and ikarus <xref rid="bib12" ref-type="bibr">[12]</xref>. Here we chose three metrics (AUROC, balanced accuracy and accuracy) instead of the previous five, because the balance accuracy is the arithmetic mean of sensitivity and specificity, which together with AUROC and accuracy are sufficient in comparing algorithm’s performance. In addition, it is more concise to display the numerous results generated by eight algorithms in 11 test sets with the three metrics. Notably, PreCanCell achieved the greatest AUROC in three datasets and the second greatest AUROC in four datasets; PreCanCell had the highest accuracy in three datasets and the second highest accuracy in three datasets; PreCanCell had the highest balanced accuracy in two datasets and the second highest balanced accuracy in six datasets.<fig id="fig0030"><label>Fig. 6</label><caption><p><bold>Comparisons of the predictive performance between PreCanCell and seven other algorithms. A</bold> The AUROC, accuracy, and balanced accuracy of the eight algorithms in predicting malignant and non-malignant cells in 11 test sets. <bold>B</bold> The maximum CPU usage, maximum memory usage and running time required by the eight algorithms in predicting malignant and non-malignant cells in 11 test sets.</p></caption><alt-text id="at0030">Fig. 6</alt-text><graphic xlink:href="gr6"/></fig></p>
      <p id="p0130">We also compared the computational resource and running time required by these algorithms (<xref rid="fig0030" ref-type="fig">Fig. 6</xref>B). Of note, PreCanCell required less computational resource than most of the seven existing algorithms. For example, when running the algorithms in the 11 test sets, PreCanCell had the maximum CPU usage of 101 %, the same as CHETAH, SingleR and ikarus but much less than the other algorithms; the maximum memory required by PreCanCell overall exceeded CHETAH and SCINA but less than the other algorithms. As for running time, PreCanCell was faster than scmap-cell and SingleR, close to CHETAH and scmap-cluster and slower than SciBet, SCINA and ikarus. It is worth noting that PreCanCell is faster than CHETAH in small datasets (such as P1_BC, P3_HCC, P5_SyS, P9_mCRPC and P11_Melanoma), but slower than CHETAH in large datasets (such as P2_BCC, P6_HCC, P7_GBM, P8_PDAC and P10_GBM). It is reasonable as <italic>k</italic>-NN is a lazy learning algorithm that focuses on prediction rather than training.</p>
    </sec>
  </sec>
  <sec id="sec0070">
    <label>4</label>
    <title>Discussion</title>
    <p id="p0135">This study proposes a novel algorithm: PreCanCell, to predict cancer and non-cancer cells from single-cell transcriptomes. Compared to the established algorithms for cell type annotation, PreCanCell has several advantages. First, it is more accurate than most algorithms in predicting malignant and non-malignant cells. Its excellent predictive performance is mainly attributed to: (1) the use of well-annotated and high-quality cancer single-cell transcriptomes as the training set; and (2) the use of an ensemble learning algorithm for class prediction. PreCanCell has overcome the drawback of many methods developed earlier using poorly-annotated training sets or reference sets. In addition, PreCanCell employs ensemble learning that has been shown to be more accurate and robust than a single model <xref rid="bib30" ref-type="bibr">[30]</xref>. Indeed, we have tried to predict malignant and non-malignant cells in the test set P1_BC with a single training dataset T5_BC by <italic>k</italic>-NN, both of which were breast cancer single-cell transcriptomes. We obtained 0.835, 0.777, 0.930, 0.853 and 0.834 of accuracy, sensitivity, specificality, balanced accuracy and AUROC, respectively, compared to 0.919, 0.956, 0.859, 0.908 and 0.92 of them by PreCanCell. It proves that PreCanCell has significantly better performance than the single model. The second advantage of PreCanCell is its simplicity. PreCanCell does not require users to provide gene markers and training or reference datasets. In addition, it is implemented with a single R package. Furthermore, as <italic>k</italic>-NN is a lazy learning algorithm that focuses on prediction rather than learning or training, the implementation of PreCanCell is simple and straightforward. Users can even add additional training datasets to improve PreCanCell’s prediction performance. The third advantage of PreCanCell is that it needs less computational resources, such as CPU and memory usage, than most existing algorithms. Finally, PreCanCell is set up with parallel operations so that it can be implemented with multiple workers to increase running speed. It is particularly useful in predicting large datasets for which <italic>k</italic>-NN is relatively time-consuming.</p>
    <p id="p0140">Here we chose <italic>k</italic>-NN as the base classifier for its some advantages over other algorithms. First, <italic>k</italic>-NN is a non-parametric method that does not make any assumption about data distribution; thus, <italic>k</italic>-NN is suitable for various types of data, including complex and non-linear data. Unlike bulk transcriptomes, single-cell transcriptomes are not normally distributed for which <italic>k</italic>-NN is a viable method. Second, <italic>k</italic>-NN is robust to noise and outliers since it uses a majority vote to reduce the impact of mislabeled samples. Again, it is quite suitable for single-cell transcriptomes which are full of noise. Finally, as a lazy learning algorithm, taking high-quality training sets as background, <italic>k</italic>-NN often can achieve a high prediction performance. Here we set <italic>k</italic> = 5 because: (1) for binary classification, the <italic>k</italic> of <italic>k</italic>-NN should be an odd number; (2) the <italic>k</italic>-NN’s prediction performance was the best in the training datasets when <italic>k</italic> ranged from 1 to 15; and (3) when <italic>k</italic> = 5, the algorithm’s computational complexity is lower than that with <italic>k</italic> &gt; 5.</p>
    <p id="p0145">In some datasets, some of the compared algorithms have achieved inferior performance (<xref rid="fig0030" ref-type="fig">Fig. 6</xref>A). A main reason behind this could be that most of these algorithms, including CHETAH, SciBet, scmap-cell, scmap-cluster, SingleR and SCINA, were not developed specifically for annotating cancer cells. Only ikarus is a tool specifically designed to identify malignant cells. Nevertheless, we observed that ikarus had poor predictive performance in several datasets, such as P4_SyS, P5_SyS, P7_GBM, P8_PDAC and P10_GBM (<xref rid="fig0030" ref-type="fig">Fig. 6</xref>A). We contend that the feature genes selected by these algorithms are not highly adequate to discriminate between malignant and non-malignant cells. Specifically, our algorithm selects the feature genes which are consistently upregulated in malignant or non-malignant cells across five common cancer types. As a result, our feature genes display a stronger power to separate malignant from non-malignant cells.</p>
    <p id="p0150">In addition to develop the novel algorithm for cancer cell identification, this study uncovered cancer marker genes by analyzing single-cell transcriptome datasets for five common cancer types: RCC, HNSCC, BC, LUAD and melanoma. We further demonstrated that the cancer marker genes had significant associations with malignancy-related characteristics in tumor bulk and cancer cell lines, such as their upregulation correlated with heightened tumor proliferation capacity, ITH and drug resistance, and poor prognosis in pan-cancer and in diverse individual cancer types.</p>
    <p id="p0155">There are several limitations in this study. First, the reported predictive performance in the training set could be overestimated due to the predicted sets being involved in feature selection. Nevertheless, the reported predictive performance in the test sets should be warranted. Second, this algorithm is limited to annotating cancer and non-cancer cells, while it is not designed for identifying subpopulations of non-cancer cells, such as immune cells, stromal cells and epithelial cells. This is a direction for us to extend the algorithm in the future.</p>
  </sec>
  <sec id="sec0075">
    <title>Ethical approval</title>
    <p id="p0160">Ethical approval and consent to participate were waived since we used only publicly available data and materials in this study.</p>
  </sec>
  <sec id="sec0080">
    <title>CRediT authorship contribution statement</title>
    <p id="p0165"><bold>Tao Yang:</bold> Data curation, Formal analysis, Investigation, Software, Validation, Writing - review &amp; editing, Visualization. <bold>Qiyu Yan:</bold> Visualization, Data curation, Formal analysis, Validation. <bold>Rongzhuo Long:</bold> Visualization, Formal analysis, Software. <bold>Zhixian Liu:</bold> Project administration, Funding acquisition, Investigation. <bold>Xiaosheng Wang:</bold> Conceptualization, Methodology, Resources, Investigation, Writing - original draft, Supervision, Project administration.</p>
  </sec>
  <sec id="sec0085">
    <title>Funding</title>
    <p id="p0170">This work was supported by <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100004608</institution-id><institution>Natural Science Foundation of Jiangsu Province</institution></institution-wrap></funding-source> (BK20201090) and <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100002858</institution-id><institution>China Postdoctoral Science Foundation</institution></institution-wrap></funding-source> (2021M691338) to ZL.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0175">The authors declare that they have no competing interests.</p>
  </sec>
</body>
<back>
  <ref-list id="bibliog0005">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sbref1">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nat Rev Genet</source>
        <volume>16</volume>
        <issue>3</issue>
        <year>2015</year>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sbref2">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <volume>36</volume>
        <issue>5</issue>
        <year>2018</year>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sbref3">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet</source>
        <volume>20</volume>
        <issue>5</issue>
        <year>2019</year>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sbref4">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <volume>20</volume>
        <issue>1</issue>
        <year>2019</year>
        <fpage>194</fpage>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sbref5">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>
        <source>Science</source>
        <volume>357</volume>
        <issue>6352</issue>
        <year>2017</year>
        <fpage>661</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="pmid">28818938</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sbref6">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature</source>
        <volume>566</volume>
        <issue>7745</issue>
        <year>2019</year>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sbref7">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>J.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <volume>47</volume>
        <issue>16</issue>
        <year>2019</year>
        <object-id pub-id-type="publisher-id">e95</object-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sbref8">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciBet as a portable and fast single cell type identifier</article-title>
        <source>Nat Commun</source>
        <volume>11</volume>
        <issue>1</issue>
        <year>2020</year>
        <fpage>1818</fpage>
        <pub-id pub-id-type="pmid">32286268</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sbref9">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCINA: a semi-supervised subtyping algorithm of single cells and bulk samples</article-title>
        <source>Genes</source>
        <volume>10</volume>
        <issue>7</issue>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sbref10">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <volume>15</volume>
        <issue>5</issue>
        <year>2018</year>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sbref11">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat Immunol</source>
        <volume>20</volume>
        <issue>2</issue>
        <year>2019</year>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sbref12">
        <person-group person-group-type="author">
          <name>
            <surname>Dohmen</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying tumor cells at the single-cell level using machine learning</article-title>
        <source>Genome Biol</source>
        <volume>23</volume>
        <issue>1</issue>
        <year>2022</year>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sbref13">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science</source>
        <volume>352</volume>
        <issue>6282</issue>
        <year>2016</year>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">27124452</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sbref14">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell dissection of intratumoral heterogeneity and lineage diversity in metastatic gastric adenocarcinoma</article-title>
        <source>Nat Med</source>
        <volume>27</volume>
        <issue>1</issue>
        <year>2021</year>
        <fpage>141</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="pmid">33398161</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sbref15">
        <person-group person-group-type="author">
          <name>
            <surname>Puram</surname>
            <given-names>S.V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of primary and metastatic tumor ecosystems in head and neck</article-title>
        <source>Cancer Cell</source>
        <volume>171</volume>
        <issue>7</issue>
        <year>2017</year>
        <fpage>1611</fpage>
        <lpage>1624 e24</lpage>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sbref16">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S.Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell and spatially resolved atlas of human breast cancers</article-title>
        <source>Nat Genet</source>
        <volume>53</volume>
        <issue>9</issue>
        <year>2021</year>
        <fpage>1334</fpage>
        <lpage>1347</lpage>
        <pub-id pub-id-type="pmid">34493872</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sbref17">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Q.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomes reveal heterogeneity of high-grade serous ovarian carcinoma</article-title>
        <source>Clin Transl Med</source>
        <volume>11</volume>
        <issue>8</issue>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">e500</object-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sbref18">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-David</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Amon</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Context is everything: aneuploidy in cancer</article-title>
        <source>Nat Rev Genet</source>
        <volume>21</volume>
        <issue>1</issue>
        <year>2020</year>
        <fpage>44</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="pmid">31548659</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sbref19">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>A.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <volume>344</volume>
        <issue>6190</issue>
        <year>2014</year>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sbref20">
        <person-group person-group-type="author">
          <name>
            <surname>Serin Harmanci</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>A.O.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>CaSpER identifies and visualizes CNV events by integrative analysis of single-cell or bulk RNA-sequencing data</article-title>
        <source>Nat Commun</source>
        <volume>11</volume>
        <issue>1</issue>
        <year>2020</year>
        <fpage>89</fpage>
        <pub-id pub-id-type="pmid">31900397</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sbref21">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Delineating copy number and clonal substructure in human tumors from single-cell transcriptomes</article-title>
        <source>Nat Biotechnol</source>
        <volume>39</volume>
        <issue>5</issue>
        <year>2021</year>
        <fpage>599</fpage>
        <lpage>608</lpage>
        <pub-id pub-id-type="pmid">33462507</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sbref22">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the single-cell transcriptome network underlying gastric premalignant lesions and early gastric cancer</article-title>
        <source>Cell Rep</source>
        <volume>27</volume>
        <issue>6</issue>
        <year>2019</year>
        <fpage>1934</fpage>
        <lpage>1947 e5</lpage>
        <pub-id pub-id-type="pmid">31067475</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sbref23">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <volume>184</volume>
        <issue>13</issue>
        <year>2021</year>
        <comment>[p. 3573–+]</comment>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sbref24">
        <person-group person-group-type="author">
          <name>
            <surname>Yoshihara</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring tumour purity and stromal and immune cell admixture from expression data</article-title>
        <source>Nat Commun</source>
        <volume>4</volume>
        <year>2013</year>
        <fpage>2612</fpage>
        <pub-id pub-id-type="pmid">24113773</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="journal" id="sbref25">
        <person-group person-group-type="author">
          <name>
            <surname>Hanzelmann</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Castelo</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Guinney</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>
        <source>BMC Bioinform</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>7</fpage>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sbref26">
        <person-group person-group-type="author">
          <name>
            <surname>MacDermed</surname>
            <given-names>D.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MUC1-associated proliferation signature predicts outcomes in lung adenocarcinoma patients</article-title>
        <source>Bmc Med Genom</source>
        <year>2010</year>
        <fpage>3</fpage>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sbref27">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>DITHER: an algorIthm for defining intratumor heterogeneity based on EntRopy</article-title>
        <source>Brief Bioinform</source>
        <volume>22</volume>
        <issue>6</issue>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sbref28">
        <person-group person-group-type="author">
          <name>
            <surname>Bland</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>Survival probabilities (the Kaplan-Meier method)</article-title>
        <source>BMJ</source>
        <volume>317</volume>
        <issue>7172</issue>
        <year>1998</year>
        <fpage>1572</fpage>
        <pub-id pub-id-type="pmid">9836663</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sbref29">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc B</source>
        <volume>57</volume>
        <year>1995</year>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sbref30">
        <person-group person-group-type="author">
          <name>
            <surname>Sagi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Rokach</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Ensemble learning: a survey</article-title>
        <source>Wiley Interdiscip Rev-Data Min Knowl Discov</source>
        <volume>8</volume>
        <issue>4</issue>
        <year>2018</year>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="sec0095" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary material</title>
    <p id="p0190">
      <supplementary-material content-type="local-data" id="ec0005">
        <caption>
          <p><bold>Figure S1.</bold> The tumors highly expressing (&gt; median) TMGs had significantly lower overall and/or disease-free survival rates than the tumors lowly expressing (&lt; median) TMGs in 11 individual cancer types.</p>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0195">
      <supplementary-material content-type="local-data" id="ec0010">
        <caption>
          <p><bold>Figure S2. Correlations between the expression of non-tumor marker genes (NMGs) and immune and stromal signatures.</bold> NMGs having significant positive expression correlations with immune scores (<bold>A</bold>) and stromal scores (<bold>B</bold>) in pan-cancer and in most individual cancer types. Spearman correlation coefficients (<italic>ρ</italic>) and <italic>P</italic>-values are shown in <bold>A</bold> and <bold>B</bold>.</p>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0200">
      <supplementary-material content-type="local-data" id="ec0015">
        <caption>
          <p>Supplementary material</p>
        </caption>
        <media xlink:href="mmc3.xlsx"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0005">
    <title>Data Availability</title>
    <p id="p0030">All data supporting the findings of this study are available within the paper and its <xref rid="sec0095" ref-type="sec">Supplementary information</xref>. The R package for the PreCanCell algorithm is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/WangX-Lab/PreCanCell" id="ir0020">https://github.com/WangX-Lab/PreCanCell</ext-link>.</p>
  </sec>
  <ack id="ack0005">
    <title>Acknowledgements</title>
    <p id="p0180">Not applicable.</p>
  </ack>
  <fn-group>
    <fn id="sec0090" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0185">Supplementary data associated with this article can be found in the online version at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2023.07.009" id="ir0105">doi:10.1016/j.csbj.2023.07.009</ext-link>.</p>
    </fn>
  </fn-group>
</back>
