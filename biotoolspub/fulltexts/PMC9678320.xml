<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010686.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9678320</article-id>
    <article-id pub-id-type="pmid">36350852</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01025</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Processes</subject>
            <subj-group>
              <subject>Horizontal Gene Transfer</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Transfer</subject>
            <subj-group>
              <subject>Horizontal Gene Transfer</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Invertebrates</subject>
                <subj-group>
                  <subject>Nematoda</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Invertebrates</subject>
              <subj-group>
                <subject>Nematoda</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AvP: A software package for automatic phylogenetic detection of candidate horizontal gene transfers</article-title>
      <alt-title alt-title-type="running-head">AvP is a software for detection of horizontal gene transfers</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3406-3715</contrib-id>
        <name>
          <surname>Koutsovoulos</surname>
          <given-names>Georgios D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff"/>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Granjeon Noriot</surname>
          <given-names>Solène</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff001" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6032-1127</contrib-id>
        <name>
          <surname>Bailly-Bechet</surname>
          <given-names>Marc</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4146-5608</contrib-id>
        <name>
          <surname>Danchin</surname>
          <given-names>Etienne G. J.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9355-5491</contrib-id>
        <name>
          <surname>Rancurel</surname>
          <given-names>Corinne</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Institut Sophia Agrobiotech, Université Côte d’Azur, INRAE, CNRS, Sophia Antipolis, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Deakin University, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>gdkoutsovoulos@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>11</issue>
    <elocation-id>e1010686</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Koutsovoulos et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Koutsovoulos et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010686.pdf"/>
    <abstract>
      <p>Horizontal gene transfer (HGT) is the transfer of genes between species outside the transmission from parent to offspring. Due to their impact on the genome and biology of various species, HGTs have gained broader attention, but high-throughput methods to robustly identify them are lacking. One rapid method to identify HGT candidates is to calculate the difference in similarity between the most similar gene in closely related species and the most similar gene in distantly related species. Although metrics on similarity associated with taxonomic information can rapidly detect putative HGTs, these methods are hampered by false positives that are difficult to track. Furthermore, they do not inform on the evolutionary trajectory and events such as duplications. Hence, phylogenetic analysis is necessary to confirm HGT candidates and provide a more comprehensive view of their origin and evolutionary history. However, phylogenetic reconstruction requires several time-consuming manual steps to retrieve the homologous sequences, produce a multiple alignment, construct the phylogeny and analyze the topology to assess whether it supports the HGT hypothesis. Here, we present <italic toggle="yes">AvP</italic> which automatically performs all these steps and detects candidate HGTs within a phylogenetic framework.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-15-IDEX-01</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3406-3715</contrib-id>
          <name>
            <surname>Koutsovoulos</surname>
            <given-names>Georgios D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100018695</institution-id>
            <institution>AgreenSkills</institution>
          </institution-wrap>
        </funding-source>
        <award-id>609398</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3406-3715</contrib-id>
          <name>
            <surname>Koutsovoulos</surname>
            <given-names>Georgios D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work has been supported by the French government, through the UCA-JEDI “Investments in the Future” project managed by the National Research Agency (ANR) with the reference number ANR-15-IDEX-01. GDK has received the support of the EU in the framework of the Marie-Curie FP7 COFUND People Programme, through the award of an AgreenSkills+ fellowship (under grant number 609398).</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="11"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-11-21</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The acquisition of genes through horizontal gene transfer (HGT) is mostly observed in prokaryotes, where they play a significant role in adaptive evolution (e.g. antibiotic resistance). To a lesser degree, cases of HGT have also been observed in eukaryotes with important consequences in the biology of the organism [<xref rid="pcbi.1010686.ref001" ref-type="bibr">1</xref>]. The increase of new genomes being sequenced and the prediction of new gene sets, represents an opportunity to detect additional HGT cases and to characterize more precisely the possible donors. To sustain these needs, high-throughput yet robust HGT detection methods are required.</p>
    <p>One method to predict potential HGTs is to calculate the difference in similarity using BLAST [<xref rid="pcbi.1010686.ref002" ref-type="bibr">2</xref>] (or other sequence similarity search software) between phylogenetically closely related and distant species. The Alien Index (AI) metric uses the difference in e-value between the best hit from closely (Ingroup) and distantly (Donor) related taxa [<xref rid="pcbi.1010686.ref003" ref-type="bibr">3</xref>]. Positive AI means that the gene is more similar to a distant taxon and indicates a potential HGT. In the past, different values of AI have been used as a cutoff to decrease false positives but with the potential risk of missing HGTs. Similarly, the HGT Index (h) [<xref rid="pcbi.1010686.ref004" ref-type="bibr">4</xref>] uses the difference in bit scores but is hampered by the same limitations in terms of a trade-off between reducing false positives without missing valid cases. However, tracking these false positives from homology search results alone is not possible.</p>
    <p>Even if different cutoffs are applied to AI, the underlying best BLAST hit analysis is an oversimplistic method for the evolutionary complexity of HGT. Recently, an additional metric called outg_pct, which is the percentage of species from Donor lineage in the top hits that have different taxonomic species names, has been used in conjunction with AI to filter out some of the false positives resulting from erroneous taxonomic annotation of the best blast hits [<xref rid="pcbi.1010686.ref005" ref-type="bibr">5</xref>]. A more evolutionary comprehensive method is to extract the results from the whole BLAST analysis and infer a phylogenetic tree. The phylogenetic position of the potential HGT candidate in relation to the other genes and their taxonomy will provide an evolutionary framework and will validate or reject the HGT hypothesis. However, manually producing then checking each phylogenetic tree is a labour-intensive and time-consuming process. In addition, contamination or symbionts in genome sequencing, unless handled properly, can provide false positives that pass both AI and phylogenetic analysis [<xref rid="pcbi.1010686.ref006" ref-type="bibr">6</xref>]. External information, such as the target gene structure, taxonomic affiliation of genes near the target gene, and support by transcription data are necessary to eliminate such false positives. Combining all information will lead to a more accurate prediction of putative HGTs.</p>
    <p>Methods exist to perform gene tree species tree reconciliation to detect xenologs (i.e HGTs) [<xref rid="pcbi.1010686.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1010686.ref008" ref-type="bibr">8</xref>] and are able to distinguish genes that were transferred horizontally with or without duplication events. However, providing a species tree together with the gene tree is required. Therefore, testing hundreds of genes requires either creating different species trees according to the input sequences or comparing everything against the whole NCBI tree of life containing hundreds of thousands of branches.</p>
    <p>In this study, we present <italic toggle="yes">AvP</italic> (short for ‘Alienness vs Predictor’) to automate the robust identification of HGTs at high-throughput with no need to provide a reference species tree. <italic toggle="yes">AvP</italic> extracts all the information needed to produce input files to perform phylogenetic reconstruction, evaluate HGTs from the phylogenetic trees, and combine multiple other external information for additional support (e.g. gff3 annotation file, transcript quantification file). Our method does not rely on an explicit reference species tree and only uses a simplified take on the species phylogeny, according to the organism tested. This allows for a rapid phylogenetic detection of HGTs that can then be used as input for more sophisticated analyses.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Software description</title>
      <p><italic toggle="yes">AvP</italic> performs automatic detection of HGT candidates within a phylogenetic framework. The pipeline comprises two major steps: (i) <italic toggle="yes">prepare</italic>, and (ii) <italic toggle="yes">detect</italic>, and three optional steps: (iii) <italic toggle="yes">classify</italic>, (iv) <italic toggle="yes">evaluate</italic>, and (v) <italic toggle="yes">hgt_local_score</italic> (<xref rid="pcbi.1010686.g001" ref-type="fig">Fig 1</xref>). Although the pipeline has been extensively tested with protein datasets, it should work at the DNA level, including non-coding sequences (see GitHub documentation). For the rest of the article we assume a protein dataset.</p>
      <fig position="float" id="pcbi.1010686.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010686.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>AvP workflow.</title>
          <p>Dashed lines indicate optional routes and analyses.</p>
        </caption>
        <graphic xlink:href="pcbi.1010686.g001" position="float"/>
      </fig>
      <p><italic toggle="yes">AvP</italic> requires three primary files, (i) a fasta file containing the proteins of the species being studied, (ii) a tabular results file of similarity search (e.g. BLAST or DIAMOND [<xref rid="pcbi.1010686.ref009" ref-type="bibr">9</xref>]) against a protein database, and (iii) an AI features file. Furthermore, the user must provide two config files, one with information on the taxonomic ingroup in the study (defining which group of species is considered closely related and which group is distantly related) and one defining multiple software parameters. The AI features file can be created with the script <italic toggle="yes">calculate_ai.py</italic> which can be found in the repository.</p>
    </sec>
    <sec id="sec004">
      <title>AvP prepare</title>
      <p>The software selects proteins for downstream analyses based on any combination of the metrics AI, outg_pct, and AHS (described below). Then, the software collects all protein sequences corresponding to significant hits from the database based on the tabular results file of the homology search and groups the query species sequences based on the percentage of shared hits (by default 70%) using single linkage clustering. Alternatively, the user can specify a file containing user-generated groups of queries and hits (e.g. from OrthoFinder [<xref rid="pcbi.1010686.ref010" ref-type="bibr">10</xref>] or protein domain analysis). For each group, a fasta file is created containing the query species sequences and their respective database hits. Each file is then aligned using MAFFT [<xref rid="pcbi.1010686.ref011" ref-type="bibr">11</xref>] with an option for alignment trimming with trimAl [<xref rid="pcbi.1010686.ref012" ref-type="bibr">12</xref>].</p>
    </sec>
    <sec id="sec005">
      <title>AvP detect</title>
      <p>There are two options available for phylogenetic inference within <italic toggle="yes">AvP</italic>: (i) FastTree [<xref rid="pcbi.1010686.ref013" ref-type="bibr">13</xref>], and (ii) IQ-TREE [<xref rid="pcbi.1010686.ref014" ref-type="bibr">14</xref>]. The defaults for these programs are [-gamma -lg] for FastTree and [-mset WAG,LG,JTT -AICc -mrate E,I,G,R] for IQ-TREE. The user can change the IQ-TREE parameters in the config file. These two approaches vary in time and compute requirements, and consequently in tree reconstruction accuracy [<xref rid="pcbi.1010686.ref015" ref-type="bibr">15</xref>]. Alternatively, the software can utilise user-generated phylogenetic trees using the alignment files created with <italic toggle="yes">AvP prepare</italic> with any program that can produce a valid Newick tree format file. By default, <italic toggle="yes">AvP</italic> does not impose a branch support threshold. However, the user can define a support threshold in the config file under which branches collapse into polytomies.</p>
      <p>Each phylogenetic tree is then processed (midpoint rooting) and each query sequence is classified into one of the following three categories: HGT candidate (✓), Complex topology (?), No evidence for HGT (X). The taxonomic assignment of genes and their position in the tree relative to the query gene are used to characterise the gene as HGT or not. Two branches are taken into account, the sister branch of the gene of interest and the ancestral sister branch (<xref rid="pcbi.1010686.g002" ref-type="fig">Fig 2</xref>). Both of these branches are tagged independently depending on the included sequences to either Donor (i.e distantly related species), Ingroup (i.e closely related species), or both. Ingroup is defined by the user and Donor is all species not in Ingroup. The Ingroup tag is applied if most of the sequences (default 80%) belong to taxa inside the taxonomic group closely related to the species studied. Consequently, the Donor tag is applied if most of the sequences belong to taxa that fall outside of the Ingroup taxonomic clade. If the branch contains taxa from both groups at a ratio higher than 1 to 5, then the branch is tagged as both. The tags of these two branches are then processed according to <xref rid="pcbi.1010686.t001" ref-type="table">Table 1</xref>. For example, if we are searching in a eukaryotic species for HGT originating from prokaryotic species, the Ingroup is set to Eukaryota and the Donor to non Eukaryota (bacteria, viruses etc). If the sister branch of the query contains sequences that belong to eukaryotic species, it is tagged as Ingroup and the gene is not considered as an HGT. In another example, if both the sister branch and the ancestral sister branch contain mostly sequences from non eukaryotic species, both of the branches are tagged as Donor ant the gene is considered as a potential HGT.</p>
      <fig position="float" id="pcbi.1010686.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010686.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Tree example.</title>
          <p>Sister branch positions on the phylogenetic tree.</p>
        </caption>
        <graphic xlink:href="pcbi.1010686.g002" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1010686.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010686.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Detection table whether the gene tested is an HGT candidate.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010686.t001" id="pcbi.1010686.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="2" colspan="1">Ancestral SB</th>
                <th align="center" colspan="3" rowspan="1">Sister branch (SB)</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Donor</th>
                <th align="center" rowspan="1" colspan="1">Ingroup</th>
                <th align="center" rowspan="1" colspan="1">Donor + Ingroup</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Donor</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">X</td>
                <td align="center" rowspan="1" colspan="1">?</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Ingroup</td>
                <td align="center" rowspan="1" colspan="1">?</td>
                <td align="center" rowspan="1" colspan="1">X</td>
                <td align="center" rowspan="1" colspan="1">X</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Donor + Ingroup</td>
                <td align="center" rowspan="1" colspan="1">?</td>
                <td align="center" rowspan="1" colspan="1">X</td>
                <td align="center" rowspan="1" colspan="1">?</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Not present</td>
                <td align="center" rowspan="1" colspan="1">✓</td>
                <td align="center" rowspan="1" colspan="1">X</td>
                <td align="center" rowspan="1" colspan="1">?</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For each query sequence, the software produces a nexus formatted file containing the phylogenetic tree, the taxonomic information for each sequence, and each sequence coloured by the taxonomic affiliation for quick visual parsing. The nexus file can be visualised with the tree visualisation software FigTree [<xref rid="pcbi.1010686.ref016" ref-type="bibr">16</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>AvP classify</title>
      <p>This step allows the further classification of HGT candidates into user-generated nested taxonomic ranks for their putative origins. It follows the same logic as in the step <italic toggle="yes">AvP detect</italic> described previously in terms of tagging the clades to a specific taxonomic affiliation. For example, the HGTs can be classified based on their origin, such as Fungi, Viridiplantae, Viruses etc., according to the NCBI taxonomy.</p>
    </sec>
    <sec id="sec007">
      <title>AvP evaluate</title>
      <p>For each HGT candidate, the topology is constrained to form a single monophyletic group containing the query sequence and all the Ingroup sequences. A phylogenetic tree is inferred with FastTree or IQ-TREE and the likelihoods of the initial and constrained topologies are compared with IQ-TREE, which supports several tree topology tests. This step can inform whether the topology supporting HGT is more likely than the alternative constrained topology that does not support HGT.</p>
    </sec>
    <sec id="sec008">
      <title>AvP hgt_local_score</title>
      <p>Given a gff3 file containing the genomic location of the genes of the query species and the results of the <italic toggle="yes">AvP</italic> analyses, this step calculates a score for each HGT candidate that corresponds to whether the HGT candidate is surrounded by genes from the query genome or ‘alien’ genes, including possible contaminants. The score ranges between -1 and +1, with -1 indicating strongly a contamination while +1 indicating strongly a HGT candidate (<xref rid="pcbi.1010686.g003" ref-type="fig">Fig 3</xref>). The rationale is that a candidate HGT surrounded by genes that were also detected as candidate HGT might be part of a contaminant insertion in the genome assembly (although HGT of a whole block of genes or duplications after acquisition are also possible). Hence, this step allows alerting the user on possible contaminations. On the opposite, if the candidate HGT is surrounded by genes that were more likely inherited vertically, the contamination hypothesis can be reasonably ruled out.</p>
      <fig position="float" id="pcbi.1010686.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010686.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>HGT local score calculation.</title>
          <p>Each neighbouring gene contributes to the score based on its classification getting a value described in the top left panel. In the example, the score is equal to 0.34, most likely indicating an HGT insertion. Overall, a score above 0 indicates an HGT insertion, while a score below 0 indicates a possible contamination or HGT rich region.</p>
        </caption>
        <graphic xlink:href="pcbi.1010686.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>AHS: A new contamination-aware metric</title>
      <p>The two metrics that are widely used (AI and h) utilise only the best Ingroup and Donor hit from the BLAST output. This poses several potential issues and AI in particular can be 0 if both hits have e-value of 0, although they can differ in similarity. The h metric resolves this problem by using the bitscore instead of the e-value. However, both of these metrics are sensitive to taxonomically misclassified or contaminating sequences in databases as they only rely on the best hits. For instance, if the best hit is wrongly assigned a Donor taxid in the database, these metrics will erroneously detect a candidate HGT. In the opposite, a wrongly assigned Ingroup taxid in the database would necessarily result in no HGT detection if it is the best hit. A different approach to try to circumvent this issue is to aggregate all the bitscores of Donor and Ingroup sequences and then perform the calculation of h. Although this approach will minimise erroneous results it will still suffer from sampling biases.</p>
      <p>In order to minimise all these effects we developed a new metric called Aggregate Hit Support (AHS). We first normalise each bitscore <xref rid="pcbi.1010686.e001" ref-type="disp-formula">Eq (1)</xref>. We then sum all the normalised bitscores of the Donor hits and all the normalised bitscores of the Ingroup hits seperately and calculate the difference <xref rid="pcbi.1010686.e002" ref-type="disp-formula">Eq (2)</xref>. A positive AHS score suggests a potential HGT candidate.
<disp-formula id="pcbi.1010686.e001"><alternatives><graphic xlink:href="pcbi.1010686.e001.jpg" id="pcbi.1010686.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>10</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pcbi.1010686.e002"><alternatives><graphic xlink:href="pcbi.1010686.e002.jpg" id="pcbi.1010686.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mi>H</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mo>∑</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec010">
    <title>Results</title>
    <sec id="sec011">
      <title>HGT pipeline</title>
      <p>We tested our pipeline using the predicted protein set for the tardigrade species <italic toggle="yes">Hypsibius exemplaris</italic> (previously named <italic toggle="yes">H</italic>. dujardini) [<xref rid="pcbi.1010686.ref017" ref-type="bibr">17</xref>]. We used the database NCBI nr instead of SwissProt+TrEMBL libraries, used in the original publication, and selected candidates with <italic toggle="yes">AI</italic> &gt; 30 instead of <italic toggle="yes">h</italic><sub><italic toggle="yes">ST</italic></sub> &gt; 30 (HGT Index), while the phylogenetic inference was performed with FastTree instead of RAxML [<xref rid="pcbi.1010686.ref018" ref-type="bibr">18</xref>]. The final selection was 401 proteins (386 genes) compared to 463 proteins (463 genes), and based on the phylogenetic trees, we detected a total of 379 candidate HGTs (95%) instead of 357 (77%). Overall, 342 candidate HGTs were common to <italic toggle="yes">AvP</italic> and the previously published analysis, the ones not identified by our pipeline having an AI below 30. We then evaluated the candidate HGTs by comparing the likelihoods of the original HGT-supporting trees to those of constrained trees in which tardigrade and other metazoan proteins were forced to form a monophyletic group. Equally likely topologies were observed for 27 proteins bringing the total number of strongly supported candidate HGTs to 352 (1.7% of the total proteins present in the genome). To assess the effect of using different databases, we performed two more searches against SwissProt (SP) and Uniref90 (UR). A total of 196 / 333 / 401 proteins were selected when using SP / UR / NR resulting in 127 / 292 / 352 candidate HGTs after alternative topology tests (<italic toggle="yes">AvP evaluate</italic>). Hence, depending on the sampling of the sequence diversity present in the sequence database, the number of detectable candidate HGT varies considerably.</p>
      <p>In the original publication describing Alien Index (AI) [<xref rid="pcbi.1010686.ref003" ref-type="bibr">3</xref>], the authors considered <italic toggle="yes">AI</italic> &gt; 45 to be a good indication of foreign origin while genes with 0 &lt; <italic toggle="yes">AI</italic> &lt; 45 were designated intermediate. However, this AI threshold value was originally defined on one single species only, the bdelloid rotifer, and further analyses on plant-parasitic nematodes have shown that an <italic toggle="yes">AI</italic> &gt; 45 might be too stringent, leaving several true positives undetectable [<xref rid="pcbi.1010686.ref019" ref-type="bibr">19</xref>]. Here, we calculated the F1 score <xref rid="pcbi.1010686.e003" ref-type="disp-formula">Eq (3)</xref> for all N with <italic toggle="yes">AI</italic> &gt; 0 in <italic toggle="yes">H. exemplaris</italic> to decide the optimal threshold between precision and sensitivity. We found that selecting genes with <italic toggle="yes">AI</italic> &gt; 10 represented an optimal balance between sensitivity and precision (<xref rid="pcbi.1010686.g004" ref-type="fig">Fig 4</xref>). Therefore, we propose to perform <italic toggle="yes">AvP</italic> with <italic toggle="yes">AI</italic> &gt; 0 with FastTree option to minimize the risk of missing HGT cases and utilise the scripts provided to calculate the F1 score and based on that, decide the optimal AI threshold (which is 10 for tardigrade example) for more sophisticated and time-consuming phylogenetic analyses.
<disp-formula id="pcbi.1010686.e003"><alternatives><graphic xlink:href="pcbi.1010686.e003.jpg" id="pcbi.1010686.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <fig position="float" id="pcbi.1010686.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010686.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Sensitivity, precision, and F1 score calculations.</title>
          <p>Sensitivity, Precision, and F1 Score were calculated for Alien Index (AI) up to 40 for the proteins of the tardigrade <italic toggle="yes">Hypsibius exemplaris</italic>. The dashed line indicates the AI with the highest F1 score indicating the most accurate AI threshold.</p>
        </caption>
        <graphic xlink:href="pcbi.1010686.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>AHS metric</title>
      <p>To test the new metric, we performed an <italic toggle="yes">AvP</italic> analysis with the nematode <italic toggle="yes">Caenorhabditis elegans</italic> and excluding members of the Nematoda phylum from the metazoan matches. Hence, the analysis was configured to identify HGT of non-metazoan origin in <italic toggle="yes">C. elegans</italic> and possibly present in any other nematoda species. We compared the list of potential HGTs by Crisp et al., [<xref rid="pcbi.1010686.ref020" ref-type="bibr">20</xref>] with the results obtained by <italic toggle="yes">AvP</italic> (see <xref rid="pcbi.1010686.s001" ref-type="supplementary-material">S1 File</xref> for full results of the comparison). By using an initial filter of <italic toggle="yes">AI</italic> &gt; 0 or <italic toggle="yes">AHS</italic> &gt; 0 we managed to recover 5 cases that would have been missed if there were filtered only on AI.</p>
      <p>We thoroughly checked two of these cases where AI and AHS disagreed to identify the cause. In the first case, AI is 318, indicating a strong HGT candidate, while AHS is -44029 indicating the opposite. The two proteins that are identified as Bacteria, and thus as best non-metazoan hits, are most likely taxonomically missclasified since they are almost identical to the nematode protein and nested in a branch otherwise containing only nematode sequences and not found in any other bacterium (<xref rid="pcbi.1010686.s002" ref-type="supplementary-material">S1 Fig</xref>). An alternative less likely hypothesis is that these proteins represent a recent transfer from nematodes to bacteria. In any case, this does not represent HGT from bacteria to nematodes and the AHS metric is not misled by this likely erroneous taxonomic annotation.</p>
      <p>In the second case, AI is 7 indicating a poorly supported HGT candidate, while AHS is 10356 indicating a strong HGT candidate (<xref rid="pcbi.1010686.s003" ref-type="supplementary-material">S2 Fig</xref>). The closest non nematode metazoan hit is annotated as a rodent protein. Running a BLAST for this protein in nr shows that it is very similar to a nematode of the genus <italic toggle="yes">Trichuris</italic> which some of its members are shown to be rodent parasites. Thus the rodent protein is actually more likely to represent contamination from a nematode one and should have been excluded from calculating AI and AHS. Although for <italic toggle="yes">C. elegans</italic> the difference in AI and AHS appear small, performing AI and AHS calculation on the <italic toggle="yes">Trichuris suis</italic> protein results in <italic toggle="yes">AI</italic> &lt; −50 while <italic toggle="yes">AHS</italic> &gt; 10000, further indicating that AHS is much less sensitive to taxonomic annotation errors than AI.</p>
      <p>Consequently, it seems that this new AHS metric is able to correct errors due to contamination and taxonomic assignation bias. We thus implemented this new metric in <italic toggle="yes">AvP</italic> and recommend to use it in combination with AI or other metric.</p>
    </sec>
  </sec>
  <sec id="sec013">
    <title>Future directions and availability</title>
    <p>We propose <italic toggle="yes">AvP</italic> to facilitate the identification and evaluation of candidate HGTs in sequenced genomes across multiple branches of the tree of life. The most common methods used so far have been based on the difference of similarity between Donor and Ingroup sequences. We also propose and implemented AHS, a new metric aiming to address contamination and erroneous taxonomic annotation. Performing phylogenetic reconstruction and alternative topology evaluation creates a framework under which more robust HGT analyses can be performed. <italic toggle="yes">AvP</italic> can contribute to rapidly populate a reliable dataset with phylogenetically supported HGT cases across the tree of life. This could eventually be used in machine learning approaches in the future attempt to predict HGT events from sequence feature themselves. Furthermore, calculating the hgt_local_score can help identify contamination and HGT hot spots in the genome. In the future, we aim to incorporate a basic module of <italic toggle="yes">AvP</italic> to the Alieness webserver [<xref rid="pcbi.1010686.ref019" ref-type="bibr">19</xref>], to facilitate usage of <italic toggle="yes">AvP</italic> for biologists not familiar with command line software.</p>
    <p>The <italic toggle="yes">AvP</italic> software is available at <ext-link xlink:href="https://github.com/GDKO/AvP" ext-link-type="uri">https://github.com/GDKO/AvP</ext-link>. It is released under GNU General Public License v3.0.</p>
  </sec>
  <sec id="sec014" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010686.s001" position="float" content-type="local-data">
      <label>S1 File</label>
      <caption>
        <title>Comparing <italic toggle="yes">AvP</italic> results on <italic toggle="yes">C. elegans</italic> to Crisp et al., 2015.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010686.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010686.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Phylogenetic tree for protein F40E10.3.</title>
        <p>Nematoda proteins are excluded from the analysis (dark orange). Bacteria proteins are coloured green while Metazoan proteins are coloured orange. The two bacterial proteins returning the best non-metazoan hits belong to <italic toggle="yes">Escherichia coli</italic> and <italic toggle="yes">Nitriliruptoraceae bacterium</italic> and are almost identical to the protein from <italic toggle="yes">C. elegans</italic> indicating that they are missclasified.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010686.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010686.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Phylogenetic tree for protein F44B9.9.</title>
        <p>Nematoda proteins are excluded from the analysis (dark orange). Fungal proteins are coloured light green, Metazoan proteins are coloured orange, Viridiplantae proteins are coloured teal, and other non-metazoan eukaryotic proteins are coloured blue. The best Metazoan hit (excluding nematode proteins) marked with the arrow most likely belongs to a nematode from <italic toggle="yes">Trichuris</italic> genus.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010686.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to the genotoul bioinformatics platform Toulouse Occitanie (Bioinfo Genotoul, doi: <ext-link xlink:href="https://doi.org/10.15454/1.5572369328961167E12" ext-link-type="uri">10.15454/1.5572369328961167E12</ext-link>) for providing computing resources. We are also grateful to the OPAL infrastructure from Université Côte d’Azur and to the Université Côte d’Azur’s Center for High-Performance Computing for providing resources and support.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010686.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Danchin</surname><given-names>EGJ</given-names></name>. <article-title>Lateral gene transfer in eukaryotes: tip of the iceberg or of the ice cube?</article-title><source>BMC Biology</source>. <year>2016</year>;<volume>14</volume>(<issue>1</issue>):<fpage>101</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12915-016-0330-x</pub-id><?supplied-pmid 27863503?><pub-id pub-id-type="pmid">27863503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <name><surname>Bealer</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>421</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id><?supplied-pmid 20003500?><pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Gladyshev</surname><given-names>EA</given-names></name>, <name><surname>Meselson</surname><given-names>M</given-names></name>, <name><surname>Arkhipova</surname><given-names>IR</given-names></name>. <article-title>Massive Horizontal Gene Transfer in Bdelloid Rotifers</article-title>. <source>Science</source>. <year>2008</year>;<volume>320</volume>(<issue>5880</issue>):<fpage>1210</fpage>–<lpage>1213</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1156407</pub-id><?supplied-pmid 18511688?><pub-id pub-id-type="pmid">18511688</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Boschetti</surname><given-names>C</given-names></name>, <name><surname>Carr</surname><given-names>A</given-names></name>, <name><surname>Crisp</surname><given-names>A</given-names></name>, <name><surname>Eyres</surname><given-names>I</given-names></name>, <name><surname>Wang-Koh</surname><given-names>Y</given-names></name>, <name><surname>Lubzens</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Biochemical Diversification through Foreign Gene Expression in Bdelloid Rotifers</article-title>. <source>PLOS Genetics</source>. <year>2012</year>;<volume>8</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1003035</pub-id><?supplied-pmid 23166508?><pub-id pub-id-type="pmid">23166508</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>Z</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Shi</surname><given-names>Z</given-names></name>, <name><surname>Pang</surname><given-names>L</given-names></name>, <name><surname>Chen</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>HGT is widespread in insects and contributes to male courtship in lepidopterans</article-title>. <source>Cell</source>. <year>2022</year>;<volume>185</volume>(<issue>16</issue>):<fpage>2975</fpage>–<lpage>2987</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2022.06.014</pub-id><?supplied-pmid 35853453?><pub-id pub-id-type="pmid">35853453</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Koutsovoulos</surname><given-names>G</given-names></name>, <name><surname>Kumar</surname><given-names>S</given-names></name>, <name><surname>Laetsch</surname><given-names>DR</given-names></name>, <name><surname>Stevens</surname><given-names>L</given-names></name>, <name><surname>Daub</surname><given-names>J</given-names></name>, <name><surname>Conlon</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>No evidence for extensive horizontal gene transfer in the genome of the tardigrade <italic toggle="yes">Hypsibius dujardini</italic></article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>18</issue>):<fpage>5053</fpage>–<lpage>5058</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1600338113</pub-id><?supplied-pmid 27035985?><pub-id pub-id-type="pmid">27035985</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jacox</surname><given-names>E</given-names></name>, <name><surname>Chauve</surname><given-names>C</given-names></name>, <name><surname>Szöllősi</surname><given-names>GJ</given-names></name>, <name><surname>Ponty</surname><given-names>Y</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>. <article-title>ecceTERA: comprehensive gene tree-species tree reconciliation using parsimony</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>13</issue>):<fpage>2056</fpage>–<lpage>2058</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw105</pub-id><?supplied-pmid 27153713?><pub-id pub-id-type="pmid">27153713</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Darby</surname><given-names>CA</given-names></name>, <name><surname>Stolzer</surname><given-names>M</given-names></name>, <name><surname>Ropp</surname><given-names>PJ</given-names></name>, <name><surname>Barker</surname><given-names>D</given-names></name>, <name><surname>Durand</surname><given-names>D</given-names></name>. <article-title>Xenolog classification</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>33</volume>(<issue>5</issue>):<fpage>640</fpage>–<lpage>649</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Buchfink</surname><given-names>B</given-names></name>, <name><surname>Xie</surname><given-names>C</given-names></name>, <name><surname>Huson</surname><given-names>DH</given-names></name>. <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id><?supplied-pmid 25402007?><pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Emms</surname><given-names>DM</given-names></name>, <name><surname>Kelly</surname><given-names>S</given-names></name>. <article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>238</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1832-y</pub-id><?supplied-pmid 31727128?><pub-id pub-id-type="pmid">31727128</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>. <source>Molecular Biology and Evolution</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Capella-Gutiérrez</surname><given-names>S</given-names></name>, <name><surname>Silla-Martínez</surname><given-names>JM</given-names></name>, <name><surname>Gabaldón</surname><given-names>T</given-names></name>. <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id><?supplied-pmid 19505945?><pub-id pub-id-type="pmid">19505945</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>MN</given-names></name>, <name><surname>Dehal</surname><given-names>PS</given-names></name>, <name><surname>Arkin</surname><given-names>AP</given-names></name>. <article-title>FastTree 2—Approximately Maximum-Likelihood Trees for Large Alignments</article-title>. <source>PLOS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id><?supplied-pmid 20224823?><pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Minh</surname><given-names>BQ</given-names></name>, <name><surname>Schmidt</surname><given-names>HA</given-names></name>, <name><surname>Chernomor</surname><given-names>O</given-names></name>, <name><surname>Schrempf</surname><given-names>D</given-names></name>, <name><surname>Woodhams</surname><given-names>MD</given-names></name>, <name><surname>von Haeseler</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title>. <source>Molecular Biology and Evolution</source>. <year>2020</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><?supplied-pmid 32011700?><pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X</given-names></name>, <name><surname>Shen</surname><given-names>XX</given-names></name>, <name><surname>Hittinger</surname><given-names>CT</given-names></name>, <name><surname>Rokas</surname><given-names>A</given-names></name>. <article-title>Evaluating Fast Maximum Likelihood-Based Phylogenetic Programs Using Empirical Phylogenomic Data Sets</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>2</issue>):<fpage>486</fpage>–<lpage>503</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msx302</pub-id><?supplied-pmid 29177474?><pub-id pub-id-type="pmid">29177474</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref016">
      <label>16</label>
      <mixed-citation publication-type="other">Rambaut A. FigTree v1.4.4. Available from: <ext-link xlink:href="http://tree.bio.ed.ac.uk/software/figtree/" ext-link-type="uri">http://tree.bio.ed.ac.uk/software/figtree/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Yoshida</surname><given-names>Y</given-names></name>, <name><surname>Koutsovoulos</surname><given-names>G</given-names></name>, <name><surname>Laetsch</surname><given-names>DR</given-names></name>, <name><surname>Stevens</surname><given-names>L</given-names></name>, <name><surname>Kumar</surname><given-names>S</given-names></name>, <name><surname>Horikawa</surname><given-names>DD</given-names></name>, <etal>et al</etal>. <article-title>Comparative genomics of the tardigrades <italic toggle="yes">Hypsibius dujardini</italic> and <italic toggle="yes">Ramazzottius varieornatus</italic></article-title>. <source>PLOS Biology</source>. <year>2017</year>;<volume>15</volume>(<issue>7</issue>):<fpage>1</fpage>–<lpage>40</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.2002266</pub-id><?supplied-pmid 28749982?><pub-id pub-id-type="pmid">28749982</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Stamatakis</surname><given-names>A</given-names></name>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>–<lpage>1313</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id><?supplied-pmid 24451623?><pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Rancurel</surname><given-names>C</given-names></name>, <name><surname>Legrand</surname><given-names>L</given-names></name>, <name><surname>Danchin</surname><given-names>EGJ</given-names></name>. <article-title>Alienness: Rapid Detection of Candidate Horizontal Gene Transfers across the Tree of Life</article-title>. <source>Genes</source>. <year>2017</year>;<volume>8</volume>(<issue>10</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/genes8100248</pub-id><?supplied-pmid 28961181?><pub-id pub-id-type="pmid">28961181</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010686.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Crisp</surname><given-names>A</given-names></name>, <name><surname>Boschetti</surname><given-names>C</given-names></name>, <name><surname>Perry</surname><given-names>M</given-names></name>, <name><surname>Tunnacliffe</surname><given-names>A</given-names></name>, <name><surname>Micklem</surname><given-names>G</given-names></name>. <article-title>Expression of multiple horizontally acquired genes is a hallmark of both vertebrate and invertebrate genomes</article-title>. <source>Genome Biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-015-0607-3</pub-id><pub-id pub-id-type="pmid">25583448</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010686.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Noble, Ziemann</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Noble, Ziemann</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Aug 2022</named-content>
    </p>
    <p>Dear Dr Koutsovoulos,</p>
    <p>Thank you very much for submitting your manuscript "AvP: a software package for automatic phylogenetic detection of candidate horizontal gene transfers." for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mark Ziemann</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Dear Dr Koutsovoulos,</p>
    <p>The manuscript has been reviewed by two experts in the field and overall impressions of the software and manuscript were positive, although both reviewers requested greater clarity in the writing and explanation of certain points. Reviewer 2 point 2 has requested the software to detect non-protein coding genes, which is an excellent suggestion and of reat value to the field, however I am mindful that this may require extensive retooling of the software. I would like to flag this software feature as optional for the authors to address, however it must be mentioned as a limitation/future direction in the discussion of the manuscript along with any challenges that may be apparent when detecting HGT of non-coding genes. I look forward to receiving a revised version of the manuscript.</p>
    <p>Regards,</p>
    <p>Mark Ziemann, PhD</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Koutsovolous et al. present AvP, a pipeline to automatically identify horizontally transferred genes, along with a set of metrics that allow users to evaluate these predictions. By using phylogenetics at its core, AvP represents a substantial improvement compared to existing best BLAST hit-based approaches. Moreover, the metrics they develop help to address many of the issues with HGT detection (e.g. contamination in assemblies and databases). I was able to install the software from GitHub and the documentation is clear. I have no doubt that AvP will be well used and well cited by researchers interested in HGT. I struggled to find anything to complain about and, as such, I would be happy to recommend the manuscript once a few of my very minor comments (below) have been addressed/considered.</p>
    <p>1. Lines 32-38: It took me a few readings of this paragraph to work out that the authors were suggesting that the existing methods that reconcile gene/species trees were not ideal because of the requirement of a species tree - could it be reworked slightly to make the message clearer? Even adding “However” before “To achieve this” would help. Note there are a few typos in here too: hundred &gt; hundreds, compare &gt; comparing, wth &gt; with.</p>
    <p>2. Lines 57-59: “AI features file can be automatically generated with the Alienness webserver” - I note that this is scored out in the GitHub instructions; is this no longer true?</p>
    <p>3. Lines 91-92: “is all not in Ingroup” &gt; “is all species not in Ingroup”</p>
    <p>4. Lines 153-154: note that the sequenced Sciento strain of tardigrades was redescribed as H. exemplaris. I’ll let the authors decide if they'd rather use H. dujardini for consistency with previous publications or H. exemplaris for taxonomic correctness.</p>
    <p>5. Lines 185-204: The authors only discuss the two problematic cases in their run on C. elegans, which is valuable, but what about all the other predicted HGT loci? How many were there? Were any of interest or consistent with previous work? I understand that analysing this in-depth is beyond the remit of this manuscript, but it seems odd to not mention anything other than where this had problems. A few examples of what can be discovered with the pipeline would be a valuable addition.</p>
    <p>6. Lines 201-203: “Consequently, it seems that this new AHS metric is able to correct errors due to contamination and taxonomic assignment bias.” Perhaps I’m confused but doesn’t the AHS value, which suggests that the rodent protein is a strong HGT candidate (10356), suggests the opposite? Surely AHS is positively misleading in this case, and even more so than AI? Or are the authors suggesting that it’s the difference between AHS and AI that is indicative of a false positive?</p>
    <p>7. Github: it would be great if the authors could add some worked examples (e.g. the tardigrade and/or C. elegans examples in the paper) to show users how to set this up.</p>
    <p>Reviewer #2: I appreciate that Koutsovoulos et al. put multiple steps that are used to detect HGT into one automatic tool called “AvP”. The study is written well and the tool is friendly to users.</p>
    <p>I have four main concerns that authors might wish to address.</p>
    <p>1. The AvP incorporated the AI values and phylogenetic robustness. Not sure how different AI cutoff will influence outputs. Of courses, there is no standard criterion. Given the complexity of the database, sometimes, the database could contain contamination so that the query protein is highly similar to the hit from contamination. A recent paper (<ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/35853453/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/35853453/</ext-link>) has considered anther parameter “outg_pct”, that is the percentage of species from OUTGROUP lineage in the list of the top 1,000 hits that have different taxonomic species names. Did you consider this too? If not, why or discuss it?</p>
    <p>2. The AvP is aiming to detect HGT based on protein-coding genes (or protein sequence), which has been done many previous studies (although they built their own pipelines). Would you please extend your tool to non-coding sequences? If you can make it, that will be much helpful, because nearly all published studies have not done this. And I think non-coding sequences could aslo be HGT too.</p>
    <p>3. It seems that the graph neural network (or machine learning) was used to predict the HGT. if it is possible, please compare your tool with it in term of accuracy of HGT identification. If this’s hard, it would be good to discuss this aspect in your study for future direction.</p>
    <p>4. If The AvP tool can also report the characteristics of HGT including the codon usage bias, dn/ds, the sequence similarity between donor and recipient, which would be better.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010686.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">7 Oct 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010686.s004" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.rtf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010686.s004.rtf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010686.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Noble, Ziemann</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Noble, Ziemann</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">17 Oct 2022</named-content>
    </p>
    <p>Dear Dr Koutsovoulos,</p>
    <p>Thank you for the revised manuscript which I see has addressed most of the reviewer comments.</p>
    <p>For your general information, if you agree with the reviewers' comments, it is good form to address them in the manuscript, as it is likely that the readership will have similar concerns. In the rebuttal letter, indicate which lines of the manuscript have been added/amended. This is relevant to points R1P2, R2P1, R2P2. If you could please amend the manuscript and rebuttal letter to this effect it can be send to reviewer 2 again.</p>
    <p>Regards,</p>
    <p>Mark Ziemann, PhD</p>
    <p>---------------</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mark Ziemann</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Dear Dr Koutsovoulos,</p>
    <p>Thank you for the revised manuscript which I see has addressed most of the reviewer comments.</p>
    <p>For your general information, if you agree with the reviewers' comments, it is good form to address them in the manuscript, as it is likely that the readership will have similar concerns. In the rebuttal letter, indicate which lines of the manuscript have been added/amended. This is relevant to points R1P2, R2P1, R2P2. If you could please amend the manuscript and rebuttal letter to this effect it can be send to reviewer 2 again.</p>
    <p>Regards,</p>
    <p>Mark Ziemann, PhD</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010686.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">21 Oct 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010686.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.rtf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010686.s005.rtf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010686.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Noble, Ziemann</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Noble, Ziemann</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">26 Oct 2022</named-content>
    </p>
    <p>Dear Koutsovoulos,</p>
    <p>We are pleased to inform you that your manuscript 'AvP: a software package for automatic phylogenetic detection of candidate horizontal gene transfers.' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Mark Ziemann</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: Thank you very much for including my suggestions! I don’t have any concerns and think it’s ready for publication.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: <bold>Yes: </bold>Xing-Xing Shen</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010686.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010686.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Noble, Ziemann</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Noble, Ziemann</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010686" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Nov 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01025R2 </p>
    <p>AvP: a software package for automatic phylogenetic detection of candidate horizontal gene transfers.</p>
    <p>Dear Dr Koutsovoulos,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofia Freund</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
