<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3324515</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts094</article-id>
    <article-id pub-id-type="publisher-id">bts094</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Oases:</italic> robust <italic>de novo</italic> RNA-seq assembly across the dynamic range of expression levels</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schulz</surname>
          <given-names>Marcel H.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="fn" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zerbino</surname>
          <given-names>Daniel R.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
        <xref ref-type="fn" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vingron</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Birney</surname>
          <given-names>Ewan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Computational Molecular Biology, Max Planck Institute for Molecular Genetics, Ihnestraße 63-73, D-14195 Berlin, Germany, <sup>2</sup>Lane Center for Computational Biology, Carnegie Mellon University, Pittsburgh, PA 15213, USA, <sup>3</sup>European Bioinformatics Institute, Wellcome Trust Genome Campus, CBS 10 SD, Hinxton, Cambridgeshire, UK and <sup>4</sup>Center for Biomolecular Science and Engineering, University of California Santa Cruz, Santa Cruz, CA 95064, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>8</issue>
    <fpage>1086</fpage>
    <lpage>1092</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>12</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>1</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>2</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> High-throughput sequencing has made the analysis of new model organisms more affordable. Although assembling a new genome can still be costly and difficult, it is possible to use RNA-seq to sequence mRNA. In the absence of a known genome, it is necessary to assemble these sequences <italic>de novo</italic>, taking into account possible alternative isoforms and the dynamic range of expression values.</p>
      <p><bold>Results:</bold> We present a software package named Oases designed to heuristically assemble RNA-seq reads in the absence of a reference genome, across a broad spectrum of expression values and in presence of alternative isoforms. It achieves this by using an array of hash lengths, a dynamic filtering of noise, a robust resolution of alternative splicing events and the efficient merging of multiple assemblies. It was tested on human and mouse RNA-seq data and is shown to improve significantly on the transABySS and Trinity <italic>de novo</italic> transcriptome assemblers.</p>
      <p><bold>Availability and implementation:</bold> Oases is freely available under the GPL license at <ext-link ext-link-type="uri" xlink:href="www.ebi.ac.uk/~zerbino/oases/">www.ebi.ac.uk/~zerbino/oases/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>dzerbino@ucsc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Next-generation sequencing of expressed mRNAs (RNA-seq) is gradually transforming the field of transcriptomics (<xref ref-type="bibr" rid="B2">Blencowe <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B27">Wang <italic>et al.</italic>, 2009</xref>). The first attempts to discover expressed gene isoforms relied on mapping the RNA-seq reads onto the exons and exon–exon junctions of a known annotation (<xref ref-type="bibr" rid="B10">Jiang and Wong 2009</xref>; <xref ref-type="bibr" rid="B15">Mortazavi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B18">Richard <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B22">Sultan <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B26">Wang <italic>et al.</italic>, 2008</xref>). Consequently, reference-based <italic>ab initio</italic> methods have been developed to assemble a transcriptome from RNA-seq data using read alignments alone, inferring the underlying annotation (<xref ref-type="bibr" rid="B5">Denoeud <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B6">Guttman <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B24">Trapnell <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B30">Yassour <italic>et al.</italic>, 2009</xref>).</p>
    <p>Unfortunately, the use of a reference genome is not always possible. Despite the drop in the cost of sequencing reagents, the complete study of a genome, from sampling to finishing the assembly is still costly and difficult. Sometimes, the model being studied is sufficiently different from the reference because it comes from a different strain or line such that the mappings are not altogether reliable. For these cases, <italic>de novo</italic> genome assemblers have been employed to create transcript assemblies, or <italic>transfrags,</italic> from the RNA-seq reads in the absence of a reference genome (<xref ref-type="bibr" rid="B1">Birol <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B4">Collins <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B9">Jackson <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B25">Wakaguri <italic>et al</italic>, 2009</xref>).</p>
    <p>However, these short read genomic assemblers, based mainly on de Bruijn graph genomic assemblers (<xref ref-type="bibr" rid="B32">Zerbino and Birney, 2008</xref>; <xref ref-type="bibr" rid="B20">Simpson <italic>et al.</italic>, 2009</xref>), make implicit assumptions regarding the evenness of the coverage and the colinearity of the sequence. Indeed, the coverage depth fluctuates significantly between transcripts, isoforms and regions of the transcript, therefore it cannot be used to determine the uniqueness of regions or to isolate erroneous sequence. In addition, these tools are geared to produce long linear contigs from the given sequence, not to detect the overlapping sequences presented by isoforms of a single gene. This affects a number of steps, including error correction, repeat detection and read pair usage. These methods are therefore not necessarily suited to process transcriptome data which does not conform to either of these assumptions.</p>
    <p>More recently, transcriptome assembly pipelines were developed to post-process the output of <italic>de novo</italic> genome assemblers: Velvet and ABySS (<xref ref-type="bibr" rid="B14">Martin <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B19">Robertson <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B23">Surget-Groba and Montoya-Burgos, 2010</xref>). The common idea shared by these pipelines is to run an assembler at different <italic>k</italic>-mer lengths and to merge these assemblies into one. The rationale behind this approach is to merge more sensitive (lower values of <italic>k</italic>) and more specific assemblies (higher values of <italic>k</italic>).</p>
    <p>The pipeline presented by <xref ref-type="bibr" rid="B19">Robertson <italic>et al.</italic> (2010</xref>), transABySS, also handles alternative splicing variants. It detects them by searching for connected groups of contigs such that they are connected in a characteristic bubble and one of the contigs has a length of exactly (2<italic>k</italic>−2). These bubbles are first removed, then added to the final assemblies, to reconstruct alternate variants.</p>
    <p>A variety of algorithmic researchers have used splicing graphs to represent alternative splicing which have a direct relationship to de Bruijn graphs, as pointed out by <xref ref-type="bibr" rid="B8">Heber <italic>et al.</italic> (2002</xref>). This homology between data structures opens the possibility of a <italic>de novo</italic> short read transcriptome assembler, as illustrated by the Trinity algorithm (<xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic>, 2011</xref>). Trinity starts by extending contigs greedily, connecting them into a de Bruijn graph, then extracting sufficiently covered paths through this graph. Trinity is designed to reconstruct highly expressed transcripts to full length using only one <italic>k</italic>-mer length.</p>
    <p>We present Oases, a <italic>de novo</italic> transcriptome assembler that combines these advances. Oases merges the use of multiple <italic>k</italic>-mers presented in (<xref ref-type="bibr" rid="B19">Robertson <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B23">Surget-Groba and Montoya-Burgos, 2010</xref>) with a topological analysis similar to that presented by <xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic> (2011</xref>). It uses dynamic error removal adapted to RNA-seq data and implements a robust method to predict full length transfrags, even in cases where noise perturbs the topology of the graph. Single <italic>k</italic> assemblies are merged to cover genes at different expression levels without redundancy.</p>
    <p>We tested the latest version of Oases (0.2.01) on experimental datasets and found that Oases produces longer assemblies than previous <italic>de novo</italic> RNA-seq assemblers. Oases was compared with a reference-based <italic>ab initio</italic> algorithm, Cufflinks (<xref ref-type="bibr" rid="B24">Trapnell <italic>et al.</italic>, 2010</xref>). The latter approach has a considerable advantage in low expression genes, as it can join otherwise disjoint reads by virtue of their genomic positions, but at high read coverage, Oases' sensitivity approaches that of reference-based <italic>ab initio</italic> algorithms. We also examined the effect of coverage depth, hash length, alternative splicing and assembly merging on the quality of assemblies.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <sec sec-type="intro" id="SEC2.1">
      <title>2.1 Overview</title>
      <p>The Oases assembly process, explained in detail below and illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>, consists of independent assemblies, which vary by one important parameter, the hash (or <italic>k</italic>-mer) length. In each of the assemblies, the reads are used to build a de Bruijn graph, which is then simplified for errors, organized into a scaffold, divided into loci and finally analyzed to extract transcript assemblies or <italic>transfrags</italic>. Once all of the individual <italic>k</italic>-mer assemblies are finished, they are merged into a final assembly.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Schematic overview of the Oases pipeline: (1) Individual reads are sequenced from an RNA sample; (2) Contigs are built from those reads, some of them are labeled as <italic>long</italic> (clear), others <italic>short</italic> (dark); (3) Long contigs, connected by single reads or read-pairs are grouped into connected components called <italic>loci</italic>; (4) Short contigs are attached to the loci; and (5) The loci are transitively reduced. Tranfrags are then extracted from the loci. The loci are divided into four categories: (A) chains, (B) bubbles, (C) forks and (D) complex (i.e. all the loci which did not fit into the previous categories).</p></caption><graphic xlink:href="bts094f1"/></fig></p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Contig assembly</title>
      <p>The Oases pipeline receives as input a preliminary assembly produced by the Velvet assembler (<xref ref-type="bibr" rid="B32">Zerbino and Birney, 2008</xref>) which was designed to produce scaffolds from genomic readsets. Its initial stages, namely hashing and graph construction can be used indifferently on transcriptome data. We only run these stages of Velvet to produce a preliminary fragmented assembly, containing the mapping of the reads onto a set of contigs.</p>
      <p>However, the later stage algorithms, Pebble and Rock Band, which resolve repeats in Velvet, are not used because they rely on assumptions related to genomic sequencing (<xref ref-type="bibr" rid="B33">Zerbino <italic>et al.</italic>, 2009</xref>). Namely, the coverage distribution should be roughly uniform across the genome and the genome should not contain any branching point. These conditions prevent those algorithms from being reliable and efficient on RNA-seq data.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Contig correction</title>
      <p>After reading the contigs produced by Velvet, Oases proceeds to correct them again with a set of dynamic and static filters.</p>
      <p>The first dynamic correction is a slightly modified version of Velvet's error correction algorithm, <italic>TourBus</italic>. TourBus searches through the graph for parallel paths that have the same starting and end node. If their sequences are similar enough, the path with lower coverage is merged into the path with higher coverage, irrespective of their absolute coverage. In this sense, the TourBus algorithm is adapted to RNA-seq data and fluctuating coverage depths. However, for performance issues, the Velvet version of TourBus only visits each node once, meaning that it does not exhaustively compare all possible pairs of paths. Given the high coverage of certain genes, and the complexity of the corresponding graphs, with numerous false positive paths, it is necessary for Oases to exhaustively examine the graph, visiting nodes several times if necessary.</p>
      <p>In addition to this correction, Oases includes a <italic>local edge removal</italic>. For each node, an outgoing edge is removed if its coverage represents &lt;10% of the sum of coverages of outgoing edges from that same node. This approach, similar to the one presented by <xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic> (2011</xref>), is based on the assumption that on high coverage regions, spurious errors are likely to reoccur more often.</p>
      <p>Finally, all contigs with less than a static coverage cutoff (by default 3×) are removed from the assembly. The rationale for this filter is that any transcript with such a low coverage cannot be properly assembled in the first place, so it is expedient to remove them from the assembly, along with many low coverage contigs created by spurious errors.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Scaffold construction</title>
      <p>The distance information between the contigs is then summarized into a set of distance estimates called a <italic>scaffold</italic>, as described in (<xref ref-type="bibr" rid="B33">Zerbino <italic>et al.</italic>, 2009</xref>). Because a read in a de Bruijn graph can be split between several contigs, the distance estimate for a <italic>connection</italic> between two contigs can be supported by both spanning single reads or paired-end reads.</p>
      <p>The total number of spanning reads and pair-end reads confirming a connection is called its <italic>support</italic>. A connection which is supported by at least one spanning read is called <italic>direct</italic>, otherwise, it is <italic>indirect</italic>.</p>
      <p>Connections are assigned a total <italic>weight</italic>. It is calculated by adding 1 for each supporting spanning read and a probabilistic weight for each spanning pair, proportional to the likelihood of observing the paired reads at their observed positions on the contigs given the estimated distance between the contigs and assuming a normal insert length distribution model.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Scaffold filtering</title>
      <p>Much like the contig correction phase, several filters are applied to the scaffold: static coverage thresholds for the very low coverage sequences and a dynamic coverage threshold that adapts to the local coverage depth.</p>
      <p>Because coverage is no longer indicative of the uniqueness of a sequence, contig length is used as an indicator. Based on the decreasing likelihood of high identity conservation as a function of sequence length (<xref ref-type="bibr" rid="B29">Whiteford <italic>et al.</italic>, 2005</xref>), contigs longer than a given threshold [by default (50+k−1) bp] are labeled as <italic>long</italic> and treated as if unique and the other nodes are labeled as <italic>short</italic>.</p>
      <p>Connections with a low support (by default 3× or lower) or with a weight &lt;0.1 are first removed. Two short contigs can only be joined by a direct connection with no intermediate gap. A short and a long contig can only be connected by a direct connection.</p>
      <p>Finally, connections between long contigs are tested against a modified version of the statistic presented in (<xref ref-type="bibr" rid="B33">Zerbino <italic>et al.</italic>, 2009</xref>), which estimates how many read pairs should connect two contigs given their respective coverages and the estimated distance separating them (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>). Indirect connections with a support lower than a given threshold (by default 10% of this expected count) are thus eliminated.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Locus construction</title>
      <p>Oases then organizes the contigs into clusters called <italic>loci</italic>, as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>. This terminology stems from the fact that in the ideal case, where no gap in coverage or overlap with exterior sequences complicate matters, all the transcripts from one gene should be assembled into a connected component of contigs. Unfortunately, in experimental conditions, this equivalence between components and genes cannot be guaranteed. It is to be expected that loci sometimes represent fragments of genes or clusters of homologous sequences.</p>
      <p>Scaffold construction takes place in two stages similarly to the approach described by <xref ref-type="bibr" rid="B3">Butler <italic>et al.</italic> (2008</xref>). Long contigs are first clustered into connected components. These long nodes have a higher likelihood of being unique, therefore it is assumed that two contigs which belong to the same component also belong to the same gene. To each locus are added the short nodes which are connected to one of the long nodes in the cluster.</p>
    </sec>
    <sec id="SEC2.7">
      <title>2.7 Transitive reduction of the loci</title>
      <p>For the following analyses to function properly, it is necessary to remove redundant long distance connections, and retain only connections between immediate neighbors, as seen in <xref ref-type="fig" rid="F1">Figure 1</xref>. For example, it is common that two contigs which are not consecutive in a locus are connected by a paired-end read.</p>
      <p>A connection is considered redundant if it connects two nodes that are connected by a distinct path of connections such that the connection and the two paths have comparable lengths. The transitive reduction implemented in Oases is inspired from the one described in (<xref ref-type="bibr" rid="B16">Myers, 2005</xref>) but had to be adapted to the conditions of short read data. In particular, short contigs can be repeated or even inverted within a single transcript and form loops in the connection graph. Because of this, occasional situations arise where every connection coming out of a node can be transitively reduced by another one, thus removing all of them, and breaking the connectivity of the locus. To avoid this, a limit is imposed on the number of removed connections. If two connections have the capacity to reduce each other, the shortest one is preserved.</p>
    </sec>
    <sec id="SEC2.8">
      <title>2.8 Extracting transcript assemblies</title>
      <p>The sequence information of the transcripts is now contained in the loci. These loci can be fragmented because of alternative splicing events which cause the de Bruijn graph to have a branch. Oases, therefore, analyses the topology of the loci to extract full length isoform assemblies.</p>
      <p>In many cases, the loci present a simple topology which can be trivially and uniquely decomposed as one or two transcripts. We define three categories of <italic>trivial</italic> locus topologies (<xref ref-type="fig" rid="F1">Fig. 1</xref>): chains, forks and bubbles, which if isolated from any other branching point, are straightforward to resolve. These three topologies are easily identifiable using the degrees of the nodes. Oases, therefore, detects all the trivial loci and enumerates the possible transcripts for each of them.</p>
      <p>Because the above exact method only applies to specific cases, an additional robust heuristic method is applied to the remaining loci, referred to as <italic>complex</italic> loci. Oases uses a reimplementation of the algorithm described in (<xref ref-type="bibr" rid="B12">Lee, 2003</xref>), which efficiently produces a parsimonious set of putative highly expressed transcripts, assuming independence of the alternative splicing events.</p>
      <p>This extension of the algorithm is quite intuitive, since there is a direct analogy between the de Bruijn graph built from the transcripts of a gene and its splicing graph, as noted by <xref ref-type="bibr" rid="B8">Heber <italic>et al.</italic> (2002</xref>). Using dynamic programming, it enumerates heavily weighted paths through the locus graph in decreasing order of coverage, until either all the contigs of the locus are covered, or a specified number of transcripts is produced (by default 10).</p>
      <p>As in the transitive reduction phase, this algorithm had to be slightly modified to allow for loops in the putative splicing graph of the locus. Loops are problematic because their presence can prevent the propagation of the dynamic programming algorithm to all the contigs of a locus. When a loop is detected, it is broken at a contig which connects the loop to the rest of the locus, so as to leave a minimum number of branch points, as described in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>.</p>
    </sec>
    <sec id="SEC2.9">
      <title>2.9 Merging assemblies with Oases-M</title>
      <p>De Bruijn graph assemblers are very sensitive to the setting of the hash length <italic>k</italic>. For transcriptome data, this optimization is more complex as transcript expression levels and coverage depths are distributed over a wide range. A way to avoid the dependence on the parameter <italic>k</italic> is to produce a merged transcriptome assembly of previously generated transfrags from Oases.</p>
      <p>Oases is run for a set of [<italic>k</italic><sub>MIN</sub>,…,<italic>k</italic><sub>MAX</sub>] values and the output transfrags are stored. All predicted transfrags from runs in the interval are then fed into the second stage of the pipeline, <italic>Oases-M</italic>, with a user selected <italic>k</italic><sub>MERGE</sub>. A de Bruijn graph for <italic>k</italic><sub>MERGE</sub> is built from these transfrags. After removing small variants with the Tourbus algorithm, any transfrag in the graph that is identical or included in another transfrag is removed. The final assembly is constructed by following the remaining transfrags through the merged graph.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Datasets</title>
      <p>Two datasets were retrieved from the Nucleotide Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/">http://www.ebi.ac.uk/ena/</ext-link>). A human dataset was produced in a study by <xref ref-type="bibr" rid="B7">Heap <italic>et al.</italic> (2010</xref>), where poly(A)-selected RNAs from human primary CD4(+) T cells were sequenced. Paired-end reads of length 45 bp with an insert size of 200 bp from one human individual (studyID SRX011545) were downloaded.</p>
      <p>A mouse dataset was taken from the study of <xref ref-type="bibr" rid="B24">Trapnell <italic>et al.</italic> (2010</xref>). In a timeseries experiment of C2C12 myoblast mouse cells, paired-end reads of length 75 bp with an insert size of 300 bp were sequenced. Read data from the 24 h timepoint (study id SRX017794) was used.</p>
      <p>To reduce the amount of erroneous bases, both paired-end datasets were processed by (i) removing Ns from both ends, (ii) clipping bases with a Sanger quality ≤10 and (iii) removing reads with more than six bases with Sanger quality ≤10 after steps (i) and (ii), leading to a total of 30 940 088 and 64 441 708 reads for human and mouse, respectively.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Assemblies and alignments</title>
      <p>All experiments were run with Oases version 0.2.01, and Velvet 1.1.06 and the coverage cutoff and the minimum support for connections were set to 3.</p>
      <p>TransABySS 1.2.0 was run with ABySS 1.2.5 through the first two stages of transABySS (assembly and merging, before mapping to a reference genome is required). Instead of just running with the default parameters, we tested an array of parameters and chose the best for those datasets, namely <italic>n</italic>=10, <italic>c</italic>=3 and ABYSS with the options -E0 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>).</p>
      <p>Trinity (ver. 2011-08-20) was run with the default parameters. In particular, the <italic>k</italic>-mer length of 25 could not be modified.</p>
      <p>Potential poly-A tails after assembly were removed using the trimEST program from the EMBOSS package (<xref ref-type="bibr" rid="B17">Rice <italic>et al.</italic>, 2000</xref>) before alignment. Subsequently, predicted transfrags of the methods were aligned against the genome using Blat (<xref ref-type="bibr" rid="B11">Kent, 2002</xref>).</p>
      <p>The Cufflinks assemblies are those published by its authors.</p>
      <p>Reads per kilobase of exon model per million mapped reads (RPKM), as defined by <xref ref-type="bibr" rid="B15">Mortazavi <italic>et al.</italic> (2008</xref>) expression values for annotated genes have been computed by aligning reads against annotated Ensembl 57 transcripts with RazerS (<xref ref-type="bibr" rid="B28">Weese <italic>et al.</italic>, 2009</xref>), (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>).</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Metrics</title>
      <p>In all the following experiments, we focused on a simple set of metrics as used in (<xref ref-type="bibr" rid="B19">Robertson, 2010</xref>; <xref ref-type="bibr" rid="B31">Yassour, 2011</xref>): nucleotide sensitivity, nucleotide specificity, percentage of transcripts assembled to 100% of their length and percentage of transcripts assembled to 80% of their length. The Blat mappings of the assemblies were compared with the Ensembl annotations of the corresponding species.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Comparing Oases to Velvet</title>
      <p>To evaluate the added value of the topology resolution within each loci, we compared the Oases contigs from the Velvet assemblies which they are built from. <xref ref-type="table" rid="T1">Table 1</xref> shows how the Oases assemblies significantly improve on the Velvet assemblies. This confirms the intuition that in the presence of alternative splicing and dynamic expression levels, the assembly is broken by breaks in the graph, which can be resolved by topological analysis and adapted error correction as described in the Methods section.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of Velvet and Oases assemblies on the human RNA-seq dataset</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"><italic>k</italic>-mer</th><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Tfrags &gt; 100 bp</th><th rowspan="1" colspan="1">Sens. (%)</th><th rowspan="1" colspan="1">Spec. (%)</th><th rowspan="1" colspan="1">Full Lgth.</th><th rowspan="1" colspan="1">80% lgth.</th></tr></thead><tbody align="left"><tr><td rowspan="2" colspan="1">19</td><td rowspan="1" colspan="1">Velvet</td><td rowspan="1" colspan="1">89 789</td><td rowspan="1" colspan="1">12.45</td><td rowspan="1" colspan="1">83.58</td><td rowspan="1" colspan="1">42</td><td rowspan="1" colspan="1">78</td></tr><tr><td rowspan="1" colspan="1">Oases</td><td rowspan="1" colspan="1">67 319</td><td rowspan="1" colspan="1">17.23</td><td rowspan="1" colspan="1">92.55</td><td rowspan="1" colspan="1">828</td><td rowspan="1" colspan="1">7437</td></tr><tr><td rowspan="2" colspan="1">25</td><td rowspan="1" colspan="1">Velvet</td><td rowspan="1" colspan="1">88 042</td><td rowspan="1" colspan="1">16.13</td><td rowspan="1" colspan="1">89.62</td><td rowspan="1" colspan="1">92</td><td rowspan="1" colspan="1">516</td></tr><tr><td rowspan="1" colspan="1">Oases</td><td rowspan="1" colspan="1">53 504</td><td rowspan="1" colspan="1">14.97</td><td rowspan="1" colspan="1">93.0</td><td rowspan="1" colspan="1">754</td><td rowspan="1" colspan="1">6882</td></tr><tr><td rowspan="2" colspan="1">31</td><td rowspan="1" colspan="1">Velvet</td><td rowspan="1" colspan="1">55 986</td><td rowspan="1" colspan="1">12.78</td><td rowspan="1" colspan="1">93.16</td><td rowspan="1" colspan="1">213</td><td rowspan="1" colspan="1">1986</td></tr><tr><td rowspan="1" colspan="1">Oases</td><td rowspan="1" colspan="1">47 878</td><td rowspan="1" colspan="1">10.55</td><td rowspan="1" colspan="1">94.63</td><td rowspan="1" colspan="1">429</td><td rowspan="1" colspan="1">3751</td></tr><tr><td rowspan="2" colspan="1">35</td><td rowspan="1" colspan="1">Velvet</td><td rowspan="1" colspan="1">36 507</td><td rowspan="1" colspan="1">7.9</td><td rowspan="1" colspan="1">94.81</td><td rowspan="1" colspan="1">107</td><td rowspan="1" colspan="1">1660</td></tr><tr><td rowspan="1" colspan="1">Oases</td><td rowspan="1" colspan="1">34 012</td><td rowspan="1" colspan="1">6.67</td><td rowspan="1" colspan="1">95.99</td><td rowspan="1" colspan="1">196</td><td rowspan="1" colspan="1">1885</td></tr></tbody></table><table-wrap-foot><fn><p>The total number of transfrags longer that 100 bp (Tfrags), nucleotide sensitivity and specificity, as well as the number of full length or 80% length reconstructed Ensembl transcripts are shown.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>As an example, the percentage cutoff for local edge removal was modulated (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Table S1</ext-link>). These results show how dynamic filters improve the quality of the assembly.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Impact of <italic>k</italic>-mer lengths</title>
      <p>One of the major parameters in de Bruijn graph assemblers is the hash length, or <italic>k</italic>-mer length. Comparing single-<italic>k</italic> assemblies performed by Oases, it is possible to observe that this parameter is crucial in RNA-seq assembly. <xref ref-type="fig" rid="F2">Figure 2</xref> shows how the <italic>k</italic>-mer length is closely related to the expression level of the transcripts being assembled. As expected, the assemblies with longer <italic>k</italic>-values perform best on high expression genes, but poorly on low expression genes. However, short <italic>k</italic>-mer assemblies have the disadvantage of introducing misassemblies, as shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Table S7</ext-link>.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Comparison of single k-mer Oases assemblies and the merged assembly from kMIN=19 to kMAX=35 by Oases-M, on the human dataset. The total number of Ensembl transcripts assembled to 80 of their length is provided by RPKM gene expression quantiles of 1464 genes each.</p></caption><graphic xlink:href="bts094f2"/></fig></p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 Impact of merging assemblies</title>
      <p>In addition, <xref ref-type="fig" rid="F2">Figure 2</xref> shows the same statistics for the merged assembly by Oases-M, which is significantly superior to each of the individual values. This result illustrates how the different assemblies do not completely overlap. Further, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Figure S2</ext-link> shows how each single <italic>k</italic>-mer assembly resolved transcripts at different expression levels.</p>
      <p>We compared merging different intervals of <italic>k</italic>-mers (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>). The wider the interval, the better the results. To determine bounds on this interval we arbitrarily bounded on the low values with 19, on the assumption that smaller <italic>k</italic>-mers are very likely to be unspecific for mammalian genomes (<xref ref-type="bibr" rid="B29">Whiteford <italic>et al.</italic>, 2005</xref>). In theory, on the upper end, all the <italic>k</italic>-mer values (up to read length) could be used. To avoid wasting resources, we measured the added value of each new assembly (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>). As expected, marginal gains progressively diminish and this metric could be used to determine how large a spectrum of <italic>k</italic>-mers to use. We also investigated which <italic>k</italic><sub>MERGE</sub> should be used and we found that <italic>k</italic><sub>MERGE</sub>= 27 works well with little difference for higher values (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Table S4</ext-link>) and is therefore used for all analyses in the article.</p>
    </sec>
    <sec id="SEC3.7">
      <title>3.7 Comparing Oases to other RNA-seq <italic>de novo</italic> assemblers</title>
      <p>Oases-M was compared with existing RNA-seq <italic>de novo</italic> assemblers, transABySS (<xref ref-type="bibr" rid="B19">Robertson <italic>et al.</italic>, 2010</xref>) and Trinity (<xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic>, 2011</xref>). The previous human dataset and a mouse dataset were used for the comparison. The datasets have different read lengths and sequencing depth, as detailed in Methods. Both transABySS and Oases were run for <italic>k</italic>-mer length 19–35 bp on the human dataset. Because the mouse reads are longer, these two assemblers were run for <italic>k</italic>-mers 21–35 on that dataset. The highest value of <italic>k</italic> was determined by an approach similar to that used on the human data (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link> for data). Trinity is fixed by implementation at <italic>k</italic>=25 bp.</p>
      <p><xref ref-type="fig" rid="F3">Figure 3</xref> shows the number of reconstructed Ensembl transcripts for each assembler on both datasets separated by expression quantiles. The main observation is that all assemblers do not behave equally with respect to expression level. Trinity appears to perform best on high expression genes, whereas transABySS performs best on low expression genes. Oases performs comparatively well throughout the spectrum of expression levels, hence the greater overall success (<xref ref-type="table" rid="T2">Table 2</xref>).
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Reconstruction efficiency of Ensembl transcripts for different RNA-seq de novo assembly methods (Oases-M, Trinity, and transABySS) on human and mouse datasets. Reference-based assembly results using Cufflinks are provided on the mouse dataset. All annotated genes have been grouped into quantiles by RPKM expression values of 1464 (resp. 1078) genes for the human data (resp. mouse).</p></caption><graphic xlink:href="bts094f3"/></fig>
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Overall comparison of the different RNA-seq assembly methods on human and mouse datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Data</th><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Tfrags &gt; 100 bp</th><th rowspan="1" colspan="1">Sens. (%)</th><th rowspan="1" colspan="1">Spec. (%)</th><th rowspan="1" colspan="1">Full lgth</th><th rowspan="1" colspan="1">80% lgth</th></tr></thead><tbody align="left"><tr><td rowspan="3" colspan="1">Human</td><td rowspan="1" colspan="1">Oases-M</td><td rowspan="1" colspan="1">174 469</td><td rowspan="1" colspan="1">21.44</td><td rowspan="1" colspan="1">92.35</td><td rowspan="1" colspan="1">1463</td><td rowspan="1" colspan="1">11 169</td></tr><tr><td rowspan="1" colspan="1">tABySS</td><td rowspan="1" colspan="1">100 127</td><td rowspan="1" colspan="1">19.65</td><td rowspan="1" colspan="1">92.16</td><td rowspan="1" colspan="1">1358</td><td rowspan="1" colspan="1">10 992</td></tr><tr><td rowspan="1" colspan="1">Trinity</td><td rowspan="1" colspan="1">76 232</td><td rowspan="1" colspan="1">19.99</td><td rowspan="1" colspan="1">88.63</td><td rowspan="1" colspan="1">953</td><td rowspan="1" colspan="1">7129</td></tr><tr><td rowspan="4" colspan="1">Mouse</td><td rowspan="1" colspan="1">Oases-M</td><td rowspan="1" colspan="1">175 914</td><td rowspan="1" colspan="1">30.83</td><td rowspan="1" colspan="1">89.08</td><td rowspan="1" colspan="1">1324</td><td rowspan="1" colspan="1">9880</td></tr><tr><td rowspan="1" colspan="1">tABySS</td><td rowspan="1" colspan="1">174 744</td><td rowspan="1" colspan="1">30.66</td><td rowspan="1" colspan="1">92.79</td><td rowspan="1" colspan="1">1149</td><td rowspan="1" colspan="1">9376</td></tr><tr><td rowspan="1" colspan="1">Trinity</td><td rowspan="1" colspan="1">92 810</td><td rowspan="1" colspan="1">31.57</td><td rowspan="1" colspan="1">87.14</td><td rowspan="1" colspan="1">1085</td><td rowspan="1" colspan="1">7028</td></tr><tr><td rowspan="1" colspan="1">Cufflinks</td><td rowspan="1" colspan="1">63 207</td><td rowspan="1" colspan="1">48.13</td><td rowspan="1" colspan="1">75.29</td><td rowspan="1" colspan="1">4369</td><td rowspan="1" colspan="1">21 222</td></tr></tbody></table><table-wrap-foot><fn><p>The number of transfrags longer than 100 bp produced (Tfrags) and nucleotide sensitivity and specificity, as well as the number of full length or 80% length reconstructed Ensembl transcripts are shown.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>Regarding correctness, we computed the number of misassemblies and the qualities of the different assemblers are comparable (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts094/DC1">Supplementary Material</ext-link>). Transfrags mapped with high confidence to the genome occasionally differ from the known annotation. For example, Oases produced 237 (resp. 390) transfrags longer than 300 bp which mapped to the reference genome, but did not overlap with the human (resp. mouse) annotation.</p>
      <p>In <xref ref-type="fig" rid="F4">Figure 4</xref>, the overlap of full length mouse transcripts reconstructed by the three methods is shown. It is interesting to note that although the results greatly overlap, the different assemblers succeeded in assembling different transcripts.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Venn Diagramm that compares mouse Ensembl transcripts reconstructed to full length by Trinity, Trans-AbySS and Oases-M for the mouse RNA-seq data.</p></caption><graphic xlink:href="bts094f4"/></fig></p>
    </sec>
    <sec id="SEC3.8">
      <title>3.8 Comparing de novo and reference-based assemblers</title>
      <p>Oases and the other <italic>de novo</italic> assemblers were finally compared on the mouse data to a reference-based assembly algorithm, Cufflinks (<xref ref-type="bibr" rid="B24">Trapnell <italic>et al.</italic>, 2010</xref>), on the mouse dataset. As could be expected, Cufflinks generally outperforms the <italic>de novo</italic> assembly algorithms, as it benefits from using the reference genome to anchor its assemblies (<xref ref-type="fig" rid="F3">Fig. 3</xref>). Nonetheless, it is interesting to note that as expression level and therefore coverage depth go up, the gap narrows.</p>
      <p>Beyond assembling more transcripts, it is also important to recover multiple isoforms for each gene. For each assembled transcript, the average number of additionally assembled transcripts from the same gene are, respectively, 1.21, 1.25, 1.01 and 1.56 for Oases, transABySS, Trinity and Cufflinks. Cufflinks performs better in that respect, whereas Trinity is less sensitive.</p>
    </sec>
    <sec id="SEC3.9">
      <title>3.9 Runtime and memory</title>
      <p>A <italic>de novo</italic> transcriptome assembly is a resource intensive task. Velvet uses multithreading but Oases currently does not. The complete merged assembly for human took ~3.2 h and 6.1 GB of peak memory on a 48 core AMD Opteron machine with 265 GB RAM. The merged assembly for mouse took ~10.3 h and 15.1 GB peak memory.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 DISCUSSION</title>
    <p>We have shown that merging different single <italic>k</italic> assemblies is beneficial, in concordance with previous work (<xref ref-type="bibr" rid="B23">Surget-Groba and Montoya-Burgos, 2010</xref>; <xref ref-type="bibr" rid="B19">Robertson <italic>et al.</italic>, 2010</xref>). Oases employs dynamic cutoffs, where possible, to allow for a robust reconstruction with different <italic>k</italic>-values. However, detailed parameter optimization for Oases and trans-ABySS may lead to further improvements.</p>
    <p>Overall, the <italic>de novo</italic> methods produced large numbers of misassemblies. Given the dynamic ranges involved, the exact parameter settings of these programs define a trade-off between sensitivity and accuracy. In these experiments, Oases tends to be more sensitive, Trinity more accurate. The correlation of small <italic>k</italic>-mer assemblies and misassembly rates suggests that homologies between genes are the main source of errors. As reads get longer, and coverage depths greater, sensitivity will only increase and users will probably avoid the shorter <italic>k</italic>-mer lengths for greater accuracy. Short <italic>k</italic>-mers will only be necessary to retrieve the very rare transcripts.</p>
    <p>An independent but significant factor to these assemblies is read preprocessing, as read error removal has already been shown to have a significant impact in the context of <italic>de novo</italic> genome assembly (<xref ref-type="bibr" rid="B21">Smeds and Künster, 2011</xref>).</p>
    <p>Interestingly, the comparison of reconstructed transcripts for the three <italic>de novo</italic> methods in <xref ref-type="fig" rid="F4">Figure 4</xref> reveals that each method outperforms the others on a separate set of transcripts. These differences in performance are probably due to the different strategies employed to remove errors. A more aggressive method, which discards more data, would presumably end up with many gaps on low expression data, whereas a more lenient algorithm would leave too many ambiguities at high coverage.</p>
    <p>In particular, it appears that the performance of all the assemblers sometimes drops at very high coverage depths. This is probably linked to increased noise. Indeed, this drop is especially marked for transABySS, which, to our knowledge, is the only of the three <italic>de novo</italic> assemblers not to integrate dynamic filters which adapt with coverage depth.</p>
    <p>Intriguingly, transABySS outperformed Trinity in our experiments, contrary to the observation of <xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic>, (2011</xref>). This could not be due to the parameterization of Trinity, which cannot be parameterized apart from the insert length. Instead, the larger <italic>k</italic> range used for transABySS and the lower sequencing depth in our analyzed data sets may explain this discrepancy, as transABySS was shown to perform especially well for low to medium expressed genes.</p>
    <p>Similarly, our experiments on mouse data show a bigger gap between Cufflinks and the <italic>de novo</italic> assemblers than observed by <xref ref-type="bibr" rid="B31">Yassour <italic>et al.</italic> (2011</xref>). In their work, the comparison was focused on the set of ‘oracle’ transcripts, which show sufficient coverage of exact <italic>k</italic>-mers in the reads. However, no such restriction was applied here and Cufflinks surpasses the <italic>de novo</italic> methods for low to medium expression ranges, where coverage is sparse.</p>
    <p>In this study, we did not analyze strand-specific RNA-seq datasets. However, as these datasets become more available (<xref ref-type="bibr" rid="B13">Levin, 2010</xref>) Oases already supports this data. During the hashing phase, reverse complement sequences can be stored separately instead of being joined as the two strands of the same sequence.</p>
  </sec>
  <sec id="SEC5">
    <title>5 CONCLUSION</title>
    <p>Oases provides users with a robust pipeline to assemble unmapped RNA-seq reads into full length transcripts. Oases was designed to deal with the conditions of RNA-seq, namely uneven coverage and alternative splicing events.</p>
    <p>Our results show how crucial it is to explore and understand the relevant conditions. Alternative splicing can significantly confound the assembly and has to be specifically addressed. Gene expression levels are a major factor determining the sensitivity of an algorithm. High coverage genes require more selective methods, whereas low coverage genes favor more sensitive algorithms. This is why exploring a range of <italic>k</italic>-mer lengths is key to success.</p>
    <p>In the light of these results, Oases was designed to perform well overall by adapting to these varying conditions and succeeded in obtaining superior overall results compared to previously published RNA-seq <italic>de novo</italic> assemblers. Nonetheless, it also appears that merging assemblies from a diversity of algorithms could be beneficial. This is probably due to the dynamic range of all the variables, which prevent any single method from being systematically superior.</p>
    <p>Finally, we examined the difference between <italic>de novo</italic> and reference-assisted assembly. In the presence of a well-assembled genome (typically human or mouse), the latter methods are generally at a significant advantage. Nonetheless, this gap reduces at high expression levels. This shows that the absence of an assembled genome can be largely compensated for provided sufficient read coverage.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_28_8_1086__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_bts094_supplement.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN1">
      <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
    </fn>
  </fn-group>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>Thank you to Cole Trapnell, Ali Mortazavi and Diane Trout for their help in obtaining the C2C12 dataset. Many thanks to Brian Haas for his patient testing of Oases, and to all the other users for their feedback. Thank you to Saket Navlakha and Benedict Paten for their proofreading and commentaries.</p>
    <p><italic>Funding</italic>: M.H.S. was supported by the International Max Planck Research School for Computational Biology and Scientific Computing. D.R.Z. and E.B. were funded by EMBL central funds. D.R.Z. is also funded by ENCODE grant 1U41HG004568-01, the NHGRI GENCODE subcontract (Prime: 1U54HG004555-01, Subaward: 0244-03) and the NHGRI ENCODE DAC grant (Prime: NHGRI 1U01HG004695-01, Subcontract: European Bioinformatics Institute).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birol</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> transcriptome assembly with ABySS</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2872</fpage>
        <lpage>2877</lpage>
        <pub-id pub-id-type="pmid">19528083</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blencowe</surname>
            <given-names>B.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Current-generation high-throughput sequencing: deepening insights into mammalian transcriptomes</article-title>
        <source>Gene. Dev.</source>
        <year>2009</year>
        <volume>23</volume>
        <fpage>1379</fpage>
        <lpage>1386</lpage>
        <pub-id pub-id-type="pmid">19528315</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ALLPATHS: <italic>de novo</italic> assembly of whole-genome shotgun microreads</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>810</fpage>
        <lpage>820</lpage>
        <pub-id pub-id-type="pmid">18340039</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>L.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An approach to transcriptome analysis of non-model organisms using short-read sequences</article-title>
        <source>Genome Inform.</source>
        <year>2008</year>
        <volume>21</volume>
        <fpage>3</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">19425143</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denoeud</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Annotating genomes with massive-scale RNA sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R175</fpage>
        <pub-id pub-id-type="pmid">19087247</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>Ab initio</italic> reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>503</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heap</surname>
            <given-names>G.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of allelic expression imbalance in human primary cells by high-throughput transcriptome resequencing</article-title>
        <source>Hum. Mol. Genet.</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>122</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="pmid">19825846</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heber</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing graphs and EST assembly problem</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>Suppl. 1</issue>
        <fpage>S181</fpage>
        <lpage>S188</lpage>
        <pub-id pub-id-type="pmid">12169546</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jackson</surname>
            <given-names>B.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Parallel short sequence assembly of transcriptomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>Suppl. 1</issue>
        <fpage>S14</fpage>
        <pub-id pub-id-type="pmid">19208113</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W.H.</given-names>
          </name>
        </person-group>
        <article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1026</fpage>
        <lpage>1032</lpage>
        <pub-id pub-id-type="pmid">19244387</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>BLAT–the BLAST-like alignment tool</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Generating consensus sequences from partial order multiple sequence alignment graphs</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>999</fpage>
        <lpage>1008</lpage>
        <pub-id pub-id-type="pmid">12761063</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin</surname>
            <given-names>J.Z.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive comparative analysis of strand-specific RNA sequencing methods</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>709</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="pmid">20711195</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rnnotator: an automated de novo transcriptome assembly pipeline from stranded RNA-Seq reads</article-title>
        <source>BMC Genomics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>663</fpage>
        <pub-id pub-id-type="pmid">21106091</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title>
        <source>Nat. Methods.</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>E.W.</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl. 2</issue>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rice</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EMBOSS: the European molecular biology open software suite</article-title>
        <source>Trends Genet.</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>276</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="pmid">10827456</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richard</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of alternative isoforms from exon expression levels in RNA-Seq experiments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e112</fpage>
        <pub-id pub-id-type="pmid">20150413</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> assembly and analysis of RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>909</fpage>
        <lpage>912</lpage>
        <pub-id pub-id-type="pmid">20935650</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>J.T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ABySS: a parallel assembler for short read sequence data</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1117</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smeds</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Künster</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>ConDetri – a content dependent read trimmer for illumina data</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e26314</fpage>
        <pub-id pub-id-type="pmid">22039460</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Surget-Groba</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Montoya-Burgos</surname>
            <given-names>J.I.</given-names>
          </name>
        </person-group>
        <article-title>Optimization of <italic>de novo</italic> transcriptome assembly from next-generation sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1432</fpage>
        <lpage>1440</lpage>
        <pub-id pub-id-type="pmid">20693479</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wakaguri</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-malaria/parasites and full-arthropods: databases of full-length cDNAs of parasites and arthropods, update 2009</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D520</fpage>
        <lpage>D525</lpage>
        <pub-id pub-id-type="pmid">18987005</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>E.T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weese</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RazerS–fast read mapping with sensitivity control</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1646</fpage>
        <lpage>1654</lpage>
        <pub-id pub-id-type="pmid">19592482</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whiteford</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An analysis of the feasibility of short read sequencing</article-title>
        <source>Nulceic Acid Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>e171</fpage>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>Ab initio</italic> construction of a eukaryotic transcriptome by massively parallel mRNA sequencing</article-title>
        <source>Proc. Natl Acad. Sci., USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>3264</fpage>
        <lpage>3269</lpage>
        <pub-id pub-id-type="pmid">19208812</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length transcriptome assembly from RNA-Seq data without a reference genome</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>644</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="pmid">21572440</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for <italic>de novo</italic> short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>D.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pebble and rock band: heuristic resolution of repeats and scaffolding in the velvet short-read <italic>de novo</italic> assembler</article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e8407</fpage>
        <pub-id pub-id-type="pmid">20027311</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
