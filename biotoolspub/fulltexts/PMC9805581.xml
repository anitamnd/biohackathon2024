<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805581</article-id>
    <article-id pub-id-type="pmid">36370074</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac730</article-id>
    <article-id pub-id-type="publisher-id">btac730</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SBMLDiagrams: a python package to process and visualize SBML layout and render</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6738-9979</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Jin</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Jessie</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3659-6817</contrib-id>
        <name>
          <surname>Sauro</surname>
          <given-names>Herbert M</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
        <xref rid="btac730-cor1" ref-type="corresp"/>
        <!--hsauro@uw.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac730-cor1">To whom correspondence should be addressed. Email: <email>hsauro@uw.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-12">
      <day>12</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac730</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac730.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The systems biology markup language (SBML) is an extensible standard format for exchanging biochemical models. One of the extensions for SBML is the SBML Layout and Render package. This allows modelers to describe a biochemical model as a pathway diagram. However, up to now, there has been little support to help users easily add and retrieve such information from SBML. In this application note, we describe a new Python package called SBMLDiagrams. This package allows a user to add a layout and render information or retrieve it using a straightforward Python API. The package uses skia-python to support the rendering of the diagrams, allowing export to commons formats such as PNG or PDF.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>SBMLDiagrams is publicly available and licensed under the liberal MIT open-source license. The package is available for all major platforms. The source code has been deposited at GitHub (<monospace>github.com/sys-bio/SBMLDiagrams</monospace>). Users can install the package using the standard pip installation mechanism: <monospace>pip install SBMLDiagrams</monospace>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U24EB028887</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The systems biological markup language (SBML) (<xref rid="btac730-B3" ref-type="bibr">Hucka <italic toggle="yes">et al.</italic>, 2003</xref>) is a markup language to describe biochemical models of biological systems. SBML is used primarily to allow the exchange of models between different software tools. To read and write SBML, users are recommended to use the software library libSBML (<xref rid="btac730-B1" ref-type="bibr">Bornstein <italic toggle="yes">et al.</italic>, 2008</xref>). libSBML allows users to read, write and create SBML documents from a wide range of languages such as C, C++, Java and Python. libSBML also supports extensions such as SBML layout and render (<xref rid="btac730-B2" ref-type="bibr">Deckard <italic toggle="yes">et al.</italic>, 2006</xref>) which allows users to describe biochemical models as pathway diagrams. The layout is used to describe the positions of elements on a canvas while the render extension is used to describe how elements are rendered in graphical form. libSBML, however, can be difficult for new users to learn requiring fairly detailed knowledge of the layout and render object model. See <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>.</p>
    <p>In this application note, we describe a python package called SBMLDiagrams that allows users to easily read, write, create and view layout and render specifications for a biochemical model without requiring an understanding of the underlying object model. The package makes use of python-libSBML, SimpleSBML and skia-python to add and inspect the layout and render part of SBML files as well as render the diagram to a variety of formats such as PNG and PDF. SBMLDiagrams support all specific layout elements.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>SBML Level 3 supports layout and render information. The layout describes the positions and sizes of different graphical objects, including compartments, species and reactions. The render describes the color and shape information. SBMLDiagrams can be used to read, write, create and/or visualize SBML files based on the layout and render information. If an SBML file contains no layout or render information, SBMLDiagrams can be used to add this information.</p>
    <sec>
      <title>2.1 Working with SBML layout and render</title>
      <p>SBMLDiagrams can be used to read and edit the layout and render of an existing SBML model which can be subsequently exported to an updated SBML model. A variety of color formats (as well as opacity) are supported including decimal RGB, HEX string and all the HTML names (<ext-link xlink:href="https://www.w3schools.com/colors/colors_names.asp" ext-link-type="uri">https://www.w3schools.com/colors/colors_names.asp</ext-link>). The following is an example that illustrates some simple operations.</p>
      <p>
        <boxed-text id="btac730-BOX1" position="float">
          <p>
            <monospace>import SBMLDiagrams</monospace>
          </p>
          <p>
            <monospace># load SBML from a file (or string)</monospace>
          </p>
          <p>
            <monospace>df = SBMLDiagrams.load(’mymodel.xml’)</monospace>
          </p>
          <p>
            <monospace>print(df.getNodeSize (“ATP”))</monospace>
          </p>
          <p>
            <monospace>print(df.getReactionFillColor (“ENOLASE”))</monospace>
          </p>
          <p>
            <monospace>df.setNodeTextPosition (“ATP”, [30, 30])</monospace>
          </p>
          <p><monospace>df.setNodeFillColor (“ATP”, “Seagreen”, opacity</monospace> <monospace>=</monospace> <monospace>0.5)</monospace></p>
          <p><monospace>df.setNodeTextFontColor (“ATP”, “#FF6347”, opacity</monospace> <monospace>=</monospace> <monospace>1.)</monospace></p>
          <p>
            <monospace>df.setReactionLineThickness (“ENOLASE”, 3.)</monospace>
          </p>
          <p>
            <monospace>newSbmlStr = df.export()</monospace>
          </p>
        </boxed-text>
      </p>
    </sec>
    <sec>
      <title>2.2 Visualization of SBML networks</title>
      <p>The visualization is based on skia-python (<monospace>pypi.org/project/skia-python/</monospace>). Users can export the SBML networks as PNG, JPG or PDF files. <xref rid="btac730-F1" ref-type="fig">Figure 1A</xref> shows a visualization example of an SBML file from Jana Wolf’s work (<xref rid="btac730-B6" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2001</xref>). The following example illustrates the use of a modeling package such as Tellurium with SBMLDiagrams.</p>
      <fig position="float" id="btac730-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Some visualization examples by SBMLDiagrams. (<bold>A)</bold> Using SBMLDiagrams to visualize a model of glycolysis (<xref rid="btac730-B6" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2001</xref>). Alias nodes are indicated with dashed border lines and boundary nodes have a thicker border width than floating nodes. An animation is also available on GitHub (<ext-link xlink:href="https://github.com/sys-bio/SBMLDiagrams" ext-link-type="uri">https://github.com/sys-bio/SBMLDiagrams</ext-link>). (<bold>B</bold>) Interface to SBGN with a complex species. (<bold>C</bold>) Interface to SBGN with a gradient node</p>
        </caption>
        <graphic xlink:href="btac730f1" position="float"/>
      </fig>
      <boxed-text id="btac730-BOX2" position="float">
        <p>
          <monospace>import SBMLDiagrams, tellurium as te</monospace>
        </p>
        <p>
          <monospace>r = te.loada (’’’</monospace>
        </p>
        <p>
          <monospace>A -&gt; B; v; B -&gt; C; v; C -&gt; D; v;</monospace>
        </p>
        <p><monospace>v</monospace> <monospace>=</monospace> <monospace>0</monospace></p>
        <p>
          <monospace>’’’)</monospace>
        </p>
        <p>
          <monospace>df = SBMLDiagrams.load(r.getSBML())</monospace>
        </p>
        <p>
          <monospace>df.autolayout()</monospace>
        </p>
        <p>
          <monospace>df.draw()</monospace>
        </p>
      </boxed-text>
      <p>For most Python IDEs, <monospace>df.draw()</monospace> will display the network at the console. Users can also save the figure to a file, for instance, <monospace>df.draw(output_fileName = ’fileName.pdf’)</monospace>.</p>
      <p>Autolayout is provided by NetworkX and is useful when an SBML model has no layout information. By use of drawing primitives it is also possible to specify networks that use some aspects from SBGN (<xref rid="btac730-B4" ref-type="bibr">Novère <italic toggle="yes">et al.</italic>, 2009</xref>), see <xref rid="btac730-F1" ref-type="fig">Figure 1B and C</xref>. SBMLDiagrams can also be driven from Tellurium to create simulation animations overlaid onto a diagram.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>SBMLDiagrams is available as a pip package (<monospace>pypi.org/project/SBMLDiagrams/</monospace>) and installed using the standard pip mechanism: <monospace>pip install SBMLDiagrams</monospace>. The package is fully documented as <ext-link xlink:href="https://sys-bio.github.io/SBMLDiagrams/" ext-link-type="uri">https://sys-bio.github.io/SBMLDiagrams/</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac730_Supplementary_Data</label>
      <media xlink:href="btac730_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Frank T. Bergmann for his assistance in using python-libSBML.</p>
    <sec>
      <title>Author contributions</title>
      <p>J.X. was the main developer of the python package. J.J. did the interface to the animation, networkX and color styles. H.M.S was responsible for the conception, funding acquisition, project administration and software testing. J.X and H.M.S. wrote the manuscript. All authors reviewed the manuscript.</p>
    </sec>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Institutes of Health [U24EB028887].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac730-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bornstein</surname><given-names>B.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>LibSBML: an API library for SBML</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>880</fpage>–<lpage>881</lpage>.<pub-id pub-id-type="pmid">18252737</pub-id></mixed-citation>
    </ref>
    <ref id="btac730-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deckard</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>Supporting the SBML layout extension</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>2966</fpage>–<lpage>2967</lpage>.<pub-id pub-id-type="pmid">17038346</pub-id></mixed-citation>
    </ref>
    <ref id="btac730-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hucka</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal>; <collab>SBML Forum</collab>. (<year>2003</year>) <article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title>. <source>Bioinformatics</source>, <volume>19</volume>, <fpage>524</fpage>–<lpage>531</lpage>.<pub-id pub-id-type="pmid">12611808</pub-id></mixed-citation>
    </ref>
    <ref id="btac730-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novère</surname><given-names>N.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>The systems biology graphical notation</article-title>. <source>Nat. Biotechnol</source>., <volume>27</volume>, <fpage>735</fpage>–<lpage>741</lpage>.<pub-id pub-id-type="pmid">19668183</pub-id></mixed-citation>
    </ref>
    <ref id="btac730-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2001</year>) <article-title>Mathematical analysis of a mechanism for autonomous metabolic oscillations in continuous culture of <italic toggle="yes">Saccharomyces cerevisiae</italic></article-title>. <source>FEBS Lett</source>., <volume>499</volume>, <fpage>230</fpage>–<lpage>234</lpage>.<pub-id pub-id-type="pmid">11423122</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
