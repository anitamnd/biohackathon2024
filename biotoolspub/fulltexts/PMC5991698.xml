<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5991698</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-07220</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0198311</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>People and Places</subject>
        <subj-group>
          <subject>Geographical Locations</subject>
          <subj-group>
            <subject>Antarctica</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Marine Mammals</subject>
                      <subj-group>
                        <subject>Seals</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Marine Biology</subject>
          <subj-group>
            <subject>Marine Mammals</subject>
            <subj-group>
              <subject>Seals</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Marine and Aquatic Sciences</subject>
          <subj-group>
            <subject>Marine Biology</subject>
            <subj-group>
              <subject>Marine Mammals</subject>
              <subj-group>
                <subject>Seals</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Invertebrates</subject>
                <subj-group>
                  <subject>Arthropoda</subject>
                  <subj-group>
                    <subject>Insects</subject>
                    <subj-group>
                      <subject>Hymenoptera</subject>
                      <subj-group>
                        <subject>Bees</subject>
                        <subj-group>
                          <subject>Bumblebees</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Visualization</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Chromatographic Techniques</subject>
          <subj-group>
            <subject>Gas Chromatography-Mass Spectrometry</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Analytical Chemistry</subject>
            <subj-group>
              <subject>Mass Spectrometry</subject>
              <subj-group>
                <subject>Gas Chromatography-Mass Spectrometry</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Mass Spectrometry</subject>
            <subj-group>
              <subject>Gas Chromatography-Mass Spectrometry</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GCalignR: An R package for aligning gas-chromatography data for ecological and evolutionary studies</article-title>
      <alt-title alt-title-type="running-head">GCalignR aligning GC data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3112-6928</contrib-id>
        <name>
          <surname>Ottensmann</surname>
          <given-names>Meinolf</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Stoffel</surname>
          <given-names>Martin A.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nichols</surname>
          <given-names>Hazel J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoffman</surname>
          <given-names>Joseph I.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Animal Behaviour, Bielefeld University, Bielefeld, Germany</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>School of Natural Sciences and Psychology, Faculty of Science, Liverpool John Moores University, Liverpool, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Leal</surname>
          <given-names>Walter S.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of California-Davis, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>meinolf.ottensmann@web.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <volume>13</volume>
    <issue>6</issue>
    <elocation-id>e0198311</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 Ottensmann et al</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>Ottensmann et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0198311.pdf"/>
    <abstract>
      <p>Chemical cues are arguably the most fundamental means of animal communication and play an important role in mate choice and kin recognition. Consequently, there is growing interest in the use of gas chromatography (GC) to investigate the chemical basis of eco-evolutionary interactions. Both GC-MS (mass spectrometry) and FID (flame ionization detection) are commonly used to characterise the chemical composition of biological samples such as skin swabs. The resulting chromatograms comprise peaks that are separated according to their retention times and which represent different substances. Across chromatograms of different samples, homologous substances are expected to elute at similar retention times. However, random and often unavoidable experimental variation introduces noise, making the alignment of homologous peaks challenging, particularly with GC-FID data where mass spectral data are lacking. Here we present <monospace>GCalignR</monospace>, a user-friendly R package for aligning GC-FID data based on retention times. The package was developed specifically for ecological and evolutionary studies that seek to investigate similarity patterns across multiple and often highly variable biological samples, for example representing different sexes, age classes or reproductive stages. The package also implements dynamic visualisations to facilitate inspection and fine-tuning of the resulting alignments and can be integrated within a broader workflow in R to facilitate downstream multivariate analyses. We demonstrate an example workflow using empirical data from Antarctic fur seals and explore the impact of user-defined parameter values by calculating alignment error rates for multiple datasets. The resulting alignments had low error rates for most of the explored parameter space and we could also show that <monospace>GCalignR</monospace> performed equally well or better than other available software. We hope that <monospace>GCalignR</monospace> will help to simplify the processing of chemical datasets and improve the standardization and reproducibility of chemical analyses in studies of animal chemical communication and related fields.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HO 5122/3-1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hoffman</surname>
            <given-names>Joseph I.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was supported by a Deutsche Forschungsgemeinschaft (DFG) standard Grant (HO 5122/3-1) together with a dual PhD studentship from Liverpool John Moores University. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="1"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Chemical cues are arguably the most common mode of communication among animals [<xref rid="pone.0198311.ref001" ref-type="bibr">1</xref>]. In the fields of animal ecology and evolution, increasing numbers of studies have therefore been using approaches like gas chromatography (GC) to characterise the chemical composition of body odours and scent marks. These studies have shown that a variety of cues are chemically encoded, including phylogenetic relatedness [<xref rid="pone.0198311.ref002" ref-type="bibr">2</xref>], breeding status [<xref rid="pone.0198311.ref003" ref-type="bibr">3</xref>], kinship [<xref rid="pone.0198311.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>] and genetic quality [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>–<xref rid="pone.0198311.ref008" ref-type="bibr">8</xref>].</p>
    <p>GC vaporises a chemical sample and retards its components differentially based on their chemical properties while passing a gas through a column. The chemical composition of the sample can then be resolved using a number of approaches such as GC coupled to a flame ionization detector (GC-FID) or GC coupled to a mass spectrometer (GC-MS). GC-FID produces a chromatogram in which each substance is represented by a peak, the area of which is proportional to the concentration of that substance in the sample [<xref rid="pone.0198311.ref009" ref-type="bibr">9</xref>]. Although GC-FID is a relatively inexpensive and high-throughput approach, the substances themselves can only be characterised according to their retention times, so their chemical composition remains effectively unknown. GC-MS similarly generates a chromatogram, but additionally provides spectral profiles corresponding to each peak, thereby allowing putative identification by comparison to databases of known substances. Both approaches have distinct advantages and disadvantages, but the low cost of GC-FID, coupled with the fact that most chemicals in non-model organisms do not reveal matches to databases containing known chemicals, has led to an increasing uptake of GC-FID in studies of wild populations [<xref rid="pone.0198311.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0198311.ref013" ref-type="bibr">13</xref>]. GC-FID is particularly appropriate for studies seeking to characterise broad patterns of chemical similarity without reference to the exact nature of the chemicals involved.</p>
    <p>As a prerequisite for any downstream analysis, homologous substances across samples need to be matched. Therefore, an important step in the processing of the chemical data is to construct a so called peak list, a matrix containing the relative abundances of each homologous substance across all of the samples. With GC-MS, homologous substances can be identified on the basis of both their retention times and the accompanying spectral information. However, with GC-FID, homologous substances can only be identified based on their retention times. This can be challenging because these retention times are often perturbed by subtle, random and often unavoidable experimental variation including changes in ambient temperature, flow rate of the carrier gas and column ageing [<xref rid="pone.0198311.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0198311.ref015" ref-type="bibr">15</xref>].</p>
    <p>Numerous algorithms have been developed for aligning MS data (reviewed by [<xref rid="pone.0198311.ref016" ref-type="bibr">16</xref>] and [<xref rid="pone.0198311.ref017" ref-type="bibr">17</xref>]). To provide an overview of breadth of currently available software that provide implementations of these algorithms for users, we conducted a literature search. First, we screened the review papers described above and selected all peer-reviewed manuscripts reporting programs that are publicly available. We excluded publications reporting algorithms that are not implemented in software, that are described as ‘available on request’ from the authors, or which could only be accessed via expired web links. Furthermore, we conducted Web of Science searches in October 2017 using the search terms ‘retention time align*’, ‘peak align*’ and ‘peak match*’ and used the same search terms to interrogate the list of packages deposited on CRAN and Bioconductor. We recovered a total of 25 programs, which we characterised according to a number of relevant criteria, ranging from the type of data for which they were designed through the programming environment to the dimensions that are used for aligning peaks (<xref ref-type="supplementary-material" rid="pone.0198311.s001">S1 File</xref>). We found that the majority (92%) of these programs were developed specifically for aligning MS data. Among these, a large proportion (87%) make use of spectral information either by binning the data according to mass-over-charge values or by directly taking mass information into consideration for the alignment method. Consequently, these programs will not support GC-FID data due to the lack of spectral information, which is a required part of the input.</p>
    <p>Only three of the programs described in <xref ref-type="supplementary-material" rid="pone.0198311.s001">S1 File</xref> claim to support a peak list format lacking MS data, thereby making them potentially suitable for aligning GC-FID data. However, two of these programs (amsrpm [<xref rid="pone.0198311.ref018" ref-type="bibr">18</xref>] and <monospace>ptw</monospace> [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>]) may not be well suited to GC-FID data for two main reasons. First, they conduct alignments strictly pairwise with respect to a pre-defined reference sample, because in general the focus is on a relatively small pool of substances that are expected to be present in most if not all samples [<xref rid="pone.0198311.ref020" ref-type="bibr">20</xref>]. However, applied to wild animal populations, GC-FID often yields high diversity datasets in which only a small subset of chemicals may be common to all individuals [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0198311.ref021" ref-type="bibr">21</xref>]. Second, these algorithms are known to be sensitive to variation in peak intensity, which is expected in GC-FID datasets and may contain important biological information [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0198311.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0198311.ref023" ref-type="bibr">23</xref>].</p>
    <p>To tackle the above issues, a third program called <monospace>GCALIGNER</monospace> was recently written in Java for aligning GC-FID data [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. This program appears to perform well based on three test datasets, each corresponding to a different bumblebee species (<monospace>Bombus</monospace> spp.). However, the underlying algorithm compares each peak with the following peak in the same sample and therefore cannot align the last peak [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. Moreover, with the increasing popularity of open source environments such as R, there is a growing need for software that can be easily integrated into broader workflows, where the source code can be modified and potentially further extended by the user, and where related tools like rmarkdown [<xref rid="pone.0198311.ref025" ref-type="bibr">25</xref>] can be applied to maximise transparency and reproducibility [<xref rid="pone.0198311.ref026" ref-type="bibr">26</xref>]. Furthermore, especially for GC-FID data where spectral data are not available, a useful addition would be to integrate dynamic visualisation tools into software to facilitate the evaluation and subsequent fine-tuning of alignment parameters. However, the vast majority of currently available software (80%) lack such tools (<xref ref-type="supplementary-material" rid="pone.0198311.s001">S1 File</xref>).</p>
    <p>In order to determine which alignment tools are commonly used in the fields of ecology and evolution, we conducted a bibliographic survey, focusing on the journals ‘Animal Behaviour’ and ‘Proceedings of the Royal Society B’, which recovered a total of 38 studies using GC-FID or GC-MS to investigate scent profiles (see <xref ref-type="supplementary-material" rid="pone.0198311.s002">S2 File</xref> for details). None of these studies used any form of alignment tool but rather aligned and called the peaks manually (e.g. [<xref rid="pone.0198311.ref027" ref-type="bibr">27</xref>]), a time-consuming process that can be prone to bias [<xref rid="pone.0198311.ref028" ref-type="bibr">28</xref>] and detrimental to reproducibility.</p>
    <p>To address the above issues, we developed <monospace>GCalignR</monospace>, an R package for aligning GC-FID data, but which can also align data generated using other detectors that allow to characterise peaks by retention times. The package implements a fast and objective method to cluster putatively homologous substances prior to multivariate statistical analyses. Using sophisticated visualisations, the resulting alignments can then be fine tuned. Finally, the package provides a seamless transition from the processing of the peak data through to downstream analysis within other widely used R packages for multivariate analysis, such as vegan [<xref rid="pone.0198311.ref029" ref-type="bibr">29</xref>].</p>
    <p>In this paper, we present <monospace>GCalignR</monospace> and describe the underlying algorithms and their implementation within a suite of R functions. We provide an example workflow using a previously published chemical dataset of Antarctic fur seals (<italic>Arctocephalus gazella</italic>) that shows a clear distinction between animals from two separate breeding colonies [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>]. We then compare the performance of <monospace>GCalignR</monospace> with <monospace>GCALIGNER</monospace> based on the same three bumblebee datasets given in [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>] and explore the sensitivity of <monospace>GCalignR</monospace> to user-defined alignment parameter values. Finally, we compared our alignment procedure with a very different approach –parametric time warping– which is commonly used in the fields of proteomics and metabolomics [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>, <xref rid="pone.0198311.ref030" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Material and methods</title>
    <sec id="sec003">
      <title>Overview of the package</title>
      <p><xref ref-type="fig" rid="pone.0198311.g001">Fig 1</xref> shows an overview of <monospace>GCalignR</monospace> in the context of a workflow for analysing GC-FID data within R. A number of steps are successively implemented, from checking the raw data through aligning peak lists and inspecting the resulting alignments to normalising the peak intensity measures prior to export into vegan [<xref rid="pone.0198311.ref029" ref-type="bibr">29</xref>]. In brief, the alignment procedure is implemented in three consecutive steps that start by accounting for systematic shifts in retention times among samples and subsequently align individual peaks based on variation in retention times across the whole dataset. For simplicity, this procedure is embedded within a single function <monospace>align_chromatograms</monospace> that allows the customisation of peak alignments by adjusting a combination of three parameters. The package vignettes provide a detailed description of all of the functions and their arguments and can be accessed via <monospace>browseVignettes(‘GCalignR’)</monospace> after the package has been installed.</p>
      <fig id="pone.0198311.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of the <monospace>GCalignR</monospace> workflow.</title>
          <p>The steps listed in the main text are numbered from one to five and the filled boxes represent functions of the package (see main text for details).</p>
        </caption>
        <graphic xlink:href="pone.0198311.g001"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Raw data format and conversion to working format</title>
      <p>GC-FID produces raw data in the form of individual chromatograms that show the measured electric current over the time course of a separation run. Proprietary software provided by the manufacturers of GC-FID machines (e.g. ‘LabSolutions’, Shimadzu; ‘Xcalibur’, Thermo Fisher and ‘ChemStation’, Agilent Technologies) are then used to integrate and export peaks in the format of a table containing retention times and intensity values (e.g. peak area and height). <xref ref-type="fig" rid="pone.0198311.g002">Fig 2A</xref> shows chromatograms of three hypothetical samples where peaks have been integrated and annotated with retention times and peak heights. The corresponding input format comprising a table of retention times and peak heights is also shown. The working format of <monospace>GCalignR</monospace> is a retention time matrix in which each sample corresponds to a column and each peak corresponds to a row (see <xref ref-type="fig" rid="pone.0198311.g002">Fig 2B</xref>).</p>
      <fig id="pone.0198311.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>GC-FID data formats.</title>
          <p><bold>A.</bold> Three hypothetical chromatograms are shown corresponding to samples A, B and C. Integrated peaks (filled areas) are annotated with retention times and peak heights. <bold>B.</bold> Using proprietary software (see main text), retention times and quantification measures like the peak height can be extracted and written to a peak list that contains sample identifiers (’Sample_A’, ‘Sample_B’ and ‘Sample_C’), variable names (’retention_time’ and ‘peak_height’) and respective values. Computations described in this manuscript use a retention matrix as the working format.</p>
        </caption>
        <graphic xlink:href="pone.0198311.g002"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Overview of the alignment algorithm</title>
      <p>We developed an alignment procedure based on dynamic programming [<xref rid="pone.0198311.ref031" ref-type="bibr">31</xref>] that involves three sequential steps to align and finally match peaks belonging to putatively homologous substances across samples (see <xref ref-type="fig" rid="pone.0198311.g003">Fig 3</xref> for a flowchart and <xref ref-type="fig" rid="pone.0198311.g004">Fig 4</xref> for a more detailed schematic representation). All of the raw code for implementing these steps is available via GitHub and CRAN and each step is described in detail below. The first step is to align each sample to a reference sample while maximising overall similarity through linear shifts of retention times. This procedure is often described in the literature as ‘full alignment’ [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>]. In the second step, individual peaks are sorted into rows based on close similarity of their retention times, a procedure that is often referred to as ‘partial alignment’ [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>]. Finally, there is still a chance that homologous peaks can be sorted into different, but adjacent, rows in different samples, depending on the variability of their retention times (for empirical examples, see <xref ref-type="supplementary-material" rid="pone.0198311.s003">S3 File</xref>). Consequently, a third step merges rows representing putatively homologous substances.</p>
      <fig id="pone.0198311.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>A flow chart showing the three sequential steps of the alignment algorithm of the peak alignment method.</title>
        </caption>
        <graphic xlink:href="pone.0198311.g003"/>
      </fig>
      <fig id="pone.0198311.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Overview of the three-step alignment algorithm implemented in <monospace>GCalignR</monospace> using a hypothetical dataset.</title>
          <p><bold>A.</bold> Linear shifts are implemented to account for systematic drifts in retention times between each sample and the reference (Sample_A). In this hypothetical example, all of the peaks within Sample_B are shifted towards smaller retention times, while the peaks within Sample_C are shifted towards larger retention times. <bold>B</bold> and <bold>C</bold> work on retention time matrices, in which rows correspond to putative substances and columns correspond to samples. For illustrative purposes, each cell is colour coded to refer to the putative identity of each substance in the final alignment. <bold>B.</bold> Consecutive manipulations of the matrices are shown in clockwise order. Here, black rectangles indicate conflicts that are solved by manipulations of the matrices. Zeros indicate absence of peaks and are therefore not considered in computations. Peaks are aligned row by row according to a user-defined criterion, <italic>a</italic> (see main text for details). <bold>C.</bold> Rows of similar mean retention time are subsequently merged according to the user-defined criterion, <italic>b</italic> (see main text for details).</p>
        </caption>
        <graphic xlink:href="pone.0198311.g004"/>
      </fig>
      <sec id="sec006">
        <title>Full alignment of peaks lists</title>
        <p>The first step in the alignment procedure consists of an algorithm that corrects systematic linear shifts between peaks of a query sample and a fixed reference to account for systematic shifts in retention times among samples (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4A</xref>). Following the approach of Daszykowski <monospace>et al.</monospace> [<xref rid="pone.0198311.ref032" ref-type="bibr">32</xref>], the sample that is most similar on average to the other samples can be automatically selected as a reference by choosing the sample with the lowest median deviation score weighted by the number of peaks to avoid a bias towards samples with few peaks:
<disp-formula id="pone.0198311.e001"><alternatives><graphic xlink:href="pone.0198311.e001.jpg" id="pone.0198311.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mtext>Ref</mml:mtext><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mtext>Query</mml:mtext><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where n is the number of retention times in the reference sample. Alternatively, the reference can be specified by the user. Using a simple warping method [<xref rid="pone.0198311.ref033" ref-type="bibr">33</xref>], the complete peak list of the query is then linearly shifted within an user-defined retention time window with an interval of 0.01 minutes. For all of the shifts, the summed deviation in retention times between each reference peak and the nearest peak in the query is used to approximate similarity as follows:
<disp-formula id="pone.0198311.e002"><alternatives><graphic xlink:href="pone.0198311.e002.jpg" id="pone.0198311.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mtext>Ref</mml:mtext><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mtext>Query</mml:mtext><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where n is the number of retention times in the reference sample. With increasing similarity, this score will converge towards zero the more homologous peaks are aligned, whereas peaks that are unique to either the query or the reference are expected to behave independently and will therefore have little effect on the overall score. The shift yielding to the smallest score is selected to transform retention times for the subsequent steps in the alignment (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4B and 4C</xref>). As the effectiveness of this approach relies on a sufficient number of homologous peaks that can be used to detect linear drift, the performance of the algorithm may vary between datasets.</p>
      </sec>
      <sec id="sec007">
        <title>Partial alignment of peaks</title>
        <p>The second step in the alignment procedure aligns individual peaks across samples by comparing the peak retention times of each sample consecutively with the mean of all previous samples (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4B</xref>) within the same row. If the focal cell within the matrix contains a retention time that is larger than the mean retention time of all previous cells within the same row plus a user-defined threshold (<xref ref-type="disp-formula" rid="pone.0198311.e003">Eq (3)</xref>), that cell is moved to the next row.
<disp-formula id="pone.0198311.e003"><alternatives><graphic xlink:href="pone.0198311.e003.jpg" id="pone.0198311.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>rt</mml:mtext><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mtext>rt</mml:mtext><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where rt is the retention time; m is the focal cell and a is the user-defined threshold deviation from the mean retention time. If the focal cell contains a retention time that is smaller than the mean retention time of all previous cells within the same row minus a user-defined threshold (<xref ref-type="disp-formula" rid="pone.0198311.e004">Eq (4)</xref>), all previous retention times are then moved to the next row.
<disp-formula id="pone.0198311.e004"><alternatives><graphic xlink:href="pone.0198311.e004.jpg" id="pone.0198311.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>rt</mml:mtext><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mtext>rt</mml:mtext><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>After the last retention time of a row has been evaluated, this procedure is repeated for the next row until the end of the retention time matrix is reached (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4B</xref>).</p>
      </sec>
      <sec id="sec008">
        <title>Merging rows</title>
        <p>The third step in the alignment procedure accounts for the fact that a number of homologous peaks will be sorted into multiple rows that can be subsequently merged (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4C</xref>). However, this results in a clear pattern whereby some of the samples will have a retention time in one of the rows while the other samples will have a retention time in an adjacent row (see <xref ref-type="supplementary-material" rid="pone.0198311.s003">S3 File</xref>). Consequently, pairs of rows can be merged when this does not cause any loss of information, an assumption that is true as long as no sample exists that contains peaks in both rows, (<xref ref-type="fig" rid="pone.0198311.g004">Fig 4C</xref>). The user can define a threshold value in minutes (i.e. parameter <monospace>b</monospace> in <xref ref-type="fig" rid="pone.0198311.g004">Fig 4C</xref>) that determines whether or not two such adjacent rows are merged. While the described pattern is unlikely to occur in large datasets purely by chance for non-homologous peaks, small datasets may require more strict threshold values to be selected.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec009">
    <title>Implementation of the alignment method</title>
    <p>The alignment algorithms that are described above are all executed by the core function <monospace>align_chromatograms</monospace> based on the user-defined parameters shown in <xref ref-type="table" rid="pone.0198311.t001">Table 1</xref>. Of these, parameters (<monospace>max_linear_shift</monospace>, <monospace>max_diff_peak2mean</monospace> and <monospace>min_diff_peak2peak</monospace>) can be adjusted by the user to fine-tune the alignment procedure. There a several additional parameters that allow for optional processing and filtering of the data independently of the alignment procedure. For further details, the reader is referred to the accompanying vignettes (see <xref ref-type="supplementary-material" rid="pone.0198311.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0198311.s005">S5</xref> Files) and helpfiles of the R package.</p>
    <table-wrap id="pone.0198311.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0198311.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Mandatory arguments of the function <monospace>align_chromatograms</monospace>.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0198311.t001g" xlink:href="pone.0198311.t001"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Parameter</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">data</td>
              <td align="left" rowspan="1" colspan="1">Path to a tab-delimited text file containing the chemical data. See the vignettes for examples including alternative input formats</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">max_diff_peak2mean</td>
              <td align="left" rowspan="1" colspan="1">Numeric value defining the allowed deviation of the retention time of a focal peak from the mean of the corresponding row during partial peak alignment (see Eqs <xref ref-type="disp-formula" rid="pone.0198311.e003">3</xref> and <xref ref-type="disp-formula" rid="pone.0198311.e004">4</xref>).</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">max_linear_shift</td>
              <td align="left" rowspan="1" colspan="1">Numeric value defining the range that is considered for the adjustment of linear shifts in peak retention times across samples</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">min_diff_peak2peak</td>
              <td align="left" rowspan="1" colspan="1">Numeric value defining the expected minimum difference in retention times across substances. Rows that are more similar than the threshold value will be merged as long as no conflict emerges due to the presence of peaks in more than one row within a single sample.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">rt_col_name</td>
              <td align="left" rowspan="1" colspan="1">Name of the variable containing peak retention times. The name needs to correspond to a variable included in the input file</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">reference</td>
              <td align="left" rowspan="1" colspan="1">Name of the sample that will be used as reference to adjust linear shifts in peak retention times across samples. By default, a reference is automatically selected (see <xref ref-type="sec" rid="sec002">Material and methods</xref>).</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">sep</td>
              <td align="left" rowspan="1" colspan="1">Field separator character. By default, a tab-delimited text file is expected. Within R, type <monospace>?read.table</monospace> for a list of supported separators</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
  </sec>
  <sec id="sec010">
    <title>Demonstration of the workflow</title>
    <p>Here, we demonstrate a typical workflow in <monospace>GCalignR</monospace> using chemical data from skin swabs of 41 Antarctic fur seal (<italic>Arctocephalus gazella</italic>) mother-pup offspring pairs from two neighbouring breeding colonies at South Georgia in the South Atlantic. Sample collection and processing are described in detail in Stoffel <monospace>et al.</monospace> [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>]. In brief, chemical samples were obtained by rubbing the cheek, underneath the eye, and behind the snout with a sterile cotton wool swab and preserved in ethanol stored prior to analysis. In order to account for possible contamination, two blank samples (cotton wool with ethanol) were processed and analysed using the same methodology. Peaks were integrated using ‘Xcalibur’ (Thermo Scientific). The chemical data associated with these samples are provided in the file <monospace>peak_data.txt</monospace>, which is distributed together with <monospace>GCalignR</monospace>. Additional data on colony membership and age-class are provided in the data frame <monospace>peak_factors.RData</monospace>.</p>
    <p>Prior to peak alignment, the <monospace>check_input</monospace> function interrogates the input file for typical formatting errors and missing data. We encourage the use of unique names for samples consisting only of letters, numbers and underscores. If the data fail to pass this quality test, indicative warnings will be returned to assist the user in error correction. As this function is executed internally prior to alignment, the data need to pass this check before the alignment can begin.</p>
    <p specific-use="line"># load GCalignR</p>
    <p specific-use="line"><bold>library</bold> (GCalignR)</p>
    <p specific-use="line"># set the path to the input data</p>
    <p specific-use="line">fpath &lt;- <bold>system.file</bold>(<bold>dir</bold> = “extdata”,</p>
    <p specific-use="line">        <bold>file</bold> = “peak_data.txt”,</p>
    <p specific-use="line">        <bold>package</bold> = “GCalignR”)</p>
    <p specific-use="line"># check for formatting problems</p>
    <p specific-use="line"><bold>check</bold>_input(fpath)</p>
    <p>In order to begin the alignment procedure, the following code needs to be executed:</p>
    <p specific-use="line">aligned_peak_<bold>data</bold> &lt;- align_chromatograms(<bold>data</bold> = peak_<bold>data</bold>,</p>
    <p specific-use="line">   <bold>rt_col</bold>_name = “time”,</p>
    <p specific-use="line">   <bold>max_diff</bold>_peak2mean = 0.02,</p>
    <p specific-use="line">   <bold>min_diff</bold>_peak2peak = 0.08,</p>
    <p specific-use="line">   <bold>max</bold>_linear_shift = 0.05,</p>
    <p specific-use="line">   <bold>delete_single</bold>_peak = TRUE,</p>
    <p specific-use="line">   blanks = <bold>c</bold>(“C2”, “C3”))</p>
    <p>Here, we set <monospace>max_linear_shift</monospace> to 0.05, <monospace>max_diff_peak2mean</monospace> to 0.02 and <monospace>min_diff_peak2peak</monospace> to 0.08. By defining the argument <monospace>blanks</monospace>, we implemented the removal of all substances that are shared with the negative control samples from the aligned dataset. Furthermore, substances that are only present in a single sample were deleted from the dataset using the argument <monospace>delete_single_peak = TRUE</monospace> as these are not informative in analysing similarity pattern [<xref rid="pone.0198311.ref034" ref-type="bibr">34</xref>]. Afterwards, a summary of the alignment process can be retrieved using the printing method, which summarises the function call including defaults that were not altered by the user. This provides all of the relevant information to retrace every step of the alignment procedure.</p>
    <p specific-use="line"># verbal summary of the alignment</p>
    <p specific-use="line"><bold>print</bold>(aligned_peak_<bold>data</bold>)</p>
    <p>As alignment quality may vary with the parameter values selected by the user, the plot function can be used to output four diagnostic plots. These allow the user to explore how the parameter values affect the resulting alignment and can help to flag issues with the raw data.</p>
    <p specific-use="line">
      <italic># produces</italic>
      <xref ref-type="fig" rid="pone.0198311.g005">Fig 5</xref>
    </p>
    <p specific-use="line"><bold>plot</bold> (aligned_peak_<bold>data</bold>)</p>
    <fig id="pone.0198311.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Diagnostic plots summarising the alignment of the Antarctic fur seal chemical dataset.</title>
        <p><bold>A</bold> shows the number of peaks both prior to and after alignment; <bold>B</bold> shows a histogram of linear shifts across all samples; <bold>C</bold> shows the variation across samples in peak retention times; and <bold>D</bold> shows a frequency distribution of substances shared across samples.</p>
      </caption>
      <graphic xlink:href="pone.0198311.g005"/>
    </fig>
    <p>The resulting output for the Antarctic fur seal chemical dataset, shown in <xref ref-type="fig" rid="pone.0198311.g005">Fig 5</xref>, reveals a number of pertinent patterns. Notably, the removal of substances shared with the negative controls or present in only one sample resulted in a substantial reduction in the total number of peaks present in each sample (<xref ref-type="fig" rid="pone.0198311.g005">Fig 5A</xref>). Furthermore, for the majority of the samples, either no linear shifts were required, or the implemented transformations were very small compared to the allowable range (<xref ref-type="fig" rid="pone.0198311.g005">Fig 5B</xref>). Additionally, the retention times of putatively homologous peaks in the aligned dataset were left-skewed, indicating that the majority of substances vary by less than 0.05 minutes (<xref ref-type="fig" rid="pone.0198311.g005">Fig 5C</xref>) but there was appreciable variation in the number of individuals in which a given substance was found (<xref ref-type="fig" rid="pone.0198311.g005">Fig 5D</xref>).</p>
    <p>Additionally, the aligned data can be visualised using a heat map with the function <monospace>gc_heatmap</monospace>. Heat maps allow the user to inspect the distribution of aligned substances across samples and assist in fine-tuning of alignment parameters as described within the vignettes (see <xref ref-type="supplementary-material" rid="pone.0198311.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0198311.s005">S5</xref> Files).</p>
    <p specific-use="line"><bold>gc</bold>_heatmap(aligned_peak_<bold>data</bold>)</p>
    <sec id="sec011">
      <title>Peak normalisation and downstream analyses</title>
      <p>In order to account for differences in sample concentration, peak normalisation is commonly implemented as a pre-processing step in the analysis of olfactory profiles [<xref rid="pone.0198311.ref035" ref-type="bibr">35</xref>–<xref rid="pone.0198311.ref037" ref-type="bibr">37</xref>]. The <monospace>GCalignR</monospace> function <monospace>normalise_peaks</monospace> can therefore be used to normalise peak abundances by calculating the relative concentration of each substance in a sample. The abundance measure (e.g. peak area) needs to be specified as <monospace>conc_col_name</monospace> in the function call. By default, the output is returned in the format of a data frame that is ready to be used in downstream analyses.</p>
      <p specific-use="line"># extract normalised peak area values</p>
      <p specific-use="line">scent &lt;- norm_peaks (<bold>data</bold> = aligned_peak_<bold>data</bold>,</p>
      <p specific-use="line">         <bold>rt_col</bold>_name = “time”,</p>
      <p specific-use="line">         conc_<bold>col</bold>_name = “area”,</p>
      <p specific-use="line">         out = “data.frame”)</p>
      <p>The output of <monospace>GCalignR</monospace> is compatible with other functionalities in R, thereby providing a seamless transition between packages. For example, downstream multivariate analyses can be conducted within the package vegan [<xref rid="pone.0198311.ref029" ref-type="bibr">29</xref>]. To visualise patterns of chemical similarity within the Antarctic fur seal dataset in relation to breeding colony membership, we used non-metric multidimensional scaling (NMDS) based on a Bray-Curtis dissimilarity matrix in vegan after normalisation and log-transformation of the chemical data.</p>
      <p specific-use="line"># log + 1 transformation</p>
      <p specific-use="line">scent &lt;- <bold>log</bold> (scent + 1)</p>
      <p specific-use="line"># sorting by row names</p>
      <p specific-use="line">scent &lt;- scent[<bold>match</bold>(<bold>row.names</bold>(peak_factors),</p>
      <p specific-use="line">         <bold>row.names</bold>(scent)),]</p>
      <p specific-use="line"># Non-metric multidimensional scaling</p>
      <p specific-use="line">scent_nmds &lt;- vegan::metaMDS(comm = scent, <bold>distance</bold> = “bray”)</p>
      <p specific-use="line">scent_nmds &lt;- <bold>as.data.frame</bold>(scent_nmds[[“points”]])</p>
      <p specific-use="line">scent_nmds &lt;- <bold>cbind</bold>(scent_nmds,</p>
      <p specific-use="line">         colony = peak factors[[“colony”]])</p>
      <p>The results results of the NMDS analysis are outputted to the data frame <monospace>scent_nmds</monospace> and can be visualised using the package ggplot2 [<xref rid="pone.0198311.ref038" ref-type="bibr">38</xref>].</p>
      <p specific-use="line"># load ggplot2</p>
      <p specific-use="line"><bold>library</bold>(ggplot2)</p>
      <p specific-use="line">
        <italic># create the plot (see</italic>
        <xref ref-type="fig" rid="pone.0198311.g006">Fig 6</xref>
        <italic>)</italic>
      </p>
      <p specific-use="line">ggplot(<bold>data</bold> = scent_nmds, aes(MDS1,MDS2, color = colony)) +</p>
      <p specific-use="line">  geom_point () +</p>
      <p specific-use="line">  theme void () +</p>
      <p specific-use="line">  <bold>scale</bold>_color_manual(values = <bold>c</bold>(“blue”, “red”)) +</p>
      <p specific-use="line">  theme(<bold>panel</bold>.background = element_<bold>rect</bold>(colour = “black”,</p>
      <p specific-use="line">   size = 1.25, fill = NA),</p>
      <p specific-use="line">   aspect.ratio = 1,</p>
      <p specific-use="line">   <bold>legend</bold>.position = “none”)</p>
      <fig id="pone.0198311.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Two-dimensional nonmetric multidimensional scaling plot of chemical data from 41 Antarctic fur seal mother–offspring pairs.</title>
          <p>Bray–Curtis dissimilarity values were calculated from standardized and log(x+1) transformed abundance data (see main text for details). Individuals from the two different breeding colonies described in Stoffel <monospace>et al.</monospace> [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>] are shown in blue and red respectively.</p>
        </caption>
        <graphic xlink:href="pone.0198311.g006"/>
      </fig>
      <p>The resulting NMDS plot shown in <xref ref-type="fig" rid="pone.0198311.g006">Fig 6</xref> reveals a clear pattern in which seals from the two colonies cluster apart based on their chemical profiles, as shown also by Stoffel <monospace>et al.</monospace> [<xref rid="pone.0198311.ref006" ref-type="bibr">6</xref>]. Although a sufficient number of standards were lacking in this example dataset to calculate the internal error rate (as shown below for the three bumblebee datasets), the strength of the overall pattern suggests that the alignment implemented by <monospace>GCalignR</monospace> is of high quality.</p>
    </sec>
  </sec>
  <sec id="sec012">
    <title>Evaluation of the performance of <monospace>GCalignR</monospace></title>
    <p>We evaluated the performance of <monospace>GCalignR</monospace> in comparison to <monospace>GCALIGNER</monospace> [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. For this analysis, we focused on three previously published bumblebee datasets that were published together with the <monospace>GCALIGNER</monospace> software [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. These data are well suited to the evaluation of alignment error rates because subsets of chemicals within each dataset have already been identified using GC-MS [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. Hence, by focusing on these known substances, we can test how the two alignment programs perform. Furthermore, these datasets allow us to further investigate the performance of <monospace>GCalignR</monospace> by evaluating how the resulting alignments are influenced by parameter settings.</p>
    <sec id="sec013">
      <title>Comparison with <monospace>GCALIGNER</monospace></title>
      <p>To facilitate comparison of the two programs, we downloaded raw data on cephalic labial gland secretions from three bumblebee species [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>] from <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/wol1/doi/10.1002/jssc.201300388/suppinfo">http://onlinelibrary.wiley.com/wol1/doi/10.1002/jssc.201300388/suppinfo</ext-link>. Each of these datasets included data on both known and unknown substances, the former being defined as those substances that were identified with respect to the NIST database [<xref rid="pone.0198311.ref039" ref-type="bibr">39</xref>]. The three datasets are described in detail by [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. Briefly, the first dataset comprises 24 <italic>Bombus bimaculatus</italic> individuals characterised for a total of 41 substances, of which 32 are known. The second dataset comprises 20 <italic>B. ephippiatus</italic> individuals characterised for 64 substances, of which 42 are known, and the third dataset comprises 11 <italic>B. flavifrons</italic> individuals characterised for 58 substances, of which 44 are known.</p>
      <p>To evaluate the performance of <monospace>GCALIGNER</monospace>, we used an existing alignment provided by [<xref rid="pone.0198311.ref024" ref-type="bibr">24</xref>]. For comparison, we then separately aligned each of the full datasets within <monospace>GCalignR</monospace> as described in detail in <xref ref-type="supplementary-material" rid="pone.0198311.s003">S3 File</xref>. We then evaluated each of the resulting alignments by calculating the error rate, based only on known substances, as the ratio of the number of incorrectly assigned retention times to the total number of retention times (<xref ref-type="disp-formula" rid="pone.0198311.e005">Eq (5)</xref>).
<disp-formula id="pone.0198311.e005"><alternatives><graphic xlink:href="pone.0198311.e005.jpg" id="pone.0198311.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Error</mml:mtext><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number</mml:mtext><mml:mspace width="1pt"/><mml:mtext>of</mml:mtext><mml:mspace width="1pt"/><mml:mtext>misaligned</mml:mtext><mml:mspace width="1pt"/><mml:mtext>retention</mml:mtext><mml:mspace width="1pt"/><mml:mtext>times</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total</mml:mtext><mml:mspace width="1pt"/><mml:mtext>number</mml:mtext><mml:mspace width="1pt"/><mml:mtext>of</mml:mtext><mml:mspace width="1pt"/><mml:mtext>retention</mml:mtext><mml:mspace width="1pt"/><mml:mtext>times</mml:mtext></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where retention times that were not assigned to the row that defines the mode of a given substance were defined as being misaligned. <xref ref-type="fig" rid="pone.0198311.g007">Fig 7</xref> shows that both programs have low alignment error rates (i.e. below 5%) for all three datasets. The programs performed equally well for one of the species (<italic>B. flavifrons</italic>), but overall <monospace>GCalignR</monospace> tended to perform slightly better, with lower alignment error rates being obtained for <italic>B. bimaculatus</italic> and <italic>B. ephippiatus</italic>.</p>
      <fig id="pone.0198311.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Alignment error rates for three bumblebee datasets using <monospace>GCalignR</monospace> and <monospace>GCALIGNER</monospace>.</title>
          <p>Error rates were calculated based only on known substances as described in the main text.</p>
        </caption>
        <graphic xlink:href="pone.0198311.g007"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>Effects of parameter values on alignment results</title>
      <p>The first step in the alignment procedure accounts for systematic linear shifts in retention times. As most datasets will require relatively modest linear transformations (illustrated by the Antarctic fur seal dataset in <xref ref-type="fig" rid="pone.0198311.g005">Fig 5</xref>), the parameter <monospace>max_linear_shift</monospace> (<xref ref-type="table" rid="pone.0198311.t001">Table 1</xref>), which defines the range that is considered for applying linear shifts (i.e. window size), is unlikely to appreciably affect the alignment results. By contrast, two user-defined parameters need to be chosen with care. Specifically, the parameter <monospace>max_diff_peak2mean</monospace> determines the variation in retention times that is allowed for sorting peaks into the same row, whereas the parameter <monospace>min_diff_peak2peak</monospace> enables rows containing homologous peaks that show larger variation in retention times to be merged (see <xref ref-type="sec" rid="sec002">Material and methods</xref> for details and <xref ref-type="table" rid="pone.0198311.t001">Table 1</xref> for definitions). To investigate the effects of different combinations of these two parameters on alignment error rates, we again used the three bumblebee datasets, calculating the error rate as described above for each conducted alignment. <xref ref-type="fig" rid="pone.0198311.g008">Fig 8</xref> shows that for all three datasets, relatively low alignment error rates were obtained when <monospace>max_diff_peak2mean</monospace> was low (i.e. around 0.01 to 0.02 minutes). Error rates gradually increased with larger values of <monospace>max_diff_peak2mean</monospace>, reflecting the incorrect alignment of non-homologous substances that are relatively similar in their retention times. In general, alignment error rates were relatively insensitive to parameter values of <monospace>min_diff_peak2peak</monospace> (see <xref ref-type="fig" rid="pone.0198311.g008">Fig 8</xref>). Higher error rates were only obtained when <monospace>max_diff_peak2mean</monospace> was larger than or the same as <monospace>min_diff_peak2peak</monospace>, in which case merging of homologous rows is not possible.</p>
      <fig id="pone.0198311.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Effects of different parameter combinations on alignment error rates for three bumblebee datasets (see main text for details).</title>
          <p>Each point shows the alignment error rate for a given combination of <monospace>max_diff_peak2mean</monospace> and <monospace>min_diff_peak2peak.</monospace></p>
        </caption>
        <graphic xlink:href="pone.0198311.g008"/>
      </fig>
    </sec>
    <sec id="sec015">
      <title>Comparison with parametric time warping</title>
      <p>In the fields of proteomics and metabolomics, several methods (usually referred to as ‘time warping’ [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>]) for aligning peaks have been developed that aim to transform retention times in such a way that the overlap with the reference sample is maximised [<xref rid="pone.0198311.ref030" ref-type="bibr">30</xref>]. The R package <monospace>ptw</monospace> [<xref rid="pone.0198311.ref019" ref-type="bibr">19</xref>] implements parametric warping and supports a peak list containing retention times and intensity values for each peak of a sample, making it in principle suitable for aligning GC-FID data. However, parametric time warping of a peak list within <monospace>ptw</monospace> is based on strictly pairwise comparisons of each sample to a reference [<xref rid="pone.0198311.ref030" ref-type="bibr">30</xref>]. Therefore, the sample and reference should ideally resemble one another and share all peaks [<xref rid="pone.0198311.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0198311.ref033" ref-type="bibr">33</xref>]. By comparison, <monospace>GCalignR</monospace> only requires a reference for the first step of the alignment procedure and should therefore be better able to cope with among-individual variability. Additionally, although <monospace>ptw</monospace> transforms individual peak lists relative to the reference, it does not provide a function to match homologous substances across samples.</p>
      <p>In order to evaluate how these differences affect alignment performance, we analysed GC-MS data on cuticular hydrocarbon compounds of 330 European earwigs (<italic>Forficula auricularia</italic>) [<xref rid="pone.0198311.ref040" ref-type="bibr">40</xref>] using both <monospace>GCalignR</monospace> and <monospace>ptw</monospace>. This dataset was chosen for two main reasons. First, alignment success can be quantified based on twenty substances of known identity. Second, all of the substances are present in every individual, the only differences being their intensities. Hence, among-individual variability is negligible, which should minimise issues that may arise from samples differing from the reference. As a proxy for alignment success, we compared average deviations in the retention times of homologous peaks in the raw and aligned datasets, with the expectation that effective alignment should reduce retention time deviation.</p>
      <p>For this analysis, we downloaded the earwig dataset from <ext-link ext-link-type="uri" xlink:href="https://datadryad.org/resource/doi:10.5061/dryad.73180">https://datadryad.org/resource/doi:10.5061/dryad.73180</ext-link> [<xref rid="pone.0198311.ref023" ref-type="bibr">23</xref>] and constructed input files for both <monospace>GCalignR</monospace> and <monospace>ptw</monospace>. We then aligned this dataset using both packages as detailed in supporting information <xref ref-type="supplementary-material" rid="pone.0198311.s003">S3 File</xref>. Following fine-tuning of alignment parameters within <monospace>GCalignR</monospace>, we obtained twenty substances in the aligned dataset and all of the homologous peaks were matched correctly (i.e. every substance had a retention time deviation of zero). Consequently, <monospace>GCalignR</monospace> consistently reduced retention time deviation across all substances relative to the raw data (<xref ref-type="fig" rid="pone.0198311.g009">Fig 9</xref>). By comparison, parametric time warping resulted in higher deviation in retention times for all but two of the substances (<xref ref-type="fig" rid="pone.0198311.g009">Fig 9</xref>). These differences in the performance of the two programs probably reflect differential sensitivity to variation in peak intensities.</p>
      <fig id="pone.0198311.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0198311.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Boxplot showing changes in retention time deviation of twenty homologous substances relative to the raw data after having aligned a dataset of 330 European earwigs within <monospace>GCalignR</monospace> and <monospace>ptw</monospace> respectively (see main text for details).</title>
        </caption>
        <graphic xlink:href="pone.0198311.g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec016">
    <title>Conclusions</title>
    <p><monospace>GCalignR</monospace> is primarily intended as a pre-processing tool in the analysis of complex chemical signatures of organisms where overall patterns of chemical similarity are of interest as opposed to specific (i.e. known) chemicals. We have therefore prioritised an objective and fast alignment procedure that is not claimed to be free of error. Nevertheless, our alignment error rate calculations suggest that <monospace>GCalignR</monospace> performs well with a variety of example datasets. <monospace>GCalignR</monospace> also implements a suite of diagnostic plots that allow the user to visualise the influence of parameter settings on the resulting alignments, allowing fine-tuning of both the pre-processing and alignment steps (<xref ref-type="fig" rid="pone.0198311.g001">Fig 1</xref>). For tutorials and worked examples illustrating the functionalities of <monospace>GCalignR</monospace>, we refer to the vignettes that are distributed with the package and are available as supporting information <xref ref-type="supplementary-material" rid="pone.0198311.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pone.0198311.s005">S5</xref> Files.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0198311.s001">
      <label>S1 File</label>
      <caption>
        <title>Summary of published algorithms implemented in publicly available software.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0198311.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0198311.s002">
      <label>S2 File</label>
      <caption>
        <title>Details on the bibliographic survey.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0198311.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0198311.s003">
      <label>S3 File</label>
      <caption>
        <title>R code and accompanying documentation for all analyses presented in this manuscript.</title>
        <p>All analysis steps are provided in an Rmarkdown document file.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0198311.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0198311.s004">
      <label>S4 File</label>
      <caption>
        <title>The vignette ‘<monospace>GCalignR</monospace>: Step by Step’ gives an more detailed introduction into the usage of the package functionalities to tune parameters for aligning peak data.</title>
        <p>(HTML)</p>
      </caption>
      <media xlink:href="pone.0198311.s004.html">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0198311.s005">
      <label>S5 File</label>
      <caption>
        <title>The vignette ‘<monospace>GCalignR</monospace>: How does the Algorithms work?’ gives an introduction into the concepts of the algorithm and illustrates how each step of the alignment procedure alters the outcome based on simple datasets consisting of simulated chromatograms.</title>
        <p>(HTML)</p>
      </caption>
      <media xlink:href="pone.0198311.s005.html">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0198311.s006">
      <label>S1 Dataset</label>
      <caption>
        <title>Datasets used to generate the results presented in this manuscript.</title>
        <p>This is a compressed zip archive that includes all the raw data that were used to produce the results shown in the manuscript and in <xref ref-type="supplementary-material" rid="pone.0198311.s003">S3 File</xref>.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0198311.s006.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Barbara Caspers and Sarah Golüke for helpful discussions and providing data for testing purposes during the development of the package. This research was supported by a Deutsche Forschungsgemeinschaft (DFG) standard Grant (HO 5122/3-1) to J.I.H. together with a dual PhD studentship from Liverpool John Moores University to M.A.S.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0198311.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Wyatt</surname><given-names>TD</given-names></name>. <source>Pheromones and animal behavior: chemical signals and signatures</source>. <edition>2nd ed</edition><publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>de Meulemeester</surname><given-names>T</given-names></name>, <name><surname>Gerbaux</surname><given-names>P</given-names></name>, <name><surname>Boulvin</surname><given-names>M</given-names></name>, <name><surname>Coppée</surname><given-names>A</given-names></name>, <name><surname>Rasmont</surname><given-names>P</given-names></name>. <article-title>A simplified protocol for bumble bee species identification by cephalic secretion analysis</article-title>. <source>Insectes Sociaux</source>. <year>2011</year>;<volume>58</volume>(<issue>2</issue>):<fpage>227</fpage>–<lpage>236</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00040-011-0146-1">10.1007/s00040-011-0146-1</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Caspers</surname><given-names>BA</given-names></name>, <name><surname>Schroeder</surname><given-names>FC</given-names></name>, <name><surname>Franke</surname><given-names>S</given-names></name>, <name><surname>Voigt</surname><given-names>CC</given-names></name>. <article-title>Scents of adolescence: the maturation of the olfactory phenotype in a free-ranging mammal</article-title>. <source>PloS one</source>. <year>2011</year>;<volume>6</volume>(<issue>6</issue>):<fpage>e21162</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0021162">10.1371/journal.pone.0021162</ext-link></comment><?supplied-pmid 21738615?><pub-id pub-id-type="pmid">21738615</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Bonadonna</surname><given-names>F</given-names></name>, <name><surname>Sanz-Aguilar</surname><given-names>A</given-names></name>. <article-title>Kin recognition and inbreeding avoidance in wild birds: The first evidence for individual kin-related odour recognition</article-title>. <source>Animal Behaviour</source>. <year>2012</year>;<volume>84</volume>(<issue>3</issue>):<fpage>509</fpage>–<lpage>513</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2012.06.014">10.1016/j.anbehav.2012.06.014</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Krause</surname><given-names>ET</given-names></name>, <name><surname>Krüger</surname><given-names>O</given-names></name>, <name><surname>Kohlmeier</surname><given-names>P</given-names></name>, <name><surname>Caspers</surname><given-names>BA</given-names></name>. <article-title>Olfactory kin recognition in a songbird</article-title>. <source>Biology letters</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>327</fpage>–<lpage>329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsbl.2011.1093">10.1098/rsbl.2011.1093</ext-link></comment><?supplied-pmid 22219391?><pub-id pub-id-type="pmid">22219391</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Stoffel</surname><given-names>MA</given-names></name>, <name><surname>Caspers</surname><given-names>BA</given-names></name>, <name><surname>Forcada</surname><given-names>J</given-names></name>, <name><surname>Giannakara</surname><given-names>A</given-names></name>, <name><surname>Baier</surname><given-names>M</given-names></name>, <name><surname>Eberhart-Phillips</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Chemical fingerprints encode mother–offspring similarity, colony membership, relatedness, and genetic quality in fur seals</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>36</issue>):<fpage>E5005</fpage>–<lpage>E5012</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1506076112">10.1073/pnas.1506076112</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Charpentier</surname><given-names>MJE</given-names></name>, <name><surname>Crawford</surname><given-names>JC</given-names></name>, <name><surname>Boulet</surname><given-names>M</given-names></name>, <name><surname>Drea</surname><given-names>CM</given-names></name>. <article-title>Message ‘scent’: Lemurs detect the genetic relatedness and quality of conspecifics via olfactory cues</article-title>. <source>Animal Behaviour</source>. <year>2010</year>;<volume>80</volume>(<issue>1</issue>):<fpage>101</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2010.04.005">10.1016/j.anbehav.2010.04.005</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Leclaire</surname><given-names>S</given-names></name>, <name><surname>Merkling</surname><given-names>T</given-names></name>, <name><surname>Raynaud</surname><given-names>C</given-names></name>, <name><surname>Mulard</surname><given-names>H</given-names></name>, <name><surname>Bessière</surname><given-names>JM</given-names></name>, <name><surname>Lhuillier</surname><given-names>É</given-names></name>, <etal>et al</etal><article-title>Semiochemical compounds of preen secretion reflect genetic make-up in a seabird species</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2012</year>;<volume>279</volume>(<issue>1731</issue>):<fpage>1185</fpage>–<lpage>1193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2011.1611">10.1098/rspb.2011.1611</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref009">
      <label>9</label>
      <mixed-citation publication-type="book"><name><surname>McNair</surname><given-names>HM</given-names></name>, <name><surname>Miller</surname><given-names>JM</given-names></name>. <source>Basic gas chromatography</source>. <edition>2nd ed</edition><publisher-loc>Hoboken, New Jersey</publisher-loc>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Boulay</surname><given-names>R</given-names></name>, <name><surname>Cerdá</surname><given-names>X</given-names></name>, <name><surname>Simon</surname><given-names>T</given-names></name>, <name><surname>Roldan</surname><given-names>M</given-names></name>, <name><surname>Hefetz</surname><given-names>A</given-names></name>. <article-title>Intraspecific competition in the ant Camponotus cruentatus: should we expect the ‘dear enemy’effect?</article-title><source>Animal Behaviour</source>. <year>2007</year>;<volume>74</volume>(<issue>4</issue>):<fpage>985</fpage>–<lpage>993</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2007.02.013">10.1016/j.anbehav.2007.02.013</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Foitzik</surname><given-names>S</given-names></name>, <name><surname>Sturm</surname><given-names>H</given-names></name>, <name><surname>Pusch</surname><given-names>K</given-names></name>, <name><surname>D’Ettorre</surname><given-names>P</given-names></name>, <name><surname>Heinze</surname><given-names>J</given-names></name>. <article-title>Nestmate recognition and intraspecific chemical and genetic variation in Temnothorax ants</article-title>. <source>Animal Behaviour</source>. <year>2007</year>;<volume>73</volume>(<issue>6</issue>):<fpage>999</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2006.07.017">10.1016/j.anbehav.2006.07.017</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>CA</given-names></name>, <name><surname>Phelan</surname><given-names>PL</given-names></name>, <name><surname>Herbers</surname><given-names>JM</given-names></name>. <article-title>Stealth and reproductive dominance in a rare parasitic ant</article-title>. <source>Animal Behaviour</source>. <year>2008</year>;<volume>76</volume>(<issue>6</issue>):<fpage>1965</fpage>–<lpage>1976</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2008.09.003">10.1016/j.anbehav.2008.09.003</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Reichle</surname><given-names>C</given-names></name>, <name><surname>Aguilar</surname><given-names>I</given-names></name>, <name><surname>Ayasse</surname><given-names>M</given-names></name>, <name><surname>Twele</surname><given-names>R</given-names></name>, <name><surname>Francke</surname><given-names>W</given-names></name>, <name><surname>Jarau</surname><given-names>S</given-names></name>. <article-title>Learnt information in species-specific ‘trail pheromone’communication in stingless bees</article-title>. <source>Animal Behaviour</source>. <year>2013</year>;<volume>85</volume>(<issue>1</issue>):<fpage>225</fpage>–<lpage>232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2012.10.029">10.1016/j.anbehav.2012.10.029</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref014">
      <label>14</label>
      <mixed-citation publication-type="book"><name><surname>Scott</surname><given-names>RPW</given-names></name>. <chapter-title>Principles and practice of chromatography</chapter-title><source>Chrom-Ed Book Series</source>. <year>2003</year>;<fpage>1</fpage> Available from: <ext-link ext-link-type="uri" xlink:href="http://www.library4science.com">http://www.library4science.com</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Pierce</surname><given-names>KM</given-names></name>, <name><surname>Hope</surname><given-names>JL</given-names></name>, <name><surname>Johnson</surname><given-names>KJ</given-names></name>, <name><surname>Wright</surname><given-names>BW</given-names></name>, <name><surname>Synovec</surname><given-names>RE</given-names></name>. <article-title>Classification of gasoline data obtained by gas chromatography using a piecewise alignment algorithm combined with feature selection and principal component analysis</article-title>. <source>Journal of Chromatography A</source>. <year>2005</year>;<volume>1096</volume>(<issue>1</issue>):<fpage>101</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chroma.2005.04.078">10.1016/j.chroma.2005.04.078</ext-link></comment><?supplied-pmid 16301073?><pub-id pub-id-type="pmid">16301073</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Lange</surname><given-names>E</given-names></name>, <name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>, <name><surname>Gröpl</surname><given-names>C</given-names></name>. <article-title>Critical assessment of alignment procedures for LC-MS proteomics and metabolomics measurements</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>375</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-9-375">10.1186/1471-2105-9-375</ext-link></comment><?supplied-pmid 18793413?><pub-id pub-id-type="pmid">18793413</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>R</given-names></name>, <name><surname>Ventura</surname><given-names>D</given-names></name>, <name><surname>Prince</surname><given-names>JT</given-names></name>. <article-title>LC-MS alignment in theory and practice: a comprehensive algorithmic review</article-title>. <source>Briefings in bioinformatics</source>. <year>2013</year>;<volume>16</volume>(<issue>1</issue>):<fpage>104</fpage>–<lpage>117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bib/bbt080">10.1093/bib/bbt080</ext-link></comment><?supplied-pmid 24273217?><pub-id pub-id-type="pmid">24273217</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Kirchner</surname><given-names>M</given-names></name>, <name><surname>Saussen</surname><given-names>B</given-names></name>, <name><surname>Steen</surname><given-names>H</given-names></name>, <name><surname>Steen</surname><given-names>JA</given-names></name>, <name><surname>Hamprecht</surname><given-names>FA</given-names></name>. <article-title>amsrpm: robust point matching for retention time alignment of LC/MS data with R</article-title>. <source>Journal of Statistical Software</source>. <year>2007</year>;<volume>18</volume>(<issue>4</issue>):<fpage>12</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v018.i04">10.18637/jss.v018.i04</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Bloemberg</surname><given-names>TG</given-names></name>, <name><surname>Gerretzen</surname><given-names>J</given-names></name>, <name><surname>Wouters</surname><given-names>HJP</given-names></name>, <name><surname>Gloerich</surname><given-names>J</given-names></name>, <name><surname>van Dael</surname><given-names>M</given-names></name>, <name><surname>Wessels</surname><given-names>HJ</given-names></name>, <etal>et al</etal><article-title>Improved parametric time warping for proteomics</article-title>. <source>Chemometrics and Intelligent Laboratory Systems</source>. <year>2010</year>;<volume>104</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chemolab.2010.04.008">10.1016/j.chemolab.2010.04.008</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>KJ</given-names></name>, <name><surname>Wright</surname><given-names>BW</given-names></name>, <name><surname>Jarman</surname><given-names>KH</given-names></name>, <name><surname>Synovec</surname><given-names>RE</given-names></name>. <article-title>High-speed peak matching algorithm for retention time alignment of gas chromatographic data for chemometric analysis</article-title>. <source>Journal of Chromatography A</source>. <year>2003</year>;<volume>996</volume>(<issue>1</issue>):<fpage>141</fpage>–<lpage>155</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0021-9673(03)00616-2">10.1016/S0021-9673(03)00616-2</ext-link></comment><?supplied-pmid 12830915?><pub-id pub-id-type="pmid">12830915</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jordan</surname><given-names>NR</given-names></name>, <name><surname>Manser</surname><given-names>MB</given-names></name>, <name><surname>Mwanguhya</surname><given-names>F</given-names></name>, <name><surname>Kyabulima</surname><given-names>S</given-names></name>, <name><surname>Rüedi</surname><given-names>P</given-names></name>, <name><surname>Cant</surname><given-names>MA</given-names></name>. <article-title>Scent marking in wild banded mongooses: 1. Sex-specific scents and overmarking</article-title>. <source>Animal Behaviour</source>. <year>2011</year>;<volume>81</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>42</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Breed</surname><given-names>MD</given-names></name>, <name><surname>Garry</surname><given-names>MF</given-names></name>, <name><surname>Pearce</surname><given-names>AN</given-names></name>, <name><surname>Hibbard</surname><given-names>BE</given-names></name>, <name><surname>Bjostad</surname><given-names>LB</given-names></name>, <name><surname>Page</surname><given-names>RE</given-names><suffix>Jr</suffix></name>. <article-title>The role of wax comb in honey bee nestmate recognition</article-title>. <source>Animal Behaviour</source>. <year>1995</year>;<volume>50</volume>(<issue>2</issue>):<fpage>489</fpage>–<lpage>496</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/anbe.1995.0263">10.1006/anbe.1995.0263</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>JWY</given-names></name>, <name><surname>Meunier</surname><given-names>J</given-names></name>, <name><surname>Lucas</surname><given-names>C</given-names></name>, <name><surname>Kölliker</surname><given-names>M</given-names></name>. <article-title>Data from: Paternal signature in kin recognition cues of a social insect: concealed in juveniles, revealed in adults</article-title>. <source>Proceedings of the Royal Society B</source>. <year>2014</year>;</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Dellicour</surname><given-names>S</given-names></name>, <name><surname>Lecocq</surname><given-names>T</given-names></name>. <article-title>GCALIGNER 1.0: an alignment program to compute a multiple sample comparison data matrix from large eco-chemical datasets obtained by GC</article-title>. <source>Journal of separation science</source>. <year>2013</year>;<volume>36</volume>(<issue>19</issue>):<fpage>3206</fpage>–<lpage>3209</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jssc.201300388">10.1002/jssc.201300388</ext-link></comment><?supplied-pmid 23894053?><pub-id pub-id-type="pmid">23894053</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Allaire JJ, Cheng J, Xie Y, McPherson J, Chang W, Allen J, et al. rmarkdown: Dynamic Documents for R; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rmarkdown">https://CRAN.R-project.org/package=rmarkdown</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>JI</given-names></name>. <article-title>Reproducibility: Archive computer code with raw data</article-title>. <source>Nature</source>. <year>2016</year>;<volume>534</volume>(<issue>7607</issue>):<fpage>326</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/534326d">10.1038/534326d</ext-link></comment><?supplied-pmid 27306179?><pub-id pub-id-type="pmid">27306179</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Greene</surname><given-names>LK</given-names></name>, <name><surname>Drea</surname><given-names>CM</given-names></name>. <article-title>Love is in the air: sociality and pair bondedness influence sifaka reproductive signalling</article-title>. <source>Animal Behaviour</source>. <year>2014</year>;<volume>88</volume>:<fpage>147</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2013.11.019">10.1016/j.anbehav.2013.11.019</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>van Wilgenburg</surname><given-names>E</given-names></name>, <name><surname>Elgar</surname><given-names>MA</given-names></name>. <article-title>Confirmation bias in studies of nestmate recognition: a cautionary note for research into the behaviour of animals</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>1</issue>):<fpage>e53548</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0053548">10.1371/journal.pone.0053548</ext-link></comment><?supplied-pmid 23372659?><pub-id pub-id-type="pmid">23372659</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Oksanen J, Blanchet FG, Friendly M, Kindt R, Legendre P, McGlinn D, et al. vegan: Community Ecology Package; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wehrens</surname><given-names>R</given-names></name>, <name><surname>Bloemberg</surname><given-names>TG</given-names></name>, <name><surname>Eilers</surname><given-names>PHC</given-names></name>. <article-title>Fast parametric time warping of peak lists</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>18</issue>):<fpage>3063</fpage>–<lpage>3065</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv299">10.1093/bioinformatics/btv299</ext-link></comment><?supplied-pmid 25971741?><pub-id pub-id-type="pmid">25971741</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>What is dynamic programming?</article-title><source>Nature biotechnology</source>. <year>2004</year>;<volume>22</volume>(<issue>7</issue>):<fpage>909</fpage>–<lpage>910</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt0704-909">10.1038/nbt0704-909</ext-link></comment><?supplied-pmid 15229554?><pub-id pub-id-type="pmid">15229554</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Daszykowski</surname><given-names>M</given-names></name>, <name><surname>Vander Heyden</surname><given-names>Y</given-names></name>, <name><surname>Boucon</surname><given-names>C</given-names></name>, <name><surname>Walczak</surname><given-names>B</given-names></name>. <article-title>Automated alignment of one-dimensional chromatographic fingerprints</article-title>. <source>Journal of chromatography A</source>. <year>2010</year>;<volume>1217</volume>(<issue>40</issue>):<fpage>6127</fpage>–<lpage>6133</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chroma.2010.08.008">10.1016/j.chroma.2010.08.008</ext-link></comment><?supplied-pmid 20800232?><pub-id pub-id-type="pmid">20800232</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Bloemberg</surname><given-names>TG</given-names></name>, <name><surname>Gerretzen</surname><given-names>J</given-names></name>, <name><surname>Lunshof</surname><given-names>A</given-names></name>, <name><surname>Wehrens</surname><given-names>R</given-names></name>, <name><surname>Buydens</surname><given-names>LMC</given-names></name>. <article-title>Warping methods for spectroscopic and chromatographic signal alignment: a tutorial</article-title>. <source>Analytica chimica acta</source>. <year>2013</year>;<volume>781</volume>:<fpage>14</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.aca.2013.03.048">10.1016/j.aca.2013.03.048</ext-link></comment><?supplied-pmid 23684461?><pub-id pub-id-type="pmid">23684461</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Clarke</surname><given-names>K</given-names></name>, <name><surname>Chapman</surname><given-names>M</given-names></name>, <name><surname>Somerfield</surname><given-names>P</given-names></name>, <name><surname>Needham</surname><given-names>H</given-names></name>. <article-title>Dispersion-based weighting of species counts in assemblage analyses</article-title>. <source>Marine Ecology Progress Series</source>. <year>2006</year>;<volume>320</volume>:<fpage>11</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3354/meps320011">10.3354/meps320011</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Burgener</surname><given-names>N</given-names></name>, <name><surname>Dehnhard</surname><given-names>M</given-names></name>, <name><surname>Hofer</surname><given-names>H</given-names></name>, <name><surname>East</surname><given-names>ML</given-names></name>. <article-title>Does anal gland scent signal identity in the spotted hyaena?</article-title><source>Animal Behaviour</source>. <year>2009</year>;<volume>77</volume>(<issue>3</issue>):<fpage>707</fpage>–<lpage>715</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2008.11.022">10.1016/j.anbehav.2008.11.022</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Setchell</surname><given-names>JM</given-names></name>, <name><surname>Vaglio</surname><given-names>S</given-names></name>, <name><surname>Abbott</surname><given-names>KM</given-names></name>, <name><surname>Moggi-Cecchi</surname><given-names>J</given-names></name>, <name><surname>Boscaro</surname><given-names>F</given-names></name>, <name><surname>Pieraccini</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>Odour signals major histocompatibility complex genotype in an Old World monkey</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2010</year>; p. rspb20100571.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenzi</surname><given-names>MC</given-names></name>, <name><surname>Cervo</surname><given-names>R</given-names></name>, <name><surname>Bagnères</surname><given-names>AG</given-names></name>. <article-title>Facultative social parasites mark host nests with branched hydrocarbons</article-title>. <source>Animal Behaviour</source>. <year>2011</year>;<volume>82</volume>(<issue>5</issue>):<fpage>1143</fpage>–<lpage>1149</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2011.08.011">10.1016/j.anbehav.2011.08.011</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0198311.ref038">
      <label>38</label>
      <mixed-citation publication-type="book"><name><surname>Wickham</surname><given-names>H</given-names></name>. <source>ggplot2: Elegant Graphics for Data Analysis</source>. <edition>2nd ed</edition><publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag New York</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref039">
      <label>39</label>
      <mixed-citation publication-type="book"><name><surname>Linstrom</surname><given-names>P</given-names></name>, <name><surname>Mallard</surname><given-names>W</given-names></name>. <source>NIST Chemistry WebBook, NIST Standard Reference Database Number 69</source>. <publisher-name>National Institute of Standards and Technology</publisher-name>, <publisher-loc>Gaithersburg MD</publisher-loc>; <year>2009</year> Available from: <ext-link ext-link-type="uri" xlink:href="https://webbook.nist.gov/">https://webbook.nist.gov/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0198311.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>JWY</given-names></name>, <name><surname>Meunier</surname><given-names>J</given-names></name>, <name><surname>Lucas</surname><given-names>C</given-names></name>, <name><surname>Kölliker</surname><given-names>M</given-names></name>. <article-title>Paternal signature in kin recognition cues of a social insect: concealed in juveniles, revealed in adults</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2014</year>;<volume>281</volume>(<issue>1793</issue>):<fpage>20141236</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2014.1236">10.1098/rspb.2014.1236</ext-link></comment></mixed-citation>
    </ref>
  </ref-list>
</back>
