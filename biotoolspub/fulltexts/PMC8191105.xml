<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8191105</article-id>
    <article-id pub-id-type="publisher-id">4222</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04222-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PPalign: optimal alignment of Potts models representing proteins with direct coupling information</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Talibart</surname>
          <given-names>Hugo</given-names>
        </name>
        <address>
          <email>hugo.talibart@irisa.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coste</surname>
          <given-names>François</given-names>
        </name>
        <address>
          <email>francois.coste@inria.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.420225.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2298 7270</institution-id><institution>Univ Rennes, Inria, CNRS, IRISA, </institution></institution-wrap>Rennes, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>317</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">To assign structural and functional annotations to the ever increasing amount of sequenced proteins, the main approach relies on sequence-based homology search methods, e.g. BLAST or the current state-of-the-art methods based on profile Hidden Markov Models, which rely on significant alignments of query sequences to annotated proteins or protein families. While powerful, these approaches do not take coevolution between residues into account. Taking advantage of recent advances in the field of contact prediction, we propose here to represent proteins by Potts models, which model direct couplings between positions in addition to positional composition, and to compare proteins by aligning these models. Due to non-local dependencies, the problem of aligning Potts models is hard and remains the main computational bottleneck for their use.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We introduce here an Integer Linear Programming formulation of the problem and PPalign, a program based on this formulation, to compute the optimal pairwise alignment of Potts models representing proteins in tractable time. The approach is assessed with respect to a non-redundant set of reference pairwise sequence alignments from SISYPHUS benchmark which have lowest sequence identity (between <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>3</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20\%$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq2.gif"/></alternatives></inline-formula>) and enable to build reliable Potts models for each sequence to be aligned. This experimentation confirms that Potts models can be aligned in reasonable time (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1'37''$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mn>37</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq3.gif"/></alternatives></inline-formula> in average on these alignments). The contribution of couplings is evaluated in comparison with HHalign and independent-site PPalign. Although Potts models were not fully optimized for alignment purposes and simple gap scores were used, PPalign yields a better mean <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq4.gif"/></alternatives></inline-formula> score and finds significantly better alignments than HHalign and PPalign without couplings in some cases.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">These results show that pairwise couplings from protein Potts models can be used to improve the alignment of remotely related protein sequences in tractable time. Our experimentation suggests yet that new research on the inference of Potts models is now needed to make them more comparable and suitable for homology search. We think that PPalign’s guaranteed optimality will be a powerful asset to perform unbiased investigations in this direction.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Direct coupling analysis</kwd>
      <kwd>Potts model</kwd>
      <kwd>Integer linear programming</kwd>
      <kwd>Proteins</kwd>
      <kwd>Sequence alignment</kwd>
      <kwd>Homology</kwd>
      <kwd>Coevolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100012958</institution-id>
            <institution>Ministére de l'Education Nationale, de la Formation professionnelle, de l'Enseignement Supérieur et de la Recherche Scientifique</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Thanks to sequencing technologies, the number of available protein sequences has considerably increased in the past years, but their functional and structural annotation remains a bottleneck. This task is thus classically performed in silico by scoring the alignment of new sequences to well-annotated homologs. One of the best-known method is BLAST [<xref ref-type="bibr" rid="CR1">1</xref>], which performs pairwise sequence alignments. The main tools for homology search are now based on profile Hidden Markov Models (pHMMs), which model position-specific composition, insertion and deletion probabilities of each family of homologous proteins. Two well-known software packages using pHMMs are widely used today: HMMER [<xref ref-type="bibr" rid="CR2">2</xref>] aligns sequences to pHMMs and HH-suite [<xref ref-type="bibr" rid="CR3">3</xref>] takes it further by aligning pHMMs to pHMMs.</p>
    <p id="Par10">Despite their solid performance, pHMMs are innerly limited by their positional nature. Yet, it is well-known that residues that are distant in the sequence can interact and co-evolve, e.g. due to their spatial proximity, resulting in correlated positions. One can cite for instance experiments of Ranganathan et al. on the WW domain who showed by experimentally testing libraries of artificial sequences of the WW domain that coevolution information is necessary to reproduce the functional properties of native proteins [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par11">There have been a few attempts to make use of long-distance sequence information. Menke, Berger and Cowen introduced a Markov Random Field (MRF) approach, SMURF [<xref ref-type="bibr" rid="CR5">5</xref>], where MRFs generalize pHMMs by allowing dependencies between paired residues in <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M10"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq5.gif"/></alternatives></inline-formula>-strands to recognize proteins that fold into <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M12"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq6.gif"/></alternatives></inline-formula>-structural motifs. Their MRFs are trained on multiple structure alignments. A model simplification [<xref ref-type="bibr" rid="CR6">6</xref>] and heuristics [<xref ref-type="bibr" rid="CR7">7</xref>] have been proposed to speed up the process. While these methods outperform HMMER [<xref ref-type="bibr" rid="CR2">2</xref>] in propeller fold prediction, they are limited to sequence-MRF alignment on <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M14"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq7.gif"/></alternatives></inline-formula>-strand motifs with available structures. Xu et al. [<xref ref-type="bibr" rid="CR8">8</xref>] proposed a more general method, MRFalign, which performs MRF-MRF alignments using probabilities estimated by neural networks from amino acid frequencies and mutual information. Unlike SMURF, MRFalign handles dependencies between all positions and MRFs are built from multiple sequence alignments.</p>
    <p id="Par12">In addition to these inputs, MRFalign relies on complex scoring functions based on Conditional Neural Fields and Probabilistic Neural Network trained on reference alignments and structural information to optimize the similarity measures of the positional and coupling potentials of the MRF models to be compared. In reported results, PSSM–PSSM and HMM–HMM alignment methods are outperformed by MRFalign in terms of both alignment accuracy and remote homology detection accuracy, notably on mainly beta proteins, showing the potential of using long-distance information in protein sequence alignment.</p>
    <p id="Par13">Meanwhile, a more interpretable type of MRF grounded in the maximum entropy principle led to a breakthrough in the field of contact prediction [<xref ref-type="bibr" rid="CR9">9</xref>]: the Potts model. This model was brought forward by Direct Coupling Analysis [<xref ref-type="bibr" rid="CR10">10</xref>], a statistical method to extract direct correlations from multiple sequence alignments. Once inferred on a multiple sequence alignment (MSA), Potts model’s nodes represent positional conservation, and its edges represent direct couplings between positions in the MSA. Unlike mutual information which also captures indirect correlations between positions, Potts models are global models capturing the collective effects of entire networks of correlations through their coupling parameters [<xref ref-type="bibr" rid="CR11">11</xref>], thus tackling indirect effects and making them a relevant means of predicting interactions between residues. Beyond contact prediction, the positional and the direct coupling information captured by Potts model’s parameters might also be valuable in the context of protein homology search. The idea of using Potts models for this purpose was simultaneously proposed last year at the 2019 <italic>Workshop on Co-evolutionary Methods for the Prediction and Design of Protein Structure and Interactions</italic> by Muntoni and Weigt [<xref ref-type="bibr" rid="CR12">12</xref>], proposing to align sequences to Potts models, and by us [<xref ref-type="bibr" rid="CR13">13</xref>], proposing to align Potts models to Potts models in our generic framework for the comparison of protein sequences using direct coupling information named ComPotts.</p>
    <p id="Par14">A method to align a sequence to an hybrid model between Potts model and profile Hidden Markov Model was concurrently proposed by Wilburn and Eddy with Hidden Potts Models [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par15">The main computational bottleneck for such approaches is that, due to non-local dependencies, alignment problems involving Potts models are hard. Muntoni and Weigt [<xref ref-type="bibr" rid="CR15">15</xref>] proposed an approximate message-passing algorithm to align a sequence to a Potts model, while Wilburn and Eddy [<xref ref-type="bibr" rid="CR14">14</xref>] proposed a method based on importance sampling. We present here PPalign, the alignment method we introduced in ComPotts to optimally align two Potts models representing proteins in tractable time with respect to our Integer Linear Programming (ILP) formulation of the problem. This work builds with an adequate scoring function on the ILP formulation of Wohlers, Andonov, Malod-Dognin and Klau [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] of the distance matrix alignment problem initiated by DALI to perform protein structure alignment [<xref ref-type="bibr" rid="CR18">18</xref>] and their efficient solver extending itself to real valued pairwise scores their solver for protein structure alignment by Contact Map Overlap (CMO) maximisation [<xref ref-type="bibr" rid="CR19">19</xref>], a well-studied problem where Linear Programming strategies are known to be efficient [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. In contrast to these methods using pairwise information from protein structures, in our approach proteins are aligned using pairwise information from protein sequences only. Our method can then be significantly different in not only considering contact or coupling strength information between position pairs but also their coupled amino-acid composition.</p>
    <p id="Par16">This paper fully describe our Potts to Potts model alignment of sequences approach and focus on its performances in terms of alignment quality on remote homologs. In the following sections, we explain our choices for the inference of Potts models and describe the method PPalign for aligning them. To assess the tractability and the quality of alignments by this approach, we extracted 33 non-redundant pairwise reference alignments with a particularly low identity from the manually curated structural alignments database SISYPHUS [<xref ref-type="bibr" rid="CR22">22</xref>] and randomly split it into a training set of 11 pairs to train our hyperparameters and a test set of 22 pairs on which we compared our results with HHalign’s alignments of pHMMs built on the same input data. On this test set, our method yielded the exact solutions up to a chosen epsilon in tractable time, and outperformed HHalign in terms of alignment quality with an <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq8.gif"/></alternatives></inline-formula> score better on average and significantly better for 5 alignments, suggesting that direct couplings can improve alignment quality of remote homologs.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Inference of Potts models</title>
      <p id="Par17">Potts models are discrete instances of pairwise Markov Random Fields which originate from statistical physics. They generalize Ising models by describing interacting spins on a crystalline lattice with a finite alphabet. In the paper introducing Direct Coupling Analysis, Weigt et al. came up with the idea of applying them to proteins: by building a multiple sequence alignment of a protein sequence and its close homologs and inferring a Potts model on it, one can predict contacts between residues by looking at its parameters [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      <p id="Par18">The inference of a Potts model from a set of protein sequences can be formally defined as follows:</p>
      <p id="Par19">Let <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\{s^n\}_{n=1,\ldots ,N}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq9.gif"/></alternatives></inline-formula> be a set of <italic>N</italic> protein sequences of lengths <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_1,\ldots ,l_N$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq10.gif"/></alternatives></inline-formula>. A multiple sequence alignment (MSA) of these sequences can be defined as a set of <italic>N</italic> sequences <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\{x^n\}_{n=1,\ldots ,N}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq11.gif"/></alternatives></inline-formula> on the alphabet of <italic>S</italic> extended with a new gap character ’−’, which all have the same length <italic>L</italic> and such that removing all gaps from a sequence <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^n$$\end{document}</tex-math><mml:math id="M24"><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq12.gif"/></alternatives></inline-formula> gives <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s^n$$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq13.gif"/></alternatives></inline-formula>. By extension, <italic>L</italic> is called the length of the MSA. We denote by <italic>q</italic> the size of the alphabet.</p>
      <p id="Par20">A Potts model with <italic>q</italic> states for MSA <italic>X</italic> can be defined as a statistical model whose probability distribution <italic>P</italic> over all sequences of length <italic>L</italic> maximizes the Shannon entropy <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H(P)=-\sum _{y \in \{1,\ldots ,q\}^L} P(y) \log P(y)}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msup></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq14.gif"/></alternatives></inline-formula> and generates the empirical single and double frequencies of the MSA as marginals:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall i&amp; = {} 1,\ldots ,L, \forall a=1,\ldots ,q, \sum _{\begin{array}{c} y \in \{1,\ldots ,q\}^L \\ y_i=a \end{array}} P(y) = f_i(a) = \frac{1}{N} \sum _{n=1}^N \delta \left( x_i^n,a\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>δ</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall i,j&amp; = {} 1,\ldots ,L, \forall a, b=1,\ldots ,q, \sum _{\begin{array}{c} y \in \{1,\ldots ,q\}^L \\ y_i=a, y_j=b \end{array}} P(y) = f_{ij}(a,b) &amp; = {} \frac{1}{N} \sum _{n=1}^N \delta (x_i^n,a) \delta \left( x_j^n,b\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>This probability distribution has the following form:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(X=x|{\boldsymbol{v}}, {\boldsymbol{w}}) = \frac{1}{Z} \exp \left( - {\mathcal {H}}(x|{\boldsymbol{v}}, {\boldsymbol{w}}) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>Z</italic> is a normalization constant : <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z=\sum _{y \in \{1, \ldots , q\}^L} \exp \left( - {\mathcal {H}}(y|{\boldsymbol{v}}, {\boldsymbol{w}}) \right)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msup></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {H}}$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">H</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq16.gif"/></alternatives></inline-formula> is an energy function defined as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {H}}(x|{\boldsymbol{v}}, {\boldsymbol{w}}) = -\left( \sum _{i=1}^L v_i(x_i) + \sum _{i=1}^{L-1} \sum _{j=i+1}^L w_{ij}(x_i,x_j) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where the parameters <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\boldsymbol{v}},{\boldsymbol{w}})$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq17.gif"/></alternatives></inline-formula> that define a Potts model are the ones that maximize the likelihood of the sequences in the MSA <italic>X</italic>:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\boldsymbol{v}}, {\boldsymbol{w}}&amp; = {} {\mathop {{{\,\mathrm{argmax}\,}}}\limits _{v,w}} \prod _{n=1}^N P \left( X=x^n|v,w\right) \\ &amp;= {\mathop {{{\,\mathrm{argmax}\,}}}\limits _{{v,w}}} \prod _{n=1}^N \frac{1}{Z} \exp \left( \sum _{i=1}^L v_i(x^n_i)  + \sum _{i=1}^{L-1} \sum _{j=i+1}^L w_{ij}\left( x^n_i,x^n_j\right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:munder><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">argmax</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">argmax</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par21">These parameters can be assigned a practical interpretation:<list list-type="bullet"><list-item><p id="Par22"><inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{v}} = \{v_i\}_{i=1,\ldots ,L}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq18.gif"/></alternatives></inline-formula> are positional parameters termed “fields”. Each <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq19.gif"/></alternatives></inline-formula> is a real vector of length <italic>q</italic> where <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i(a)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq20.gif"/></alternatives></inline-formula> is related to the propensity of letter <italic>a</italic> to be found at position <italic>i</italic>.</p></list-item><list-item><p id="Par23"><inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{w}} = \{w_{ij}\}_{i,j=1,\ldots ,L}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq21.gif"/></alternatives></inline-formula> are pairwise coupling parameters. Each <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq22.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q \times q$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq23.gif"/></alternatives></inline-formula> real matrix where <inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq24.gif"/></alternatives></inline-formula> quantifies how compatible letters <italic>a</italic> and <italic>b</italic> are when found at positions <italic>i</italic> and <italic>j</italic>.</p></list-item></list>An illustration of Potts model is given Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Example of Potts model representing a MSA of length 4. Each column in the MSA is associated with a field vector <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq25.gif"/></alternatives></inline-formula> of length <inline-formula id="IEq26"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q=20$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq26.gif"/></alternatives></inline-formula> where each <inline-formula id="IEq27"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i(a)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq27.gif"/></alternatives></inline-formula> is a real value weighting positively or negatively the occurrence of letter <italic>a</italic> at position <italic>i</italic>. Each pair of positions (<italic>i</italic>, <italic>j</italic>) is associated with a <inline-formula id="IEq28"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q \times q$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq28.gif"/></alternatives></inline-formula> coupling matrix <inline-formula id="IEq29"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq29.gif"/></alternatives></inline-formula> where <inline-formula id="IEq30"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}(a,b)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq30.gif"/></alternatives></inline-formula> are real values weighting positively or negatively the co-occurrence of letters <italic>a</italic> and <italic>b</italic> respectively at position <italic>i</italic> and <italic>j</italic></p></caption><graphic xlink:href="12859_2021_4222_Fig1_HTML" id="MO6"/></fig></p>
      <p id="Par24">These parameters are unique up to a <italic>gauge invariance</italic>: Eqs. (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>) are not independent, implying that the probability distribution remains unchanged under the following transformation:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\left\{ \begin{array}{ll} w_{ij}(a,b) \leftarrow w_{ij}(a,b) + K_{ij}(a) + K_{ji}(b)\\ v_i(a) \leftarrow v_i(a) + C_i - \sum _{j \ne i} (K_{ij}(a)+K_{ji}(a)) \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{ij}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_i$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq32.gif"/></alternatives></inline-formula> are arbitrary values. In our case, this indeterminacy is fixed with the widely-used zero-sum gauge:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall i, j, b, \sum _a w_{ij}(a,b) = \sum _a v_i(a) = 0 \end{aligned}$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par25">In practice, maximizing the likelihood would require the computation of the normalization constant <italic>Z</italic> at each step, which is computationally intractable. Among the several approximate inference methods that have been proposed [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR26">26</xref>], we opted here for pseudo-likelihood maximization since it was proven to be a consistent estimator in the limit of infinite data [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] within reasonable time. Furthermore, since our goal is to align Potts models, we need the inferrence to be geared towards similar models for similar MSAs, which is not what inference methods were initially designed for. In an effort towards inferring canonical Potts models, we have chosen here to use CCMpredPy [<xref ref-type="bibr" rid="CR29">29</xref>], a recent Python-based version of CCMpred [<xref ref-type="bibr" rid="CR30">30</xref>] which, instead of using the standard <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq33.gif"/></alternatives></inline-formula> regularization prior <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R(v,w) = \lambda _v \left\Vert v\right\Vert _2^2 + \lambda _w \left\Vert w\right\Vert _2^2}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:mi>v</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:mi>w</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq34.gif"/></alternatives></inline-formula>, allows us to use a smarter prior on <italic>v</italic>:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R(v,w) = \lambda _v \left\Vert v-v^*\right\Vert _2^2 + \lambda _w \left\Vert w\right\Vert _2^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:mi>w</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq35"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^*$$\end{document}</tex-math><mml:math id="M86"><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq35.gif"/></alternatives></inline-formula> obeys<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\exp \left( v^*_i(a)\right) }{\sum _{b=1}^q \exp \left( v^*_i(b)\right) } = f_i(a) \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>which yields the correct probability model if no columns are coupled, i.e. <inline-formula id="IEq36"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(x|v,w) = \prod _{i=1}^L P(x_i)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq36.gif"/></alternatives></inline-formula>. Our intuition is that positional parameters should explain the MSA as much as possible and only necessary couplings should be added.</p>
    </sec>
    <sec id="Sec4">
      <title>From a protein sequence to a Potts model</title>
      <p id="Par26">Unlike homology detection methods based on simple pairwise sequence alignment such as BLAST, as HHalign our method explicitly considers sequence conservation and variability around sequences to be compared by modeling each sequence and its retrieved close homologs, with the addition of coupling information in our case. This implies that the quality of the alignment will be dependent on the quality of the MSAs of close homologs built for each sequence. In this paper, based on CCMpred’s recommendations [<xref ref-type="bibr" rid="CR31">31</xref>], for each sequence we run HHblits [<xref ref-type="bibr" rid="CR3">3</xref>] v3.03 with the following parameters:</p>
      <p id="Par27"><inline-formula id="IEq37"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt {-maxfilt~100000}}~{\texttt {-realign}}\_{\texttt {max}}~{\texttt {100000 -all -B 100000 -Z 100000 -n 3 -e 0.001}}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">maxfilt</mml:mi><mml:mspace width="3.33333pt"/><mml:mn mathvariant="monospace">100000</mml:mn></mml:mrow><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">realign</mml:mi></mml:mrow><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">max</mml:mi><mml:mspace width="3.33333pt"/><mml:mrow><mml:mn mathvariant="monospace">100000</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">all</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">B</mml:mi><mml:mn mathvariant="monospace">100000</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">Z</mml:mi><mml:mn mathvariant="monospace">100000</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">n</mml:mi><mml:mn mathvariant="monospace">3</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="monospace">e</mml:mi><mml:mn mathvariant="monospace">0.001</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq37.gif"/></alternatives></inline-formula> on Uniclust30 [<xref ref-type="bibr" rid="CR32">32</xref>] (08/2018 release), and then process the output by:<list list-type="bullet"><list-item><p id="Par28">filtering at <inline-formula id="IEq38"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$80\%$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq38.gif"/></alternatives></inline-formula> identity using HHfilter</p></list-item><list-item><p id="Par29">taking the first 1000 sequences</p></list-item><list-item><p id="Par30">removing all columns with <inline-formula id="IEq39"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;50\%$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq39.gif"/></alternatives></inline-formula> gaps using trimal [<xref ref-type="bibr" rid="CR33">33</xref>]</p></list-item></list>The resulting MSA is inputted to CCMpredy [<xref ref-type="bibr" rid="CR29">29</xref>] using default parameters to infer a Potts model, and trimmed positions <italic>i</italic> (with <inline-formula id="IEq40"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;50\%$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq40.gif"/></alternatives></inline-formula> gaps in the input MSA) are re-inserted in the model with positional parameters at position <italic>i</italic> set to background fields defined using frequencies <inline-formula id="IEq41"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_0$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq41.gif"/></alternatives></inline-formula> given by [<xref ref-type="bibr" rid="CR34">34</xref>]<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_0(a) = \log f_0(a) - \frac{1}{q} \sum _{b=1}^q \log f_0(b) \end{aligned}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>and pairwise coupling parameters with position <italic>i</italic> set to:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall j, a, b, w_{ij}(a,b) = 0 \end{aligned}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec5">
      <title>Parameter rescaling strategy</title>
      <p id="Par31">Since existing Potts model inference methods were specifically designed for the prediction of co-evolving position pairs, inferred parameters might not be ideally suited for Potts model comparison. This section describes two strategies implemented to compensate for these shortcomings.</p>
      <sec id="Sec6">
        <title>Lessening the effect of small sample variations on the positional parameters</title>
        <p id="Par32">Since field parameters <italic>v</italic> are linked to single frequencies through a logarithmic relation [see Eq. (<xref rid="Equ9" ref-type="">9</xref>)], any noise in the presence of small probabilities can have a great impact on the model parameters. This has a dramatic effect on the scoring function we use for pairwise Potts model alignment since the sign of each parameter directly determines the sign of their similarity score (see next section). To lessen the effects of sampling variations, we apply additive smoothing to the softmax probability distribution <inline-formula id="IEq42"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq42.gif"/></alternatives></inline-formula> associated with each <inline-formula id="IEq43"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq43.gif"/></alternatives></inline-formula>.</p>
        <p id="Par33">More formally, a standard softmax probability distribution <inline-formula id="IEq44"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq44.gif"/></alternatives></inline-formula> is extracted for each positional parameter <inline-formula id="IEq45"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq45.gif"/></alternatives></inline-formula>:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall a \, p_i(a) = \frac{\exp (v_i(a))}{\sum _{b=1}^{q} \exp (v_i(b))} \end{aligned}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>a</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par34">It is then smoothed towards a uniform distribution so that very low probabilities are more homogenized:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tilde{p_i}(a) = (1-\tau _v) p_i(a) + \frac{\tau _v}{q} \end{aligned}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _v$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq46.gif"/></alternatives></inline-formula> is a parameter controlling the amount of additive smoothing used. Final smoothed parameters <inline-formula id="IEq47"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{v_i}(a)$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq47.gif"/></alternatives></inline-formula> are retrieved by inverting the softmax function using the fact that <inline-formula id="IEq48"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{a=1}^{q} v_i(a) = 0$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq48.gif"/></alternatives></inline-formula> according to CCMpredPy’s gauge choice:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tilde{v_i}(a) = \log \tilde{p_i}(a) - \frac{1}{q} \sum _{b=1}^{q} \log \tilde{p_i}(b) \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par35">Summing up in one formula, each parameter <inline-formula id="IEq49"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i(a)$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq49.gif"/></alternatives></inline-formula> of the inferred Potts model is smoothed using the following function:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tilde{v_i}(a) &amp;= \log \left( (1-\tau _v) \frac{\exp (v_i(a))}{\sum _{b=1}^{q} \exp (v_i(b))} + \frac{\tau _v}{q} \right) \\ &amp;- \frac{1}{q} \sum _{c=1}^{q} \log \left( (1-\tau _v) \frac{\exp (v_i(c))}{\sum _{b=1}^{q} \exp (v_i(b))} + \frac{\tau _v}{q} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec7">
        <title>Diminishing contributions of anti-correlations</title>
        <p id="Par36">In theory, coupling values inside a <inline-formula id="IEq50"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq50.gif"/></alternatives></inline-formula> matrix are supposed to deviate positively or negatively from 0 to reflect a (direct) correlation or anti-correlation. In practice however, while input data can be sufficient to assert that two letters <italic>a</italic> and <italic>b</italic> are likely to be found together at positions <italic>i</italic> and <italic>j</italic>, deducing that they should not be found together at positions <italic>i</italic> and <italic>j</italic> requires more examples to have sufficient countings on all pairs of <italic>a</italic> and <italic>b</italic>. Considering that our data set is limited, a large number of spurious anti-correlations can arise from a mere lack of data.</p>
        <p id="Par37">Since positive correlations are more likely to be supported by available training sample than negative ones, our approach here is to skew the coupling value distribution inside each <inline-formula id="IEq51"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq51.gif"/></alternatives></inline-formula> matrix to favor higher, positive values.</p>
        <p id="Par38">To do this, we extract each coupling matrix probability distribution as for the fields, only with a different softmax base <inline-formula id="IEq52"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _w$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq52.gif"/></alternatives></inline-formula>, chosen so that the extracted distribution is skewed towards higher probabilities and, as for the fields, smooth it towards a uniform distribution to lessen noise, which gives:<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \tilde{w_{ij}}(a,b) = \frac{1}{\beta _w} \left( \log \left( (1-\tau _w) \frac{\exp (\beta _w w_{ij}(a,b))}{\sum _{c=1}^{q} \sum _{d=1}^{q} \exp (\beta _w w_{ij}(c,d))} + \frac{\tau _w}{q^2} \right) \right.   \\ \left. - \frac{1}{q^2} \sum _{e=1}^{q} \sum _{f=1}^{q} \log \left( (1-\tau _w) \frac{\exp (\beta _w w_{ij}(e,f))}{\sum _{c=1}^{q} \sum _{d=1}^{q} \exp (\beta _w w_{ij}(c,d))} + \frac{\tau _w}{q^2} \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M136" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mfrac><mml:mfenced open="("><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mfenced close=")"><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par39">Using this smoothing scheme on each input Potts model make them more comparable since the most significant information stands out while sampling variations are tuned down.</p>
        <p id="Par40">This strategy was implemented to compensate for the impossibility to add pseudo-counts when inferring models with methods based on pseudo-likelihood, such as CCMpredPy, which we selected for its smart prior on the field parameters. For future experiments, we are hoping to find an inference method with the same prior and allowing us to add pseudo-counts on the single and the double frequencies. This smoothing strategy will then probably no longer be needed.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Alignment of Potts models</title>
      <p id="Par41">This section introduces our method for aligning two Potts models. The function we designed to score a given alignment is described and constraints ensuring that the alignment is proper are added as in Wohlers et al. [<xref ref-type="bibr" rid="CR17">17</xref>], resulting in an Integer Linear Programming formulation that can be optimized using their efficient solver.</p>
      <sec id="Sec9">
        <title>Scoring function</title>
        <p id="Par42">Basically, the best alignment between two Potts models <inline-formula id="IEq53"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A=({\boldsymbol{v}}^A,{\boldsymbol{w}}^A)$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:mrow><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B=({\boldsymbol{v}}^B,{\boldsymbol{w}}^B)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:mrow><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq54.gif"/></alternatives></inline-formula> of lengths <inline-formula id="IEq55"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_A$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_B$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq56.gif"/></alternatives></inline-formula> is defined as the alignment which maximizes the similarity between aligned fields and aligned couplings. Formally, this means finding the values of the binary variables <inline-formula id="IEq57"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ik}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq57.gif"/></alternatives></inline-formula> where <inline-formula id="IEq58"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ik}=1$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq58.gif"/></alternatives></inline-formula> iff position <italic>i</italic> in Potts model <italic>A</italic> is aligned with position <italic>k</italic> in Potts model <italic>B</italic> so as to maximize:<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s(A,B) = \sum _{i=1}^{L_A} \sum _{k=1}^{L_B}s_v\left( v_i^A, v_k^B\right) x_{ik} &amp;+ \alpha _w \sum _{i=1}^{L_A-1} \sum _{j=i+1}^{L_A} \sum _{k=1}^{L_B-1} \sum _{l=k+1}^{L_B} s_w\left( w^A_{ij}, w^B_{kl}\right) y_{ikjl} \end{aligned}$$\end{document}</tex-math><mml:math id="M150" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mfenced><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mfenced><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikjl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq59"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{ikjl}=x_{ik}x_{jl}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikjl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq59.gif"/></alternatives></inline-formula>, <inline-formula id="IEq60"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_v(v_i^A,v_k^B)$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_w(w_{ij}^A,w_{kl}^B)$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq61.gif"/></alternatives></inline-formula> are similarity scores, respectively between positional parameters <inline-formula id="IEq62"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i^A$$\end{document}</tex-math><mml:math id="M158"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_k^B$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq63.gif"/></alternatives></inline-formula> and coupling parameters <inline-formula id="IEq64"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}^A$$\end{document}</tex-math><mml:math id="M162"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{kl}^B$$\end{document}</tex-math><mml:math id="M164"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq65.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq66"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _w$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi>α</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq66.gif"/></alternatives></inline-formula> is a coefficient ensuring proper balance between positional and coupling score.</p>
        <p id="Par43">To measure the similarity between vectors, the scalar product is a natural candidate. We propose thus to measure the similarity <inline-formula id="IEq67"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_v(v_i^A, v_k^B)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq67.gif"/></alternatives></inline-formula> between field parameters using:<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \langle v_i^A, v_k^B \rangle = \sum _{a=1}^q v_i^A(a) v_k^B(a) \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>and to measure the similarity <inline-formula id="IEq68"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_w(w^A_{ij}, w^B_{kl})$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq68.gif"/></alternatives></inline-formula> between coupling parameters by the extension of the scalar product to matrices, the Frobenius inner product:<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \langle w_{ij}^A, w_{kl}^B \rangle = \sum _{a=1}^q \sum _{b=1}^q w_{ij}^A(a,b) w_{kl}^B(a,b) \end{aligned}$$\end{document}</tex-math><mml:math id="M174" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par44">Note that this scoring function for two Potts models naturally generalizes the score of a sequence <italic>x</italic> for a given Potts model since its energy can be computed as:<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {H}}(x|{\boldsymbol{v}},{\boldsymbol{w}}) = - \left( \sum _{i=1}^L v_i(x_i) + \sum _{i=1}^{L-1} \sum _{j=i+1}^L w_{ij}(x_i,x_j) \right) &amp;= - \left( \sum _{i=1}^L \langle v_i, e_{x_i} \rangle + \sum _{i=1}^{L-1} \sum _{j=i+1}^L \langle w_{ij}, e_{x_i x_j} \rangle \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M176" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>where<list list-type="bullet"><list-item><p id="Par45"><inline-formula id="IEq69"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{x_i}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mi>e</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq69.gif"/></alternatives></inline-formula> is the vector defined by <inline-formula id="IEq70"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall a \in [1..q], e_{x_i}(a) = \delta (a, x_i)$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq70.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par46"><inline-formula id="IEq71"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{x_ix_j}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq71.gif"/></alternatives></inline-formula> is the matrix defined by <inline-formula id="IEq72"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall (a,b) \in [1..q]^2, e_{x_ix_j}(a,b) = \delta (a,x_i)\delta (b,x_j)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mo>∀</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq72.gif"/></alternatives></inline-formula></p></list-item></list>Inspired by sequence alignment methods which use log-odds ratios to compute their scores with respect to a background model, we remove the background field <inline-formula id="IEq73"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_0$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq73.gif"/></alternatives></inline-formula> defined in Eq. (<xref rid="Equ10" ref-type="">10</xref>) to each field vector before computing the scalar product. The actual similarity score between two positional parameters <inline-formula id="IEq74"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i^A$$\end{document}</tex-math><mml:math id="M188"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_k^B$$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq75.gif"/></alternatives></inline-formula> used in this paper is thus:<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s_v\left( v_i^A,v_k^B\right) = \langle v_i^A - v_0, v_k^B - v_0 \rangle \end{aligned}$$\end{document}</tex-math><mml:math id="M192" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>while the similarity score between two coupling parameters <inline-formula id="IEq76"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{ij}^A$$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{kl}^B$$\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq77.gif"/></alternatives></inline-formula> remains:<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s_w(w_{ij}^A, w_{kl}) = \langle w_{ij}^A, w_{kl}^B \rangle \end{aligned}$$\end{document}</tex-math><mml:math id="M198" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec10">
        <title>Optimizing score with respect to constraints</title>
        <p id="Par47">Naturally, the scoring function should be maximized with respect to constraints ensuring that the alignment is proper. In that perspective, we build on the work of Wohlers et al. [<xref ref-type="bibr" rid="CR17">17</xref>], initially dedicated to protein structure alignment, to propose an Integer Linear Programming formulation for the Potts model alignment problem.</p>
        <p id="Par48">Let us first introduce necessary definitions and notations following [<xref ref-type="bibr" rid="CR17">17</xref>] to define a proper alignment.</p>
        <p id="Par49">The <italic>alignment graph</italic> of two Potts models <italic>A</italic> and <italic>B</italic> of lengths <inline-formula id="IEq78"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_A$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq78.gif"/></alternatives></inline-formula> and <inline-formula id="IEq79"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_B$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq79.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq80"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_A \times L_B$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq80.gif"/></alternatives></inline-formula> grid graph where rows (from bottom to top) represent positions in <italic>A</italic> and columns (from left to right) represent positions in <italic>B</italic>. A node <italic>i</italic>.<italic>k</italic> in the alignment graph represents the alignment of node <italic>i</italic> from Potts model <italic>A</italic> and node <italic>k</italic> from Potts model <italic>B</italic>. Directed edges (<italic>i</italic>.<italic>k</italic>, <italic>j</italic>.<italic>l</italic>) are drawn for <inline-formula id="IEq81"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt;j$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&lt;l$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq82.gif"/></alternatives></inline-formula>. In this framework, an alignment of <italic>n</italic> positions in the two Potts models is represented by a set of nodes <inline-formula id="IEq83"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{i_1.k_1, \ldots , i_n.k_n\}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq83.gif"/></alternatives></inline-formula> where <inline-formula id="IEq84"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_1&lt; \cdots &lt; i_n$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq84.gif"/></alternatives></inline-formula> and <inline-formula id="IEq85"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_1&lt; \cdots &lt; k_n$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq85.gif"/></alternatives></inline-formula>, termed <italic>increasing path</italic>.</p>
        <p id="Par50">In order to properly set constraints on the alignment, two additional node sets are defined: <inline-formula id="IEq86"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {row}_{ik}(j)$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:msub><mml:mtext>row</mml:mtext><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq86.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq87"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {col}_{ik}(l)$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msub><mml:mtext>col</mml:mtext><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq87.gif"/></alternatives></inline-formula>) is the maximal set of nodes in the alignment graph that are tails of edges with head at <italic>i</italic>.<italic>k</italic> or heads of edges with tail at <italic>i</italic>.<italic>k</italic>, that contain at least one node at row <italic>j</italic> (resp. column <italic>l</italic>), and that <italic>mutually contradict</italic>, i.e. no two of them lie on an increasing path.</p>
        <p id="Par51">To cast the alignment problem into an ILP, binary variables <inline-formula id="IEq88"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ik}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq88.gif"/></alternatives></inline-formula> are assigned to each node <italic>i</italic>.<italic>k</italic> in the alignment graph, with <inline-formula id="IEq89"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ik}=1$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq89.gif"/></alternatives></inline-formula> if position <italic>i</italic> in Potts model <italic>A</italic> and position <italic>k</italic> in Potts model <italic>B</italic> are aligned, and similarly a binary variable <inline-formula id="IEq90"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{ikjl}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikjl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq90.gif"/></alternatives></inline-formula> is assigned to each edge in the alignment graph where <inline-formula id="IEq91"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{ikjl}=1$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikjl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq91.gif"/></alternatives></inline-formula> if edge (<italic>i</italic>.<italic>k</italic>, <italic>j</italic>.<italic>l</italic>) is activated.</p>
        <p id="Par52">Given notations above, the alignment of two Potts models <italic>A</italic> and <italic>B</italic> of lengths <inline-formula id="IEq92"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_A$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq92.gif"/></alternatives></inline-formula> and <inline-formula id="IEq93"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_B$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq93.gif"/></alternatives></inline-formula> and parameters <inline-formula id="IEq94"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(v^A, w^A)$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi>A</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq94.gif"/></alternatives></inline-formula>, <inline-formula id="IEq95"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(v^B,w^B)$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi>B</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq95.gif"/></alternatives></inline-formula> can be formulated as the following Integer Linear Programming problem:<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\text {max} \quad \sum _{i=1}^{L_A} \sum _{k=1}^{L_B} s_v\left( v_i^A, v_k^B \right) x_{ik} + \alpha _w \sum _{i=1}^{L_A-1} \sum _{j=i+1}^{L_A} \sum _{k=1}^{L_B-1} \sum _{l=k+1}^{L_B} s_w\left( w_{ij}^A, w_{kl}^B\right) y_{ikjl} \end{aligned}$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>max</mml:mtext><mml:mspace width="1em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mfenced><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mfenced><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikjl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\text {s.t.} \quad x_{ik} \ge \sum _{r.s \in \textit{row}_{ik}(j)} y_{ikrs} \quad j \in [i+1,L_A], i \in [1,L_A-1], k \in [1, L_B-1] \end{aligned}$$\end{document}</tex-math><mml:math id="M238" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>s.t.</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="italic">row</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikrs</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x_{ik} \ge \sum _{r.s \in \textit{col}_{ik}(l)} y_{ikrs} \quad l \in [k+1,L_B], i \in [1, L_A-1], k \in [1,L_B-1] \end{aligned}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="italic">col</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ikrs</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x_{ik} \ge \sum _{r.s \in \textit{row}_{ik}(j)} y_{rsik} \quad j \in [1,i-1], i \in [2,L_A], k \in [2,L_B] \end{aligned}$$\end{document}</tex-math><mml:math id="M242" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="italic">row</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">rsik</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x_{ik} \ge \sum _{r.s \in \textit{col}_{ik}(l)} y_{rsik} \quad l \in [1,k-1], i \in [2,L_A], k \in [2,L_B] \end{aligned}$$\end{document}</tex-math><mml:math id="M244" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="italic">col</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">rsik</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x_{ik} \le \sum _{\begin{array}{c} r.s \in \textit{row}_{ik}(j) \\ s(A_{ri},B_{sk}) \le 0 \end{array}} (y_{rsik}-x_{rs}) +1 \quad j \in [1,i-1], i \in [2,L_A], k \in [2,L_B] \end{aligned}$$\end{document}</tex-math><mml:math id="M246" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="italic">row</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">ri</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">rsik</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">rs</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ29"><label>29</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\sum _{l=1}^k x_{il} + \sum _{j=1}^{i-1} x_{jk} \le 1 \quad i \in [1,L_A], k \in [1,L_B] \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ30"><label>30</label><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x, y \textit{ binary} \end{aligned}$$\end{document}</tex-math><mml:math id="M250" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mspace width="4pt"/><mml:mi mathvariant="italic">binary</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par53">Constraints (<xref rid="Equ24" ref-type="">24</xref>) and (<xref rid="Equ25" ref-type="">25</xref>) prevent edges from activating if their tails are not activated and ensure that heads of edges with a common tail do not contradict, and constraints (<xref rid="Equ26" ref-type="">26</xref>) and (<xref rid="Equ27" ref-type="">27</xref>) denote the reverse situation. Constraint (<xref rid="Equ28" ref-type="">28</xref>) ensures that edges are activated if their heads and tails are activated (this constraint is necessary since similarity scores can be negative). Finally, constraint (<xref rid="Equ29" ref-type="">29</xref>) ensures that the nodes lie on an increasing path.</p>
        <p id="Par54">A major asset of the solver is that it can yield the exact solution of this ILP, or a solution within a chosen epsilon range of the exact one, in tractable time. Desired precision of the optimization can be set by the parameter <inline-formula id="IEq96"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M252"><mml:mi>ϵ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq96.gif"/></alternatives></inline-formula>, ensuring that <inline-formula id="IEq97"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frac{2(\text {UB}-\text {LB})}{s(A,A)+s(B,B)} \le \epsilon }$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mtext>UB</mml:mtext><mml:mo>-</mml:mo><mml:mtext>LB</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq97.gif"/></alternatives></inline-formula> where <inline-formula id="IEq98"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {UB}$$\end{document}</tex-math><mml:math id="M256"><mml:mtext>UB</mml:mtext></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq98.gif"/></alternatives></inline-formula> and <inline-formula id="IEq99"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {LB}$$\end{document}</tex-math><mml:math id="M258"><mml:mtext>LB</mml:mtext></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq99.gif"/></alternatives></inline-formula> are the upper and lower bounds guaranteed by the solver for the solution, to avoid unnecessary optimization steps (the precision can be sufficient for the task) and speed up the search (often the last optimization steps only contribute to tighten the bounds while the optimal solution is already found).</p>
      </sec>
      <sec id="Sec11">
        <title>Gap cost and offset</title>
        <p id="Par55">As in [<xref ref-type="bibr" rid="CR17">17</xref>], an affine gap cost function can be added to the score function to account for insertions and deletions in the sequences, with the appropriate choice of a gap open and a gap extend penalties.</p>
        <p id="Par56">Furthermore, as in most profile-profile methods [<xref ref-type="bibr" rid="CR35">35</xref>], in order to prevent our method from greedily aligning every position, we penalize each aligned pair with a fixed negative offset hyperparameter.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Data</title>
      <p id="Par57">To evaluate PPalign and the contribution of distant dependencies, we focused on reference alignments based on structures with low sequence identity. We opted for SISYPHUS database [<xref ref-type="bibr" rid="CR22">22</xref>] since it provides manually curated structural alignments for proteins with non-trivial relationships. Our data set was built as follows:<list list-type="bullet"><list-item><p id="Par58">From each multiple sequence alignment in SISYPHUS, every possible pairwise sequence alignment with a sequence identity lower than <inline-formula id="IEq100"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20\%$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq100.gif"/></alternatives></inline-formula> was extracted (we set a low sequence identity threshold to focus on harder targets)</p></list-item><list-item><p id="Par59">For each sequence in each of these extracted pairwise reference alignments, we attempted to build a Potts model with the workflow previously described. Sequences that had less than 1000 <inline-formula id="IEq101"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$80\%$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq101.gif"/></alternatives></inline-formula> non-redundant homologs were discarded to focus on sequences with sufficient co-evolution signal. Due to CCMpredPy memory consumption, trimmed MSAs whose length was longer than 200 also had to be discarded.</p></list-item><list-item><p id="Par60">Finally, for each reference multiple sequence alignment in SISYPHUS with more than two of such eligible sequences, a reference sequence pair was randomly selected. This last steps discards many alignment pairs but ensures that no multiple sequence alignment biases the results.</p></list-item></list>This resulted in a set of 33 non-redundant reference pairwise alignments which was randomly split into a train set of 11 alignments on which our hyperparameters were trained (see Table <xref rid="Tab1" ref-type="table">1</xref>) and a test set of 22 target alignments (see Table <xref rid="Tab2" ref-type="table">2</xref>).</p>
      <p id="Par61">The overall workflow to align two protein sequences with our method and the evaluation procedure for each reference MSA are respectively summarized in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Potts to Potts alignment of two sequences workflow. Coevolution information is obtained for each sequence by retrieving close homologs, and Potts models are inferred on the corresponding multiple sequence alignments. PPalign computes the optimal alignment of the two Potts models, thereby providing an alignment of the two initial sequences</p></caption><graphic xlink:href="12859_2021_4222_Fig2_HTML" id="MO32"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Overview of evaluation procedure for a reference MSA. A reference pairwise sequence alignment is (randomly) extracted from a reference MSA in SISYPHUS. The two sequences are then aligned by PPalign with the workflow previously introduced, and the alignment is compared with the reference alignment in terms of precision, recall and <inline-formula id="IEq102"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq102.gif"/></alternatives></inline-formula> score</p></caption><graphic xlink:href="12859_2021_4222_Fig3_HTML" id="MO33"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Training set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">MSA</th><th align="left">Sequences</th><th align="left">Sequence identity (%)</th></tr></thead><tbody><tr><td align="left">AL10050464</td><td align="left">1r5bA_559_659, 1r5bA_470_549</td><td align="left">3.85</td></tr><tr><td align="left">AL00053697</td><td align="left">1vimA_36_164, 1iatA_334_500</td><td align="left">4.04</td></tr><tr><td align="left">AL00063412</td><td align="left">1bccA_34_201, 1ezvB_236_357</td><td align="left">5.59</td></tr><tr><td align="left">AL00051306</td><td align="left">1ay9A_51_137, 1b12A_81_302</td><td align="left">6.28</td></tr><tr><td align="left">AL00052113</td><td align="left">1kzyC_1731_1838, 1in1A_853_916</td><td align="left">8.60</td></tr><tr><td align="left">AL10069117</td><td align="left">1kncA_13_172, 2gmyA_14_141</td><td align="left">9.09</td></tr><tr><td align="left">AL00050815</td><td align="left">1i4uA_33_167, 1np1A_21_166</td><td align="left">10.00</td></tr><tr><td align="left">AL00054790</td><td align="left">1vig_10_72, 1k1gA_136_223</td><td align="left">11.36</td></tr><tr><td align="left">AL00054403</td><td align="left">4monA_6_47, 1roaA_23_119</td><td align="left">13.33</td></tr><tr><td align="left">AL00048098</td><td align="left">1cmzA_90_199, 1omwA_54_168</td><td align="left">13.91</td></tr><tr><td align="left">AL00089800</td><td align="left">1p6oA_10_147, 1wkqA_2_150</td><td align="left">17.88</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Test set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">MSA</th><th align="left">Sequences</th><th align="left">Sequence identity (%)</th></tr></thead><tbody><tr><td align="left">AL00050475</td><td align="left">1ci0A_43_200, 1uscA_12_145</td><td align="left">3.61</td></tr><tr><td align="left">AL00050692</td><td align="left">1uheA_11_87, 1q16A_1084_1225</td><td align="left">4.14</td></tr><tr><td align="left">AL10050815</td><td align="left">1exsA_17_124, 1qftA_27_139</td><td align="left">5.04</td></tr><tr><td align="left">AL10050875</td><td align="left">1rbp_19_140, 1hms_3_131</td><td align="left">5.19</td></tr><tr><td align="left">AL00050715</td><td align="left">1dfuP_2_94, 1qtqA_340_541</td><td align="left">5.22</td></tr><tr><td align="left">AL00055723</td><td align="left">1tu1A_1_140, 1v2bB_18_186</td><td align="left">5.81</td></tr><tr><td align="left">AL00050799</td><td align="left">1pklA_88_180, 1o65A_12_173</td><td align="left">6.02</td></tr><tr><td align="left">AL00074653</td><td align="left">1tolA_151_213, 1ihrA_172_230</td><td align="left">6.15</td></tr><tr><td align="left">AL10063410</td><td align="left">1qf6A_68_223, 1hr6B_48_215</td><td align="left">6.29</td></tr><tr><td align="left">AL00053335</td><td align="left">1ri5A_51_291, 1nv8A_106_279</td><td align="left">7.43</td></tr><tr><td align="left">AL10050155</td><td align="left">1k32A_764_851, 1lcyA_228_321</td><td align="left">9.62</td></tr><tr><td align="left">AL10050335</td><td align="left">1h9mA_5_141, 1v43A_247_366</td><td align="left">10.22</td></tr><tr><td align="left">AL10074933</td><td align="left">1k32A_763_852, 1te0A_257_349</td><td align="left">10.68</td></tr><tr><td align="left">AL00052141</td><td align="left">1mwiA_9_163, 1oe4A_87_277</td><td align="left">11.48</td></tr><tr><td align="left">AL20089447</td><td align="left">1z0rA_8_48, 1n0gA_33_142</td><td align="left">12.93</td></tr><tr><td align="left">AL00047241</td><td align="left">1tjoA_29_171, 1lb3A_15_153</td><td align="left">13.01</td></tr><tr><td align="left">AL00054814</td><td align="left">1egaB_197_282, 1hh2P_199_275</td><td align="left">13.40</td></tr><tr><td align="left">AL00050021</td><td align="left">1jm1A_57_211, 1nykA_54_191</td><td align="left">14.61</td></tr><tr><td align="left">AL00047861</td><td align="left">1m12A_3_74, 1n69B_2_73</td><td align="left">15.38</td></tr><tr><td align="left">AL00052441</td><td align="left">1c30A_7_127, 1w93A_59_184</td><td align="left">15.38</td></tr><tr><td align="left">AL00054407</td><td align="left">1eqkA_11_95, 2ch9A_38_144</td><td align="left">15.74</td></tr><tr><td align="left">AL00052787</td><td align="left">5pnt_5_155, 1jl3A_3_137</td><td align="left">17.72</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>Alignment evaluation metrics</title>
      <p id="Par62">Alignment quality with respect to SISYPHUS’ reference alignments is assessed by computing alignment precision:<disp-formula id="Equ31"><label>31</label><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P=\frac{{\# \,correctly\,aligned\,pairs}}{{\# \,aligned\, pairs \,in \,computed \,alignment}} \end{aligned}$$\end{document}</tex-math><mml:math id="M266" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula>and recall:<disp-formula id="Equ32"><label>32</label><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R=\frac{{\# \,correctly \,aligned \,pairs}}{{\# \,aligned\, pairs \,in \,reference \,alignment}} \end{aligned}$$\end{document}</tex-math><mml:math id="M268" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>using Edgar’s qscore program [<xref ref-type="bibr" rid="CR36">36</xref>] v2.1, and <inline-formula id="IEq103"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq103.gif"/></alternatives></inline-formula> score:<disp-formula id="Equ33"><label>33</label><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F_1=\frac{2PR}{P+R} \end{aligned}$$\end{document}</tex-math><mml:math id="M272" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>P</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4222_Article_Equ33.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec14">
      <title>PPalign’s hyperparameters</title>
      <p id="Par63">PPalign’s hyperparameters were optimized in a supervised fashion on the 11 alignments from the training set using Hyperopt library [<xref ref-type="bibr" rid="CR37">37</xref>] to maximize the <inline-formula id="IEq104"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq104.gif"/></alternatives></inline-formula> score. This process showed to be excessively time-consuming, Hyperopt being unable to show a convergence on the choice of the parameters after one month. In order to reduce the hyperparameter search space and speed up the convergence of this process, we had to arbitrarily set some parameters after some trials on the training set: precision <inline-formula id="IEq105"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M276"><mml:mi>ϵ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq105.gif"/></alternatives></inline-formula> was set to 0.02, <inline-formula id="IEq106"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _v$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq106.gif"/></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _w$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>τ</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq107.gif"/></alternatives></inline-formula> from Eqs. (<xref rid="Equ15" ref-type="">15</xref>) and (<xref rid="Equ16" ref-type="">16</xref>) were both set to 0.4 and the gap extend penalty was set to 0. In accordance with the expected NP-hardness of the pairwise Potts model alignment problem, time needed to find optimal alignment could be very long for some sets of parameters and even exceed the 6 hours time-out we set. We observed yet that good alignments were usually already found in less than 1 minute and decided to set the time-out by alignment to this value to speed-up more the optimisation of the remaining parameters by Hyperopt, which yielded the following values:<list list-type="bullet"><list-item><p id="Par64">Gap open penalty: 13</p></list-item><list-item><p id="Par65">Coupling contribution coefficient <inline-formula id="IEq108"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _w$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>α</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq108.gif"/></alternatives></inline-formula>: 6</p></list-item><list-item><p id="Par66">Softmax base <inline-formula id="IEq109"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _w$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>β</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq109.gif"/></alternatives></inline-formula>: 8.0</p></list-item><list-item><p id="Par67">Offset <inline-formula id="IEq110"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M286"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq110.gif"/></alternatives></inline-formula>: 1.0</p></list-item></list></p>
    </sec>
    <sec id="Sec15">
      <title>Other methods to be compared</title>
      <p id="Par68">In this experiment, we compared the results of PPalign with HHalign, the core alignment method of the state-of-the-art remote homology detection method HHsearch. We ran HHalign v3.0.3 with default options to align pHMMs built with HHmake with default options from the MSAs used to infer Potts models (except for the trimming of the positions with <inline-formula id="IEq111"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;50\%$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq111.gif"/></alternatives></inline-formula> gaps since pHMMs handle well insertions and deletions).</p>
      <p id="Par69">To assess the contribution of direct couplings in sequence alignment, we also used PPalign to compute alignments of independent-site Potts models (i.e. Potts models where positions are assumed to be independent, thus without coupling parameters) with the same hyperparameters (termed “<italic>independent-site PPalign</italic>”).</p>
      <p id="Par70">We also ran BLASTp v2.9.0+ without E-value cutoff on the sequences truncated as in our training MSAs to provide an indication on the sequences’ similarity.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Tractable computation time</title>
      <p id="Par71">We examined the computation times of PPalign, independent-site PPalign and HHalign, considering the time they took to align the models (and not the steps to build them, that can be done offline) of the sequence pairs from the test set. Experiments were run on a Debian9 virtual machine with 4 VCPUs (2.3 GHz) and 8 GB RAM. The timeout for each alignment was set to 6 hours.</p>
      <p id="Par72">The first result is that all the alignments could be computed by PPalign in running times ranging from 5 seconds to 6 minutes, with an average of 1 min 36. Figure <xref rid="Fig4" ref-type="fig">4</xref>a plots the running times with respect to the lengths of the models to align. It shows that most problems (17/22) are easily solved and that running time for these problems increases gently with the lengths of the models, while a few (5/22) other problems stand out from this majority trend but are still solved in a few minutes.</p>
      <p id="Par73">When couplings are not considered, the problem is fundamentally easier and running times of HHalign and independent-site PPalign are significantly faster than PPalign: both programs were able to compute each optimal positional alignment in less than 1 second. The running times of HHalign and independent-site PPalign are plotted in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, c . The two plots are not completely comparable since time needed to load the models is here included for HHalign and not for independent-site PPalign, but they illustrate the difference between the dynamic programming approach of HHalign, with a steady running time increment with the length of the models, and the Integer Linear Programming optimization approach of independent-site PPalign, showing here 2 outliers with respect to the general tendency.<fig id="Fig4"><label>Fig. 4</label><caption><p>Time for aligning models of lengths <inline-formula id="IEq112"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_A$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq112.gif"/></alternatives></inline-formula> and <inline-formula id="IEq113"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_B$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq113.gif"/></alternatives></inline-formula> for sequence pairs from test set</p></caption><graphic xlink:href="12859_2021_4222_Fig4_HTML" id="MO37"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Alignment quality</title>
      <p id="Par74">Alignment quality was assessed by comparing the alignment obtained by the different methods for the 22 sequences pairs in the test set to their reference alignment.</p>
      <p id="Par75">Overall, PPalign achieves a better <inline-formula id="IEq114"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq114.gif"/></alternatives></inline-formula> score than HHalign (0.600 versus 0.578) with a better recall (0.613 vs 0.533) but a lower precision (0.587 vs 0.661), outperforming it in 12 out of the 22 alignments. BLAST only aligned 4 out of the 22 pairs, yielding an average <inline-formula id="IEq115"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq115.gif"/></alternatives></inline-formula> score of 0.113.</p>
      <p id="Par76">Results for each sequence pair of the test set are displayed in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and one example where couplings were particularly helpful in the alignment is discussed Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Quality of the alignments computed by PPalign, independent-site PPalign, HHalign and BLAST with respect to target reference alignments in test set (ordered by increasing percentage of sequence identity)</p></caption><graphic xlink:href="12859_2021_4222_Fig5_HTML" id="MO38"/></fig></p>
      <p id="Par77">In most cases, PPalign and HHalign yield similar <inline-formula id="IEq116"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq116.gif"/></alternatives></inline-formula> scores (with less than 0.1 difference), except for 8 sequence pairs. 5 of them, marked by blue dots in the Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, are significantly better aligned by PPalign: AL00050475, AL00050692, AL10050875, AL00050715 and AL00050799 which are among the 7 alignments with the smallest percentage of sequence identity with respectively <inline-formula id="IEq117"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.61\%$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mn>3.61</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq117.gif"/></alternatives></inline-formula>, <inline-formula id="IEq118"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.04\%$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mn>5.04</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq118.gif"/></alternatives></inline-formula>, <inline-formula id="IEq119"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.19\%$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mn>5.19</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq119.gif"/></alternatives></inline-formula>, <inline-formula id="IEq120"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.22\%$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mn>5.22</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$6.02\%$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mn>6.02</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq121.gif"/></alternatives></inline-formula>. AL10050875 and AL00050715 are part with AL10063410 of the three sequence pairs that HHalign fails completely to align, yielding small and incorrect alignments with an <inline-formula id="IEq122"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq122.gif"/></alternatives></inline-formula> score of 0. On AL10063410, PPalign also failed, but on AL10050875 and AL00050715 it was able to do a bit better than HHalign by correctly aligning in each case roughly a fifth of the target alignment while still being wrong on the four other fifths. On AL00050475 and AL00050692, PPalign successfully retrieves about half of the target alignments when HHalign was retrieving only respectively a fifth and a third of it. The contribution of the coupling parameters is particularly noticeable for AL00050799, PPalign correctly retrieving almost <inline-formula id="IEq123"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$70\%$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mn>70</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq123.gif"/></alternatives></inline-formula> of the alignment while HHalign retrieves only <inline-formula id="IEq124"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20\%$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq124.gif"/></alternatives></inline-formula> of it (see detailed analysis in Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Illustration of the contribution of couplings for the alignment of 1o65A_12_173 and 1pklA_88_180 sequences</p></caption><graphic xlink:href="12859_2021_4222_Fig6_HTML" id="MO39"/></fig></p>
      <p id="Par78">PPalign is significantly outperformed by HHalign on 3 pairs, marked by yellow dots in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b. On AL00053335 (<inline-formula id="IEq125"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7.43\%$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mn>7.43</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq125.gif"/></alternatives></inline-formula> sequence identity), PPalign suffers from its tendency to align too many positions: like HHalign it correctly aligns half of the target alignment, but it proposes a longer alignment than HHalign, making its precision drop to around <inline-formula id="IEq126"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$40\%$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq126.gif"/></alternatives></inline-formula> when HHalign stays around <inline-formula id="IEq127"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\%$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mn>60</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq127.gif"/></alternatives></inline-formula>. The two other pairs are AL00050021 and AL00052441 with respectively <inline-formula id="IEq128"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$14.61\%$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mn>14.61</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$15.38\%$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:mn>15.38</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq129.gif"/></alternatives></inline-formula> sequence identity allowing HHalign to correctly align <inline-formula id="IEq130"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\%$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:mn>60</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq130.gif"/></alternatives></inline-formula> of the target alignment. On AL00052441, PPalign correctly aligns more than <inline-formula id="IEq131"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$50\%$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq131.gif"/></alternatives></inline-formula> of the target alignment but the main difference comes here again from the precision (0.58 vs 0.81). Results on AL00050021 are clearly in favour of HHalign with an <inline-formula id="IEq132"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq132.gif"/></alternatives></inline-formula> score of 0.6 compared to 0.4 for PPalign and can be explained by the extremely gappy MSAs used to build the models (more than <inline-formula id="IEq133"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M332"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq133.gif"/></alternatives></inline-formula> positions in the reference alignment were trimmed).</p>
      <p id="Par79">Interestingly, PPalign without coupling score (independent-site PPalign) achieves an <inline-formula id="IEq134"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq134.gif"/></alternatives></inline-formula> score comparable to HHalign (0.580 vs 0.578) despite a poor handling of gaps by Potts models as opposed to pHMMs. Besides, while PPalign’s alignment is most of the time better with the coupling score, 2 sequence pairs were yet significantly better aligned by independent-site PPalign than by PPalign with couplings: on already discussed AL10050875, where it improves a bit the poor quality of the alignment by PPalign, but also on AL00089447 (<inline-formula id="IEq135"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12.93\%$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:mn>12.93</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq135.gif"/></alternatives></inline-formula> sequence identity) where it improves over the improvement of HHalign on PPalign.</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par80">Although the problem is very likely to be NP-hard since the threading problem is NP-hard [<xref ref-type="bibr" rid="CR38">38</xref>], these experiments demonstrate that PPalign yields optimal Potts to Potts alignments up to a precision <inline-formula id="IEq136"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M338"><mml:mi>ϵ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq136.gif"/></alternatives></inline-formula> in tractable time. These results have to be confirmed on bigger instances. For now, experimentation is limited by memory handling in CCMpredPy, which is currently the only inference method offering the features we require to infer comparable Potts models, but the current implementation of CCMpred [<xref ref-type="bibr" rid="CR30">30</xref>] shows that this type of inference can be optimized to handle significantly larger models. This should enable us to test larger alignments in the future. Based on our experimentation, we expect these alignments to be also tractable. This is surprising with respect to the NP-complete nature of the problem, but it seems that alignments of Potts models are not the hardest instances when they properly represent homologous proteins. We think that this depends yet on the choice of the parameters shaping the inference of Potts models and the similarity of the models to align: these questions deserve further studies to better understand the application scope of this method.</p>
    <p id="Par81">Regarding alignment quality, our results for the alignment of Potts models inferred using a pseudo-likelihood method designed for co-evolution prediction purposes are overall better than for the alignment of pHMMs by HHalign, with significant examples demonstrating how taking couplings into account can improve the alignment of remote homologous proteins, especially for lowest similarity alignments. There is still room for improvement in our method. We have noticed a tendency to align too many positions that can be corrected and our worst score with respect to HHalign is associated with very gappy train MSAs, indicating that augmenting Potts models with an appropriate gap handling strategy would undoubtedly improve our results. Above all, it is worth noting that independent-site PPalign finds sometimes a better alignment than PPalign, coupling matrices bringing more noise than assistance in these cases. To get better alignments, the priority is now is to work on more robust inference of Potts models, to make them more comparable and informative for homology search despite the relatively small size of training samples. We proposed here some ideas towards the inference of more canonical Potts models, with only the necessary couplings, as well as some post-processing steps, notably to smooth weights by simulated uniform pseudocounts. This later step allowed us to raise the average <inline-formula id="IEq137"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq137.gif"/></alternatives></inline-formula> score from 0.48 to 0.60, but we think that a more direct procedure would still be preferable. We are now searching for an efficient Potts model inference method that can be geared towards canonicity, providing the possibility to add pseudo-counts on the single and double amino acid counts – thus excluding methods based on pseudo-likelihood maximization – and being able to infer extended Potts models with an appropriate gap handling strategy. Besides, though the focus of this paper was the alignment of models inferred on pre-built multiple sequence alignments, it should be noted that the quality of the sequence alignments we provide strongly depends on the quality of their associated MSAs. The use of a suitable inference method will allow us to properly test this dependency on the method used to retrieve close homologs and on the chosen alignment depth in future experiments.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusion</title>
    <p id="Par82">While Potts models have been successfully used for contact prediction and other tasks on protein sequences, using coevolutionary information captured by direct coupling analysis to improve homology search by sequence alignment seems promising, but challenging. The main computational bottleneck is the hardness of alignments involving Potts models.</p>
    <p id="Par83">We presented here PPalign, our method for Potts model to Potts model alignment based on the introduction of an Integer Linear Programming formulation of the problem with an implementation relying on an efficient solver able to yield the optimal solution in tractable time. This initiates a new approach for remote homology search by alignment of Potts models inferred from close homologs, similarly to HHalign with the alignment of pHMMs but with the addition of long distance sequence correlations reflecting the 3D structure of proteins. In this approach, Potts models need to be comparable. As a basic principle for building canonical Potts models, we proposed to infer models with as much weight as possible on the positional parameters and to add only necessary weight on pairwise couplings. We also proposed a scheme for lessening the effects of small sample variations on the Potts model’s parameters.</p>
    <p id="Par84">To experimentally assess the feasibility and interest of the approach, we carefully selected a set of non-redundant reference pairwise alignments with low sequence identity and with enough close homologs for each aligned sequence to infer a Potts models. We carried out rigorous experimentation with a strict separation of data used to train hyperparameters of the method and data used to test its performances. Results on test alignments confirm that Potts models can be aligned in reasonable time (<inline-formula id="IEq138"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1'37''$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mn>37</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4222_Article_IEq138.gif"/></alternatives></inline-formula> in average) and that taking into account direct coupling information can improve sequence alignments, especially for remote homologs with lowest sequence identity.</p>
    <p id="Par85">Our experiments suggest that new research on the inference of Potts models could improve their usefulness for homology search. The approach would undoubtedly benefit from extending to Potts models the insertion/deletions modeling capacities as well as the efficient pseudocount schemes of pHMMs. Maybe a more difficult issue is to have guarantees on a canonical form or at least some robustness of inferred Potts models to make them more comparable. We hope that PPalign’s efficiency and optimality will help to perform unbiased investigations in these directions.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MSA</term>
        <def>
          <p id="Par4">Multiple sequence alignment</p>
        </def>
      </def-item>
      <def-item>
        <term>pHMM</term>
        <def>
          <p id="Par5">Profile Hidden Markov Model</p>
        </def>
      </def-item>
      <def-item>
        <term>ILP</term>
        <def>
          <p id="Par6">Integer Linear Programming</p>
        </def>
      </def-item>
      <def-item>
        <term>UB</term>
        <def>
          <p id="Par7">Upper bound</p>
        </def>
      </def-item>
      <def-item>
        <term>LB</term>
        <def>
          <p id="Par8">Lower bound</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to warmly thank Inken Wohlers for providing us with her code, Mathilde Carpentier for providing helpful scripts for alignment assessment and data since SISYPHUS database is temporarily unavailable, Susann Bader (nee Vorberg) for helpful discussion on CCMpredPy, and the GenOuest Bioinformatics platform for providing computing resources. We are also grateful to the reviewers for their insightful suggestions towards improving this paper.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>HT and FC devised the project and the main conceptual ideas. HT developed the theoretical formalism, carried out the implementation, built the benchmark and performed the experimentation. HT drafted the manuscript. HT and FC contributed to the final manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>HT is supported by a PhD grant from <italic>Ministére de l’Enseignement Supérieur et de la Recherche</italic> (MESR).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Software and data are available here: <ext-link ext-link-type="uri" xlink:href="https://www-dyliss.irisa.fr/ppalign">https://www-dyliss.irisa.fr/ppalign</ext-link></p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par86">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par87">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par88">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>1998</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>755</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Steinegger M, Meier M, Mirdita M, Voehringer H, Haunsberger SJ, Soeding J. HH-suite3 for fast remote homology detection and deep protein annotation. bioRxiv 560029;2019.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Socolich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lockless</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary information for specifying a protein fold</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <issue>7058</issue>
        <fpage>512</fpage>
        <pub-id pub-id-type="doi">10.1038/nature03991</pub-id>
        <pub-id pub-id-type="pmid">16177782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cowen</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Markov random fields reveal an n-terminal double beta-propeller motif as part of a bacterial hybrid two-component sensor system</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>9</issue>
        <fpage>4069</fpage>
        <lpage>4074</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0909950107</pub-id>
        <pub-id pub-id-type="pmid">20147619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniels</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Hosur</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cowen</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Smurflite: combining simplified Markov random fields with simulated evolution improves remote homology detection for beta-structural proteins into the twilight zone</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>9</issue>
        <fpage>1216</fpage>
        <lpage>1222</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts110</pub-id>
        <pub-id pub-id-type="pmid">22408192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniels</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Gallant</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramsey</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cowen</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>MRFy: remote homology detection for beta-structural proteins using Markov random fields and stochastic search</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2014</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>4</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2014.2344682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MRFalign: protein homology detection through alignment of markov random fields</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>1003500</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monastyrskyy</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>D’Andrea</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fidelis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tramontano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kryshtafovych</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>New encouraging developments in contact prediction: assessment of the casp 11 results</article-title>
        <source>Proteins Struct Funct Bioinform</source>
        <year>2016</year>
        <volume>84</volume>
        <fpage>131</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.24943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Szurmant</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hoch</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>1</issue>
        <fpage>67</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0805923106</pub-id>
        <pub-id pub-id-type="pmid">19116270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Figliuzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barrat-Charlaix</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>How pairwise coevolutionary models capture the collective residue variability in proteins?</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>1018</fpage>
        <lpage>1027</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy007</pub-id>
        <pub-id pub-id-type="pmid">29351669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Muntoni AP, Pagnani A, Weigt M, Zamponi F. Using direct coupling analysis for the protein sequences alignment problem. In: CECAM 2019—workshop on co-evolutionary methods for the prediction and design of protein structure and interactions; 2019.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Talibart H, Coste F. Using residues coevolution to search for protein homologs through alignment of Potts models. In: CECAM 2019—workshop on co-evolutionary methods for the prediction and design of protein structure and interactions; 2019.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilburn</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Remote homology search with hidden Potts models</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>11</issue>
        <fpage>1008085</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muntoni</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Pagnani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zamponi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Aligning biological sequences by exploiting residue conservation and coevolution</article-title>
        <source>Phys Rev E</source>
        <year>2020</year>
        <volume>102</volume>
        <issue>6</issue>
        <fpage>062409</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.102.062409</pub-id>
        <pub-id pub-id-type="pmid">33465950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohlers</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Andonov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Algorithm engineering for optimal alignment of protein structure distance matrices</article-title>
        <source>Optim Lett</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>421</fpage>
        <lpage>433</lpage>
        <pub-id pub-id-type="doi">10.1007/s11590-011-0313-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohlers</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Andonov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Dalix: optimal dali protein structure alignment</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2012</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>26</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2012.143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Protein structure comparison by alignment of distance matrices</article-title>
        <source>J Mol Biol</source>
        <year>1993</year>
        <volume>233</volume>
        <issue>1</issue>
        <fpage>123</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1993.1489</pub-id>
        <pub-id pub-id-type="pmid">8377180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andonov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malod-Dognin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yanev</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Maximum contact map overlap revisited</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2009.0196</pub-id>
        <pub-id pub-id-type="pmid">21210730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Lena</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Margara</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vassura</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast overlapping of protein contact maps by alignment of eigenvectors</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>18</issue>
        <fpage>2250</fpage>
        <lpage>2258</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq402</pub-id>
        <pub-id pub-id-type="pmid">20610612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pulim</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bienkowska</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optimal contact map alignment of protein-protein interfaces</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>20</issue>
        <fpage>2324</fpage>
        <lpage>2328</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn432</pub-id>
        <pub-id pub-id-type="pmid">18710876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andreeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prlić</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Murzin</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>Sisyphus-structural alignments for proteins with non-trivial relationships</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>suppl-1</issue>
        <fpage>253</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morcos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pagnani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lunt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zecchina</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Onuchic</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>49</issue>
        <fpage>1293</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1111471108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldassi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zamparo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Feinauer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Procaccini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zecchina</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pagnani</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate multivariate gaussian modeling of protein families: predicting residue contacts and protein-interaction partners</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>92721</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0092721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekeberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lövkvist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weigt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aurell</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer potts models</article-title>
        <source>Phys Rev E</source>
        <year>2013</year>
        <volume>87</volume>
        <issue>1</issue>
        <fpage>012707</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.87.012707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barton</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>De Leonardis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Coucke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cocco</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ace: adaptive cluster expansion for maximum entropy graphical model inference</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>20</issue>
        <fpage>3089</fpage>
        <lpage>3097</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw328</pub-id>
        <pub-id pub-id-type="pmid">27329863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <source>Probabilistic graphical models: principles and techniques</source>
        <year>2009</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Besag</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of non-lattice data</article-title>
        <source>J R Stat Soc Ser D (Stat)</source>
        <year>1975</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>179</fpage>
        <lpage>195</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Vorberg S. Bayesian statistical approach for protein residue-residue contact prediction. Ph.D. thesis, Ludwig-Maximilians-Universität; 2017</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seemayer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gruber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ccmpred-ast and precise prediction of protein residue-residue contacts from correlated mutations</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>21</issue>
        <fpage>3128</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu500</pub-id>
        <pub-id pub-id-type="pmid">25064567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Seemayer S. GitHub CCMpred—Frequently Asked Questions (FAQ). <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/CCMpred/wiki/FAQ">https://github.com/soedinglab/CCMpred/wiki/FAQ</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von den Driesch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galiez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>D1</issue>
        <fpage>170</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capella-Gutiérrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Silla-Martínez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>15</issue>
        <fpage>1972</fpage>
        <lpage>1973</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>
        <pub-id pub-id-type="pmid">19505945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Massar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cerf</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Rooman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Optimality of the genetic code with respect to protein stability and amino-acid frequencies</article-title>
        <source>Genome Biol</source>
        <year>2001</year>
        <volume>2</volume>
        <issue>11</issue>
        <fpage>0049</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2001-2-11-research0049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dunbrack</surname>
            <given-names>RL</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>Scoring profile-to-profile sequence alignments</article-title>
        <source>Protein Sci</source>
        <year>2004</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>1612</fpage>
        <lpage>1626</lpage>
        <pub-id pub-id-type="doi">10.1110/ps.03601504</pub-id>
        <pub-id pub-id-type="pmid">15152092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Edgar RC. Qscore. <ext-link ext-link-type="uri" xlink:href="http://www.drive5.com/qscore/">http://www.drive5.com/qscore/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Bergstra J, Yamins D, Cox DD. Making a science of model search: Hyperparameter optimization in hundreds of dimensions for vision architectures; 2013.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lathrop</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>The protein threading problem with sequence amino acid interaction preferences is NP-complete</article-title>
        <source>Protein Eng Des Sel</source>
        <year>1994</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>1059</fpage>
        <lpage>1068</lpage>
        <pub-id pub-id-type="doi">10.1093/protein/7.9.1059</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
