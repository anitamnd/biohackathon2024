<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD with MathML3 v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1-mathml3.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?noissn?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
    <journal-id journal-id-type="publisher-id">BIORXIV</journal-id>
    <journal-title-group>
      <journal-title>bioRxiv</journal-title>
    </journal-title-group>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8687460</article-id>
    <article-id pub-id-type="pmid">34931186</article-id>
    <article-id pub-id-type="doi">10.1101/2021.12.13.472454</article-id>
    <article-version-alternatives>
      <article-version article-version-type="status">preprint</article-version>
      <article-version article-version-type="number">1</article-version>
    </article-version-alternatives>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TopHap: Rapid inference of key phylogenetic structures from common haplotypes in large genome collections with limited diversity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Caraballo-Ortiz</surname>
          <given-names>Marcos A.</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
        <xref rid="FN1" ref-type="author-notes">x</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miura</surname>
          <given-names>Sayaka</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
        <xref rid="FN1" ref-type="author-notes">x</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sanderford</surname>
          <given-names>Maxwell</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dolker</surname>
          <given-names>Tenzin</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tao</surname>
          <given-names>Qiqing</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weaver</surname>
          <given-names>Steven</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pond</surname>
          <given-names>Sergei L. K.</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kumar</surname>
          <given-names>Sudhir</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
        <xref rid="A3" ref-type="aff">3</xref>
        <xref rid="CR1" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, PA 19122, USA,</aff>
    <aff id="A2"><label>2</label>Department of Biology, Temple University, Philadelphia, PA 19122, USA,</aff>
    <aff id="A3"><label>3</label>Center of Excellence in Genome Medicine Research, King Abdulaziz University, Saudi Arabia.</aff>
    <author-notes>
      <fn fn-type="other" id="FN1">
        <label>x</label>
        <p id="P1">Joint first authors.</p>
      </fn>
      <fn fn-type="con" id="FN2">
        <p id="P2">Author contributions</p>
        <p id="P3">S.K. and S.M developed the original method, designed research; and implemented the technique; M.A.C.O., S.M., T.D., and Q.T. performed analyses; S.P. and S.W. assembled sequence alignments; and S.K., S.M., M.A.C.O., Q.T., and S.P. wrote the paper.</p>
      </fn>
      <corresp id="CR1"><label>*</label>To whom correspondence should be addressed. <bold>Contact</bold>: <email>s.kumar@temple.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <elocation-id>2021.12.13.472454</elocation-id>
    <permissions>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyndlicense">https://creativecommons.org/licenses/by-nd/4.0/</ali:license_ref>
        <license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nd/4.0/">Creative Commons Attribution-NoDerivatives 4.0 International License</ext-link>, which allows reusers to copy and distribute the material in any medium or format in unadapted form only, and only so long as attribution is given to the creator. The license allows for commercial use.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf">nihpp-2021.12.13.472454.pdf</self-uri>
    <abstract id="ABS1">
      <sec id="S1">
        <title>Motivation:</title>
        <p id="P4">Building reliable phylogenies from very large collections of sequences with a limited number of phylogenetically informative sites is challenging because sequencing errors and recurrent/backward mutations interfere with the phylogenetic signal, confounding true evolutionary relationships. Massive global efforts of sequencing genomes and reconstructing the phylogeny of SARS-CoV-2 strains exemplify these difficulties since there are only hundreds of phylogenetically informative sites and millions of genomes. For such datasets, we set out to develop a method for building the phylogenetic tree of genomic haplotypes consisting of positions harboring common variants to improve the signal-to-noise ratio for more accurate phylogenetic inference of resolvable phylogenetic features.</p>
      </sec>
      <sec id="S2">
        <title>Results:</title>
        <p id="P5">We present the <italic toggle="yes">TopHap</italic> approach that determines spatiotemporally common haplotypes of common variants and builds their phylogeny at a fraction of the computational time of traditional methods. To assess topological robustness, we develop a bootstrap resampling strategy that resamples genomes spatiotemporally. The application of <italic toggle="yes">TopHap</italic> to build a phylogeny of 68,057 genomes (68KG) produced an evolutionary tree of major SARS-CoV-2 haplotypes. This phylogeny is concordant with the mutation tree inferred using the co-occurrence pattern of mutations and recovers key phylogenetic relationships from more traditional analyses. We also evaluated alternative roots of the SARS-CoV-2 phylogeny and found that the earliest sampled genomes in 2019 likely evolved by four mutations of the most recent common ancestor of all SARS-CoV-2 genomes. An application of <italic toggle="yes">TopHap</italic> to more than 1 million genomes reconstructed the most comprehensive evolutionary relationships of major variants, which confirmed the 68KG phylogeny and provided evolutionary origins of major variants of concern.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S4">
    <label>1</label>
    <title>Introduction</title>
    <p id="P7">The global health emergency caused by the SARS-CoV-2 coronavirus has catalyzed an unprecedented effort to sequence millions of genomes from all around the world and their analysis to reveal its origins and evolution (<xref rid="R1" ref-type="bibr">Andersen <italic toggle="yes">et al</italic>., 2020</xref>; <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., 2021</xref>; <xref rid="R15" ref-type="bibr">Rambaut <italic toggle="yes">et al</italic>., 2020</xref>). However, applying classical phylogenetic methods to infer the global SARS-CoV-2 phylogeny has been challenging (<xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., 2021</xref>; <xref rid="R10" ref-type="bibr">Morel <italic toggle="yes">et al</italic>., 2020</xref>). This is partly because phylogenetically informative sites are relatively rare due to a low mutation rate and a short evolutionary period of the outbreak. Genome sequences contain random and systematic sequencing errors, which compete with informative phylogenetic variation and mislead phylogenetic inference (<xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., 2021</xref>; <xref rid="R10" ref-type="bibr">Morel <italic toggle="yes">et al</italic>., 2020</xref>; <xref rid="R14" ref-type="bibr">Pipes <italic toggle="yes">et al</italic>., 2020</xref>). Consequently, the application of standard phylogenetic methods to the multiple sequencing alignment (MSA) of SARS-CoV-2 genomes has produced many equally plausible phylogenies, particularly when reconstructing early mutational history and the root of the SARS-CoV-2 phylogeny (<xref rid="R12" ref-type="bibr">Nie <italic toggle="yes">et al</italic>., 2020</xref>; <xref rid="R14" ref-type="bibr">Pipes <italic toggle="yes">et al</italic>., 2020</xref>; <xref rid="R20" ref-type="bibr">van Dorp <italic toggle="yes">et al</italic>., 2020</xref>).</p>
    <p id="P8"><xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> reconstructed a mutation tree using shared co-occurrence patterns of mutations occurring in &gt;1% of isolates. They applied and advanced a maximum likelihood method (SCITE, <xref rid="R5" ref-type="bibr">Jahn <italic toggle="yes">et al</italic>., 2016</xref>) that models false-positive and false-negative variant detections while assuming that recombination is absent (<xref rid="R5" ref-type="bibr">Jahn <italic toggle="yes">et al</italic>., 2016</xref>; <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., 2021</xref>). They reported success deciphering the earliest phases of SARS-CoV-2 evolution, including the most recent common ancestor (MRCA) genome, using common variants observed in the early stages of SARS-CoV-2 evolution. Based on the success in building the mutation tree using common variants, we hypothesized that it should be possible to build a reliable molecular phylogeny of major SARS-CoV-2 haplotypes by filtering out all genomic positions at which no minor allele rose to a frequency greater than 1%. Such filtering should effectively reduce the effect of the noise in making molecular phylogenetic inferences using standard approaches (e.g., the maximum likelihood [ML] method). If successful, one would prefer a traditional phylogenetic approach because it can better handle multiple substitutions at the same site (homoplasy) and use outgroup sequences more effectively than the mutation tree approaches.</p>
    <p id="P9">However, excluding alignment sites with only low-frequency variants followed by applying a standard phylogenetic approach on remaining sites was unsuccessful. An example illustrates the problem in <xref rid="F1" ref-type="fig">figure 1</xref>. The ancestral genome contains only three polymorphic positions where derived alleles occur at high frequencies (#1, #2, and #3; <xref rid="F1" ref-type="fig">Fig. 1a</xref>). In this case, we expect to see at most four correct haplotypes in the absence of noise: three mutant strains (H1, H2, and H3) and one ancestral haplotype. The addition of a small number of sequencing errors and homoplasy generate additional haplotypes (e.g., H4, H5, and H6) that occur with very low frequency but still mislead an ML analysis (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). ML phylogenies place two spurious haplotypes (H5 and H6) near the root of the tree (<xref rid="F1" ref-type="fig">Fig. 1c</xref>), albeit without significant statistical support.</p>
    <p id="P10">However, this behavior is rectified when one removes rare haplotypes (<xref rid="F1" ref-type="fig">Fig. 1d</xref>). This observation prompted us to develop a simple filtering procedure to identify <italic toggle="yes">common (top) haplotypes</italic> of <italic toggle="yes">common variants</italic> for molecular phylogenetic analysis. We first present this filtering process (the <italic toggle="yes">TopHap</italic> approach) and then apply it to infer the early evolutionary history of SARS-CoV-2 by using 68,057 genomes previously analyzed by <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> for a direct comparison of the <italic toggle="yes">TopHap</italic> phylogeny with the mutation tree generated by using patterns of co-occurrence of variants.</p>
  </sec>
  <sec id="S5">
    <label>2</label>
    <title>Methods</title>
    <sec id="S6">
      <label>2.1</label>
      <title>The <italic toggle="yes">TopHap</italic> approach</title>
      <p id="P11">As input, <italic toggle="yes">TopHap</italic> uses an MSA of genomes (<italic toggle="yes">n</italic> genomes and <italic toggle="yes">m</italic> base positions; <xref rid="F2" ref-type="fig">Fig. 2a</xref>). The first step is the selection of common variants by specifying a desired minor allele frequency threshold (e.g., <italic toggle="yes">maf</italic> &gt; 1%) without using any reference genomes. All alignment sites containing at least one allele with a frequency greater than <italic toggle="yes">maf</italic> and another allele with a frequency less than 1-<italic toggle="yes">maf</italic> are marked for inclusion (<italic toggle="yes">k</italic> variant positions). Every genome is then reduced to a haplotype on <italic toggle="yes">k</italic> retained sites. Next, unique haplotype sequences are identified, and their frequencies tallied.</p>
      <p id="P12"><italic toggle="yes">TopHap</italic> selects the top <italic toggle="yes">h</italic> haplotypes given a desired <italic toggle="yes">hf</italic> frequency cut-off. Now, the MSA contains <italic toggle="yes">h</italic> haplotypes, each <italic toggle="yes">k</italic> base positions long and tagged with its frequency. Outgroup genomes are added into the MSA by converting them into haplotypes containing only <italic toggle="yes">k</italic> selected positions. This reduced MSA is subjected to the phylogenetic analysis using standard methods, e.g., Maximum Parsimony (MP) or ML methods with models for analyzing datasets containing only polymorphic positions (<xref rid="R7" ref-type="bibr">Lewis, 2001</xref>; <xref rid="R16" ref-type="bibr">Schrempf <italic toggle="yes">et al</italic>., 2016</xref>; <xref rid="R18" ref-type="bibr">Stamatakis, 2014</xref>). This will produce the <italic toggle="yes">TopHap</italic> phylogeny of common haplotypes on common variants.</p>
      <p id="P13">When information on sampling location and time of haplotypes is available, <italic toggle="yes">TopHap</italic> selects variants and haplotypes for each spatiotemporal slice of the dataset that is regionally (e.g., continent, country, or city) and/or temporally (e.g., monthly) partitioned (<xref rid="F2" ref-type="fig">Fig. 2b</xref>). Then, all the variants and haplotypes selected in spatiotemporal slices are pooled together. In this case, the same <italic toggle="yes">maf</italic> and <italic toggle="yes">hf</italic> thresholds are applied to each spatiotemporal slice.</p>
      <sec id="S7">
        <title>Calculation of bootstrap support.</title>
        <p id="P14">In the <italic toggle="yes">TopHap</italic> approach, bootstrap branch support for the inferred phylogeny of common haplotypes is calculated by resampling genomes to build bootstrap replicate datasets. This procedure assesses the robustness of the inferred phylogeny to the inclusion/exclusion of haplotypes likely created by sequencing errors and convergent changes that are expected to have relatively low frequencies spatiotemporally because the bootstrap resampling procedure is applied separately to each spatiotemporal slice and the final set of variants and haplotypes are pooled together. This genome resampling approach is different from Felsenstein’s bootstrap approach of resampling sites to build bootstrap replicate datasets, which is not useful for phylogenies in which many branches are expected to have fewer than three mutations. At least three mutations per branch are required to achieve a 95% confidence level even without any homoplasy in the standard bootstrap approach (<xref rid="R4" ref-type="bibr">Felsenstein, 1985</xref>; <xref rid="R17" ref-type="bibr">Soltis and Soltis, 2003</xref>).</p>
        <p id="P15">Every bootstrap replicate dataset is subjected to phylogeny reconstruction to generate bootstrap replicate phylogenies. Haplotypes that do not appear in all the bootstrap replicates are then pruned from all the phylogenies. (Of course, one may choose to retain all haplotypes that occur in most of the bootstrap replicates.) Then a bootstrap consensus tree is generated. This consensus tree contains bootstrap support values on the inferred phylogeny.</p>
      </sec>
      <sec id="S8">
        <title>Placement of additional haplotypes into the phylogeny.</title>
        <p id="P16">To place a new genome into the <italic toggle="yes">TopHap</italic> phylogeny, the first step is to transform it into a haplotype of <italic toggle="yes">k</italic> positions used to build the <italic toggle="yes">TopHap</italic> phylogeny. One may use an MP (e.g., UShER (<xref rid="R19" ref-type="bibr">Turakhia <italic toggle="yes">et al</italic>., 2021</xref>) and pplacer (<xref rid="R9" ref-type="bibr">Matsen <italic toggle="yes">et al</italic>., 2010</xref>)) or ML approach (RAxML-EPA (<xref rid="R2" ref-type="bibr">Berger <italic toggle="yes">et al</italic>., 2011</xref>)). When the intent is to place a genome with variant(s) in the genomic position that was not used to build the <italic toggle="yes">TopHap</italic> phylogeny, we rebuild the phylogeny by requiring that the position(s) of interest be always included during the <italic toggle="yes">TopHap</italic> analysis. This process takes only a few additional minutes and produces a phylogeny with haplotypes that contain the variant(s) of interest.</p>
      </sec>
      <sec id="S9">
        <title>Annotations using Nextstrain and PANGO classifications.</title>
        <p id="P17">To compare <italic toggle="yes">TopHap</italic> phylogeny with the Nextstrain classification, we annotated all the <italic toggle="yes">TopHap</italic> haplotypes using the presence and absence of diagnostic Nextstrain mutations (<ext-link xlink:href="https://nextstrain.org/ncov" ext-link-type="uri">https://Nextstrain.org/ncov</ext-link>). We also assigned a PANGO lineage to each genome in the data using the Phylogenetic Assignment of Named Global Outbreak Lineages (PANGOLIN) software (<xref rid="R15" ref-type="bibr">Rambaut <italic toggle="yes">et al</italic>., 2020</xref>). <italic toggle="yes">TopHap</italic> haplotype ID was also assigned for each genome when an observed haplotype was perfectly identical to a <italic toggle="yes">TopHap</italic> haplotype. Here, the same <italic toggle="yes">TopHap</italic> haplotypes may belong to more than one different PANGO lineage. In this case, we paired a <italic toggle="yes">TopHap</italic> haplotype with the major PANGO lineage.</p>
      </sec>
    </sec>
    <sec id="S10">
      <label>2.2</label>
      <title>Genome Data Acquisition and Assembly</title>
      <p id="P18">We obtained an MSA containing 68,057 genomes (hereafter, 68KG) of the SARS-CoV-2 coronavirus from human hosts analyzed in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., (2021)</xref>. These genomes were obtained from the GISAID database (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org</ext-link>) and covered the period from December 24, 2019, until October 12, 2020. The 68KG alignment was generated after filtering 133,741 SARS-CoV-2 genomes, such that genomes shorter than 28,000 bases and those with many ambiguous bases were removed. Three outgroup coronavirus genomes were added to the alignment: <italic toggle="yes">Rhinolophus affinis</italic> (RaTG13) and <italic toggle="yes">R. malayanus</italic> (RmYN02) bats, and the <italic toggle="yes">Manis javanica</italic> pangolin (MT040335) (<xref rid="R8" ref-type="bibr">Liu <italic toggle="yes">et al</italic>., 2020</xref>; <xref rid="R22" ref-type="bibr">Zhou <italic toggle="yes">et al</italic>., 2020</xref>). Following the above procedure, we also assembled a dataset containing 1,106,862 genomes (hereafter 1MG) from the GISAID database covering the period from December 24, 2019, to September 11, 2021.</p>
    </sec>
  </sec>
  <sec id="S11">
    <label>3</label>
    <title>Results</title>
    <p id="P19">We stratified sequence isolates by (month of sampling, country) attributes to select variants and haplotypes in the <italic toggle="yes">TopHap</italic> analysis of the 68KG dataset. We used spatial and regional <italic toggle="yes">maf</italic> and <italic toggle="yes">hf</italic> cut-offs of 5% to avoid including problematic variants and haplotypes created by recurrent/backward mutations and sequencing error, particularly because of the small number of genomes available for some spatiotemporal slices. We retained a data stratum that contained at least 500 genomes. When the number of genomes sampled from a country was less than 500, we manually pooled them with adjacent countries with sparse sampling, i.e., all genomes from these countries were pooled when they were located in the same continent. Also, the numbers of genomes in December 2019 and October 2020 were &lt;500, so we pooled them with January 2020 and September 2020 time slices, respectively.</p>
    <p id="P20">We used the Maximum Parsimony approach to infer <italic toggle="yes">TopHap</italic> phylogeny because the dataset contained only variable sites. One hundred bootstrap replicate analyses were carried out following the procedure outlined in the <xref rid="S5" ref-type="sec">methods</xref> section. The whole <italic toggle="yes">TopHap</italic> analysis was completed in less than an hour, providing the spatiotemporal slices of 68K haplotypes composed of positions with <italic toggle="yes">maf</italic> &gt; 5%. The final tree consisted of 83 variable sites and 39 unique haplotypes (<xref rid="F3" ref-type="fig">Fig. 3</xref>). All but three groupings in this tree were highly supported (bootstrap confidence levels &gt; 95%), i.e., many inferences were robust to genome sampling (100 replicates). The other three groupings received &gt;80% bootstrap support. In the <italic toggle="yes">TopHap</italic> phylogeny, many branches were longer than one mutation, and many zero-length branches created multifurcations.</p>
    <sec id="S12">
      <title>Temporal trends in variant frequencies</title>
      <p id="P21">The <italic toggle="yes">TopHap</italic> approach in the MP analysis of selected haplotypes does not use the temporal information of genomes (isolation day) nor observed variant frequency. Therefore, a <italic toggle="yes">TopHap</italic> phylogeny allows us to test the concordance between mutation occurrence time and variant frequency and those expected from the phylogeny. We first mapped mutations to every branch in the SARS-CoV-2 phylogeny by reconstructing the most parsimonious ancestral states and minimum evolution. All mutations were mapped unambiguously (<xref rid="F3" ref-type="fig">Fig. 3</xref>). In the <italic toggle="yes">TopHap</italic> phylogeny of haplotypes from the early pandemic (up to October 2020), the frequencies of variants mapped onto branches generally decreased from the root to tip on evolutionary lineages (e.g., <xref rid="F4" ref-type="fig">Fig 4a</xref>). For example, the mutant bases mapping to the earliest diverging branches in the <italic toggle="yes">TopHap</italic> phylogeny occurred with the highest frequency in the 68KG dataset. Also, the timing of the first sampling date of variants increased on lineages from root to tip (<xref rid="F4" ref-type="fig">Fig 4b</xref>). This good concordance with those expected from the inferred <italic toggle="yes">TopHap</italic> phylogeny indicates that the observed patterns are consistent with the clonal evolution of SARS-CoV-2 during the early stage of the pandemic.</p>
    </sec>
    <sec id="S13">
      <title>Comparing the TopHap phylogeny with the mutation tree</title>
      <p id="P22">We compared the order of mutations in the <italic toggle="yes">TopHap</italic> phylogeny with the mutation tree inferred using the co-occurring mutations pattern by <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>. This is different from the MP analysis of <italic toggle="yes">TopHap</italic> haplotypes as it treated every variant position independently. For notational consistency, we used Greek symbols for variants when they were the same as those analyzed in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021</xref>, Supplementary Table 2). In total, 49 mutations were shared between 68K <italic toggle="yes">TopHap</italic> phylogeny (83 mutations) and the mutation tree in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> (84 mutations). Thirty-four variants were unique to the <italic toggle="yes">TopHap</italic> phylogeny because those variants and corresponding haplotypes rose to high enough frequency (5% frequency) in at least one spatiotemporal slice (locale or month), but their global frequency was less than the 1% required by <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., (2021)</xref> in building the mutation tree. Thirty-five mutations analyzed in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> were missing from the <italic toggle="yes">TopHap</italic> analysis because they never rose to 5% frequency in any time slice. So, we based our comparison of <italic toggle="yes">TopHap</italic> and mutation tree on 49 variants found in both analyses.</p>
      <p id="P23">The inferred mutation order from the <italic toggle="yes">TopHap</italic> phylogeny is consistent with the mutation tree, except that some mutations on branches with multiple mutations were not resolved. For example, the mutation tree suggested that α<sub>2</sub> mutation preceded α<sub>3</sub>, but <italic toggle="yes">TopHap</italic> phylogeny does not resolve this transition because the corresponding intermediate haplotype did not occur with more than 5% frequency in any spatiotemporal slice. This <italic toggle="yes">TopHap</italic> result is reasonable because sequencing error may have created spurious transitional haplotypes (<xref rid="R13" ref-type="bibr">Pekar <italic toggle="yes">et al</italic>., 2021</xref>). At the same time, some multi-mutation branches in the <italic toggle="yes">TopHap</italic> phylogeny also correspond well with the unresolved branching order of mutations in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>, which was suggested to be due to evolutionary bursts (e.g., three β mutations and three ε mutations).</p>
      <p id="P24">The high concordance of <italic toggle="yes">TopHap</italic> phylogeny inferred, without making any assumptions about the lack of recombination, with the mutation tree inferred using variant co-occurrence patterns suggests that the early phases of SARS-CoV-2 evolution did not involve significant numbers of recombination and co-infections (see also <xref rid="R21" ref-type="bibr">Varabyou <italic toggle="yes">et al</italic>., 2021</xref>), which could have, otherwise, resulted in differences between the <italic toggle="yes">TopHap</italic> phylogeny and the mutation tree.</p>
    </sec>
    <sec id="S14">
      <title>TopHap analysis with &gt;1 million SARS-CoV-2 genomes</title>
      <p id="P25">Next, we analyzed a recent snapshot of SARS-CoV-2 genome collection acquired one year after the 68KG data set. After filtering incomplete genome sequences, we obtained an alignment of 1,106,862 genomes to build the 1MG dataset that was 16 times bigger than the 68KG dataset. Nevertheless, the <italic toggle="yes">TopHap</italic> analysis, including 100 bootstrap replicates, was completed in less than 3 hours. Using TopHap with <italic toggle="yes">hf</italic> &gt; 5% and <italic toggle="yes">maf</italic> &gt; 5%, we obtained a reduced MSA of 150 haplotypes with 675 variable sites. Therefore, the number of haplotypes increased only four-fold, and the number of variable sites increased by eight times. The inferred phylogeny from the 1MG data set (<xref rid="F6" ref-type="fig">Figure 6a</xref>) was supported with relatively high bootstrap values (&gt;80%) and concordant with the 68KG <italic toggle="yes">TopHap</italic> phylogeny. The order of early mutations (α<sub>1−</sub>α<sub>3</sub>, β<sub>1−</sub>β<sub>3</sub>, ε<sub>1−</sub>ε<sub>3</sub>, γ<sub>1</sub>, δ<sub>1</sub>, and ν<sub>1-</sub>ν<sub>2</sub>) was the same for 1MG and 68KG <italic toggle="yes">TopHap</italic> phylogenies. Therefore, inferences about the early history reported for the 68KG data set were robust to the expanded sampling of genomes.</p>
      <p id="P26">The 1MG <italic toggle="yes">TopHap</italic> phylogeny contains several branches with many mutations, which often lead to haplotypes that have been designated variants of concern (VOC) by WHO. This includes WHO-ALPHA, WHO-BETA, WHO-DELTA, WHO-ETA, WHO-GAMMA, and WHO-LAMBDA variants. We used the WHO-prefix to avoid conflicting between Kumar et al. notations for mutations and the WHO’s notation for multi-mutation strains. Notably, Kumar et al. mutation identifiers were proposed earlier, so we have retained them. The placement of these VOCs in <italic toggle="yes">TopHap</italic> is like that in the Nextstrain (<xref rid="F6" ref-type="fig">Fig. 6b</xref> and <xref rid="F6" ref-type="fig">6c</xref>). For example, both Nextstrain and <italic toggle="yes">TopHap</italic> reconstruct WHO-ALPHA, WHO-GAMMA, and WHO-LAMBDA to be sister lineages. Also, the N501Y Spike recurrent mutation (A23063T) occurred independently in WHO-ALPHA, WHO-GAMMA, and WHO-BETA lineages, inferred correctly by <italic toggle="yes">TopHap</italic> (<xref rid="F6" ref-type="fig">Fig. 6a</xref>).</p>
    </sec>
    <sec id="S15">
      <title>Rooting the tree of SARS-CoV-2 genomes</title>
      <p id="P27">We find that Nextstrain and PANGO phylogeny broadly agree with 68KG and 1MG <italic toggle="yes">TopHap</italic> phylogenies, except for the root position (<xref rid="F3" ref-type="fig">Fig. 3</xref>, <xref rid="F5" ref-type="fig">5</xref>, and <xref rid="F6" ref-type="fig">6</xref>). For example, clade 19A is at the root of the Nextstrain phylogeny, but <italic toggle="yes">TopHap</italic> phylogenies using the bat/pangolin outgroups suggest that Clade 19A is a derived clade. Based on 100 genome resamples, the bootstrap support was modest (&gt;66%) for the root of the <italic toggle="yes">TopHap</italic> phylogeny. But, no bootstrap replicates supported the Nextstrain rooting, and &lt;34% supported the PANGO rooting.</p>
      <p id="P28">The <italic toggle="yes">TopHap</italic> rooting is the same as that implied by the mutation tree reported in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>. <italic toggle="yes">TopHap</italic> root is also consistent with one of the two preferred roots in <xref rid="R3" ref-type="bibr">Bloom (2021)</xref>, who analyzed 13 additional partial genomes from only China until the end of January 2020. Key early mutations analyzed in <xref rid="R3" ref-type="bibr">Bloom (2021)</xref> contained an additional variable site (genomic position 29095), where the minor base occurred with a too low frequency to be included in the <italic toggle="yes">TopHap</italic> analysis (0.4% in the 68KG). So, we refer to it as mutation <italic toggle="yes">x</italic> (= 29095, U is minor, and C is major) and include it in the 68KG MSA. We also searched for other rare haplotypes to see if any other cluster at or near the root position in the 68KG <italic toggle="yes">TopHap</italic> phylogeny.</p>
      <p id="P29">We found 936 additional unique haplotypes that occurred in the 68KG dataset more than once. We tested their placement one by one in the <italic toggle="yes">TopHap</italic> phylogeny by using RAxML-EPA (<xref rid="R2" ref-type="bibr">Berger <italic toggle="yes">et al</italic>., 2011</xref>). Only two were attached at or near the root. One of them had the same haplotype sequence as that of MRCA and was present in 17 isolates. This haplotype is the proCoV2 sequence reported by <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>, circulating in early 2020. The other haplotype differed from the proCoV2 sequence in two genomic positions (29095 [location of <italic toggle="yes">x</italic> variant] and 18060 [location of α<sub>1</sub> variant]). This haplotype is the same as what <xref rid="R3" ref-type="bibr">Bloom (2021)</xref> suggested to be important in rooting the SARS-CoV-2 phylogeny, which led us to consider five alternative scenarios based on <italic toggle="yes">TopHap</italic>, <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>, <xref rid="R3" ref-type="bibr">Bloom (2021)</xref>, Nextstrain, and PANGO (<xref rid="F7" ref-type="fig">Fig. 7</xref>) involving eight positions that experienced mutations (α<sub>1</sub>-α<sub>3</sub>, β<sub>1</sub>-β<sub>3</sub>, ν<sub>1</sub>-ν<sub>2</sub>, and <italic toggle="yes">x</italic>) and gave rise to seven major early haplotypes. Our evaluation of these five scenarios is the most detailed comparison to date because of the size of the dataset analyzed and the variants included. For example, ν<sub>1</sub> and ν<sub>2</sub> variants were absent in the analysis by <xref rid="R3" ref-type="bibr">Bloom (2021)</xref>, because genomes only sampled until the end of January 2020 were included, and variant <italic toggle="yes">x</italic> was missing from <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> analysis because its global frequency was less than 1% in the 68KG dataset.</p>
      <p id="P30">We evaluated these five scenarios (topologies) using MP and ML optimally criteria (<xref rid="F7" ref-type="fig">Fig. 7</xref>). We used the key seven haplotypes with the eight positions (α<sub>1</sub>-α<sub>3</sub>, β<sub>1</sub>-β<sub>3</sub>, ν<sub>1</sub>-ν<sub>2</sub>, and <italic toggle="yes">x</italic>). MP suggests scenarios A, B, and C to be equally parsimonious, and D and E (PANGO and Nextstrain, respectively) to be less parsimonious by 1 and 3 mutations. Scenario D and E were also less likely than A, B, and C, where we estimated the log-likelihood (<italic toggle="yes">lnL</italic>) of all five scenarios (topologies) using a GTR model of nucleotide substitutions in MEGA for the haplotypes shown in <xref rid="F7" ref-type="fig">Fig. 7</xref>. While the log-likelihood of scenario A was the highest, it was only slightly higher than that for B and C that were equally likely. Among scenarios A, B, and C, <italic toggle="yes">x</italic> variant was lost in B, while the α<sub>1</sub> variant was acquired twice in A and lost in C.</p>
      <p id="P31">In all the three equally most parsimonious scenarios (A, B, and C), the addition of mutation <italic toggle="yes">x</italic> pushes back the MRCA of SARS-CoV-2 by one mutation compared to the proCoV2 sequence of <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>. In these cases, the number of differences between Wuhan-1 and the MRCA is four (<xref rid="F7" ref-type="fig">Fig. 7</xref>). With a mutation rate range of 6.64 × 10<sup>−4</sup>–9.27 × 10<sup>−4</sup> substitutions per site per year (<xref rid="R13" ref-type="bibr">Pekar <italic toggle="yes">et al</italic>., 2021</xref>), we can estimate that proCoV2 existed 7.7–10.8 weeks before the December 24, 2019 sampling date of Wuhan-1. This places the progenitor of SARS-CoV-2 to have evolved in mid-September to Early-October 2019, which is earlier than the mid-November 2019 date favored by <xref rid="R13" ref-type="bibr">Pekar et al. (2021)</xref>. Pekar et al. used rooting in scenario D in which the lineage containing (α<sub>2</sub>-α<sub>3</sub> and β<sub>1</sub>-β<sub>3</sub>; PONGO B) is a sister group of the lineage containing α<sub>1</sub> and ν<sub>1</sub>-ν<sub>2</sub> (PONGO A). As noted above, this scenario receives lower bootstrap support than the alternative in which PONGO B arose from the ancestor containing α<sub>1</sub>. In this sense, <xref rid="R13" ref-type="bibr">Pekar et al. (2021)</xref> may have dated a later event in the SARS-CoV-2 phylogeny.</p>
    </sec>
  </sec>
  <sec id="S16">
    <label>4</label>
    <title>Conclusions</title>
    <p id="P32">The ongoing global efforts to monitor the evolution of the SARS-CoV-2 coronavirus have motivated hundreds of laboratories worldwide to generate genome sequences continuously. The number of genomes has grown quickly, becoming orders of magnitude greater than the genome size. Rapid growth, low sequence variability, and the presence of sequencing error have made the direct use of phylogenetic methods on genome alignments challenging for such data (e.g., <xref rid="R10" ref-type="bibr">Morel <italic toggle="yes">et al</italic>., 2020</xref>). We have shown that the <italic toggle="yes">TopHap</italic> phylogeny for common variants and haplotypes in the 68KG SARS-CoV-2 dataset works well and agrees with the mutation tree produced using a mutation order approach (MOA) (<xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., 2021</xref>). But, the <italic toggle="yes">TopHap</italic> approach offers some advantages over MOA. Firstly, MOA assumes the sequencing error rate to be constant throughout the outbreak, which is unlikely to hold for pathogenomic datasets acquired in different laboratories at different times. Secondly, MOA analysis needs to have mutant bases indicated at the outset, a limitation addressed by <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref>, but at a large computational expense. In contrast, <italic toggle="yes">TopHap</italic> analyses directly use outgroup in standard phylogenetic analysis. <italic toggle="yes">TopHap</italic> analysis is certainly more computationally efficient as the analysis of the 68KG dataset took only a few hours. In contrast, MOA took more than a week to compute.</p>
    <p id="P33">Thirdly, <italic toggle="yes">TopHap</italic> analysis can use well-established methods to infer phylogeny and ancestral sequences to identify recurrent and backward mutations. In contrast, MOA assumes an infinite site model and, thus, is not suitable for detecting recurrent and backward mutations. Lastly, rarer haplotypes can also be attached to a backbone of a <italic toggle="yes">TopHap</italic> phylogeny by simply adding the genomic position of interest in constructing the MSA of haplotypes, as demonstrated above.</p>
    <p id="P34">In conclusion, <italic toggle="yes">TopHap</italic> is a simple and effective method to build haplotype phylogenies and assess their statistical robustness. <italic toggle="yes">TopHap</italic> can be applied in any data containing a large number of sequences with a handful of variants, including other pathogens and tumor single-cell sequencing data that is now producing a large number of somatic cell sequences (<xref rid="R11" ref-type="bibr">Navin, 2015</xref>).</p>
  </sec>
</body>
<back>
  <ack id="S17">
    <title>Acknowledgments</title>
    <p id="P35">We thank Sudip Sharma for comments and everyone depositing genome data on GISAID (list at <ext-link xlink:href="http://igem.temple.edu/COVID-19" ext-link-type="uri">http://igem.temple.edu/COVID-19</ext-link>).</p>
    <sec id="S18">
      <title>Funding</title>
      <p id="P36">This work has been supported by the U.S. National Science Foundation to S.K./S.M. (DEB-2034228) and S.P. (DBI-2027196) and U.S. National Institutes of Health to S.K. (GM 139504-01) and S.P. (AI-134384).</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="FN3">
      <p id="P44"><bold>Availability:</bold><italic toggle="yes">TopHap</italic> is available on the web at <ext-link xlink:href="https://github.com/SayakaMiura/TopHap" ext-link-type="uri">https://github.com/SayakaMiura/TopHap</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <mixed-citation publication-type="journal"><name><surname>Andersen</surname><given-names>K.G.</given-names></name>, <etal/> (<year>2020</year>) <article-title>The proximal origin of sars-cov-2</article-title>. <source>Nat. Med.</source>, <volume>26</volume>, <fpage>450</fpage>–<lpage>452</lpage>.<pub-id pub-id-type="pmid">32284615</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <mixed-citation publication-type="journal"><name><surname>Berger</surname><given-names>S.A.</given-names></name>, <etal/> (<year>2011</year>) <article-title>Performance, accuracy, and web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>. <source>Syst. Biol.</source>, <volume>60</volume>, <fpage>291</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">21436105</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <mixed-citation publication-type="journal"><name><surname>Bloom</surname><given-names>J.D.</given-names></name> (<year>2021</year>) <article-title>Recovery of deleted deep sequencing data sheds more light on the early wuhan sars-cov-2 epidemic</article-title>. <source>Mol. Biol. Evol.</source>, <pub-id pub-id-type="doi">10.1093/molbev/msab246</pub-id>.</mixed-citation>
    </ref>
    <ref id="R4">
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J.</given-names></name> (<year>1985</year>) <article-title>Confidence limits on phylogenies: An approach using the bootstrap</article-title>. <source>Evolution</source>, <volume>39</volume>, <fpage>783</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">28561359</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>K.</given-names></name>, <etal/> (<year>2016</year>) <article-title>Tree inference for single-cell data</article-title>. <source>Genome Biology</source>, <volume>17</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <mixed-citation publication-type="journal"><name><surname>Kumar</surname><given-names>S.</given-names></name>, <etal/> (<year>2021</year>) <article-title>An evolutionary portrait of the progenitor sars-cov-2 and its dominant offshoots in covid-19 pandemic</article-title>. <source>Mol. Biol. Evol.</source>, <volume>38</volume>, <fpage>3046</fpage>–<lpage>3059</lpage>.<pub-id pub-id-type="pmid">33942847</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <mixed-citation publication-type="journal"><name><surname>Lewis</surname><given-names>P.O.</given-names></name> (<year>2001</year>) <article-title>A likelihood approach to estimating phylogeny from discrete morphological character data</article-title>. <source>Syst. Biol.</source>, <volume>50</volume>, <fpage>913</fpage>–<lpage>925</lpage>.<pub-id pub-id-type="pmid">12116640</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>P.</given-names></name>, <etal/> (<year>2020</year>) <article-title>Are pangolins the intermediate host of the 2019 novel coronavirus (sars-cov-2)?</article-title>
<source>PLoS Path.</source>, <volume>16</volume>, <fpage>e1008421</fpage>.</mixed-citation>
    </ref>
    <ref id="R9">
      <mixed-citation publication-type="journal"><name><surname>Matsen</surname><given-names>F.A.</given-names></name>, <etal/> (<year>2010</year>) <article-title>Pplacer: Linear time maximum-likelihood and bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>538</fpage>.<pub-id pub-id-type="pmid">21034504</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <mixed-citation publication-type="journal"><name><surname>Morel</surname><given-names>B.</given-names></name>, <etal/> (<year>2020</year>) <article-title>Phylogenetic analysis of sars-cov-2 data is difficult</article-title>. <source>Mol. Biol. Evol.</source>, <volume>38</volume>, <fpage>1777</fpage>–<lpage>1791</lpage>.</mixed-citation>
    </ref>
    <ref id="R11">
      <mixed-citation publication-type="journal"><name><surname>Navin</surname><given-names>N.E.</given-names></name> (<year>2015</year>) <article-title>The first five years of single-cell cancer genomics and beyond</article-title>. <source>Genome Res.</source>, <volume>25</volume>, <fpage>1499</fpage>–<lpage>1507</lpage>.<pub-id pub-id-type="pmid">26430160</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <mixed-citation publication-type="journal"><name><surname>Nie</surname><given-names>Q.</given-names></name>, <etal/> (<year>2020</year>) <article-title>Phylogenetic and phylodynamic analyses of sars-cov-2</article-title>. <source>Virus Res.</source>, <volume>287</volume>, <fpage>198098</fpage>.<pub-id pub-id-type="pmid">32687861</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <mixed-citation publication-type="book"><name><surname>Pekar</surname><given-names>J.</given-names></name>, <etal/> (<year>2021</year>) <part-title>Evidence against the veracity of sars-cov-2 genomes intermediate between lineages a and b</part-title>. In, <source><ext-link xlink:href="http://Virological.org" ext-link-type="uri">Virological.org</ext-link></source>.</mixed-citation>
    </ref>
    <ref id="R14">
      <mixed-citation publication-type="journal"><name><surname>Pipes</surname><given-names>L.</given-names></name>, <etal/> (<year>2020</year>) <article-title>Assessing uncertainty in the rooting of the sars-cov-2 phylogeny</article-title>. <source>Mol. Biol. Evol.</source>, <volume>38</volume>, <fpage>1537</fpage>–<lpage>1543</lpage>.</mixed-citation>
    </ref>
    <ref id="R15">
      <mixed-citation publication-type="journal"><name><surname>Rambaut</surname><given-names>A.</given-names></name>, <etal/> (<year>2020</year>) <article-title>A dynamic nomenclature proposal for sars-cov-2 lineages to assist genomic epidemiology</article-title>. <source>Nat. Microbiol.</source>, <volume>5</volume>, <fpage>1403</fpage>–<lpage>1407</lpage>.<pub-id pub-id-type="pmid">32669681</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <mixed-citation publication-type="journal"><name><surname>Schrempf</surname><given-names>D.</given-names></name>, <etal/> (<year>2016</year>) <article-title>Reversible polymorphism-aware phylogenetic models and their application to tree inference</article-title>. <source>J. Theor. Biol.</source>, <volume>407</volume>, <fpage>362</fpage>–<lpage>370</lpage>.<pub-id pub-id-type="pmid">27480613</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <mixed-citation publication-type="journal"><name><surname>Soltis</surname><given-names>P.S.</given-names></name> and <name><surname>Soltis</surname><given-names>D.E.</given-names></name> (<year>2003</year>) <article-title>Applying the bootstrap in phylogeny reconstruction</article-title>. <source>Stat. Sci.</source>, <volume>18</volume>, <fpage>256</fpage>–<lpage>267</lpage>.</mixed-citation>
    </ref>
    <ref id="R18">
      <mixed-citation publication-type="journal"><name><surname>Stamatakis</surname><given-names>A.</given-names></name> (<year>2014</year>) <article-title>Raxml version 8: A tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1312</fpage>–<lpage>1313</lpage>.<pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <mixed-citation publication-type="journal"><name><surname>Turakhia</surname><given-names>Y.</given-names></name>, <etal/> (<year>2021</year>) <article-title>Ultrafast sample placement on existing trees (usher) enables real-time phylogenetics for the sars-cov-2 pandemic</article-title>. <source>Nat. Genet.</source>, <volume>53</volume>, <fpage>809</fpage>–<lpage>816</lpage>.<pub-id pub-id-type="pmid">33972780</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <mixed-citation publication-type="journal"><name><surname>van Dorp</surname><given-names>L.</given-names></name>, <etal/> (<year>2020</year>) <article-title>Emergence of genomic diversity and recurrent mutations in sars-cov-2</article-title>. <source>Infect., Genet. Evol.</source>, <volume>83</volume>, <fpage>104351</fpage>.<pub-id pub-id-type="pmid">32387564</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <mixed-citation publication-type="journal"><name><surname>Varabyou</surname><given-names>A.</given-names></name>, <etal/> (<year>2021</year>) <article-title>Rapid detection of inter-clade recombination in sars-cov-2 with bolotie</article-title>. <source>Genetics</source>, <volume>218</volume>, <fpage>iyab074</fpage>.<pub-id pub-id-type="pmid">33983397</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>P.</given-names></name>, <etal/> (<year>2020</year>) <article-title>A pneumonia outbreak associated with a new coronavirus of probable bat origin</article-title>. <source>Nature</source>, <volume>579</volume>, <fpage>270</fpage>–<lpage>273</lpage>.<pub-id pub-id-type="pmid">32015507</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="F1">
    <label>Figure 1</label>
    <caption>
      <title>Traditional phylogenetic approach versus the new <italic toggle="yes">TopHap</italic> approach to manage a dataset that contains many sequences with few variants.</title>
      <p id="P37">(<bold>a</bold>) The true tree showing three simulated haplotypes. In this example, three mutations (α, β, and γ) occurred sequentially and gave rise to haplotypes, H1, H2, and H3. The size of triangles at each tip is proportional to the number of genomes containing these haplotypes. (<bold>b</bold>) Phylogenetic approaches use a multiple sequence alignment, simplified here with only three informative variants. Due to sequencing errors, a few spurious haplotypes would be observed (red letters, i.e., H4–H6) in low haplotype frequencies (0.3%–1%). Inclusion of these spurious haplotypes misguides the maximum likelihood (ML) and other methods and distorts the evolutionary inference. (<bold>c</bold>) Results based on a typical ML approach would suggest that the spurious haplotypes H6 and H5, were the first to arise. The bootstrap support for all the branching patterns is low (21%–47%) because each branch is only one mutation long, a situation where the bootstrap method is known to be powerless (see text). (<bold>d</bold>) The <italic toggle="yes">TopHap</italic> approach was able to infer the correct tree because it uses high-frequency haplotypes to infer a phylogeny; the haplotypes with low frequencies – which are likely spurious due to sequencing errors – are removed.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0001" position="float"/>
  </fig>
  <fig position="float" id="F2">
    <label>Figure 2</label>
    <caption>
      <title>Overview of the <italic toggle="yes">TopHap</italic> approach.</title>
      <p id="P38">Input to <italic toggle="yes">TopHap</italic> is an alignment of genome sequences (<italic toggle="yes">n</italic> sequences, <italic toggle="yes">m</italic> bases each). <italic toggle="yes">TopHap</italic> flowchart (<bold>a</bold>) without any spatiotemporal sampling information and (<bold>b</bold>) with consideration of spatiotemporal information are shown. In the <italic toggle="yes">TopHap</italic> algorithm, we first identify high-frequency variants (&gt;<italic toggle="yes">maf</italic>) and produce a restricted alignment with <italic toggle="yes">n</italic> sequences and <italic toggle="yes">k</italic> bases. Next, we identify high-frequency haplotypes (&gt;<italic toggle="yes">hf</italic>) and produce a new alignment of <italic toggle="yes">h</italic> haplotypes, each with <italic toggle="yes">k</italic> bases. These haplotypes are subjected to phylogenetic inference. To compute bootstrap confidence limits, we resample <italic toggle="yes">n</italic> haplotypes with replacement to form a replicate <italic toggle="yes">n</italic>×<italic toggle="yes">k</italic> dataset, identify high-frequency haplotypes (&gt;<italic toggle="yes">hf</italic>) and then infer a phylogeny. This process is repeated 100 times and a bootstrap consensus phylogeny is inferred. When the analyses are conducted with the consideration of spatiotemporal (or other type) annotation to construct subsets (<bold>panel b</bold>), variants and haplotypes are identified for each slice separately and then they are merged prior to phylogenetic analysis. For the SARS-CoV-2 68KG dataset, we classified sequences based on their sampling months and sampling countries.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0002" position="float"/>
  </fig>
  <fig position="float" id="F3">
    <label>Figure 3.</label>
    <caption>
      <title>The <italic toggle="yes">TopHap</italic> Phylogeny of 68KG SARS-CoV-2 major haplotypes.</title>
      <p id="P39">(<bold>a</bold>) Numbers near nodes are bootstrap confidence limits derived from bootstrap resampling of genomes. Mutations mapped are shown on branches. When the same mutations were included in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., (2021)</xref>, their mutation IDs (Greek symbols) were shown. Their mutations and genomic positions are given in the right side. The Nextstrain clade ID was annotated based on their diagnostic mutations and is provided at the far right. PANGO lineage was annotated for each genome using PANGOLIN software (<xref rid="R15" ref-type="bibr">Rambaut <italic toggle="yes">et al</italic>., 2020</xref>). We also annotated <italic toggle="yes">TopHap</italic> haplotype for each genome by comparing its haplotype with <italic toggle="yes">TopHap</italic> haplotypes. When an observed haplotype did not perfectly match any of the <italic toggle="yes">TopHap</italic> haplotypes, we did not assign any for the genome. Using these genome annotations, we paired each <italic toggle="yes">TopHap</italic> haplotype with the major PANGO lineage, and the percentage of genomes containing it is presented in the parenthesis.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0003" position="float"/>
  </fig>
  <fig position="float" id="F4">
    <label>Figure 4.</label>
    <caption>
      <p id="P40">Number of branches from the root to a tip and global mutant nucleotide frequency (<bold>b</bold>) and the first time the mutation was observed (<bold>c</bold>). Selected tip IDs are found in <xref rid="F3" ref-type="fig">Figure 3</xref>. The day was counted from the first sample date (Dec 24, 2019).</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0004" position="float"/>
  </fig>
  <fig position="float" id="F5">
    <label>Figure 5.</label>
    <caption>
      <title>Comparison of <italic toggle="yes">TopHap</italic> phylogeny with the Nextstrain (a) and PANGO (b) phylogenies.</title>
      <p id="P41">(<bold>a</bold>) Only clades included in the 68KG data are shown. (<bold>b</bold>) Only PANGO lineages that were included in the <italic toggle="yes">TopHap</italic> phylogeny were used. Corresponding PANGO IDs are found in <xref rid="F3" ref-type="fig">Figure 3</xref>.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0005" position="float"/>
  </fig>
  <fig position="float" id="F6">
    <label>Figure 6.</label>
    <caption>
      <title>The 1MG <italic toggle="yes">TopHap</italic> Phylogeny.</title>
      <p id="P42">(<bold>a</bold>) Red numbers near nodes are bootstrap confidence limits derived from bootstrap resampling of genomes. Early mutations that were predicted in <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>. (2021)</xref> are mapped are shown on branches using their mutation IDs (Greek symbols). Their mutations and genomic positions are given in <xref rid="F3" ref-type="fig">Figure 3</xref>. The haplotypes with concerning mutations are indicated by using WHO IDs, and 20A EU2 and 20E (EU1) are Nextstrain clade IDs. These haplotypes were identified by annotating PANGO and Nextstrain lineage for each genome. We also annotated <italic toggle="yes">TopHap</italic> haplotype for each genome by comparing its haplotype with <italic toggle="yes">TopHap</italic> haplotypes. When an observed haplotype did not perfectly match any of the <italic toggle="yes">TopHap</italic> haplotypes, we did not assign any for the genome. Using these genome annotations, we paired each <italic toggle="yes">TopHap</italic> haplotype with the major PANGO and Nextstrain lineage, which contained the WHO annotation. We assigned WHO ID when at least one of the annotations indicated it. Evolutionary relationship of lineages with concerning mutations by (<bold>b</bold>) Nextstrain and (<bold>c</bold>) <italic toggle="yes">TopHap</italic>.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0006" position="float"/>
  </fig>
  <fig position="float" id="F7">
    <label>Figure 7.</label>
    <caption>
      <title>The early history of SARS-CoV-2 variants.</title>
      <p id="P43">Five root positions are explored in which the haplotype with mutation <italic toggle="yes">x</italic> has been added to the <italic toggle="yes">TopHap</italic> phylogeny in <xref rid="F3" ref-type="fig">figure 3</xref> (A and B), <xref rid="R6" ref-type="bibr">Kumar <italic toggle="yes">et al</italic>., (2021)</xref> mutational history (B), <xref rid="R3" ref-type="bibr">Bloom, (2021)</xref> phylogeny (B and C), PANGO classification (D), and the Nextstrain classification (E). Haplotypes have eight positions that contain variants α1-α3, β1-β3, ν1-ν2, and <italic toggle="yes">x</italic>. Genomic positions are shown whenever a mutation occurs: green box for forward and red for backward mutations). ML log likelihoods (<italic toggle="yes">lnL</italic>) and number of MP substitutions are shown. WH-1 is the haplotype corresponding to the Wuhan-1 genome. The gray triangle represents all the other SARS-CoV-2 haplotypes of the ongoing infections in the world.</p>
    </caption>
    <graphic xlink:href="nihpp-2021.12.13.472454v1-f0007" position="float"/>
  </fig>
</floats-group>
