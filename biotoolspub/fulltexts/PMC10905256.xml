<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e2697?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10905256</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202312-01</article-id>
    <article-id pub-id-type="publisher-id">110</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.110</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.1101/2023.12.25.573324</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Genetics and Genomics</subject>
        <subject>Bioinformatics</subject>
        <subject>Developmental Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</article-title>
      <alt-title alt-title-type="left-running-head">B. Zhang <italic toggle="yes">et al.</italic>
</alt-title>
      <alt-title alt-title-type="right-running-head">Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6654-3567</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Bohan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3310-2911</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Mei</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6579-7944</contrib-id>
        <name>
          <surname>Kang</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Zhonghan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0004-6887-6743</contrib-id>
        <name>
          <surname>Qin</surname>
          <given-names>Hua</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6304-9907</contrib-id>
        <name>
          <surname>Su</surname>
          <given-names>Kui</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0000-2977-4059</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Xiuwen</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3635-0817</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Lichuan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Huanlin</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="supporting">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4126-0074</contrib-id>
        <name>
          <surname>Fang</surname>
          <given-names>Shuangsang</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9950-1793</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yong</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuxiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8951-6705</contrib-id>
        <name>
          <surname>Brix</surname>
          <given-names>Susanne</given-names>
        </name>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5338-5173</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Xun</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration" degree-contribution="lead">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision" degree-contribution="lead">Supervision</role>
        <xref rid="cor1" ref-type="corresp">
          <sup>*</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Shenzhen</addr-line>, <addr-line content-type="postcode">518083</addr-line>, <country>China</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Beijing</addr-line>, <addr-line content-type="postcode">102601</addr-line>, <country>China</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Biotechnology and Biomedicine</addr-line>, <institution>Technical University of Denmark</institution>, <addr-line content-type="postcode">2800</addr-line>, <addr-line content-type="city">Kgs. Lyngby</addr-line>, <country>Denmark</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding authors. E-mail: <email xlink:href="sbrix@dtu.dk">sbrix@dtu.dk</email>; <email xlink:href="xuxun@genomics.cn">xuxun@genomics.cn</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>2024</volume>
    <elocation-id>gigabyte110</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In spatially resolved transcriptomics, Stereo-seq facilitates the analysis of large tissues at the single-cell level, offering subcellular resolution and centimeter-level field-of-view. Our previous work on StereoCell introduced a one-stop software using cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. With advancements allowing the acquisition of cell boundary information, such as cell membrane/wall staining images, we updated our software to a new version, STCellbin. Using cell nuclei staining images, STCellbin aligns cell membrane/wall staining images with spatial gene expression maps. Advanced cell segmentation ensures the detection of accurate cell boundaries, leading to more reliable single-cell spatial gene expression profiles. We verified that STCellbin can be applied to mouse liver (cell membranes) and <italic toggle="yes">Arabidopsis</italic> seed (cell walls) datasets, outperforming other methods. The improved capability of capturing single-cell gene expression profiles results in a deeper understanding of the contribution of single-cell phenotypes to tissue biology.</p>
      <sec specific-use="heading-level-1" id="s0001">
        <title>Availability &amp; Implementation</title>
        <p>The source code of STCellbin is available at <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>National Key R&amp;D Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFC3400400</award-id>
      </award-group>
      <funding-statement>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0002">
    <title>Statement of need</title>
    <p>Spatially resolved single-cell transcriptomics enables the generation of comprehensive molecular maps that provide insights into the spatial distribution of molecules within individual cells constituting tissues. This groundbreaking technology offers insights into the location and function of cells across diverse tissues, advancing our understanding of organ development <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>, tumor heterogeneity <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>, cancer evolution <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content>, and other biological mechanisms. Resolution and field-of-view are critical parameters in spatial transcriptomics. Specifically, a high resolution provides detailed molecular information at the single-cell level, and a large field-of-view facilitates the creation of complete 3D maps, capturing biological functions at the organ level. Stereo-seq simultaneously achieves subcellular resolution and a centimeter-level field-of-view, providing the technical foundation for obtaining comprehensive spatial gene expression profiles of whole tissues at the single-cell level <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. Our previous work introduced StereoCell, a one-stop software for obtaining single-cell spatial gene expression profiles with a high signal-to-noise ratio from Stereo-seq data <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. StereoCell takes the cell nuclei staining image tiles and its corresponding spatial gene expression data as input, and it performs tasks such as image stitching, image registration, tissue segmentation, cell nuclei segmentation, and molecule labeling steps. Notably, Stereo-seq uses cell nuclei staining images; however, there exists a significant difference between cell nuclei and cell boundary staining images, based on cell membrane/wall staining, in terms of the ability to capture robust and precise cell-specific gene expression profiles. Despite the widespread use of spatial techniques, such as MERFISH <styled-content style-type="bibr-wrapper">[<xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>, CosMx <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>]</styled-content>, and Xenium <styled-content style-type="bibr-wrapper">[<xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>, several of these techniques struggle to provide accurate cell boundary information, as they rely on cell nuclei staining images generated using stains such as 4,6-diamidino-2-phenylindole (or DAPI). Hematoxylin-eosin and single-strand DNA fluorescence nuclei staining images are also commonly used and readily obtainable. The updated Stereo-seq technology incorporates a procedure leveraging simultaneous cell membrane/wall and cell nuclei staining by adding multiplex immunofluorescence (mIF) and calcofluor white (CFW) staining <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>, <xref rid="ref10" ref-type="bibr">10</xref>]</styled-content>, enabling to acquire more accurate cell boundary information automatically and, consequently, more reliable single-cell spatial gene expression profiles.</p>
    <p>Here, we updated StereoCell to a new version: STCellbin. The new version retains key steps from StereoCell, such as image stitching, tissue segmentation, and molecule labeling. Additionally, it incorporates improved image registration and cell segmentation steps. Notably, the “track line”, a crossed linear marker embedded on the Stereo-seq chip, is key to the image registration step of StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. As the cell membrane/wall staining images miss the “track line” information, the cell nuclei staining images are used to align the cell membrane/wall staining images with the spatial gene expression maps, thereby obtaining registered cell boundary information in the cell segmentation step. Based on the cell boundary information, STCellbin directly assigns the molecules to their corresponding cells, obtaining single-cell spatial gene expression profiles. We applied STCellbin to mouse liver (cell membrane) and <italic toggle="yes">Arabidopsis</italic> seed (cell wall) datasets and confirmed the accuracy of the cell segmentation provided by the software. This update offers a comprehensive workflow to obtain reliable single-cell spatial gene expression profiles based on cell membrane/wall information. Hence, STCellbin provides support and guidance, particularly for scientific investigations based on Stereo-seq data.</p>
  </sec>
  <sec id="s0003">
    <title>Implementation</title>
    <sec id="s0004">
      <title>Overview of STCellbin</title>
      <p>The process of STCellbin includes image stitching, image registration, cell segmentation, and molecule labeling (Figure <xref rid="gigabyte-2024-110-g001" ref-type="fig">1</xref>). Input into STCellbin includes Stereo-seq spatial gene expression data, alongside cell nuclei and cell membrane/wall staining image tiles. The stitched cell nuclei and cell membrane/wall staining images are obtained using the MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. These two stitched staining images are registered using a Fast Fourier Transform (FFT) algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>. The spatial gene expression data is transformed into a map, which is then registered with a stitched cell nuclei staining image based on “track line” information. Thus, the registration of the gene expression map and cell membrane/wall staining image is implemented. Cell segmentation is performed on the registered cell membrane/wall staining image using the adjusted Cellpose 2.0 tool <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> to obtain the cell mask. Molecules are then assigned to their corresponding cells based on the cell mask, thus generating the single-cell spatial gene expression profile. The tissue segmentation step based on Bi-Directional ConvLSTM U-Net <styled-content style-type="bibr-wrapper">[<xref rid="ref13" ref-type="bibr">13</xref>]</styled-content> is set as optional, and it can be used to generate a tissue mask to assist in filtering out impurities outside the tissue.</p>
      <fig position="float" id="gigabyte-2024-110-g001">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of STCellbin. The cell nuclei and cell membrane/wall staining image tiles are stitched into individual large images. The spatial gene expression map and stitched cell membrane/wall staining image are registered using the stitched cell nuclei staining image as a bridge. The cell mask is directly obtained from the registered cell membrane/wall staining image by cell segmentation. The single-cell spatial gene expression profile is obtained by overlaying the generated cell mask and the gene expression map.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g001" position="float"/>
      </fig>
    </sec>
    <sec id="s0005">
      <title>Image stitching</title>
      <p>The image stitching step in STCellbin is consistent with the one in StereoCell. The MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> leverages FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> to compute offsets between adjacent tiles featuring overlapping areas. This enables the stitching of these tiles, and the process is extended iteratively to encompass all tiles in the dataset. The relative error, absolute error, and computational efficiency of MFWS were assessed in our previous work <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0006">
      <title>Image registration</title>
      <p>The registration of STCellbin includes three stages. The first stage is the registration of the stitched cell nuclei and stitched cell membrane/wall staining images. These two staining images have similar sizes and no significant difference in rotation because the chip does not move when they are photographed. The key to this registration is to calculate their offset. The size of the cell membrane/wall staining image is adjusted to match that of the cell nuclei staining image through cutting and zero-padding (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>A). The two staining images are mean-based subsampled <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>B). The offset of the subsampled images is calculated through FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>, similarly to MFWS <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>C). Then, the calculated offset is restored to the scale of the original images (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>D). Thus, these two staining images can be registered.</p>
      <fig position="float" id="gigabyte-2024-110-g002">
        <label>Figure 2.</label>
        <caption>
          <p>Registration of the cell membrane/wall staining image and spatial gene expression map using the cell nuclei staining image as a bridge. (A) The size of the cell membrane/wall staining image is adjusted to be consistent with the cell nuclei staining image. (B) The cell nuclei and cell membrane/wall staining images are subsampled. (C) Calculation of the offsets of the subsampled images. (D) Restoring the offsets to the scale of the original images for registration. (E) Registration of the spatial gene expression map and cell nuclei staining image by performing scaling, rotating, flipping, and translating, followed by the registration of the spatial gene expression map and cell membrane/wall staining image by performing the same operations.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g002" position="float"/>
      </fig>
      <p> The second stage is the registration of the stitched nuclei staining image and spatial gene expression map. This registration is the same as in StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. The spatial gene expression data is transformed into a map. The stitched cell nuclei staining image is registered with the map based on “track line” information, involving scaling, rotating, flipping, and translating on the stitched cell nuclei staining image.</p>
      <p>The third stage is the registration of the stitched cell membrane/wall staining image and the spatial gene expression map. Since the cell nuclei and cell membrane/wall staining images have been registered in the first stage, the same operations of the second stage, including scaling, rotating, flipping, and translating, are applied to the cell membrane/wall staining image (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>E). Then, the cell membrane/wall staining image and spatial gene expression map can be registered. Moreover, when utilizing staining images produced with a multi-channel microscope, STCellbin can omit the registration among these images. STCellbin can also process the case of multiple mIF staining images captured from identical tissues using the same microscope when there is only a difference in offsets among these images.</p>
    </sec>
    <sec id="s0007">
      <title>Cell segmentation</title>
      <p>The cell segmentation step of STCellbin uses Cellpose 2.0 <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> with some adjustments. The model architecture of Cellpose 2.0 and its weight files “cyto2” are downloaded. However, due to the large size of the staining images derived from Stereo-seq data, Cellpose 2.0 cannot be executed smoothly using normal hardware configurations. To address this issue, the staining images are cropped into multiple tiles with overlapping areas to perform cell segmentation and record the coordinates of these tiles. The overlapping areas prevent cells at the border of the tiles from being cropped. For optimal results, segmentations with different values of the cell diameter are performed independently, and the segmentation yielding the highest total cell area is retained. Next, all the segmented tiles are assembled into the final segmented result according to the recorded coordinates. Moreover, when selecting the tissue segmentation option, an additional step involves applying a filter to the cell mask using the tissue mask, resulting in a refined segmented output.</p>
    </sec>
    <sec id="s0008">
      <title>Molecule labeling</title>
      <p>The molecule labeling of STCellbin is the same as in StereoCell, in principle. StereoCell assigns molecules from the cell nuclei to the cell by using the cell nuclei mask, and then assigns molecules outside the cell nuclei to the cells with the highest probability density using a Gaussian Mixture Model <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content>. Conversely, STCellbin directly assigns molecules to the cells based on the cell mask, while assigning molecules outside the cell is optional. This decision was driven by the observation that cell membranes/walls are usually tightly packed, with a few molecules appearing outside the cells, and the assignment of these molecules may take a lot of time. Thus, we generally do not recommend this option, and users can choose to employ it based on particular requirements.</p>
    </sec>
  </sec>
  <sec id="s0009">
    <title>Results</title>
    <sec id="s0010">
      <title>Datasets and computing resource</title>
      <p>We selected two datasets acquired via Stereo-seq technology <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. One was a mouse liver dataset, a tissue that offers cell boundary information via cell membranes, as in all mammalian tissues. The other dataset was derived from seeds of the plant <italic toggle="yes">Arabidopsis</italic>, a tissue that provides cell boundary information based on rigid cell walls. More details of the two datasets are shown in Table <xref rid="gigabyte-2024-110-t001" ref-type="table">1</xref>.</p>
      <table-wrap position="float" id="gigabyte-2024-110-t001">
        <label>Table 1</label>
        <caption>
          <p>Details of two datasets used for evaluation of cell boundary information.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="center" width="34%"/>
            <col span="1" align="center" width="33%"/>
            <col span="1" align="center" width="33%"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" rowspan="1" colspan="1"> Detail</th>
              <th align="center" rowspan="1" colspan="1">Mouse liver dataset</th>
              <th align="center" rowspan="1" colspan="1"><italic toggle="yes">Arabidopsis</italic> seed dataset</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Data source</td>
              <td align="center" rowspan="1" colspan="1"> A slice of liver</td>
              <td align="center" rowspan="1" colspan="1"> Slices of multiple seeds</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell nuclei dye</td>
              <td align="center" rowspan="1" colspan="1"> DAPI</td>
              <td align="center" rowspan="1" colspan="1"> ssDNA</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell membrane/wall dye</td>
              <td align="center" rowspan="1" colspan="1"> mIF</td>
              <td align="center" rowspan="1" colspan="1"> CFW</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Number of molecules</td>
              <td align="center" rowspan="1" colspan="1"> 16,177,288</td>
              <td align="center" rowspan="1" colspan="1"> 62,884,637</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The experiment for image segmentation was implemented on the STOmics cloud platform <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with these settings: 32 CPUs, 32 GB memory, and “ALL” resource type. An exception was the watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>, which was implemented using ImageJ on a computer with a 16-core CPU and 16 GB of RAM. Also, the experiment for downstream analysis was implemented on a server with a 40-core CPU, 128 GB of RAM, and 24 GB of GPU.</p>
    </sec>
    <sec id="s0011">
      <title>Evaluation criteria for cell segmentation performance</title>
      <p>In a cell mask image, the gray value of a pixel is set to 255 in the cell area and 0 in the background. True positive (TP, the number of pixels with gray value of 255 in both ground truth and segmented result), true negative (TN, the number of pixels with gray value of 0 in both ground truth and segmented result), false positive (FP, the number of pixels with gray value of 0 in ground truth and 255 in segmented result) and false negative (FN, the number of pixels with gray value of 255 in ground truth and 0 in segmented result) are calculated. The number of cells segmented by a method is <italic toggle="yes">ns</italic>. For each segmented cell (cell<sub><italic toggle="yes">i</italic></sub>), there should be a corresponding area in the ground truth (area<sub><italic toggle="yes">i</italic></sub>), where <italic toggle="yes">i</italic> is the cell index (<italic toggle="yes">i</italic> = 1,  2, …, <italic toggle="yes">ns</italic>). The intersection over union metric (IoU) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> is set as: <disp-formula id="eqn0001"><label>(1)</label><alternatives><tex-math id="d2e737">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{IoU}_{i}=\text{ao}_{i}/\text{au}_{i}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math001" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>ao</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mtext>au</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula> where ao<sub><italic toggle="yes">i</italic></sub> is the overlap area between cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>, and au<sub><italic toggle="yes">i</italic></sub> is the union area of cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>. Then the precision (Pre), recall (Rec), F1 score (F1_<italic toggle="yes">s</italic>), Dice coefficient (Dc), and average Jaccard index (Avg_<italic toggle="yes">J</italic>) are calculated as:<disp-formula id="eqn0002"><label>(2)</label><alternatives><tex-math id="d2e801">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Pre} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FP}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math002" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Pre</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0003"><label>(3)</label><alternatives><tex-math id="d2e836">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Rec} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math003" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Rec</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0004"><label>(4)</label><alternatives><tex-math id="d2e870">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{F}1\_s &amp; = &amp; \displaystyle 2\times (\text{Pre}\times \text{Rec})/(\text{Pre}+\text{Rec}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math004" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>F</mml:mtext><mml:mn>1</mml:mn><mml:mi>\_</mml:mi><mml:mi>s</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0005"><label>(5)</label><alternatives><tex-math id="d2e924">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Dc} &amp; = &amp; \displaystyle 2\times \text{TP}/(2\times \text{TP}+\text{FP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math005" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Dc</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0006"><label>(6)</label><alternatives><tex-math id="d2e970">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Avg}\_J &amp; = &amp; \displaystyle \mathop{\sum }_{i=1}^{ns}\text{IoU}_{i}/ns. \end{eqnarray*}\end{document}</tex-math><mml:math id="math006" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Avg</mml:mtext><mml:mi>\_</mml:mi><mml:mi>J</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0012">
      <title>Process and evaluation of downstream analysis</title>
      <p>The generated single-cell spatial gene expression profiles were input into Stereopy (v0.6.0) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>. The cells with fewer than ten expressed genes, fewer than three expression counts, and more than 3% mitochondrial genes were removed; genes present in less than three cells were also removed. After normalization, the differentially expressed genes were summarized using Principal Component Analysis to reduce the data dimensionality. Specifically, the number of features was reduced to 10. The Leiden algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content> was used for clustering, and the Uniform Manifold Approximation and Projection (UMAP) algorithm (RRID:<named-content content-type="rrid">SCR_018217</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref21" ref-type="bibr">21</xref>]</styled-content> was used to obtain 2D data projections. The Silhouette coefficient (Sc) and Moran’s I (MI) were used to evaluate the effect of clustering and the spatial self-correlation of each cluster, respectively. Sc is calculated as: <disp-formula id="eqn0007"><label>(7)</label><alternatives><tex-math id="d2e1049">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{Sc}=(b_{j}-a_{j})/\max \{a_{j},b_{j}\}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math007" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>Sc</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">a</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and other samples in its cluster, and <italic toggle="yes">b</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and the samples in other clusters. MI is calculated as: <disp-formula id="eqn0008"><label>(8)</label><alternatives><tex-math id="d2e1125">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{MI}=(n/W_{0})(\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}(y_{k}-\overline{y})(y_{l}-\overline{y})/\mathop{\sum }_{k=1}^{n}⁡(y_{k}-\overline{y})^{2}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math008" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>MI</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">n</italic> is the number of clusters, <italic toggle="yes">y</italic>
<sub><italic toggle="yes">k</italic></sub> and <italic toggle="yes">y</italic>
<sub><italic toggle="yes">l</italic></sub> are the attribute values of the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, respectively, <overline><italic toggle="yes">y</italic></overline> is the mean of all cluster attributes, 𝜔<sub><italic toggle="yes">k</italic>, <italic toggle="yes">l</italic></sub> is the spatial weight between the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, and <italic toggle="yes">W</italic>
<sub>0</sub> is the aggregation of all spatial weights as: <disp-formula id="eqn0009"><label>(9)</label><alternatives><tex-math id="d2e1325">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    W_{0}=\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}. \end{eqnarray*}\end{document}</tex-math><mml:math id="math009" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0013">
      <title>STCellbin more accurately segments cells based on cell membrane/wall staining images</title>
      <p>We cropped two areas with higher image quality from the two datasets and designed their ground truths based on the manual markup of the cells according to the cell membranes/walls in the staining images. The cell segmentation method of STCellbin was compared with the original Cellpose <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content>, the state-of-the-art method DeepCell <styled-content style-type="bibr-wrapper">[<xref rid="ref22" ref-type="bibr">22</xref>]</styled-content>, and a traditional watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>.</p>
      <p>Using the mouse liver dataset, STCellbin effectively identified cell membranes for segmentation, yielding cell masks that demonstrated acceptable agreement with the stating image and ground truth (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, upper). Among all cell mask images, STCellbin provided the best description of the cell boundaries, outperforming other methods, which missed quite a few cells (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, lower). We observed a similar trend using the <italic toggle="yes">Arabidopsis</italic> seed dataset, showing that STCellbin can also effectively identify cell walls for segmentation (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>B). Compared with other methods, STCellbin obtained higher values across most indicators on these two datasets (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>C). The comparison with the original Cellpose validated the effectiveness of STCellbin in adjusting segmentation. While DeepCell is a powerful method, it is primarily designed for segmenting cell nuclei, which involves identifying highlighted areas in the nuclei staining images. This strategy is unsuitable for cell membrane/wall staining images, resulting in less desirable results. Similarly, the traditional watershed method performs poorly on cell membrane/wall staining images. In summary, STCellbin’s cell segmentation emerged as the most practical and effective method.</p>
      <fig position="float" id="gigabyte-2024-110-g003">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of cell segmentation performance. (A) Cell segmentation results on the cropped area from the mouse liver dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (B) Cell segmentation results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (C) Indicator comparison of cell segmentation results on the cropped areas from the mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g003" position="float"/>
      </fig>
    </sec>
    <sec id="s0014">
      <title>STCellbin generates more reliable single-cell spatial gene expression profiles for downstream analysis</title>
      <p>Currently, there is a lack of image-based one-stop software like STCellbin for Stereo-seq data. Therefore, we compared STCellbin with Baysor (v0.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref23" ref-type="bibr">23</xref>]</styled-content>, a tool that generates the spatial gene expression profile without relying on images. However, Baysor could not output results on the complete mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets in an acceptable time or a given computational resource. We ran Baysor on a smaller <italic toggle="yes">Arabidopsis</italic> seed dataset, which was the cropped area in the cell segmentation experiment and contained two complete seed data.</p>
      <p>The cell area, number of unique genes per cell, and number of gene counts per cell were statistically calculated from the results of STCellbin (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>A). The clustering results of STCellbin were obtained utilizing the generated single-cell spatial gene expression profiles. The clusters of cells were spatially mapped within the tissue (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, left-hand side for each tissue), allowing for the observation of their specific positions. From the UMAPs, it was apparent that the different cell types were effectively distinguished (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, right-hand side for each tissue). The spatial location of the different cell types positively influenced a series of downstream analyses, such as cellular annotation in less well-studied tissues.</p>
      <fig position="float" id="gigabyte-2024-110-g004">
        <label>Figure 4.</label>
        <caption>
          <p>Downstream analysis results and comparison. (A) Statistical results of cell area, gene number per cell, and gene expression per cell of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (B) Clustering results and UMAPs of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (C) Indicator comparison of downstream analysis results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset, where <italic toggle="yes">Sc</italic> and <italic toggle="yes">MI</italic> are averaged across all clusters.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g004" position="float"/>
      </fig>
      <p> The cells were clustered into seven clusters on the profile of STCellbin, and 14 clusters on the profile of Baysor (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the first subfigure from the left). We observed that the number of cells segmented by Baysor was significantly higher than that segmented by STCellbin, and it did not align with the cell count observed in the ground truth image. This fact could account for the higher number of clusters produced by Baysor. The Sc and MI obtained by both STCellbin and Baysor were not satisfactory (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the second and third subfigures from the left), possibly due to the limited information from a small dataset. Nevertheless, the values from STCellbin were higher than those from Baysor. Moreover, STCellbin demonstrated significant advantages in terms of computing resource usage and running time (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the fourth and fifth subfigures from the left), which also explains why Baysor was unable to process the complete mouse liver and Arabidopsis seed datasets.</p>
      <p>It should be noted that the stitching and registration steps of STCellbin could not be performed on the cropped dataset. Hence, the corresponding computational resource usage and running time could not be recorded. Thus, the resource usage and time of STCellbin for comparison were obtained on the complete <italic toggle="yes">Arabidopsis</italic> seed dataset. Specifically, STCellbin was able to process a larger dataset with fewer computational resources and less time compared to Baysor. Overall, STCellbin is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data.</p>
    </sec>
  </sec>
  <sec id="s0015">
    <title>Discussion</title>
    <p>Accurate identification of cell boundaries is crucial in generating single-cell resolution in spatial omics applications. Building upon previous work in StereoCell, which uses cell nuclei staining images to generate single-cell spatial gene expression profiles, this STCellbin update extends the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries, thereby facilitating downstream analyses. We also showcased a few examples of the performance of cell membrane/wall segmentation in STCellbin. Currently, the tools for cell nuclei and cell membrane/wall segmentation can be independently executed, allowing users to choose the most suitable solution for their specific applications. In future work, these two techniques could be combined by training a deep learning model compatible with any staining image type, thereby achieving more accurate results.</p>
  </sec>
  <sec id="s0016">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: STCellbin</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: Python</p>
        </list-item>
        <list-item>
          <p>Other requirements: Python 3.8</p>
        </list-item>
        <list-item>
          <p>License: MIT License</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024438</named-content></p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank China National GeneBank for providing technical support.</p>
  </ack>
  <sec sec-type="data-availability" id="s0017">
    <title>Data availability</title>
    <p>The data that support the findings of this study have been deposited into the Spatial Transcript Omics DataBase (STOmics DB) of the China National GeneBank DataBase (CNGBdb), with accession number <ext-link xlink:href="https://db.cngb.org/stomics/project/STT0000048" ext-link-type="uri" specific-use="url">STT0000048</ext-link>. A backup for the data is also provided at the Github link of STCellbin <styled-content style-type="bibr-wrapper">[<xref rid="ref24" ref-type="bibr">24</xref>]</styled-content>. Archival snapshots of the code are also available from software heritage (Figure <xref rid="gigabyte-2024-110-g005" ref-type="fig">5</xref>) <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.</p>
    <fig position="float" id="gigabyte-2024-110-g005" fig-type="softwareHeritageUrl">
      <label>Figure 5.</label>
      <caption>
        <p>The Software Heritage archive of the software <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.<ext-link xlink:href="https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/" ext-link-type="uri" specific-use="softwareHeritageUrl">https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/</ext-link></p>
      </caption>
      <graphic xlink:href="gigabyte-2024-110-g005" position="float"/>
    </fig>
  </sec>
  <sec id="s0018">
    <title>Abbreviations</title>
    <p>FFT, Fast Fourier Transform; MI, Moran’s I; mIF, multiplex immunofluorescence; Sc, Silhouette coefficient; UMAP, Uniform Manifold Approximation and Projection.</p>
  </sec>
  <sec id="s0019">
    <title>Declarations</title>
    <sec id="s0020">
      <title>Ethics approval and consent to participate</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0021">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="s0022">
      <title>Authors’ contributions</title>
      <p>Conceptualization: BZ and ML. Project administration and supervision: SB and XX. Software implementation: ZD, HQ, KS, and HL. Data collection and processing: QK, XF, and LC. Validation: QK and ZD. Project coordination: BZ and ML. Manuscript writing and figure generation: BZ, ML, and QK. Manuscript review: ML, SF, YZ, YL and SB.</p>
    </sec>
    <sec id="s0023">
      <title>Funding</title>
      <p>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Computational approaches and challenges in spatial transcriptomics</article-title>. <source>Genom. Proteom. Bioinform.</source>, <year>2023</year>; <volume>21</volume>: <fpage>24</fpage>–<lpage>47</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2022.10.001</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>T</given-names></name>, <name><surname>Ang</surname><given-names>CE</given-names></name>, <name><surname>Zhuang</surname><given-names>X</given-names></name>. </person-group><article-title>Spatially resolved epigenomic profiling of single cells in complex tissues</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>4448</fpage>–<lpage>4464</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2023.04.006</pub-id>.<pub-id pub-id-type="pmid">36272405</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erickson</surname><given-names>A</given-names></name>, <name><surname>He</surname><given-names>M</given-names></name>, <name><surname>Berglund</surname><given-names>E</given-names></name><etal/></person-group><article-title>Spatially resolved clonal copy number alterations in benign and malignant tissue</article-title>. <source>Nature</source>, <year>2022</year>; <volume>608</volume>: <fpage>360</fpage>–<lpage>367</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41586-022-05023-2</pub-id>.<pub-id pub-id-type="pmid">35948708</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Cheng</surname><given-names>M</given-names></name><etal/></person-group><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>1777</fpage>–<lpage>1792</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2022.04.003</pub-id>.<pub-id pub-id-type="pmid">35512705</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name><etal/></person-group><article-title>StereoCell enables highly accurate single-cell segmentation for spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.02.28.530414</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>KH</given-names></name>, <name><surname>Boettiger</surname><given-names>AN</given-names></name>, <name><surname>Moffitt</surname><given-names>JR</given-names></name><etal/></person-group><article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>. <source>Science</source>, <year>2015</year>; <volume>348</volume>: <elocation-id content-type="artnum">aaa6090</elocation-id>. doi:<pub-id pub-id-type="doi">10.1126/science.aaa6090</pub-id>.<pub-id pub-id-type="pmid">25858977</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>S</given-names></name>, <name><surname>Bhatt</surname><given-names>R</given-names></name>, <name><surname>Brown</surname><given-names>C</given-names></name><etal/></person-group><article-title>High-plex imaging of RNA and proteins at subcellular resolution in fixed tissue by spatial molecular imaging</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>1794</fpage>–<lpage>1806</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-022-01483-z</pub-id>.<pub-id pub-id-type="pmid">36203011</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janesick</surname><given-names>A</given-names></name>, <name><surname>Shelansky</surname><given-names>R</given-names></name>, <name><surname>Gottscho</surname><given-names>AD</given-names></name><etal/></person-group><article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>. <source>Nat. Commun.</source>, <year>2023</year>; <volume>14</volume>(<issue>1</issue>): <elocation-id content-type="artnum">8353</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41467-023-43458-x</pub-id>.<pub-id pub-id-type="pmid">38114474</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Heng</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name><etal/></person-group><article-title>Integrated spatial transcriptomic and proteomic analysis of fresh frozen tissue based on stereo-seq</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.04.28.538364</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOmics Documentation</collab></person-group>. <ext-link xlink:href="https://en.stomics.tech/" ext-link-type="uri" specific-use="url">https://en.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duhamel</surname><given-names>P</given-names></name>, <name><surname>Vetterli</surname><given-names>M</given-names></name>. </person-group><article-title>Fast fourier transforms: A tutorial review and a state of the art</article-title>. <source>Signal Process.</source>, <year>1990</year>; <volume>19</volume>(<issue>4</issue>): <fpage>259</fpage>–<lpage>299</lpage>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name>, <name><surname>Stringer</surname><given-names>C</given-names></name>. </person-group><article-title>Cellpose 2.0: how to train your own model</article-title>. <source>Nat. Methods</source>, <year>2022</year>; <volume>19</volume>: <fpage>1634</fpage>–<lpage>1641</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-022-01663-4</pub-id>.<pub-id pub-id-type="pmid">36344832</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Azad</surname><given-names>R</given-names></name>, <name><surname>Asadi-Aghbolaghi</surname><given-names>M</given-names></name>, <name><surname>Fathy</surname><given-names>M</given-names></name><etal/></person-group><part-title>Bi-Directional ConvLSTM U-Net with densley connected convolutions</part-title>. In: <source>IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</source>. <year>2019</year>. pp. <fpage>406</fpage>–<lpage>415</lpage>, doi:<pub-id pub-id-type="doi">10.1109/ICCVW.2019.00052</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levina</surname><given-names>A</given-names></name>, <name><surname>Priesemann</surname><given-names>V</given-names></name>. </person-group><article-title>Subsampling scaling</article-title>. <source>Nat. Commun.</source>, <year>2017</year>; <volume>8</volume>: <elocation-id content-type="artnum">15140</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/ncomms15140</pub-id>.<pub-id pub-id-type="pmid">28469176</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>D</given-names></name>. </person-group><part-title>Gaussian mixture models</part-title>. In: <person-group person-group-type="editor"><name content-type="editor"><surname>Li</surname><given-names>SZ</given-names></name>, <name content-type="editor"><surname>Jain</surname><given-names>A</given-names></name></person-group> (eds), <source>Encyclopaedia of Biometrics</source>. vol. <volume>741</volume>, <publisher-loc>Boston, MA</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2009</year>; pp. <fpage>659</fpage>–<lpage>663</lpage>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOMICs Cloud</collab></person-group>. <ext-link xlink:href="https://cloud.stomics.tech/" ext-link-type="uri" specific-use="url">https://cloud.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>T</given-names></name>, <name><surname>Tong</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Review of research on the instance segmentation of cell images</article-title>. <source>Comput. Meth. Prog. Bio.</source>, <year>2022</year>; <volume>227</volume>: <elocation-id content-type="artnum">107211</elocation-id>. doi:<pub-id pub-id-type="doi">10.1016/j.cmpb.2022.107211</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Michaelos</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cellpose: a generalist algorithm for cellular Segmentation</article-title>. <source>Nat. Methods</source>, <year>2021</year>; <volume>18</volume>: <fpage>100</fpage>–<lpage>106</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>.<pub-id pub-id-type="pmid">33318659</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Cao</surname><given-names>L</given-names></name><etal/></person-group><article-title>Stereopy: modeling comparative and spatiotemporal cellular heterogeneity via multi-sample spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.12.04.569485</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name>, <name><surname>Waltman</surname><given-names>L</given-names></name>, <name><surname>Van Eck</surname><given-names>NJ</given-names></name>. </person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep.</source>, <year>2019</year>; <volume>9</volume>: <elocation-id content-type="artnum">5233</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>.<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name>, <name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name><etal/></person-group><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat. Biotechnol.</source>, <year>2019</year>; <volume>37</volume>: <fpage>38</fpage>–<lpage>44</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenwald</surname><given-names>NF</given-names></name>, <name><surname>Miller</surname><given-names>G</given-names></name>, <name><surname>Moen</surname><given-names>E</given-names></name><etal/></person-group><article-title>Whole-cell segmentation of tissue images with human-level performance using large-scale data annotation and deep learning</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>555</fpage>–<lpage>565</lpage>.<pub-id pub-id-type="pmid">34795433</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petukhov</surname><given-names>V</given-names></name>, <name><surname>Xu</surname><given-names>RJ</given-names></name>, <name><surname>Soldatov</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>10</volume>: <fpage>345</fpage>–<lpage>354</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-021-01044-w</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STCellbin GitHub</collab></person-group>. <year>2023</year>; <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Kang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>STCellbin</article-title> (Version 1) [Computer software]. <italic toggle="yes">Software Heritage</italic>. <year>2024</year>; <ext-link xlink:href="https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0" ext-link-type="uri" specific-use="url">https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e2697">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2703">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2709">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2715">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>03</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>04</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2721">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>08</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">chunquan Li</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Unable to test</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">Stereo-seq, an advanced spatial transcriptomics technique, allows detailed analysis of large tissues at the single-cell level with precise subcellular resolution. Author's prior software was groundbreaking, generating robust single-cell spatial gene expression profiles using cell nuclei staining images and statistical methods. They've enhanced their software to STCellbin, using cell nuclei images to align cell membrane/wall staining images. This update employs improved cell segmentation, ensuring accurate boundaries and more dependable single-cell spatial gene expression profiles. Successful tests on mouse liver and Arabidopsis seed datasets demonstrate STCellbin's effectiveness, enabling a deeper insight into the role of single-cell characteristics in tissue biology. However, I do have some suggestions and questions about certain parts of the manuscript.&#13; &#13; &#13; 1. The authors should show the advantages and performance of STCellbin compared to other methods, such as its computational efficiency, accuracy, and suitability for various image types. &#13; 2. To comprehensively assess the performance of STCellbin, the authors should consider integrating other commonly used cell segmentation evaluation metrics, such as F1-score, Dice coefficient, and so forth.&#13; 3. To ensure the completeness and reproducibility of the data analysis, more detailed information regarding the clustering analysis of the single-cell spatial gene expression maps generated through STCellbin is requested. This information should encompass methods, parameters, and results such as cluster type annotations.&#13; 4. The authors can use simpler and clearer language and terminology to describe the image registration process in the methods section, ensuring that readers can easily understand the workflow and principles of image registration.&#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Major Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2727">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Wang</surname>
            <given-names>Zhaowei</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Zhaowei Wang</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">In this manuscript, the authors propose STCellbin to generate single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images. The experiment results on mouse liver and Arabidopsis seed datasets prove the good performance of STCellbin. The topic is significant and the proposed method is feasible. However, there are still some concerns and problems to be improved and clarified.&#13; &#13; (1) STCellbin is an update version of StereoCell, but the explanation of StereoCell is not sufficient. The authors should give a more detailed explanation of StereoCell, such as its input and main process.&#13; &#13; (2) The authors list some existing dyeing methods in Lines 52-53, Page 3. They should clarify that these methods are used for nuclei staining, which differentiate them from the cell membrane/wall staining methods of following content. It can provide a more accurate explanation for readers and users.&#13; &#13; (3) The authors share the GitHub repository of STCellbin, and I noticed that when executing STCellbin, the input only requires the path of image data and spatial gene expression data, the path of the output results, and the chip number. Are there other adjustable parameters?&#13; &#13; (4) In Page 5, Line 85, “steps” should be “step”, and in Page 8, Line 145, “must” would be better revised to “should”. Moreover, the writing of “stained image” and “staining image” should be consistent.&#13; &#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2734">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>18</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e2425">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Major Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2431">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2437">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Re-Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>29</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Comments on revised manuscript</td>
            <td rowspan="1" colspan="1">It is suitable for publication now. </td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2443">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2449">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2455">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2462">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">This paper describes a new spatial transcriptomics method that that utilizes cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. STCellbin is an update of StereoCell, now using a more advanced cell segmentation technique, so more accurate cell boundaries can be obtained, allowing more reliable single-cell spatial gene expression profiles to be obtained. After peer review more comparisons were added and more description given on what was upgraded in this version to convince the reviewers. Demonstrating it is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data. And extending the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2468">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e2697?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10905256</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202312-01</article-id>
    <article-id pub-id-type="publisher-id">110</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.110</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.1101/2023.12.25.573324</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Genetics and Genomics</subject>
        <subject>Bioinformatics</subject>
        <subject>Developmental Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</article-title>
      <alt-title alt-title-type="left-running-head">B. Zhang <italic toggle="yes">et al.</italic>
</alt-title>
      <alt-title alt-title-type="right-running-head">Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6654-3567</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Bohan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3310-2911</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Mei</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6579-7944</contrib-id>
        <name>
          <surname>Kang</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Zhonghan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0004-6887-6743</contrib-id>
        <name>
          <surname>Qin</surname>
          <given-names>Hua</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6304-9907</contrib-id>
        <name>
          <surname>Su</surname>
          <given-names>Kui</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0000-2977-4059</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Xiuwen</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3635-0817</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Lichuan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Huanlin</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="supporting">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4126-0074</contrib-id>
        <name>
          <surname>Fang</surname>
          <given-names>Shuangsang</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9950-1793</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yong</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuxiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8951-6705</contrib-id>
        <name>
          <surname>Brix</surname>
          <given-names>Susanne</given-names>
        </name>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5338-5173</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Xun</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration" degree-contribution="lead">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision" degree-contribution="lead">Supervision</role>
        <xref rid="cor1" ref-type="corresp">
          <sup>*</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Shenzhen</addr-line>, <addr-line content-type="postcode">518083</addr-line>, <country>China</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Beijing</addr-line>, <addr-line content-type="postcode">102601</addr-line>, <country>China</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Biotechnology and Biomedicine</addr-line>, <institution>Technical University of Denmark</institution>, <addr-line content-type="postcode">2800</addr-line>, <addr-line content-type="city">Kgs. Lyngby</addr-line>, <country>Denmark</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding authors. E-mail: <email xlink:href="sbrix@dtu.dk">sbrix@dtu.dk</email>; <email xlink:href="xuxun@genomics.cn">xuxun@genomics.cn</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>2024</volume>
    <elocation-id>gigabyte110</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In spatially resolved transcriptomics, Stereo-seq facilitates the analysis of large tissues at the single-cell level, offering subcellular resolution and centimeter-level field-of-view. Our previous work on StereoCell introduced a one-stop software using cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. With advancements allowing the acquisition of cell boundary information, such as cell membrane/wall staining images, we updated our software to a new version, STCellbin. Using cell nuclei staining images, STCellbin aligns cell membrane/wall staining images with spatial gene expression maps. Advanced cell segmentation ensures the detection of accurate cell boundaries, leading to more reliable single-cell spatial gene expression profiles. We verified that STCellbin can be applied to mouse liver (cell membranes) and <italic toggle="yes">Arabidopsis</italic> seed (cell walls) datasets, outperforming other methods. The improved capability of capturing single-cell gene expression profiles results in a deeper understanding of the contribution of single-cell phenotypes to tissue biology.</p>
      <sec specific-use="heading-level-1" id="s0001">
        <title>Availability &amp; Implementation</title>
        <p>The source code of STCellbin is available at <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>National Key R&amp;D Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFC3400400</award-id>
      </award-group>
      <funding-statement>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0002">
    <title>Statement of need</title>
    <p>Spatially resolved single-cell transcriptomics enables the generation of comprehensive molecular maps that provide insights into the spatial distribution of molecules within individual cells constituting tissues. This groundbreaking technology offers insights into the location and function of cells across diverse tissues, advancing our understanding of organ development <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>, tumor heterogeneity <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>, cancer evolution <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content>, and other biological mechanisms. Resolution and field-of-view are critical parameters in spatial transcriptomics. Specifically, a high resolution provides detailed molecular information at the single-cell level, and a large field-of-view facilitates the creation of complete 3D maps, capturing biological functions at the organ level. Stereo-seq simultaneously achieves subcellular resolution and a centimeter-level field-of-view, providing the technical foundation for obtaining comprehensive spatial gene expression profiles of whole tissues at the single-cell level <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. Our previous work introduced StereoCell, a one-stop software for obtaining single-cell spatial gene expression profiles with a high signal-to-noise ratio from Stereo-seq data <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. StereoCell takes the cell nuclei staining image tiles and its corresponding spatial gene expression data as input, and it performs tasks such as image stitching, image registration, tissue segmentation, cell nuclei segmentation, and molecule labeling steps. Notably, Stereo-seq uses cell nuclei staining images; however, there exists a significant difference between cell nuclei and cell boundary staining images, based on cell membrane/wall staining, in terms of the ability to capture robust and precise cell-specific gene expression profiles. Despite the widespread use of spatial techniques, such as MERFISH <styled-content style-type="bibr-wrapper">[<xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>, CosMx <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>]</styled-content>, and Xenium <styled-content style-type="bibr-wrapper">[<xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>, several of these techniques struggle to provide accurate cell boundary information, as they rely on cell nuclei staining images generated using stains such as 4,6-diamidino-2-phenylindole (or DAPI). Hematoxylin-eosin and single-strand DNA fluorescence nuclei staining images are also commonly used and readily obtainable. The updated Stereo-seq technology incorporates a procedure leveraging simultaneous cell membrane/wall and cell nuclei staining by adding multiplex immunofluorescence (mIF) and calcofluor white (CFW) staining <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>, <xref rid="ref10" ref-type="bibr">10</xref>]</styled-content>, enabling to acquire more accurate cell boundary information automatically and, consequently, more reliable single-cell spatial gene expression profiles.</p>
    <p>Here, we updated StereoCell to a new version: STCellbin. The new version retains key steps from StereoCell, such as image stitching, tissue segmentation, and molecule labeling. Additionally, it incorporates improved image registration and cell segmentation steps. Notably, the “track line”, a crossed linear marker embedded on the Stereo-seq chip, is key to the image registration step of StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. As the cell membrane/wall staining images miss the “track line” information, the cell nuclei staining images are used to align the cell membrane/wall staining images with the spatial gene expression maps, thereby obtaining registered cell boundary information in the cell segmentation step. Based on the cell boundary information, STCellbin directly assigns the molecules to their corresponding cells, obtaining single-cell spatial gene expression profiles. We applied STCellbin to mouse liver (cell membrane) and <italic toggle="yes">Arabidopsis</italic> seed (cell wall) datasets and confirmed the accuracy of the cell segmentation provided by the software. This update offers a comprehensive workflow to obtain reliable single-cell spatial gene expression profiles based on cell membrane/wall information. Hence, STCellbin provides support and guidance, particularly for scientific investigations based on Stereo-seq data.</p>
  </sec>
  <sec id="s0003">
    <title>Implementation</title>
    <sec id="s0004">
      <title>Overview of STCellbin</title>
      <p>The process of STCellbin includes image stitching, image registration, cell segmentation, and molecule labeling (Figure <xref rid="gigabyte-2024-110-g001" ref-type="fig">1</xref>). Input into STCellbin includes Stereo-seq spatial gene expression data, alongside cell nuclei and cell membrane/wall staining image tiles. The stitched cell nuclei and cell membrane/wall staining images are obtained using the MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. These two stitched staining images are registered using a Fast Fourier Transform (FFT) algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>. The spatial gene expression data is transformed into a map, which is then registered with a stitched cell nuclei staining image based on “track line” information. Thus, the registration of the gene expression map and cell membrane/wall staining image is implemented. Cell segmentation is performed on the registered cell membrane/wall staining image using the adjusted Cellpose 2.0 tool <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> to obtain the cell mask. Molecules are then assigned to their corresponding cells based on the cell mask, thus generating the single-cell spatial gene expression profile. The tissue segmentation step based on Bi-Directional ConvLSTM U-Net <styled-content style-type="bibr-wrapper">[<xref rid="ref13" ref-type="bibr">13</xref>]</styled-content> is set as optional, and it can be used to generate a tissue mask to assist in filtering out impurities outside the tissue.</p>
      <fig position="float" id="gigabyte-2024-110-g001">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of STCellbin. The cell nuclei and cell membrane/wall staining image tiles are stitched into individual large images. The spatial gene expression map and stitched cell membrane/wall staining image are registered using the stitched cell nuclei staining image as a bridge. The cell mask is directly obtained from the registered cell membrane/wall staining image by cell segmentation. The single-cell spatial gene expression profile is obtained by overlaying the generated cell mask and the gene expression map.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g001" position="float"/>
      </fig>
    </sec>
    <sec id="s0005">
      <title>Image stitching</title>
      <p>The image stitching step in STCellbin is consistent with the one in StereoCell. The MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> leverages FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> to compute offsets between adjacent tiles featuring overlapping areas. This enables the stitching of these tiles, and the process is extended iteratively to encompass all tiles in the dataset. The relative error, absolute error, and computational efficiency of MFWS were assessed in our previous work <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0006">
      <title>Image registration</title>
      <p>The registration of STCellbin includes three stages. The first stage is the registration of the stitched cell nuclei and stitched cell membrane/wall staining images. These two staining images have similar sizes and no significant difference in rotation because the chip does not move when they are photographed. The key to this registration is to calculate their offset. The size of the cell membrane/wall staining image is adjusted to match that of the cell nuclei staining image through cutting and zero-padding (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>A). The two staining images are mean-based subsampled <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>B). The offset of the subsampled images is calculated through FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>, similarly to MFWS <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>C). Then, the calculated offset is restored to the scale of the original images (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>D). Thus, these two staining images can be registered.</p>
      <fig position="float" id="gigabyte-2024-110-g002">
        <label>Figure 2.</label>
        <caption>
          <p>Registration of the cell membrane/wall staining image and spatial gene expression map using the cell nuclei staining image as a bridge. (A) The size of the cell membrane/wall staining image is adjusted to be consistent with the cell nuclei staining image. (B) The cell nuclei and cell membrane/wall staining images are subsampled. (C) Calculation of the offsets of the subsampled images. (D) Restoring the offsets to the scale of the original images for registration. (E) Registration of the spatial gene expression map and cell nuclei staining image by performing scaling, rotating, flipping, and translating, followed by the registration of the spatial gene expression map and cell membrane/wall staining image by performing the same operations.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g002" position="float"/>
      </fig>
      <p> The second stage is the registration of the stitched nuclei staining image and spatial gene expression map. This registration is the same as in StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. The spatial gene expression data is transformed into a map. The stitched cell nuclei staining image is registered with the map based on “track line” information, involving scaling, rotating, flipping, and translating on the stitched cell nuclei staining image.</p>
      <p>The third stage is the registration of the stitched cell membrane/wall staining image and the spatial gene expression map. Since the cell nuclei and cell membrane/wall staining images have been registered in the first stage, the same operations of the second stage, including scaling, rotating, flipping, and translating, are applied to the cell membrane/wall staining image (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>E). Then, the cell membrane/wall staining image and spatial gene expression map can be registered. Moreover, when utilizing staining images produced with a multi-channel microscope, STCellbin can omit the registration among these images. STCellbin can also process the case of multiple mIF staining images captured from identical tissues using the same microscope when there is only a difference in offsets among these images.</p>
    </sec>
    <sec id="s0007">
      <title>Cell segmentation</title>
      <p>The cell segmentation step of STCellbin uses Cellpose 2.0 <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> with some adjustments. The model architecture of Cellpose 2.0 and its weight files “cyto2” are downloaded. However, due to the large size of the staining images derived from Stereo-seq data, Cellpose 2.0 cannot be executed smoothly using normal hardware configurations. To address this issue, the staining images are cropped into multiple tiles with overlapping areas to perform cell segmentation and record the coordinates of these tiles. The overlapping areas prevent cells at the border of the tiles from being cropped. For optimal results, segmentations with different values of the cell diameter are performed independently, and the segmentation yielding the highest total cell area is retained. Next, all the segmented tiles are assembled into the final segmented result according to the recorded coordinates. Moreover, when selecting the tissue segmentation option, an additional step involves applying a filter to the cell mask using the tissue mask, resulting in a refined segmented output.</p>
    </sec>
    <sec id="s0008">
      <title>Molecule labeling</title>
      <p>The molecule labeling of STCellbin is the same as in StereoCell, in principle. StereoCell assigns molecules from the cell nuclei to the cell by using the cell nuclei mask, and then assigns molecules outside the cell nuclei to the cells with the highest probability density using a Gaussian Mixture Model <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content>. Conversely, STCellbin directly assigns molecules to the cells based on the cell mask, while assigning molecules outside the cell is optional. This decision was driven by the observation that cell membranes/walls are usually tightly packed, with a few molecules appearing outside the cells, and the assignment of these molecules may take a lot of time. Thus, we generally do not recommend this option, and users can choose to employ it based on particular requirements.</p>
    </sec>
  </sec>
  <sec id="s0009">
    <title>Results</title>
    <sec id="s0010">
      <title>Datasets and computing resource</title>
      <p>We selected two datasets acquired via Stereo-seq technology <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. One was a mouse liver dataset, a tissue that offers cell boundary information via cell membranes, as in all mammalian tissues. The other dataset was derived from seeds of the plant <italic toggle="yes">Arabidopsis</italic>, a tissue that provides cell boundary information based on rigid cell walls. More details of the two datasets are shown in Table <xref rid="gigabyte-2024-110-t001" ref-type="table">1</xref>.</p>
      <table-wrap position="float" id="gigabyte-2024-110-t001">
        <label>Table 1</label>
        <caption>
          <p>Details of two datasets used for evaluation of cell boundary information.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="center" width="34%"/>
            <col span="1" align="center" width="33%"/>
            <col span="1" align="center" width="33%"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" rowspan="1" colspan="1"> Detail</th>
              <th align="center" rowspan="1" colspan="1">Mouse liver dataset</th>
              <th align="center" rowspan="1" colspan="1"><italic toggle="yes">Arabidopsis</italic> seed dataset</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Data source</td>
              <td align="center" rowspan="1" colspan="1"> A slice of liver</td>
              <td align="center" rowspan="1" colspan="1"> Slices of multiple seeds</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell nuclei dye</td>
              <td align="center" rowspan="1" colspan="1"> DAPI</td>
              <td align="center" rowspan="1" colspan="1"> ssDNA</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell membrane/wall dye</td>
              <td align="center" rowspan="1" colspan="1"> mIF</td>
              <td align="center" rowspan="1" colspan="1"> CFW</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Number of molecules</td>
              <td align="center" rowspan="1" colspan="1"> 16,177,288</td>
              <td align="center" rowspan="1" colspan="1"> 62,884,637</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The experiment for image segmentation was implemented on the STOmics cloud platform <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with these settings: 32 CPUs, 32 GB memory, and “ALL” resource type. An exception was the watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>, which was implemented using ImageJ on a computer with a 16-core CPU and 16 GB of RAM. Also, the experiment for downstream analysis was implemented on a server with a 40-core CPU, 128 GB of RAM, and 24 GB of GPU.</p>
    </sec>
    <sec id="s0011">
      <title>Evaluation criteria for cell segmentation performance</title>
      <p>In a cell mask image, the gray value of a pixel is set to 255 in the cell area and 0 in the background. True positive (TP, the number of pixels with gray value of 255 in both ground truth and segmented result), true negative (TN, the number of pixels with gray value of 0 in both ground truth and segmented result), false positive (FP, the number of pixels with gray value of 0 in ground truth and 255 in segmented result) and false negative (FN, the number of pixels with gray value of 255 in ground truth and 0 in segmented result) are calculated. The number of cells segmented by a method is <italic toggle="yes">ns</italic>. For each segmented cell (cell<sub><italic toggle="yes">i</italic></sub>), there should be a corresponding area in the ground truth (area<sub><italic toggle="yes">i</italic></sub>), where <italic toggle="yes">i</italic> is the cell index (<italic toggle="yes">i</italic> = 1,  2, …, <italic toggle="yes">ns</italic>). The intersection over union metric (IoU) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> is set as: <disp-formula id="eqn0001"><label>(1)</label><alternatives><tex-math id="d2e737">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{IoU}_{i}=\text{ao}_{i}/\text{au}_{i}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math001" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>ao</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mtext>au</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula> where ao<sub><italic toggle="yes">i</italic></sub> is the overlap area between cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>, and au<sub><italic toggle="yes">i</italic></sub> is the union area of cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>. Then the precision (Pre), recall (Rec), F1 score (F1_<italic toggle="yes">s</italic>), Dice coefficient (Dc), and average Jaccard index (Avg_<italic toggle="yes">J</italic>) are calculated as:<disp-formula id="eqn0002"><label>(2)</label><alternatives><tex-math id="d2e801">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Pre} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FP}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math002" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Pre</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0003"><label>(3)</label><alternatives><tex-math id="d2e836">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Rec} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math003" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Rec</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0004"><label>(4)</label><alternatives><tex-math id="d2e870">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{F}1\_s &amp; = &amp; \displaystyle 2\times (\text{Pre}\times \text{Rec})/(\text{Pre}+\text{Rec}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math004" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>F</mml:mtext><mml:mn>1</mml:mn><mml:mi>\_</mml:mi><mml:mi>s</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0005"><label>(5)</label><alternatives><tex-math id="d2e924">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Dc} &amp; = &amp; \displaystyle 2\times \text{TP}/(2\times \text{TP}+\text{FP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math005" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Dc</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0006"><label>(6)</label><alternatives><tex-math id="d2e970">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Avg}\_J &amp; = &amp; \displaystyle \mathop{\sum }_{i=1}^{ns}\text{IoU}_{i}/ns. \end{eqnarray*}\end{document}</tex-math><mml:math id="math006" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Avg</mml:mtext><mml:mi>\_</mml:mi><mml:mi>J</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0012">
      <title>Process and evaluation of downstream analysis</title>
      <p>The generated single-cell spatial gene expression profiles were input into Stereopy (v0.6.0) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>. The cells with fewer than ten expressed genes, fewer than three expression counts, and more than 3% mitochondrial genes were removed; genes present in less than three cells were also removed. After normalization, the differentially expressed genes were summarized using Principal Component Analysis to reduce the data dimensionality. Specifically, the number of features was reduced to 10. The Leiden algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content> was used for clustering, and the Uniform Manifold Approximation and Projection (UMAP) algorithm (RRID:<named-content content-type="rrid">SCR_018217</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref21" ref-type="bibr">21</xref>]</styled-content> was used to obtain 2D data projections. The Silhouette coefficient (Sc) and Moran’s I (MI) were used to evaluate the effect of clustering and the spatial self-correlation of each cluster, respectively. Sc is calculated as: <disp-formula id="eqn0007"><label>(7)</label><alternatives><tex-math id="d2e1049">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{Sc}=(b_{j}-a_{j})/\max \{a_{j},b_{j}\}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math007" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>Sc</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">a</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and other samples in its cluster, and <italic toggle="yes">b</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and the samples in other clusters. MI is calculated as: <disp-formula id="eqn0008"><label>(8)</label><alternatives><tex-math id="d2e1125">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{MI}=(n/W_{0})(\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}(y_{k}-\overline{y})(y_{l}-\overline{y})/\mathop{\sum }_{k=1}^{n}⁡(y_{k}-\overline{y})^{2}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math008" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>MI</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">n</italic> is the number of clusters, <italic toggle="yes">y</italic>
<sub><italic toggle="yes">k</italic></sub> and <italic toggle="yes">y</italic>
<sub><italic toggle="yes">l</italic></sub> are the attribute values of the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, respectively, <overline><italic toggle="yes">y</italic></overline> is the mean of all cluster attributes, 𝜔<sub><italic toggle="yes">k</italic>, <italic toggle="yes">l</italic></sub> is the spatial weight between the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, and <italic toggle="yes">W</italic>
<sub>0</sub> is the aggregation of all spatial weights as: <disp-formula id="eqn0009"><label>(9)</label><alternatives><tex-math id="d2e1325">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    W_{0}=\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}. \end{eqnarray*}\end{document}</tex-math><mml:math id="math009" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0013">
      <title>STCellbin more accurately segments cells based on cell membrane/wall staining images</title>
      <p>We cropped two areas with higher image quality from the two datasets and designed their ground truths based on the manual markup of the cells according to the cell membranes/walls in the staining images. The cell segmentation method of STCellbin was compared with the original Cellpose <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content>, the state-of-the-art method DeepCell <styled-content style-type="bibr-wrapper">[<xref rid="ref22" ref-type="bibr">22</xref>]</styled-content>, and a traditional watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>.</p>
      <p>Using the mouse liver dataset, STCellbin effectively identified cell membranes for segmentation, yielding cell masks that demonstrated acceptable agreement with the stating image and ground truth (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, upper). Among all cell mask images, STCellbin provided the best description of the cell boundaries, outperforming other methods, which missed quite a few cells (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, lower). We observed a similar trend using the <italic toggle="yes">Arabidopsis</italic> seed dataset, showing that STCellbin can also effectively identify cell walls for segmentation (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>B). Compared with other methods, STCellbin obtained higher values across most indicators on these two datasets (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>C). The comparison with the original Cellpose validated the effectiveness of STCellbin in adjusting segmentation. While DeepCell is a powerful method, it is primarily designed for segmenting cell nuclei, which involves identifying highlighted areas in the nuclei staining images. This strategy is unsuitable for cell membrane/wall staining images, resulting in less desirable results. Similarly, the traditional watershed method performs poorly on cell membrane/wall staining images. In summary, STCellbin’s cell segmentation emerged as the most practical and effective method.</p>
      <fig position="float" id="gigabyte-2024-110-g003">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of cell segmentation performance. (A) Cell segmentation results on the cropped area from the mouse liver dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (B) Cell segmentation results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (C) Indicator comparison of cell segmentation results on the cropped areas from the mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g003" position="float"/>
      </fig>
    </sec>
    <sec id="s0014">
      <title>STCellbin generates more reliable single-cell spatial gene expression profiles for downstream analysis</title>
      <p>Currently, there is a lack of image-based one-stop software like STCellbin for Stereo-seq data. Therefore, we compared STCellbin with Baysor (v0.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref23" ref-type="bibr">23</xref>]</styled-content>, a tool that generates the spatial gene expression profile without relying on images. However, Baysor could not output results on the complete mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets in an acceptable time or a given computational resource. We ran Baysor on a smaller <italic toggle="yes">Arabidopsis</italic> seed dataset, which was the cropped area in the cell segmentation experiment and contained two complete seed data.</p>
      <p>The cell area, number of unique genes per cell, and number of gene counts per cell were statistically calculated from the results of STCellbin (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>A). The clustering results of STCellbin were obtained utilizing the generated single-cell spatial gene expression profiles. The clusters of cells were spatially mapped within the tissue (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, left-hand side for each tissue), allowing for the observation of their specific positions. From the UMAPs, it was apparent that the different cell types were effectively distinguished (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, right-hand side for each tissue). The spatial location of the different cell types positively influenced a series of downstream analyses, such as cellular annotation in less well-studied tissues.</p>
      <fig position="float" id="gigabyte-2024-110-g004">
        <label>Figure 4.</label>
        <caption>
          <p>Downstream analysis results and comparison. (A) Statistical results of cell area, gene number per cell, and gene expression per cell of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (B) Clustering results and UMAPs of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (C) Indicator comparison of downstream analysis results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset, where <italic toggle="yes">Sc</italic> and <italic toggle="yes">MI</italic> are averaged across all clusters.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g004" position="float"/>
      </fig>
      <p> The cells were clustered into seven clusters on the profile of STCellbin, and 14 clusters on the profile of Baysor (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the first subfigure from the left). We observed that the number of cells segmented by Baysor was significantly higher than that segmented by STCellbin, and it did not align with the cell count observed in the ground truth image. This fact could account for the higher number of clusters produced by Baysor. The Sc and MI obtained by both STCellbin and Baysor were not satisfactory (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the second and third subfigures from the left), possibly due to the limited information from a small dataset. Nevertheless, the values from STCellbin were higher than those from Baysor. Moreover, STCellbin demonstrated significant advantages in terms of computing resource usage and running time (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the fourth and fifth subfigures from the left), which also explains why Baysor was unable to process the complete mouse liver and Arabidopsis seed datasets.</p>
      <p>It should be noted that the stitching and registration steps of STCellbin could not be performed on the cropped dataset. Hence, the corresponding computational resource usage and running time could not be recorded. Thus, the resource usage and time of STCellbin for comparison were obtained on the complete <italic toggle="yes">Arabidopsis</italic> seed dataset. Specifically, STCellbin was able to process a larger dataset with fewer computational resources and less time compared to Baysor. Overall, STCellbin is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data.</p>
    </sec>
  </sec>
  <sec id="s0015">
    <title>Discussion</title>
    <p>Accurate identification of cell boundaries is crucial in generating single-cell resolution in spatial omics applications. Building upon previous work in StereoCell, which uses cell nuclei staining images to generate single-cell spatial gene expression profiles, this STCellbin update extends the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries, thereby facilitating downstream analyses. We also showcased a few examples of the performance of cell membrane/wall segmentation in STCellbin. Currently, the tools for cell nuclei and cell membrane/wall segmentation can be independently executed, allowing users to choose the most suitable solution for their specific applications. In future work, these two techniques could be combined by training a deep learning model compatible with any staining image type, thereby achieving more accurate results.</p>
  </sec>
  <sec id="s0016">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: STCellbin</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: Python</p>
        </list-item>
        <list-item>
          <p>Other requirements: Python 3.8</p>
        </list-item>
        <list-item>
          <p>License: MIT License</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024438</named-content></p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank China National GeneBank for providing technical support.</p>
  </ack>
  <sec sec-type="data-availability" id="s0017">
    <title>Data availability</title>
    <p>The data that support the findings of this study have been deposited into the Spatial Transcript Omics DataBase (STOmics DB) of the China National GeneBank DataBase (CNGBdb), with accession number <ext-link xlink:href="https://db.cngb.org/stomics/project/STT0000048" ext-link-type="uri" specific-use="url">STT0000048</ext-link>. A backup for the data is also provided at the Github link of STCellbin <styled-content style-type="bibr-wrapper">[<xref rid="ref24" ref-type="bibr">24</xref>]</styled-content>. Archival snapshots of the code are also available from software heritage (Figure <xref rid="gigabyte-2024-110-g005" ref-type="fig">5</xref>) <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.</p>
    <fig position="float" id="gigabyte-2024-110-g005" fig-type="softwareHeritageUrl">
      <label>Figure 5.</label>
      <caption>
        <p>The Software Heritage archive of the software <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.<ext-link xlink:href="https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/" ext-link-type="uri" specific-use="softwareHeritageUrl">https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/</ext-link></p>
      </caption>
      <graphic xlink:href="gigabyte-2024-110-g005" position="float"/>
    </fig>
  </sec>
  <sec id="s0018">
    <title>Abbreviations</title>
    <p>FFT, Fast Fourier Transform; MI, Moran’s I; mIF, multiplex immunofluorescence; Sc, Silhouette coefficient; UMAP, Uniform Manifold Approximation and Projection.</p>
  </sec>
  <sec id="s0019">
    <title>Declarations</title>
    <sec id="s0020">
      <title>Ethics approval and consent to participate</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0021">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="s0022">
      <title>Authors’ contributions</title>
      <p>Conceptualization: BZ and ML. Project administration and supervision: SB and XX. Software implementation: ZD, HQ, KS, and HL. Data collection and processing: QK, XF, and LC. Validation: QK and ZD. Project coordination: BZ and ML. Manuscript writing and figure generation: BZ, ML, and QK. Manuscript review: ML, SF, YZ, YL and SB.</p>
    </sec>
    <sec id="s0023">
      <title>Funding</title>
      <p>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Computational approaches and challenges in spatial transcriptomics</article-title>. <source>Genom. Proteom. Bioinform.</source>, <year>2023</year>; <volume>21</volume>: <fpage>24</fpage>–<lpage>47</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2022.10.001</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>T</given-names></name>, <name><surname>Ang</surname><given-names>CE</given-names></name>, <name><surname>Zhuang</surname><given-names>X</given-names></name>. </person-group><article-title>Spatially resolved epigenomic profiling of single cells in complex tissues</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>4448</fpage>–<lpage>4464</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2023.04.006</pub-id>.<pub-id pub-id-type="pmid">36272405</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erickson</surname><given-names>A</given-names></name>, <name><surname>He</surname><given-names>M</given-names></name>, <name><surname>Berglund</surname><given-names>E</given-names></name><etal/></person-group><article-title>Spatially resolved clonal copy number alterations in benign and malignant tissue</article-title>. <source>Nature</source>, <year>2022</year>; <volume>608</volume>: <fpage>360</fpage>–<lpage>367</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41586-022-05023-2</pub-id>.<pub-id pub-id-type="pmid">35948708</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Cheng</surname><given-names>M</given-names></name><etal/></person-group><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>1777</fpage>–<lpage>1792</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2022.04.003</pub-id>.<pub-id pub-id-type="pmid">35512705</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name><etal/></person-group><article-title>StereoCell enables highly accurate single-cell segmentation for spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.02.28.530414</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>KH</given-names></name>, <name><surname>Boettiger</surname><given-names>AN</given-names></name>, <name><surname>Moffitt</surname><given-names>JR</given-names></name><etal/></person-group><article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>. <source>Science</source>, <year>2015</year>; <volume>348</volume>: <elocation-id content-type="artnum">aaa6090</elocation-id>. doi:<pub-id pub-id-type="doi">10.1126/science.aaa6090</pub-id>.<pub-id pub-id-type="pmid">25858977</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>S</given-names></name>, <name><surname>Bhatt</surname><given-names>R</given-names></name>, <name><surname>Brown</surname><given-names>C</given-names></name><etal/></person-group><article-title>High-plex imaging of RNA and proteins at subcellular resolution in fixed tissue by spatial molecular imaging</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>1794</fpage>–<lpage>1806</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-022-01483-z</pub-id>.<pub-id pub-id-type="pmid">36203011</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janesick</surname><given-names>A</given-names></name>, <name><surname>Shelansky</surname><given-names>R</given-names></name>, <name><surname>Gottscho</surname><given-names>AD</given-names></name><etal/></person-group><article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>. <source>Nat. Commun.</source>, <year>2023</year>; <volume>14</volume>(<issue>1</issue>): <elocation-id content-type="artnum">8353</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41467-023-43458-x</pub-id>.<pub-id pub-id-type="pmid">38114474</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Heng</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name><etal/></person-group><article-title>Integrated spatial transcriptomic and proteomic analysis of fresh frozen tissue based on stereo-seq</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.04.28.538364</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOmics Documentation</collab></person-group>. <ext-link xlink:href="https://en.stomics.tech/" ext-link-type="uri" specific-use="url">https://en.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duhamel</surname><given-names>P</given-names></name>, <name><surname>Vetterli</surname><given-names>M</given-names></name>. </person-group><article-title>Fast fourier transforms: A tutorial review and a state of the art</article-title>. <source>Signal Process.</source>, <year>1990</year>; <volume>19</volume>(<issue>4</issue>): <fpage>259</fpage>–<lpage>299</lpage>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name>, <name><surname>Stringer</surname><given-names>C</given-names></name>. </person-group><article-title>Cellpose 2.0: how to train your own model</article-title>. <source>Nat. Methods</source>, <year>2022</year>; <volume>19</volume>: <fpage>1634</fpage>–<lpage>1641</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-022-01663-4</pub-id>.<pub-id pub-id-type="pmid">36344832</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Azad</surname><given-names>R</given-names></name>, <name><surname>Asadi-Aghbolaghi</surname><given-names>M</given-names></name>, <name><surname>Fathy</surname><given-names>M</given-names></name><etal/></person-group><part-title>Bi-Directional ConvLSTM U-Net with densley connected convolutions</part-title>. In: <source>IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</source>. <year>2019</year>. pp. <fpage>406</fpage>–<lpage>415</lpage>, doi:<pub-id pub-id-type="doi">10.1109/ICCVW.2019.00052</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levina</surname><given-names>A</given-names></name>, <name><surname>Priesemann</surname><given-names>V</given-names></name>. </person-group><article-title>Subsampling scaling</article-title>. <source>Nat. Commun.</source>, <year>2017</year>; <volume>8</volume>: <elocation-id content-type="artnum">15140</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/ncomms15140</pub-id>.<pub-id pub-id-type="pmid">28469176</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>D</given-names></name>. </person-group><part-title>Gaussian mixture models</part-title>. In: <person-group person-group-type="editor"><name content-type="editor"><surname>Li</surname><given-names>SZ</given-names></name>, <name content-type="editor"><surname>Jain</surname><given-names>A</given-names></name></person-group> (eds), <source>Encyclopaedia of Biometrics</source>. vol. <volume>741</volume>, <publisher-loc>Boston, MA</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2009</year>; pp. <fpage>659</fpage>–<lpage>663</lpage>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOMICs Cloud</collab></person-group>. <ext-link xlink:href="https://cloud.stomics.tech/" ext-link-type="uri" specific-use="url">https://cloud.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>T</given-names></name>, <name><surname>Tong</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Review of research on the instance segmentation of cell images</article-title>. <source>Comput. Meth. Prog. Bio.</source>, <year>2022</year>; <volume>227</volume>: <elocation-id content-type="artnum">107211</elocation-id>. doi:<pub-id pub-id-type="doi">10.1016/j.cmpb.2022.107211</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Michaelos</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cellpose: a generalist algorithm for cellular Segmentation</article-title>. <source>Nat. Methods</source>, <year>2021</year>; <volume>18</volume>: <fpage>100</fpage>–<lpage>106</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>.<pub-id pub-id-type="pmid">33318659</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Cao</surname><given-names>L</given-names></name><etal/></person-group><article-title>Stereopy: modeling comparative and spatiotemporal cellular heterogeneity via multi-sample spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.12.04.569485</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name>, <name><surname>Waltman</surname><given-names>L</given-names></name>, <name><surname>Van Eck</surname><given-names>NJ</given-names></name>. </person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep.</source>, <year>2019</year>; <volume>9</volume>: <elocation-id content-type="artnum">5233</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>.<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name>, <name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name><etal/></person-group><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat. Biotechnol.</source>, <year>2019</year>; <volume>37</volume>: <fpage>38</fpage>–<lpage>44</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenwald</surname><given-names>NF</given-names></name>, <name><surname>Miller</surname><given-names>G</given-names></name>, <name><surname>Moen</surname><given-names>E</given-names></name><etal/></person-group><article-title>Whole-cell segmentation of tissue images with human-level performance using large-scale data annotation and deep learning</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>555</fpage>–<lpage>565</lpage>.<pub-id pub-id-type="pmid">34795433</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petukhov</surname><given-names>V</given-names></name>, <name><surname>Xu</surname><given-names>RJ</given-names></name>, <name><surname>Soldatov</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>10</volume>: <fpage>345</fpage>–<lpage>354</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-021-01044-w</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STCellbin GitHub</collab></person-group>. <year>2023</year>; <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Kang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>STCellbin</article-title> (Version 1) [Computer software]. <italic toggle="yes">Software Heritage</italic>. <year>2024</year>; <ext-link xlink:href="https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0" ext-link-type="uri" specific-use="url">https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e2697">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2703">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2709">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2715">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>03</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>04</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2721">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>08</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">chunquan Li</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Unable to test</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">Stereo-seq, an advanced spatial transcriptomics technique, allows detailed analysis of large tissues at the single-cell level with precise subcellular resolution. Author's prior software was groundbreaking, generating robust single-cell spatial gene expression profiles using cell nuclei staining images and statistical methods. They've enhanced their software to STCellbin, using cell nuclei images to align cell membrane/wall staining images. This update employs improved cell segmentation, ensuring accurate boundaries and more dependable single-cell spatial gene expression profiles. Successful tests on mouse liver and Arabidopsis seed datasets demonstrate STCellbin's effectiveness, enabling a deeper insight into the role of single-cell characteristics in tissue biology. However, I do have some suggestions and questions about certain parts of the manuscript.&#13; &#13; &#13; 1. The authors should show the advantages and performance of STCellbin compared to other methods, such as its computational efficiency, accuracy, and suitability for various image types. &#13; 2. To comprehensively assess the performance of STCellbin, the authors should consider integrating other commonly used cell segmentation evaluation metrics, such as F1-score, Dice coefficient, and so forth.&#13; 3. To ensure the completeness and reproducibility of the data analysis, more detailed information regarding the clustering analysis of the single-cell spatial gene expression maps generated through STCellbin is requested. This information should encompass methods, parameters, and results such as cluster type annotations.&#13; 4. The authors can use simpler and clearer language and terminology to describe the image registration process in the methods section, ensuring that readers can easily understand the workflow and principles of image registration.&#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Major Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2727">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Wang</surname>
            <given-names>Zhaowei</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Zhaowei Wang</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">In this manuscript, the authors propose STCellbin to generate single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images. The experiment results on mouse liver and Arabidopsis seed datasets prove the good performance of STCellbin. The topic is significant and the proposed method is feasible. However, there are still some concerns and problems to be improved and clarified.&#13; &#13; (1) STCellbin is an update version of StereoCell, but the explanation of StereoCell is not sufficient. The authors should give a more detailed explanation of StereoCell, such as its input and main process.&#13; &#13; (2) The authors list some existing dyeing methods in Lines 52-53, Page 3. They should clarify that these methods are used for nuclei staining, which differentiate them from the cell membrane/wall staining methods of following content. It can provide a more accurate explanation for readers and users.&#13; &#13; (3) The authors share the GitHub repository of STCellbin, and I noticed that when executing STCellbin, the input only requires the path of image data and spatial gene expression data, the path of the output results, and the chip number. Are there other adjustable parameters?&#13; &#13; (4) In Page 5, Line 85, “steps” should be “step”, and in Page 8, Line 145, “must” would be better revised to “should”. Moreover, the writing of “stained image” and “staining image” should be consistent.&#13; &#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2734">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>18</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e2425">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Major Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2431">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2437">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Re-Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>29</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Comments on revised manuscript</td>
            <td rowspan="1" colspan="1">It is suitable for publication now. </td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2443">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2449">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2455">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2462">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">This paper describes a new spatial transcriptomics method that that utilizes cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. STCellbin is an update of StereoCell, now using a more advanced cell segmentation technique, so more accurate cell boundaries can be obtained, allowing more reliable single-cell spatial gene expression profiles to be obtained. After peer review more comparisons were added and more description given on what was upgraded in this version to convince the reviewers. Demonstrating it is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data. And extending the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2468">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e2697?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10905256</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202312-01</article-id>
    <article-id pub-id-type="publisher-id">110</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.110</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.1101/2023.12.25.573324</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Genetics and Genomics</subject>
        <subject>Bioinformatics</subject>
        <subject>Developmental Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</article-title>
      <alt-title alt-title-type="left-running-head">B. Zhang <italic toggle="yes">et al.</italic>
</alt-title>
      <alt-title alt-title-type="right-running-head">Generating single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6654-3567</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Bohan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3310-2911</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Mei</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6579-7944</contrib-id>
        <name>
          <surname>Kang</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Zhonghan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/validation/" vocab-term="Validation">Validation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0004-6887-6743</contrib-id>
        <name>
          <surname>Qin</surname>
          <given-names>Hua</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6304-9907</contrib-id>
        <name>
          <surname>Su</surname>
          <given-names>Kui</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0000-2977-4059</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Xiuwen</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3635-0817</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Lichuan</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/data-curation/" vocab-term="Data curation">Data curation</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Huanlin</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="supporting">Software</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4126-0074</contrib-id>
        <name>
          <surname>Fang</surname>
          <given-names>Shuangsang</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9950-1793</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yong</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuxiang</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8951-6705</contrib-id>
        <name>
          <surname>Brix</surname>
          <given-names>Susanne</given-names>
        </name>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5338-5173</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Xun</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/project-administration/" vocab-term="Project administration" degree-contribution="lead">Project administration</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision" degree-contribution="lead">Supervision</role>
        <xref rid="cor1" ref-type="corresp">
          <sup>*</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Shenzhen</addr-line>, <addr-line content-type="postcode">518083</addr-line>, <country>China</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><institution>BGI Research</institution>, <addr-line content-type="city">Beijing</addr-line>, <addr-line content-type="postcode">102601</addr-line>, <country>China</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Biotechnology and Biomedicine</addr-line>, <institution>Technical University of Denmark</institution>, <addr-line content-type="postcode">2800</addr-line>, <addr-line content-type="city">Kgs. Lyngby</addr-line>, <country>Denmark</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding authors. E-mail: <email xlink:href="sbrix@dtu.dk">sbrix@dtu.dk</email>; <email xlink:href="xuxun@genomics.cn">xuxun@genomics.cn</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>2024</volume>
    <elocation-id>gigabyte110</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In spatially resolved transcriptomics, Stereo-seq facilitates the analysis of large tissues at the single-cell level, offering subcellular resolution and centimeter-level field-of-view. Our previous work on StereoCell introduced a one-stop software using cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. With advancements allowing the acquisition of cell boundary information, such as cell membrane/wall staining images, we updated our software to a new version, STCellbin. Using cell nuclei staining images, STCellbin aligns cell membrane/wall staining images with spatial gene expression maps. Advanced cell segmentation ensures the detection of accurate cell boundaries, leading to more reliable single-cell spatial gene expression profiles. We verified that STCellbin can be applied to mouse liver (cell membranes) and <italic toggle="yes">Arabidopsis</italic> seed (cell walls) datasets, outperforming other methods. The improved capability of capturing single-cell gene expression profiles results in a deeper understanding of the contribution of single-cell phenotypes to tissue biology.</p>
      <sec specific-use="heading-level-1" id="s0001">
        <title>Availability &amp; Implementation</title>
        <p>The source code of STCellbin is available at <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>National Key R&amp;D Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFC3400400</award-id>
      </award-group>
      <funding-statement>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0002">
    <title>Statement of need</title>
    <p>Spatially resolved single-cell transcriptomics enables the generation of comprehensive molecular maps that provide insights into the spatial distribution of molecules within individual cells constituting tissues. This groundbreaking technology offers insights into the location and function of cells across diverse tissues, advancing our understanding of organ development <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>, tumor heterogeneity <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>, cancer evolution <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content>, and other biological mechanisms. Resolution and field-of-view are critical parameters in spatial transcriptomics. Specifically, a high resolution provides detailed molecular information at the single-cell level, and a large field-of-view facilitates the creation of complete 3D maps, capturing biological functions at the organ level. Stereo-seq simultaneously achieves subcellular resolution and a centimeter-level field-of-view, providing the technical foundation for obtaining comprehensive spatial gene expression profiles of whole tissues at the single-cell level <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. Our previous work introduced StereoCell, a one-stop software for obtaining single-cell spatial gene expression profiles with a high signal-to-noise ratio from Stereo-seq data <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. StereoCell takes the cell nuclei staining image tiles and its corresponding spatial gene expression data as input, and it performs tasks such as image stitching, image registration, tissue segmentation, cell nuclei segmentation, and molecule labeling steps. Notably, Stereo-seq uses cell nuclei staining images; however, there exists a significant difference between cell nuclei and cell boundary staining images, based on cell membrane/wall staining, in terms of the ability to capture robust and precise cell-specific gene expression profiles. Despite the widespread use of spatial techniques, such as MERFISH <styled-content style-type="bibr-wrapper">[<xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>, CosMx <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>]</styled-content>, and Xenium <styled-content style-type="bibr-wrapper">[<xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>, several of these techniques struggle to provide accurate cell boundary information, as they rely on cell nuclei staining images generated using stains such as 4,6-diamidino-2-phenylindole (or DAPI). Hematoxylin-eosin and single-strand DNA fluorescence nuclei staining images are also commonly used and readily obtainable. The updated Stereo-seq technology incorporates a procedure leveraging simultaneous cell membrane/wall and cell nuclei staining by adding multiplex immunofluorescence (mIF) and calcofluor white (CFW) staining <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>, <xref rid="ref10" ref-type="bibr">10</xref>]</styled-content>, enabling to acquire more accurate cell boundary information automatically and, consequently, more reliable single-cell spatial gene expression profiles.</p>
    <p>Here, we updated StereoCell to a new version: STCellbin. The new version retains key steps from StereoCell, such as image stitching, tissue segmentation, and molecule labeling. Additionally, it incorporates improved image registration and cell segmentation steps. Notably, the “track line”, a crossed linear marker embedded on the Stereo-seq chip, is key to the image registration step of StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. As the cell membrane/wall staining images miss the “track line” information, the cell nuclei staining images are used to align the cell membrane/wall staining images with the spatial gene expression maps, thereby obtaining registered cell boundary information in the cell segmentation step. Based on the cell boundary information, STCellbin directly assigns the molecules to their corresponding cells, obtaining single-cell spatial gene expression profiles. We applied STCellbin to mouse liver (cell membrane) and <italic toggle="yes">Arabidopsis</italic> seed (cell wall) datasets and confirmed the accuracy of the cell segmentation provided by the software. This update offers a comprehensive workflow to obtain reliable single-cell spatial gene expression profiles based on cell membrane/wall information. Hence, STCellbin provides support and guidance, particularly for scientific investigations based on Stereo-seq data.</p>
  </sec>
  <sec id="s0003">
    <title>Implementation</title>
    <sec id="s0004">
      <title>Overview of STCellbin</title>
      <p>The process of STCellbin includes image stitching, image registration, cell segmentation, and molecule labeling (Figure <xref rid="gigabyte-2024-110-g001" ref-type="fig">1</xref>). Input into STCellbin includes Stereo-seq spatial gene expression data, alongside cell nuclei and cell membrane/wall staining image tiles. The stitched cell nuclei and cell membrane/wall staining images are obtained using the MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. These two stitched staining images are registered using a Fast Fourier Transform (FFT) algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>. The spatial gene expression data is transformed into a map, which is then registered with a stitched cell nuclei staining image based on “track line” information. Thus, the registration of the gene expression map and cell membrane/wall staining image is implemented. Cell segmentation is performed on the registered cell membrane/wall staining image using the adjusted Cellpose 2.0 tool <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> to obtain the cell mask. Molecules are then assigned to their corresponding cells based on the cell mask, thus generating the single-cell spatial gene expression profile. The tissue segmentation step based on Bi-Directional ConvLSTM U-Net <styled-content style-type="bibr-wrapper">[<xref rid="ref13" ref-type="bibr">13</xref>]</styled-content> is set as optional, and it can be used to generate a tissue mask to assist in filtering out impurities outside the tissue.</p>
      <fig position="float" id="gigabyte-2024-110-g001">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of STCellbin. The cell nuclei and cell membrane/wall staining image tiles are stitched into individual large images. The spatial gene expression map and stitched cell membrane/wall staining image are registered using the stitched cell nuclei staining image as a bridge. The cell mask is directly obtained from the registered cell membrane/wall staining image by cell segmentation. The single-cell spatial gene expression profile is obtained by overlaying the generated cell mask and the gene expression map.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g001" position="float"/>
      </fig>
    </sec>
    <sec id="s0005">
      <title>Image stitching</title>
      <p>The image stitching step in STCellbin is consistent with the one in StereoCell. The MFWS algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> leverages FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> to compute offsets between adjacent tiles featuring overlapping areas. This enables the stitching of these tiles, and the process is extended iteratively to encompass all tiles in the dataset. The relative error, absolute error, and computational efficiency of MFWS were assessed in our previous work <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0006">
      <title>Image registration</title>
      <p>The registration of STCellbin includes three stages. The first stage is the registration of the stitched cell nuclei and stitched cell membrane/wall staining images. These two staining images have similar sizes and no significant difference in rotation because the chip does not move when they are photographed. The key to this registration is to calculate their offset. The size of the cell membrane/wall staining image is adjusted to match that of the cell nuclei staining image through cutting and zero-padding (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>A). The two staining images are mean-based subsampled <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>B). The offset of the subsampled images is calculated through FFT <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content>, similarly to MFWS <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content> (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>C). Then, the calculated offset is restored to the scale of the original images (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>D). Thus, these two staining images can be registered.</p>
      <fig position="float" id="gigabyte-2024-110-g002">
        <label>Figure 2.</label>
        <caption>
          <p>Registration of the cell membrane/wall staining image and spatial gene expression map using the cell nuclei staining image as a bridge. (A) The size of the cell membrane/wall staining image is adjusted to be consistent with the cell nuclei staining image. (B) The cell nuclei and cell membrane/wall staining images are subsampled. (C) Calculation of the offsets of the subsampled images. (D) Restoring the offsets to the scale of the original images for registration. (E) Registration of the spatial gene expression map and cell nuclei staining image by performing scaling, rotating, flipping, and translating, followed by the registration of the spatial gene expression map and cell membrane/wall staining image by performing the same operations.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g002" position="float"/>
      </fig>
      <p> The second stage is the registration of the stitched nuclei staining image and spatial gene expression map. This registration is the same as in StereoCell <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>. The spatial gene expression data is transformed into a map. The stitched cell nuclei staining image is registered with the map based on “track line” information, involving scaling, rotating, flipping, and translating on the stitched cell nuclei staining image.</p>
      <p>The third stage is the registration of the stitched cell membrane/wall staining image and the spatial gene expression map. Since the cell nuclei and cell membrane/wall staining images have been registered in the first stage, the same operations of the second stage, including scaling, rotating, flipping, and translating, are applied to the cell membrane/wall staining image (Figure <xref rid="gigabyte-2024-110-g002" ref-type="fig">2</xref>E). Then, the cell membrane/wall staining image and spatial gene expression map can be registered. Moreover, when utilizing staining images produced with a multi-channel microscope, STCellbin can omit the registration among these images. STCellbin can also process the case of multiple mIF staining images captured from identical tissues using the same microscope when there is only a difference in offsets among these images.</p>
    </sec>
    <sec id="s0007">
      <title>Cell segmentation</title>
      <p>The cell segmentation step of STCellbin uses Cellpose 2.0 <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content> with some adjustments. The model architecture of Cellpose 2.0 and its weight files “cyto2” are downloaded. However, due to the large size of the staining images derived from Stereo-seq data, Cellpose 2.0 cannot be executed smoothly using normal hardware configurations. To address this issue, the staining images are cropped into multiple tiles with overlapping areas to perform cell segmentation and record the coordinates of these tiles. The overlapping areas prevent cells at the border of the tiles from being cropped. For optimal results, segmentations with different values of the cell diameter are performed independently, and the segmentation yielding the highest total cell area is retained. Next, all the segmented tiles are assembled into the final segmented result according to the recorded coordinates. Moreover, when selecting the tissue segmentation option, an additional step involves applying a filter to the cell mask using the tissue mask, resulting in a refined segmented output.</p>
    </sec>
    <sec id="s0008">
      <title>Molecule labeling</title>
      <p>The molecule labeling of STCellbin is the same as in StereoCell, in principle. StereoCell assigns molecules from the cell nuclei to the cell by using the cell nuclei mask, and then assigns molecules outside the cell nuclei to the cells with the highest probability density using a Gaussian Mixture Model <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content>. Conversely, STCellbin directly assigns molecules to the cells based on the cell mask, while assigning molecules outside the cell is optional. This decision was driven by the observation that cell membranes/walls are usually tightly packed, with a few molecules appearing outside the cells, and the assignment of these molecules may take a lot of time. Thus, we generally do not recommend this option, and users can choose to employ it based on particular requirements.</p>
    </sec>
  </sec>
  <sec id="s0009">
    <title>Results</title>
    <sec id="s0010">
      <title>Datasets and computing resource</title>
      <p>We selected two datasets acquired via Stereo-seq technology <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>. One was a mouse liver dataset, a tissue that offers cell boundary information via cell membranes, as in all mammalian tissues. The other dataset was derived from seeds of the plant <italic toggle="yes">Arabidopsis</italic>, a tissue that provides cell boundary information based on rigid cell walls. More details of the two datasets are shown in Table <xref rid="gigabyte-2024-110-t001" ref-type="table">1</xref>.</p>
      <table-wrap position="float" id="gigabyte-2024-110-t001">
        <label>Table 1</label>
        <caption>
          <p>Details of two datasets used for evaluation of cell boundary information.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="center" width="34%"/>
            <col span="1" align="center" width="33%"/>
            <col span="1" align="center" width="33%"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" rowspan="1" colspan="1"> Detail</th>
              <th align="center" rowspan="1" colspan="1">Mouse liver dataset</th>
              <th align="center" rowspan="1" colspan="1"><italic toggle="yes">Arabidopsis</italic> seed dataset</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Data source</td>
              <td align="center" rowspan="1" colspan="1"> A slice of liver</td>
              <td align="center" rowspan="1" colspan="1"> Slices of multiple seeds</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell nuclei dye</td>
              <td align="center" rowspan="1" colspan="1"> DAPI</td>
              <td align="center" rowspan="1" colspan="1"> ssDNA</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Cell membrane/wall dye</td>
              <td align="center" rowspan="1" colspan="1"> mIF</td>
              <td align="center" rowspan="1" colspan="1"> CFW</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1"> Number of molecules</td>
              <td align="center" rowspan="1" colspan="1"> 16,177,288</td>
              <td align="center" rowspan="1" colspan="1"> 62,884,637</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The experiment for image segmentation was implemented on the STOmics cloud platform <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with these settings: 32 CPUs, 32 GB memory, and “ALL” resource type. An exception was the watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>, which was implemented using ImageJ on a computer with a 16-core CPU and 16 GB of RAM. Also, the experiment for downstream analysis was implemented on a server with a 40-core CPU, 128 GB of RAM, and 24 GB of GPU.</p>
    </sec>
    <sec id="s0011">
      <title>Evaluation criteria for cell segmentation performance</title>
      <p>In a cell mask image, the gray value of a pixel is set to 255 in the cell area and 0 in the background. True positive (TP, the number of pixels with gray value of 255 in both ground truth and segmented result), true negative (TN, the number of pixels with gray value of 0 in both ground truth and segmented result), false positive (FP, the number of pixels with gray value of 0 in ground truth and 255 in segmented result) and false negative (FN, the number of pixels with gray value of 255 in ground truth and 0 in segmented result) are calculated. The number of cells segmented by a method is <italic toggle="yes">ns</italic>. For each segmented cell (cell<sub><italic toggle="yes">i</italic></sub>), there should be a corresponding area in the ground truth (area<sub><italic toggle="yes">i</italic></sub>), where <italic toggle="yes">i</italic> is the cell index (<italic toggle="yes">i</italic> = 1,  2, …, <italic toggle="yes">ns</italic>). The intersection over union metric (IoU) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> is set as: <disp-formula id="eqn0001"><label>(1)</label><alternatives><tex-math id="d2e737">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{IoU}_{i}=\text{ao}_{i}/\text{au}_{i}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math001" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>ao</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mtext>au</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula> where ao<sub><italic toggle="yes">i</italic></sub> is the overlap area between cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>, and au<sub><italic toggle="yes">i</italic></sub> is the union area of cell<sub><italic toggle="yes">i</italic></sub> and area<sub><italic toggle="yes">i</italic></sub>. Then the precision (Pre), recall (Rec), F1 score (F1_<italic toggle="yes">s</italic>), Dice coefficient (Dc), and average Jaccard index (Avg_<italic toggle="yes">J</italic>) are calculated as:<disp-formula id="eqn0002"><label>(2)</label><alternatives><tex-math id="d2e801">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Pre} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FP}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math002" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Pre</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0003"><label>(3)</label><alternatives><tex-math id="d2e836">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Rec} &amp; = &amp; \displaystyle \text{TP}/(\text{TP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math003" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Rec</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0004"><label>(4)</label><alternatives><tex-math id="d2e870">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{F}1\_s &amp; = &amp; \displaystyle 2\times (\text{Pre}\times \text{Rec})/(\text{Pre}+\text{Rec}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math004" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>F</mml:mtext><mml:mn>1</mml:mn><mml:mi>\_</mml:mi><mml:mi>s</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pre</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Rec</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0005"><label>(5)</label><alternatives><tex-math id="d2e924">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Dc} &amp; = &amp; \displaystyle 2\times \text{TP}/(2\times \text{TP}+\text{FP}+\text{FN}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math005" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Dc</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="eqn0006"><label>(6)</label><alternatives><tex-math id="d2e970">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \displaystyle \text{Avg}\_J &amp; = &amp; \displaystyle \mathop{\sum }_{i=1}^{ns}\text{IoU}_{i}/ns. \end{eqnarray*}\end{document}</tex-math><mml:math id="math006" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"/><mml:mtext>Avg</mml:mtext><mml:mi>\_</mml:mi><mml:mi>J</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"/><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>IoU</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0012">
      <title>Process and evaluation of downstream analysis</title>
      <p>The generated single-cell spatial gene expression profiles were input into Stereopy (v0.6.0) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>. The cells with fewer than ten expressed genes, fewer than three expression counts, and more than 3% mitochondrial genes were removed; genes present in less than three cells were also removed. After normalization, the differentially expressed genes were summarized using Principal Component Analysis to reduce the data dimensionality. Specifically, the number of features was reduced to 10. The Leiden algorithm <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content> was used for clustering, and the Uniform Manifold Approximation and Projection (UMAP) algorithm (RRID:<named-content content-type="rrid">SCR_018217</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref21" ref-type="bibr">21</xref>]</styled-content> was used to obtain 2D data projections. The Silhouette coefficient (Sc) and Moran’s I (MI) were used to evaluate the effect of clustering and the spatial self-correlation of each cluster, respectively. Sc is calculated as: <disp-formula id="eqn0007"><label>(7)</label><alternatives><tex-math id="d2e1049">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{Sc}=(b_{j}-a_{j})/\max \{a_{j},b_{j}\}
                     \end{eqnarray*}\end{document}</tex-math><mml:math id="math007" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>Sc</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">a</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and other samples in its cluster, and <italic toggle="yes">b</italic>
<sub><italic toggle="yes">j</italic></sub> is the average distance between the <italic toggle="yes">j</italic>-th sample and the samples in other clusters. MI is calculated as: <disp-formula id="eqn0008"><label>(8)</label><alternatives><tex-math id="d2e1125">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    \text{MI}=(n/W_{0})(\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}(y_{k}-\overline{y})(y_{l}-\overline{y})/\mathop{\sum }_{k=1}^{n}⁡(y_{k}-\overline{y})^{2}) \end{eqnarray*}\end{document}</tex-math><mml:math id="math008" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext>MI</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> where <italic toggle="yes">n</italic> is the number of clusters, <italic toggle="yes">y</italic>
<sub><italic toggle="yes">k</italic></sub> and <italic toggle="yes">y</italic>
<sub><italic toggle="yes">l</italic></sub> are the attribute values of the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, respectively, <overline><italic toggle="yes">y</italic></overline> is the mean of all cluster attributes, 𝜔<sub><italic toggle="yes">k</italic>, <italic toggle="yes">l</italic></sub> is the spatial weight between the <italic toggle="yes">k</italic>-th and <italic toggle="yes">l</italic>-th clusters, and <italic toggle="yes">W</italic>
<sub>0</sub> is the aggregation of all spatial weights as: <disp-formula id="eqn0009"><label>(9)</label><alternatives><tex-math id="d2e1325">\documentclass[10pt]{article}
                    \usepackage{wasysym}
                    \usepackage[substack]{amsmath}
                    \usepackage{amsfonts}
                    \usepackage{amssymb}
                    \usepackage{amsbsy}
                    \usepackage[mathscr]{eucal}
                    \usepackage{mathrsfs}
                    \usepackage{pmc}
                    \usepackage[Euler]{upgreek}
                    \pagestyle{empty}
                    \oddsidemargin -1.0in \begin{document}\begin{eqnarray*}
                    W_{0}=\mathop{\sum }_{k=1}^{n}⁡\mathop{\sum }_{l=1}^{n}⁡{\rm\omega}_{k,l}. \end{eqnarray*}\end{document}</tex-math><mml:math id="math009" overflow="scroll"><mml:mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="s0013">
      <title>STCellbin more accurately segments cells based on cell membrane/wall staining images</title>
      <p>We cropped two areas with higher image quality from the two datasets and designed their ground truths based on the manual markup of the cells according to the cell membranes/walls in the staining images. The cell segmentation method of STCellbin was compared with the original Cellpose <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content>, the state-of-the-art method DeepCell <styled-content style-type="bibr-wrapper">[<xref rid="ref22" ref-type="bibr">22</xref>]</styled-content>, and a traditional watershed method <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>.</p>
      <p>Using the mouse liver dataset, STCellbin effectively identified cell membranes for segmentation, yielding cell masks that demonstrated acceptable agreement with the stating image and ground truth (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, upper). Among all cell mask images, STCellbin provided the best description of the cell boundaries, outperforming other methods, which missed quite a few cells (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>A, lower). We observed a similar trend using the <italic toggle="yes">Arabidopsis</italic> seed dataset, showing that STCellbin can also effectively identify cell walls for segmentation (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>B). Compared with other methods, STCellbin obtained higher values across most indicators on these two datasets (Figure <xref rid="gigabyte-2024-110-g003" ref-type="fig">3</xref>C). The comparison with the original Cellpose validated the effectiveness of STCellbin in adjusting segmentation. While DeepCell is a powerful method, it is primarily designed for segmenting cell nuclei, which involves identifying highlighted areas in the nuclei staining images. This strategy is unsuitable for cell membrane/wall staining images, resulting in less desirable results. Similarly, the traditional watershed method performs poorly on cell membrane/wall staining images. In summary, STCellbin’s cell segmentation emerged as the most practical and effective method.</p>
      <fig position="float" id="gigabyte-2024-110-g003">
        <label>Figure 3.</label>
        <caption>
          <p>Comparison of cell segmentation performance. (A) Cell segmentation results on the cropped area from the mouse liver dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (B) Cell segmentation results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. In the merged images, cell masks are in yellow, staining images are in cyan, and ground truths are in red. (C) Indicator comparison of cell segmentation results on the cropped areas from the mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g003" position="float"/>
      </fig>
    </sec>
    <sec id="s0014">
      <title>STCellbin generates more reliable single-cell spatial gene expression profiles for downstream analysis</title>
      <p>Currently, there is a lack of image-based one-stop software like STCellbin for Stereo-seq data. Therefore, we compared STCellbin with Baysor (v0.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref23" ref-type="bibr">23</xref>]</styled-content>, a tool that generates the spatial gene expression profile without relying on images. However, Baysor could not output results on the complete mouse liver and <italic toggle="yes">Arabidopsis</italic> seed datasets in an acceptable time or a given computational resource. We ran Baysor on a smaller <italic toggle="yes">Arabidopsis</italic> seed dataset, which was the cropped area in the cell segmentation experiment and contained two complete seed data.</p>
      <p>The cell area, number of unique genes per cell, and number of gene counts per cell were statistically calculated from the results of STCellbin (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>A). The clustering results of STCellbin were obtained utilizing the generated single-cell spatial gene expression profiles. The clusters of cells were spatially mapped within the tissue (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, left-hand side for each tissue), allowing for the observation of their specific positions. From the UMAPs, it was apparent that the different cell types were effectively distinguished (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>B, right-hand side for each tissue). The spatial location of the different cell types positively influenced a series of downstream analyses, such as cellular annotation in less well-studied tissues.</p>
      <fig position="float" id="gigabyte-2024-110-g004">
        <label>Figure 4.</label>
        <caption>
          <p>Downstream analysis results and comparison. (A) Statistical results of cell area, gene number per cell, and gene expression per cell of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (B) Clustering results and UMAPs of STCellbin on the mouse liver dataset and cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset. (C) Indicator comparison of downstream analysis results on the cropped area from the <italic toggle="yes">Arabidopsis</italic> seed dataset, where <italic toggle="yes">Sc</italic> and <italic toggle="yes">MI</italic> are averaged across all clusters.</p>
        </caption>
        <graphic xlink:href="gigabyte-2024-110-g004" position="float"/>
      </fig>
      <p> The cells were clustered into seven clusters on the profile of STCellbin, and 14 clusters on the profile of Baysor (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the first subfigure from the left). We observed that the number of cells segmented by Baysor was significantly higher than that segmented by STCellbin, and it did not align with the cell count observed in the ground truth image. This fact could account for the higher number of clusters produced by Baysor. The Sc and MI obtained by both STCellbin and Baysor were not satisfactory (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the second and third subfigures from the left), possibly due to the limited information from a small dataset. Nevertheless, the values from STCellbin were higher than those from Baysor. Moreover, STCellbin demonstrated significant advantages in terms of computing resource usage and running time (Figure <xref rid="gigabyte-2024-110-g004" ref-type="fig">4</xref>C, the fourth and fifth subfigures from the left), which also explains why Baysor was unable to process the complete mouse liver and Arabidopsis seed datasets.</p>
      <p>It should be noted that the stitching and registration steps of STCellbin could not be performed on the cropped dataset. Hence, the corresponding computational resource usage and running time could not be recorded. Thus, the resource usage and time of STCellbin for comparison were obtained on the complete <italic toggle="yes">Arabidopsis</italic> seed dataset. Specifically, STCellbin was able to process a larger dataset with fewer computational resources and less time compared to Baysor. Overall, STCellbin is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data.</p>
    </sec>
  </sec>
  <sec id="s0015">
    <title>Discussion</title>
    <p>Accurate identification of cell boundaries is crucial in generating single-cell resolution in spatial omics applications. Building upon previous work in StereoCell, which uses cell nuclei staining images to generate single-cell spatial gene expression profiles, this STCellbin update extends the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries, thereby facilitating downstream analyses. We also showcased a few examples of the performance of cell membrane/wall segmentation in STCellbin. Currently, the tools for cell nuclei and cell membrane/wall segmentation can be independently executed, allowing users to choose the most suitable solution for their specific applications. In future work, these two techniques could be combined by training a deep learning model compatible with any staining image type, thereby achieving more accurate results.</p>
  </sec>
  <sec id="s0016">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: STCellbin</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: Python</p>
        </list-item>
        <list-item>
          <p>Other requirements: Python 3.8</p>
        </list-item>
        <list-item>
          <p>License: MIT License</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024438</named-content></p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank China National GeneBank for providing technical support.</p>
  </ack>
  <sec sec-type="data-availability" id="s0017">
    <title>Data availability</title>
    <p>The data that support the findings of this study have been deposited into the Spatial Transcript Omics DataBase (STOmics DB) of the China National GeneBank DataBase (CNGBdb), with accession number <ext-link xlink:href="https://db.cngb.org/stomics/project/STT0000048" ext-link-type="uri" specific-use="url">STT0000048</ext-link>. A backup for the data is also provided at the Github link of STCellbin <styled-content style-type="bibr-wrapper">[<xref rid="ref24" ref-type="bibr">24</xref>]</styled-content>. Archival snapshots of the code are also available from software heritage (Figure <xref rid="gigabyte-2024-110-g005" ref-type="fig">5</xref>) <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.</p>
    <fig position="float" id="gigabyte-2024-110-g005" fig-type="softwareHeritageUrl">
      <label>Figure 5.</label>
      <caption>
        <p>The Software Heritage archive of the software <styled-content style-type="bibr-wrapper">[<xref rid="ref25" ref-type="bibr">25</xref>]</styled-content>.<ext-link xlink:href="https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/" ext-link-type="uri" specific-use="softwareHeritageUrl">https://archive.softwareheritage.org/browse/embed/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0/</ext-link></p>
      </caption>
      <graphic xlink:href="gigabyte-2024-110-g005" position="float"/>
    </fig>
  </sec>
  <sec id="s0018">
    <title>Abbreviations</title>
    <p>FFT, Fast Fourier Transform; MI, Moran’s I; mIF, multiplex immunofluorescence; Sc, Silhouette coefficient; UMAP, Uniform Manifold Approximation and Projection.</p>
  </sec>
  <sec id="s0019">
    <title>Declarations</title>
    <sec id="s0020">
      <title>Ethics approval and consent to participate</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0021">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="s0022">
      <title>Authors’ contributions</title>
      <p>Conceptualization: BZ and ML. Project administration and supervision: SB and XX. Software implementation: ZD, HQ, KS, and HL. Data collection and processing: QK, XF, and LC. Validation: QK and ZD. Project coordination: BZ and ML. Manuscript writing and figure generation: BZ, ML, and QK. Manuscript review: ML, SF, YZ, YL and SB.</p>
    </sec>
    <sec id="s0023">
      <title>Funding</title>
      <p>This work was supported by the National Key R&amp;D Program of China (2022YFC3400400).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Computational approaches and challenges in spatial transcriptomics</article-title>. <source>Genom. Proteom. Bioinform.</source>, <year>2023</year>; <volume>21</volume>: <fpage>24</fpage>–<lpage>47</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2022.10.001</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>T</given-names></name>, <name><surname>Ang</surname><given-names>CE</given-names></name>, <name><surname>Zhuang</surname><given-names>X</given-names></name>. </person-group><article-title>Spatially resolved epigenomic profiling of single cells in complex tissues</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>4448</fpage>–<lpage>4464</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2023.04.006</pub-id>.<pub-id pub-id-type="pmid">36272405</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erickson</surname><given-names>A</given-names></name>, <name><surname>He</surname><given-names>M</given-names></name>, <name><surname>Berglund</surname><given-names>E</given-names></name><etal/></person-group><article-title>Spatially resolved clonal copy number alterations in benign and malignant tissue</article-title>. <source>Nature</source>, <year>2022</year>; <volume>608</volume>: <fpage>360</fpage>–<lpage>367</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41586-022-05023-2</pub-id>.<pub-id pub-id-type="pmid">35948708</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Cheng</surname><given-names>M</given-names></name><etal/></person-group><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title>. <source>Cell</source>, <year>2022</year>; <volume>185</volume>: <fpage>1777</fpage>–<lpage>1792</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2022.04.003</pub-id>.<pub-id pub-id-type="pmid">35512705</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name><etal/></person-group><article-title>StereoCell enables highly accurate single-cell segmentation for spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.02.28.530414</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>KH</given-names></name>, <name><surname>Boettiger</surname><given-names>AN</given-names></name>, <name><surname>Moffitt</surname><given-names>JR</given-names></name><etal/></person-group><article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>. <source>Science</source>, <year>2015</year>; <volume>348</volume>: <elocation-id content-type="artnum">aaa6090</elocation-id>. doi:<pub-id pub-id-type="doi">10.1126/science.aaa6090</pub-id>.<pub-id pub-id-type="pmid">25858977</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>S</given-names></name>, <name><surname>Bhatt</surname><given-names>R</given-names></name>, <name><surname>Brown</surname><given-names>C</given-names></name><etal/></person-group><article-title>High-plex imaging of RNA and proteins at subcellular resolution in fixed tissue by spatial molecular imaging</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>1794</fpage>–<lpage>1806</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-022-01483-z</pub-id>.<pub-id pub-id-type="pmid">36203011</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janesick</surname><given-names>A</given-names></name>, <name><surname>Shelansky</surname><given-names>R</given-names></name>, <name><surname>Gottscho</surname><given-names>AD</given-names></name><etal/></person-group><article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>. <source>Nat. Commun.</source>, <year>2023</year>; <volume>14</volume>(<issue>1</issue>): <elocation-id content-type="artnum">8353</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41467-023-43458-x</pub-id>.<pub-id pub-id-type="pmid">38114474</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Heng</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name><etal/></person-group><article-title>Integrated spatial transcriptomic and proteomic analysis of fresh frozen tissue based on stereo-seq</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.04.28.538364</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOmics Documentation</collab></person-group>. <ext-link xlink:href="https://en.stomics.tech/" ext-link-type="uri" specific-use="url">https://en.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duhamel</surname><given-names>P</given-names></name>, <name><surname>Vetterli</surname><given-names>M</given-names></name>. </person-group><article-title>Fast fourier transforms: A tutorial review and a state of the art</article-title>. <source>Signal Process.</source>, <year>1990</year>; <volume>19</volume>(<issue>4</issue>): <fpage>259</fpage>–<lpage>299</lpage>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name>, <name><surname>Stringer</surname><given-names>C</given-names></name>. </person-group><article-title>Cellpose 2.0: how to train your own model</article-title>. <source>Nat. Methods</source>, <year>2022</year>; <volume>19</volume>: <fpage>1634</fpage>–<lpage>1641</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-022-01663-4</pub-id>.<pub-id pub-id-type="pmid">36344832</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Azad</surname><given-names>R</given-names></name>, <name><surname>Asadi-Aghbolaghi</surname><given-names>M</given-names></name>, <name><surname>Fathy</surname><given-names>M</given-names></name><etal/></person-group><part-title>Bi-Directional ConvLSTM U-Net with densley connected convolutions</part-title>. In: <source>IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</source>. <year>2019</year>. pp. <fpage>406</fpage>–<lpage>415</lpage>, doi:<pub-id pub-id-type="doi">10.1109/ICCVW.2019.00052</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levina</surname><given-names>A</given-names></name>, <name><surname>Priesemann</surname><given-names>V</given-names></name>. </person-group><article-title>Subsampling scaling</article-title>. <source>Nat. Commun.</source>, <year>2017</year>; <volume>8</volume>: <elocation-id content-type="artnum">15140</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/ncomms15140</pub-id>.<pub-id pub-id-type="pmid">28469176</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>D</given-names></name>. </person-group><part-title>Gaussian mixture models</part-title>. In: <person-group person-group-type="editor"><name content-type="editor"><surname>Li</surname><given-names>SZ</given-names></name>, <name content-type="editor"><surname>Jain</surname><given-names>A</given-names></name></person-group> (eds), <source>Encyclopaedia of Biometrics</source>. vol. <volume>741</volume>, <publisher-loc>Boston, MA</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2009</year>; pp. <fpage>659</fpage>–<lpage>663</lpage>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STOMICs Cloud</collab></person-group>. <ext-link xlink:href="https://cloud.stomics.tech/" ext-link-type="uri" specific-use="url">https://cloud.stomics.tech/</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>T</given-names></name>, <name><surname>Tong</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Review of research on the instance segmentation of cell images</article-title>. <source>Comput. Meth. Prog. Bio.</source>, <year>2022</year>; <volume>227</volume>: <elocation-id content-type="artnum">107211</elocation-id>. doi:<pub-id pub-id-type="doi">10.1016/j.cmpb.2022.107211</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Michaelos</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cellpose: a generalist algorithm for cellular Segmentation</article-title>. <source>Nat. Methods</source>, <year>2021</year>; <volume>18</volume>: <fpage>100</fpage>–<lpage>106</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>.<pub-id pub-id-type="pmid">33318659</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Cao</surname><given-names>L</given-names></name><etal/></person-group><article-title>Stereopy: modeling comparative and spatiotemporal cellular heterogeneity via multi-sample spatial transcriptomics</article-title>. bioRxiv. <year>2023</year>; <pub-id pub-id-type="doi">10.1101/2023.12.04.569485</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name>, <name><surname>Waltman</surname><given-names>L</given-names></name>, <name><surname>Van Eck</surname><given-names>NJ</given-names></name>. </person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep.</source>, <year>2019</year>; <volume>9</volume>: <elocation-id content-type="artnum">5233</elocation-id>. doi:<pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>.<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name>, <name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name><etal/></person-group><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat. Biotechnol.</source>, <year>2019</year>; <volume>37</volume>: <fpage>38</fpage>–<lpage>44</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenwald</surname><given-names>NF</given-names></name>, <name><surname>Miller</surname><given-names>G</given-names></name>, <name><surname>Moen</surname><given-names>E</given-names></name><etal/></person-group><article-title>Whole-cell segmentation of tissue images with human-level performance using large-scale data annotation and deep learning</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>40</volume>: <fpage>555</fpage>–<lpage>565</lpage>.<pub-id pub-id-type="pmid">34795433</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petukhov</surname><given-names>V</given-names></name>, <name><surname>Xu</surname><given-names>RJ</given-names></name>, <name><surname>Soldatov</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>. <source>Nat. Biotechnol.</source>, <year>2022</year>; <volume>10</volume>: <fpage>345</fpage>–<lpage>354</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-021-01044-w</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">STCellbin GitHub</collab></person-group>. <year>2023</year>; <ext-link xlink:href="https://github.com/STOmics/STCellbin" ext-link-type="uri" specific-use="url">https://github.com/STOmics/STCellbin</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Kang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>STCellbin</article-title> (Version 1) [Computer software]. <italic toggle="yes">Software Heritage</italic>. <year>2024</year>; <ext-link xlink:href="https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0" ext-link-type="uri" specific-use="url">https://archive.softwareheritage.org/swh:1:dir:f7963c6d274ef64e392923ce7405f39fb23dea5a;origin=https://github.com/STOmics/STCellbin;visit=swh:1:snp:dd0bfc7b4fb0791789cf43b2c50742d25c8bc00e;anchor=swh:1:rev:09e89551499f980c4ffb4df9fb73712d93830fd0</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e2697">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2703">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2709">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>27</day>
          <month>12</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2715">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>03</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>04</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2721">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>08</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">chunquan Li</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Unable to test</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">Stereo-seq, an advanced spatial transcriptomics technique, allows detailed analysis of large tissues at the single-cell level with precise subcellular resolution. Author's prior software was groundbreaking, generating robust single-cell spatial gene expression profiles using cell nuclei staining images and statistical methods. They've enhanced their software to STCellbin, using cell nuclei images to align cell membrane/wall staining images. This update employs improved cell segmentation, ensuring accurate boundaries and more dependable single-cell spatial gene expression profiles. Successful tests on mouse liver and Arabidopsis seed datasets demonstrate STCellbin's effectiveness, enabling a deeper insight into the role of single-cell characteristics in tissue biology. However, I do have some suggestions and questions about certain parts of the manuscript.&#13; &#13; &#13; 1. The authors should show the advantages and performance of STCellbin compared to other methods, such as its computational efficiency, accuracy, and suitability for various image types. &#13; 2. To comprehensively assess the performance of STCellbin, the authors should consider integrating other commonly used cell segmentation evaluation metrics, such as F1-score, Dice coefficient, and so forth.&#13; 3. To ensure the completeness and reproducibility of the data analysis, more detailed information regarding the clustering analysis of the single-cell spatial gene expression maps generated through STCellbin is requested. This information should encompass methods, parameters, and results such as cluster type annotations.&#13; 4. The authors can use simpler and clearer language and terminology to describe the image registration process in the methods section, ensuring that readers can easily understand the workflow and principles of image registration.&#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Major Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2727">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Wang</surname>
            <given-names>Zhaowei</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Zhaowei Wang</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">In this manuscript, the authors propose STCellbin to generate single-cell gene expression profiles for high-resolution spatial transcriptomics based on cell boundary images. The experiment results on mouse liver and Arabidopsis seed datasets prove the good performance of STCellbin. The topic is significant and the proposed method is feasible. However, there are still some concerns and problems to be improved and clarified.&#13; &#13; (1) STCellbin is an update version of StereoCell, but the explanation of StereoCell is not sufficient. The authors should give a more detailed explanation of StereoCell, such as its input and main process.&#13; &#13; (2) The authors list some existing dyeing methods in Lines 52-53, Page 3. They should clarify that these methods are used for nuclei staining, which differentiate them from the cell membrane/wall staining methods of following content. It can provide a more accurate explanation for readers and users.&#13; &#13; (3) The authors share the GitHub repository of STCellbin, and I noticed that when executing STCellbin, the input only requires the path of image data and spatial gene expression data, the path of the output results, and the chip number. Are there other adjustable parameters?&#13; &#13; (4) In Page 5, Line 85, “steps” should be “step”, and in Page 8, Line 145, “must” would be better revised to “should”. Moreover, the writing of “stained image” and “staining image” should be consistent.&#13; &#13;
</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2734">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>16</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>18</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e2425">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Major Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Qiang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2431">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>1</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e2437">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Re-Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>Chunquan</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>29</day>
          <month>1</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Comments on revised manuscript</td>
            <td rowspan="1" colspan="1">It is suitable for publication now. </td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2443">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2449">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>06</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2455">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e2462">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">This paper describes a new spatial transcriptomics method that that utilizes cell nuclei staining images and statistical methods to generate high-confidence single-cell spatial gene expression profiles for Stereo-seq data. STCellbin is an update of StereoCell, now using a more advanced cell segmentation technique, so more accurate cell boundaries can be obtained, allowing more reliable single-cell spatial gene expression profiles to be obtained. After peer review more comparisons were added and more description given on what was upgraded in this version to convince the reviewers. Demonstrating it is a more reliable method, particularly for analyzing high-resolution and large-field-of-view spatial transcriptomic data. And extending the capability to automatically process Stereo-seq cell membrane/wall staining images for identifying cell boundaries.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e2468">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>2</month>
          <year>2024</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
