<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8479681</article-id>
    <article-id pub-id-type="pmid">33543757</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab088</article-id>
    <article-id pub-id-type="publisher-id">btab088</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>multiclassPairs: an R package to train multiclass pair-based classifier</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9029-3702</contrib-id>
        <name>
          <surname>Marzouka</surname>
          <given-names>Nour-Al-Dain</given-names>
        </name>
        <xref rid="btab088-cor1" ref-type="corresp"/>
        <aff><institution>Department of Clinical Sciences, Division of Oncology, Lund University</institution>, 22381 Lund, <country country="SE">Sweden</country></aff>
        <!--nour-al-dain.marzouka@med.lu.se-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eriksson</surname>
          <given-names>Pontus</given-names>
        </name>
        <aff><institution>Department of Clinical Sciences, Division of Oncology, Lund University</institution>, 22381 Lund, <country country="SE">Sweden</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab088-cor1">To whom correspondence should be addressed. <email>nour-al-dain.marzouka@med.lu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-02-05">
      <day>05</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>18</issue>
    <fpage>3043</fpage>
    <lpage>3044</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>29</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab088.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>k–Top Scoring Pairs (kTSP) algorithms utilize in-sample gene expression feature pair rules for class prediction, and have demonstrated excellent performance and robustness. The available packages and tools primarily focus on binary prediction (i.e. two classes). However, many real-world classification problems e.g. tumor subtype prediction, are multiclass tasks.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present multiclassPairs, an R package to train pair-based single sample classifiers for multiclass problems. multiclassPairs offers two main methods to build multiclass prediction models, either using a one-versus-rest kTSP scheme or through a novel pair-based Random Forest approach. The package also provides options for dealing with class imbalances, multiplatform training, missing features in test data and visualization of training and test results.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>‘multiclassPairs’ package is available on CRAN servers and GitHub: <ext-link xlink:href="https://github.com/NourMarzouka/multiclassPairs" ext-link-type="uri">https://github.com/NourMarzouka/multiclassPairs</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>The Swedish Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>The Swedish Cancer Society</institution>
          </institution-wrap>
        </funding-source>
        <award-id>190051Pj</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mrs. Berta Kamprad’s Cancer Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FBKS-2019-35</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single sample predictors have the benefit that in-sample measurements and relationships are used; consequently, a given sample is classified in an absolute manner avoiding the need for normalization toward a reference cohort. k-Top-Scoring Pairs (kTSP, <xref rid="btab088-B11" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2005</xref>) single sample predictors have demonstrated good performance across platforms (<xref rid="btab088-B4" ref-type="bibr">Cirenajwis <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab088-B9" ref-type="bibr">Paquet and Hallett, 2015</xref>; <xref rid="btab088-B11" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2005</xref>; <xref rid="btab088-B13" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2005</xref>). kTSP uses a majority voting of a set of binary rules e.g. if <bold>GeneA</bold>&lt;<bold>GeneB</bold>, then <bold>Class1</bold>, else <bold>Class2</bold>, to predict one of two classes. Different implementations of binary kTSP classifiers are currently available through R packages, e.g. MetaKTSP (<xref rid="btab088-B6" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2016</xref>), switchBox (<xref rid="btab088-B2" ref-type="bibr">Afsari<italic toggle="yes">et al.</italic>, 2015</xref>), ktspair (<xref rid="btab088-B5" ref-type="bibr">Damond, 2011</xref>), Rgtsp (<xref rid="btab088-B10" ref-type="bibr">Popovici<italic toggle="yes">et al.</italic>, 2011</xref>) and tspair (<xref rid="btab088-B8" ref-type="bibr">Leek, 2009</xref>). However, many real-world classification tasks are multiclass problems. Thus, to extend the rule-based approach to multiclass prediction, <xref rid="btab088-B11" ref-type="bibr">Tan <italic toggle="yes">et al.</italic> (2005)</xref> suggested a prediction scheme based on the voting of one-versus-rest or one-versus-one rules or using binary rules in a hierarchical approach. <xref rid="btab088-B10" ref-type="bibr">Popovici<italic toggle="yes">et al.</italic> (2011)</xref> suggested a decision tree-like structure in the R package Rgtsp, which is currently the only multiclass prediction approach available as an R package. <xref rid="btab088-B9" ref-type="bibr">Paquet and Hallett (2015)</xref> combined one-versus-rest rules using a Naive Bayes model to solve a multiclass problem. However, none of the methods outperforms all others in every aspect, and can differ in performance, computational demand and interpretability.</p>
    <p>Here, we present the R package ‘multiclassPairs’, which provides a streamlined way to train and apply pair-based multiclass predictors using either a novel Random Forest (RF) approach or through ensembled one-versus-rest kTSP classifiers generated by the switchBox package. multiclassPairs provides additional gene and rule selection methods tailored for multiclass and multiplatform problems.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>To build a pair-based multiclass predictor, multiclassPairs provides two methods, either an RF-based workflow or a one-versus-rest kTSP workflow. Both have the following steps: reading the input data and labels, selecting informative features, combining features as pairs, selecting informative pairs and constructing the final predictor model. After reading the input data and labels by <italic toggle="yes">ReadData</italic> function, each workflow handles the subsequent steps differently, as described below and in further detail in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>.</p>
  </sec>
  <sec>
    <title>3 Random Forest scheme</title>
    <p>multiclassPairs uses the RF algorithm which is capable of handling complex prediction tasks and can be used for feature selection. The fast RF implementation from the ranger package (<xref rid="btab088-B12" ref-type="bibr">Wright and Ziegler, 2017</xref>) is used in all RF steps. This includes ranking of genes (<italic toggle="yes">sort_genes_RF</italic> function) and rules (<italic toggle="yes">sort_rules_RF</italic> function) and the training of the final RF model (<italic toggle="yes">train_RF</italic> function). To deal with class size imbalance, gene and rule selection are performed using both overall and class-versus-rest importance which can be applied separately to each platform/study to select features important in all platforms/studies. The <italic toggle="yes">train_RF</italic> function optionally filters the less informative rules via the Boruta package (<xref rid="btab088-B7" ref-type="bibr">Kursa and Rudnicki, 2010</xref>) before building the final trained RF model. The user can determine how many times genes are allowed to be used among the rules, by default genes are not repeated (disjointed rules). The <italic toggle="yes">optimize_RF</italic> function can be used to perform parameter tuning for the final RF model. To handle potential missing values/genes in the test data, a kNN-imputation strategy has been incorporated into the prediction function (<italic toggle="yes">predict_RF</italic>).</p>
  </sec>
  <sec>
    <title>4 One-versus-rest scheme</title>
    <p>In the one-versus-rest scheme, one-versus-rest binary classifiers for each class are assembled in one model. A benefit of the one-versus-rest approach is the intuitive model interpretability. The workflow in this scheme starts with gene filtering (<italic toggle="yes">filter_genes_TSP</italic> function) which can be performed using one-versus-rest Wilcoxon test or one-versus-one Dunn’s test. The <italic toggle="yes">train_one_vs_rest_TSP</italic> function combines the filtered genes into binary one-versus-rest rules and gives a score for each rule in each class, after which an optimal number of top-scoring rules for each class is selected and assembled into a final model. Rule scores can be obtained as one-versus-rest score or as the average of one-versus-one scores. The switchBox package is used for calculating the rule scores and to determine the optimal number of rules for each class through the Variance Optimization (VO) approach (<xref rid="btab088-B1" ref-type="bibr">Afsari <italic toggle="yes">et al.</italic>, 2014</xref>), which is faster than the slower cross-validation approach. The user can specify a search range for candidate number of rules and allow gene repetition in rules or not. Non-variant genes (known as pivot genes), can be included in rule formation to include more possible pairs. For prediction, predict_one_vs_rest_TSP function uses either class votes i.e. number of <italic toggle="yes">true</italic> rules divided by number of rules for that class, or weighted class votes i.e. sum of the scores for the <italic toggle="yes">true</italic> rules divided by sum of rule scores for that class. Weighted votes are used by default to reduce the chance of ties. Vote ties are flagged and reported to the user. Similar to the RF workflow, gene filtering and rule scoring can be performed in a platform/study-wise manner.</p>
  </sec>
  <sec>
    <title>5 Visualization</title>
    <p>multiclassPairs provides heatmap plots to visualize the binary rules and prediction scores in the training and test datasets (<xref rid="btab088-F1" ref-type="fig">Fig.1</xref>). For the RF models, a proximity matrix based on out of bag predictions can be visualized to show the class cohesiveness among the training samples.</p>
    <fig position="float" id="btab088-F1">
      <label>Fig.1.</label>
      <caption>
        <p>Example plot of binary rules in a leukemia training dataset. Columns represent samples. Upper panel shows the reference and predicted labels. Middle panel shows bar plots for the prediction scores. Lower panel shows the binary rules in the one-versus-rest classifiers. Black indicates ‘true’ rules and white are ‘false’</p>
      </caption>
      <graphic xlink:href="btab088f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>6 Comparison</title>
    <p>We used a breast cancer gene expression dataset (<italic toggle="yes">n</italic> = 3134 samples, <xref rid="btab088-B3" ref-type="bibr">Brueffer <italic toggle="yes">et al.</italic>, 2018</xref>) to compare the subtype prediction performance between multiclassPairs and the Rgtsp decision tree (DT) approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>). We found that the multiclassPairs outperformed DT in accuracy and training time regardless of the training dataset size. One-versus-rest and RF schemes showed similar accuracies. However, with larger training datasets RF outperformed one-versus-rest approach.</p>
  </sec>
  <sec>
    <title>7 Conclusion</title>
    <p>Here, we introduce the R package multiclassPairs, enabling easy training and application of pair-based multiclass single-sample predictors using the established one-versus-rest kTSP scheme or an RF scheme. multiclassPairs is equipped with options to handle multiclass and multi-platform scenarios.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab088_Supplementary_Data</label>
      <media xlink:href="btab088_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank MattiasHöglund and Johan Vallon-Christersson for the helpful discussions on single sample classification methods.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by The Swedish Research Council, The Swedish Cancer Society [190051Pj] and Mrs. Berta Kamprad’s Cancer Foundation [FBKS-2019-35].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab088-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Afsari</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Rank discriminants for predicting phenotypes from RNA expression</article-title>. <source>Ann. Appl. Stat</source>., <volume>8</volume>, <fpage>1469</fpage>–<lpage>1491</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Afsari</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>switchBox: an R package for k-Top Scoring Pairs classifier development</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>31</volume>, <fpage>273</fpage>–<lpage>274</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brueffer</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Clinical value of RNA sequencing-based classifiers for prediction of the five conventional breast cancer biomarkers: a report from the population-based multicenter Sweden Cancerome Analysis Network-Breast Initiative</article-title>. <source>JCO Precis. Oncol</source>., <volume>2</volume>, <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cirenajwis</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Performance of gene expression-based single sample predictors for assessment of clinicopathological subgroups and molecular subtypes in cancers: a case comparison study in non-small cell lung cancer</article-title>. <source>Brief. Bioinf</source>., <volume>21</volume>, <fpage>729</fpage>–<lpage>740</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Damond</surname><given-names>J.</given-names></string-name></person-group> (<year>2011</year>) ktspair: k-Top Scoring Pairs for Microarray Classification. R package version 1.0. <ext-link xlink:href="https://CRAN.R-project.org/package=ktspair" ext-link-type="uri">https://CRAN.R-project.org/package=ktspair</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab088-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>MetaKTSP: a meta-analytic top scoring pair method for robust cross-study validation of omics prediction analysis</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>32</volume>, <fpage>1966</fpage>–<lpage>1973</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kursa</surname><given-names>M.B.</given-names></string-name>, <string-name><surname>Rudnicki</surname><given-names>W.R.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Feature Selection with the Boruta Package</article-title>. <source>J. Stat. Softw</source>., <volume>36</volume>, <fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leek</surname><given-names>J.T.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>The tspair package for finding top scoring pair classifiers in R</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>25</volume>, <fpage>1203</fpage>–<lpage>1204</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paquet</surname><given-names>E.R.</given-names></string-name>, <string-name><surname>Hallett</surname><given-names>M.T.</given-names></string-name></person-group> (<year>2015</year>) 
<article-title>Absolute assignment of breast cancer intrinsic molecular subtype</article-title>. <source>J. Natl. Cancer Inst</source>., <volume>107</volume>, <fpage>357</fpage>.<pub-id pub-id-type="pmid">25479802</pub-id></mixed-citation>
    </ref>
    <ref id="btab088-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popovici</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Rgtsp: a generalized top scoring pairs package for class prediction</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>27</volume>, <fpage>1729</fpage>–<lpage>1730</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>A.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) 
<article-title>Simple decision rules for classifying human cancers from gene expression profiles</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>21</volume>, <fpage>3896</fpage>–<lpage>3904</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>M.N.</given-names></string-name>, <string-name><surname>Ziegler</surname><given-names>A.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>ranger: a fast implementation of random forests for high dimensional data in C++ and R</article-title>. <source>J. Stat. Softw</source>., <volume>77</volume>, <fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btab088-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) 
<article-title>Robust prostate cancer marker genes emerge from direct integration of inter-study microarray data</article-title>. <source>Bioinf. Oxf. Engl</source>., <volume>21</volume>, <fpage>3905</fpage>–<lpage>3911</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
