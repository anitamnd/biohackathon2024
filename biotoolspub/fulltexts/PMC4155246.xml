<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4155246</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu333</article-id>
    <article-id pub-id-type="publisher-id">btu333</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Next maSigPro: updating maSigPro bioconductor package for RNA-seq time series</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nueda</surname>
          <given-names>María José</given-names>
        </name>
        <xref ref-type="aff" rid="btu333-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu333-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tarazona</surname>
          <given-names>Sonia</given-names>
        </name>
        <xref ref-type="aff" rid="btu333-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu333-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conesa</surname>
          <given-names>Ana</given-names>
        </name>
        <xref ref-type="aff" rid="btu333-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btu333-COR1">*</xref>
      </contrib>
      <aff id="btu333-AFF1"><sup>1</sup>Statistics and Operational Research Department, University of Alicante, 03690, Alicante, Spain, <sup>2</sup>Genomics of Gene Expression Laboratory, Prince Felipe Research Centre, 46012 Valencia, Spain and <sup>3</sup>Applied Statistics, Operational Research and Quality Department, Polytechnic University of Valencia, 46020 Valencia, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu333-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>03</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>18</issue>
    <fpage>2598</fpage>
    <lpage>2602</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>8</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>5</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/3.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The widespread adoption of RNA-seq to quantitatively measure gene expression has increased the scope of sequencing experimental designs to include time-course experiments. maSigPro is an R package specifically suited for the analysis of time-course gene expression data, which was developed originally for microarrays and hence was limited in its application to count data.</p>
      <p><bold>Results:</bold> We have updated maSigPro to support RNA-seq time series analysis by introducing generalized linear models in the algorithm to support the modeling of count data while maintaining the traditional functionalities of the package. We show a good performance of the maSigPro-GLM method in several simulated time-course scenarios and in a real experimental dataset.</p>
      <p><bold>Availability and implementation:</bold> The package is freely available under the LGPL license from the Bioconductor Web site (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org">http://bioconductor.org</ext-link>).</p>
      <p><bold>Contact:</bold><email>mj.nueda@ua.es</email> or <email>aconesa@cipf.es</email></p>
    </abstract>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>The use of RNA-seq for transcriptome profiling as a replacement for microarrays has triggered the development of statistical methods to properly deal with the properties of these types of count-based data. RNA-seq measurement of gene expression is based on the number of reads mapped to transcripts, which results in discrete quantities and left-skewed distributions. In contrast, microarray signals are scanned fluorescence intensities, and this translates into continuous and nearly normal expression data. Although normality was typically assumed and linear models (LMs) were applied to model microarray experiments, other distributions such as Poisson and Negative Binomial (NB) capture better the nature of count data. Hence, methods such as edgeR (<xref rid="btu333-B19" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>) and DEseq (<xref rid="btu333-B1" ref-type="bibr">Anders and Huber, 2010</xref>) updated microarray analysis to RNA-seq by incorporating appropriate statistical models, whereas other methodologies were developed specifically for the new technology (<xref rid="btu333-B17" ref-type="bibr">Roberts and Pachter, 2013</xref>; <xref rid="btu333-B21" ref-type="bibr">Tarazona <italic>et al.</italic>, 2011</xref>; <xref rid="btu333-B22" ref-type="bibr">Trapnell <italic>et al.</italic>, 2012</xref>). Moreover, sequencing introduces specific biases to gene expression quantitation and, therefore, dedicated normalization methods exist for RNA-seq to correct for sequencing depth, transcript length (<xref rid="btu333-B12" ref-type="bibr">Mortazavi <italic>et al.</italic>, 2008</xref>), GC content (<xref rid="btu333-B16" ref-type="bibr">Risso <italic>et al.</italic>, 2011</xref>) and non-uniform transcript distributions (<xref rid="btu333-B2" ref-type="bibr">Bullard <italic>et al.</italic>, 2010</xref>; <xref rid="btu333-B18" ref-type="bibr">Robinson and Oshlack, 2010</xref>).</p>
    <p>The first RNA-seq experiments were still constrained by the relatively high costs of sequencing in comparison with microarrays, which restricted experimental designs to case–control studies with low replication. As a consequence, the novel statistical methods mostly addressed this analysis scenario. As the technology became more affordable, other types of designs involving more samples, such as time-course experiments, started to appear. In a time-course study, the dynamics of gene expression are evaluated at different time points after induction by a particular treatment or in relation to development. Statistical analysis of time-course data implies the identification of genes that change their expression along time and/or follow a specific expression pattern. maSigPro is an R package designed for the analysis of transcriptomics time courses (<xref rid="btu333-B3" ref-type="bibr">Conesa <italic>et al.</italic>, 2006</xref>). maSigPro models gene expression by polynomial regression and identifies expression changes along one or across several time series by introducing dummy variables in the model. The method progresses in two regression steps: the first one selects genes with non-flat profiles and the second step creates best regression models for each gene to identify specific time or series-associated changes. The package includes several clustering algorithms and visualization tools to group and display genes with the same expression patterns. maSigPro has been applied in many different biological settings, such as biomedicine (<xref rid="btu333-B6" ref-type="bibr">Hoogerwerf <italic>et al.</italic>, 2008</xref>), biotechnology (<xref rid="btu333-B7" ref-type="bibr">Levin <italic>et al.</italic>, 2007</xref>) and plant research (<xref rid="btu333-B23" ref-type="bibr">Terol <italic>et al.</italic>, 2007</xref>) to cite some, and also has been implemented in several web services (<xref rid="btu333-B11" ref-type="bibr">Medina <italic>et al.</italic>, 2010</xref>; <xref rid="btu333-B14" ref-type="bibr">Nueda <italic>et al.</italic>, 2010</xref>) and used in combination with multivariate statistics to analyze multifactorial designs (<xref rid="btu333-B13" ref-type="bibr">Nueda <italic>et al.</italic>, 2009</xref>) or as batch filtering technique (<xref rid="btu333-B15" ref-type="bibr">Nueda <italic>et al.</italic>, 2012</xref>). maSigPro was developed to treat continuous microarray intensities and applies LMs to model gene expression. In this article, we describe the update of maSigPro to deal with RNA-seq count data by incorporating generalized linear models (GLMs; <xref rid="btu333-B4" ref-type="bibr">Dobson, 2002</xref>; <xref rid="btu333-B10" ref-type="bibr">McCullagh and Nelder, 1989</xref>) into the package and allowing a more flexible choice in the reference family distribution. We demonstrate the appropriateness of this adaptation using simulated and real data and compare the method with edgeR that also accepts time-course designs.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Model</title>
      <p>Considering the case of a time-course experiment with <italic>T</italic> time points and <italic>S</italic> experimental groups or series (e.g. different treatments, strains, tissues), maSigPro uses polynomial regression to model the gene expression value <italic>y<sub>i</sub></italic> at condition <italic>i</italic> and time <italic>t<sub>i</sub></italic>, and defines <italic>S</italic> − 1 binary variables (<italic>z<sub>s</sub></italic>) to distinguish between each experimental group and a reference group (<xref rid="btu333-B3" ref-type="bibr">Conesa <italic>et al.</italic>, 2006</xref>). For the sake of simplicity and illustration of the model, we consider here a quadratic regression and an experiment with two series. The polynomial model of <italic>y<sub>i</sub></italic> is
<disp-formula><mml:math id="UM1"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
maSigPro originally supported only LMs, where the response variable is modeled as a normal distribution. GLMs are a generalization of classical LMs, which can accommodate a wider class of distributions named as <italic>exponential family</italic>, providing great flexibility for modeling different types of response variables. Normal, Poisson, Binomial, Gamma and NB are examples of this family of distributions. These family classes have generic definitions, which imply that a common maximum likelihood method for estimating the parameters of the model can be applied to all of them. Although explicit mathematical expressions can be found for estimators, iterative numerical methods based on the Newton–Raphson are typically used (<xref rid="btu333-B4" ref-type="bibr">Dobson, 2002</xref>; <xref rid="btu333-B10" ref-type="bibr">McCullagh and Nelder, 1989</xref>). In GLMs, hypothesis testing and the goodness of fit of the model are based on the log-likelihood ratio statistic, also denoted as deviance <italic>D</italic>:
<disp-formula><mml:math id="UM2"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="I1"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the maximized likelihood of a model with <italic>m</italic>, the maximum number of parameters that can be estimated, and <inline-formula><mml:math id="I2"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the likelihood of the <italic>P</italic>-dimensional parameter β. The difference between the deviance statistics of the model of interest, <italic>M</italic><sub>1</sub>, and a model without covariates, <italic>M</italic><sub>0</sub>, is <inline-formula><mml:math id="I3"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, which can be used to evaluate the significance of each gene fit. Within the GLMs definition, LMs are recovered when the normal distribution is followed.</p>
      <p>To accommodate the GLMs, the existing <italic>p.vector()</italic> and <italic>T.fit()</italic> functions of the maSigPro package that account, respectively, for first and second regression steps of the method have been modified by replacing the function <italic>lm()</italic> by <italic>glm()</italic>. A new argument, denoted <italic>counts</italic>, has been added to select the type of modeling. The default setting is <italic>counts = FALSE</italic> to keep the LMs and by setting <italic>counts = TRUE</italic>, maSigPro will apply the GLMs option with NB distribution. NB is the recommended family to use when dealing with RNA-seq as it allows overdispersion of variance, which is related to the mean through the (θ) parameter:
<disp-formula><mml:math id="UM3"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>, where</mml:mtext><mml:mspace width=".3em"/><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width=".3em"/><mml:mtext>and</mml:mtext><mml:mspace width=".3em"/><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mi>θ</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p>
      <p>Theta (θ) can be estimated using available software (for instance edgeR, <xref rid="btu333-B19" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>). When no estimation of θ is possible, we recommend to use the default value, θ = 10. Our experience indicates that maSigPro results do not change much by using different values of θ. The package also includes the possibility of applying any other available exponential family through the additional argument <italic>family</italic>.</p>
      <p>In the second step of maSigPro, the goodness of fit, <italic>R</italic><sup>2</sup>, of each optimized gene model is computed. This parameter is used for selecting genes with clear expression trends. In LMs, <italic>R</italic><sup>2</sup> is defined from the residual sum of squares, and in GLMs the goodness of fit is evaluated in terms of the deviance: the percentage of deviance explained by the model. However, for the sake of consistency with older maSigPro versions, the package maintains the notation <italic>R</italic><sup>2</sup> for both LMs and GLMs. The remaining functions of the package stay unchanged.</p>
      <p>Note that no explicit normalization procedure is implemented within the maSigPro methodology, and hence, data should be appropriately normalized beforehand. Results presented in this article have been computed by using TMM normalization (<xref rid="btu333-B18" ref-type="bibr">Robinson and Oshlack, 2010</xref>).</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 The evaluation strategy</title>
      <p>To evaluate the performance of the updated maSigPro to identify differentially expressed genes (DEGs) in RNA-seq time-course data, we have created different synthetic datasets in which we consider several possible experimental designs. Each dataset has been analyzed with maSigPro-LM, maSigPro-GLM and edgeR. Comparison with maSigPro-LM was included to highlight the limitations of this modeling with count data when the number of replicates is low, even after normalization.</p>
      <p>Both maSigPro and edgeR methods are based on the GLMs but with a different approach. The major difference between the maSigPro and edgeR methods is that maSigPro is specialized in the estimation of serial data, i.e. when the independent variable is quantitative such as time. This is achieved by providing an easy way to define a polynomial model for the data. Another important difference is that maSigPro follows a second stepwise regression that obtains the best model for each gene and retains only significant coefficients in each model, whereas edgeR applies the same model to each gene.</p>
      <sec id="SEC2.2.1">
        <title>2.2.1 Simulated data</title>
        <p>Simulations have been created using NB distributions with a parametrization based on the mean μ and size θ. In each sample <italic>i</italic>, where the targeted total number of reads is <italic>N</italic>, and the relative abundance of each gene <italic>g</italic> is <italic>p</italic><sub><italic>gi</italic></sub>, the expected gene counts, μ<sub><italic>gi</italic></sub>, can be computed as
<disp-formula><mml:math id="UM4"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
</p>
        <p>Note that, as gene counts are randomly drawn from a NB distribution, the simulated count values of each gene will slightly vary among samples and so will the total number of reads <italic>N<sub>i</sub></italic> of the sample <italic>i</italic>.</p>
        <p>Simulated datasets were designed to contain genes that belong to one of the <italic>K</italic> = 4 gene expression level classes, which are defined by a fixed reference value at time 1 (<italic>v<sub>k</sub></italic><sub>1</sub>) and a given size (<italic>n<sub>k</sub></italic>, number of genes) in each <italic>k</italic> level as indicated in <xref ref-type="table" rid="btu333-T1">Table 1</xref>.
<table-wrap id="btu333-T1" position="float"><label>Table 1.</label><caption><p>Reference <italic>v<sub>k</sub></italic><sub>1</sub> values for K = 4 groups</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Expression</th><th rowspan="1" colspan="1">Reference value <italic>v<sub>k</sub></italic><sub>1</sub></th><th rowspan="1" colspan="1">Number of genes <italic>n<sub>k</sub></italic></th><th rowspan="1" colspan="1">Genes (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Low</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">10 000</td><td rowspan="1" colspan="1">50</td></tr><tr><td rowspan="1" colspan="1">Median</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">8000</td><td rowspan="1" colspan="1">40</td></tr><tr><td rowspan="1" colspan="1">High</td><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">1900</td><td rowspan="1" colspan="1">9.5</td></tr><tr><td rowspan="1" colspan="1">Very high</td><td rowspan="1" colspan="1">5000</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">20 000</td><td rowspan="1" colspan="1">100</td></tr></tbody></table></table-wrap></p>
        <p>To model time-associated gene expression changes we considered the following linear expression:
<disp-formula><mml:math id="UM5"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width=".3em"/><mml:mi>g</mml:mi><mml:mspace width=".3em"/><mml:mtext>is not DEG</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width=".3em"/><mml:mi>g</mml:mi><mml:mspace width=".3em"/><mml:mtext>is DEG</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mspace width=".3em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where 5% genes have <italic>b<sub>g</sub></italic> values different from zero and are differentially expressed. Furthermore, we modeled three different data scenarios by assigning different values to the <italic>b<sub>g</sub></italic> parameter to subsets of genes: (A) In this scenario, all DEGs increase their expression linearly with <italic>b<sub>g</sub></italic> = 0.2; (B) In this scenario, half of the DEGs increase <italic>b<sub>g</sub></italic> = 0.2 and half decrease with <inline-formula><mml:math id="I4"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, and we added, when needed, a positive value to <italic>v<sub>g</sub></italic><sub>1</sub> to avoid negative means; (C) Genes follow a strong upregulation in the second time-point followed by decrease with <inline-formula><mml:math id="I5"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
        <p>Datasets were modeled either with one or two time series. In the two series case, one series was modeled as described and the second was modeled as a flat profile. For each scenario and series number, datasets were simulated with 1, 2, 3 or 5 replicates. Finally, genes were considered to have constant length equal to 1 kb in all datasets and no length correction was applied in the data.</p>
        <p>Following this simulation scheme, the relative proportion of counts of gene <italic>g</italic> in sample <italic>i</italic> is
<disp-formula><mml:math id="UM6"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
</p>
        <p>This approach provides the way to take into account not only the expression level, but also the composition of the RNA population in the sample, as gene proportions are computed a posteriori and are affected by the gene expression changes modeled in each scenario.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Experimental data</title>
        <p>The maSigPro-GLM and compared methods were evaluated on a real dataset that describes the transcriptional response of inmunocompromised <italic>Arabidopsis thaliana</italic> lines to the barley powdery mildew fungus <italic>Blumeria graminis</italic> (Bgh) (<xref rid="btu333-B5" ref-type="bibr">Hacquard <italic>et al.</italic>, 2013</xref>; <xref rid="btu333-B9" ref-type="bibr">Maekawa <italic>et al.</italic>, 2012</xref>). In this study, pen2 pad4 sag101 Arabidopsis plants harboring (pps) or without (B12) the MLA1-HA construct were challenged with either the Bgh isolate K1 expressing the cognate AVRA1 effector for MLA1 or the Bgh isolate A6 expressing other AVRA effectors. Three independent biological replicates per condition were harvested at 6, 12, 18, 24 h post-inoculation. The experimental design of this study has therefore 4 time points, 2 covariates with 2 levels each one: MLA1 (pps or B12) and Bgh isolate (A6 or K1), 3 replicates and 6477 genes. Initial analysis of these data revealed little effect of the MLA1 construct covariate, which was then eliminated from the model for simplicity. Therefore, in the maSigPro formulation, this experiment corresponds to a replicated 4 time points course with two series (Bgh isolate A6 or K1). Data are available at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE43163">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE43163</ext-link>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Simulation studies</title>
      <p>The simulation experiment contained 24 datasets obtained by combining three secenarios (A, B and C), one or two time series and one of the four replication levels. Datasets were created with θ = 10, and 6 time points. Here, we show results from data with 20 000 genes. Simulations with a smaller dataset of 6000 genes gave similar results.</p>
      <p>One of the challenges in the development of the maSigPro-GLM methodology was to establish an appropriate cutoff value for the <italic>R</italic><sup>2</sup> parameter in the second regression step. We analyzed False Discovery Rate [FDR : false positives (FP)/Selection] and False Non-discovery Rate [FNR: false negatives (FN)/Non-selected] for varying <italic>R</italic><sup>2</sup> values at fixed FDR = 0.05 (<xref ref-type="fig" rid="btu333-F1">Fig. 1</xref>). We observed that as the number of replicates increase, FDR and FNR drop and that the two series scenario is slightly better than the one series case. In general, for <italic>R</italic><sup>2 </sup>= 0.7 the method achieves a good control of FDR with negligible FNR. However, in designs with three replicates and two series, and when five replicates are available, FDR is also controlled by <italic>R</italic><sup>2 </sup>= 0.5. Taking this result into account, we applied a <italic>R</italic><sup>2 </sup>= 0.7 cutoff value to obtain performance metrics in our simulation study. <xref ref-type="table" rid="btu333-T2">Table 2</xref> shows the number of selected genes, FP and FN for the three methods at a FDR = 0.05. Several conclusions can be drawn from these results:
<list list-type="order"><list-item><p>Absence of replication is clearly insufficient for appropriate time-course modeling. maSigPro-LM is unable to find DEGs and maSigPro-GLM calls too many FP. edgeR is not recommended for unreplicated data and, therefore, not used in this case.</p></list-item><list-item><p>In general, maSigPro-LM performs poorly on RNA-seq data in all scenarios and conditions.</p></list-item><list-item><p>Given two or more replicates, maSigPro-GLM succeeds in controlling FDR &lt;5%, whereas edgeR tends to give moreFP, ranging between 11 and 20% false calls.</p></list-item><list-item><p>FNR is properly controlled both by maSigPro-GLM and edgeR. This last method has a zero false call rate in our simulations, whereas maSigPro-GLM shows FNR &lt;1%. Results were basically similar considering one or two series and different expression patterns for DEGs.</p></list-item></list>
<fig id="btu333-F1" position="float"><label>Fig. 1.</label><caption><p>FDR and FNR for maSigPro-GLM at different levels of <italic>R</italic><sup>2</sup> with 1 and 2 series</p></caption><graphic xlink:href="btu333f1p"/></fig>
<table-wrap id="btu333-T2" position="float"><label>Table 2.</label><caption><p>Simulated experiments results with scenarios A, B and C for maSigPro-LM, maSigPro-GLM and edgeR</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">(Scenario) # Series</th><th rowspan="2" colspan="1">Rep</th><th align="center" colspan="3" rowspan="1">maSigPro-LM<hr/></th><th align="center" colspan="3" rowspan="1">maSigPro-GLM<hr/></th><th align="center" colspan="3" rowspan="1">edgeR<hr/></th></tr><tr><th rowspan="1" colspan="1">Sel</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">FN</th><th rowspan="1" colspan="1">Sel</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">FN</th><th rowspan="1" colspan="1">Sel</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">FN</th></tr></thead><tbody align="left"><tr><td colspan="11" rowspan="1">(A)</td></tr><tr><td rowspan="4" colspan="1">1 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">999</td><td rowspan="1" colspan="1">2210</td><td rowspan="1" colspan="1">1496</td><td rowspan="1" colspan="1">286</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">533</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">492</td><td rowspan="1" colspan="1">976</td><td rowspan="1" colspan="1">52</td><td rowspan="1" colspan="1">76</td><td rowspan="1" colspan="1">1135</td><td rowspan="1" colspan="1">135</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">589</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">416</td><td rowspan="1" colspan="1">975</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1">1173</td><td rowspan="1" colspan="1">173</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">515</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">485</td><td rowspan="1" colspan="1">997</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">1170</td><td rowspan="1" colspan="1">170</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1"/><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="4" colspan="1">2 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">471</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">563</td><td rowspan="1" colspan="1">1969</td><td rowspan="1" colspan="1">972</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">981</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">24</td><td rowspan="1" colspan="1">1001</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1267</td><td rowspan="1" colspan="1">267</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">985</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1278</td><td rowspan="1" colspan="1">278</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">995</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1219</td><td rowspan="1" colspan="1">219</td><td rowspan="1" colspan="1">0</td></tr><tr><td colspan="11" rowspan="1">(B)</td></tr><tr><td rowspan="4" colspan="1">1 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">1592</td><td rowspan="1" colspan="1">741</td><td rowspan="1" colspan="1">149</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">723</td><td rowspan="1" colspan="1">46</td><td rowspan="1" colspan="1">323</td><td rowspan="1" colspan="1">990</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">44</td><td rowspan="1" colspan="1">1158</td><td rowspan="1" colspan="1">158</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">750</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">252</td><td rowspan="1" colspan="1">978</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">23</td><td rowspan="1" colspan="1">1155</td><td rowspan="1" colspan="1">155</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">751</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">249</td><td rowspan="1" colspan="1">994</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1136</td><td rowspan="1" colspan="1">136</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1"/><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="4" colspan="1">2 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">253</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">761</td><td rowspan="1" colspan="1">1351</td><td rowspan="1" colspan="1">411</td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">672</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">332</td><td rowspan="1" colspan="1">951</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">1240</td><td rowspan="1" colspan="1">240</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">592</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">408</td><td rowspan="1" colspan="1">963</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">37</td><td rowspan="1" colspan="1">1225</td><td rowspan="1" colspan="1">225</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">538</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">462</td><td rowspan="1" colspan="1">978</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">22</td><td rowspan="1" colspan="1">1138</td><td rowspan="1" colspan="1">138</td><td rowspan="1" colspan="1">0</td></tr><tr><td colspan="11" rowspan="1">(C)</td></tr><tr><td rowspan="4" colspan="1">1 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">1427</td><td rowspan="1" colspan="1">764</td><td rowspan="1" colspan="1">337</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">284</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">730</td><td rowspan="1" colspan="1">972</td><td rowspan="1" colspan="1">37</td><td rowspan="1" colspan="1">65</td><td rowspan="1" colspan="1">1166</td><td rowspan="1" colspan="1">166</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">433</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">570</td><td rowspan="1" colspan="1">945</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">1125</td><td rowspan="1" colspan="1">125</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">357</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">643</td><td rowspan="1" colspan="1">963</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">37</td><td rowspan="1" colspan="1">1134</td><td rowspan="1" colspan="1">134</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1"/><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="4" colspan="1">2 Series</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">222</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">790</td><td rowspan="1" colspan="1">1458</td><td rowspan="1" colspan="1">471</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">684</td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1">325</td><td rowspan="1" colspan="1">996</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1284</td><td rowspan="1" colspan="1">284</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">378</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">322</td><td rowspan="1" colspan="1">999</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1201</td><td rowspan="1" colspan="1">201</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">681</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">319</td><td rowspan="1" colspan="1">998</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">1209</td><td rowspan="1" colspan="1">209</td><td rowspan="1" colspan="1">0</td></tr></tbody></table><table-wrap-foot><fn id="btu333-TF1"><p><italic>Note</italic>: Number of replicates (Rep), number of selected genes (Sel), false positives (FP) and false negatives (FN).</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Experimental study</title>
      <p>We applied both edgeR and maSigPro-GLM to the <italic>A</italic><italic>.</italic><italic>thaliana</italic> time-course data considering the two series defined by the Bgh isolate. An <italic>R</italic><sup>2</sup> threshold of 0.5 was chosen for the second maSigPro-GLM step, according to the results presented in <xref ref-type="fig" rid="btu333-F1">Figure 1</xref>. Genes with &lt;100 reads in all samples were discarded, resulting in a dataset containing 5838 genes. edgeR identified 2870 DEGs across the different time points, whereas maSigPro-GLM selected 2158 DEGs (FDR = 0.05). There were 1629 genes in common between the two methods, 529 specifically found by maSigPro and 1241 identified only by edgeR. Out of these 1241 edgeR exclusive DEGs, 1194 were identified as significant in the first maSigPro but finally not selected in the second regression step because their <italic>R</italic><sup>2 </sup>&lt; 0.5, while the remaining 47 genes were not preselected by maSigPro in the first step. To better understand the gene expression patterns associated to similarities and differences between the two methods, we randomly selected three genes belonging to each of these sets (<xref ref-type="fig" rid="btu333-F2">Fig. 2</xref>). These examples suggested that genes selected by both methodologies and exclusively by maSigPro (A and B) have good regression models, clean expression trends and strong expression changes. Genes selected by edgeR and not preselected by maSigPro (C) show little fold change and high variance, and genes that edgeR calls significant but do not pass the second regression step in maSigPro (D) used to display time-point-specific variances and expression differences.
<fig id="btu333-F2" position="float"><label>Fig. 2.</label><caption><p>Random examples from genes selected with (<bold>A</bold>) maSigPro and edgeR, (<bold>B</bold>) maSigPro and not with edgeR, (<bold>C</bold>) with edgeR and not preselected with maSigPro and (<bold>D</bold>) with edgeR and not with maSigPro because <italic>R</italic><sup>2 </sup>&lt; 0.5</p></caption><graphic xlink:href="btu333f2p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>In this work, we describe and justify the modifications introduced in the maSigPro package to deal with RNA-seq data. We have incorporated GLMs into the first and second regression steps of the algorithm and add the parameter <italic>counts</italic> into the <italic>p.vector()</italic> function to select the type of statistical modeling. Setting <italic>counts = TRUE</italic> chooses the GLMs and applies the NB distribution, whereas <italic>counts = FALSE</italic> selects the Linear Model as previously. The remaining functions for defining the polynomial model, selecting genes, clustering and visualization remained unchanged, making maSigPro a unified package for the analysis of both microarray and RNA-seq time-course data.</p>
    <p>maSigPro applies GLMs to model RNA-seq as do other dedicated statistical packages such as edgeR, included for comparison in this study. The major difference between maSigPro and edegR methods is that maSigPro is specialized in parameter estimation of serial data, i.e. when the independent variable is quantitative such as time. This is achieved by providing an easy way to define a polynomial model for the data that have the flexibility to fit different time-course patterns. In contrast, edgeR treats time not as a continuous variable but as multifactor. Another important difference is that maSigPro follows a second step that obtains the best model for each gene such that only significant coefficients are retained in each model, whereas edgeR applies the same model to each gene under the multifactor consideration. This results in models with more variables that might be prone to give false calls. Moreover, we apply in the second step a filter on gene selection that takes into account the <italic>R</italic><sup>2</sup> of the regression model, implying that only genes with a good fit to the model will be selected. The consequences of the different implementations are clear in the results of the simulation study and the experimental data. Basically, we observed a better control of FDRs in maSigPro and that genes selected by maSigPro have not only significant models but also well-fitted models. Finally, the maSigPro package also provides clustering and visualization of significant genes.</p>
    <p>One important aspect that we considered in our simulation study was the number of replicates and the complexity of the time-course experiment (one or two comparing series). Our results indicate that one replicate is clearly not sufficient for the proper control of the FDRs. While initial RNA-seq took advantage of the accuracy of the technology to avoid replication, recent studies highlight the importance of appropriate replication for a sound RNA-seq data analysis (<xref rid="btu333-B8" ref-type="bibr">Liu <italic>et al.</italic>, 2014</xref>; <xref rid="btu333-B20" ref-type="bibr">Sims <italic>et al.</italic>, 2014</xref>; <xref rid="btu333-B21" ref-type="bibr">Tarazona <italic>et al.</italic>, 2011</xref>). Within the parameter settings of the simulation experiment, we show that maSigPro-GLMs controls FDR and FN from two replicates and that the performance improves as the number of replicates and series increase. Related to this, it is also interesting to comment results of the maSigPro-LM analysis on the synthetic data. While it might be obvious that LMs are not appropriate to model count data, one could speculate that after data normalization, discretization would be removed and the normalized data could be treated as continuous data. However, transformed data are not normally distributed, and right asymmetry still holds. Although transformed data do not necessarily conserve the probability distribution of the untransformed data, the GLMs fitting process mainly depends on the assumed variance-to-mean relationship. Linear transformations of the data do not change these relations and link functions such as the logarithm are not exclusive for discrete data. This becomes evident when looking into the maSigPro-LM results on the simulated data: the linear model performs poorly in most scenarios. However, the central limit theorem suggests that models developed for normal data can be applied to non-normal data if the available sample is large enough. We show that maSigPro-LM can achieve good FDR control when five replicates per condition are used in the two series scenario, although still suffering from a significant rate of false-negative calls. The versatility of the maSigPro package to choose the LMs or GLMs with one simple argument option allows easy adaptation of the methodology to the types of data and experimental design.</p>
    <p>Finally, although significance thresholds in maSigPro-GLM maintain their statistical meaning, the goodness of fit, which is used in the second step of maSigPro to select genes with well-fitted models, is evaluated in GLMs in terms of the deviance: the percentage of deviance explained by the model. We conducted experiments with simulated data to understand how this parameter behaves in different experimental settings. Our results indicated that similar to the recommended threshold in the LM version of maSigPro, a cutoff value of 0.7 is valid in most scenarios. However, when data are abundant, i.e. triplicated measurements and multiple series, this threshold could be lowered to 0.5. Indeed, this value was used in the analysis of the real Arabidopsis dataset. The comparison with edgeR, which solely selects genes on the basis of a significant <italic>P</italic>-value, showed that the maSigPro filtering based on a <italic>R</italic><sup>2</sup> cutoff value resulted in genes with consistent models. Genes that were significant with both methods but discarded by maSigPro because of a <italic>R</italic><sup>2 </sup>&lt; 0.5 used to have outliers or highly variable measurements (<xref ref-type="fig" rid="btu333-F2">Fig. 2</xref>).</p>
    <p>In conclusion, we show that maSigPro-GLM is suitable for the identification of DEGs from time-course RNA-seq data under a wide range of experimental settings. The updated package successfully controls both false-positive and false-negative detection rates.</p>
    <p><italic>Funding</italic>: This work has been funded by the <funding-source>FP7 STATegra</funding-source> [<award-id>GA-30600</award-id>] project, <funding-source>EU FP7</funding-source> [<award-id>30600</award-id>] and the <funding-source>Spanish MINECO</funding-source> [<award-id>BIO2012-40244</award-id>].</p>
    <p><italic>Conflicts of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu333-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>maSigPro: a method to identify significantly differential expression profiles in time-course microarray experiments</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1096</fpage>
        <lpage>1102</lpage>
        <pub-id pub-id-type="pmid">16481333</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B4">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dobson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <source>An Introduction to Generalized Linear Models</source>
        <year>2002</year>
        <edition>2nd edn</edition>
        <publisher-loc>Boca Ratón, FL</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu333-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hacquard</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mosaic genome structure of the barley powdery mildew pathogen and conservation of transcriptional programs in divergent hosts</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>2219</fpage>
        <lpage>2228</lpage>
      </element-citation>
    </ref>
    <ref id="btu333-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoogerwerf</surname>
            <given-names>WA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional profiling of mRNA expression in the mouse distal colon</article-title>
        <source>Gastroenterology</source>
        <year>2008</year>
        <volume>135</volume>
        <fpage>2019</fpage>
        <lpage>2029</lpage>
        <pub-id pub-id-type="pmid">18848557</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial differentiation in the vegetative mycelium of <italic>Aspergillus niger</italic></article-title>
        <source>Eukaryot. Cell</source>
        <year>2007</year>
        <volume>6</volume>
        <fpage>2311</fpage>
        <lpage>2322</lpage>
        <pub-id pub-id-type="pmid">17951513</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq differential expression studies: more sequence or more replication?</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>301</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="pmid">24319002</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maekawa</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conservation of NLR-triggered immunity across plant lineages</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>20119</fpage>
        <lpage>20123</lpage>
        <pub-id pub-id-type="pmid">23175786</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B10">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCullagh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>Generalized Linear Models</source>
        <year>1989</year>
        <edition>2nd edn</edition>
        <publisher-loc>Boca Ratón, FL</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu333-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medina</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Babelomics: an integrative platform for the analysis of transcriptomics, proteomics and genomic data with advanced functional profiling</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>W210</fpage>
        <lpage>W213</lpage>
        <pub-id pub-id-type="pmid">20478823</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nueda</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional assessment of time course microarray data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>Suppl. 6</issue>
        <fpage>S9</fpage>
        <pub-id pub-id-type="pmid">19534758</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nueda</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Serial Expression Analysis: a web tool for the analysis of serial gene expression data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>3822</volume>
        <fpage>239</fpage>
        <lpage>245</lpage>
      </element-citation>
    </ref>
    <ref id="btu333-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nueda</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ARSyN: a method for the identification and removal of systematic noise in multifactorial time course microarray experiments</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>553</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="pmid">22085896</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GC-content normalization for RNA-Seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>480</fpage>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Streaming fragment assignment for real-time analysis of sequencing experiments</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>71</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">23160280</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-Seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing depth and coverage: key considerations in genomic analyses</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>121</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="pmid">24434847</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential expression in RNAseq: a matter of depth</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>2213</fpage>
        <lpage>2223</lpage>
        <pub-id pub-id-type="pmid">21903743</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title>
        <source>Nat. Protoc.</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>562</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="pmid">22383036</pub-id>
      </element-citation>
    </ref>
    <ref id="btu333-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Terol</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of 13000 unique Citrus clusters associated with fruit quality, production and salinity tolerance</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>31</fpage>
        <pub-id pub-id-type="pmid">17254327</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
