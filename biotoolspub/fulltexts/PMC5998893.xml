<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5998893</article-id>
    <article-id pub-id-type="pmid">29745866</article-id>
    <article-id pub-id-type="publisher-id">2129</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2129-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Chao</given-names>
        </name>
        <address>
          <email>chz069@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rabiee</surname>
          <given-names>Maryam</given-names>
        </name>
        <address>
          <email>mrabieeh@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sayyari</surname>
          <given-names>Erfan</given-names>
        </name>
        <address>
          <email>esayyari@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mirarab</surname>
          <given-names>Siavash</given-names>
        </name>
        <address>
          <email>smirarab@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Electrical and Computer Engineering, </institution><institution>University of California at San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, 92093-0021 CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of California at San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, 92093-0021 CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Bioinformatics and Systems Biology, University of California at San Diego, </institution></institution-wrap>9500 Gilman Drive, La Jolla, 92093-0021 CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <issue>Suppl 6</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. JM is a co-author of one of the papers published in this supplement, review of his paper was organised by LN.</issue-sponsor>
    <elocation-id>153</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Evolutionary histories can be discordant across the genome, and such discordances need to be considered in reconstructing the species phylogeny. ASTRAL is one of the leading methods for inferring species trees from gene trees while accounting for gene tree discordance. ASTRAL uses dynamic programming to search for the tree that shares the maximum number of quartet topologies with input gene trees, restricting itself to a predefined set of bipartitions.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce ASTRAL-III, which substantially improves the running time of ASTRAL-II and guarantees polynomial running time as a function of both the number of species (<italic>n</italic>) and the number of genes (<italic>k</italic>). ASTRAL-III limits the bipartition constraint set (<italic>X</italic>) to grow at most linearly with <italic>n</italic> and <italic>k</italic>. Moreover, it handles polytomies more efficiently than ASTRAL-II, exploits similarities between gene trees better, and uses several techniques to avoid searching parts of the search space that are mathematically guaranteed not to include the optimal tree. The asymptotic running time of ASTRAL-III in the presence of polytomies is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left ((nk)^{1.726} D \right)$\end{document}</tex-math><mml:math id="M2"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq1.gif"/></alternatives></inline-formula> where <italic>D</italic>=<italic>O</italic>(<italic>nk</italic>) is the sum of degrees of all <italic>unique</italic> nodes in input trees. The running time improvements enable us to test whether contracting low support branches in gene trees improves the accuracy by reducing noise. In extensive simulations, we show that removing branches with <italic>very</italic> low support (e.g., below 10%) improves accuracy while overly aggressive filtering is harmful. We observe on a biological avian phylogenomic dataset of 14K genes that contracting low support branches greatly improve results.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>ASTRAL-III is a faster version of the ASTRAL method for phylogenetic reconstruction and can scale up to 10,000 species. With ASTRAL-III, low support branches can be removed, resulting in improved accuracy.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2129-y) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenomics</kwd>
      <kwd>Incomplete lineage sorting</kwd>
      <kwd>ASTRAL</kwd>
    </kwd-group>
    <conference>
      <conf-name>RECOMB-CG - 2017 : The Fifteenth RECOMB Comparative Genomics Satellite Conference</conf-name>
      <conf-acronym>RECOMB-CG 2017</conf-acronym>
      <conf-loc>Barcelona, Spain</conf-loc>
      <conf-date>04-06 October 2017</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The potential for genome-wide discordance of evolutionary histories [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] has motivated the development of several approaches for species phylogeny reconstruction. Reconstructing a collection of gene trees, each inferred from a different part of the genome, and then summarizing them to get a species tree is one such approach and is used by many phylogenomic projects (e.g., [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]) (while “gene trees” need not be inferred from functional genes, following the conventions of the field, we will refer to them as such). This two-step approach stands in contrast to concatenation [<xref ref-type="bibr" rid="CR8">8</xref>], where all the data are combined and analyzed in a single analysis. The two-step approach aims to account for discordances between gene trees and the species tree (but its effectiveness is debated [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]) and is more computationally efficient than statistical co-estimation of gene trees and the species tree [<xref ref-type="bibr" rid="CR13">13</xref>]. Incomplete lineage sorting (ILS) is a ubiquitous [<xref ref-type="bibr" rid="CR14">14</xref>] cause of discordance. ILS is typically modeled by the multi-species coalescent model (MSCM) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], where branches of the species tree represent populations, and lineages are allowed to coalesce inside each branch; lineages that fail to coalesce at the root of each branch are moved to the parent branch.</p>
    <p>Many “summary” methods have been developed to infer a species tree from a collection of input trees. Examples include MP-EST [<xref ref-type="bibr" rid="CR17">17</xref>], NJst [<xref ref-type="bibr" rid="CR18">18</xref>], ASTRID [<xref ref-type="bibr" rid="CR19">19</xref>], DISTIQUE [<xref ref-type="bibr" rid="CR20">20</xref>], ASTRAL [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and STAR [<xref ref-type="bibr" rid="CR23">23</xref>], which only use gene tree topologies, and GLASS [<xref ref-type="bibr" rid="CR24">24</xref>] and STEAC [<xref ref-type="bibr" rid="CR23">23</xref>], which also use branch lengths. These methods are all proved statistically consistent under the MSCM, given error-free input gene trees; when input trees are inferred from sequence data, statistical consistency is not guaranteed [<xref ref-type="bibr" rid="CR25">25</xref>]. Most methods take rooted gene trees as input, but some methods (e.g., ASTRAL, NJst/ASTRID and DISTIQUE) use unrooted input trees. ASTRAL-II [<xref ref-type="bibr" rid="CR22">22</xref>] is currently one of the commonly used summary methods.</p>
    <p>In this paper, we introduce an improved version of ASTRAL called ASTRAL-III. As we will show, compared to ASTRAL-II, the new version has better running time without sacrificing accuracy. The improvements in the running time are both theoretical (reducing the asymptotic running time so that it is guaranteed to grow polynomially with the dataset size) and empirical.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Notations and definitions</title>
      <p>Let the set of <italic>n</italic> species be called <italic>L</italic> and let <italic>G</italic> be the set of <italic>k</italic> input gene trees on <italic>L</italic>. Let [<italic>d</italic>] represent the set {1,2…,<italic>d</italic>}. We use <italic>Q</italic>(<italic>t</italic>) to denote the set of quartet trees induced by a tree <italic>t</italic>. Any subset of <italic>L</italic> is called a cluster. We define a partition as a set of clusters that are pairwise mutually exclusive; note that we abuse the term “partition” here because the union of all clusters in a partition need not give the complete set. Each node in an unrooted tree defines a partition. A bipartition (tripartition) is a partition with cardinality two (three); a partition with cardinality at least four corresponds to a multifurcation (also referred to as a polytomy). Let <italic>X</italic> (the constraint bipartition set) be a set of clusters such that for each <italic>A</italic>∈<italic>X</italic>, we also have <italic>L</italic>−<italic>A</italic>∈<italic>X</italic>. We use <italic>Y</italic> to represent the set of all tripartitions that can be build from <italic>X</italic>: 
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} Y=\{(A',A-A',L-A) : A' \subset A, A \in X, A' \in X, A-A' \in X\}. \end{aligned} $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊂</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>}</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2018_2129_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We use <italic>E</italic> to denote the set of all unique partitions and their frequency in <italic>G</italic>. Thus, 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ E=\left\{\left(M, \sum_{g\in G}|N(g) \cap \{M\}|\right) : M\in N(g), g\in G\right\}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo><mml:mo>∩</mml:mo><mml:mo>{</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfenced><mml:mo>:</mml:mo><mml:mi>M</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>N</italic>(<italic>g</italic>) is the set of all partitions representing all internal nodes in the tree <italic>g</italic>. We also define <italic>D</italic> as the sum of the cardinalities of unique partitions in gene trees: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D=\sum_{(M,c)\in E} |M|.  $$ \end{document}</tex-math><mml:math id="M8"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>|</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec4">
      <title>ASTRAL (old versions)</title>
      <p>The problem addressed by ASTRAL is to find the tree that shares the maximum number of induced quartet topologies with the collection of input gene trees: Problem statement: Given a set <italic>G</italic> of input gene trees, find the species tree <italic>t</italic> that maximizes <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{g \in G} |Q(g)\cap Q(t)|$\end{document}</tex-math><mml:math id="M10"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo><mml:mo>∩</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq2.gif"/></alternatives></inline-formula>.</p>
      <p>Lafond and Scornavacca recently proved this problem is NP-hard [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
      <sec id="Sec5">
        <title>ASTRAL-I and ASTRAL-II algorithms</title>
        <p>ASTRAL solves a constrained version of the problem where a set of clusters <italic>X</italic> restricts bipartitions that the output species tree may include (recall ∀<italic>A</italic>∈<italic>X</italic>:<italic>L</italic>−<italic>A</italic>∈<italic>X</italic>). Note that setting <italic>X</italic> to the powerset solves the unconstrained problem. Based on the fact that an unrooted quartet species tree always matches the most likely unrooted quartet gene tree [<xref ref-type="bibr" rid="CR27">27</xref>], ASTRAL is proved statistically consistent [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
        <p>ASTRAL uses dynamic programming to solve the problem using the recursive relation: 
<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${{} \begin{aligned} V(A) &amp;= \left\{\begin{array}{lc} 0 &amp; |A|=1\\ \max_{A'\subset A, (A'|A-A'|L-A)\in Y} V(A,A') &amp; |A|&gt;1 \end{array}\right.\\ V(A,A') &amp;= V(A') + V(A-A') + w(A'|A-A'|L-A) \end{aligned}} $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊂</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2018_2129_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where the function <italic>w</italic>(<italic>T</italic>) scores each tripartition <italic>T</italic>=(<italic>A</italic>|<italic>B</italic>|<italic>C</italic>) against each node in each input gene tree. Let partition <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M=\left (M_{1}|M_{2}|...|M_{d}\right)$\end{document}</tex-math><mml:math id="M14"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>...</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq3.gif"/></alternatives></inline-formula> represent an internal node of degree <italic>d</italic> in a gene tree. The overall contribution of <italic>T</italic> to the score of any species tree that includes <italic>T</italic> is: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ w(T)=\sum_{g\in G}\sum_{M\in N(g)}\frac{1}{2}QI(T,M)  $$ \end{document}</tex-math><mml:math id="M16"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mtext mathvariant="italic">QI</mml:mtext><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where, defining <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a_{i}=|A\cap M_{i}|$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{i}=|B\cap M_{i}|$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq5.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c_{i}=|C\cap M_{i}|$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq6.gif"/></alternatives></inline-formula>, we have: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  {{} \begin{aligned} QI(T, M)=\sum_{i\in [d]}\sum_{j\in [d]-\{i\}}\sum_{k\in [d]-\{i,j\}} \frac{a_{i}+b_{j}+c_{k} -3}{2} a_{i} b_{j} c_{k}. \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">QI</mml:mtext><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>As previously proved [<xref ref-type="bibr" rid="CR21">21</xref>], <italic>QI</italic>(<italic>T,M</italic>) computes twice the number of quartet trees that are going to be shared between any two trees if one includes only <italic>T</italic> and the other includes only <italic>M</italic>. ASTRAL-II requires <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Theta \left (d^{3}\right)$\end{document}</tex-math><mml:math id="M26"><mml:mi>Θ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq7.gif"/></alternatives></inline-formula> time for computing <italic>QI</italic>(.), making its overall running time <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{3}k|Y|\right)$\end{document}</tex-math><mml:math id="M28"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq8.gif"/></alternatives></inline-formula> with polytomies of unbounded degrees or <italic>O</italic>(<italic>nk</italic>|<italic>Y</italic>|) in the absence of polytomies.</p>
        <p>Noting trivially that |<italic>Y</italic>|&lt;|<italic>X</italic>|<sup>2</sup>, the previously published running time analysis of ASTRAL-II was <inline-formula id="IEq9"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (nk|X|^{2}\right)$\end{document}</tex-math><mml:math id="M30"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq9.gif"/></alternatives></inline-formula> for binary gene trees and <inline-formula id="IEq10"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{3}k|X|^{2}\right)$\end{document}</tex-math><mml:math id="M32"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq10.gif"/></alternatives></inline-formula> for trees with polytomies. A recent result by Kane and Tao [<xref ref-type="bibr" rid="CR28">28</xref>] (motivated by the analysis of ASTRAL) proved that <inline-formula id="IEq11"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}|Y|\leq |X|^{3/log_{3}(27/4)}$\end{document}</tex-math><mml:math id="M34"><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mtext mathvariant="italic">lo</mml:mtext><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>27</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq11.gif"/></alternatives></inline-formula>. This result immediately gives us a better upper bound on the running time.</p>
        <sec id="d29e1635">
          <title>
            <bold>Corollary 1</bold>
          </title>
          <p>ASTRAL-II runs in <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (nk|X|^{{1.726}}\right)$\end{document}</tex-math><mml:math id="M36"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{3}k|X|^{{1.726}}\right)$\end{document}</tex-math><mml:math id="M38"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq13.gif"/></alternatives></inline-formula>, respectively, with and without polytomies in gene trees.</p>
          <p>In ASTRAL-I, <italic>X</italic> is the set of all bipartitions observed in input gene trees. While sufficient for statistical consistency and often for accuracy, under some conditions, this set <italic>X</italic> is too restrictive. To address this shortcoming, ASTRAL-II [<xref ref-type="bibr" rid="CR22">22</xref>] uses several heuristics (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix A) and further expands the set <italic>X</italic>. Even though ATRAL-II tries to limit |<italic>X</italic>|, it does not provide any guarantees as to how it grows with <italic>n</italic> and <italic>k</italic>. In the worst case, |<italic>X</italic>| can grow exponentially, and thus, ASTRAL-II does not guarantee polynomial running time. The relatively high accuracy of ASTRAL-II has been shown in several simulations [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] and it has been adopted by the community as one of the main methods used in phylogenomics. ASTRAL has the ability to compute branch lengths in coalescent units [<xref ref-type="bibr" rid="CR2">2</xref>] and a measure of branch support called local posterior probability [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
        </sec>
      </sec>
      <sec id="Sec6">
        <title>Limitations of ASTRAL-II</title>
        <p>Several shortcomings of ASTRAL-II in terms of running time are addressed here (ASTRAL-III); our improvements, in turn, enable new types of analyses.</p>
        <p>While ASTRAL-II can analyze datasets with a thousand species and gene trees in reasonable time, it does not easily scale to many tens of thousands of input trees. Datasets with more than ten thousand loci are already available (e.g., [<xref ref-type="bibr" rid="CR5">5</xref>]) and as more genomes are sequenced, more are destined to become available in the near future. Moreover, being able to handle large <italic>k</italic> (i.e., numbers of input trees) enables using multiple trees per locus (e.g., a Bayesian sample) as input to ASTRAL. The limited scalability of ASTRAL with <italic>k</italic> has two reasons. First, the set <italic>X</italic> is not bounded in ASTRAL-II and can grow to become the power set. Thus, in ASTRAL-II, |<italic>X</italic>|<italic>can</italic> theoretically grow exponentially with <italic>n</italic>. We fix this in ASTRAL-III by modifying heuristics that form the set <italic>X</italic> so that they all guarantee that |<italic>X</italic>|=<italic>O</italic>(<italic>nk</italic>). The second cause of the slowdown is that computing each <italic>w</italic>(<italic>T</italic>) for a tripartition <italic>T</italic> requires <italic>Θ</italic>(<italic>nk</italic>). This computation does not exploit similarities between gene trees, a shortcoming that we fix in ASTRAL-III.</p>
        <p>Beyond large <italic>k</italic>, ASTRAL-II, which scales as <italic>O</italic>(<italic>n</italic><sup>3</sup><italic>k</italic>|<italic>X</italic>|<sup>1.726</sup>) in the presence of polytomies, can quickly become prohibitively slow for input trees with large polytomies. ASTRAL-III uses a mathematical trick to enable scoring of gene tree polytomies in time similar to binary nodes. The ability to handle large polytomies in input gene trees is important for two reasons. Some of the conditions that are conducive to ILS, namely shallow trees, are also likely to produce identical gene sequence data for several species. The gene tree should leave the relationship between identical sequences unresolved (FastTree [<xref ref-type="bibr" rid="CR32">32</xref>] automatically does it and RAxML, which outputs an arbitrary resolution, warns the user about the input). Moreover, all summary methods, including ASTRAL, are sensitive to gene tree estimation error [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR37">37</xref>]. One way of dealing with gene tree error, previously studied in the context of minimizing deep coalescence [<xref ref-type="bibr" rid="CR38">38</xref>], is to contract low support branches in gene trees and use these unresolved trees as input to the summary method. While earlier studies found no evidence that this approach helps ASTRAL-II when the support is judged by SH-like FastTree support [<xref ref-type="bibr" rid="CR22">22</xref>], no study has tested this approach with bootstrap support values. We will for the first time evaluate the effectiveness of contracting branches with low <italic>bootstrap</italic> support and show that conservative filtering of <italic>very</italic> low support branches does, in fact, help the accuracy.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>ASTRAL-III</title>
      <p>ASTRAL-III has six new features: 
<list list-type="order"><list-item><p>Heuristics for building the set <italic>X</italic> are modified to ensure |<italic>X</italic>|=<italic>O</italic>(<italic>nk</italic>). This step alone (without subsequent improvements) guarantees the overall running time is <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left ((nk)^{2.726}\right)$\end{document}</tex-math><mml:math id="M40"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq14.gif"/></alternatives></inline-formula> for binary gene trees and <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{4.726}k^{2.726}\right)$\end{document}</tex-math><mml:math id="M42"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>4.726</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq15.gif"/></alternatives></inline-formula> for polytomies.</p></list-item><list-item><p>Heuristics for building the set <italic>X</italic> are modified to enlarge <italic>X</italic> for gene trees with polytomies without breaking |<italic>X</italic>|=<italic>O</italic>(<italic>nk</italic>) guarantees. This can impact the accuracy and empirical running times but not the asymptotic running time.</p></list-item><list-item><p>A new way of computing <italic>w</italic>(<italic>q</italic>) is introduced to reduce the running time for scoring a gene tree to <italic>O</italic>(<italic>n</italic>), instead of <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{3}\right)$\end{document}</tex-math><mml:math id="M44"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq16.gif"/></alternatives></inline-formula>, in the presence of polytomies. This step, combined with the previous steps, reduces the total running time to <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left ((nk)^{2.726}\right)$\end{document}</tex-math><mml:math id="M46"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq17.gif"/></alternatives></inline-formula> irrespective of whether gene trees have polytomies.</p></list-item><list-item><p>A polytree is used to represent gene trees, and this enables an algorithm that reduces the overall running time from <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left ((nk)^{2.726}\right)$\end{document}</tex-math><mml:math id="M48"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq18.gif"/></alternatives></inline-formula> to <italic>O</italic>(<italic>D</italic>.(<italic>nk</italic>)<sup>1.726</sup>), which is the final theoretical analysis of ATRAL-III running time.</p></list-item><list-item><p>A new algorithm, similar to A* [<xref ref-type="bibr" rid="CR39">39</xref>], is used to compute an upper-bound on the best possible resolution of a clade; we need not expand a clade recursively when its upper-bound is below the best available score. The worst case asymptotic running time does not change due to this feature.</p></list-item><list-item><p>A two-stage heuristic mechanism is designed to further tighten the upper bounds used in pruning unnecessary parts of the search space. The worst case asymptotic running time is not impacted.</p></list-item></list></p>
      <p>A beta version of ASTRAL-III was recently described [<xref ref-type="bibr" rid="CR40">40</xref>] and that version included features 3–5 but not the others. We next describe each improvement.</p>
      <sec id="Sec8">
        <title>New search space: |<italic>X</italic>|=<italic>O</italic>(<italic>nk</italic>)</title>
        <p>ASTRAL-II uses several heuristic methods to build <italic>X</italic> (see the original paper [<xref ref-type="bibr" rid="CR22">22</xref>] for details). The main method involves computing several extended majority consensus trees from gene trees and then resolving polytomies in these consensus trees using three techniques (mentioned below). These steps are repeated for 10 rounds or more until very few (less than a constant threshold) of the bipartitions observed are new to <italic>X</italic>. Because the number of rounds is not constant or a function of <italic>n</italic> and <italic>k</italic>, we cannot bound how <italic>X</italic> grows with <italic>n</italic> and <italic>k</italic> for ASTRAL-II. In ASTRAL-III, we limit the number of rounds by a constant value (default set to 110). This enables us to provide guarantees of a polynomial growth of |<italic>X</italic>| with <italic>n</italic> and <italic>k</italic>.</p>
        <p>To get to <italic>X</italic>=<italic>O</italic>(<italic>nk</italic>), we need further changes. As mentioned, three techniques are used to resolve each polytomy of degree <italic>d</italic> in extended majority consensus trees. The first technique uses a precomputed distance matrix to build a UPGMA tree starting from sides of the polytomy and adds the new bipartitions from the UPGMA tree to <italic>X</italic>. This can only add <italic>O</italic>(<italic>d</italic>)=<italic>O</italic>(<italic>n</italic>) resolutions. The second technique computes a greedy consensus of gene trees subsampled to randomly selected taxa (one from each side of the polytomy) and adds bipartitions from the greedy consensus to <italic>X</italic>. This also can only add <italic>O</italic>(<italic>d</italic>) new bipartitions. The third resolution samples a taxon from each side of the polytomy, computes <italic>d</italic> caterpillar trees, each constructed based on decreasing similarity to each sampled taxon, and adds the bipartitions from all these caterpillar trees to <italic>X</italic>. This quadratic resolution step can add <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (d^{2}\right)=O\left (n^{2}\right)$\end{document}</tex-math><mml:math id="M50"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq19.gif"/></alternatives></inline-formula> bipartitions to <italic>X</italic>. To have |<italic>X</italic>|=<italic>O</italic>(<italic>n</italic>), we need to change this step. Let <italic>d</italic><sub>1</sub>…<italic>d</italic><sub><italic>r</italic></sub> be the list of all polytomy degrees in an extended majority consensus tree in the ascending ordered. We find the smallest threshold <italic>q</italic> such that <inline-formula id="IEq20"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i=1}^{q} d_{i}^{2} \leq c n$\end{document}</tex-math><mml:math id="M52"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mtext mathvariant="italic">cn</mml:mtext></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq20.gif"/></alternatives></inline-formula> for some constant <italic>c</italic> (default =25). In ASTRAL-III, we apply the quadratic resolution technique only for polytomies <italic>d</italic><sub>1</sub>…<italic>d</italic><sub><italic>q</italic></sub>; this, by definition, ensures no more than <italic>O</italic>(<italic>d</italic>)=<italic>O</italic>(<italic>n</italic>) bipartitions are added in each round.</p>
      </sec>
      <sec id="Sec9">
        <title>New search space: handling gene tree polytomies</title>
        <p>We also change the way ASTRAL builds <italic>X</italic> in the presence of gene tree polytomies. Our goal is to increase |<italic>X</italic>| compared to ASTRAL-II for multifurcating gene trees. However, |<italic>X</italic>| is enlarged at most by a constant factor and we retain |<italic>X</italic>|=<italic>O</italic>(<italic>nk</italic>).</p>
        <p>If a gene tree includes polytomies, ASTRAL-II adds bipartitions implied by resolutions of that polytomy to the set <italic>X</italic> using a guide tree <italic>g</italic>. To build <italic>g</italic>, a greedy consensus of all gene trees is computed and is further refined to become binary by applying UPGMA to each polytomy of the greedy tree using a precomputed similarity matrix (see the original paper [<xref ref-type="bibr" rid="CR22">22</xref>] for details). To resolve a gene tree polytomy of degree <italic>d</italic>, ASTRAL-II first randomly samples <italic>d</italic> taxa, each from one side of the polytomy. Let <italic>S</italic> be the sampled taxa. All bipartitions from the tree <italic>g</italic> restricted to the set <italic>S</italic> of leaves are added to <italic>X</italic>. While in ASTRAL-II this process is done only once, in ASTRAL-III, we repeat the process three times with different random samples <italic>S</italic>. This increases |<italic>X</italic>| but at most by a constant factor. The enlarged <italic>X</italic> can lead to improved accuracy when input trees include many polytomies.</p>
        <p>The second change in ASTRAL-III is that we now use a UPGMA tree inferred based on the similarity matrix as the guide tree. We observed that the UPGMA tree summarizes the input gene trees more accurately than the greedy tree (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Finally, in ASTRAL-III, we improve the definition of the similarity matrix in the presence of gene tree polytomies. Unlike in ASTRAL-II, we ensure that unresolved quartet trees induced by gene trees do not increase the similarity between pairs of taxa included in those quartets. Note that the similarity matrix, which is based on quartets, should not be confused with the quartet score optimized by ASTRAL.</p>
      </sec>
      <sec id="Sec10">
        <title>Efficient handling of Polytomies</title>
        <p>Recall that ASTRAL-II uses Eq. <xref rid="Equ4" ref-type="">4</xref> to score a tripartition against a polytomy of size <italic>d</italic> in <italic>Θ</italic>(<italic>d</italic><sup>3</sup>) time. Our next Lemma shows that this can be improved.</p>
        <sec id="d29e2376">
          <title>
            <bold>Lemma 1</bold>
          </title>
          <p>Let <italic>QI</italic>(<italic>T,M</italic>) be twice the number of quartet tree topologies shared between an unrooted tree that only includes a node corresponding to the tripartition <italic>T</italic>=(<italic>A</italic>|<italic>B</italic>|<italic>C</italic>) and another tree that includes only a node corresponding to a partition <inline-formula id="IEq21"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M=\left (M_{1}|M_{2}|...|M_{d}\right)$\end{document}</tex-math><mml:math id="M54"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>...</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq21.gif"/></alternatives></inline-formula> of degree <italic>d</italic>; then, <italic>QI</italic>(<italic>T,M</italic>) can be computed in time <italic>Θ</italic>(<italic>d</italic>).</p>
        </sec>
        <sec id="d29e2460">
          <title>
            <italic>Proof</italic>
          </title>
          <p>In <italic>Θ</italic>(<italic>d</italic>) time, we can compute: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S_{a} =\sum_{i\in [d]}a_{i}~~~\textmd{and}~~~ S_{a,b} =\sum_{i\in [d]}a_{i} b_{i}  $$ \end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
          <p>where <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a_{i}=|A\cap M_{i}|$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{i}=|B\cap M_{i}|$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq23.gif"/></alternatives></inline-formula>; we can also compute <italic>S</italic><sub><italic>b</italic></sub>, <italic>S</italic><sub><italic>c</italic></sub>, <italic>S</italic><sub><italic>a,c</italic></sub> and <italic>S</italic><sub><italic>b,c</italic></sub> (similarly defined). Equation <xref rid="Equ4" ref-type="">4</xref> computes twice the number of quartet tree topologies shared between an unrooted tree with internal node <italic>T</italic> and another tree with one internal node <italic>M</italic> [<xref ref-type="bibr" rid="CR22">22</xref>]. Equation <xref rid="Equ4" ref-type="">4</xref> can be rewritten as: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} QI\left((A|B|C), M\right)=&amp;\sum_{i\in [d]}{{a_{i}}\choose{2}}\left((S_{b} - b_{i}) (S_{c} - c_{i}) - S_{b,c} + b_{i} c_{i}\right)\\ +&amp;\sum_{i\in [d]}{{b_{i}}\choose{2}}\left((S_{a} - a_{i}) (S_{c} - c_{i}) - S_{a,c} + a_{i} c_{i}\right)\\ +&amp;\sum_{i\in [d]}{{c_{i}}\choose{2}}\left((S_{a} - a_{i}) (S_{b} - b_{i}) - S_{a,b} + a_{i} b_{i}\right) \end{aligned}  $$ \end{document}</tex-math><mml:math id="M62"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">QI</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
          <p>(the derivation is given in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix B). Computing Eq. <xref rid="Equ6" ref-type="">6</xref> instead of Eq. <xref rid="Equ4" ref-type="">4</xref> clearly reduces the running time to <italic>Θ</italic>(<italic>d</italic>) instead of <inline-formula id="IEq24"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Theta \left (d^{3}\right)$\end{document}</tex-math><mml:math id="M64"><mml:mi>Θ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq24.gif"/></alternatives></inline-formula>. □</p>
          <p>ASTRAL needs to score each of the |<italic>Y</italic>| tripartitions considered in the dynamic programming against each internal node of each input gene tree. The sum of degrees of <italic>k</italic> trees on <italic>n</italic> leaves is <italic>O</italic>(<italic>nk</italic>) (since that sum can never exceed the number of bipartitions in gene trees) and thus:</p>
        </sec>
        <sec id="d29e3071">
          <title>
            <bold>Corollary 2</bold>
          </title>
          <p>Scoring a tripartition (i.e., computing <italic>w</italic>) can be done in <italic>O</italic>(<italic>nk</italic>).</p>
        </sec>
      </sec>
      <sec id="Sec11">
        <title>Gene trees as a Polytree</title>
        <p>ASTRAL-II scores each dynamic programming tripartition against each individual node of each gene tree. However, nodes that are repeated in several gene trees need not be recomputed. Recalling the definitions of <italic>E</italic> and <italic>D</italic> (Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>),</p>
        <sec id="d29e3103">
          <title>
            <bold>Lemma 2</bold>
          </title>
          <p>The score of a tripartition <italic>T</italic>=(<italic>A</italic>|<italic>B</italic>|<italic>C</italic>) against all gene trees (i.e., the <italic>w</italic>(<italic>T</italic>) score) can be computed in <italic>Θ</italic>(<italic>D</italic>).</p>
        </sec>
        <sec id="d29e3134">
          <title>
            <italic>Proof</italic>
          </title>
          <p>In ASTRAL-III, we keep track of nodes that appear in multiple trees. This enables us to reduce the total calculation by using multiplicities: 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ w(T)=\sum_{(M,c)\in E}c\times QI(T,M).  $$ \end{document}</tex-math><mml:math id="M66"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mtext mathvariant="italic">QI</mml:mtext><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
          <p>We achieve this in two steps. In the first step, for each distinct gene tree cluster <italic>W</italic>, we compute the cardinality of the intersection of <italic>W</italic> and sets <italic>A</italic>, <italic>B</italic>, and <italic>C</italic> once using a depth-first search with memoization. Let <italic>children</italic>(<italic>W</italic>) denote the set of children of <italic>W</italic> in an arbitrarily chosen tree <italic>g</italic>∈<italic>G</italic> containing <italic>W</italic>. Then, we have the following recursive relation: 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  |W \cap A| = \sum_{Z\in children(W)} |Z \cap A|  $$ \end{document}</tex-math><mml:math id="M68"><mml:mo>|</mml:mo><mml:mi>W</mml:mi><mml:mo>∩</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">children</mml:mtext><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>∩</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:math><graphic xlink:href="12859_2018_2129_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
          <p>(ditto for <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|W \cap B|$\end{document}</tex-math><mml:math id="M70"><mml:mo>|</mml:mo><mml:mi>W</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|W \cap C|$\end{document}</tex-math><mml:math id="M72"><mml:mo>|</mml:mo><mml:mi>W</mml:mi><mml:mo>∩</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq26.gif"/></alternatives></inline-formula>). All such intersection values can be computed in a post-order traversal of a polytree. In this polytree, all unique clusters in the gene trees are represented as vertices and parent-child relations are represented as edges; note that when a cluster has different resolutions in two different input trees, we arbitrary choose one set of children in building the polytree. The polytree will include no more than <italic>D</italic> edges; thus, the time complexity of traversing this polytree (to compute Eq. <xref rid="Equ8" ref-type="">8</xref>) for all nodes is <italic>O</italic>(<italic>D</italic>). Once all intersections are computed, in the second step, we simply compute the sum in Eq. <xref rid="Equ7" ref-type="">7</xref>. Each <italic>QI</italic>(.) computation requires <italic>Θ</italic>(<italic>d</italic>) by Lemma 1. Recalling that <inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D=\sum _{(M,c)\in E} |M|$\end{document}</tex-math><mml:math id="M74"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq27.gif"/></alternatives></inline-formula>, it is clear that computing Eq. <xref rid="Equ7" ref-type="">7</xref> requires <italic>Θ</italic>(<italic>D</italic>). Therefore, both steps can be performed in <italic>Θ</italic>(<italic>D</italic>). □</p>
        </sec>
        <sec id="d29e3399">
          <title>
            <bold>Theorem 1</bold>
          </title>
          <p>The running time of ASTRAL-III grows as <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (D(nk)^{{1.726}}\right)$\end{document}</tex-math><mml:math id="M76"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq28.gif"/></alternatives></inline-formula> for both binary and multifurcating gene trees.</p>
        </sec>
        <sec id="d29e3430">
          <title>
            <italic>Proof</italic>
          </title>
          <p>By results of Kane and Tao [<xref ref-type="bibr" rid="CR28">28</xref>], the size of the set <italic>Y</italic> is <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (|X|^{{1.726}}\right)$\end{document}</tex-math><mml:math id="M78"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq29.gif"/></alternatives></inline-formula>, and for each element in <italic>Y</italic>, by Lemma 2, we require <italic>O</italic>(<italic>D</italic>) to compute the weights, regardless of the presence or absence of polytomies. The running time of ASTRAL is dominated by computing the weights [<xref ref-type="bibr" rid="CR22">22</xref>]. Thus, the overall running time is <inline-formula id="IEq30"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O(D|Y|)=O\left (D|X|^{1.726}\right)$\end{document}</tex-math><mml:math id="M80"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq30.gif"/></alternatives></inline-formula>. Moreover, ASTRAL-III forces |<italic>X</italic>| to grow as <italic>O</italic>(<italic>nk</italic>), giving the overall running time of <inline-formula id="IEq31"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (D(nk)^{1.726}\right)$\end{document}</tex-math><mml:math id="M82"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq31.gif"/></alternatives></inline-formula> □</p>
        </sec>
      </sec>
      <sec id="Sec12">
        <title>Trimming of the dynamic programming</title>
        <p>We now introduce an upper-bound (proved in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix B): 
<disp-formula id="Equc"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$V(A) \leq U(A)=\frac{w(A|A|L)}{2}-\frac{w(A|A|A)}{3}. $$ \end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2129_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Let <italic>U</italic>(<italic>A,A</italic><sup>″</sup>)=<italic>U</italic>(<italic>A</italic><sup>″</sup>)+<italic>U</italic>(<italic>A</italic>−<italic>A</italic><sup>″</sup>)+<italic>w</italic>(<italic>A</italic><sup>″</sup>|<italic>A</italic>−<italic>A</italic><sup>″</sup>|<italic>L</italic>−<italic>A</italic>). Since <italic>V</italic>(<italic>A</italic>)≤<italic>U</italic>(<italic>A</italic>), for any (<italic>A</italic><sup>′</sup>|<italic>A</italic>−<italic>A</italic><sup>′</sup>|<italic>L</italic>−<italic>A</italic><sup>′</sup>)∈<italic>Y</italic> and (<italic>A</italic><sup>″</sup>|<italic>A</italic>−<italic>A</italic><sup>″</sup>|<italic>L</italic>−<italic>A</italic><sup>″</sup>)∈<italic>Y</italic>, we no longer need to recursively compute <italic>V</italic>(<italic>A</italic><sup>″</sup>) and <italic>V</italic>(<italic>A</italic>−<italic>A</italic><sup>″</sup>) when <italic>U</italic>(<italic>A,A</italic><sup>″</sup>)≤<italic>V</italic>(<italic>A,A</italic><sup>′</sup>). When computing <italic>V</italic>(<italic>A</italic>) by maximizing the score over all resolutions of <italic>A</italic>, imagine that we first encounter <italic>A</italic><sup>′</sup> and then <italic>A</italic><sup>″</sup>. We avoid expanding <italic>A</italic><sup>″</sup> when <italic>U</italic>(<italic>A,A</italic><sup>″</sup>)≤<italic>V</italic>(<italic>A,A</italic><sup>′</sup>). This approach clearly makes the order of processing of the resolutions important. To heuristically improve the efficiency of this approach, we order all (<italic>A</italic><sup>′</sup>|<italic>A</italic>−<italic>A</italic><sup>′</sup>|<italic>L</italic>−<italic>A</italic>)∈<italic>Y</italic> according to <italic>U</italic>(<italic>A,A</italic><sup>′</sup>). Note that computing <italic>U</italic>(<italic>A</italic>) does not require recursive computations down the dynamic programming DAG. Thus, the use of this upper-bound results in the trimming of the search space. However, as far as we can tell, this trimming does not improve the theoretical running time.</p>
      </sec>
      <sec id="Sec13">
        <title>Two-staged <italic>α</italic>-trimming</title>
        <p>In order to further trim the search space, another upper-bound of <italic>V</italic>(<italic>A</italic>) is calculated. For a given <italic>α</italic>≥1 and any ordering of the set <inline-formula id="IEq32"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{A' : (A'|A-A'|L-A) \in Y \right \}$\end{document}</tex-math><mml:math id="M86"><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq32.gif"/></alternatives></inline-formula> denoted by <italic>A</italic><sub>1</sub>…<italic>A</italic><sub><italic>r</italic></sub>, we define <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>) as follows. 
<disp-formula id="Equd"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} {V_{\alpha}}^{i}(A) &amp;= \left\{ \begin{array}{lr} 0, &amp; i = 0 \\ {V_{\alpha}}(A,A_{i}), &amp; {V_{\alpha}}(A,A_{i}) &gt; \alpha {V_{\alpha}}^{i-1}(A)\\ {V_{\alpha}}^{i-1}(A), &amp; \text{otherwise} \end{array}\right\} ~~ \text{for} 0\leq i\leq r\\ {V_{\alpha}}(A,A_{i}) &amp;= {V_{\alpha}}(A_{i})+{V_{\alpha}}(A-A_{i})+w(A_{i}|A-A_{i}|L-A) ~~ \text{and}\\&amp; {V_{\alpha}}(A) = {V_{\alpha}}^{r}(A) \end{aligned} $$ \end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2018_2129_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>We can compute <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>) using an algorithm equivalent to our dynamic programming for computing <italic>V</italic>(<italic>A</italic>), except that, as resolutions of a clade <italic>A</italic> are being tested, a new one is accepted only if it improves upon the previous best resolution by a factor of <italic>α</italic> (thus, <italic>α</italic>=1 simply reproduces our existing dynamic programming). When computing <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>), for any <italic>i</italic>&lt;<italic>j</italic>, if <inline-formula id="IEq33"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha \left (V_{\alpha }(A,A_{i})\right) \geq U(A,A_{j})$\end{document}</tex-math><mml:math id="M90"><mml:mi>α</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq33.gif"/></alternatives></inline-formula>, then it is guaranteed that <inline-formula id="IEq34"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha \left (V_{\alpha }(A,A_{i})\right) \geq V_{\alpha }\left (A,A_{j}\right)$\end{document}</tex-math><mml:math id="M92"><mml:mi>α</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq34.gif"/></alternatives></inline-formula>, and thus we no longer need to recursively compute <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic><sub><italic>j</italic></sub>) and <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>). After all <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>) values are computed for some choice of <italic>α</italic>, we turn to computing <italic>V</italic>(<italic>A</italic>).</p>
        <p>Observe that <italic>V</italic><sub><italic>α</italic></sub>(<italic>A</italic>)≤<italic>V</italic>(<italic>A</italic>)≤<italic>αV</italic><sub><italic>α</italic></sub>(<italic>A</italic>). Let <italic>U</italic><sub><italic>α</italic></sub>(<italic>A,A</italic><sub><italic>j</italic></sub>) be defined as 
<disp-formula id="Eque"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \min\left(U(A_{j}), \alpha V_{\alpha}(A_{j})\right) &amp; + \min\left(U(A-A_{j}), \alpha V_{\alpha}(A-A_{j})\right) \\&amp;\quad+ w(A_{j}|A-A_{j}|L-A) \end{aligned} $$ \end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>min</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>+</mml:mo><mml:mo>min</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2018_2129_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> and note that <italic>U</italic><sub><italic>α</italic></sub>(<italic>A,A</italic><sub><italic>j</italic></sub>)≥<italic>V</italic>(<italic>A,A</italic><sub><italic>j</italic></sub>)=<italic>V</italic>(<italic>A</italic><sub><italic>j</italic></sub>)+<italic>V</italic>(<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>)+<italic>w</italic>(<italic>A</italic><sub><italic>j</italic></sub>|<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>|<italic>L</italic>−<italic>A</italic>). Thus, during the dynamic programming, for <italic>i</italic>&lt;<italic>j</italic>, if <italic>V</italic>(<italic>A,A</italic><sub><italic>i</italic></sub>)&gt;<italic>U</italic><sub><italic>α</italic></sub>(<italic>A,A</italic><sub><italic>j</italic></sub>), then it is guaranteed that <italic>V</italic>(<italic>A,A</italic><sub><italic>i</italic></sub>)≥<italic>V</italic>(<italic>A,A</italic><sub><italic>j</italic></sub>), and thus we no longer need to recursively compute <italic>V</italic>(<italic>A</italic><sub><italic>j</italic></sub>) and <italic>V</italic>(<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>). The hope is that the <italic>U</italic><sub><italic>α</italic></sub> function will give us tighter upper bounds compared to the <italic>U</italic> function previously defined. Whether this happens or not depends on the choice of <italic>α</italic>, the order of visiting clusters, and the particularities of a dataset.</p>
        <p>While any choice of <italic>α</italic>≥1 would guarantee the correct solution to the dynamic programming, we have empirically selected a heuristic to choose <italic>α</italic>. We set <inline-formula id="IEq35"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha = \frac {U(L)}{g(L)}$\end{document}</tex-math><mml:math id="M96"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq35.gif"/></alternatives></inline-formula>, where <italic>g</italic>(<italic>A</italic>)=<italic>g</italic>(<italic>A</italic><sub><italic>i</italic></sub>)+<italic>g</italic>(<italic>A</italic>−<italic>A</italic><sub><italic>i</italic></sub>)+<italic>w</italic>(<italic>A</italic><sub><italic>i</italic></sub>|<italic>A</italic>−<italic>A</italic><sub><italic>i</italic></sub>|<italic>L</italic>−<italic>A</italic>) where <italic>i</italic>=arg max<sub><italic>j</italic></sub><italic>U</italic>(<italic>A</italic><sub><italic>j</italic></sub>)+<italic>U</italic>(<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>)+<italic>w</italic>(<italic>A</italic><sub><italic>j</italic></sub>|<italic>A</italic>−<italic>A</italic><sub><italic>j</italic></sub>|<italic>L</italic>−<italic>A</italic>) and <italic>g</italic>(<italic>A</italic>)=0 for |<italic>A</italic>|=1. Just as before, we order the clusters in the decreasing order of <italic>U</italic>(<italic>A,A</italic><sub><italic>i</italic></sub>).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="results">
    <title>Results</title>
    <sec id="Sec15">
      <title>Experimental setup</title>
      <p>We study three research questions: RQ1: Can <italic>contracting low support branches</italic> improve the accuracy of ASTRAL? RQ2: How do the <italic>running time and search space</italic> compare between ASTRAL-II and ASTRAL-III? RQ3: How <italic>accurate</italic> is ASTRAL-III, which guarantees polynomial size search space, compared to ATRAL-II?</p>
      <sec id="Sec16">
        <title>Datasets</title>
        <sec id="Sec17">
          <title>Avian biological dataset:</title>
          <p>Neoavian relationships show extremely high levels of gene tree discord, perhaps because their ancestors experienced a rapid radiation [<xref ref-type="bibr" rid="CR5">5</xref>]. A dataset of 48 genomes representing all avian orders has been used to partially resolve this rapid radiation [<xref ref-type="bibr" rid="CR5">5</xref>]. A set of 14,446 loci (including exons, introns, and UCEs) was used to produce two reference species trees using concatenation and using a coalescent-based method [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. We use the set of all unbinned gene trees and compare ASTRAL-III with and without contraction against both reference trees.</p>
        </sec>
        <sec id="Sec18">
          <title>Simulated avian-like dataset:</title>
          <p>This simulated dataset, previously used to emulate the biological avian dataset [<xref ref-type="bibr" rid="CR33">33</xref>], has three model conditions with respect to the simulated levels of ILS: 1X is the default, whereas 0.5X divides each branch length in half (increasing ILS) and 2X multiplies them by 2 (reducing ILS). Average RF distances between true species tree and true gene trees are 0.35, 0.47, and 0.59, respectively for 2X, 1X, and 0.5X. To further test the impact of gene tree estimation error, sequence lengths were also varied to create four model conditions: 250bp alignments (0.67 RF distance between true gene trees and estimated gene trees), 500bp (0.54 RF), 1000bp (0.39 RF) and 1500bp (0.30 RF), all based on the 1X ILS. We use 1000 gene trees, and 20 replicates per condition. Gene trees are estimated using RAxML [<xref ref-type="bibr" rid="CR41">41</xref>] with 200 replicates of bootstrapping.</p>
        </sec>
        <sec id="Sec19">
          <title>SimPhy-homogeneous (S100):</title>
          <p>We simulated a new 101-taxon dataset using SimPhy [<xref ref-type="bibr" rid="CR42">42</xref>] with 50 replicates, each with a different species tree. The species trees are simulated under the birth-only process with birth rate 10<sup>−7</sup>, fixed haploid <italic>N</italic><sub><italic>e</italic></sub> of 400K, and the number of generations sampled from a log-normal distribution with mean 2.5M. For each replicate, 1000 true gene trees are simulated under the MSCM (exact commands shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix C and parameters given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). The average normalized RF distance between true species trees and true gene trees was in most replicates in the <inline-formula id="IEq36"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left [0.3,0.6\right ]$\end{document}</tex-math><mml:math id="M98"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq36.gif"/></alternatives></inline-formula> range, with an average of 0.46 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We use Indelible [<xref ref-type="bibr" rid="CR43">43</xref>] to simulate the nucleotide sequences along the gene trees using the GTR evolutionary model [<xref ref-type="bibr" rid="CR44">44</xref>] with 4 different fixed sequence lengths: 1600, 800, 400, and 200bp. We then use FastTree2 [<xref ref-type="bibr" rid="CR32">32</xref>] to estimate both ML and 100 bootstrapped gene trees under the GTR+ <italic>Γ</italic> (requiring more than two million runs in total). Gene tree estimation error, measured by the FN rate between the true gene trees and the estimated gene trees, depended on the sequence length as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (0.55, 0.42, 0.31, and 0.23 on average for 200bp, 400bp, 800bp, and 1600bp, respectively). We sample 1000, 500, 200, or 50 genes to generate datasets with varying numbers of gene trees.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Properties of the S100 dataset. <bold>a</bold> The density plot of the amount of true gene discordance measured by the FN rate between the true species tree and the true gene trees. <bold>b</bold> The density plot of gene tree estimation error measured by FN rate between true gene trees and estimated gene trees for different sets of sequence lengths</p></caption><graphic xlink:href="12859_2018_2129_Fig1_HTML" id="MO1"/></fig></p>
        </sec>
        <sec id="Sec20">
          <title>SimPhy-ASTRAL2 (S200):</title>
          <p>This dataset (201 taxa) is from the ASTRAL-II paper [<xref ref-type="bibr" rid="CR22">22</xref>]. We use its most challenging model conditions with max tree height set to 500K generations and two rates of speciation: 10<sup>−6</sup> and 10<sup>−7</sup> (respectively, recent and deep speciation events). Compared to S100, this dataset has a much higher level of ILS. This was the only case in the ASTRAL-II paper where enlarging <italic>X</italic> substantially impacted accuracy [<xref ref-type="bibr" rid="CR22">22</xref>]. We use S200 to test if our changes to <italic>X</italic> have compromised the accuracy. Like S100, gene alignments have varying lengths and mutation rates, leading to a wide range of gene tree error [<xref ref-type="bibr" rid="CR22">22</xref>]. We analyze the data using 1000, 200, or 50 genes, and each model condition has 50 replicates; following the original paper, three replicates with low signal are removed.</p>
        </sec>
      </sec>
      <sec id="Sec21">
        <title>Methods and Evaluation</title>
        <p>We compare ASTRAL-III (version 5.5.4) to ASTRAL-II (version 4.11.1) in terms of running time and accuracy. To address RQ1, we draw bootstrap support values on the ML gene trees and then contract branches with bootstrap support up to a threshold (0, 3, 5, 7, 10, 20, 33, 50, and 75%,) using the newick utility package [<xref ref-type="bibr" rid="CR45">45</xref>]. Together with the original gene trees, we have 10 different versions of ASTRAL-III.</p>
        <p>To measure the accuracy of estimated species trees, we use False Negative (FN) rate. Note that in all our species tree comparisons, FN rate is equivalent to normalized Robinson–Foulds (RF) [<xref ref-type="bibr" rid="CR46">46</xref>] metric because the ASTRAL species trees are fully resolved. All running times are measured on a cluster with servers with Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz; each run was assigned to a single process, sharing cache and memory with other jobs.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>RQ1: Impact of contracting low support branches on accuracy</title>
      <p>We investigate RQ1 on the two simulated datasets where bootstrapping was feasible (avian and S100) and on the real avian dataset. On S200, due to its size, bootstrapping was not feasible and thus we cannot test RQ1.</p>
      <sec id="Sec23">
        <title>S100</title>
        <p>On this dataset, contracting <italic>very</italic> low support branches in most cases improves the accuracy (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). However, the excessive removal of branches with high, moderate, or occasionally low support degrades the accuracy. Nevertheless, filtering at 10% is always beneficial on average (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). The threshold where contracting starts to become detrimental depends on the condition, especially the number of gene trees and the alignment length, perhaps representing a signal to noise ratio trade-off.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Impact of contraction on the S100 dataset. The FN error of ASTRAL-III species trees is shown on the S100 dataset given <italic>k</italic>= 50, 200, 500, or 1000 genes (<italic>boxes</italic>) run on the original FastTree gene trees (<italic>non</italic>) or gene trees with branches with ≤{0,3,5,7,10,20,33,50}% support contracted (<italic>x-axis</italic>). Average FN error and standard error bars (200 replicates) are shown with the four alignment lengths combined (<italic>black solid line</italic>). average FN error broken down by alignment length (50 replicates) is also shown (<italic>dashed colored lines</italic>)</p></caption><graphic xlink:href="12859_2018_2129_Fig2_HTML" id="MO2"/></fig></p>
        <p>As the number of genes increases, the optimal threshold for contracting also tends to increase. Combining all model conditions, the error continues to drop until a 20% contracting threshold with 1000 genes, whereas no substantial improvement is observed after contracting branches with 5% support for 50 genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Nevertheless, removing branches with 10% or 20% does not increase the error with 50 genes. Perhaps, with few gene trees, removing branches of low support leaves us with very little information left; thus, regardless of whether we contract or not, we don’t get much signal around the most difficult branches. In contrast, when many gene trees are given, perhaps even after removing many branches, still enough gene trees with a resolution around difficult species tree branches are left.</p>
        <p>The alignment length and gene tree error also impact the effect of contraction. For short alignments (200bp) and 1000 genes, contracting branches with up to 10% support reduces the species tree error by 21% (from 8.8% with no contraction to 6.9%). As alignment length grows, benefits of gene tree contraction diminish, so that with 1600bp genes, the reduction in error is merely from 4.1 to 3.7%. This pattern is perhaps expected because, with longer alignments, branch support is expected to increase. Thus, with longer gene alignments and consequently better gene trees with higher support, there is less room for improvement by reducing the noise. Consistent with this explanation, grouping replicates based on average gene tree error gives similar results as grouping by alignment length (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
      </sec>
      <sec id="Sec24">
        <title>avian-like simulations</title>
        <p>On the avian simulated dataset, contracting low support branches helps accuracy marginally, but the extent of impact depends on the model condition (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). With moderate ILS (2X), we see no improvements as a result of contracting low support branches, perhaps because the average error is below 5% even with no contraction, leaving little room for improvements. Increasing ILS, we start to see improvements using contracted gene trees. Removing branches of up to 5% support reduces the error from 13 to 11% with 0.5X, and from 8 to 7% for the 1X condition.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Impact of contraction on the avian simulated dataset. The FN error of ASTRAL-III species trees is shown on the avian simulated dataset given <italic>k</italic>=1000 genes with (<italic>left</italic>) fixed sequence lengths =500 and varying levels of ILS, or (<italic>right</italic>) fixed ILS (1X) and varying sequence length, in each case both with full FastTree gene trees (<italic>non</italic>) or trees with branches with ≤{0,3,5,7,10,20,33,50}% support contracted (<italic>x-axis</italic>). Average and standard error bars are shown for all conditions combined (<italic>black solid line</italic>) and also for each model condition separately (<italic>dashed color lines</italic>). Each model condition has 20 replicates</p></caption><graphic xlink:href="12859_2018_2129_Fig3_HTML" id="MO3"/></fig></p>
        <p>When ILS is fixed to 1X and sequence length is varied (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), contracting is helpful mostly with short sequences (e.g., 250 bp). With longer sequences, where gene tree estimation error is low, little or no improvement in accuracy is obtained. The best accuracy is typically observed by contracting at 0–5%. The gains in accuracy comparing no contraction to contraction at 0, 3, 5% thresholds are statistically significant (<italic>p</italic>=0.017, 0.028, and 0.013) according to one-tailed paired t-tests.</p>
      </sec>
      <sec id="Sec25">
        <title>Avian biological dataset</title>
        <p>The original analyses on this dataset [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR33">33</xref>] report that MP-EST [<xref ref-type="bibr" rid="CR17">17</xref>] run on 14,446 gene trees produces a tree that conflicts with strong evidence from the literature and other analyses on the same dataset. The statistical binning method was developed to address this shortcoming by combining loci together to reduce gene tree error [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. MP-EST run on binned gene trees (i.e., binned MP-EST) produced results [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR33">33</xref>] that were largely congruent with the concatenation using ExaML [<xref ref-type="bibr" rid="CR47">47</xref>] and differed in only five branches with low support (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">a</xref>, <xref rid="Fig4" ref-type="fig">b</xref>); both trees were used as the reference [<xref ref-type="bibr" rid="CR5">5</xref>]. Here, we test if simply contracting low support gene tree branches and using ASTRAL-III produces trees congruent with the reference trees.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Avian dataset with 14,446 genes. Shown are reference trees from the original paper [<xref ref-type="bibr" rid="CR5">5</xref>] using the coalescent-based binning (<bold>a</bold>) and concatenation (<bold>b</bold>), and two new trees using ASTRAL-III with no contraction (<bold>c</bold>) and with contraction with 3, 5, and 10% thresholds (<bold>d</bold>). Support values (bootstrap for <bold>a</bold>, <bold>b</bold> and local posterior probability for <bold>c</bold>, <bold>d</bold>) shown for all branches except those with full support; in (<bold>d</bold>), support is shown for 3, 5, and 10%, respectively. Branches conflicting with the reference coalescent-based tree are shown as dotted red lines</p></caption><graphic xlink:href="12859_2018_2129_Fig4_HTML" id="MO4"/></fig></p>
        <p>Similar to MP-EST, when ATRAL-III is run on 14,446 gene trees with no contraction, the results differ in nine and 11 branches, respectively, with respect to the reference binned MP-EST and concatenation trees (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">c</xref>). Moreover, this tree contradicts some strong results from the avian analyses (e.g., not recovering the Columbea group [<xref ref-type="bibr" rid="CR5">5</xref>]). ASTRAL-III with no contraction finishes in 32 hours, but with contraction, depending on the threshold, it takes 3 to 84 h (&gt;50 h for 0 – 20% thresholds and &lt;26 hours for 33 – 75%). Contracting 0% branches has minimal impact on the discordance (eight discordant branches with binned MP-EST instead of nine). However, contracting low support branches with 3–33% thresholds dramatically reduces the discordance with the reference tree (2, 2, 4, 2, 3, and 3 discordant branches, respectively, for 3, 5, 7, 10, 20, and 33%). Three thresholds (3, 5, and 10%) produce an identical tree (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">d</xref>). The remaining differences are among the branches that are deemed unresolved by Jarvis <italic>et al.</italic> and change among the reference trees as well [<xref ref-type="bibr" rid="CR5">5</xref>]. Contracting at 50 and 75% thresholds, however, increases discordance to five and six branches, respectively.</p>
        <p>Thus, consistent with simulations, contracting very low support branches seems to produce the best results, when judged by similarity with the reference trees. To summarize, ASTRAL-III obtained on unbinned but collapsed gene trees agreed with all major relations in Jarvis et al., including the novel Columbea group, whereas the unresolved tree missed important clades (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>RQ2: Running time improvements</title>
      <sec id="Sec27">
        <title>Varying the number of genes (<italic>k</italic>)</title>
        <p>We compare ASTRAL-III to ASTRAL-II on the avian simulated dataset, changing the number of genes from 2<sup>8</sup> to 2<sup>14</sup> and forcing <italic>X</italic> to be the same for both versions to enable comparing impacts of improved weight calculation (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). We allow each replicate run to take up to two days. ASTRAL-III improves the running time over ASTRAL-II and the extent of the improvement depends on <italic>k</italic> (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). With 1000 genes or more, there is at least a 2.1X improvement. With 2<sup>13</sup> genes, the largest value where both versions could run, ASTRAL-III finishes on average 3.2 times faster than ASTRAL-II (234 versus 758 minutes). ASTRAL-II is not able to finish on the dataset with <italic>k</italic>=2<sup>14</sup>, while ASTRAL-III finishes on all conditions. Moreover, fitting a line to the average running time in the log-log scale graph reveals that on this dataset, the running time of ASTRAL-III on average grows as <italic>O</italic>(<italic>k</italic><sup>2.08</sup>), which is better than that of ASTRAL-II at <italic>O</italic>(<italic>k</italic><sup>2.28</sup>), and both are better than the theoretical worst case, which is <italic>O</italic>(<italic>k</italic><sup>2.726</sup>). These results are consistent with the fact that ASTRAL-III considers similarities between gene tree nodes.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Running time versus <italic>k</italic>. Average running times (4 replicates) are shown for ASTRAL-II and ASTRAL-III on the avian dataset with 500bp or 1500bp alignments with varying numbers of gens (<italic>k</italic>), shown in log scale (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 for normal scale). A line is fit to the data points in the log/log space and line slopes are shown. ASTRAL-II did not finish on 2<sup>14</sup> genes in 48 hours</p></caption><graphic xlink:href="12859_2018_2129_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec28">
        <title>Running time for large polytomies</title>
        <p>ASTRAL-III has a clear advantage compared to ASTRAL-II with respect to the running time when gene trees include polytomies (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">a</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Since ASTRAL-II and ASTRAL-III can have a different set <italic>X</italic>, we show the running time per each weight calculation (i.e., Eq. <xref rid="Equ3" ref-type="">3</xref>). As we contract low support branches and hence increase the prevalence of polytomies, the weight calculation time quickly grows for ASTRAL-II, whereas, in ASTRAL-III, the weight calculation time remains flat, or even decreases. These results are consistent with a change of asymptotic running time to score a polytomy of size <italic>d</italic> from <italic>O</italic>(<italic>d</italic><sup>3</sup>) in ASTRAL-II to <italic>O</italic>(<italic>d</italic>) in ASTRAL-III.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Weight calculation and |<italic>X</italic>| on S100. Average and standard error of (<bold>a</bold>) the time it takes to score a single tripartition using Eq. <xref rid="Equ3" ref-type="">3</xref> and (<bold>b</bold>) search space size |<italic>X</italic>| are shown for both ASTRAL-II and ASTRAL-III on the S100 dataset. Running time is in log scale. We vary numbers of gene trees (<italic>boxes</italic>) and sequence length (200 and 1600). See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 for similar patterns for with 400 and 800bp alignments</p></caption><graphic xlink:href="12859_2018_2129_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
      <sec id="Sec29">
        <title>The search space</title>
        <p>Comparing the size of the search space (|<italic>X</italic>|) between ATRAL-II and ASTRAL-III shows that as intended, the search space is decreased in size for cases with no polytomy but can increase in the presence of polytomies (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">b</xref>). With no contraction, on average, |<italic>X</italic>| is always smaller for ASTRAL-III than ASTRAL-II. With few error-prone gene trees (50 gene trees from 200bp alignments), the search space has reduced dramatically but with many genes or high-quality gene trees, the reductions are minimal. Moreover, the search space for gene trees estimated from short alignments (e.g., 200 bp) is several times larger than those based on longer alignments (e.g., 1600 bp) for both methods. These are results of the first feature of ASTRAL-III that forces the search space to grow at <italic>O</italic>(<italic>nk</italic>).</p>
        <p>Contracting low support branches initially increases the search space. This is because ASTRAL-III unlike ASTRAL-II adds multiple resolutions per polytomy to <italic>X</italic>. Further contraction results in reductions in |<italic>X</italic>|, presumably because many polytomies exist and they are resolved similarly inside ASTRAL-III.</p>
      </sec>
    </sec>
    <sec id="Sec30">
      <title>RQ3: ASTRAL-II versus ASTRAL-III accuracy</title>
      <p>Despite limiting |<italic>X</italic>| to grow at most linearly with <italic>n</italic> and <italic>k</italic>, the accuracy of ASTRAL-III remains unchanged compared to ASTRAL-II (Table <xref rid="Tab1" ref-type="table">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4–S7). Importantly, even for the very challenging S200 dataset, the accuracy is not reduced substantially even though |<italic>X</italic>| is reduced by up to 47%. Over all datasets, differences in error are less than 0.002, except for three datasets where the error of ASTRAL-III was less than ASTRAL-II by 0.003, 0.005, and 0.006 and two cases where the error increased by 0.004. Over all datasets, the differences between ASTRAL-II and ASTRAL-III were not statistically significant according to a paired t-test (<italic>p</italic>-value = 0.496). Since ASTRAL-III has a reduced search space, its quartet scores are typically slightly lower than ASTRAL-II, but these reductions are never more than 0.06%. As expected, the largest drops in the quartet score happen for the challenging S200 dataset with only 50 gene trees. The search space reduces in almost all cases and the reductions can be as much as 72%. Thus, the improved running time of ASTRAL-III does not come at the price of reduced accuracy.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>ASTRAL-II versus ASTRAL-III. Average and standard error (inside parenthesis) are shown for changes in accuracy (normalized FN rate), quartet score, and search space size (|<italic>X</italic>|)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data set</th><th align="left">Model condition</th><th align="left">FN</th><th align="left">|<italic>X</italic>|</th><th align="left">Quartet score</th></tr></thead><tbody><tr><td align="left">avian</td><td align="left">0.5X-500bp</td><td align="left">−0.006 (0.007)</td><td align="left">−3% (0)</td><td align="left">−0.01% (0.01)</td></tr><tr><td align="left"/><td align="left">1X-1000bp</td><td align="left">0.001 (0.002)</td><td align="left">−1% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">1X-1500bp</td><td align="left">0.004 (0.003)</td><td align="left">−1% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">1X-250bp</td><td align="left">0.004 (0.007)</td><td align="left">−3% (0)</td><td align="left">−0.01% (0.00)</td></tr><tr><td align="left"/><td align="left">1X-500bp</td><td align="left">−0.001 (0.004)</td><td align="left">−2% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">2X-500bp</td><td align="left">−0.003 (0.003)</td><td align="left">−2% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left">S200</td><td align="left">1000gt- 10<sup>−6</sup></td><td align="left">−0.001 (0.000)</td><td align="left">0% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">200gt- 10<sup>−6</sup></td><td align="left">0.000 (0.001)</td><td align="left">−5% (1)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">50gt- 10<sup>−6</sup></td><td align="left">−0.001 (0.001)</td><td align="left">−42% (2)</td><td align="left">−0.06% (0.01)</td></tr><tr><td align="left"/><td align="left">1000gt- 10<sup>−7</sup></td><td align="left">0.001 (0.001)</td><td align="left">−1% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">200gt- 10<sup>−7</sup></td><td align="left">−0.001 (0.001)</td><td align="left">−6% (1)</td><td align="left">0.00% (0.01)</td></tr><tr><td align="left"/><td align="left">50gt- 10<sup>−7</sup></td><td align="left">0.000 (0.002)</td><td align="left">−47% (2)</td><td align="left">−0.06% (0.01)</td></tr><tr><td align="left">S100</td><td align="left">1000gt-1600bp</td><td align="left">0.000 (0.000)</td><td align="left">−3% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">500gt-1600bp</td><td align="left">0.000 (0.000)</td><td align="left">−6% (1)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">200gt-1600bp</td><td align="left">0.000 (0.001)</td><td align="left">−17% (1)</td><td align="left">−0.01% (0.00)</td></tr><tr><td align="left"/><td align="left">50gt-1600bp</td><td align="left">−0.001 (0.001)</td><td align="left">−46% (3)</td><td align="left">−0.01% (0.01)</td></tr><tr><td align="left"/><td align="left">1000gt-200bp</td><td align="left">−0.001 (0.002)</td><td align="left">−9% (1)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">500gt-200bp</td><td align="left">−0.001 (0.001)</td><td align="left">−19% (1)</td><td align="left">−0.01% (0.01)</td></tr><tr><td align="left"/><td align="left">200gt-200bp</td><td align="left">−0.001 (0.001)</td><td align="left">−40% (1)</td><td align="left">−0.01% (0.00)</td></tr><tr><td align="left"/><td align="left">50gt-200bp</td><td align="left">−0.002 (0.002)</td><td align="left">−72% (1)</td><td align="left">−0.05% (0.01)</td></tr><tr><td align="left"/><td align="left">1000gt-400bp</td><td align="left">−0.001 (0.002)</td><td align="left">−6% (1)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">500gt-400bp</td><td align="left">0.001 (0.001)</td><td align="left">−12% (1)</td><td align="left">−0.01% (0.00)</td></tr><tr><td align="left"/><td align="left">200gt-400bp</td><td align="left">0.000 (0.001)</td><td align="left">−29% (2)</td><td align="left">−0.01% (0.01)</td></tr><tr><td align="left"/><td align="left">50gt-400bp</td><td align="left">−0.005 (0.001)</td><td align="left">−61% (2)</td><td align="left">−0.02% (0.01)</td></tr><tr><td align="left"/><td align="left">1000gt-800bp</td><td align="left">0.000 (0.000)</td><td align="left">−4% (0)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">500gt-800bp</td><td align="left">0.001 (0.001)</td><td align="left">−9% (1)</td><td align="left">0.00% (0.00)</td></tr><tr><td align="left"/><td align="left">200gt-800bp</td><td align="left">0.001 (0.000)</td><td align="left">−22% (2)</td><td align="left">−0.01% (0.01)</td></tr><tr><td align="left"/><td align="left">50gt-800bp</td><td align="left">0.000 (0.001)</td><td align="left">−52% (3)</td><td align="left">−0.02% (0.01)</td></tr></tbody></table><table-wrap-foot><p>FN: we show ASTRALIII−ASTRALII; negative numbers indicate ASTRALIII is more accurate. |<italic>X</italic>|: we show <inline-formula id="IEq37"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {\text {ASTRALIII}-\text {ASTRALII}}{\text {ASTRALII}}\times 100$\end{document}</tex-math><mml:math id="M100"><mml:mfrac><mml:mrow><mml:mtext>ASTRALIII</mml:mtext><mml:mo>−</mml:mo><mml:mtext>ASTRALII</mml:mtext></mml:mrow><mml:mrow><mml:mtext>ASTRALII</mml:mtext></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq37.gif"/></alternatives></inline-formula>; negative numbers indicate that ASTRAL-III has a reduced search space. Quartet score: we show <inline-formula id="IEq38"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {\text {ASTRALIII}-\text {ASTRALII}}{\text {ASTRALII}}\times 100$\end{document}</tex-math><mml:math id="M102"><mml:mfrac><mml:mrow><mml:mtext>ASTRALIII</mml:mtext><mml:mo>−</mml:mo><mml:mtext>ASTRALII</mml:mtext></mml:mrow><mml:mrow><mml:mtext>ASTRALII</mml:mtext></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq38.gif"/></alternatives></inline-formula>; positive numbers indicate that ASTRALIII has improved quartet scores. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4–S7 for full distributions</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec31" sec-type="discussion">
    <title>Discussion</title>
    <p>Below we further comment on ASTRAL-III in terms of accuracy and running time. We finish by comparing ASTRAL-III and ASTRAL-III-beta.</p>
    <sec id="Sec32">
      <title>Accuracy</title>
      <p>Although tree accuracy can improve with contracted gene trees, the gap between performance on true gene trees and estimated gene trees remains wide (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). On the S100 dataset, respectively for 50, 200, 500, and 1000 genes, the best average error with 1600bp gene trees among all contraction levels were 9.8%, 5.9%, 4.3%, and 3.7% compared to 7.0%, 3.7%, 2.4%, and 1.5% with true gene trees. Thus, while contracting low support branches helps in addressing gene tree error, improved methods of gene tree estimation remain crucial. Our results also indicate that in the presence of noisy gene trees, increased numbers of genes are needed to achieve high accuracy. For example, on the S100 dataset, with 1000 gene trees of only 200bp and contracting with a 10% threshold, the species tree error was 6.9%, which slightly outperformed the accuracy with only 50 true gene trees. This observation encourages the use of a large number of gene trees; incidentally, a main feature of ASTRAL-III is improved running time with many genes.</p>
      <p>The best choice of the threshold of contraction was somewhat sensitive to the dataset. Testing up to 1000 gene trees, we observed that more gene trees clearly increased the optimal threshold, but did not test beyond 1000 genes. One can predict that perhaps the trend may continue but also that the optimal threshold will not indefinitely increase. Similarly, we saw that the amount of gene tree error due to lack of signal impacts the optimal threshold. One may expect that other sources of error, including incorrect orthology, incorrect alignment, and model misspecifications may also impact the optimal threshold. Regardless of the choice of the optimal threshold, it seems that the largest benefits are associated with removing the least supported branches. Overall, a threshold of 10% seemed to provide a good default value.</p>
      <p>In most datasets, a substantial accuracy improvement was observed when 0% BS branches were removed. Branches of 0% support are presumably resolved arbitrarily. The use of conserved genes or closely related taxa can increase instances where two or more taxa have identical sequences in some genes. Some tree estimation methods generate binary trees even under such conditions. Removing branches that are arbitrarily resolved make sense and, as our results indicate, improves accuracy.</p>
      <p>The main competitor of ASTRAL is NJst [<xref ref-type="bibr" rid="CR18">18</xref>] and its fast implementation, ASTRID [<xref ref-type="bibr" rid="CR19">19</xref>], but these tools are not able to handle polytomies in input gene trees. ASTRAL-III makes it efficient to use unresolved gene trees. Moreover, beyond contracting low support branches, other strategies could be used to reduce impacts of gene tree uncertainty. Previous studies indicate that simply using the set of all bootstrap gene tree replicates as input to ASTRAL increases error [<xref ref-type="bibr" rid="CR21">21</xref>], perhaps due to the increased noise [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. However, using a sample from the Bayesian distribution for each gene tree may improve the accuracy of ASTRAL.</p>
      <p>Finally, theoretical implications of removing low support branches are less clear than its empirical impact. In principle, branches that have low support are not necessarily expected to be randomly selected among gene trees. Thus, while our empirical results support the use of (conservative) filtering, the resulting procedure may lose statistical guarantees of consistency. Future work should study conditions where ASTRAL remains statistically consistent with contracted gene trees.</p>
    </sec>
    <sec id="Sec33">
      <title>Running time</title>
      <sec id="Sec34">
        <title>Large <italic>n</italic></title>
        <p>To assess limits of ASTRAL-III in terms of scalability, we tested it on 20 replicates of a dataset with 5,000 species and 1000 true gene trees (simulation procedure described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix C and parameters given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). ASTRAL-III took between 2 and 62 h to run on this dataset (9.4 hours on average). We also attempted to test ASTRAL-III on four replicates of a dataset with 10,000 species and 1000 true gene trees, allowing a week of running time. Of the four replicates, two were able to finish within the allotted time. Thus, depending on the nature of the data, ASTRAL-III may be able to scale to datasets with up to 10,000 species given sufficient running time.</p>
      </sec>
      <sec id="Sec35">
        <title>Average running time, |<italic>X</italic>|, and |<italic>Y</italic>|</title>
        <p>The ASTRAL-III running time analysis is based on several worst-case assumptions, and real data may grow less rapidly with both <italic>n</italic> and <italic>k</italic>. Overall, although the exact value depends on the dataset and especially the amount of discordance, the running time of ASTRAL seems to grow roughly quadratically with both <italic>n</italic> and <italic>k</italic> (i.e., proportionally to <italic>n</italic><sup>2</sup><italic>k</italic><sup>2</sup>); see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S2 and S8.</p>
        <p>ASTRAL-III bounds |<italic>X</italic>| to grow at most linearly with <italic>n</italic> and <italic>k</italic>. Empirically, we observe that |<italic>X</italic>| grows sublinearly with <italic>k</italic><inline-formula id="IEq39"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\mathrm {close to} O\left (k^{\frac {3}{4}}\right)\right)$\end{document}</tex-math><mml:math id="M104"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">closeto</mml:mi><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq39.gif"/></alternatives></inline-formula> on the avian simulated dataset (Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">a</xref>). Note that the avian dataset has one of the highest levels of ILS; the dependence on <italic>k</italic> is expected to be lower for datasets with lower gene tree discordance. Testing the growth with <italic>n</italic> is more difficult because as <italic>n</italic> changes, other factors such as the amount of discordance also change. Nevertheless, across all the datasets that we had available, we tested the change in running time for fixed <italic>k</italic> as <italic>n</italic> changes and observed a linear growth (Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">b</xref>), matching the worst-case scenario.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Empirical search space. <bold>a</bold> |<italic>X</italic>| is shown for ASTRAL-II and ASTRAL-III for avian-like simulateds dataset with varying numbers of genes. <bold>b</bold> |<italic>X</italic>| is shown for ASTRAL-III for several datasets with varying <italic>n</italic>. <bold>c</bold> The density plots of <inline-formula id="IEq40"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log _{X} |Y|$\end{document}</tex-math><mml:math id="M106"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq40.gif"/></alternatives></inline-formula> across all ASTRAL-III runs reported in this paper. Size of the dynamic programming space <italic>Y</italic> is never above |<italic>X</italic>|<sup>1.312</sup> here</p></caption><graphic xlink:href="12859_2018_2129_Fig7_HTML" id="MO7"/></fig></p>
        <p>Finally, establishing empirical running time growth requires establishing the rate of the growth of |<italic>Y</italic>| with respect to |<italic>X</italic>|. The |<italic>Y</italic>|≤|<italic>X</italic>|<sup>1.726</sup> upper-bound is for specialized formations of the set <italic>X</italic> [<xref ref-type="bibr" rid="CR28">28</xref>]. Empirically, as |<italic>X</italic>| increases, the size of |<italic>Y</italic>| in ASTRAL-III does not increase as fast as the worst-case scenario implies. Across all of our ASTRAL-III runs in this paper, |<italic>Y</italic>| ranged in 90% of our runs between |<italic>X</italic>|<sup>1.07</sup> and |<italic>X</italic>|<sup>1.20</sup>, and the overall average was |<italic>X</italic>|<sup>1.11</sup> (Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">c</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec36">
      <title>Comparisons to ASTRAL-III-beta</title>
      <p>The beta version of ASTRAL-III [<xref ref-type="bibr" rid="CR40">40</xref>] included features 3–5 but not changes to <italic>X</italic> (features 1 and 2) or the two-staged <italic>α</italic>-trimming technique (feature 6). For completeness, we compared ASTRAL-III-beta and ASTRAL-III in terms of accuracy, quartet score, and the running time (Table <xref rid="Tab2" ref-type="table">2</xref>). Accuracy and quartet scores are very similar, perhaps with a small improvement since the beta version. The search space is reduced since the beta version (due to features 1 and 2), and the running times are substantially decreased (at least by half in most cases). The reductions in the running time are due to <italic>α</italic>-trimming, reduced |<italic>X</italic>|, in addition to further improvements in details of our implementation of the polytree data-structure.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>ASTRAL-III-beta vs ASTRAL-III. Columns are defined similar to Table <xref rid="Tab1" ref-type="table">1</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Contraction</th><th align="left">FN</th><th align="left">|<italic>X</italic>|</th><th align="left">|<italic>Y</italic>|</th><th align="left">Quartet</th><th align="left">Running</th></tr><tr><th align="left">condition</th><th align="left"/><th align="left"/><th align="left"/><th align="left"/><th align="left">score</th><th align="left">time</th></tr></thead><tbody><tr><td align="left">avian-0.5X-500bp</td><td align="left">None</td><td align="left">−0.003</td><td align="left">−3%</td><td align="left">−9%</td><td align="left">−0.02%</td><td align="left">−48%</td></tr><tr><td align="left">avian-1X-250bp</td><td align="left">None</td><td align="left">−0.001</td><td align="left">−3%</td><td align="left">−9%</td><td align="left">0.00%</td><td align="left">−56%</td></tr><tr><td align="left">avian-1X-500bp</td><td align="left">None</td><td align="left">−0.001</td><td align="left">−2%</td><td align="left">−6%</td><td align="left">0.00%</td><td align="left">−50%</td></tr><tr><td align="left">avian-1X-1000bp</td><td align="left">None</td><td align="left">−0.001</td><td align="left">−1%</td><td align="left">−4%</td><td align="left">0.00%</td><td align="left">−58%</td></tr><tr><td align="left">avian-1X-1500bp</td><td align="left">None</td><td align="left">0.001</td><td align="left">−1%</td><td align="left">−4%</td><td align="left">0.00%</td><td align="left">−57%</td></tr><tr><td align="left">avian-2X-500bp</td><td align="left">None</td><td align="left">−0.002</td><td align="left">−2%</td><td align="left">−4%</td><td align="left">0.00%</td><td align="left">−65%</td></tr><tr><td align="left">avian-0.5X-500bp</td><td align="left">10%</td><td align="left">−0.003</td><td align="left">−3%</td><td align="left">−29%</td><td align="left">−0.01%</td><td align="left">−69%</td></tr><tr><td align="left">avian-1X-250bp</td><td align="left">10%</td><td align="left">−0.001</td><td align="left">−50%</td><td align="left">−40%</td><td align="left">0.00%</td><td align="left">−81%</td></tr><tr><td align="left">avian-1X-500bp</td><td align="left">10%</td><td align="left">0.003</td><td align="left">−18%</td><td align="left">−62%</td><td align="left">−0.01%</td><td align="left">−62%</td></tr><tr><td align="left">avian-1X-1000bp</td><td align="left">10%</td><td align="left">0.000</td><td align="left">−5%</td><td align="left">−8%</td><td align="left">0.00%</td><td align="left">−61%</td></tr><tr><td align="left">avian-1X-1500bp</td><td align="left">10%</td><td align="left">0.003</td><td align="left">0%</td><td align="left">−1%</td><td align="left">0.00%</td><td align="left">−55%</td></tr><tr><td align="left">avian-2X-500bp</td><td align="left">10%</td><td align="left">−0.002</td><td align="left">−14%</td><td align="left">−18%</td><td align="left">0.00%</td><td align="left">−62%</td></tr></tbody></table><table-wrap-foot><p>Negative numbers indicate ASTRAL-III-beta has a larger value (i.e., has higher error, larger search space, better quartet scores, and is slower)</p></table-wrap-foot></table-wrap></p>
      <p>To further demonstrate the impact of the <italic>α</italic>-trimming feature, we randomly chose 18 species from the avian dataset with 1500bp and 1X ILS. On this limited dataset, we ran ASTRAL-III in its exact mode (i.e., setting <italic>X</italic> to the power set) with 100 gene trees. Without any trimming of the dynamic programming (i.e., without features 5 and 6), the running time was 40 minutes. Emulating ASTRAL-III-beta, we disabled <italic>α</italic>-trimming but kept the trimming (feature 5) and the running time reduced to 33 min. Adding the <italic>α</italic>-trimming feature dramatically reduced the running time to 13 min. Thus, when <italic>X</italic> includes many bipartitions that have very little promise in improving the quartet score (as in the exact mode of ASTRAL), the <italic>α</italic>-trimming approach is very effective in reducing the running time.</p>
    </sec>
  </sec>
  <sec id="Sec37" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We introduced ASTRAL-III, which compared to ASTRAL-II, improves scalability, especially for datasets with large <italic>k</italic> and many polytomies. These improvements enabled us to test the accuracy of ASTRAL after contracting low support branches. Overall, we observed improvements in accuracy when very low support branches were contracted, but also evidence that aggressive filtering reduces the accuracy. ASTRAL-III bounds the theoretical running time to <inline-formula id="IEq41"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left ((nk)^{{1.726}}.D\right)$\end{document}</tex-math><mml:math id="M108"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">nk</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup><mml:mi>.D</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2129_Article_IEq41.gif"/></alternatives></inline-formula> where <italic>D</italic>=<italic>O</italic>(<italic>nk</italic>) is the sum of degrees of all unique gene tree nodes. In practice, the running time tends to grow no worse than quadratically with both <italic>n</italic> and <italic>k</italic>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec38">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2129_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary material and appendices. Appendices A, B, and C in addition to <bold>Figures S1–S8</bold>, and <bold>Tables S1–S4</bold> are all provided as one Additional file <xref rid="MOESM1" ref-type="media">1</xref>. (PDF 476 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>From RECOMB-CG - 2017: The Fifteenth RECOMB Comparative Genomics Satellite Conference Barcelona, Spain. 04-06 October 2017</p>
    </fn>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s12859-018-2129-y) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Authors thank anonymous reviewers.</p>
    <sec id="d29e6773">
      <title>Funding</title>
      <p>This work was supported by the National Science Foundation grant IIS-1565862 to SM, MHR, and ES. Computations were performed on the San Diego Supercomputer Center (SDSC) through XSEDE allocations, which is supported by the NSF grant ACI-1053575. The publication cost of this article was funded by the NSF grant IIS-1565862.</p>
    </sec>
    <sec id="d29e6778">
      <title>Availability of data and materials</title>
      <p>ASTRAL-III is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/smirarab/ASTRAL">https://github.com/smirarab/ASTRAL</ext-link>. The data presented in this paper can be found at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/esayyari/ASTRALIII.">https://gitlab.com/esayyari/ASTRALIII.</ext-link></p>
    </sec>
    <sec id="d29e6792">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics</italic> Volume 19 Supplement 6, 2018: Proceedings of the 15th Annual Research in Computational Molecular Biology (RECOMB) Comparative Genomics Satellite Workshop: bioinformatics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-19-supplement-6">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-19-supplement-6</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CZ, MHR, and SM designed the algorithms and CZ and MHR implemented them. SM, ES, and CZ designed the experiments and all authors contributed to running experiments and analyzing the data. All authors contributed to the writing. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e6811">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e6816">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e6821">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e6826">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Gene trees in species trees</article-title>
        <source>Syst Biol</source>
        <year>1997</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>523</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/46.3.523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title>
        <source>Trends Ecol Evol</source>
        <year>2009</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>332</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2009.01.009</pub-id>
        <?supplied-pmid 19307040?>
        <pub-id pub-id-type="pmid">19307040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Resolving conflict in eutherian mammal phylogeny using phylogenomics and the multispecies coalescent model</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>37</issue>
        <fpage>14942</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1211733109</pub-id>
        <?supplied-pmid 22930817?>
        <pub-id pub-id-type="pmid">22930817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickett</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Matasci</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ayyampalayam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Gitzendanner</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ruhfel</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Wafula</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Der</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Melkonian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Soltis</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Soltis</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Miles</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Rothfels</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Pokorny</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>DeGironimo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stevenson</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Surek</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Villarreal</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Roure</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>DePamphilis</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Deyholos</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Baucom</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Kutchan</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Augustin</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>GK-S</given-names>
          </name>
          <name>
            <surname>Leebens-Mack</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Phylotranscriptomic analysis of the origin and early diversification of land plants</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>45</issue>
        <fpage>4859</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1323926111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aberer</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Houde</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SYW</given-names>
          </name>
          <name>
            <surname>Faircloth</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Nabholz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>da Fonseca</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Narula</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ganapathy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Zavidovych</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Capella-Gutiérrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rekepalli</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Munch</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lindow</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Bruford</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Derryberry</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Bertelsen</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Sheldon</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Brumfield</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Mello</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Lovell</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Wirthlin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>MPC</given-names>
          </name>
          <name>
            <surname>Prosdocimi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Samaniego</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Velazquez</surname>
            <given-names>AMV</given-names>
          </name>
          <name>
            <surname>Alfaro-Núñez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Campos</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sicheritz-Ponten</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Scofield</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bunce</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Perelman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Driskell</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yinqi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Smeds</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rheindt</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Fjeldså</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Orlando</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Jønsson</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Koepfli</surname>
            <given-names>K-P</given-names>
          </name>
          <name>
            <surname>O’Brien</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ryder</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Rahbek</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Willerslev</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Graves</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Glenn</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Burt</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Ellegren</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Alström</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mindell</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Cracraft</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jun</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>MTP</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome analyses resolve early branches in the tree of life of modern birds</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6215</issue>
        <fpage>1320</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1253451</pub-id>
        <?supplied-pmid 25504713?>
        <pub-id pub-id-type="pmid">25504713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Laumer CE, Hejnol A, Giribet G. Nuclear genomic signals of the ’microturbellarian’ roots of platyhelminth evolutionary innovation. eLife. 2015;4. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.05503">https://doi.org/10.7554/eLife.05503</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarver</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>dos Reis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>O’Reilly</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>O’Connell</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Asher</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Donoghue</surname>
            <given-names>PCJ</given-names>
          </name>
          <name>
            <surname>Pisani</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The Interrelationships of Placental Mammals and the Limits of Phylogenetic Inference</article-title>
        <source>Genome Biol Evol</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>330</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evv261</pub-id>
        <?supplied-pmid 26733575?>
        <pub-id pub-id-type="pmid">26733575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rokas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale approaches to resolving incongruence in molecular phylogenies</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>425</volume>
        <issue>6960</issue>
        <fpage>798</fpage>
        <lpage>804</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02053</pub-id>
        <?supplied-pmid 14574403?>
        <pub-id pub-id-type="pmid">14574403</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Springer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The gene tree delusion</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2016</year>
        <volume>94</volume>
        <issue>Part A</issue>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2015.07.018</pub-id>
        <?supplied-pmid 26238460?>
        <pub-id pub-id-type="pmid">26238460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meiklejohn</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Faircloth</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Glenn</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Kimball</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Analysis of a Rapid Evolutionary Radiation Using Ultraconserved Elements: Evidence for a Bias in Some Multispecies Coalescent Methods</article-title>
        <source>Syst Biol</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>4</issue>
        <fpage>612</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syw014</pub-id>
        <?supplied-pmid 26865273?>
        <pub-id pub-id-type="pmid">26865273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Janke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Faircloth</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Glenn</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Leaché</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Implementing and testing the multispecies coalescent model: A valuable paradigm for phylogenomics</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2016</year>
        <volume>94</volume>
        <fpage>447</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2015.10.027</pub-id>
        <?supplied-pmid 26518740?>
        <pub-id pub-id-type="pmid">26518740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>X-X</given-names>
          </name>
          <name>
            <surname>Hittinger</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Rokas</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Contentious relationships in phylogenomic studies can be driven by a handful of genes</article-title>
        <source>Nat Ecol Evol</source>
        <year>2017</year>
        <volume>1</volume>
        <issue>5</issue>
        <fpage>0126</fpage>
        <pub-id pub-id-type="doi">10.1038/s41559-017-0126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of species trees from multilocus data</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>570</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp274</pub-id>
        <?supplied-pmid 19906793?>
        <pub-id pub-id-type="pmid">19906793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>Is a new and general theory of molecular systematics emerging?</article-title>
        <source>Evolution</source>
        <year>2009</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1558-5646.2008.00549.x</pub-id>
        <?supplied-pmid 19146594?>
        <pub-id pub-id-type="pmid">19146594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pamilo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Relationships between gene trees and species trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1988</year>
        <volume>5</volume>
        <issue>5</issue>
        <fpage>568</fpage>
        <lpage>83</lpage>
        <?supplied-pmid 3193878?>
        <pub-id pub-id-type="pmid">3193878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>164</volume>
        <issue>4</issue>
        <fpage>1645</fpage>
        <lpage>56</lpage>
        <?supplied-pmid 12930768?>
        <pub-id pub-id-type="pmid">12930768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>
        <source>BMC Evol Bioly</source>
        <year>2010</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>302</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-10-302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Estimating species trees from unrooted gene trees</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>661</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syr027</pub-id>
        <?supplied-pmid 21447481?>
        <pub-id pub-id-type="pmid">21447481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vachaspati</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRID: Accurate Species TRees from Internode Distances</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>Suppl 10</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S10-S3</pub-id>
        <pub-id pub-id-type="pmid">25649116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Anchoring quartet-based phylogenetic distances and applications to species tree reconstruction</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>S10</issue>
        <fpage>101</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-016-3098-z</pub-id>
        <pub-id pub-id-type="pmid">26861502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reaz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Swenson</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>541</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL-II: coalescent-based species tree estimation with many hundreds of taxa and thousands of genes</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>44</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pearl</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>Estimating species phylogenies using coalescence times among sequences</article-title>
        <source>Syst Biol</source>
        <year>2009</year>
        <volume>58</volume>
        <issue>5</issue>
        <fpage>468</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syp031</pub-id>
        <?supplied-pmid 20525601?>
        <pub-id pub-id-type="pmid">20525601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mossel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Incomplete lineage sorting: consistent phylogeny estimation from multiple loci</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinformatics (TCBB)</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>166</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2008.66</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>On the robustness to gene tree estimation error (or lack thereof) of coalescent-based species tree methods</article-title>
        <source>Syst Biol</source>
        <year>2015</year>
        <volume>64</volume>
        <issue>4</issue>
        <fpage>663</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv016</pub-id>
        <?supplied-pmid 25813358?>
        <pub-id pub-id-type="pmid">25813358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Lafond M, Scornavacca C. On the Weighted Quartet Consensus problem. arXiv 610.00505. 2016.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rhodes</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Determining species tree topologies from clade probabilities under the coalescent</article-title>
        <source>J Theor Biol</source>
        <year>2011</year>
        <volume>289</volume>
        <issue>1</issue>
        <fpage>96</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2011.08.006</pub-id>
        <?supplied-pmid 21867714?>
        <pub-id pub-id-type="pmid">21867714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kane</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A Bound on Partitioning Clusters</article-title>
        <source>Electr J Comb</source>
        <year>2017</year>
        <volume>24</volume>
        <fpage>P2.31</fpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Species tree estimation using ASTRAL: how many genes are enough?</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2017</year>
        <volume>99</volume>
        <fpage>1</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2017.2757930</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vachaspati</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic species tree estimation in the presence of incomplete lineage sorting and horizontal gene transfer</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>Suppl 10</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S10-S1</pub-id>
        <pub-id pub-id-type="pmid">25553907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast Coalescent-Based Computation of Local Branch Support from Quartet Frequencies</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>7</issue>
        <fpage>1654</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw079</pub-id>
        <?supplied-pmid 27189547?>
        <pub-id pub-id-type="pmid">27189547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree-2 – Approximately Maximum-Likelihood Trees for Large Alignments</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>9490</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Statistical binning enables an accurate coalescent-based estimation of the avian tree</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6215</issue>
        <fpage>1250463</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1250463</pub-id>
        <?supplied-pmid 25504728?>
        <pub-id pub-id-type="pmid">25504728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>M. S</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Weighted statistical binning: enabling statistically consistent genome-scale phylogenetic analyses</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>6</issue>
        <fpage>0129183</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0129183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Evaluating Summary Methods for Multilocus Species Tree Estimation in the Presence of Incomplete Lineage Sorting</article-title>
        <source>Syst Biol</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>366</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syu063</pub-id>
        <?supplied-pmid 25164915?>
        <pub-id pub-id-type="pmid">25164915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Error in phylogenetic estimation for bushes in the tree of life</article-title>
        <source>J Phylogenet Evol Biol</source>
        <year>2013</year>
        <volume>01</volume>
        <issue>02</issue>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.4172/2329-9002.1000110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Springer</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic analysis at deep timescales: unreliable gene trees, bypassed hidden support, and the coalescence/concatalescence conundrum</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2014</year>
        <volume>80</volume>
        <fpage>231</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2014.08.013</pub-id>
        <?supplied-pmid 25152276?>
        <pub-id pub-id-type="pmid">25152276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for MDC-based multi-locus phylogeny inference: beyond rooted binary gene trees on single alleles</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1543</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0174</pub-id>
        <?supplied-pmid 22035329?>
        <pub-id pub-id-type="pmid">22035329</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A formal basis for the heuristic determination of minimum cost paths</article-title>
        <source>IEEE Trans Syst Sci Cybernet</source>
        <year>1968</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>100</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1109/TSSC.1968.300136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Meidanis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL-III: Increased Scalability and Impacts of Contracting Low Support Branches</article-title>
        <source>Lecture Notes in Computer Science. vol. 10562 LNBI</source>
        <year>2017</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML version 8: A tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1312</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id>
        <?supplied-pmid 24451623?>
        <pub-id pub-id-type="pmid">24451623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>De Oliveira Martins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SimPhy : Phylogenomic Simulation of Gene, Locus, and Species Trees</article-title>
        <source>Syst Biol</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>2</issue>
        <fpage>334</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv082</pub-id>
        <?supplied-pmid 26526427?>
        <pub-id pub-id-type="pmid">26526427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: A flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>1879</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id>
        <?supplied-pmid 19423664?>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>
        <source>Lect Math Life Sci</source>
        <year>1986</year>
        <volume>17</volume>
        <fpage>57</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Junier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>The Newick utilities: high-throughput phylogenetic tree processing in the UNIX shell</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>13</issue>
        <fpage>1669</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq243</pub-id>
        <?supplied-pmid 20472542?>
        <pub-id pub-id-type="pmid">20472542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <issue>1-2</issue>
        <fpage>131</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozlov</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Aberer</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>ExaML version 3: a tool for phylogenomic analyses on supercomputers</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>15</issue>
        <fpage>2577</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv184</pub-id>
        <?supplied-pmid 25819675?>
        <pub-id pub-id-type="pmid">25819675</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
