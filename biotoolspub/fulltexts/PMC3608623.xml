<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3608623</article-id>
    <article-id pub-id-type="pmid">23555882</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-24023</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0060055</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic Acids</subject>
            <subj-group>
              <subject>DNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Genetic Polymorphism</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Virology</subject>
            <subj-group>
              <subject>Viral Classification</subject>
              <subject>Viral Disease Diagnosis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Computer Applications</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Design</subject>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Medicine</subject>
        <subj-group>
          <subject>Infectious Diseases</subject>
          <subj-group>
            <subject>Viral Diseases</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MultiPSQ: A Software Solution for the Analysis of Diagnostic n-Plexed Pyrosequencing Reactions</article-title>
      <alt-title alt-title-type="running-head">A Software for n-Plexed Pyrosequencing Reactions</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dabrowski</surname>
          <given-names>Piotr Wojtek</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Schröder</surname>
          <given-names>Kati</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nitsche</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Central Administration 4 (IT), Robert Koch Institute, Berlin, Germany</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Centre for Biological Threats and Special Pathogens 1, Robert Koch Institute, Berlin, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hajibabaei</surname>
          <given-names>Mehrdad</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Guelph, Canada</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>DabrowskiW@rki.de</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: AN KS PWD. Performed the experiments: KS PWD. Analyzed the data: KS PWD. Contributed reagents/materials/analysis tools: AN. Wrote the paper: AN KS PWD.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>3</issue>
    <elocation-id>e60055</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>2</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Dabrowski et al</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Dabrowski et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Pyrosequencing can be applied for Single-Nucleotide-Polymorphism (SNP)-based pathogen typing or for providing sequence information of short DNA stretches. However, for some pathogens molecular typing cannot be performed relying on a single SNP or short sequence stretch, necessitating the consideration of several genomic regions. A promising rapid approach is the simultaneous application of multiple sequencing primers, called multiplex pyrosequencing. These primers generate a fingerprint-pyrogram which is constituted by the sum of all individual pyrograms originating from each primer used.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>To improve pyrosequencing-based pathogen typing, we have developed the software tool MultiPSQ that expedites the analysis and evaluation of multiplex-pyrograms. As a proof of concept, a multiplex pyrosequencing assay for the typing of orthopoxviruses was developed to analyse clinical samples diagnosed in the German Consultant Laboratory for Poxviruses.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The software tool MultiPSQ enabled the analysis of multiplex-pyrograms originating from various pyrosequencing primers. Thus several target regions can be used for pathogen typing based on pyrosequencing. As shown with a proof of concept assay, SNPs present in different orthopoxvirus strains could be identified correctly with two primers by MultiPSQ.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Software currently available is restricted to a fixed number of SNPs and sequencing primers, severely limiting the usefulness of this technique. In contrast, our novel software MultiPSQ allows analysis of data from multiplex pyrosequencing assays that contain any number of sequencing primers covering any number of polymorphisms.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This work was partly supported by the Federal Ministry of Education and Research (BMBF, <ext-link ext-link-type="uri" xlink:href="http://www.bmbf.de/">http://www.bmbf.de/</ext-link>) funded project under the research programme for civil security of the German Federal Government as part of the high-tech strategy for Germany: Potential release-oriented biothreat emergency diagnostics (P.R.O.B.E.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>One sensitive way to diagnose and subtype viral pathogens is usually based on the detection of viral nucleic acids via PCR amplification and subsequent DNA sequencing. For this purpose Sanger sequencing is commonly used to determine the viral species <xref rid="pone.0060055-Sanger1" ref-type="bibr">[1]</xref>. As a novel approach, pyrosequencing is a sequencing-by-synthesis method allowing a fast and reliable detection of single nucleotide polymorphisms (SNP) and sequence variations between different species <xref rid="pone.0060055-Ahmadian1" ref-type="bibr">[2]</xref>–<xref rid="pone.0060055-Ronaghi2" ref-type="bibr">[6]</xref>. The pyrosequencing reaction relies on the indirect detection of pyrophosphate that is released during sequence-specific nucleotide incorporation. Pyrophosphate is converted into discrete light signals proportional to the number of identical nucleotides incorporated. Light signals are detected by a charge-coupled device (CCD) camera and graphed in a so-called pyrogram <xref rid="pone.0060055-Patel1" ref-type="bibr">[7]</xref>.</p>
    <p>In some cases the differentiation of viral types is not possible by detecting only one SNP or by considering only one sequence stretch as the same sequence variation can be found in different species. One approach to circumventing this problem is the use of a pool of type-specific primers <xref rid="pone.0060055-Gharizadeh1" ref-type="bibr">[8]</xref>, <xref rid="pone.0060055-Gharizadeh2" ref-type="bibr">[9]</xref>. Another approach is the detection of multiple sequence variations in one region or in several regions in the same reaction by multiplex pyrosequencing with several sequencing primers <xref rid="pone.0060055-Patel1" ref-type="bibr">[7]</xref>, <xref rid="pone.0060055-Gharizadeh3" ref-type="bibr">[10]</xref>–<xref rid="pone.0060055-Doostzadeh1" ref-type="bibr">[12]</xref>. Here, one or more DNA templates containing relevant sequence variations are amplified by PCR using one biotinylated primer. Biotin-labelled ssDNA strands are separated, followed by hybridization of two or more sequencing primers. During pyrosequencing nucleotides are dispensed in a defined order and incorporated following each primer sequence. Since the signals from these simultaneous sequencing reactions are generated at the same time, they overlap to result in a single pyrogram (<xref ref-type="fig" rid="pone-0060055-g001">Figure 1</xref>). This pyrogram cannot be used directly for sequence analysis as it is unknown from which of the sequencing reactions the respective light signal originates. However, the resulting single pyrogram can be used as a unique fingerprint which is representative of a specific combination of sequences.</p>
    <fig id="pone-0060055-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0060055.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Principle of multiplex pyrosequencing.</title>
        <p>Several sequencing primers are used in a single reaction. The incorporation of nucleotides following each of the primers independently leads to the generation of light signals. These signals overlap in the final pyrogram, resulting in a characteristic fingerprint. Changes in any of the single sequences lead to a change in the fingerprint which allows classification based on SNPs from different regions of a PCR product or even from different PCR products.</p>
      </caption>
      <graphic xlink:href="pone.0060055.g001"/>
    </fig>
    <p>Using software currently commercially available, analysis of multiplex pyrograms is still challenging. Therefore, an in-house software tool called MultiPSQ was developed to analyse and evaluate multiplex pyrosequencing results. To verify this software, we developed a multiplex pyrosequencing assay identifying all human-pathogenic orthopoxviruses (OPV). In addition to the causative agent of smallpox, variola virus (VARV), the genus OPV comprises diverse species including those transmitted zoonotically and causing infections in humans, like monkeypox virus (MPXV), cowpox virus (CPXV) and vaccinia virus (VACV). Further OPV that do not infect humans are camelpox virus (CMLV), mousepox virus (ECTV), raccoonpox virus and taterapox virus as well as various unclassified OPV. As genomic sequences are well conserved among OPV, virus type differentiation by only sequence variations or SNPs within a single stretch of sequence is often impossible. This makes OPV a good candidate for the demonstration of the utility of multiplex pyrosequencing and our tool’s capabilities.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2a">
      <title>PCR with Biotinylated Primers</title>
      <p>Each 25 µl reaction contained 3 µl of DNA, 1 × PCR buffer (Invitrogen), 4 mM of MgCl<sub>2</sub>, 200 nM of each dNTP, 800 nM of each PCR primer (mPox F: gTgATTTTggCAATAgTCCATgT, mPox R bio: Biotin-TAAAATggCCgAggAATTTg; Invitrogen) and 1 U of Platinum Taq polymerase (Invitrogen). PCR was performed in an Eppendorf Thermocycler (Eppendorf) with initial denaturation at 95°C for 5 min, followed by 45 cycles of 95°C for 15 s, 54°C for 30 s and 72°C for 30 s and a final elongation at 72°C for 5 min.</p>
    </sec>
    <sec id="s2b">
      <title>Gelelectrophoresis and Quantification</title>
      <p>To quantify amplified PCR product which represents the DNA template for pyrosequencing, 2 µl of PCR product were mixed with 1 µl of 6 × loading buffer and loaded on a 1.5% Agarose gel containing 0.5 µg/ml ethidium bromide. Equally, 2 µl of low mass DNA ladder (Invitrogen) were loaded in parallel. Electrophoresis was performed in 1 × TAE buffer at 90 V for 30 min. Quantification of DNA in resulting bands was done with E.A.S.Y RH-3 software (Herolab).</p>
    </sec>
    <sec id="s2c">
      <title>Multiplex Pyrosequencing</title>
      <p>Prior to sequencing, 20 to 25 µl of biotinylated PCR product were captured with Streptavidin Sepharose beads and purified with the PyroMark Q96 Vacuum Prep Workstation according to the manufacturer’s instructions (Qiagen). For pyrosequencing, 10 pmol of each sequencing primer (mPox PS1: AAATTCCggATACAT and mPox PS2: CTTgACAAAAATTgT) were hybridized to a single-stranded DNA template in the same well. Multiplex pyrosequencing using both primers at the same time for each template was performed with Pyro-Mark ID System (Qiagen) with programmed nucleotide dispensation order of eight cycles AGTC.</p>
    </sec>
    <sec id="s2d">
      <title>Viral DNA from Cell Culture and Clinical Samples</title>
      <p>The multiplex PSQ assay was established with viral DNA extracted from infected cell culture supernatants. DNA of the following viral strains was used: CMLV CP-19, CPXV GuWi, CPXV Brighton Red, CPXV Calpox, ECTV MP-Nü, MPXV MSF (the latter two kindly provided by Dr. H. Meyer, Bundeswehr Institute of Microbiology, Munich, Germany) and VACV NYCBH (ATCC # VR-1536).</p>
      <p>To verify the multiplex PSQ assay established, DNA from 34 clinical samples provided by the German Consultant Laboratory for Poxviruses were analysed and differentiated with the novel approach. Using real-time PCR approaches, 31 out of these 34 samples had previously been diagnosed as OPV positive, two as parapoxvirus (PPV) positive and one as Molluscum contagiosum virus (MOCV) positive. For 23 of 31 OPV samples the sequence of the haemagglutinin (HA) gene had been determined by Sanger sequencing, revealing one ECTV and 22 CPXV infections. For eight OPV samples the HA sequence and therefore the OPV species were unknown at this point of time.</p>
    </sec>
    <sec id="s2e">
      <title>Analysis of Multiplex Pyrograms</title>
      <p>A cross-platform program MultiPSQ was developed in C++ using the Trolltech QT toolkit to perform the analysis of the pyrograms. Initially, the data created by the pyrosequencer was exported into an xml file using the Pyro-Mark ID System software. This file included information about the wells used in the experiment, the dispensation order and the times of injection of the dNTPs for each well as well as the raw signals recorded during the run. This xml file was loaded into the analysis software.</p>
      <p>When reading the raw data of the wells, multiPSQ used a moving average filter to smooth the data. The baseline corrected value (B<sub>i</sub>) at each point was found by computing an intermediate value (A<sub>i</sub>) using the following formula:</p>
      <p><disp-formula id="pone.0060055.e001"><graphic xlink:href="pone.0060055.e001.jpg" position="anchor" orientation="portrait"/></disp-formula><inline-formula><inline-graphic xlink:href="pone.0060055.e002.jpg"/></inline-formula>where R<sub>n</sub> is the value of the raw data vector at position n, w is the window width (w = 30 in this case) and B<sub>i</sub> is the value of the corrected vector at position i. Peaks were detected, with a peak being defined as a point which on the one hand was a local maximum, preceded by at least three monotonously rising points, followed by at least three monotonously falling points. On the other hand, it had to be close to a known dNTP dispensation time. Given that no significant signal decline was observed when analyzing fragments up to 30 flows in length, no correction for signal decline was performed. Once the data had been read and preprocessed, multiPSQ showed a list of used wells at the top and both raw and preprocessed data for the selected well at the bottom (<xref ref-type="supplementary-material" rid="pone.0060055.s001">Figure S1</xref>). The signals of either a single well or all wells could then be analyzed by clicking the “Analyze” or “Analyze all” buttons, respectively. The analysis was performed in five steps:</p>
      <sec id="s2e1">
        <title>Calculation of possible pyrograms</title>
        <p>MultiPSQ read the definition of the assay from a primer file and, given the dispensation order of the loaded experiment, calculated the pyrogram which would have been expected from each of the primers in each organism defined in the assay. The plain text primer file can be exported from the program mPSQed <xref rid="pone.0060055-Dabrowski1" ref-type="bibr">[13]</xref> for any multiplex pyrosequencing assay created therein or it can be created by hand following the instructions in the README file which is distributed together with multiPSQ.</p>
      </sec>
      <sec id="s2e2">
        <title>Filtering of wells</title>
        <p>To make sure that only wells containing a meaningful signal were analyzed, two criteria were defined which had to be fulfilled by the raw data from each well before it was considered for further analysis: A peak must have occurred at least once every four cycles (as only four different bases are dispensed periodically), and two consecutive peaks were not generated by an injection of the same base. If one of these anomalies occurred, the well was not considered in the following calculations and was classified as “suspected NTC” (non-template control).</p>
      </sec>
      <sec id="s2e3">
        <title>Fitting of fingerprints</title>
        <p>The pyrogram generated during the experiment could be seen as a vector of signal strengths which, if an organism defined in the assay was sequenced, must have been a linear combination of the pyrograms expected for that organism. Since the different sequencing primers could contribute differently to the final pyrogram, the formula for the expected fingerprint was:<disp-formula id="pone.0060055.e003"><graphic xlink:href="pone.0060055.e003.jpg" position="anchor" orientation="portrait"/></disp-formula>where the vector F is the fingerprint with each element of F representing the signal intensity following the dispensation of a base, n is the number of pyrosequencing primers in the assay, the vector X<sub>i</sub> is the expected pyrogram of the i<sup>th</sup> pyrosequencing primer with each element of X<sub>i</sub> representing the expected signal intensity following the dispensation of a base given the dispensation order of the current experiment, and a<sub>i</sub> is the factor with which the i<sup>th</sup> pyrosequencing primer contributed to the fingerprint. Since neither the PCR amplification efficiencies nor the sequencing efficiencies of the different sequenced fragments relative to each other are known, it is impossible to pre-define a<sub>i</sub> for any of the pyrosequencing primers. However, the values of F and X<sub>i</sub> are known from the raw data and the assay definition file. Thus, as long as the number of dispensation events during the sequencing is larger than the number n of pyrosequencing primers used simultaneously in the experiment, the formula above describes an overdetermined system. Thus the set of factors a for each of the primers which allows the expected pyrograms to best fit the raw data could be calculated using the linear least squares method. Since a negative contribution of an amplicon to the signal is not biologically plausible, fingerprints for which the calculation yielded a negative value for any of the factors a<sub>i</sub> were discarded at this point. This constraint additionally increases the power of the least squares method, facilitating the recovery of the correct factors a<sub>i</sub> even in the presence of noise <xref rid="pone.0060055-Slawski1" ref-type="bibr">[14]</xref>.</p>
      </sec>
      <sec id="s2e4">
        <title>Filtering of fingerprints</title>
        <p>If a peak was expected in the fingerprint but no peak could be detected in the raw data the fingerprint was discarded.</p>
      </sec>
      <sec id="s2e5">
        <title>Determination of final classification</title>
        <p>After the filtering step, the fingerprint which explained the peaks in the raw data with the highest R<sup>2</sup> was defined as the most likely fingerprint. In order to assess the quality of this best fit, each assay can be calibrated using a plate with known species in each well. During calibration, the R<sup>2</sup> of the best-fitting fingerprint for each of the wells is determined. A cutoff R<sub>cut</sub> is defined as<disp-formula id="pone.0060055.e004"><graphic xlink:href="pone.0060055.e004.jpg" position="anchor" orientation="portrait"/></disp-formula>Where <inline-formula><inline-graphic xlink:href="pone.0060055.e005.jpg"/></inline-formula> is the mean R<sup>2</sup> of the best fit of the wells containing species defined in the assay and <inline-formula><inline-graphic xlink:href="pone.0060055.e006.jpg"/></inline-formula> is the mean R<sup>2</sup> of the best fit of the wells containing species not defined in the assay. In following analyses, any well where the R<sup>2</sup> of the best-fitting fingerprint is lower than R<sub>cut</sub> is classified as “unknown”. To ensure that the identified cutoff is correct, following calibration a leave-one-out analysis is performed over the whole plate. If, during the leave-one-out, any well is misclassified, the user is provided with a list of misclassified wells and warned that classification using the given assay is likely to be unreliable. Otherwise, the determined R<sub>cut</sub> is saved to the assay definition file so that it can be used in subsequent analyses.</p>
        <p>It is possible to perform classification without prior calibration. In that case, a default cutoff of 0.5 is used. However, every time an analysis is performed using an uncalibrated assay, the user is given a warning and is reminded to perform calibration to ensure valid results.</p>
        <p>Since the algorithm only fits the raw signals to pyrograms expected from known, pre-defined sequences, a strain containing novel SNPs will be classified as “unknown”. The identification of sequences similar, but not identical to the predefined set is not possible since, as described above and shown in <xref ref-type="fig" rid="pone-0060055-g001">Figure 1</xref>, it is not possible to reconstruct the sequences from which a multiplex pyrosequencing fingerprint was created without a priori information about the possible starting sequences.</p>
        <p>The results of the analysis for the selected well are shown in the top area of multiPSQ, along with the optimal factors a<sub>i</sub> determined for the most likely fingerprint. For all wells, the analysis result is color-coded in the well selection area (<xref ref-type="supplementary-material" rid="pone.0060055.s001">Figure S1</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>Design of the Multiplex Pyrosequencing Assay</title>
      <p>Critical steps in designing a multiplex pyrosequencing assay were the identification of suitable sequence variations and the respective selection of sequencing primers in combination with an optimal nucleotide dispensation order. Suitable SNPs could be identified by the following strategy: First, all relevant known sequences (sequences of 89 OPV genomes available from NCBI and 24 full genome sequences generated in-house which have not been published yet, see <xref ref-type="supplementary-material" rid="pone.0060055.s002">Table S1</xref>) were aligned. Then the sequences were grouped by species. Potentially interesting SNPs could be found at those positions in the alignment which are fully conserved within each of the individual groups but not fully conserved across the groups to be differentiated. Ideally, regions in the alignment should be identified which contain several such representative SNPs within a stretch of only a few bases, as several SNPs could then be sequenced with a single primer. Once characteristic SNPs had been found for each group, the pyrosequencing primers had to be positioned in a way that all of the SNPs could be sequenced with just a few sequencing cycles. Finally, the resulting fingerprints (<xref ref-type="fig" rid="pone-0060055-g001">Figure 1</xref>) had to be calculated to ensure that each group’s fingerprint was indeed unique. Because of the way the fingerprints were generated, it was possible for signals to mask each other. For instance, if one of the characteristic SNPs was the deletion of an A and another characteristic SNP – sequenced by a different primer – was the insertion of an A, these two SNPs would cancel out in the fingerprint if both “As” were sequenced in the same cycle. This problem could be solved by moving one of the primers so that one of them generates the sequence of the SNP in a different cycle. Obviously careful positioning of the pyrosequencing primers was of utmost importance. Specialized software had been developed in-house to aid in this design process <xref rid="pone.0060055-Dabrowski1" ref-type="bibr">[13]</xref>.</p>
      <p>The analysis and classification of pyrograms generated from such multiplex pyrosequencing assays was also challenging. Since software currently available was limited to a fixed number of SNPs and sequencing primers, we have developed our own software tool, multiPSQ, for data analysis. MultiPSQ was developed in C++ using the QT toolkit. Source code and binaries are available for download together with exemplary data from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/multipsq/">http://sourceforge.net/projects/multipsq/</ext-link>.</p>
    </sec>
    <sec id="s3b">
      <title>Differentiation of Orthopoxviruses</title>
      <p>In the case of OPV differentiation, pyrosequencing of one PCR product with two sequencing primers resulted in species-specific fingerprints for all OPV species tested (<xref ref-type="fig" rid="pone-0060055-g002">Figure 2</xref>). Samples with non-OPV template were correctly determined as “unknown” while the non-template control was truly negative. In addition to cell culture-derived virus stocks, 34 clinical samples from the German Consultant Laboratory for Poxviruses were analyzed with the new multiplex PSQ assay (<xref ref-type="table" rid="pone-0060055-t001">Table 1</xref>). Pyrosequencing results were compared to conventional Sanger sequencing results, identifying 22 clinical samples as CPXV or ECTV positive, respectively, with both methods. Eight samples, for which no Sanger sequence was available at that time, were identified as CPXV positive using multiplex PSQ. In one case Sanger sequencing and pyrosequencing showed different results, classifying sample number 31 as CPXV or VACV positive, respectively. Examination of the regions used in the multiplex PSQ assay showed that sample 31 indeed carries all of the SNPs expected for VACV rather than for CPXV. However, phylogenetic analysis of the whole Sanger sequence showed sample 31 clearly clustering with CPXV. This means that the primers used in this work cannot be used to differentiate between CPXV and VACV since CPXV strains carrying the VACV SNPs exist. Still, the SNPs present in the sequence were correctly identified by the algorithm. Given that this work does not aim at creating a new diagnostic assay but rather at proving that relevant SNPs can be extracted from multiplex PSQ signals, and SNP information was indeed correctly identified, we consider this discrepancy in classification unproblematic.</p>
      <fig id="pone-0060055-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0060055.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Fingerprints and species classification by the OPV multiplex PSQ assay.</title>
          <p>Each OPV species resulted in a slightly different fingerprint allowing a definite identification. Non-OPV template is determined as “unknown” and non-template control is identified as “NTC”.</p>
        </caption>
        <graphic xlink:href="pone.0060055.g002"/>
      </fig>
      <table-wrap id="pone-0060055-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0060055.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparative results of multiplex pyrosequencing and Sanger sequencing.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0060055-t001-1" xlink:href="pone.0060055.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sample #</td>
                <td align="left" rowspan="1" colspan="1">Species</td>
                <td align="left" rowspan="1" colspan="1">DNA source</td>
                <td align="left" rowspan="1" colspan="1">OPV PCR</td>
                <td align="left" rowspan="1" colspan="1">Sanger sequencing</td>
                <td align="left" rowspan="1" colspan="1">Pyrosequencing</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">banded mongoose</td>
                <td align="left" rowspan="1" colspan="1">skin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">cat</td>
                <td align="left" rowspan="1" colspan="1">scab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">cat</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">dog</td>
                <td align="left" rowspan="1" colspan="1">tissue, paraffin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">scab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">ichor</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">11</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">skin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">scab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">13</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">scab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">14</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">cornea</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">15</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">tissue</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">16</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">tissue, paraffin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">17</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">tissue</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">18</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">19</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">tissue</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">20</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">scab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">21</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">lymph node</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">23</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">glove</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">24</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">ichor</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">jaguarundi</td>
                <td align="left" rowspan="1" colspan="1">skin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">26</td>
                <td align="left" rowspan="1" colspan="1">mara</td>
                <td align="left" rowspan="1" colspan="1">eye</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">n.d.</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">27</td>
                <td align="left" rowspan="1" colspan="1">mouse</td>
                <td align="left" rowspan="1" colspan="1">lung</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">ECTV</td>
                <td align="left" rowspan="1" colspan="1">ECTV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">rat</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">29</td>
                <td align="left" rowspan="1" colspan="1">rat</td>
                <td align="left" rowspan="1" colspan="1">skin</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">rat</td>
                <td align="left" rowspan="1" colspan="1">lung</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">31</td>
                <td align="left" rowspan="1" colspan="1">rat</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">VACV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">32</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">PPV</td>
                <td align="left" rowspan="1" colspan="1">−</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">33</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">serum</td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">PPV</td>
                <td align="left" rowspan="1" colspan="1">−</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">34</td>
                <td align="left" rowspan="1" colspan="1">human</td>
                <td align="left" rowspan="1" colspan="1">swab</td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">MOCV</td>
                <td align="left" rowspan="1" colspan="1">−</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">35</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CMLV</td>
                <td align="left" rowspan="1" colspan="1">CMLV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">37</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
                <td align="left" rowspan="1" colspan="1">CPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">39</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">ECTV</td>
                <td align="left" rowspan="1" colspan="1">ECTV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">MPXV</td>
                <td align="left" rowspan="1" colspan="1">MPXV</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">41</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">cell culture</td>
                <td align="left" rowspan="1" colspan="1">+</td>
                <td align="left" rowspan="1" colspan="1">VACV</td>
                <td align="left" rowspan="1" colspan="1">VACV</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>+ positive PCR result; − negative PCR result; n.d. not done. Sanger classification is based on sequencing of a ∼960 bp fragment of the HA gene, except for PPV and MOCV which are not OPV (thus also yielding no signal in the OPV PCR).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Non-OPV species such as PPV and MOCV were identified as negative.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>In contrast to laborious and time-consuming Sanger sequencing which is usually done to identify and type pathogens following PCR, pyrosequencing represents a fast and reliable alternative method. It allows sequence generation and pathogen identification in less than one hour from preparation of PCR products to final sequence. However, due to the underlying mechanism of sequencing-by-synthesis, sequences generated by pyrosequencing are usually short (up to 80 nucleotides) <xref rid="pone.0060055-Ronaghi2" ref-type="bibr">[6]</xref>, <xref rid="pone.0060055-Kramski1" ref-type="bibr">[15]</xref>. Therefore, discrimination of more than two closely related organisms that differ only in a few but non-conserved SNPs is not possible with conventional pyrosequencing. To circumvent this problem, the generation of sequences starting from more than one primer leads to specific sequence fingerprints, enabling pathogen typing despite non-conserved SNPs that are representative for a respective group. Recently, such a multiplex pyrosequencing assay has been developed e.g. for genotyping hepatitis C virus <xref rid="pone.0060055-Pourmand1" ref-type="bibr">[11]</xref>.</p>
    <p>Multiplex pyrosequencing is a versatile technology which can be used for quick and easy classification of samples based on a large set of different SNPs. The design of assays and the analysis of the resulting data are, however, neither trivial nor are they supported by common software. In this paper, we present the program MultiPSQ which complements the analysis capabilities of the Qiagen pyrosequencing platform. We demonstrate the capability of this technology to tackle non-trivial tasks by applying it to the identification and classification of all human-pathogenic OPV.</p>
    <p>In our investigations one clinical sample could not be classified correctly by the novel approach. The multiplex assay was designed on the basis of all 89 known and annotated OPV genomes found in GenBank (see <xref ref-type="supplementary-material" rid="pone.0060055.s002">Table S1</xref>) and 24 unpublished OPV genomes sequenced by whole genome sequencing in our lab. Sanger sequencing of the longer haemagglutinin ORF (816–957 bases) identified a CPXV strain in clinical sample number 31. However, the CPXV strain shows sequence similarity to VACV strains in the region of the O2L CDS used for multiplex pyrosequencing. The use of a third amplicon for pyrosequencing could help to obtain additional information.</p>
    <p>Since our method classifies samples based on the similarity of their pyrosequencing fingerprints to theoretical fingerprints generated from known sequences, novel mutations cannot be correctly attributed to a certain species, but can be defined as unknown, indicating a novel variant of the virus. As can be seen in <xref ref-type="fig" rid="pone-0060055-g001">Figure 1</xref>, it is impossible to reconstruct the individual sequences from the fingerprint. Thus, any unknown strain – in this case for instance an OPV with a novel mutation in the sequence regions used – will generate a fingerprint which is different from all of the expected fingerprints. Since it is impossible to tell whether this difference stems from a simple SNP or from major differences in sequence, the sample will be classified as “Unknown”.</p>
    <p>It has to be mentioned that a multiplex pyrosequencing assay is not suitable to identify co-infections with different pathogen strains. We have demonstrated the applicability of multiplex pyrosequencing to the identification and classification of human-pathogenic OPV. This method is applicable to any problem where samples need to be classified based on nucleic acid sequences. The possibility to use any number of amplicons with any number of pyrosequencing primers and thus any number of SNPs means that even tough problems, where conserved sites with discriminating SNPs are few and far between, can be successfully tackled. However, since our method does not correct for the decline of signal intensity in long pyrosequencing reads, it may not perform well on assays in which long amplicons need to be sequenced.</p>
    <p>We postulate that the method presented in this paper will lead to a more wide-spread adaptation of multiplex pyrosequencing in diagnostics, as it allows the quick and cost-effective generation of high-quality results.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0060055.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Screenshots of the program.</bold> Left: The program window after a run xml file has been loaded into the software. A: The imported plate is shown, the used wells are marked. The raw data (B: gray graph) and the pre-processed data (C: blue graph) are displayed. The gray bars in the blue graph show where peaks have been detected. Right: The program window after a run has been analyzed. D: Next to the plate graphic the resulting classification (in this case CPXV1) and the optimum factors of the (two) pyrosequencing primers are shown. E: Red and blue bars in the bottom graph visualize how the detected peaks are explained by the signals expected from the two primers.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0060055.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0060055.s002">
      <label>Table S1</label>
      <caption>
        <p>List of 89 OPV genomes from NCBI used in the design of the proof-of-concept assay.</p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0060055.s002.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Ursula Erikli for copy-editing. We also thank Dr. Bernhard Renard for critical discussions, many highly constructive suggestions and great help with finishing the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0060055-Sanger1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Sanger</surname><given-names>F</given-names></name>, <name><surname>Nicklen</surname><given-names>S</given-names></name>, <name><surname>Coulson</surname><given-names>AR</given-names></name> (<year>1977</year>) <article-title>DNA sequencing with chain-terminating inhibitors</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>74</volume>: <fpage>5463</fpage>–<lpage>5467</lpage>.<pub-id pub-id-type="pmid">271968</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Ahmadian1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Ahmadian</surname><given-names>A</given-names></name>, <name><surname>Gharizadeh</surname><given-names>B</given-names></name>, <name><surname>Gustafsson</surname><given-names>AC</given-names></name>, <name><surname>Sterky</surname><given-names>F</given-names></name>, <name><surname>Nyren</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2000</year>) <article-title>Single-nucleotide polymorphism analysis by pyrosequencing</article-title>. <source>Anal Biochem</source>
<volume>280</volume>: <fpage>103</fpage>–<lpage>110</lpage>.<pub-id pub-id-type="pmid">10805527</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Elahi1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Elahi</surname><given-names>E</given-names></name>, <name><surname>Ronaghi</surname><given-names>M</given-names></name> (<year>2004</year>) <article-title>Pyrosequencing: a tool for DNA sequencing analysis</article-title>. <source>Methods Mol Biol</source>
<volume>255</volume>: <fpage>211</fpage>–<lpage>219</lpage>.<pub-id pub-id-type="pmid">15020827</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-FakhraiRad1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Fakhrai-Rad</surname><given-names>H</given-names></name>, <name><surname>Pourmand</surname><given-names>N</given-names></name>, <name><surname>Ronaghi</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>Pyrosequencing: an accurate detection platform for single nucleotide polymorphisms</article-title>. <source>Hum Mutat</source>
<volume>19</volume>: <fpage>479</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">11968080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Ronaghi1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ronaghi</surname><given-names>M</given-names></name> (<year>2001</year>) <article-title>Pyrosequencing sheds light on DNA sequencing</article-title>. <source>Genome Res</source>
<volume>11</volume>: <fpage>3</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">11156611</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Ronaghi2">
      <label>6</label>
      <mixed-citation publication-type="other">Ronaghi M, Uhlen M, Nyren P (1998) A sequencing method based on real-time pyrophosphate. Science 281: 363, 365.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Patel1">
      <label>7</label>
      <mixed-citation publication-type="other">Patel P, Shiao YH, Fortina P (2007) Multiplex pyrosequencing for DNA variation analysis. Methods Mol Biol: 75–88.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Gharizadeh1">
      <label>8</label>
      <mixed-citation publication-type="other">Gharizadeh B, Ghaderi M, Donnelly D, Amini B, Wallin KL, <etal>et al</etal>. (2003) Multiple-primer DNA sequencing method. Electrophoresis: 1145–1151.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Gharizadeh2">
      <label>9</label>
      <mixed-citation publication-type="other">Gharizadeh B, Oggionni M, Zheng B, Akom E, Pourmand N, <etal>et al</etal>. (2005) A Novel Strategy for Reliable and Rapid Genotyping of Human Papillomaviruses by Pyrosequencing Technology. J Mol Diagn: 198–205.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Gharizadeh3">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Gharizadeh</surname><given-names>B</given-names></name>, <name><surname>Oggionni</surname><given-names>M</given-names></name>, <name><surname>Zheng</surname><given-names>B</given-names></name>, <name><surname>Akom</surname><given-names>E</given-names></name>, <name><surname>Pourmand</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Type-specific multiple sequencing primers: a novel strategy for reliable and rapid genotyping of human papillomaviruses by pyrosequencing technology</article-title>. <source>J Mol Diagn</source>
<volume>7</volume>: <fpage>198</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">15858143</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Pourmand1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Pourmand</surname><given-names>N</given-names></name>, <name><surname>Elahi</surname><given-names>E</given-names></name>, <name><surname>Davis</surname><given-names>RW</given-names></name>, <name><surname>Ronaghi</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>Multiplex Pyrosequencing</article-title>. <source>Nucleic Acids Res</source>
<volume>30</volume>: <fpage>e31</fpage>.<pub-id pub-id-type="pmid">11917037</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0060055-Doostzadeh1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Doostzadeh</surname><given-names>J</given-names></name>, <name><surname>Shokralla</surname><given-names>S</given-names></name>, <name><surname>Absalan</surname><given-names>F</given-names></name>, <name><surname>Jalili</surname><given-names>R</given-names></name>, <name><surname>Mohandessi</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>High Throughput Automated Allele Frequency Estimation by Pyrosequencing</article-title>. <source>PLoS ONE</source>
<volume>7</volume>: <fpage>e2693</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Dabrowski1">
      <label>13</label>
      <mixed-citation publication-type="other">Dabrowski PW, Nitsche A (2012) mPSQed: A software for the Design of Multiplex Pyrosequencing Assays. PLoS ONE.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Slawski1">
      <label>14</label>
      <mixed-citation publication-type="other">Slawski M, Hein M, Campus E (2011) Sparse recovery by thresholded non-negative least squares. Advances in Neural Information Processing Systems 24: Department of Computer Science, University of Saarbruecken. 1926–1934.</mixed-citation>
    </ref>
    <ref id="pone.0060055-Kramski1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kramski</surname><given-names>M</given-names></name>, <name><surname>Meisel</surname><given-names>H</given-names></name>, <name><surname>Klempa</surname><given-names>B</given-names></name>, <name><surname>Kruger</surname><given-names>DH</given-names></name>, <name><surname>Pauli</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Detection and typing of human pathogenic hantaviruses by real-time reverse transcription-PCR and pyrosequencing</article-title>. <source>Clin Chem</source>
<volume>53</volume>: <fpage>1899</fpage>–<lpage>1905</lpage>.<pub-id pub-id-type="pmid">17717126</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
