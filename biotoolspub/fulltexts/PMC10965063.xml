<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pgen.1011189.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10965063</article-id>
    <article-id pub-id-type="pmid">38484017</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-23-01170</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Organism Development</subject>
            <subj-group>
              <subject>Organogenesis</subject>
              <subj-group>
                <subject>Brain Development</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Phenotypes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognition</subject>
              <subj-group>
                <subject>Memory</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Learning and Memory</subject>
            <subj-group>
              <subject>Memory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Critical Care and Emergency Medicine</subject>
          <subj-group>
            <subject>Trauma Medicine</subject>
            <subj-group>
              <subject>Traumatic Injury</subject>
              <subj-group>
                <subject>Neurotrauma</subject>
                <subj-group>
                  <subject>Traumatic Brain Injury</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>INSIDER: Interpretable sparse matrix decomposition for RNA expression data analysis</article-title>
      <alt-title alt-title-type="running-head">Insider</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2774-6326</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Kai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Sen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Cuichan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2533-7270</contrib-id>
        <name>
          <surname>Sham</surname>
          <given-names>Pak Chung</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>So</surname>
          <given-names>Hon-Cheong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Zhixiang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of System Engineering and Engineering Management, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Psychiatry, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Psychiatry, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Centre for Genomic Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>State Key Laboratory for Cognitive and Brain Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>School of Biomedical Sciences, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>KIZ-CUHK Joint Laboratory of Bioresources and Molecular Research of Common Diseases, Kunming Institute of Zoology and The Chinese University of Hong Kong, Hong Kong, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Case Western Reserve University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hcso@cuhk.edu.hk</email> (H-CS); <email>zhixianglin@cuhk.edu.hk</email> (ZL)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>3</issue>
    <elocation-id>e1011189</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhao et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhao et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1011189.pdf"/>
    <abstract>
      <p>RNA sequencing (RNA-Seq) is widely used to capture transcriptome dynamics across tissues, biological entities, and conditions. Currently, few or no methods can handle multiple biological variables (e.g., tissues/ phenotypes) and their interactions simultaneously, while also achieving dimension reduction (DR).</p>
      <p>We propose INSIDER, a general and flexible statistical framework based on matrix factorization, which is freely available at <ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve DR of high-dimensional data (of &gt; = 3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample × expression). Besides, it enables computing ’adjusted’ expression profiles for specific biological variables while controlling variation from other variables. INSIDER is computationally efficient and accommodates missing data. INSIDER also performed similarly or outperformed a close competing method, SDA, as shown in simulations and can handle complex missing data in RNA-Seq data. Moreover, unlike SDA, it can be used when the data cannot be structured into a tensor. Lastly, we demonstrate its usefulness via real data analysis, including clustering donors for disease subtyping, revealing neuro-development trajectory using the BrainSpan data, and uncovering biological processes contributing to variables of interest (e.g., disease status and tissue) and their interactions.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>The RNA-Seq studies aim to understand the contributing role of gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development. However, our ability to understand these key issues in high-dimensional settings is hampered by the limitations of currently available methods for analyzing RNA-seq data. To address these issues, we propose a novel statistical method to jointly model variation from multiple biological variables (e.g., donor, tissue, phenotype), to introduce interactions (tissue × phenotype), and to reduce dimensionality. The favorable properties of our method are discussed below. Its advantages over one closest existing computational tool and its wide applicability are shown via simulation and applications. A computationally efficient implementation of our method is provided.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4930181</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100021366</institution-id>
            <institution>Faculty of Science, Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRIMS 4620033</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4053540, 4053586</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002920</institution-id>
            <institution>Research Grants Council, University Grants Committee</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GRF 14301120, GRF 14300923</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>ZL has been supported by the Chinese University of Hong Kong startup grant (4930181), the Chinese University of Hong Kong Science Faculty’s Collaborative Research Impact Matching Scheme (CRIMS 4620033), the Chinese University of Hong Kong direct grants (4053540, 4053586), and Hong Kong Research Grant Council (GRF 14301120, 14300923). The funders play no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="4"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-03-26</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA Sequencing (RNA-Seq), which has been developed for more than a decade, uses deep sequencing technology to offer a far more precise measurement of levels of transcripts and their isoforms than other methods [<xref rid="pgen.1011189.ref001" ref-type="bibr">1</xref>]. It is now widely used to measure transcriptome levels across different tissues from a number of donors and capture transcriptome dynamics across tissues or biological conditions. For example, the Genotype-Tissue Expression (GTEx) [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] project offers a valuable data resource to study tissue-specific gene expression and regulation. Moreover, there are many data resources related to brain development or psychiatric disorders across brain regions, including the BrainSpan [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>], PsychENCODE [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], and ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>]. The primary task of these studies is to link gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development.</p>
    <p>However, variation in transcript levels due to covariates, such as donor and tissue, makes the task challenging. Let us take studies of autism spectrum disorder (ASD) as examples. Different brain regions may demonstrate wide differences in gene activities in ASD [<xref rid="pgen.1011189.ref006" ref-type="bibr">6</xref>]. On the other hand, no individuals with ASD have exactly the same genetic expression profiles [<xref rid="pgen.1011189.ref007" ref-type="bibr">7</xref>], which are influenced by individual characteristics such as age, sex, diet, and lifestyle. Thus, joint analyses of gene expression by RNA-Seq of multiple brain regions from several donors are hindered by the variation from donors and tissues.</p>
    <p>Tools for differential gene expression (DGE) analysis [<xref rid="pgen.1011189.ref008" ref-type="bibr">8</xref>, <xref rid="pgen.1011189.ref009" ref-type="bibr">9</xref>], typically built upon generalized linear models (GLM), have been widely employed to quantify changes in expression levels across experimental groups or biological conditions in analyzing RNA expression data. Such methods can also consider confounding variation from covariates, such as donor, and tissue. However, DGE analysis does not aim for dimension reduction and thus cannot help achieve the tasks that require reducing high dimensional data onto a low-rank latent space, such as clustering donors based on low-rank representations of donors (low-rank representations are preferred as the high dimension of genomic features often makes clustering analysis difficult), and other downstream analysis with low-rank representations of biological conditions (phenotype, tissue, or developmental stage).</p>
    <p>Traditional dimension reduction (DR) approaches, such as principal component analysis (PCA), factor analysis, and matrix factorization, cannot directly handle the variation from <italic toggle="yes">multiple</italic> covariates, such as donor, tissue, and other clinical or biological features, to facilitate further analysis. One study [<xref rid="pgen.1011189.ref010" ref-type="bibr">10</xref>] proposed a PCA-based approach with adjustment for confounding variables. Other approaches based on factor analysis have been proposed to adjust for technical artifacts or confounding variables [<xref rid="pgen.1011189.ref011" ref-type="bibr">11</xref>,<xref rid="pgen.1011189.ref012" ref-type="bibr">12</xref>]. These studies aim to remove technical artifacts or control confounding variations rather than interpret variations originating from biological conditions.</p>
    <p>Non-negative matrix factorization (NMF) [<xref rid="pgen.1011189.ref013" ref-type="bibr">13</xref>–<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>] has gained popularity in the analysis of genomic data. The conventional NMF method cannot be directly employed to model variations arising from <italic toggle="yes">multiple</italic> biological variables and their interactions, and to interpret variations from <italic toggle="yes">multiple</italic> biological features or conditions. Variants of NMF proposed for the analysis of bulk RNA-Seq data are rather limited, and most of them aim to correct batch effects in single-cell settings instead of interpreting variation from biological variables [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>]. On the other hand, NMF and its variants fail to directly infer down-regulations of elements in biological settings [<xref rid="pgen.1011189.ref016" ref-type="bibr">16</xref>], so its interpretability is hampered.</p>
    <p>To summarize, conventional DR methods such as PCA and NMF can usually only be used for two-dimensional (2D) data (e.g., sample × expression), and cannot directly handle <italic toggle="yes">multiple</italic> variables or biological conditions (e.g., donor × tissue × expression; donor × time × expression etc.), or interactions between these conditions. On the other hand, the new methodology we proposed below (INSIDER) can handle <italic toggle="yes">higher-dimensional data (of three or more dimensions)</italic>, as well as interactions between the variables of interest, while performing DR simultaneously.</p>
    <p>We note that most tensor decomposition approaches [<xref rid="pgen.1011189.ref017" ref-type="bibr">17</xref>–<xref rid="pgen.1011189.ref019" ref-type="bibr">19</xref>] can achieve DR with high-dimensional data, however most cannot handle missing data or invoke sparsity in the latent representations. This may impose limitations in analyzing gene expression data since the function of a particular biological pathway often only involves a subset of genes, and each latent dimension only encodes information related to a few pathways. Thus, a sparse Bayesian tensor decomposition approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] (Sparse Decomposition of Arrays [SDA]) was proposed to capture variation from donor and tissue in analyzing RNA-Seq data. However, Bayesian-based approaches face a heavy computational burden in analyzing large-scale genomic data, especially when optimizing with Markov Chain Monte Carlo.</p>
    <p>To model variation from <italic toggle="yes">multiple</italic> biological variables and to facilitate interpretation of the variation, we propose a general and flexible statistical framework, INSIDER, based on matrix decomposition (MF) without non-negative constraints to decompose the variation from covariates in high dimensional data into a shared low-rank latent space. INSIDER has the following favorable properties:</p>
    <list list-type="order">
      <list-item>
        <p>it is a general and flexible framework, in which various covariates and interaction terms can be defined based on research questions and study design. Importantly, it can accommodate <italic toggle="yes">multiple</italic> biological variables simultaneously, and achieve DR of <italic toggle="yes">high-dimensional</italic> data, as opposed to other conventional methods such as PCA and NMF which generally can only handle 2D data (e.g., sample × expression);</p>
      </list-item>
      <list-item>
        <p>it is able to consider <italic toggle="yes">interactions</italic> between different biological/clinical variables, enabling gaining insights into the effect of one variable on others. For example, modeling gene expression of various brain regions across neuropsychiatric disorders, the brain region × disorder interaction, can help understand how brain regions interact with the type of disorder to influence expression. Intuitively, the same disease may affect expression differently in different brain regions; such information may be missed if interactions are not modeled. Notably, interactions are usually ignored by conventional methods, such as PCA, NMF, and their variants. Interactions were also ignored in the recently developed SDA approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>];</p>
      </list-item>
      <list-item>
        <p>it allows one to compute the ’adjusted’ expression for one variable (e.g., phenotype) that controls for variation from other variables (e.g., donor). In addition, to consider the group effect among genes and invoke sparsity in gene expression, it introduces an elastic net penalty (combination of L1 and L2 penalty). Elastic net penalty is widely used in the regression setting where only a subset of features may contribute to the outcome, but it prefers highly correlated predictors to be included or excluded from the model together [<xref rid="pgen.1011189.ref021" ref-type="bibr">21</xref>] (instead of arbitrarily selecting one predictor over others as in LASSO);</p>
      </list-item>
      <list-item>
        <p>Results from it facilitate different downstream analyses, including clustering donors with donor representations, temporal dynamic analyses, and uncovering disease mechanisms. The potential of INSIDER in facilitating clinical and biological discoveries will be demonstrated in the Results section;</p>
      </list-item>
      <list-item>
        <p>it is computationally efficient and can also handle missing data well. These will be elaborated further in the sections below;</p>
      </list-item>
      <list-item>
        <p>it also performed similarly or outperformed one of the closest competing methods, SDA, as shown in our simulations. Moreover, unlike SDA, it can also be used where the data matrix cannot be neatly structured into a tensor, as explained below.</p>
      </list-item>
    </list>
    <p>To recap the uniqueness of INSIDER, it models variation arising from <italic toggle="yes">multiple</italic> biological variables and their interaction to comprehend their effects on gene expression in a complex biological setting instead of solely removing technical artifacts or controlling confounding variations. Moreover, it models the effect of specific biological variables while controlling for variation from other biological variables. Unlike GLM-based methods for DGE analysis, INSIDER is a statistical approach for dimension reduction, thus enabling performing the tasks that are challenging using high-dimensional features, such as clustering subjects with donor representations. In contrast to NMF, INSIDER considers the interaction between biological variables and does not impose non-negativity constraints on the latent representations, which allows for capturing down-regulation in gene expression and thus enhances model interpretability. Additionally, compared with tensor decomposition, it can handle situations where the data matrix cannot be structured into a tensor. Usually, for tensor decomposition approaches, we assume one observation/sample per each combination of the three (or more) dimensions, but this is not always the case in practice. To illustrate with an example, when analyzing the effect of neuropsychiatric disorders on expression in different brain regions, multiple samples may be taken from a specific brain region from donors with a certain disorder. The number of samples taken could also differ across donors. This scenario can be challenging for standard tensor decomposition or SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], but can be handled by our proposed method.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of INSIDER</title>
      <p>We propose a novel computational method called INSIDER (<underline>in</underline>terpretable <underline>s</underline>parse matr<underline>i</underline>x <underline>de</underline>composition for bulk <underline>R</underline>NA expression data analysis), summarized in <xref rid="pgen.1011189.g001" ref-type="fig">Fig 1</xref>. INSIDER considers that variation in RNA expression levels originates from several biological variables or covariates, such as donor, tissue, and phenotype (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1A</xref>). The variation is decomposed into a shared latent space of rank <italic toggle="yes">K</italic> by matrix factorization, and variation from unknow sources can also be considered by INSIDER (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). The effect of each covariate on expression can be measured by multiplying the corresponding latent representation with the gene representation <italic toggle="yes">V</italic> (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). Specifically, the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>, <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub>, is modelled as
<disp-formula id="pgen.1011189.e001"><alternatives><graphic xlink:href="pgen.1011189.e001.jpg" id="pgen.1011189.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>. <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the information is unavailable. The interaction effect between tissues and phenotypes is incorporated by introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. Let <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> denote the observed data matrix for <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The above equation can be rewritten in the following matrix representation
<disp-formula id="pgen.1011189.e002"><alternatives><graphic xlink:href="pgen.1011189.e002.jpg" id="pgen.1011189.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>We assume there are <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. For the purpose of representation, <inline-formula id="pgen.1011189.e003"><alternatives><graphic xlink:href="pgen.1011189.e003.jpg" id="pgen.1011189.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are introduced to be the indicator matrices for donors, phenotypes, tissues, phenotype by tissue interactions, and observations, which are the dummy design matrices for the samples. <italic toggle="yes">X</italic><sub><italic toggle="yes">U</italic></sub> is an identity matrix. <inline-formula id="pgen.1011189.e004"><alternatives><graphic xlink:href="pgen.1011189.e004.jpg" id="pgen.1011189.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the matrices for latent representations for the effects of donors, phenotypes, tissues, phenotype by tissue interactions, and observations on the <italic toggle="yes">K</italic> latent metagenes, respectively, and <italic toggle="yes">V</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> represents <italic toggle="yes">K</italic> metagenes across the <italic toggle="yes">M</italic> genes, which capture genes that tend to be co-expressed or work together to induce biological functions.</p>
      <p>In INSIDER, we seek to minimize the following objective
<disp-formula id="pgen.1011189.e005"><alternatives><graphic xlink:href="pgen.1011189.e005.jpg" id="pgen.1011189.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e006"><alternatives><graphic xlink:href="pgen.1011189.e006.jpg" id="pgen.1011189.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e007"><alternatives><graphic xlink:href="pgen.1011189.e007.jpg" id="pgen.1011189.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Here <italic toggle="yes">λ</italic>, <italic toggle="yes">α</italic> are tuning parameters for the elastic net regularization term,||·||<sub><italic toggle="yes">F</italic></sub> represents the Frobenius norm. Alternating block coordinate descent (BCD) is utilized to optimize the objective. INSIDER can incorporate observations with missing values. The technical details of INSIDER are presented in the Methods section.</p>
      <p>INSIDER enables various downstream analyses (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1C</xref>). For instance, cluster analysis on the donor representation can reveal characteristics of the donors and help find patients subgroups or disease subtyping, development trajectory can be more readily revealed with ‘metagenes’ (low-rank representations of gene expression), which capture the information of genes that tend to be co-expressed or work together to induce biological functions [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. Also, biological processes (BPs) enriched by results from INSIDER help to gain insights into mechanisms underlying covariates like phenotype and interactions between covariates. Details of these analyses are presented below.</p>
      <fig position="float" id="pgen.1011189.g001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of INSIDER.</title>
          <p>A. The RNA-seq data is usually obtained from samples of different tissues from several donors with different phenotypes. B. The variation in RNA-seq expression data can be decomposed into a shared <italic toggle="yes">K</italic>-rank latent space by INSIDER. The latent representation for observations <italic toggle="yes">U</italic> can be included when the donor, phenotype, and/or tissue information is unavailable. Note that INSIDER incorporates the interaction between covariates and that the gene representation <italic toggle="yes">V</italic> is shared. C. Various types of downstream analysis can be conducted on the result from INSIDER. The donor representations can be utilized for cluster analysis, development trajectories can be revealed in the analysis of the BrainSpan data, and biological mechanisms behind phenotypes of interest and interactions between covariates can be revealed. Details on these analyses will be demonstrated in the Result section.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Simulation study</title>
      <p>To our knowledge, there is no readily available computational tool for modeling the variation arising from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic>, while also performing dimension reduction (and having similar favorable properties as described earlier). Tensor decomposition is the closest existing computational tool to INSIDER. To showcase the advantages of INSIDER in capturing complex latent structures of gene expression data, it was compared to SDA[<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a sparse Bayesian tensor decomposition approach. We evaluated their abilities to accurately recover the underlying latent structures from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic> with RMSE (root-mean-squared error).</p>
      <p>In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (250×200), and variation in the matrix comes from two biological variables (<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>), their interaction, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic></sub><italic toggle="yes">R</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and the dimension of <italic toggle="yes">R</italic> for the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> is 250×5. <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>,<italic toggle="yes">R</italic>} are <inline-formula id="pgen.1011189.e008"><alternatives><graphic xlink:href="pgen.1011189.e008.jpg" id="pgen.1011189.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e009"><alternatives><graphic xlink:href="pgen.1011189.e009.jpg" id="pgen.1011189.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e010"><alternatives><graphic xlink:href="pgen.1011189.e010.jpg" id="pgen.1011189.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (250×200) was generated from a normal distribution <italic toggle="yes">N</italic>(0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. We considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1 in our simulations. Meanwhile, to introduce sparsity in gene expression, we randomly silence the expression of 30% of the genes.</p>
      <p>Subsequently, we employed INSIDER with and without considering the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> and SDA to decompose the matrix <italic toggle="yes">Z</italic>, and then evaluated their abilities to recover <italic toggle="yes">T</italic> using RMSE. For the implementation of SDA, the software provided by the original study [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] was used. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. Results for the comparison are shown in <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparison of performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to INSIDER.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t001" id="pgen.1011189.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">2.21</td>
                <td align="center" rowspan="1" colspan="1">2.12</td>
                <td align="center" rowspan="1" colspan="1">1.82</td>
                <td align="center" rowspan="1" colspan="1">1.84</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.10</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>, we see that SDA fails to capture the underlying relationship across different noise levels. Moreover, INSIDER without interaction outperforms SDA in recovering <italic toggle="yes">T</italic> using RMSE, even though both methods have a similar model complexity. Importantly, when considering the interactive effects between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic>, INSIDER demonstrates substantially better performance in recovering <italic toggle="yes">T</italic>, compared with SDA, even as the level of noise increases.</p>
      <p>To show the performance of INSIDER in case of model misspecification, we first included simulation studies of INSIDER under the situation where the simulation data is generated according to SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a tensor decomposition method. Specifically, we consider a tensor of gene expression <italic toggle="yes">Z</italic> of dimensions 50×5×200, which is generated according to <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <inline-formula id="pgen.1011189.e011"><alternatives><graphic xlink:href="pgen.1011189.e011.jpg" id="pgen.1011189.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Here the rank of latent space <italic toggle="yes">K</italic> is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The elements of Θ are generated from <italic toggle="yes">N</italic>(0, <italic toggle="yes">σ</italic>). In practice, we consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For the application of INSIDER to the simulated data, we flat the tensor <italic toggle="yes">Z</italic> by its first two dimensions and transform it into a 250×200 matrix. Then, we introduce two design matrices <inline-formula id="pgen.1011189.e012"><alternatives><graphic xlink:href="pgen.1011189.e012.jpg" id="pgen.1011189.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>and <inline-formula id="pgen.1011189.e013"><alternatives><graphic xlink:href="pgen.1011189.e013.jpg" id="pgen.1011189.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for the first two dimensions of <italic toggle="yes">Z</italic>, and the two design matrices are considered as covariates for INSIDER. Since SDA only has one hyperparameter, the latent rank <italic toggle="yes">K</italic> (<italic toggle="yes">num_comps</italic>), and does not allow missing entries, we adopt the following procedure in the simulation study. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. For INSIDER, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as validation set and consider the left data trainset, select the hyperparameters with which INSIDER trained on the trainset performs the best on the validation set, and run INSIDER with selected hyperparameters on <italic toggle="yes">Z</italic>. Then we compared the performance of INSIDER with and without interactions to SDA in recovering the true pattern <italic toggle="yes">T</italic> using RMSE. The results of the simulation studies are presented in <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of the performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to SDA.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t002" id="pgen.1011189.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">0.04</td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.22</td>
                <td align="center" rowspan="1" colspan="1">1.57</td>
                <td align="center" rowspan="1" colspan="1">2.10</td>
                <td align="center" rowspan="1" colspan="1">1.66</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>, we find that INSIDER without interaction did not perform well in the case of model misspecification. However, INSIDER with interaction demonstrated a performance similar to SDA, although the simulation data is generated according to the SDA model. This suggests that INSIDER performs well in the case of model specification when data is generated according to SDA.</p>
      <p>To further demonstrate the performance of INSIDER in case of model misspecification, we conducted further simulation analysis to examine its performance when the data is generated according to multivariate linear regression models. For illustration, the gene expression matrix <italic toggle="yes">Z</italic> of dimensions 100×200 is generated by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = <italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic>+<italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic>, <inline-formula id="pgen.1011189.e014"><alternatives><graphic xlink:href="pgen.1011189.e014.jpg" id="pgen.1011189.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1011189.e015"><alternatives><graphic xlink:href="pgen.1011189.e015.jpg" id="pgen.1011189.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the dummy matrices for two categorical variables, <italic toggle="yes">E</italic><sup>20×200</sup>,<italic toggle="yes">F</italic><sup>5×200</sup> are matrices for coefficients of the two categorical variables across 200 genes, and Θ<sup>100×200</sup> is the error matrix. In simulation, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are generated from <italic toggle="yes">N</italic>(0, 1) and Θ is generated from <italic toggle="yes">N</italic>(0,<italic toggle="yes">σ</italic>), where <italic toggle="yes">σ</italic> denotes the noise level. We consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For INSIDER, we incorporate two categorical variables as covariates without considering their interaction. For linear regression, we fit ridge regression with the two categorical variables as predictors and <italic toggle="yes">Z</italic> as responses. For a fair comparison, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as hold-out set, draw 10% of the elements of the left data without replacement as validation set, and consider other elements of the left data as trainset. To employ INSIDER and Ridge regression, we first train them on the trainset with different hyperparameters and select the parameters with which they perform the best on the validation set in terms of RMSE. Then, we fit them with the chosen hyperparameters on the left data (trainset + validation set) and report the RMSE of the fitted model on <italic toggle="yes">T</italic> for the testset. The baseline RMSE is the root-mean-square difference between <italic toggle="yes">T</italic> and the average of <italic toggle="yes">Z</italic> over the trainset and validation set. The results of the simulation are shown in <xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Performance of INSIDER in recovering <italic toggle="yes">T</italic> over the hold-out set using RMSE when the data is generated according to a multivariate linear model.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t003" id="pgen.1011189.t003g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Baseline</td>
                <td align="center" rowspan="1" colspan="1">1.4234</td>
                <td align="center" rowspan="1" colspan="1">1.4046</td>
                <td align="center" rowspan="1" colspan="1">1.4005</td>
                <td align="center" rowspan="1" colspan="1">1.4001</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Ridge regression</td>
                <td align="center" rowspan="1" colspan="1">0.1496</td>
                <td align="center" rowspan="1" colspan="1">0.2934</td>
                <td align="center" rowspan="1" colspan="1">0.4257</td>
                <td align="center" rowspan="1" colspan="1">0.5426</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">INSIDER</td>
                <td align="center" rowspan="1" colspan="1">0.1493</td>
                <td align="center" rowspan="1" colspan="1">0.2950</td>
                <td align="center" rowspan="1" colspan="1">0.4268</td>
                <td align="center" rowspan="1" colspan="1">0.5458</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref> shows that INSIDER performs similarly to ridge regression in terms of RMSE in recovering <italic toggle="yes">T</italic>. Moreover, compared with the baseline RMSE, INSIDER captures a large proportion of signals. This suggests that INSIDER performs well under the case of model specification when the simulated data is generated according to multivariate linear models.</p>
      <p>Further, we also explored the ability of INSIDER to handle missing values in simulation settings. There are mainly two types of missing in RNA-Seq studies. The first type is missing samples. For example, the biosamples of some tissues from donors are not available, and this leads to missing samples in RNA-Seq data. The second type is missing entries. That is, expression levels of some genes for samples are missing. In practice, the proportion of missing entries is usually small in RNA-Seq data. Here we studied the two types of missing in the simulation below.</p>
      <p>In our simulation study, we assume there are 50 donors with 2 different phenotypes, 8 tissues, and 1000 genes. The number of samples for our simulated data matrix is 400 (50×8). Moreover, we consider the interaction between phenotypes and tissues. In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (400×1000), and variation in the matrix comes from three biological variables (<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>), the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic>, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">R</italic>+Θ, where R = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub><italic toggle="yes">D</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub><italic toggle="yes">P</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub><italic toggle="yes">T</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub><italic toggle="yes">W</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, and <italic toggle="yes">T</italic> are matrices of dimensions 50×5, 2×5, and 8×5, respectively, and the dimension of <italic toggle="yes">W</italic> for the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic> is 16×5. <italic toggle="yes">V</italic> is a 5×1000 matrix for gene latent representations. All matrices for latent representation were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>} are <inline-formula id="pgen.1011189.e016"><alternatives><graphic xlink:href="pgen.1011189.e016.jpg" id="pgen.1011189.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e017"><alternatives><graphic xlink:href="pgen.1011189.e017.jpg" id="pgen.1011189.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e018"><alternatives><graphic xlink:href="pgen.1011189.e018.jpg" id="pgen.1011189.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e019"><alternatives><graphic xlink:href="pgen.1011189.e019.jpg" id="pgen.1011189.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (400×1000) was generated from a normal distribution <italic toggle="yes">N</italic> (0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. In the simulation, we considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1.</p>
      <p>To better mimic the complex missing samples in real settings, we consider the setting based on the distribution of brain structures and phenotypes of samples of 50 donors similar to the ageing, dementia, and TBI data. Among 50 donors, 27 are healthy, and the other 23 are affected by a specific disease. For each donor, at least 4 out of 8 tissues are available. Then, we had 229 samples available, and 171 (42.75%) samples were missing. For comparison, we also conducted simulation studies on the scenario where 42.75% of samples are missing at random. Further, to introduce missing entries in the data matrix of samples available, we randomly drew 5% of the elements from it as missing entries. To evaluate the performance of INSIDER in handling missing, we examined the RMSE between the estimated <inline-formula id="pgen.1011189.e020"><alternatives><graphic xlink:href="pgen.1011189.e020.jpg" id="pgen.1011189.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER and <italic toggle="yes">R</italic> over missing entries and samples, and the result is presented in <xref rid="pgen.1011189.t004" ref-type="table">Table 4</xref>. In the table, the baseline RMSE is the root-mean-square difference between <italic toggle="yes">R</italic> for missing entries or samples and the average of <italic toggle="yes">Z</italic> over nonmissing entries. Since the baseline RMSE for missing entries and samples are roughly the same, we only show the baseline RMSE for missing samples for illustration.</p>
      <table-wrap position="float" id="pgen.1011189.t004">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The baseline RMSE and RMSE of the estimated <inline-formula id="pgen.1011189.e021"><alternatives><graphic xlink:href="pgen.1011189.e021" id="pgen.1011189.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER against <italic toggle="yes">R</italic> on missing entries and samples across different simulation settings.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t004" id="pgen.1011189.t004g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">RMSE<break/>Noise</th>
                <th align="center" rowspan="1" colspan="1">Baseline</th>
                <th align="center" rowspan="1" colspan="1">Missing entries</th>
                <th align="center" rowspan="1" colspan="1">Random missing samples</th>
                <th align="center" rowspan="1" colspan="1">Missing samples (real)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.25</td>
                <td align="center" rowspan="1" colspan="1">4.5308</td>
                <td align="center" rowspan="1" colspan="1">0.0460</td>
                <td align="center" rowspan="1" colspan="1">0.0394</td>
                <td align="center" rowspan="1" colspan="1">0.0401</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">4.6308</td>
                <td align="center" rowspan="1" colspan="1">0.0907</td>
                <td align="center" rowspan="1" colspan="1">0.0780</td>
                <td align="center" rowspan="1" colspan="1">0.0803</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.75</td>
                <td align="center" rowspan="1" colspan="1">4.5998</td>
                <td align="center" rowspan="1" colspan="1">0.1397</td>
                <td align="center" rowspan="1" colspan="1">0.1207</td>
                <td align="center" rowspan="1" colspan="1">0.1206</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">4.4998</td>
                <td align="center" rowspan="1" colspan="1">0.1827</td>
                <td align="center" rowspan="1" colspan="1">0.1553</td>
                <td align="center" rowspan="1" colspan="1">0.1581</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From the table, we see that the RMSE for missing entries and samples increases slightly with increasing noise levels, and the RMSE for missing entries is slightly higher compared with the RMSE for missing samples. The RMSE for random missing samples and the designed missing samples based on the ageing, dementia, and TBI data is roughly the same. The simulation result suggests that the INSIDER has a good ability to recover underlying true patterns and the ability decreases slightly with increasing noise levels, even though complex missing exists.</p>
    </sec>
    <sec id="sec005">
      <title>Analysis of the BrainSpan data</title>
      <p>The BrainSpan study provides RNA-Seq data profiling up to sixteen cortical and subcortical structures across the entire course of human brain development [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>]. In this analysis, we aim to explore the development trajectories across human brain development, the BPs that function in different brain regions, and the involvement of brain regions in different development stages.</p>
      <p>The BrainSpan dataset was downloaded from the website provided in [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>]. The dimension of the data matrix for our analysis is 524×43411. In this analysis, we modeled development stages and brain regions as covariates but omitted interactions between development stages and brain regions, because many combinations of development stages and brain regions only have 1 or 0 RNA-seq sample, so inference of the interaction will be unreliable. For the definition of development stages, we follow the specifications defined in the original study [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>].</p>
      <p>In the application, even though the development stages are in chronological order, we consider development stages as unordered categorical variables. The main reason is that human brain development is nonlinear, so some metagenes may only be highly active in certain developmental stages and then are leveled down or turned off. For example, the study [<xref rid="pgen.1011189.ref024" ref-type="bibr">24</xref>] systematically discussed the development of different brain structures across developmental stages, suggesting that the development of brain structures is specific to certain development stages. For illustration, we denote <inline-formula id="pgen.1011189.e022"><alternatives><graphic xlink:href="pgen.1011189.e022.jpg" id="pgen.1011189.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>as the latent representations for development stages, brain regions, and genes, respectively. There are <italic toggle="yes">N</italic><sub>1</sub> development stages and <italic toggle="yes">N</italic><sub>2</sub> brain regions, and <italic toggle="yes">M</italic> is the number of genes included. The rank <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 19.</p>
    </sec>
    <sec id="sec006">
      <title>Metagenes reveal development trajectories</title>
      <p>We adopt the convention to consider the rows of <italic toggle="yes">V</italic> as metagenes [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. We first looked at <inline-formula id="pgen.1011189.e023"><alternatives><graphic xlink:href="pgen.1011189.e023.jpg" id="pgen.1011189.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which are the levels of expression of <italic toggle="yes">K</italic> metagenes across <italic toggle="yes">N</italic><sub>1</sub> developmental stages, and computed the variance of the expression levels of each metagene across <italic toggle="yes">N</italic><sub>1</sub> developmental stages (the variances are computed with the columns in <italic toggle="yes">D</italic>). We chose the most variable (16<sup>th</sup>), 2<sup>nd</sup>, and 17<sup>th</sup> metagenes. We visualized the trajectories of the selected metagenes across human brain development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Meanwhile, we see a rapid surge in the level of the 2<sup>nd</sup> metagene between late fetal and childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Additionally, the loading of the 17<sup>th</sup> metagene is high at the early fetal and fluctuates around zero at later stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>).</p>
      <fig position="float" id="pgen.1011189.g002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Downstream analyses with results from the application to the BrainSpan data.</title>
          <p>A. The trajectories of the selected metagene across human brain development are displayed in the left of panel A. The definition of stages is provided in the table on the right of panel A. B. The top 30 up-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is presented. C. The top 30 down-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is displayed. D. The top 30 up-regulated BPs in the primary motor and somatosensory cortex (M1C-S1C) are shown in panel D. E. The top 30 down-regulated BPs in the M1C-S1C are shown in panel E. F. Trajectories of the adjusted expression for the selected genes at the whole brain level are shown in panel F. The definition of stages in the figure is the same as in panel A.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g002" position="float"/>
      </fig>
      <p>To decode biological mechanisms behind these metagenes, we carried out enrichment analyses to find up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2C</xref>) biological processes (BPs) encoded by them. Specifically, for a given metagene <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, the <italic toggle="yes">i</italic>-th row of <italic toggle="yes">V</italic>, we examine the BPs enriched by genes with large effects, that is, the genes with large absolute values for <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, since these genes encode primary biological functions of the metagene. Therefore, enrichment analyses were conducted on the set of genes in the upper or lower 2.5% quantile of <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub> to explore up- or down-regulated BPs encoded by the metagene, respectively. Here up- or down-regulated BPs refer to BPs enriched by up- or down-regulated genes. Throughout our work, we use them to convey the meaning without loss of clarity. Other technical details for the enrichment analysis are presented in the Supplementary Content (<xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). The up- and down-regulated BPs for the 2<sup>nd</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1B Fig</xref>) and 17<sup>th</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C and S1D Fig</xref>) metagenes are also provided in <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1 Fig</xref>.</p>
      <p>On the one hand, a joint analysis of the trajectories of the (16<sup>th</sup>, 17<sup>th</sup>) metagenes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) with their corresponding up-regulated BPs shows that the embryo is under rapid differentiation and development at the early fetal (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C Fig</xref>) and that developments of brain regions, such as the hippocampus, pallium, and forebrain, are high before the mid-fetal period (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>). As core systems of the brain are established before birth [<xref rid="pgen.1011189.ref025" ref-type="bibr">25</xref>], levels of BPs involved in cell development, axonogenesis, myelination, and gliogenesis fall rapidly after the late fetal period (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2B</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C</xref>). The basic structure of human brains does not undergo substantial changes after birth, so we observed a decline in levels of BPs related to the development of brain regions, such as the forebrain, telencephalon, pallium, and hippocampus (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>). With its continued development, human brains mature well into the 20s [<xref rid="pgen.1011189.ref026" ref-type="bibr">26</xref>], corresponding to a relatively low level of these BPs in young adulthood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>).</p>
      <p>On the other hand, we observed that the BPs involved in learning, memory, and cognition are relatively low in fetal stages (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1D</xref>). With the development of human brains, we also noticed a rapid surge in the level of BPs related to learning, memory, and cognition during infancy (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A</xref>) and a stable rise in levels of these BPs after mid-fetal stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). After the maturation of human brains, these BPs maintain a high level (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). During the development of learning, memory, and cognition, new neural networks form in the brain [<xref rid="pgen.1011189.ref027" ref-type="bibr">27</xref>], and the level of neurotransmitters increases simultaneously [<xref rid="pgen.1011189.ref028" ref-type="bibr">28</xref>]. Our findings also show that the BPs involved in synaptic functions and neurotransmitter activities follow a similar trajectory as those of learning, memory, and cognition (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref>, <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1D</xref>).</p>
      <p>The trajectory of the least variable metagene is highly negative and flat across human brain development (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2A Fig</xref>). Subsequent enrichment analysis revealed that the down-regulated BPs enriched by metagene are involved in cell and ATP metabolism and cell communication (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>), which generally maintain a high level during brain development.</p>
    </sec>
    <sec id="sec007">
      <title>Metagenes characterize development stages and brain regions</title>
      <p>Previously, metagenes depicted the development trajectories of human brains. Moreover, metagenes also can characterize development stages and brain regions. This can be achieved by examining BPs enriched by metagenes with highly distinct values for development stages or brain regions. We highlighted several metagenes for demonstration (Tabs A and B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>).</p>
      <p>On the one hand, one metagene was highlighted to characterize development stages for demonstration. First, we observed that the expression level of the 5<sup>th</sup> metagene for the early mid-fetal (the 5<sup>th</sup> stage in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) is highly positive and much greater than for other stages (Tab A in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). Subsequently, the top up-regulated BPs by the 5<sup>th</sup> metagene involve ossification and development of bone, muscle, and sensory systems (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2C Fig</xref>). The results suggest that the mid-fetal period is vital for bone and muscle formation and contributes to sensory system development.</p>
      <p>On the other hand, we also highlighted one metagene to uncover the functions of brain regions. The loading of the 1st metagene for the striatum is highly positive. Furthermore, the absolute value of the metagene is much greater for the brain region than for other brain regions (Tab B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). As shown by subsequent enrichment analysis, the top 30 up-regulated BPs by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2D Fig</xref>), suggesting that the striatum is responsible for human emotion and cognition (e.g., reward system) [<xref rid="pgen.1011189.ref029" ref-type="bibr">29</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Reveal trajectories of genes expression across human brain development at the whole-brain level</title>
      <p>The development of the human brains is heterogenous across different individuals and not linear across different brain regions. Thus, the confounding variation from donors and tissues makes it difficult to reveal gene expression changes at the whole-brain level across human brain development. One can only show trajectories of gene expression in a tissue-wise manner, as displayed in the study [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>However, INSIDER allows us to obtain the ‘adjusted’ gene expression profiles across development stages by multiplying <italic toggle="yes">D</italic> with <italic toggle="yes">V</italic>. Note that variation from tissue and donor is controlled in the adjusted gene expression profiles, which cannot be readily computed from conventional approaches. Here we showed the trajectories of summarized expression changes for six selected genes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>), which are chosen from genes in the top and bottom of the expression profile for the most variable (16<sup>th</sup>) metagene selected previously.</p>
      <p>The left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref> showed that the trajectory of <italic toggle="yes">DCX</italic>, expressed in neuronal progenitor cells and immature migrating neurons, is similar to that of BPs involved in human brain development discussed previously and consistent with its trend in the hippocampus [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>Regarding <italic toggle="yes">Sox4</italic> and <italic toggle="yes">Sox11</italic>, known key controllers of embryonic and fetal development, our results suggested that they are expressed at high levels in the early development stages (left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). Furthermore, they also demonstrate a similar trajectory across human brain development in the panel.</p>
      <p>Both <italic toggle="yes">MBP</italic> and <italic toggle="yes">PLP1</italic> are involved in the myelination in the CNS, which is vital to cognition development and function and is largely completed in early adulthood [<xref rid="pgen.1011189.ref030" ref-type="bibr">30</xref>,<xref rid="pgen.1011189.ref031" ref-type="bibr">31</xref>]. Another gene <italic toggle="yes">NRGN</italic> regulates synaptic plasticity crucial for synaptic function [<xref rid="pgen.1011189.ref032" ref-type="bibr">32</xref>]. The trends of trajectories of the three genes are similar and upward (right panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). This observation is consistent with the development of cognition discussed previously.</p>
    </sec>
    <sec id="sec009">
      <title>Uncover biological mechanisms underlying the development of specific brain regions</title>
      <p>The tissue representation from INSIDER enables us to explore BPs in specific brain regions by computing their adjusted gene expression profiles. Specifically, the adjusted gene expression profiles for brain regions were obtained by multiplying <italic toggle="yes">T</italic> with <italic toggle="yes">V</italic>. In the multiplication, two metagenes with the least variance across different brain regions were excluded because they aggregate the expression of cell metabolic and ATP metabolic processes and cell communication. Thus, excluding them enables us better uncover BPs related to brain development.</p>
      <p>Then, we conducted enrichment analyses on the adjusted gene expression profile of M1C-S1C (primary motor and somatosensory cortex) to explore up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>) BPs for the brain region. We have no particular preference for specific brain region for further analysis; the main reason for choosing M1C-S1C for presentation is that its function is probably more specific and has less overlap with other regions, so the biological relevance of our approach can be better demonstrated.</p>
      <p>The M1C-S1C is mainly responsible for generating signals to direct the body’s movement and processing somatic sensations. The development of this region involves axonogenesis and regulation of neuron projection development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and thus increases connectivity between synapses. The levels of synaptic activities also increase with the increased connectivity [<xref rid="pgen.1011189.ref033" ref-type="bibr">33</xref>]. Therefore, it is reasonable to observe that BPs involved in synaptic activities, such as chemical synaptic transmission, trans−synaptic signaling, and synaptic plasticity, are upregulated in this brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>). However, the levels of gene expression for BPs involved in the development of human organs, such as the kidney, renal system, spinal cord, and sensory organ (e.g., inner ear and ear), are low in the brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>).</p>
      <p>In summary, through the analysis of the BrainSpan data, the advantages of INSIDER have been demonstrated. It enables analyzing gene expression data that cannot be readily formatted into 3D tensors, as there could be several observations for some combinations of brain regions and developmental stages. Our approach reveals the brain developmental trajectories by metagenes, and up- and down-regulated BPs encoded by the metagenes. Our method also characterizes the molecular basis underlying neurodevelopment for different brain regions and developmental stages by examining their underlying up- and down-regulated BPs. However, standard PCA- and especially GLM-based methods are unapplicable for these tasks in RNA-seq data analysis. Moreover, NMF may not be readily applicable as it is not straightforward to directly infer down-regulations of gene expression.</p>
    </sec>
    <sec id="sec010">
      <title>Analysis of the aging, dementia, and TBI data</title>
      <p>Dementia is a kind of neurodegenerative disorder, and there are various underlying causes. Traumatic brain injury (TBI) may lead to dementia, but the most common cause is Alzheimer’s disease (AD). The Aging, Dementia, and TBI Study aims to characterize neuropathologic, molecular, and transcriptomic changes in the brains of controls and TBI cases from an aged population-based cohort [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>], which offers RNA-Seq data of temporal cortex (TC), parietal cortex (PC), cortical white matter (WM), and hippocampus (HPC) of controls and TBI cases.</p>
      <p>We downloaded the aging, dementia, and TBI data from the website provided in [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>]. The dimension of our dataset is 377 × 44,477, and the RNA-seq samples come from 107 donors. In this analysis, we seek to explore BPs contributing to the progression of dementia and discover BPs contributing to dementia in specific brain structures. Here we modeled four covariates: donor, brain structure, diagnosis of dementia, and gene, and incorporated interactions between brain structures and phenotype (dementia diagnosis). The number of ranks <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 23.</p>
    </sec>
    <sec id="sec011">
      <title>Clustering analysis of donor representations</title>
      <p>It is challenging to perform clustering analysis in high-dimensional settings, for example, with high-dimensional omics data. However, INSIDER enables us to cluster donors with donor representations to characterize donors and even identify disease subtypes, which is in line with personalized treatment delivery. In practice, we performed hierarchical clustering with latent donor representations (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3A</xref>) without the least variable metagene, which encodes BPs related to ATP metabolic processes. We selected two as the number of clusters. Subsequently, we examined the clinical or demographic relevance of the clusters. The two-tailed standard (<italic toggle="yes">P</italic> = 0.0251) and rank-based ANOVA tests (<italic toggle="yes">P</italic> = 0.0185) indicate that the clustering memberships statistically correlate with donor age distribution. We note that age itself was not included as an input for clustering, yet our clustering primarily based on expression data is able to identify subgroups with important clinical differences (e.g., age).</p>
      <fig position="float" id="pgen.1011189.g003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Downstream analyses with results from the application to the aging, dementia, and TBI data.</title>
          <p>A. The figure shows the dendrogram of hierarchical clustering with donor representations. B. The top 30 down-regulated BPs enriched for the difference in gene expression between dementia and control are displayed. C. The top 30 down-regulated BPs enriched by the difference in gene expression of left HPC between dementia and control are presented.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g003" position="float"/>
      </fig>
      <p>We also explored whether donor representations enable us to reveal subgroups related to subtypes of dementia. Since not all metagenes are associated with dementia, we filtered off several metagenes that have little relevance to dementia by examining the relevance of the top 30 up- and down-regulated BPs to dementia by searching literatures. Then, we performed hierarchical clustering on donor representation with these kept metagenes. The dendrogram (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3A Fig</xref>) indicates three subgroups.</p>
      <p>Two-tailed standard (<italic toggle="yes">P</italic> = 0.0205) and rank-based (<italic toggle="yes">P</italic> = 0.0731) ANOVA tests yielded similar <italic toggle="yes">p</italic>-values when we examined the association between the clustering and age distribution. In further exploring its relevance to the clinical diagnoses of dementia, Fisher’s exact tests revealed that clusters have a statistically significant association with the Braak staging of dementia (<italic toggle="yes">P</italic> = 0.0025) and showed a trend of association with diagnoses of dementia by the NINCDS-ADRDA Alzheimer’s criteria (<italic toggle="yes">P</italic> = 0.108), one of the most widely used criteria in the diagnosis of Alzheimer’s disease. Note that clinical or pathological features related to staging are not used as input for the clustering, hence this serves as an ‘external validation’ of the validity of the clusters. In other words, our proposed clustering framework, primarily based on expression profiles with dimension reduction by INSIDER, might indeed be useful in identifying clinically distinct and meaningful subgroups, which are consistent with widely used clinical staging/diagnosis systems.</p>
    </sec>
    <sec id="sec012">
      <title>Metagenes reveal the biological mechanism of dementia</title>
      <p>Here we explored the BPs significantly down-regulated in dementia compared with controls to shed light on the mechanism of dementia. In practice, we selected the top 2 variable metagenes in phenotype representation, as they achieved the most significant <italic toggle="yes">p</italic>-values in the following enrichment analysis. Then, the adjusted gene expression profiles for dementia and control were obtained by multiplying phenotype representations by gene representation with only the selected metagenes. Subsequently, we examined down-regulated BPs enriched by the difference in gene expression between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>).</p>
      <p>The top 30 BPs enriched for down-regulated genes are statistically significant at the <italic toggle="yes">p&lt;</italic>5e-5 level. We observed that expression levels of genes for BPs involved in cognition, learning, and memory were significantly lower in the dementia brain than in the control brain (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). In addition, significant differences in BPs related to synaptic activities, such as trans-synaptic signaling, and chemical synaptic transmission, were also observed when comparing dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). This observation is supported by previous studies [<xref rid="pgen.1011189.ref035" ref-type="bibr">35</xref>–<xref rid="pgen.1011189.ref037" ref-type="bibr">37</xref>], suggesting that synaptic signaling and transmission play indispensable roles in the nervous system function, and their dysfunctions might be important contributing factors to dementia.</p>
      <p>Interestingly, expression levels of genes involved in ossification (bone tissue formation) are also significantly different between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). The connection between impaired bone microarchitecture or regeneration and dementia has been reported [<xref rid="pgen.1011189.ref038" ref-type="bibr">38</xref>]. Moreover, a degree of comorbidity of AD and osteoporosis is also supported by epidemiological studies [<xref rid="pgen.1011189.ref039" ref-type="bibr">39</xref>]. On the other hand, several BPs related to metal ions are also identified in the enrichment analysis (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>), suggesting that expression levels of genes involved in these BPs are lower in dementia than in normal. Since metal ions play essential roles in neurotransmitter synthesis and energy metabolism, their deficiencies may contribute to cognitive decline and memory loss [<xref rid="pgen.1011189.ref040" ref-type="bibr">40</xref>], which are the most common symptoms of dementia.</p>
    </sec>
    <sec id="sec013">
      <title>Metagenes characterize donors and functions of brain regions</title>
      <p>In addition to revealing the mechanism of dementia, metagenes can help us to characterize donors and reveal functions of brain regions among the aged donors.</p>
      <p>We first employed standard two-tailed t-tests to identify metagenes associated with donor characteristics. Statistical test results showed the most statistically significant difference in loadings for the 13<sup>th</sup> metagene between donors who experienced TBI with loss of consciousness (LOC) and those not experiencing TBI (<italic toggle="yes">P</italic> = 0.0242). Subsequent enrichment analysis with the 13<sup>th</sup> metagene reveals that the top 30 down-regulated BPs involve cognitive functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3B Fig</xref>), suggesting that experiencing TBI with LOC may be associated with cognitive dysfunction.</p>
      <p>For demonstration, we highlighted one metagene (17<sup>th</sup>) to reveal the functions of the white matter (WM) (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>) of the forebrain. The loadings of the 17<sup>th</sup> metagene are negative only for WMs of both the left and right forebrain (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>). Subsequent enrichment analysis with the 17<sup>th</sup> metagene revealed that the top 30 up-regulated BPs involve learning, memory, cognition, and synaptic functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3C Fig</xref>).</p>
      <p>This suggests that expression of genes involved in these BPs is relatively low in the WM of both the left and right forebrains, compared to other brain regions. Moreover, we noticed that the loading of this metagene is lower in the WM of the left forebrain than in its counterpart. However, this cannot help us lead to the claim that the WM of the left forebrain is less involved in these BPs than its counterpart, as a single metagene may not show the whole picture of the involvement of WMs.</p>
      <p>To further clarify the issue, we examined the top down-regulated BPs in WMs of the left and right forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E and S3F Fig</xref>, respectively). The BPs down-regulated in WM of the left forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E Fig</xref>) are slightly more statistically significant than those in the right counterpart (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3F Fig</xref>). On the other hand, the BPs down-regulated in both areas are basically the same. Our analysis suggests that both areas of the WM may similarly involve in dementia.</p>
    </sec>
    <sec id="sec014">
      <title>Incorporating the interaction improves INSIDER</title>
      <p>To verify that the performance of INSIDER is significantly improved by considering interaction, we conducted the following statistical test. Generally, performance on held-out data is considered a golden standard to evaluate model performance. Thus, we examine whether incorporating interaction terms improves the performance of INSIDER on held-out data using RMSE. First, we randomly drew 10% of the elements without replacement from the data matrix as testset and considered the left elements as trainset. Second, we followed the same procedure to select hyperparameters for INSIDER with and without the interaction term. Then, we ran INSIDER on the trainset with the selected hyperparameters 50 times for 30 iterations with different parameter initializations and reported their RMSE on the testset. Finally, we examined whether the RMSE of INSIDER with interaction is statistically significantly lower than that of INSIDER without interaction with a one-sided <italic toggle="yes">t</italic>-test. The <italic toggle="yes">p</italic>-value (<italic toggle="yes">p</italic>-value &lt; 2.2e-16) from the test suggests that incorporating interaction improves the performance of INSIDER. The mean with standard error for INSIDER with and without interaction are 0.2297+0.0001 and 0.2302+0.0001, respectively. To our knowledge, the relatively small improvement in RMSE is due to the fact that only a small proportion of genes contribute to the interaction between dementia and brain structures.</p>
    </sec>
    <sec id="sec015">
      <title>Discover heterogeneous effects of dementia on brain structures</title>
      <p>Here we further show that the interaction term improves model interpretation of INSIDER. As dementia was shown to have potentially heterogeneous effects on the left and right HPC at gene levels (Section II in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4 Fig</xref>), we seek to compare BPs down-regulated by dementia in the left and right HPC to clarify the issue further.</p>
      <p>Here we will highlight how INSIDER with interaction is useful in unraveling interactions between biological variables (in this case, dementia diagnosis × brain structure). Compared to controls, dementia is associated with changes in gene expression, but the degree of change may not be uniform across different brain structures/regions. For instance, dementia may increase the expression of gene <italic toggle="yes">X</italic> by 1 unit, and the expression is also, on average, elevated by 1 unit across brain regions. However, dementia could be associated with a 5-unit increase in gene <italic toggle="yes">X</italic> expression in region <italic toggle="yes">Y</italic>, due to the presence of an interaction.</p>
      <p>First, we used the left HPC as an example to show how to obtain BPs down-regulated by dementia. First, we multiplied the submatrix <italic toggle="yes">W</italic><sub><italic toggle="yes">k</italic></sub> of interaction representation corresponding to the left HPC by gene representation <italic toggle="yes">V</italic>. In the operation, several metagenes with the least variance in the submatrix were excluded. Technical details of metagene selection are provided in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>. Then, we examined the down-regulated BPs enriched by genes showing significant differences in expression in the left HPC between dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>). Similarly, BPs down-regulated by dementia in the right HPC can be obtained (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>).</p>
      <p>Overall, most down-regulated BPs are more significant in the left HPC (<italic toggle="yes">P</italic> at 1e-66 in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>) than in the right (<italic toggle="yes">P</italic> at 2e-57 in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>). Moreover, the gene ratio in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> is also greater than in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>. Here gene ratio is the proportion of genes enriched for a BP. Regarding BPs enriched for the two brain structures, there is little difference in general. This leads to a similar finding that the left and right HPC may be affected differently by dementia and supported by previous studies we discussed earlier.</p>
      <p>To summarize, INSIDER demonstrates the following advantages over existing methods in analyzing the aging, dementia, and TBI data. INSIDER enables clustering donors into disease subtypes. This task is inapplicable to GLM-based methods for DGE analysis. Moreover, INSIDER reduces dimension with respect to one variable (e.g., donor) while controlling for variation from other variables (e.g., brain regions) and helps gain insights into the interaction between brain regions and dementia diagnosis. However, PCA- and NMF-based methods are also not applicable for these tasks, as they cannot perform dimension reduction with respect to different covariates separately and consider the interaction between covariates. Moreover, tensor decomposition cannot be employed to explore the interaction, as there are several observations for different combinations of brain regions and diagnosis of dementia and thus the data cannot be formatted into order-3 tensors.</p>
    </sec>
    <sec id="sec016">
      <title>Computing time and memory requirements</title>
      <p>The computing time of INSIDER varies depending on the stopping criteria and computational resources allocated. In our study, with the defined stopping criteria, INSIDER takes approximately 5 hours and 8 hours to run the BrainSpan dataset (524×43,411) and the aging, dementia, and TBI dataset (377×44,477), respectively, when using 30 cores (Intel Xeon Gold 6230 CPU @2.10GHz).</p>
      <p>Owing to our implementation with RcppArmadillo for parallel computing, INSIDER has relatively low memory requirements. It requires less than 5GB of memory for the BrainSpan dataset and the aging, dementia, and TBI dataset.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Discussion</title>
    <p>We demonstrated the versatility and potential of INSIDER through applications in which various downstream analyses were performed. In the first application, the development trajectories across the human life span were revealed, and up- and down-regulated BPs underlying them were uncovered. Moreover, the implicated brain regions were characterized. In the other application, we explored the mechanisms contributing to dementia, identified subgroups among donors with latent donor representations, and examined the contribution of tissues (e.g., brain regions) to biological conditions (e.g., dementia). Our results are supported by the literature. For example, the interpretation of the development trajectories is consistent with findings from previous studies.</p>
    <p>INSIDER has the following advantages. First, it is general and flexible, in which covariates and interactions in modeling can be adjusted according to research interest. Second, it is versatile and interpretable in terms of downstream analysis. Various downstream analyses were carried out, such as revealing development trajectory, clustering donors, revealing disease mechanisms, and exploring interactions between covariates. Third, it encourages sparsity in gene representations by introducing elastic-net regularization, thus facilitating result interpretations. Fourth, it can capture interactions between covariates, common in biological settings. Finally, it has good scalability and allows missing values.</p>
    <p>Moreover, the advantages of INSIDER over existing methods have been demonstrated via applications. Compared with INSIDER, GLM-based methods for DGE analysis do not aim for dimension reduction and thus do not enable clustering donors in low-dimension, revealing developmental trajectories, and characterizing brain regions or development stages. Moreover, traditional PCA/factor analysis decomposes the variation of <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> by <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> = <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup>
<italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup>. Both <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup> and <italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> are unobserved. The <italic toggle="yes">L</italic> combines two or more variables into a single component/factor. Similarly, INSIDER combines several genes that tend to be co-expressed or work together to induce biological functions into a single metagene. Thus, <italic toggle="yes">V</italic> in INSIDER is analogous to <italic toggle="yes">L</italic> in factor analysis, the elements of <italic toggle="yes">V</italic> represent the effects of metagenes on individual genes, and the contribution of individual genes to each metagene is represented by the corresponding row of <italic toggle="yes">V</italic>. Moreover, INSIDER can be considered a generalization/extension of factor analysis, where the factors are modelled as being under the influence of some covariates. In INSIDER, we introduce a model of <italic toggle="yes">F</italic> in terms of covariates <italic toggle="yes">X</italic> by <italic toggle="yes">F</italic> = <italic toggle="yes">XB</italic>, where <italic toggle="yes">X</italic> is an indicator matrix of measured covariates and <italic toggle="yes">B</italic> is a matrix of coefficients. The covariates are classified into donor (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>), phenotype (<italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>), tissue (<italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>), and phenotype-by-tissue interactions (<italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>). However, these indicator matrices can be joined into a single matrix <italic toggle="yes">X</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>), if the coefficient matrices are also joined together into a single matrix <italic toggle="yes">B</italic> = (<italic toggle="yes">D</italic><sup>⊺</sup>,<italic toggle="yes">P</italic><sup>⊺</sup>,<italic toggle="yes">T</italic><sup>⊺</sup>,<italic toggle="yes">W</italic><sup>⊺</sup>)<sup>⊺</sup>. Thus, this gives the overall INSIDER model by <italic toggle="yes">Z</italic> = <italic toggle="yes">XBV</italic> + Θ. Different from PCA/factor analysis, INSIDER directly associates the covariates (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>) with the metagenes through the matrices <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>, and this provides insights on how covariates affect the biological pathways. However, the estimation of <italic toggle="yes">V</italic> in PCA/factor analysis is not guided by the covariates and thus it cannot directly associate the components/factors with the covariates. In addition, INSIDER enables computing adjusted expression profiles for covariates, thus uncovering the effect of covariates on gene expression. In contrast with INSIDER, standard NMF-based methods cannot model variation from <italic toggle="yes">multiple</italic> variables separately and capture their interaction. and unable directly infer down-regulation in biological settings, which impairs its interpretability. Compared with tensor decomposition, the closest analog of INSIDER, INSIDER also demonstrates its superiority through simulation studies and is able to handle the situation where the data matrix cannot be formatted into tensors, as demonstrated via applications. A more explicitly comparison of the above capabilities of INSIDER with those of the other methods is displayed in <xref rid="pgen.1011189.s008" ref-type="supplementary-material">S3 Table</xref>.</p>
    <p>Bulk RNA-Seq techniques are popular in studying tissue-specific expression profiles. Usually, confounding variables (covariates) are inevitably introduced in the RNA-Seq expression data. For example, GTEx [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] data contains confounding variables and other features leading to variations in expression, such as donor, gender, and age. However, few studies fully addressed the issue of <italic toggle="yes">multiple</italic> confounders or covariates while also achieving dimensionality reduction (DR). Existing approaches such as PCA, factor analysis, and non-negative matrix factorization only can reduce data dimensionality but have substantial limitations, as described above. The importance of an improved methodology to perform DR in high-dimensional data with <italic toggle="yes">multiple</italic> covariates has become more prominent with the increasing availability of RNA-seq data and the popularity of joint data analysis from different sources. For example, the PsychENCODE project [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>] is composited of several independent projects, such as ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>], CMC (the CommonMind Consortium) [<xref rid="pgen.1011189.ref041" ref-type="bibr">41</xref>], and BrainGVEX [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], with different study aims. INSIDER well addresses the challenge and takes account of sparsity in gene expression and the interaction between covariates simultaneously. More importantly, it has excellent interpretability and can be applied to large-scale data analysis.</p>
    <p>Meanwhile, we notice that the development stages are in chronological order. In practice, we consider them as unordered categorical variables because human brain development is nonlinear and the development of brain structures is specific to certain development stages, as we discussed previously. It is more reasonable to model development stages as unordered categorical variables. On the other hand, our simulation studies show that INSIDER can recover the monotonic trend for ordinal variables (Section VI in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Therefore, it is a feasible solution for INSIDER to consider ordinal variables as unordered categorical variables. It is ideal for INSIDER to consider ordinal variables explicitly. We would like to address this issue in future.</p>
    <p>Future works may also include further analysis of various bulk RNA-seq datasets and extend it to single-cell data analysis. In addition, further experimental studies to validate the findings from our applications will be an important future direction. We note that the biological findings should be considered tentative until further replicated by further experimental and clinical studies.</p>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Conclusion</title>
    <p>This article proposed a novel statistical approach, INSIDER, based on matrix decomposition, to model the variation contributed by confounding variables or covariates in bulk RNA-Seq data and decompose it into a shared low-rank latent space. The variation may originate differently, such as donor, gender, tissue, or other biological conditions. INSIDER is a general and flexible framework, which is robust to missing values. In particular, it can capture interactions between variables or covariates. Moreover, it encourages sparsity in latent representations by imposing the elastic net penalty, thus facilitating model interpretations. In our applications, various downstream analyses were carried out based on results from INSIDER. The broad applicability of INSIDER in biomedical and clinical settings was demonstrated in the applications.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec019">
    <title>Methods</title>
    <p>Here we propose INSIDER, based on additive matrix factorization, to decompose heterogeneous biological variation in RNA-Seq data into a low-rank latent space.</p>
    <sec id="sec020">
      <title>Model specifications</title>
      <p>Denote <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> as the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>. We assume that there are <italic toggle="yes">N</italic> observations, <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> is modelled as
<disp-formula id="pgen.1011189.e024"><alternatives><graphic xlink:href="pgen.1011189.e024.jpg" id="pgen.1011189.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>, <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>, <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>, <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the source information is unavailable. Note that the above equation incorporates the interaction effect between tissues and phenotypes via introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. The objective function that we seek to minimize for <xref rid="pgen.1011189.e024" ref-type="disp-formula">Eq 1</xref> is defined as
<disp-formula id="pgen.1011189.e025"><alternatives><graphic xlink:href="pgen.1011189.e025.jpg" id="pgen.1011189.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e026"><alternatives><graphic xlink:href="pgen.1011189.e026.jpg" id="pgen.1011189.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pgen.1011189.e027"><alternatives><graphic xlink:href="pgen.1011189.e027.jpg" id="pgen.1011189.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be represented with matrix notations. Let <italic toggle="yes">Z</italic> ∈ ℝ<sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> represent the data matrix for the expression profile of <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The matrices <inline-formula id="pgen.1011189.e028"><alternatives><graphic xlink:href="pgen.1011189.e028.jpg" id="pgen.1011189.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the rank <italic toggle="yes">K</italic> latent representations for <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, <italic toggle="yes">N</italic><sub>3</sub> tissues, <italic toggle="yes">N</italic><sub>2</sub> * <italic toggle="yes">N</italic><sub>3</sub> interactions, <italic toggle="yes">N</italic> observations, and <italic toggle="yes">M</italic> genes, respectively. <inline-formula id="pgen.1011189.e029"><alternatives><graphic xlink:href="pgen.1011189.e029.jpg" id="pgen.1011189.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are indicator matrices, representing the dummy design matrices for <italic toggle="yes">N</italic> samples. <italic toggle="yes"><inline-formula id="pgen.1011189.e030"><alternatives><graphic xlink:href="pgen.1011189.e030.jpg" id="pgen.1011189.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic> is an identity matrix, which can be ignored and is added for the consideration of consistency in notations. <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be rewritten as:
<disp-formula id="pgen.1011189.e031"><alternatives><graphic xlink:href="pgen.1011189.e031.jpg" id="pgen.1011189.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e032"><alternatives><graphic xlink:href="pgen.1011189.e032.jpg" id="pgen.1011189.e032g" position="anchor"/><mml:math id="M32" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e033"><alternatives><graphic xlink:href="pgen.1011189.e033.jpg" id="pgen.1011189.e033g" position="anchor"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Missing entries in <italic toggle="yes">Z</italic> are removed in the summation in the first line of the equation.</p>
    </sec>
    <sec id="sec021">
      <title>Model fitting</title>
      <p>Alternating block coordinate descent (BCD) was employed to optimize <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. In each iteration, we update all parameters of INSIDER sequentially. We repeat the process until the stop criteria meets.</p>
    </sec>
    <sec id="sec022">
      <title>Optimize the objective function</title>
      <p>First, we choose to maximize the objective function with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> in <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. By fixing all <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> and taking the derivative with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, we can have the update for <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> as follows
<disp-formula id="pgen.1011189.e034"><alternatives><graphic xlink:href="pgen.1011189.e034.jpg" id="pgen.1011189.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e035"><alternatives><graphic xlink:href="pgen.1011189.e035.jpg" id="pgen.1011189.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub> is the set of row indices of samples with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">j</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub>. Similarly, the update for <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub> can be derived as
<disp-formula id="pgen.1011189.e036"><alternatives><graphic xlink:href="pgen.1011189.e036.jpg" id="pgen.1011189.e036g" position="anchor"/><mml:math id="M36" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e037"><alternatives><graphic xlink:href="pgen.1011189.e037.jpg" id="pgen.1011189.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub> is the set of row indices of samples from tissue <italic toggle="yes">h</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">h</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub>. Likewise, we can have the update for <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>:
<disp-formula id="pgen.1011189.e038"><alternatives><graphic xlink:href="pgen.1011189.e038.jpg" id="pgen.1011189.e038g" position="anchor"/><mml:math id="M38" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e039"><alternatives><graphic xlink:href="pgen.1011189.e039.jpg" id="pgen.1011189.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub> is the set of row indices of samples from donor <italic toggle="yes">i</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">i</italic></sub> denote the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub>. Besides, the update for <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e040"><alternatives><graphic xlink:href="pgen.1011189.e040.jpg" id="pgen.1011189.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e041"><alternatives><graphic xlink:href="pgen.1011189.e041.jpg" id="pgen.1011189.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub> is the set of row indices of samples of tissue <italic toggle="yes">h</italic> with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">jh</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub>. Finally, the update for <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e042"><alternatives><graphic xlink:href="pgen.1011189.e042.jpg" id="pgen.1011189.e042g" position="anchor"/><mml:math id="M42" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e043"><alternatives><graphic xlink:href="pgen.1011189.e043.jpg" id="pgen.1011189.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pgen.1011189.e044"><alternatives><graphic xlink:href="pgen.1011189.e044.jpg" id="pgen.1011189.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the <italic toggle="yes">s</italic>-th row of <inline-formula id="pgen.1011189.e045"><alternatives><graphic xlink:href="pgen.1011189.e045.jpg" id="pgen.1011189.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is latent representation for the <italic toggle="yes">s</italic>-th sample.</p>
      <p>In the above, we derived the updates for <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>,<italic toggle="yes">U</italic> for categorical covariates. In fact, INSIDER can also handle continuous covariate. For illustration, let denote <italic toggle="yes">q</italic> is a vector of length <italic toggle="yes">K</italic> for latent representation for a continuous covariate, and <inline-formula id="pgen.1011189.e046"><alternatives><graphic xlink:href="pgen.1011189.e046.jpg" id="pgen.1011189.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the variable across <italic toggle="yes">N</italic> observations.</p>
      <disp-formula id="pgen.1011189.e047">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e047.jpg" id="pgen.1011189.e047g" position="anchor"/>
          <mml:math id="M47" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi mathvariant="script">L</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>q</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>T</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>W</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>U</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>V</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mo>|</mml:mo>
              <mml:mo>|</mml:mo>
              <mml:mi>Z</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mfenced>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>D</mml:mi>
                  </mml:msub>
                  <mml:mi>D</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>q</mml:mi>
                  </mml:msub>
                  <mml:msup>
                    <mml:mi>q</mml:mi>
                    <mml:mo>⊤</mml:mo>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msub>
                  <mml:mi>T</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>W</mml:mi>
                  </mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>U</mml:mi>
                  </mml:msub>
                  <mml:mi>U</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mi>V</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:msubsup>
                <mml:mo>|</mml:mo>
                <mml:mi>F</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e048">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e048.jpg" id="pgen.1011189.e048g" position="anchor"/>
          <mml:math id="M48" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>q</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>W</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>U</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e049">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e049.jpg" id="pgen.1011189.e049g" position="anchor"/>
          <mml:math id="M49" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <p>In the equation, the meaning of other notations is the same as in the manuscript. With other parameters fixed, the objective function with respect to <italic toggle="yes">q</italic> can be simplified as follows:
<disp-formula id="pgen.1011189.e050"><alternatives><graphic xlink:href="pgen.1011189.e050.jpg" id="pgen.1011189.e050g" position="anchor"/><mml:math id="M50" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mi>q</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>Tr</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo>∥</mml:mo><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e051"><alternatives><graphic xlink:href="pgen.1011189.e051.jpg" id="pgen.1011189.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> By minimizing the objective with respect to <italic toggle="yes">q</italic>, the update for <italic toggle="yes">q</italic> can be obtained by
<disp-formula id="pgen.1011189.e052"><alternatives><graphic xlink:href="pgen.1011189.e052.jpg" id="pgen.1011189.e052g" position="anchor"/><mml:math id="M52" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⊤</mml:mo></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>This feature has been incorporated into the software of INSIDER.</p>
      <p>When we seek to minimize the objective function defined by <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> with respect to <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub>, the <italic toggle="yes">m</italic>-th column of <italic toggle="yes">V</italic>, with all the other parameters fixed, the equation can be simplified into the following elastic net problem
<disp-formula id="pgen.1011189.e053"><alternatives><graphic xlink:href="pgen.1011189.e053.jpg" id="pgen.1011189.e053g" position="anchor"/><mml:math id="M53" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Here <inline-formula id="pgen.1011189.e054"><alternatives><graphic xlink:href="pgen.1011189.e054.jpg" id="pgen.1011189.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> is the expression levels of the <italic toggle="yes">m</italic>-th gene across the <italic toggle="yes">N</italic> samples, and missing entries in <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> are removed in the calculation. The randomized coordinate descent (RCD) algorithm proposed in Algorithm 1 in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> is employed to optimize each column of <italic toggle="yes">V</italic> in parallel.</p>
      <p>In practice, optimizing the subproblems defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> is computationally intensive. The safe rules for screening are adopted to accelerate the computation, which discard variables with coefficients that are shrunk to zero in optimization. To illustrate with <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref>, the rules defined by Eq. 24 in the study [<xref rid="pgen.1011189.ref042" ref-type="bibr">42</xref>] for discarding predictor <italic toggle="yes">j</italic> is
<disp-formula id="pgen.1011189.e055"><alternatives><graphic xlink:href="pgen.1011189.e055.jpg" id="pgen.1011189.e055g" position="anchor"/><mml:math id="M55" display="block" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pgen.1011189.e056"><alternatives><graphic xlink:href="pgen.1011189.e056.jpg" id="pgen.1011189.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic toggle="yes">u</italic><sub><italic toggle="yes">j</italic></sub> is the <italic toggle="yes">j</italic>-th column of <italic toggle="yes">U</italic>.</p>
    </sec>
    <sec id="sec023">
      <title>Initialization, hyperparameter tuning and the stopping criterion</title>
      <p>Regarding initialization of <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, <italic toggle="yes">T</italic>, <italic toggle="yes">W</italic>, <italic toggle="yes">U</italic>, <italic toggle="yes">V</italic> defined in the <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>, they are initiated from normal distribution <italic toggle="yes">N</italic>(0, 0.001). We consider the solution from the previous iteration as warm start for the subproblem defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> in optimization.</p>
      <p>In model selection, we use the following procedure to select the hyperparameters {<italic toggle="yes">K</italic>,<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>} for INSIDER. Specifically, we first randomly draw 10% of elements without replacement from the data matrix as testset and consider the left data as trainset. Only the trainset is used to train INSIDER, and the testset is independent from model training and utilized for model selection. Specifically, we first train INSIDER on the trainset and then examine whether our approximations for the testset by the trained model can well approximate their real values. This practice is also consistent with the idea of cross-validation, which performs model selection based on model performance on held-out data. In fact, it is also widely used in recommendation systems [<xref rid="pgen.1011189.ref043" ref-type="bibr">43</xref>] and matrix completion [<xref rid="pgen.1011189.ref044" ref-type="bibr">44</xref>]. To evaluate the performance of INSIDER with different hyperparameters, the root mean squared error (RMSE) on the testset is calculated, which measures the root averaged squared difference between the approximations from INSIDER and the real values, so a lower RMSE on the testset corresponds to a better model.</p>
      <p>In our applications, <italic toggle="yes">K</italic> was chosen from a sequence from 10 to 30 with step size 2. The range of <italic toggle="yes">K</italic> is enough in general and can be broadened to consider more complex models. For each try of <italic toggle="yes">K</italic> from the sequence, we run INSIDER for 30 iterations. In the process, <italic toggle="yes">λ</italic> is set to 0.1 to avoid singularity in matrix inverse, and <italic toggle="yes">α</italic> is fixed to 0. Then, we select the rank <italic toggle="yes">K</italic> corresponding to the lowest RMSE on the testset. Empirical evidence shows that 30 iterations are sufficient to give consistent selection results, compared with 50 iterations (Section IV in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Also, previous studies [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>] utilized a small number of iterations (e.g., 20 iterations) to select the rank <italic toggle="yes">K</italic> for the methods based on matrix factorization. Note that our method for selecting <italic toggle="yes">K</italic> is quite computationally efficient, since we set <italic toggle="yes">α</italic> = 0 and the update for all parameters can be computed in a closed form.</p>
      <p>After choosing <italic toggle="yes">K</italic>, we define a parameter grid for {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>}. For each set of candidate hyperparameters {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>},we also run alternating BCD for 30 iterations and choose the parameters with the best performance on the test set.</p>
      <p>In our study, the stopping criteria is defined as
<disp-formula id="pgen.1011189.e057"><alternatives><graphic xlink:href="pgen.1011189.e057.jpg" id="pgen.1011189.e057g" position="anchor"/><mml:math id="M57" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where <inline-formula id="pgen.1011189.e058"><alternatives><graphic xlink:href="pgen.1011189.e058.jpg" id="pgen.1011189.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ℒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>·</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes the loss at the <italic toggle="yes">i</italic>-th iteration, and <italic toggle="yes">δ</italic> is a predefined threshold and set to 10<sup>−10</sup> in our experiment.</p>
    </sec>
  </sec>
  <sec id="sec024" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pgen.1011189.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary Content.</title>
        <p>It provides technical details on enrichment analysis, gene selection in comparing expression differences between dementia and control across brain regions, and metagene selection for discovering heterogeneous effects of dementia on brain structures. Regarding the model selection of INSIDER, it demonstrates the effect of different numbers of iterations (e.g., 30, 50) on model selection. It also shows the capability of INSIDER to handle ordinal variables via simulation studies. Regarding the difference between INSIDER and PCA/factor analysis or GLM-based approaches, it presents an in-depth discussion on their differences. To demonstrate its wide applicability, results from analyzing gender differences in gene expression of the human brain with GTEx using INSIDER are provided. Further, derivations for random coordinate descent for elastic net problems and the RCD algorithm (Algorithm 1) for the elastic net with screening rules are also presented.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s001.docx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The top 30 up- and down-regulated BPs enriched by the 2nd and 17th metages.</title>
        <p>The top 30 up-regulated BPs (S1A Fig) enriched by the 2nd metagene and down-regulated BPs (S1D Fig) by the 17th metagene are related to learning, memory, cognition, and synaptic functions and neurotransmitter activities. The top 30 down-regulated BPs (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>) enriched by the 2nd metagene involve axon development, axonogenesis, myelination, and gliogenesis. The top 30 up-regulated BPs (S1C Fig) by the 17th metagene cover the BPs related to cell development and differentiation.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s002.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The trajectory of the least variable metagene and top 30 BPs enriched by metagenes.</title>
        <p>S2A Fig shows that the trajectory of the least variable metagene is negative and basically flat across human brain development. The top 30 down-regulated BPs (S2B Fig) encoded by the metagene involve cell and ATP metabolism and cell communication. Moreover, the top 30 up-regulated BPs (S2C Fig) enriched by the 5th metagene involve ossification and development of bone, muscle, and sensory systems, and the top 30 up-regulated BPs (S2D Fig) by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s003.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Supplement Figs for analysis of the aging, dementia, and TBI data.</title>
        <p>S3A Fig shows the dendrogram of hierarchical clustering on donor representation with the selected metagenes. We selected 3 subgroups for further analysis. The top 30 down-regulated BPs (S3B Fig) enriched by the 13th metagene involve cognitive functions, and the top 30 up-regulated BPs (S3C Fig) enriched by the 17th cover learning, memory, cognition, and synaptic functions. S3D Fig shows the top 30 down-regulated BPs enriched by the difference in gene expression of right HPC between dementia and control. Overall, the <italic toggle="yes">p</italic>-values for most down-regulated BPs in S3D Fig are significant at 2e-57, which are greater than those for the left HPC shown in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> from the manuscript (<italic toggle="yes">P</italic> at 1e-66). Moreover, the gene ratio in S3D Fig is also smaller than in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>. This leads to the finding that the left and right HPC may be affected differently by dementia. S3E and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4F</xref> Figs show the top 30 down-regulated BPs enriched by the difference in expression profiles for WM of the left and right forebrain, respectively. The BPs in S3E Fig are slightly more statistically significant than those in S3F Fig and the BPs in the two figures are basically the same.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s004.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s005" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Comparison of differences in the expression of three selected genes between dementia and control across brain regions.</title>
        <p>The figure compares the expression levels of three selected genes (NRGN, CAMK2A, and SHISA6) between dementia and control across brain regions, suggesting that dementia has potentially heterogeneous effects on the left and right HPC at gene levels.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s005.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s006" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Tab A. The loadings of all metagenes across brain development stages in the analysis of the BrainSpan dataset.</title>
        <p>The table shows that the loading of the 5th metagene for the early-mid fetal stage (the 5th stage) is highly positive, and its absolute value is much larger than that of the metagene for other developmental stages. Thus, the 5th metagene can be used to characterize the stage. <bold>Tab B. The loadings of all metagenes across all brain regions in the analysis of the BrainSpan dataset.</bold> The table shows that the loading of the 1st metagene for the striatum is highly positive, and its absolute value is much larger than that of the metagene for other brain regions. Thus, the 1st metagene can be used to characterize the brain region.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s007" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The loadings of all metagenes across all brain regions in the analysis of the aging, dementia, and TBI dataset.</title>
        <p>The table shows that the loadings of the 17th metagene are only negative for FWM (both left and right) and their absolute value is much larger than those for other brain regions. Therefore, this metagene can be utilized to reveal the functions of FWM in the brains of aged donors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s008" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Comparison of INSIDER with the other methods in their capabilities in accommodating different situations in the analysis of gene expression data.</title>
        <p>In the table, we compare INSIDER with other methods, including PCA/NMF, SDA, and the GLM-based methods for DEG analysis, in their abilities to handle more than 3-dimensional data, to incorporate interaction, to allow missing data, to reduce data dimensionality, to perform differential expression analysis, and to handle multidimensional (&gt; = 3 dimensions) data that cannot fit into tensors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s008.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1011189.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>. <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature reviews genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>57</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><?supplied-pmid 19015660?><pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lonsdale</surname><given-names>J</given-names></name>, <name><surname>Thomas</surname><given-names>J</given-names></name>, <name><surname>Salvatore</surname><given-names>M</given-names></name>, <name><surname>Phillips</surname><given-names>R</given-names></name>, <name><surname>Lo</surname><given-names>E</given-names></name>, <name><surname>Shad</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>(<issue>6</issue>):<fpage>580</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><?supplied-pmid 23715323?><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Ding</surname><given-names>S</given-names></name>, <name><surname>Sunkin</surname><given-names>SM</given-names></name>, <name><surname>Smith</surname><given-names>KA</given-names></name>, <name><surname>Ng</surname><given-names>L</given-names></name>, <name><surname>Szafer</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional landscape of the prenatal human brain</article-title>. <source>Nature</source>. <year>2014</year>;<volume>508</volume>(<issue>7495</issue>):<fpage>199</fpage>–<lpage>206</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature13185</pub-id><?supplied-pmid 24695229?><pub-id pub-id-type="pmid">24695229</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Akbarian</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Knowles</surname><given-names>JA</given-names></name>, <name><surname>Vaccarino</surname><given-names>FM</given-names></name>, <name><surname>Farnham</surname><given-names>PJ</given-names></name>, <name><surname>Crawford</surname><given-names>GE</given-names></name>, <etal>et al</etal>. <article-title>The psychencode project</article-title>. <source>Nat Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1707</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nn.4156</pub-id><?supplied-pmid 26605881?><pub-id pub-id-type="pmid">26605881</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Voineagu</surname><given-names>I</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Johnston</surname><given-names>P</given-names></name>, <name><surname>Lowe</surname><given-names>JK</given-names></name>, <name><surname>Tian</surname><given-names>Y</given-names></name>, <name><surname>Horvath</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Transcriptomic analysis of autistic brain reveals convergent molecular pathology</article-title>. <source>Nature</source>. <year>2011</year>;<volume>474</volume>(<issue>7351</issue>):<fpage>380</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10110</pub-id><?supplied-pmid 21614001?><pub-id pub-id-type="pmid">21614001</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ha</surname><given-names>S</given-names></name>, <name><surname>Sohn</surname><given-names>I</given-names></name>, <name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Sim</surname><given-names>HJ</given-names></name>, <name><surname>Cheon</surname><given-names>K</given-names></name>. <article-title>Characteristics of brains in autism spectrum disorder: structure, function and connectivity across the lifespan</article-title>. <source>Experimental neurobiology</source>. <year>2015</year>;<volume>24</volume>(<issue>4</issue>):<fpage>273</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.5607/en.2015.24.4.273</pub-id><?supplied-pmid 26713076?><pub-id pub-id-type="pmid">26713076</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lord</surname><given-names>C</given-names></name>, <name><surname>Cook</surname><given-names>EH</given-names></name>, <name><surname>Leventhal</surname><given-names>BL</given-names></name>, <name><surname>Amaral</surname><given-names>DG</given-names></name>. <article-title>Autism spectrum disorders</article-title>. <source>Neuron</source>. <year>2000</year>;<volume>28</volume>(<issue>2</issue>):<fpage>355</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/s0896-6273(00)00115-x</pub-id><?supplied-pmid 11144346?><pub-id pub-id-type="pmid">11144346</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ritchie</surname><given-names>ME</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Wu</surname><given-names>DI</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>. <article-title>Differential expression analysis for sequence count data</article-title>. <source>Nature Precedings</source>. <year>2010</year>:<fpage>1</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Duchi</surname><given-names>J</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous dimension reduction and adjustment for confounding variation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>51</issue>):<fpage>14662</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1617317113</pub-id><?supplied-pmid 27930330?><pub-id pub-id-type="pmid">27930330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>X</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>. <article-title>Batch effects correction with unknown subtypes</article-title>. <source>Journal of the American Statistical Association</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>WE</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Rabinovic</surname><given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name>. <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>. <year>1999</year>;<volume>401</volume>(<issue>6755</issue>):<fpage>788</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/44565</pub-id><?supplied-pmid 10548103?><pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Qian</surname><given-names>K</given-names></name>, <name><surname>Fu</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>WV</given-names></name>. <article-title>scINSIGHT for interpreting single-cell gene expression from biologically heterogeneous data</article-title>. <source>Genome Biol</source>. <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">34980209</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Gao</surname><given-names>C</given-names></name>, <name><surname>Sodicoff</surname><given-names>J</given-names></name>, <name><surname>Kozareva</surname><given-names>V</given-names></name>, <name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Welch</surname><given-names>JD</given-names></name>. <article-title>Jointly defining cell types from multiple single-cell datasets using LIGER</article-title>. <source>Nature protocols</source>. <year>2020</year>;<volume>15</volume>(<issue>11</issue>):<fpage>3632</fpage>–<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41596-020-0391-8</pub-id><?supplied-pmid 33046898?><pub-id pub-id-type="pmid">33046898</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name>, <name><surname>Arora</surname><given-names>R</given-names></name>, <name><surname>Culhane</surname><given-names>AC</given-names></name>, <name><surname>Favorov</surname><given-names>AV</given-names></name>, <name><surname>Garmire</surname><given-names>LX</given-names></name>, <name><surname>Greene</surname><given-names>CS</given-names></name>, <etal>et al</etal>. <article-title>Enter the matrix: factorization uncovers knowledge from omics</article-title>. <source>Trends in Genetics</source>. <year>2018</year>;<volume>34</volume>(<issue>10</issue>):<fpage>790</fpage>–<lpage>805</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2018.07.003</pub-id><?supplied-pmid 30143323?><pub-id pub-id-type="pmid">30143323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kolda</surname><given-names>TG</given-names></name>, <name><surname>Bader</surname><given-names>BW</given-names></name>. <article-title>Tensor decompositions and applications</article-title>. <source>SIAM Rev</source>. <year>2009</year>;<volume>51</volume>(<issue>3</issue>):<fpage>455</fpage>–<lpage>500</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hoff</surname><given-names>PD</given-names></name>. <article-title>Hierarchical multilinear models for multiway data</article-title>. <source>Comput Stat Data Anal</source>. <year>2011</year>;<volume>55</volume>(<issue>1</issue>):<fpage>530</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Yener</surname><given-names>B</given-names></name>, <name><surname>Acar</surname><given-names>E</given-names></name>, <name><surname>Aguis</surname><given-names>P</given-names></name>, <name><surname>Bennett</surname><given-names>K</given-names></name>, <name><surname>Vandenberg</surname><given-names>SL</given-names></name>, <name><surname>Plopper</surname><given-names>GE</given-names></name>. <article-title>Multiway modeling and analysis in stem cell systems biology</article-title>. <source>BMC systems biology</source>. <year>2008</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1752-0509-2-63</pub-id><?supplied-pmid 18625054?><pub-id pub-id-type="pmid">18171472</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hore</surname><given-names>V</given-names></name>, <name><surname>Vinuela</surname><given-names>A</given-names></name>, <name><surname>Buil</surname><given-names>A</given-names></name>, <name><surname>Knight</surname><given-names>J</given-names></name>, <name><surname>McCarthy</surname><given-names>MI</given-names></name>, <name><surname>Small</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Tensor decomposition for multiple-tissue gene expression experiments</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>9</issue>):<fpage>1094</fpage>–<lpage>100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3624</pub-id><?supplied-pmid 27479908?><pub-id pub-id-type="pmid">27479908</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the royal statistical society: series B (statistical methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Brunet</surname><given-names>J</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Golub</surname><given-names>TR</given-names></name>, <name><surname>Mesirov</surname><given-names>JP</given-names></name>. <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proceedings of the national academy of sciences</source>. <year>2004</year>;<volume>101</volume>(<issue>12</issue>):<fpage>4164</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id><?supplied-pmid 15016911?><pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HJ</given-names></name>, <name><surname>Kawasawa</surname><given-names>YI</given-names></name>, <name><surname>Cheng</surname><given-names>F</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal transcriptome of the human brain</article-title>. <source>Nature</source>. <year>2011</year>;<volume>478</volume>(<issue>7370</issue>):<fpage>483</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10523</pub-id><?supplied-pmid 22031440?><pub-id pub-id-type="pmid">22031440</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Stiles</surname><given-names>J</given-names></name>, <name><surname>Jernigan</surname><given-names>TL</given-names></name>. <article-title>The basics of brain development</article-title>. <source>Neuropsychol Rev</source>. <year>2010</year>;<volume>20</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11065-010-9148-4</pub-id><?supplied-pmid 21042938?><pub-id pub-id-type="pmid">21042938</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Thomason</surname><given-names>ME</given-names></name>, <name><surname>Hect</surname><given-names>J</given-names></name>, <name><surname>Waller</surname><given-names>R</given-names></name>, <name><surname>Manning</surname><given-names>JH</given-names></name>, <name><surname>Stacks</surname><given-names>AM</given-names></name>, <name><surname>Beeghly</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Prenatal neural origins of infant motor development: Associations between fetal brain and infant motor development</article-title>. <source>Dev Psychopathol</source>. <year>2018</year>;<volume>30</volume>(<issue>3</issue>):<fpage>763</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1017/S095457941800072X</pub-id><?supplied-pmid 30068433?><pub-id pub-id-type="pmid">30068433</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>SB</given-names></name>, <name><surname>Blum</surname><given-names>RW</given-names></name>, <name><surname>Giedd</surname><given-names>JN</given-names></name>. <article-title>Adolescent maturity and the brain: the promise and pitfalls of neuroscience research in adolescent health policy</article-title>. <source>Journal of adolescent health</source>. <year>2009</year>;<volume>45</volume>(<issue>3</issue>):<fpage>216</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jadohealth.2009.05.016</pub-id><?supplied-pmid 19699416?><pub-id pub-id-type="pmid">19699416</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kennedy</surname><given-names>MB</given-names></name>. <article-title>Synaptic signaling in learning and memory</article-title>. <source>Cold Spring Harbor perspectives in biology</source>. <year>2016</year>;<volume>8</volume>(<issue>2</issue>):<fpage>a016824</fpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Herlenius</surname><given-names>E</given-names></name>, <name><surname>Lagercrantz</surname><given-names>H</given-names></name>. <article-title>Development of neurotransmitter systems during critical periods</article-title>. <source>Exp Neurol</source>. <year>2004</year>;<volume>190</volume>:<fpage>8</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.expneurol.2004.03.027</pub-id><?supplied-pmid 15498537?><pub-id pub-id-type="pmid">15498537</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Balleine</surname><given-names>BW</given-names></name>, <name><surname>Delgado</surname><given-names>MR</given-names></name>, <name><surname>Hikosaka</surname><given-names>O</given-names></name>. <article-title>The role of the dorsal striatum in reward and decision-making</article-title>. <source>Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>(<issue>31</issue>):<fpage>8161</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1554-07.2007</pub-id><?supplied-pmid 17670959?><pub-id pub-id-type="pmid">17670959</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Siems</surname><given-names>SB</given-names></name>, <name><surname>Kusch</surname><given-names>K</given-names></name>, <name><surname>Hesse</surname><given-names>D</given-names></name>, <name><surname>Jung</surname><given-names>RB</given-names></name>, <name><surname>Liepold</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>The CNS myelin proteome: deep profile and persistence after post-mortem delay</article-title>. <source>Frontiers in Cellular Neuroscience</source>. <year>2020</year>;<volume>14</volume>:<fpage>239</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fncel.2020.00239</pub-id><?supplied-pmid 32973451?><pub-id pub-id-type="pmid">32973451</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Tenzer</surname><given-names>S</given-names></name>, <name><surname>Werner</surname><given-names>HB</given-names></name>. <article-title>Myelin proteomics: molecular anatomy of an insulating sheath</article-title>. <source>Mol Neurobiol</source>. <year>2009</year>;<volume>40</volume>:<fpage>55</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12035-009-8071-2</pub-id><?supplied-pmid 19452287?><pub-id pub-id-type="pmid">19452287</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Shamir</surname><given-names>A</given-names></name>, <name><surname>Kwon</surname><given-names>O</given-names></name>, <name><surname>Karavanova</surname><given-names>I</given-names></name>, <name><surname>Vullhorst</surname><given-names>D</given-names></name>, <name><surname>Leiva-Salcedo</surname><given-names>E</given-names></name>, <name><surname>Janssen</surname><given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>The importance of the NRG-1/ErbB4 pathway for synaptic plasticity and behaviors associated with psychiatric disorders</article-title>. <source>Journal of Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>9</issue>):<fpage>2988</fpage>–<lpage>97</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1899-11.2012</pub-id><?supplied-pmid 22378872?><pub-id pub-id-type="pmid">22378872</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Fauth</surname><given-names>M</given-names></name>, <name><surname>Wörgötter</surname><given-names>F</given-names></name>, <name><surname>Tetzlaff</surname><given-names>C</given-names></name>. <article-title>The formation of multi-synaptic connections by the interaction of synaptic and structural plasticity and their functional consequences</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004031</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004031</pub-id><?supplied-pmid 25590330?><pub-id pub-id-type="pmid">25590330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Guillozet-Bongaarts</surname><given-names>A</given-names></name>, <name><surname>Gibbons</surname><given-names>LE</given-names></name>, <name><surname>Postupna</surname><given-names>N</given-names></name>, <name><surname>Renz</surname><given-names>A</given-names></name>, <name><surname>Beller</surname><given-names>AE</given-names></name>, <etal>et al</etal>. <article-title>Neuropathological and transcriptomic characteristics of the aged brain</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e31126</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.31126</pub-id><?supplied-pmid 29120328?><pub-id pub-id-type="pmid">29120328</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Torres</surname><given-names>DMC</given-names></name>, <name><surname>Cardenas</surname><given-names>FP</given-names></name>. <article-title>Synaptic plasticity in Alzheimer’s disease and healthy aging</article-title>. <source>Rev Neurosci</source>. <year>2020</year>;<volume>31</volume>(<issue>3</issue>):<fpage>245</fpage>–<lpage>68</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1515/revneuro-2019-0058</pub-id><?supplied-pmid 32250284?><pub-id pub-id-type="pmid">32250284</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Clare</surname><given-names>R</given-names></name>, <name><surname>King</surname><given-names>VG</given-names></name>, <name><surname>Wirenfeldt</surname><given-names>M</given-names></name>, <name><surname>Vinters</surname><given-names>HV</given-names></name>. <article-title>Synapse loss in dementias</article-title>. <source>J Neurosci Res</source>. <year>2010</year>;<volume>88</volume>(<issue>10</issue>):<fpage>2083</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/jnr.22392</pub-id><?supplied-pmid 20533377?><pub-id pub-id-type="pmid">20533377</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Colom-Cadena</surname><given-names>M</given-names></name>, <name><surname>Spires-Jones</surname><given-names>T</given-names></name>, <name><surname>Zetterberg</surname><given-names>H</given-names></name>, <name><surname>Blennow</surname><given-names>K</given-names></name>, <name><surname>Caggiano</surname><given-names>A</given-names></name>, <name><surname>DeKosky</surname><given-names>ST</given-names></name>, <etal>et al</etal>. <article-title>The clinical promise of biomarkers of synapse damage or loss in Alzheimer’s disease</article-title>. <source>Alzheimer’s research &amp; therapy</source>. <year>2020</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13195-020-00588-4</pub-id><?supplied-pmid 32122400?><pub-id pub-id-type="pmid">32122400</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>M</given-names></name>, <name><surname>Hu</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>. <article-title>Alzheimer’s disease and impaired bone microarchitecture, regeneration and potential genetic links</article-title>. <source>Life</source>. <year>2023</year>;<volume>13</volume>(<issue>2</issue>):<fpage>373</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/life13020373</pub-id><?supplied-pmid 36836731?><pub-id pub-id-type="pmid">36836731</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>L</given-names></name>, <name><surname>Zeng</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>APP promotes osteoblast survival and bone formation by regulating mitochondrial function and preventing oxidative stress</article-title>. <source>Cell death &amp; disease</source>. <year>2018</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41419-018-1123-7</pub-id><?supplied-pmid 30349052?><pub-id pub-id-type="pmid">29298988</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hackett</surname><given-names>MJ</given-names></name>, <name><surname>Hollings</surname><given-names>AL</given-names></name>, <name><surname>Lam</surname><given-names>V</given-names></name>, <name><surname>Takechi</surname><given-names>R</given-names></name>, <name><surname>Mamo</surname><given-names>JC</given-names></name>, <name><surname>de Jonge</surname><given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Metallo-maze to Memory Loss: Does Neuronal Metal Ion Deficiency Contribute to Dementia? Yakugaku Zasshi</article-title>: <source>Journal of the Pharmaceutical Society of Japan</source>. <year>2021</year>;<volume>141</volume>(<issue>6</issue>):<fpage>835</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">34078791</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>GE</given-names></name>, <name><surname>Bendl</surname><given-names>J</given-names></name>, <name><surname>Voloudakis</surname><given-names>G</given-names></name>, <name><surname>Montgomery</surname><given-names>KS</given-names></name>, <name><surname>Sloofman</surname><given-names>L</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>CommonMind Consortium provides transcriptomic and epigenomic data for Schizophrenia and Bipolar Disorder</article-title>. <source>Scientific data</source>. <year>2019</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30647409</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Bien</surname><given-names>J</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Simon</surname><given-names>N</given-names></name>, <name><surname>Taylor</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Strong rules for discarding predictors in lasso-type problems</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2012</year>;<volume>74</volume>(<issue>2</issue>):<fpage>245</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01004.x</pub-id><?supplied-pmid 25506256?><pub-id pub-id-type="pmid">25506256</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>Y</given-names></name>, <name><surname>Bell</surname><given-names>R</given-names></name>, <name><surname>Volinsky</surname><given-names>C</given-names></name>. <article-title>Matrix factorization techniques for recommender systems</article-title>. <source>Computer</source>. <year>2009</year>;<volume>42</volume>(<issue>8</issue>):<fpage>30</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Mazumder</surname><given-names>R</given-names></name>, <name><surname>Lee</surname><given-names>JD</given-names></name>, <name><surname>Zadeh</surname><given-names>R</given-names></name>. <article-title>Matrix completion and low-rank SVD via fast alternating least squares</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>3367</fpage>–<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10208-009-9045-5</pub-id><?supplied-pmid 31130828?><pub-id pub-id-type="pmid">31130828</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Nov 2023</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>Thank you very much for submitting your Methods entitled 'INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis' to PLOS Genetics.</p>
    <p>The manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some concerns about the current manuscript. Based on the reviews, we will not be able to accept this version of the manuscript, but we would be willing to review a much-revised version. We cannot, of course, promise publication at that time.</p>
    <p>Should you decide to revise the manuscript for further consideration here, your revisions should address the specific points made by each reviewer. We will also require a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>If you decide to revise the manuscript for further consideration at PLOS Genetics, please aim to resubmit within the next 60 days, unless it will take extra time to address the concerns of the reviewers, in which case we would appreciate an expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments are included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist" ext-link-type="uri">Submission Checklist</ext-link>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>Please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link xlink:href="http://pace.apexcovantage.com/" ext-link-type="uri">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool.  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>PLOS has incorporated <ext-link xlink:href="http://www.crossref.org/crosscheck.html" ext-link-type="uri">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, use the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage. Please do not hesitate to contact us if you have any concerns or questions.</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This article proposed a dimension reduction approach for RNA expression data to decompose variation from different biological variables, which overcomes some limitations of the existing methods and was shown to be useful in the real data analysis. My comments are as follows.</p>
    <p>1. It is still not very clear to me how to interpret the metagenes together with the covariates, especially the matrix V. Because it seems that V has nothing to do with the covariates, but the metagenes from INSIDER would be different under the models with different covariates. Also, what is the difference in the interpretation of the metagenes obtained from INSIDER compared to those obtained from PCA or factor analysis?</p>
    <p>2. The article mentioned that “INSIDER decomposes variation from different biological variables”, but only the discrete covariates have been discussed. Is INSIDER also able to handle the continuous covariates?</p>
    <p>3. In the real data analysis of BrainSpan data, development stages and brain regions are used as covariates. However, the development stages are in chronological order. Does INSIDER handle the ordinal variables and the unordered categorical variables in the same manner?</p>
    <p>4. In the section “Metagenes reveal development trajectories”, it said “The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood”. I wonder how the expression level of the metagene is calculated. Is there an explicit formula of the metagene? Could the author give more details?</p>
    <p>5. In the enrichment analyse for a metagene, say the 2nd metagene, it is not clear to me how to conduct the analyse because the metagene is a latent variable. It would be beneficial if more details could be provided.</p>
    <p>Reviewer #2: Dimension reduction is critically important in data exploration analysis. Particularly it provides the stepstone to understand the biological signals in high dimensional RNA-seq data. In this paper, the authors propose INSIDER, a general and flexible statistical framework based on matrix factorization. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve dimension reduction of high-dimensional data (of &gt;=3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample ´ expression). Besides, it enables computing 'adjusted' expression profiles for specific biological variables while controlling variation from other variables.</p>
    <p>Overall, the idea is novel and to develop new method to explain the data. better. INSIDER is a general and flexible framework. It can capture interactions between variables or covariate and encourages sparsity in latent representations by imposing the elastic net penalty. The advantages have been highlighted. The paper is well written and the motivation is explained quite clear.</p>
    <p>My minor concern is as follows,</p>
    <p>1. To use INSIDER well, the users have to know the major variation sources. For example, it’s quite typical for expression data with donors, phenotypes, tissues information. But sometimes those information is not available. How should the method be used?</p>
    <p>2. The authors added the phenotype by tissue interactions as an example. To make the method more general, it’s better to having one version without interaction term. It’s also good to demonstrate how the interaction term improves the results.</p>
    <p>3. To highlight the high-dimensional data (of &gt;=3 dimensions), it’s better to have more examples to show high-dimensional data is common and quite general case in practice.</p>
    <p>4. The choice of K is a multi-scale problem. How should we choose it in practice.</p>
    <p>5. It’s better to provide software in Github.</p>
    <p>From the editorial board:</p>
    <p>Two reviewers and the editorial team have reviewed the manuscript. They showed overall enthusiasm for the proposed method as a general and principled approach to dimension reduction, while also offering several suggestions as follow. Please carefully review those questions and suggestions and respond to them accordingly.</p>
    <p>Firstly, the authors claim that the INSIDER method can manage missing data. However, this aspect isn't explored in depth. The effect of significant and complex missing data remains uncertain. It would be beneficial to conduct further evaluations through simulation studies.</p>
    <p>Additionally, as one reviewer highlighted, the process for determining the rank K in the latent space is vague. A more clear, justifiable, and efficient method for the choice is needed.</p>
    <p>Regarding the analysis of real data, the comparison to standard and frequently used methods like PCA or GLM-based approaches is inadequate. While some discussions are present, more detailed comparative analyses are required.</p>
    <p>Lastly, showing additional simulation results in cases of model misspecification would be informative.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pgen.1011189.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">22 Jan 2024</named-content>
    </p>
    <supplementary-material id="pgen.1011189.s009" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Insider_response_letter_v4.docx</named-content></p>
      </caption>
      <media xlink:href="pgen.1011189.s009.docx"/>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Feb 2024</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been editorially accepted for publication in PLOS Genetics. Congratulations!</p>
    <p>Before your submission can be formally accepted and sent to production you will need to complete our formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Please note: the accept date on your published article will reflect the date of this provisional acceptance, but your manuscript will not be scheduled for publication until the required changes have been made.</p>
    <p>Once your paper is formally accepted, an uncorrected proof of your manuscript will be published online ahead of the final version, unless you’ve already opted out via the online submission form. If, for any reason, you do not want an earlier version of your manuscript published online or are unsure if you have already indicated as such, please let the journal staff know immediately at <email>plosgenetics@plos.org</email>.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pgenetics/" ext-link-type="uri">https://www.editorialmanager.com/pgenetics/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process. Note that PLOS requires an ORCID iD for all corresponding authors. Therefore, please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to ‘Update my Information’ (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field.  This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p>
    <p>If you have a press-related query, or would like to know about making your underlying data available (as you will be aware, this is required for publication), please see the end of this email. If your institution or institutions have a press office, please notify them about your upcoming article at this point, to enable them to help maximise its impact. Inform journal staff as soon as possible if you are preparing a press release for your article and need a publication date.</p>
    <p>Thank you again for supporting open-access publishing; we are looking forward to publishing your work in PLOS Genetics!</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>
      <ext-link xlink:href="http://www.plosgenetics.org" ext-link-type="uri">www.plosgenetics.org</ext-link>
    </p>
    <p>Twitter: @PLOSGenetics</p>
    <p>----------------------------------------------------</p>
    <p>Comments from the reviewers (if applicable):</p>
    <p>The reviewers are satisfied with the revision and I would recommend to accept the work.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my comments. No more comments.</p>
    <p>Reviewer #2: The authors have fully addressed my concerns by performing additional experiments and adding discussions. The manuscript has been greatly improved.</p>
    <p>One follow-up suggesting for optimal k selection is as follows. The training and test data split and RMSE calculation is reasonable and rigorous. In dimension reduction, people use the variance explained by the k latent variables to better understand the data structure. It would be nice to provide this index for INSIDER method and also compare with different k choices with shuffled data.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Data Deposition</bold>
    </p>
    <p>If you have submitted a Research Article or Front Matter that has associated data that are not suitable for deposition in a subject-specific public repository (such as GenBank or ArrayExpress), one way to make that data available is to deposit it in the <ext-link xlink:href="http://www.datadryad.org/" ext-link-type="uri">Dryad Digital Repository</ext-link>. As you may recall, we ask all authors to agree to make data available; this is one way to achieve that. A full list of recommended repositories can be found on our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability#loc-recommended-repositories" ext-link-type="uri">website</ext-link>.</p>
    <p>The following link will take you to the Dryad record for your article, so you won't have to re‐enter its bibliographic information, and can upload your files directly: </p>
    <p>
      <ext-link xlink:href="http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1" ext-link-type="uri">http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1</ext-link>
    </p>
    <p>More information about depositing data in Dryad is available at <ext-link xlink:href="http://www.datadryad.org/depositing" ext-link-type="uri">http://www.datadryad.org/depositing</ext-link>. If you experience any difficulties in submitting your data, please contact <email>help@datadryad.org</email> for support.</p>
    <p>Additionally, please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying display items are included with the submission, and you will need to provide this before we can formally accept your manuscript, if not already present.</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Press Queries</bold>
    </p>
    <p>If you or your institution will be preparing press materials for this manuscript, or if you need to know your paper's publication date for media purposes, please inform the journal staff as soon as possible so that your submission can be scheduled accordingly. Your manuscript will remain under a strict press embargo until the publication date and time. This means an early version of your manuscript will not be published ahead of your final version. PLOS Genetics may also choose to issue a press release for your article. If there's anything the journal should know or you'd like more information, please get in touch via <email>plosgenetics@plos.org</email>.</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pgen.1011189.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Mar 2024</named-content>
    </p>
    <p>PGENETICS-D-23-01170R1 </p>
    <p>INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis </p>
    <p>Dear Dr Lin, </p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been formally accepted for publication in PLOS Genetics! Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out or your manuscript is a front-matter piece, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Genetics and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Genetics</p>
    <p>On behalf of:</p>
    <p>The PLOS Genetics Team</p>
    <p>Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom</p>
    <p><email>plosgenetics@plos.org</email> | +44 (0) 1223-442823</p>
    <p><ext-link xlink:href="http://plosgenetics.org" ext-link-type="uri">plosgenetics.org</ext-link> | Twitter: @PLOSGenetics</p>
  </body>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pgen.1011189.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10965063</article-id>
    <article-id pub-id-type="pmid">38484017</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-23-01170</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Organism Development</subject>
            <subj-group>
              <subject>Organogenesis</subject>
              <subj-group>
                <subject>Brain Development</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Phenotypes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognition</subject>
              <subj-group>
                <subject>Memory</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Learning and Memory</subject>
            <subj-group>
              <subject>Memory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Critical Care and Emergency Medicine</subject>
          <subj-group>
            <subject>Trauma Medicine</subject>
            <subj-group>
              <subject>Traumatic Injury</subject>
              <subj-group>
                <subject>Neurotrauma</subject>
                <subj-group>
                  <subject>Traumatic Brain Injury</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>INSIDER: Interpretable sparse matrix decomposition for RNA expression data analysis</article-title>
      <alt-title alt-title-type="running-head">Insider</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2774-6326</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Kai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Sen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Cuichan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2533-7270</contrib-id>
        <name>
          <surname>Sham</surname>
          <given-names>Pak Chung</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>So</surname>
          <given-names>Hon-Cheong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Zhixiang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of System Engineering and Engineering Management, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Psychiatry, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Psychiatry, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Centre for Genomic Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>State Key Laboratory for Cognitive and Brain Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>School of Biomedical Sciences, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>KIZ-CUHK Joint Laboratory of Bioresources and Molecular Research of Common Diseases, Kunming Institute of Zoology and The Chinese University of Hong Kong, Hong Kong, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Case Western Reserve University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hcso@cuhk.edu.hk</email> (H-CS); <email>zhixianglin@cuhk.edu.hk</email> (ZL)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>3</issue>
    <elocation-id>e1011189</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhao et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhao et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1011189.pdf"/>
    <abstract>
      <p>RNA sequencing (RNA-Seq) is widely used to capture transcriptome dynamics across tissues, biological entities, and conditions. Currently, few or no methods can handle multiple biological variables (e.g., tissues/ phenotypes) and their interactions simultaneously, while also achieving dimension reduction (DR).</p>
      <p>We propose INSIDER, a general and flexible statistical framework based on matrix factorization, which is freely available at <ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve DR of high-dimensional data (of &gt; = 3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample × expression). Besides, it enables computing ’adjusted’ expression profiles for specific biological variables while controlling variation from other variables. INSIDER is computationally efficient and accommodates missing data. INSIDER also performed similarly or outperformed a close competing method, SDA, as shown in simulations and can handle complex missing data in RNA-Seq data. Moreover, unlike SDA, it can be used when the data cannot be structured into a tensor. Lastly, we demonstrate its usefulness via real data analysis, including clustering donors for disease subtyping, revealing neuro-development trajectory using the BrainSpan data, and uncovering biological processes contributing to variables of interest (e.g., disease status and tissue) and their interactions.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>The RNA-Seq studies aim to understand the contributing role of gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development. However, our ability to understand these key issues in high-dimensional settings is hampered by the limitations of currently available methods for analyzing RNA-seq data. To address these issues, we propose a novel statistical method to jointly model variation from multiple biological variables (e.g., donor, tissue, phenotype), to introduce interactions (tissue × phenotype), and to reduce dimensionality. The favorable properties of our method are discussed below. Its advantages over one closest existing computational tool and its wide applicability are shown via simulation and applications. A computationally efficient implementation of our method is provided.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4930181</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100021366</institution-id>
            <institution>Faculty of Science, Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRIMS 4620033</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4053540, 4053586</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002920</institution-id>
            <institution>Research Grants Council, University Grants Committee</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GRF 14301120, GRF 14300923</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>ZL has been supported by the Chinese University of Hong Kong startup grant (4930181), the Chinese University of Hong Kong Science Faculty’s Collaborative Research Impact Matching Scheme (CRIMS 4620033), the Chinese University of Hong Kong direct grants (4053540, 4053586), and Hong Kong Research Grant Council (GRF 14301120, 14300923). The funders play no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="4"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-03-26</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA Sequencing (RNA-Seq), which has been developed for more than a decade, uses deep sequencing technology to offer a far more precise measurement of levels of transcripts and their isoforms than other methods [<xref rid="pgen.1011189.ref001" ref-type="bibr">1</xref>]. It is now widely used to measure transcriptome levels across different tissues from a number of donors and capture transcriptome dynamics across tissues or biological conditions. For example, the Genotype-Tissue Expression (GTEx) [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] project offers a valuable data resource to study tissue-specific gene expression and regulation. Moreover, there are many data resources related to brain development or psychiatric disorders across brain regions, including the BrainSpan [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>], PsychENCODE [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], and ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>]. The primary task of these studies is to link gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development.</p>
    <p>However, variation in transcript levels due to covariates, such as donor and tissue, makes the task challenging. Let us take studies of autism spectrum disorder (ASD) as examples. Different brain regions may demonstrate wide differences in gene activities in ASD [<xref rid="pgen.1011189.ref006" ref-type="bibr">6</xref>]. On the other hand, no individuals with ASD have exactly the same genetic expression profiles [<xref rid="pgen.1011189.ref007" ref-type="bibr">7</xref>], which are influenced by individual characteristics such as age, sex, diet, and lifestyle. Thus, joint analyses of gene expression by RNA-Seq of multiple brain regions from several donors are hindered by the variation from donors and tissues.</p>
    <p>Tools for differential gene expression (DGE) analysis [<xref rid="pgen.1011189.ref008" ref-type="bibr">8</xref>, <xref rid="pgen.1011189.ref009" ref-type="bibr">9</xref>], typically built upon generalized linear models (GLM), have been widely employed to quantify changes in expression levels across experimental groups or biological conditions in analyzing RNA expression data. Such methods can also consider confounding variation from covariates, such as donor, and tissue. However, DGE analysis does not aim for dimension reduction and thus cannot help achieve the tasks that require reducing high dimensional data onto a low-rank latent space, such as clustering donors based on low-rank representations of donors (low-rank representations are preferred as the high dimension of genomic features often makes clustering analysis difficult), and other downstream analysis with low-rank representations of biological conditions (phenotype, tissue, or developmental stage).</p>
    <p>Traditional dimension reduction (DR) approaches, such as principal component analysis (PCA), factor analysis, and matrix factorization, cannot directly handle the variation from <italic toggle="yes">multiple</italic> covariates, such as donor, tissue, and other clinical or biological features, to facilitate further analysis. One study [<xref rid="pgen.1011189.ref010" ref-type="bibr">10</xref>] proposed a PCA-based approach with adjustment for confounding variables. Other approaches based on factor analysis have been proposed to adjust for technical artifacts or confounding variables [<xref rid="pgen.1011189.ref011" ref-type="bibr">11</xref>,<xref rid="pgen.1011189.ref012" ref-type="bibr">12</xref>]. These studies aim to remove technical artifacts or control confounding variations rather than interpret variations originating from biological conditions.</p>
    <p>Non-negative matrix factorization (NMF) [<xref rid="pgen.1011189.ref013" ref-type="bibr">13</xref>–<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>] has gained popularity in the analysis of genomic data. The conventional NMF method cannot be directly employed to model variations arising from <italic toggle="yes">multiple</italic> biological variables and their interactions, and to interpret variations from <italic toggle="yes">multiple</italic> biological features or conditions. Variants of NMF proposed for the analysis of bulk RNA-Seq data are rather limited, and most of them aim to correct batch effects in single-cell settings instead of interpreting variation from biological variables [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>]. On the other hand, NMF and its variants fail to directly infer down-regulations of elements in biological settings [<xref rid="pgen.1011189.ref016" ref-type="bibr">16</xref>], so its interpretability is hampered.</p>
    <p>To summarize, conventional DR methods such as PCA and NMF can usually only be used for two-dimensional (2D) data (e.g., sample × expression), and cannot directly handle <italic toggle="yes">multiple</italic> variables or biological conditions (e.g., donor × tissue × expression; donor × time × expression etc.), or interactions between these conditions. On the other hand, the new methodology we proposed below (INSIDER) can handle <italic toggle="yes">higher-dimensional data (of three or more dimensions)</italic>, as well as interactions between the variables of interest, while performing DR simultaneously.</p>
    <p>We note that most tensor decomposition approaches [<xref rid="pgen.1011189.ref017" ref-type="bibr">17</xref>–<xref rid="pgen.1011189.ref019" ref-type="bibr">19</xref>] can achieve DR with high-dimensional data, however most cannot handle missing data or invoke sparsity in the latent representations. This may impose limitations in analyzing gene expression data since the function of a particular biological pathway often only involves a subset of genes, and each latent dimension only encodes information related to a few pathways. Thus, a sparse Bayesian tensor decomposition approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] (Sparse Decomposition of Arrays [SDA]) was proposed to capture variation from donor and tissue in analyzing RNA-Seq data. However, Bayesian-based approaches face a heavy computational burden in analyzing large-scale genomic data, especially when optimizing with Markov Chain Monte Carlo.</p>
    <p>To model variation from <italic toggle="yes">multiple</italic> biological variables and to facilitate interpretation of the variation, we propose a general and flexible statistical framework, INSIDER, based on matrix decomposition (MF) without non-negative constraints to decompose the variation from covariates in high dimensional data into a shared low-rank latent space. INSIDER has the following favorable properties:</p>
    <list list-type="order">
      <list-item>
        <p>it is a general and flexible framework, in which various covariates and interaction terms can be defined based on research questions and study design. Importantly, it can accommodate <italic toggle="yes">multiple</italic> biological variables simultaneously, and achieve DR of <italic toggle="yes">high-dimensional</italic> data, as opposed to other conventional methods such as PCA and NMF which generally can only handle 2D data (e.g., sample × expression);</p>
      </list-item>
      <list-item>
        <p>it is able to consider <italic toggle="yes">interactions</italic> between different biological/clinical variables, enabling gaining insights into the effect of one variable on others. For example, modeling gene expression of various brain regions across neuropsychiatric disorders, the brain region × disorder interaction, can help understand how brain regions interact with the type of disorder to influence expression. Intuitively, the same disease may affect expression differently in different brain regions; such information may be missed if interactions are not modeled. Notably, interactions are usually ignored by conventional methods, such as PCA, NMF, and their variants. Interactions were also ignored in the recently developed SDA approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>];</p>
      </list-item>
      <list-item>
        <p>it allows one to compute the ’adjusted’ expression for one variable (e.g., phenotype) that controls for variation from other variables (e.g., donor). In addition, to consider the group effect among genes and invoke sparsity in gene expression, it introduces an elastic net penalty (combination of L1 and L2 penalty). Elastic net penalty is widely used in the regression setting where only a subset of features may contribute to the outcome, but it prefers highly correlated predictors to be included or excluded from the model together [<xref rid="pgen.1011189.ref021" ref-type="bibr">21</xref>] (instead of arbitrarily selecting one predictor over others as in LASSO);</p>
      </list-item>
      <list-item>
        <p>Results from it facilitate different downstream analyses, including clustering donors with donor representations, temporal dynamic analyses, and uncovering disease mechanisms. The potential of INSIDER in facilitating clinical and biological discoveries will be demonstrated in the Results section;</p>
      </list-item>
      <list-item>
        <p>it is computationally efficient and can also handle missing data well. These will be elaborated further in the sections below;</p>
      </list-item>
      <list-item>
        <p>it also performed similarly or outperformed one of the closest competing methods, SDA, as shown in our simulations. Moreover, unlike SDA, it can also be used where the data matrix cannot be neatly structured into a tensor, as explained below.</p>
      </list-item>
    </list>
    <p>To recap the uniqueness of INSIDER, it models variation arising from <italic toggle="yes">multiple</italic> biological variables and their interaction to comprehend their effects on gene expression in a complex biological setting instead of solely removing technical artifacts or controlling confounding variations. Moreover, it models the effect of specific biological variables while controlling for variation from other biological variables. Unlike GLM-based methods for DGE analysis, INSIDER is a statistical approach for dimension reduction, thus enabling performing the tasks that are challenging using high-dimensional features, such as clustering subjects with donor representations. In contrast to NMF, INSIDER considers the interaction between biological variables and does not impose non-negativity constraints on the latent representations, which allows for capturing down-regulation in gene expression and thus enhances model interpretability. Additionally, compared with tensor decomposition, it can handle situations where the data matrix cannot be structured into a tensor. Usually, for tensor decomposition approaches, we assume one observation/sample per each combination of the three (or more) dimensions, but this is not always the case in practice. To illustrate with an example, when analyzing the effect of neuropsychiatric disorders on expression in different brain regions, multiple samples may be taken from a specific brain region from donors with a certain disorder. The number of samples taken could also differ across donors. This scenario can be challenging for standard tensor decomposition or SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], but can be handled by our proposed method.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of INSIDER</title>
      <p>We propose a novel computational method called INSIDER (<underline>in</underline>terpretable <underline>s</underline>parse matr<underline>i</underline>x <underline>de</underline>composition for bulk <underline>R</underline>NA expression data analysis), summarized in <xref rid="pgen.1011189.g001" ref-type="fig">Fig 1</xref>. INSIDER considers that variation in RNA expression levels originates from several biological variables or covariates, such as donor, tissue, and phenotype (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1A</xref>). The variation is decomposed into a shared latent space of rank <italic toggle="yes">K</italic> by matrix factorization, and variation from unknow sources can also be considered by INSIDER (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). The effect of each covariate on expression can be measured by multiplying the corresponding latent representation with the gene representation <italic toggle="yes">V</italic> (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). Specifically, the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>, <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub>, is modelled as
<disp-formula id="pgen.1011189.e001"><alternatives><graphic xlink:href="pgen.1011189.e001.jpg" id="pgen.1011189.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>. <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the information is unavailable. The interaction effect between tissues and phenotypes is incorporated by introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. Let <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> denote the observed data matrix for <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The above equation can be rewritten in the following matrix representation
<disp-formula id="pgen.1011189.e002"><alternatives><graphic xlink:href="pgen.1011189.e002.jpg" id="pgen.1011189.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>We assume there are <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. For the purpose of representation, <inline-formula id="pgen.1011189.e003"><alternatives><graphic xlink:href="pgen.1011189.e003.jpg" id="pgen.1011189.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are introduced to be the indicator matrices for donors, phenotypes, tissues, phenotype by tissue interactions, and observations, which are the dummy design matrices for the samples. <italic toggle="yes">X</italic><sub><italic toggle="yes">U</italic></sub> is an identity matrix. <inline-formula id="pgen.1011189.e004"><alternatives><graphic xlink:href="pgen.1011189.e004.jpg" id="pgen.1011189.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the matrices for latent representations for the effects of donors, phenotypes, tissues, phenotype by tissue interactions, and observations on the <italic toggle="yes">K</italic> latent metagenes, respectively, and <italic toggle="yes">V</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> represents <italic toggle="yes">K</italic> metagenes across the <italic toggle="yes">M</italic> genes, which capture genes that tend to be co-expressed or work together to induce biological functions.</p>
      <p>In INSIDER, we seek to minimize the following objective
<disp-formula id="pgen.1011189.e005"><alternatives><graphic xlink:href="pgen.1011189.e005.jpg" id="pgen.1011189.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e006"><alternatives><graphic xlink:href="pgen.1011189.e006.jpg" id="pgen.1011189.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e007"><alternatives><graphic xlink:href="pgen.1011189.e007.jpg" id="pgen.1011189.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Here <italic toggle="yes">λ</italic>, <italic toggle="yes">α</italic> are tuning parameters for the elastic net regularization term,||·||<sub><italic toggle="yes">F</italic></sub> represents the Frobenius norm. Alternating block coordinate descent (BCD) is utilized to optimize the objective. INSIDER can incorporate observations with missing values. The technical details of INSIDER are presented in the Methods section.</p>
      <p>INSIDER enables various downstream analyses (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1C</xref>). For instance, cluster analysis on the donor representation can reveal characteristics of the donors and help find patients subgroups or disease subtyping, development trajectory can be more readily revealed with ‘metagenes’ (low-rank representations of gene expression), which capture the information of genes that tend to be co-expressed or work together to induce biological functions [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. Also, biological processes (BPs) enriched by results from INSIDER help to gain insights into mechanisms underlying covariates like phenotype and interactions between covariates. Details of these analyses are presented below.</p>
      <fig position="float" id="pgen.1011189.g001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of INSIDER.</title>
          <p>A. The RNA-seq data is usually obtained from samples of different tissues from several donors with different phenotypes. B. The variation in RNA-seq expression data can be decomposed into a shared <italic toggle="yes">K</italic>-rank latent space by INSIDER. The latent representation for observations <italic toggle="yes">U</italic> can be included when the donor, phenotype, and/or tissue information is unavailable. Note that INSIDER incorporates the interaction between covariates and that the gene representation <italic toggle="yes">V</italic> is shared. C. Various types of downstream analysis can be conducted on the result from INSIDER. The donor representations can be utilized for cluster analysis, development trajectories can be revealed in the analysis of the BrainSpan data, and biological mechanisms behind phenotypes of interest and interactions between covariates can be revealed. Details on these analyses will be demonstrated in the Result section.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Simulation study</title>
      <p>To our knowledge, there is no readily available computational tool for modeling the variation arising from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic>, while also performing dimension reduction (and having similar favorable properties as described earlier). Tensor decomposition is the closest existing computational tool to INSIDER. To showcase the advantages of INSIDER in capturing complex latent structures of gene expression data, it was compared to SDA[<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a sparse Bayesian tensor decomposition approach. We evaluated their abilities to accurately recover the underlying latent structures from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic> with RMSE (root-mean-squared error).</p>
      <p>In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (250×200), and variation in the matrix comes from two biological variables (<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>), their interaction, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic></sub><italic toggle="yes">R</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and the dimension of <italic toggle="yes">R</italic> for the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> is 250×5. <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>,<italic toggle="yes">R</italic>} are <inline-formula id="pgen.1011189.e008"><alternatives><graphic xlink:href="pgen.1011189.e008.jpg" id="pgen.1011189.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e009"><alternatives><graphic xlink:href="pgen.1011189.e009.jpg" id="pgen.1011189.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e010"><alternatives><graphic xlink:href="pgen.1011189.e010.jpg" id="pgen.1011189.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (250×200) was generated from a normal distribution <italic toggle="yes">N</italic>(0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. We considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1 in our simulations. Meanwhile, to introduce sparsity in gene expression, we randomly silence the expression of 30% of the genes.</p>
      <p>Subsequently, we employed INSIDER with and without considering the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> and SDA to decompose the matrix <italic toggle="yes">Z</italic>, and then evaluated their abilities to recover <italic toggle="yes">T</italic> using RMSE. For the implementation of SDA, the software provided by the original study [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] was used. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. Results for the comparison are shown in <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparison of performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to INSIDER.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t001" id="pgen.1011189.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">2.21</td>
                <td align="center" rowspan="1" colspan="1">2.12</td>
                <td align="center" rowspan="1" colspan="1">1.82</td>
                <td align="center" rowspan="1" colspan="1">1.84</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.10</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>, we see that SDA fails to capture the underlying relationship across different noise levels. Moreover, INSIDER without interaction outperforms SDA in recovering <italic toggle="yes">T</italic> using RMSE, even though both methods have a similar model complexity. Importantly, when considering the interactive effects between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic>, INSIDER demonstrates substantially better performance in recovering <italic toggle="yes">T</italic>, compared with SDA, even as the level of noise increases.</p>
      <p>To show the performance of INSIDER in case of model misspecification, we first included simulation studies of INSIDER under the situation where the simulation data is generated according to SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a tensor decomposition method. Specifically, we consider a tensor of gene expression <italic toggle="yes">Z</italic> of dimensions 50×5×200, which is generated according to <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <inline-formula id="pgen.1011189.e011"><alternatives><graphic xlink:href="pgen.1011189.e011.jpg" id="pgen.1011189.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Here the rank of latent space <italic toggle="yes">K</italic> is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The elements of Θ are generated from <italic toggle="yes">N</italic>(0, <italic toggle="yes">σ</italic>). In practice, we consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For the application of INSIDER to the simulated data, we flat the tensor <italic toggle="yes">Z</italic> by its first two dimensions and transform it into a 250×200 matrix. Then, we introduce two design matrices <inline-formula id="pgen.1011189.e012"><alternatives><graphic xlink:href="pgen.1011189.e012.jpg" id="pgen.1011189.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>and <inline-formula id="pgen.1011189.e013"><alternatives><graphic xlink:href="pgen.1011189.e013.jpg" id="pgen.1011189.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for the first two dimensions of <italic toggle="yes">Z</italic>, and the two design matrices are considered as covariates for INSIDER. Since SDA only has one hyperparameter, the latent rank <italic toggle="yes">K</italic> (<italic toggle="yes">num_comps</italic>), and does not allow missing entries, we adopt the following procedure in the simulation study. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. For INSIDER, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as validation set and consider the left data trainset, select the hyperparameters with which INSIDER trained on the trainset performs the best on the validation set, and run INSIDER with selected hyperparameters on <italic toggle="yes">Z</italic>. Then we compared the performance of INSIDER with and without interactions to SDA in recovering the true pattern <italic toggle="yes">T</italic> using RMSE. The results of the simulation studies are presented in <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of the performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to SDA.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t002" id="pgen.1011189.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">0.04</td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.22</td>
                <td align="center" rowspan="1" colspan="1">1.57</td>
                <td align="center" rowspan="1" colspan="1">2.10</td>
                <td align="center" rowspan="1" colspan="1">1.66</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>, we find that INSIDER without interaction did not perform well in the case of model misspecification. However, INSIDER with interaction demonstrated a performance similar to SDA, although the simulation data is generated according to the SDA model. This suggests that INSIDER performs well in the case of model specification when data is generated according to SDA.</p>
      <p>To further demonstrate the performance of INSIDER in case of model misspecification, we conducted further simulation analysis to examine its performance when the data is generated according to multivariate linear regression models. For illustration, the gene expression matrix <italic toggle="yes">Z</italic> of dimensions 100×200 is generated by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = <italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic>+<italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic>, <inline-formula id="pgen.1011189.e014"><alternatives><graphic xlink:href="pgen.1011189.e014.jpg" id="pgen.1011189.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1011189.e015"><alternatives><graphic xlink:href="pgen.1011189.e015.jpg" id="pgen.1011189.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the dummy matrices for two categorical variables, <italic toggle="yes">E</italic><sup>20×200</sup>,<italic toggle="yes">F</italic><sup>5×200</sup> are matrices for coefficients of the two categorical variables across 200 genes, and Θ<sup>100×200</sup> is the error matrix. In simulation, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are generated from <italic toggle="yes">N</italic>(0, 1) and Θ is generated from <italic toggle="yes">N</italic>(0,<italic toggle="yes">σ</italic>), where <italic toggle="yes">σ</italic> denotes the noise level. We consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For INSIDER, we incorporate two categorical variables as covariates without considering their interaction. For linear regression, we fit ridge regression with the two categorical variables as predictors and <italic toggle="yes">Z</italic> as responses. For a fair comparison, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as hold-out set, draw 10% of the elements of the left data without replacement as validation set, and consider other elements of the left data as trainset. To employ INSIDER and Ridge regression, we first train them on the trainset with different hyperparameters and select the parameters with which they perform the best on the validation set in terms of RMSE. Then, we fit them with the chosen hyperparameters on the left data (trainset + validation set) and report the RMSE of the fitted model on <italic toggle="yes">T</italic> for the testset. The baseline RMSE is the root-mean-square difference between <italic toggle="yes">T</italic> and the average of <italic toggle="yes">Z</italic> over the trainset and validation set. The results of the simulation are shown in <xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Performance of INSIDER in recovering <italic toggle="yes">T</italic> over the hold-out set using RMSE when the data is generated according to a multivariate linear model.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t003" id="pgen.1011189.t003g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Baseline</td>
                <td align="center" rowspan="1" colspan="1">1.4234</td>
                <td align="center" rowspan="1" colspan="1">1.4046</td>
                <td align="center" rowspan="1" colspan="1">1.4005</td>
                <td align="center" rowspan="1" colspan="1">1.4001</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Ridge regression</td>
                <td align="center" rowspan="1" colspan="1">0.1496</td>
                <td align="center" rowspan="1" colspan="1">0.2934</td>
                <td align="center" rowspan="1" colspan="1">0.4257</td>
                <td align="center" rowspan="1" colspan="1">0.5426</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">INSIDER</td>
                <td align="center" rowspan="1" colspan="1">0.1493</td>
                <td align="center" rowspan="1" colspan="1">0.2950</td>
                <td align="center" rowspan="1" colspan="1">0.4268</td>
                <td align="center" rowspan="1" colspan="1">0.5458</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref> shows that INSIDER performs similarly to ridge regression in terms of RMSE in recovering <italic toggle="yes">T</italic>. Moreover, compared with the baseline RMSE, INSIDER captures a large proportion of signals. This suggests that INSIDER performs well under the case of model specification when the simulated data is generated according to multivariate linear models.</p>
      <p>Further, we also explored the ability of INSIDER to handle missing values in simulation settings. There are mainly two types of missing in RNA-Seq studies. The first type is missing samples. For example, the biosamples of some tissues from donors are not available, and this leads to missing samples in RNA-Seq data. The second type is missing entries. That is, expression levels of some genes for samples are missing. In practice, the proportion of missing entries is usually small in RNA-Seq data. Here we studied the two types of missing in the simulation below.</p>
      <p>In our simulation study, we assume there are 50 donors with 2 different phenotypes, 8 tissues, and 1000 genes. The number of samples for our simulated data matrix is 400 (50×8). Moreover, we consider the interaction between phenotypes and tissues. In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (400×1000), and variation in the matrix comes from three biological variables (<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>), the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic>, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">R</italic>+Θ, where R = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub><italic toggle="yes">D</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub><italic toggle="yes">P</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub><italic toggle="yes">T</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub><italic toggle="yes">W</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, and <italic toggle="yes">T</italic> are matrices of dimensions 50×5, 2×5, and 8×5, respectively, and the dimension of <italic toggle="yes">W</italic> for the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic> is 16×5. <italic toggle="yes">V</italic> is a 5×1000 matrix for gene latent representations. All matrices for latent representation were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>} are <inline-formula id="pgen.1011189.e016"><alternatives><graphic xlink:href="pgen.1011189.e016.jpg" id="pgen.1011189.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e017"><alternatives><graphic xlink:href="pgen.1011189.e017.jpg" id="pgen.1011189.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e018"><alternatives><graphic xlink:href="pgen.1011189.e018.jpg" id="pgen.1011189.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e019"><alternatives><graphic xlink:href="pgen.1011189.e019.jpg" id="pgen.1011189.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (400×1000) was generated from a normal distribution <italic toggle="yes">N</italic> (0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. In the simulation, we considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1.</p>
      <p>To better mimic the complex missing samples in real settings, we consider the setting based on the distribution of brain structures and phenotypes of samples of 50 donors similar to the ageing, dementia, and TBI data. Among 50 donors, 27 are healthy, and the other 23 are affected by a specific disease. For each donor, at least 4 out of 8 tissues are available. Then, we had 229 samples available, and 171 (42.75%) samples were missing. For comparison, we also conducted simulation studies on the scenario where 42.75% of samples are missing at random. Further, to introduce missing entries in the data matrix of samples available, we randomly drew 5% of the elements from it as missing entries. To evaluate the performance of INSIDER in handling missing, we examined the RMSE between the estimated <inline-formula id="pgen.1011189.e020"><alternatives><graphic xlink:href="pgen.1011189.e020.jpg" id="pgen.1011189.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER and <italic toggle="yes">R</italic> over missing entries and samples, and the result is presented in <xref rid="pgen.1011189.t004" ref-type="table">Table 4</xref>. In the table, the baseline RMSE is the root-mean-square difference between <italic toggle="yes">R</italic> for missing entries or samples and the average of <italic toggle="yes">Z</italic> over nonmissing entries. Since the baseline RMSE for missing entries and samples are roughly the same, we only show the baseline RMSE for missing samples for illustration.</p>
      <table-wrap position="float" id="pgen.1011189.t004">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The baseline RMSE and RMSE of the estimated <inline-formula id="pgen.1011189.e021"><alternatives><graphic xlink:href="pgen.1011189.e021" id="pgen.1011189.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER against <italic toggle="yes">R</italic> on missing entries and samples across different simulation settings.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t004" id="pgen.1011189.t004g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">RMSE<break/>Noise</th>
                <th align="center" rowspan="1" colspan="1">Baseline</th>
                <th align="center" rowspan="1" colspan="1">Missing entries</th>
                <th align="center" rowspan="1" colspan="1">Random missing samples</th>
                <th align="center" rowspan="1" colspan="1">Missing samples (real)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.25</td>
                <td align="center" rowspan="1" colspan="1">4.5308</td>
                <td align="center" rowspan="1" colspan="1">0.0460</td>
                <td align="center" rowspan="1" colspan="1">0.0394</td>
                <td align="center" rowspan="1" colspan="1">0.0401</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">4.6308</td>
                <td align="center" rowspan="1" colspan="1">0.0907</td>
                <td align="center" rowspan="1" colspan="1">0.0780</td>
                <td align="center" rowspan="1" colspan="1">0.0803</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.75</td>
                <td align="center" rowspan="1" colspan="1">4.5998</td>
                <td align="center" rowspan="1" colspan="1">0.1397</td>
                <td align="center" rowspan="1" colspan="1">0.1207</td>
                <td align="center" rowspan="1" colspan="1">0.1206</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">4.4998</td>
                <td align="center" rowspan="1" colspan="1">0.1827</td>
                <td align="center" rowspan="1" colspan="1">0.1553</td>
                <td align="center" rowspan="1" colspan="1">0.1581</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From the table, we see that the RMSE for missing entries and samples increases slightly with increasing noise levels, and the RMSE for missing entries is slightly higher compared with the RMSE for missing samples. The RMSE for random missing samples and the designed missing samples based on the ageing, dementia, and TBI data is roughly the same. The simulation result suggests that the INSIDER has a good ability to recover underlying true patterns and the ability decreases slightly with increasing noise levels, even though complex missing exists.</p>
    </sec>
    <sec id="sec005">
      <title>Analysis of the BrainSpan data</title>
      <p>The BrainSpan study provides RNA-Seq data profiling up to sixteen cortical and subcortical structures across the entire course of human brain development [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>]. In this analysis, we aim to explore the development trajectories across human brain development, the BPs that function in different brain regions, and the involvement of brain regions in different development stages.</p>
      <p>The BrainSpan dataset was downloaded from the website provided in [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>]. The dimension of the data matrix for our analysis is 524×43411. In this analysis, we modeled development stages and brain regions as covariates but omitted interactions between development stages and brain regions, because many combinations of development stages and brain regions only have 1 or 0 RNA-seq sample, so inference of the interaction will be unreliable. For the definition of development stages, we follow the specifications defined in the original study [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>].</p>
      <p>In the application, even though the development stages are in chronological order, we consider development stages as unordered categorical variables. The main reason is that human brain development is nonlinear, so some metagenes may only be highly active in certain developmental stages and then are leveled down or turned off. For example, the study [<xref rid="pgen.1011189.ref024" ref-type="bibr">24</xref>] systematically discussed the development of different brain structures across developmental stages, suggesting that the development of brain structures is specific to certain development stages. For illustration, we denote <inline-formula id="pgen.1011189.e022"><alternatives><graphic xlink:href="pgen.1011189.e022.jpg" id="pgen.1011189.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>as the latent representations for development stages, brain regions, and genes, respectively. There are <italic toggle="yes">N</italic><sub>1</sub> development stages and <italic toggle="yes">N</italic><sub>2</sub> brain regions, and <italic toggle="yes">M</italic> is the number of genes included. The rank <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 19.</p>
    </sec>
    <sec id="sec006">
      <title>Metagenes reveal development trajectories</title>
      <p>We adopt the convention to consider the rows of <italic toggle="yes">V</italic> as metagenes [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. We first looked at <inline-formula id="pgen.1011189.e023"><alternatives><graphic xlink:href="pgen.1011189.e023.jpg" id="pgen.1011189.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which are the levels of expression of <italic toggle="yes">K</italic> metagenes across <italic toggle="yes">N</italic><sub>1</sub> developmental stages, and computed the variance of the expression levels of each metagene across <italic toggle="yes">N</italic><sub>1</sub> developmental stages (the variances are computed with the columns in <italic toggle="yes">D</italic>). We chose the most variable (16<sup>th</sup>), 2<sup>nd</sup>, and 17<sup>th</sup> metagenes. We visualized the trajectories of the selected metagenes across human brain development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Meanwhile, we see a rapid surge in the level of the 2<sup>nd</sup> metagene between late fetal and childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Additionally, the loading of the 17<sup>th</sup> metagene is high at the early fetal and fluctuates around zero at later stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>).</p>
      <fig position="float" id="pgen.1011189.g002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Downstream analyses with results from the application to the BrainSpan data.</title>
          <p>A. The trajectories of the selected metagene across human brain development are displayed in the left of panel A. The definition of stages is provided in the table on the right of panel A. B. The top 30 up-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is presented. C. The top 30 down-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is displayed. D. The top 30 up-regulated BPs in the primary motor and somatosensory cortex (M1C-S1C) are shown in panel D. E. The top 30 down-regulated BPs in the M1C-S1C are shown in panel E. F. Trajectories of the adjusted expression for the selected genes at the whole brain level are shown in panel F. The definition of stages in the figure is the same as in panel A.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g002" position="float"/>
      </fig>
      <p>To decode biological mechanisms behind these metagenes, we carried out enrichment analyses to find up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2C</xref>) biological processes (BPs) encoded by them. Specifically, for a given metagene <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, the <italic toggle="yes">i</italic>-th row of <italic toggle="yes">V</italic>, we examine the BPs enriched by genes with large effects, that is, the genes with large absolute values for <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, since these genes encode primary biological functions of the metagene. Therefore, enrichment analyses were conducted on the set of genes in the upper or lower 2.5% quantile of <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub> to explore up- or down-regulated BPs encoded by the metagene, respectively. Here up- or down-regulated BPs refer to BPs enriched by up- or down-regulated genes. Throughout our work, we use them to convey the meaning without loss of clarity. Other technical details for the enrichment analysis are presented in the Supplementary Content (<xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). The up- and down-regulated BPs for the 2<sup>nd</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1B Fig</xref>) and 17<sup>th</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C and S1D Fig</xref>) metagenes are also provided in <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1 Fig</xref>.</p>
      <p>On the one hand, a joint analysis of the trajectories of the (16<sup>th</sup>, 17<sup>th</sup>) metagenes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) with their corresponding up-regulated BPs shows that the embryo is under rapid differentiation and development at the early fetal (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C Fig</xref>) and that developments of brain regions, such as the hippocampus, pallium, and forebrain, are high before the mid-fetal period (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>). As core systems of the brain are established before birth [<xref rid="pgen.1011189.ref025" ref-type="bibr">25</xref>], levels of BPs involved in cell development, axonogenesis, myelination, and gliogenesis fall rapidly after the late fetal period (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2B</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C</xref>). The basic structure of human brains does not undergo substantial changes after birth, so we observed a decline in levels of BPs related to the development of brain regions, such as the forebrain, telencephalon, pallium, and hippocampus (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>). With its continued development, human brains mature well into the 20s [<xref rid="pgen.1011189.ref026" ref-type="bibr">26</xref>], corresponding to a relatively low level of these BPs in young adulthood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>).</p>
      <p>On the other hand, we observed that the BPs involved in learning, memory, and cognition are relatively low in fetal stages (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1D</xref>). With the development of human brains, we also noticed a rapid surge in the level of BPs related to learning, memory, and cognition during infancy (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A</xref>) and a stable rise in levels of these BPs after mid-fetal stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). After the maturation of human brains, these BPs maintain a high level (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). During the development of learning, memory, and cognition, new neural networks form in the brain [<xref rid="pgen.1011189.ref027" ref-type="bibr">27</xref>], and the level of neurotransmitters increases simultaneously [<xref rid="pgen.1011189.ref028" ref-type="bibr">28</xref>]. Our findings also show that the BPs involved in synaptic functions and neurotransmitter activities follow a similar trajectory as those of learning, memory, and cognition (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref>, <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1D</xref>).</p>
      <p>The trajectory of the least variable metagene is highly negative and flat across human brain development (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2A Fig</xref>). Subsequent enrichment analysis revealed that the down-regulated BPs enriched by metagene are involved in cell and ATP metabolism and cell communication (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>), which generally maintain a high level during brain development.</p>
    </sec>
    <sec id="sec007">
      <title>Metagenes characterize development stages and brain regions</title>
      <p>Previously, metagenes depicted the development trajectories of human brains. Moreover, metagenes also can characterize development stages and brain regions. This can be achieved by examining BPs enriched by metagenes with highly distinct values for development stages or brain regions. We highlighted several metagenes for demonstration (Tabs A and B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>).</p>
      <p>On the one hand, one metagene was highlighted to characterize development stages for demonstration. First, we observed that the expression level of the 5<sup>th</sup> metagene for the early mid-fetal (the 5<sup>th</sup> stage in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) is highly positive and much greater than for other stages (Tab A in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). Subsequently, the top up-regulated BPs by the 5<sup>th</sup> metagene involve ossification and development of bone, muscle, and sensory systems (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2C Fig</xref>). The results suggest that the mid-fetal period is vital for bone and muscle formation and contributes to sensory system development.</p>
      <p>On the other hand, we also highlighted one metagene to uncover the functions of brain regions. The loading of the 1st metagene for the striatum is highly positive. Furthermore, the absolute value of the metagene is much greater for the brain region than for other brain regions (Tab B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). As shown by subsequent enrichment analysis, the top 30 up-regulated BPs by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2D Fig</xref>), suggesting that the striatum is responsible for human emotion and cognition (e.g., reward system) [<xref rid="pgen.1011189.ref029" ref-type="bibr">29</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Reveal trajectories of genes expression across human brain development at the whole-brain level</title>
      <p>The development of the human brains is heterogenous across different individuals and not linear across different brain regions. Thus, the confounding variation from donors and tissues makes it difficult to reveal gene expression changes at the whole-brain level across human brain development. One can only show trajectories of gene expression in a tissue-wise manner, as displayed in the study [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>However, INSIDER allows us to obtain the ‘adjusted’ gene expression profiles across development stages by multiplying <italic toggle="yes">D</italic> with <italic toggle="yes">V</italic>. Note that variation from tissue and donor is controlled in the adjusted gene expression profiles, which cannot be readily computed from conventional approaches. Here we showed the trajectories of summarized expression changes for six selected genes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>), which are chosen from genes in the top and bottom of the expression profile for the most variable (16<sup>th</sup>) metagene selected previously.</p>
      <p>The left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref> showed that the trajectory of <italic toggle="yes">DCX</italic>, expressed in neuronal progenitor cells and immature migrating neurons, is similar to that of BPs involved in human brain development discussed previously and consistent with its trend in the hippocampus [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>Regarding <italic toggle="yes">Sox4</italic> and <italic toggle="yes">Sox11</italic>, known key controllers of embryonic and fetal development, our results suggested that they are expressed at high levels in the early development stages (left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). Furthermore, they also demonstrate a similar trajectory across human brain development in the panel.</p>
      <p>Both <italic toggle="yes">MBP</italic> and <italic toggle="yes">PLP1</italic> are involved in the myelination in the CNS, which is vital to cognition development and function and is largely completed in early adulthood [<xref rid="pgen.1011189.ref030" ref-type="bibr">30</xref>,<xref rid="pgen.1011189.ref031" ref-type="bibr">31</xref>]. Another gene <italic toggle="yes">NRGN</italic> regulates synaptic plasticity crucial for synaptic function [<xref rid="pgen.1011189.ref032" ref-type="bibr">32</xref>]. The trends of trajectories of the three genes are similar and upward (right panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). This observation is consistent with the development of cognition discussed previously.</p>
    </sec>
    <sec id="sec009">
      <title>Uncover biological mechanisms underlying the development of specific brain regions</title>
      <p>The tissue representation from INSIDER enables us to explore BPs in specific brain regions by computing their adjusted gene expression profiles. Specifically, the adjusted gene expression profiles for brain regions were obtained by multiplying <italic toggle="yes">T</italic> with <italic toggle="yes">V</italic>. In the multiplication, two metagenes with the least variance across different brain regions were excluded because they aggregate the expression of cell metabolic and ATP metabolic processes and cell communication. Thus, excluding them enables us better uncover BPs related to brain development.</p>
      <p>Then, we conducted enrichment analyses on the adjusted gene expression profile of M1C-S1C (primary motor and somatosensory cortex) to explore up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>) BPs for the brain region. We have no particular preference for specific brain region for further analysis; the main reason for choosing M1C-S1C for presentation is that its function is probably more specific and has less overlap with other regions, so the biological relevance of our approach can be better demonstrated.</p>
      <p>The M1C-S1C is mainly responsible for generating signals to direct the body’s movement and processing somatic sensations. The development of this region involves axonogenesis and regulation of neuron projection development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and thus increases connectivity between synapses. The levels of synaptic activities also increase with the increased connectivity [<xref rid="pgen.1011189.ref033" ref-type="bibr">33</xref>]. Therefore, it is reasonable to observe that BPs involved in synaptic activities, such as chemical synaptic transmission, trans−synaptic signaling, and synaptic plasticity, are upregulated in this brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>). However, the levels of gene expression for BPs involved in the development of human organs, such as the kidney, renal system, spinal cord, and sensory organ (e.g., inner ear and ear), are low in the brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>).</p>
      <p>In summary, through the analysis of the BrainSpan data, the advantages of INSIDER have been demonstrated. It enables analyzing gene expression data that cannot be readily formatted into 3D tensors, as there could be several observations for some combinations of brain regions and developmental stages. Our approach reveals the brain developmental trajectories by metagenes, and up- and down-regulated BPs encoded by the metagenes. Our method also characterizes the molecular basis underlying neurodevelopment for different brain regions and developmental stages by examining their underlying up- and down-regulated BPs. However, standard PCA- and especially GLM-based methods are unapplicable for these tasks in RNA-seq data analysis. Moreover, NMF may not be readily applicable as it is not straightforward to directly infer down-regulations of gene expression.</p>
    </sec>
    <sec id="sec010">
      <title>Analysis of the aging, dementia, and TBI data</title>
      <p>Dementia is a kind of neurodegenerative disorder, and there are various underlying causes. Traumatic brain injury (TBI) may lead to dementia, but the most common cause is Alzheimer’s disease (AD). The Aging, Dementia, and TBI Study aims to characterize neuropathologic, molecular, and transcriptomic changes in the brains of controls and TBI cases from an aged population-based cohort [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>], which offers RNA-Seq data of temporal cortex (TC), parietal cortex (PC), cortical white matter (WM), and hippocampus (HPC) of controls and TBI cases.</p>
      <p>We downloaded the aging, dementia, and TBI data from the website provided in [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>]. The dimension of our dataset is 377 × 44,477, and the RNA-seq samples come from 107 donors. In this analysis, we seek to explore BPs contributing to the progression of dementia and discover BPs contributing to dementia in specific brain structures. Here we modeled four covariates: donor, brain structure, diagnosis of dementia, and gene, and incorporated interactions between brain structures and phenotype (dementia diagnosis). The number of ranks <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 23.</p>
    </sec>
    <sec id="sec011">
      <title>Clustering analysis of donor representations</title>
      <p>It is challenging to perform clustering analysis in high-dimensional settings, for example, with high-dimensional omics data. However, INSIDER enables us to cluster donors with donor representations to characterize donors and even identify disease subtypes, which is in line with personalized treatment delivery. In practice, we performed hierarchical clustering with latent donor representations (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3A</xref>) without the least variable metagene, which encodes BPs related to ATP metabolic processes. We selected two as the number of clusters. Subsequently, we examined the clinical or demographic relevance of the clusters. The two-tailed standard (<italic toggle="yes">P</italic> = 0.0251) and rank-based ANOVA tests (<italic toggle="yes">P</italic> = 0.0185) indicate that the clustering memberships statistically correlate with donor age distribution. We note that age itself was not included as an input for clustering, yet our clustering primarily based on expression data is able to identify subgroups with important clinical differences (e.g., age).</p>
      <fig position="float" id="pgen.1011189.g003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Downstream analyses with results from the application to the aging, dementia, and TBI data.</title>
          <p>A. The figure shows the dendrogram of hierarchical clustering with donor representations. B. The top 30 down-regulated BPs enriched for the difference in gene expression between dementia and control are displayed. C. The top 30 down-regulated BPs enriched by the difference in gene expression of left HPC between dementia and control are presented.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g003" position="float"/>
      </fig>
      <p>We also explored whether donor representations enable us to reveal subgroups related to subtypes of dementia. Since not all metagenes are associated with dementia, we filtered off several metagenes that have little relevance to dementia by examining the relevance of the top 30 up- and down-regulated BPs to dementia by searching literatures. Then, we performed hierarchical clustering on donor representation with these kept metagenes. The dendrogram (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3A Fig</xref>) indicates three subgroups.</p>
      <p>Two-tailed standard (<italic toggle="yes">P</italic> = 0.0205) and rank-based (<italic toggle="yes">P</italic> = 0.0731) ANOVA tests yielded similar <italic toggle="yes">p</italic>-values when we examined the association between the clustering and age distribution. In further exploring its relevance to the clinical diagnoses of dementia, Fisher’s exact tests revealed that clusters have a statistically significant association with the Braak staging of dementia (<italic toggle="yes">P</italic> = 0.0025) and showed a trend of association with diagnoses of dementia by the NINCDS-ADRDA Alzheimer’s criteria (<italic toggle="yes">P</italic> = 0.108), one of the most widely used criteria in the diagnosis of Alzheimer’s disease. Note that clinical or pathological features related to staging are not used as input for the clustering, hence this serves as an ‘external validation’ of the validity of the clusters. In other words, our proposed clustering framework, primarily based on expression profiles with dimension reduction by INSIDER, might indeed be useful in identifying clinically distinct and meaningful subgroups, which are consistent with widely used clinical staging/diagnosis systems.</p>
    </sec>
    <sec id="sec012">
      <title>Metagenes reveal the biological mechanism of dementia</title>
      <p>Here we explored the BPs significantly down-regulated in dementia compared with controls to shed light on the mechanism of dementia. In practice, we selected the top 2 variable metagenes in phenotype representation, as they achieved the most significant <italic toggle="yes">p</italic>-values in the following enrichment analysis. Then, the adjusted gene expression profiles for dementia and control were obtained by multiplying phenotype representations by gene representation with only the selected metagenes. Subsequently, we examined down-regulated BPs enriched by the difference in gene expression between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>).</p>
      <p>The top 30 BPs enriched for down-regulated genes are statistically significant at the <italic toggle="yes">p&lt;</italic>5e-5 level. We observed that expression levels of genes for BPs involved in cognition, learning, and memory were significantly lower in the dementia brain than in the control brain (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). In addition, significant differences in BPs related to synaptic activities, such as trans-synaptic signaling, and chemical synaptic transmission, were also observed when comparing dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). This observation is supported by previous studies [<xref rid="pgen.1011189.ref035" ref-type="bibr">35</xref>–<xref rid="pgen.1011189.ref037" ref-type="bibr">37</xref>], suggesting that synaptic signaling and transmission play indispensable roles in the nervous system function, and their dysfunctions might be important contributing factors to dementia.</p>
      <p>Interestingly, expression levels of genes involved in ossification (bone tissue formation) are also significantly different between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). The connection between impaired bone microarchitecture or regeneration and dementia has been reported [<xref rid="pgen.1011189.ref038" ref-type="bibr">38</xref>]. Moreover, a degree of comorbidity of AD and osteoporosis is also supported by epidemiological studies [<xref rid="pgen.1011189.ref039" ref-type="bibr">39</xref>]. On the other hand, several BPs related to metal ions are also identified in the enrichment analysis (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>), suggesting that expression levels of genes involved in these BPs are lower in dementia than in normal. Since metal ions play essential roles in neurotransmitter synthesis and energy metabolism, their deficiencies may contribute to cognitive decline and memory loss [<xref rid="pgen.1011189.ref040" ref-type="bibr">40</xref>], which are the most common symptoms of dementia.</p>
    </sec>
    <sec id="sec013">
      <title>Metagenes characterize donors and functions of brain regions</title>
      <p>In addition to revealing the mechanism of dementia, metagenes can help us to characterize donors and reveal functions of brain regions among the aged donors.</p>
      <p>We first employed standard two-tailed t-tests to identify metagenes associated with donor characteristics. Statistical test results showed the most statistically significant difference in loadings for the 13<sup>th</sup> metagene between donors who experienced TBI with loss of consciousness (LOC) and those not experiencing TBI (<italic toggle="yes">P</italic> = 0.0242). Subsequent enrichment analysis with the 13<sup>th</sup> metagene reveals that the top 30 down-regulated BPs involve cognitive functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3B Fig</xref>), suggesting that experiencing TBI with LOC may be associated with cognitive dysfunction.</p>
      <p>For demonstration, we highlighted one metagene (17<sup>th</sup>) to reveal the functions of the white matter (WM) (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>) of the forebrain. The loadings of the 17<sup>th</sup> metagene are negative only for WMs of both the left and right forebrain (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>). Subsequent enrichment analysis with the 17<sup>th</sup> metagene revealed that the top 30 up-regulated BPs involve learning, memory, cognition, and synaptic functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3C Fig</xref>).</p>
      <p>This suggests that expression of genes involved in these BPs is relatively low in the WM of both the left and right forebrains, compared to other brain regions. Moreover, we noticed that the loading of this metagene is lower in the WM of the left forebrain than in its counterpart. However, this cannot help us lead to the claim that the WM of the left forebrain is less involved in these BPs than its counterpart, as a single metagene may not show the whole picture of the involvement of WMs.</p>
      <p>To further clarify the issue, we examined the top down-regulated BPs in WMs of the left and right forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E and S3F Fig</xref>, respectively). The BPs down-regulated in WM of the left forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E Fig</xref>) are slightly more statistically significant than those in the right counterpart (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3F Fig</xref>). On the other hand, the BPs down-regulated in both areas are basically the same. Our analysis suggests that both areas of the WM may similarly involve in dementia.</p>
    </sec>
    <sec id="sec014">
      <title>Incorporating the interaction improves INSIDER</title>
      <p>To verify that the performance of INSIDER is significantly improved by considering interaction, we conducted the following statistical test. Generally, performance on held-out data is considered a golden standard to evaluate model performance. Thus, we examine whether incorporating interaction terms improves the performance of INSIDER on held-out data using RMSE. First, we randomly drew 10% of the elements without replacement from the data matrix as testset and considered the left elements as trainset. Second, we followed the same procedure to select hyperparameters for INSIDER with and without the interaction term. Then, we ran INSIDER on the trainset with the selected hyperparameters 50 times for 30 iterations with different parameter initializations and reported their RMSE on the testset. Finally, we examined whether the RMSE of INSIDER with interaction is statistically significantly lower than that of INSIDER without interaction with a one-sided <italic toggle="yes">t</italic>-test. The <italic toggle="yes">p</italic>-value (<italic toggle="yes">p</italic>-value &lt; 2.2e-16) from the test suggests that incorporating interaction improves the performance of INSIDER. The mean with standard error for INSIDER with and without interaction are 0.2297+0.0001 and 0.2302+0.0001, respectively. To our knowledge, the relatively small improvement in RMSE is due to the fact that only a small proportion of genes contribute to the interaction between dementia and brain structures.</p>
    </sec>
    <sec id="sec015">
      <title>Discover heterogeneous effects of dementia on brain structures</title>
      <p>Here we further show that the interaction term improves model interpretation of INSIDER. As dementia was shown to have potentially heterogeneous effects on the left and right HPC at gene levels (Section II in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4 Fig</xref>), we seek to compare BPs down-regulated by dementia in the left and right HPC to clarify the issue further.</p>
      <p>Here we will highlight how INSIDER with interaction is useful in unraveling interactions between biological variables (in this case, dementia diagnosis × brain structure). Compared to controls, dementia is associated with changes in gene expression, but the degree of change may not be uniform across different brain structures/regions. For instance, dementia may increase the expression of gene <italic toggle="yes">X</italic> by 1 unit, and the expression is also, on average, elevated by 1 unit across brain regions. However, dementia could be associated with a 5-unit increase in gene <italic toggle="yes">X</italic> expression in region <italic toggle="yes">Y</italic>, due to the presence of an interaction.</p>
      <p>First, we used the left HPC as an example to show how to obtain BPs down-regulated by dementia. First, we multiplied the submatrix <italic toggle="yes">W</italic><sub><italic toggle="yes">k</italic></sub> of interaction representation corresponding to the left HPC by gene representation <italic toggle="yes">V</italic>. In the operation, several metagenes with the least variance in the submatrix were excluded. Technical details of metagene selection are provided in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>. Then, we examined the down-regulated BPs enriched by genes showing significant differences in expression in the left HPC between dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>). Similarly, BPs down-regulated by dementia in the right HPC can be obtained (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>).</p>
      <p>Overall, most down-regulated BPs are more significant in the left HPC (<italic toggle="yes">P</italic> at 1e-66 in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>) than in the right (<italic toggle="yes">P</italic> at 2e-57 in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>). Moreover, the gene ratio in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> is also greater than in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>. Here gene ratio is the proportion of genes enriched for a BP. Regarding BPs enriched for the two brain structures, there is little difference in general. This leads to a similar finding that the left and right HPC may be affected differently by dementia and supported by previous studies we discussed earlier.</p>
      <p>To summarize, INSIDER demonstrates the following advantages over existing methods in analyzing the aging, dementia, and TBI data. INSIDER enables clustering donors into disease subtypes. This task is inapplicable to GLM-based methods for DGE analysis. Moreover, INSIDER reduces dimension with respect to one variable (e.g., donor) while controlling for variation from other variables (e.g., brain regions) and helps gain insights into the interaction between brain regions and dementia diagnosis. However, PCA- and NMF-based methods are also not applicable for these tasks, as they cannot perform dimension reduction with respect to different covariates separately and consider the interaction between covariates. Moreover, tensor decomposition cannot be employed to explore the interaction, as there are several observations for different combinations of brain regions and diagnosis of dementia and thus the data cannot be formatted into order-3 tensors.</p>
    </sec>
    <sec id="sec016">
      <title>Computing time and memory requirements</title>
      <p>The computing time of INSIDER varies depending on the stopping criteria and computational resources allocated. In our study, with the defined stopping criteria, INSIDER takes approximately 5 hours and 8 hours to run the BrainSpan dataset (524×43,411) and the aging, dementia, and TBI dataset (377×44,477), respectively, when using 30 cores (Intel Xeon Gold 6230 CPU @2.10GHz).</p>
      <p>Owing to our implementation with RcppArmadillo for parallel computing, INSIDER has relatively low memory requirements. It requires less than 5GB of memory for the BrainSpan dataset and the aging, dementia, and TBI dataset.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Discussion</title>
    <p>We demonstrated the versatility and potential of INSIDER through applications in which various downstream analyses were performed. In the first application, the development trajectories across the human life span were revealed, and up- and down-regulated BPs underlying them were uncovered. Moreover, the implicated brain regions were characterized. In the other application, we explored the mechanisms contributing to dementia, identified subgroups among donors with latent donor representations, and examined the contribution of tissues (e.g., brain regions) to biological conditions (e.g., dementia). Our results are supported by the literature. For example, the interpretation of the development trajectories is consistent with findings from previous studies.</p>
    <p>INSIDER has the following advantages. First, it is general and flexible, in which covariates and interactions in modeling can be adjusted according to research interest. Second, it is versatile and interpretable in terms of downstream analysis. Various downstream analyses were carried out, such as revealing development trajectory, clustering donors, revealing disease mechanisms, and exploring interactions between covariates. Third, it encourages sparsity in gene representations by introducing elastic-net regularization, thus facilitating result interpretations. Fourth, it can capture interactions between covariates, common in biological settings. Finally, it has good scalability and allows missing values.</p>
    <p>Moreover, the advantages of INSIDER over existing methods have been demonstrated via applications. Compared with INSIDER, GLM-based methods for DGE analysis do not aim for dimension reduction and thus do not enable clustering donors in low-dimension, revealing developmental trajectories, and characterizing brain regions or development stages. Moreover, traditional PCA/factor analysis decomposes the variation of <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> by <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> = <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup>
<italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup>. Both <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup> and <italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> are unobserved. The <italic toggle="yes">L</italic> combines two or more variables into a single component/factor. Similarly, INSIDER combines several genes that tend to be co-expressed or work together to induce biological functions into a single metagene. Thus, <italic toggle="yes">V</italic> in INSIDER is analogous to <italic toggle="yes">L</italic> in factor analysis, the elements of <italic toggle="yes">V</italic> represent the effects of metagenes on individual genes, and the contribution of individual genes to each metagene is represented by the corresponding row of <italic toggle="yes">V</italic>. Moreover, INSIDER can be considered a generalization/extension of factor analysis, where the factors are modelled as being under the influence of some covariates. In INSIDER, we introduce a model of <italic toggle="yes">F</italic> in terms of covariates <italic toggle="yes">X</italic> by <italic toggle="yes">F</italic> = <italic toggle="yes">XB</italic>, where <italic toggle="yes">X</italic> is an indicator matrix of measured covariates and <italic toggle="yes">B</italic> is a matrix of coefficients. The covariates are classified into donor (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>), phenotype (<italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>), tissue (<italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>), and phenotype-by-tissue interactions (<italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>). However, these indicator matrices can be joined into a single matrix <italic toggle="yes">X</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>), if the coefficient matrices are also joined together into a single matrix <italic toggle="yes">B</italic> = (<italic toggle="yes">D</italic><sup>⊺</sup>,<italic toggle="yes">P</italic><sup>⊺</sup>,<italic toggle="yes">T</italic><sup>⊺</sup>,<italic toggle="yes">W</italic><sup>⊺</sup>)<sup>⊺</sup>. Thus, this gives the overall INSIDER model by <italic toggle="yes">Z</italic> = <italic toggle="yes">XBV</italic> + Θ. Different from PCA/factor analysis, INSIDER directly associates the covariates (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>) with the metagenes through the matrices <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>, and this provides insights on how covariates affect the biological pathways. However, the estimation of <italic toggle="yes">V</italic> in PCA/factor analysis is not guided by the covariates and thus it cannot directly associate the components/factors with the covariates. In addition, INSIDER enables computing adjusted expression profiles for covariates, thus uncovering the effect of covariates on gene expression. In contrast with INSIDER, standard NMF-based methods cannot model variation from <italic toggle="yes">multiple</italic> variables separately and capture their interaction. and unable directly infer down-regulation in biological settings, which impairs its interpretability. Compared with tensor decomposition, the closest analog of INSIDER, INSIDER also demonstrates its superiority through simulation studies and is able to handle the situation where the data matrix cannot be formatted into tensors, as demonstrated via applications. A more explicitly comparison of the above capabilities of INSIDER with those of the other methods is displayed in <xref rid="pgen.1011189.s008" ref-type="supplementary-material">S3 Table</xref>.</p>
    <p>Bulk RNA-Seq techniques are popular in studying tissue-specific expression profiles. Usually, confounding variables (covariates) are inevitably introduced in the RNA-Seq expression data. For example, GTEx [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] data contains confounding variables and other features leading to variations in expression, such as donor, gender, and age. However, few studies fully addressed the issue of <italic toggle="yes">multiple</italic> confounders or covariates while also achieving dimensionality reduction (DR). Existing approaches such as PCA, factor analysis, and non-negative matrix factorization only can reduce data dimensionality but have substantial limitations, as described above. The importance of an improved methodology to perform DR in high-dimensional data with <italic toggle="yes">multiple</italic> covariates has become more prominent with the increasing availability of RNA-seq data and the popularity of joint data analysis from different sources. For example, the PsychENCODE project [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>] is composited of several independent projects, such as ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>], CMC (the CommonMind Consortium) [<xref rid="pgen.1011189.ref041" ref-type="bibr">41</xref>], and BrainGVEX [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], with different study aims. INSIDER well addresses the challenge and takes account of sparsity in gene expression and the interaction between covariates simultaneously. More importantly, it has excellent interpretability and can be applied to large-scale data analysis.</p>
    <p>Meanwhile, we notice that the development stages are in chronological order. In practice, we consider them as unordered categorical variables because human brain development is nonlinear and the development of brain structures is specific to certain development stages, as we discussed previously. It is more reasonable to model development stages as unordered categorical variables. On the other hand, our simulation studies show that INSIDER can recover the monotonic trend for ordinal variables (Section VI in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Therefore, it is a feasible solution for INSIDER to consider ordinal variables as unordered categorical variables. It is ideal for INSIDER to consider ordinal variables explicitly. We would like to address this issue in future.</p>
    <p>Future works may also include further analysis of various bulk RNA-seq datasets and extend it to single-cell data analysis. In addition, further experimental studies to validate the findings from our applications will be an important future direction. We note that the biological findings should be considered tentative until further replicated by further experimental and clinical studies.</p>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Conclusion</title>
    <p>This article proposed a novel statistical approach, INSIDER, based on matrix decomposition, to model the variation contributed by confounding variables or covariates in bulk RNA-Seq data and decompose it into a shared low-rank latent space. The variation may originate differently, such as donor, gender, tissue, or other biological conditions. INSIDER is a general and flexible framework, which is robust to missing values. In particular, it can capture interactions between variables or covariates. Moreover, it encourages sparsity in latent representations by imposing the elastic net penalty, thus facilitating model interpretations. In our applications, various downstream analyses were carried out based on results from INSIDER. The broad applicability of INSIDER in biomedical and clinical settings was demonstrated in the applications.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec019">
    <title>Methods</title>
    <p>Here we propose INSIDER, based on additive matrix factorization, to decompose heterogeneous biological variation in RNA-Seq data into a low-rank latent space.</p>
    <sec id="sec020">
      <title>Model specifications</title>
      <p>Denote <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> as the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>. We assume that there are <italic toggle="yes">N</italic> observations, <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> is modelled as
<disp-formula id="pgen.1011189.e024"><alternatives><graphic xlink:href="pgen.1011189.e024.jpg" id="pgen.1011189.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>, <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>, <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>, <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the source information is unavailable. Note that the above equation incorporates the interaction effect between tissues and phenotypes via introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. The objective function that we seek to minimize for <xref rid="pgen.1011189.e024" ref-type="disp-formula">Eq 1</xref> is defined as
<disp-formula id="pgen.1011189.e025"><alternatives><graphic xlink:href="pgen.1011189.e025.jpg" id="pgen.1011189.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e026"><alternatives><graphic xlink:href="pgen.1011189.e026.jpg" id="pgen.1011189.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pgen.1011189.e027"><alternatives><graphic xlink:href="pgen.1011189.e027.jpg" id="pgen.1011189.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be represented with matrix notations. Let <italic toggle="yes">Z</italic> ∈ ℝ<sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> represent the data matrix for the expression profile of <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The matrices <inline-formula id="pgen.1011189.e028"><alternatives><graphic xlink:href="pgen.1011189.e028.jpg" id="pgen.1011189.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the rank <italic toggle="yes">K</italic> latent representations for <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, <italic toggle="yes">N</italic><sub>3</sub> tissues, <italic toggle="yes">N</italic><sub>2</sub> * <italic toggle="yes">N</italic><sub>3</sub> interactions, <italic toggle="yes">N</italic> observations, and <italic toggle="yes">M</italic> genes, respectively. <inline-formula id="pgen.1011189.e029"><alternatives><graphic xlink:href="pgen.1011189.e029.jpg" id="pgen.1011189.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are indicator matrices, representing the dummy design matrices for <italic toggle="yes">N</italic> samples. <italic toggle="yes"><inline-formula id="pgen.1011189.e030"><alternatives><graphic xlink:href="pgen.1011189.e030.jpg" id="pgen.1011189.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic> is an identity matrix, which can be ignored and is added for the consideration of consistency in notations. <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be rewritten as:
<disp-formula id="pgen.1011189.e031"><alternatives><graphic xlink:href="pgen.1011189.e031.jpg" id="pgen.1011189.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e032"><alternatives><graphic xlink:href="pgen.1011189.e032.jpg" id="pgen.1011189.e032g" position="anchor"/><mml:math id="M32" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e033"><alternatives><graphic xlink:href="pgen.1011189.e033.jpg" id="pgen.1011189.e033g" position="anchor"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Missing entries in <italic toggle="yes">Z</italic> are removed in the summation in the first line of the equation.</p>
    </sec>
    <sec id="sec021">
      <title>Model fitting</title>
      <p>Alternating block coordinate descent (BCD) was employed to optimize <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. In each iteration, we update all parameters of INSIDER sequentially. We repeat the process until the stop criteria meets.</p>
    </sec>
    <sec id="sec022">
      <title>Optimize the objective function</title>
      <p>First, we choose to maximize the objective function with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> in <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. By fixing all <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> and taking the derivative with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, we can have the update for <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> as follows
<disp-formula id="pgen.1011189.e034"><alternatives><graphic xlink:href="pgen.1011189.e034.jpg" id="pgen.1011189.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e035"><alternatives><graphic xlink:href="pgen.1011189.e035.jpg" id="pgen.1011189.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub> is the set of row indices of samples with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">j</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub>. Similarly, the update for <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub> can be derived as
<disp-formula id="pgen.1011189.e036"><alternatives><graphic xlink:href="pgen.1011189.e036.jpg" id="pgen.1011189.e036g" position="anchor"/><mml:math id="M36" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e037"><alternatives><graphic xlink:href="pgen.1011189.e037.jpg" id="pgen.1011189.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub> is the set of row indices of samples from tissue <italic toggle="yes">h</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">h</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub>. Likewise, we can have the update for <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>:
<disp-formula id="pgen.1011189.e038"><alternatives><graphic xlink:href="pgen.1011189.e038.jpg" id="pgen.1011189.e038g" position="anchor"/><mml:math id="M38" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e039"><alternatives><graphic xlink:href="pgen.1011189.e039.jpg" id="pgen.1011189.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub> is the set of row indices of samples from donor <italic toggle="yes">i</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">i</italic></sub> denote the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub>. Besides, the update for <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e040"><alternatives><graphic xlink:href="pgen.1011189.e040.jpg" id="pgen.1011189.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e041"><alternatives><graphic xlink:href="pgen.1011189.e041.jpg" id="pgen.1011189.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub> is the set of row indices of samples of tissue <italic toggle="yes">h</italic> with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">jh</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub>. Finally, the update for <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e042"><alternatives><graphic xlink:href="pgen.1011189.e042.jpg" id="pgen.1011189.e042g" position="anchor"/><mml:math id="M42" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e043"><alternatives><graphic xlink:href="pgen.1011189.e043.jpg" id="pgen.1011189.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pgen.1011189.e044"><alternatives><graphic xlink:href="pgen.1011189.e044.jpg" id="pgen.1011189.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the <italic toggle="yes">s</italic>-th row of <inline-formula id="pgen.1011189.e045"><alternatives><graphic xlink:href="pgen.1011189.e045.jpg" id="pgen.1011189.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is latent representation for the <italic toggle="yes">s</italic>-th sample.</p>
      <p>In the above, we derived the updates for <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>,<italic toggle="yes">U</italic> for categorical covariates. In fact, INSIDER can also handle continuous covariate. For illustration, let denote <italic toggle="yes">q</italic> is a vector of length <italic toggle="yes">K</italic> for latent representation for a continuous covariate, and <inline-formula id="pgen.1011189.e046"><alternatives><graphic xlink:href="pgen.1011189.e046.jpg" id="pgen.1011189.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the variable across <italic toggle="yes">N</italic> observations.</p>
      <disp-formula id="pgen.1011189.e047">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e047.jpg" id="pgen.1011189.e047g" position="anchor"/>
          <mml:math id="M47" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi mathvariant="script">L</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>q</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>T</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>W</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>U</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>V</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mo>|</mml:mo>
              <mml:mo>|</mml:mo>
              <mml:mi>Z</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mfenced>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>D</mml:mi>
                  </mml:msub>
                  <mml:mi>D</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>q</mml:mi>
                  </mml:msub>
                  <mml:msup>
                    <mml:mi>q</mml:mi>
                    <mml:mo>⊤</mml:mo>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msub>
                  <mml:mi>T</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>W</mml:mi>
                  </mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>U</mml:mi>
                  </mml:msub>
                  <mml:mi>U</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mi>V</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:msubsup>
                <mml:mo>|</mml:mo>
                <mml:mi>F</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e048">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e048.jpg" id="pgen.1011189.e048g" position="anchor"/>
          <mml:math id="M48" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>q</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>W</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>U</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e049">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e049.jpg" id="pgen.1011189.e049g" position="anchor"/>
          <mml:math id="M49" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <p>In the equation, the meaning of other notations is the same as in the manuscript. With other parameters fixed, the objective function with respect to <italic toggle="yes">q</italic> can be simplified as follows:
<disp-formula id="pgen.1011189.e050"><alternatives><graphic xlink:href="pgen.1011189.e050.jpg" id="pgen.1011189.e050g" position="anchor"/><mml:math id="M50" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mi>q</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>Tr</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo>∥</mml:mo><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e051"><alternatives><graphic xlink:href="pgen.1011189.e051.jpg" id="pgen.1011189.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> By minimizing the objective with respect to <italic toggle="yes">q</italic>, the update for <italic toggle="yes">q</italic> can be obtained by
<disp-formula id="pgen.1011189.e052"><alternatives><graphic xlink:href="pgen.1011189.e052.jpg" id="pgen.1011189.e052g" position="anchor"/><mml:math id="M52" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⊤</mml:mo></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>This feature has been incorporated into the software of INSIDER.</p>
      <p>When we seek to minimize the objective function defined by <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> with respect to <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub>, the <italic toggle="yes">m</italic>-th column of <italic toggle="yes">V</italic>, with all the other parameters fixed, the equation can be simplified into the following elastic net problem
<disp-formula id="pgen.1011189.e053"><alternatives><graphic xlink:href="pgen.1011189.e053.jpg" id="pgen.1011189.e053g" position="anchor"/><mml:math id="M53" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Here <inline-formula id="pgen.1011189.e054"><alternatives><graphic xlink:href="pgen.1011189.e054.jpg" id="pgen.1011189.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> is the expression levels of the <italic toggle="yes">m</italic>-th gene across the <italic toggle="yes">N</italic> samples, and missing entries in <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> are removed in the calculation. The randomized coordinate descent (RCD) algorithm proposed in Algorithm 1 in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> is employed to optimize each column of <italic toggle="yes">V</italic> in parallel.</p>
      <p>In practice, optimizing the subproblems defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> is computationally intensive. The safe rules for screening are adopted to accelerate the computation, which discard variables with coefficients that are shrunk to zero in optimization. To illustrate with <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref>, the rules defined by Eq. 24 in the study [<xref rid="pgen.1011189.ref042" ref-type="bibr">42</xref>] for discarding predictor <italic toggle="yes">j</italic> is
<disp-formula id="pgen.1011189.e055"><alternatives><graphic xlink:href="pgen.1011189.e055.jpg" id="pgen.1011189.e055g" position="anchor"/><mml:math id="M55" display="block" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pgen.1011189.e056"><alternatives><graphic xlink:href="pgen.1011189.e056.jpg" id="pgen.1011189.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic toggle="yes">u</italic><sub><italic toggle="yes">j</italic></sub> is the <italic toggle="yes">j</italic>-th column of <italic toggle="yes">U</italic>.</p>
    </sec>
    <sec id="sec023">
      <title>Initialization, hyperparameter tuning and the stopping criterion</title>
      <p>Regarding initialization of <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, <italic toggle="yes">T</italic>, <italic toggle="yes">W</italic>, <italic toggle="yes">U</italic>, <italic toggle="yes">V</italic> defined in the <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>, they are initiated from normal distribution <italic toggle="yes">N</italic>(0, 0.001). We consider the solution from the previous iteration as warm start for the subproblem defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> in optimization.</p>
      <p>In model selection, we use the following procedure to select the hyperparameters {<italic toggle="yes">K</italic>,<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>} for INSIDER. Specifically, we first randomly draw 10% of elements without replacement from the data matrix as testset and consider the left data as trainset. Only the trainset is used to train INSIDER, and the testset is independent from model training and utilized for model selection. Specifically, we first train INSIDER on the trainset and then examine whether our approximations for the testset by the trained model can well approximate their real values. This practice is also consistent with the idea of cross-validation, which performs model selection based on model performance on held-out data. In fact, it is also widely used in recommendation systems [<xref rid="pgen.1011189.ref043" ref-type="bibr">43</xref>] and matrix completion [<xref rid="pgen.1011189.ref044" ref-type="bibr">44</xref>]. To evaluate the performance of INSIDER with different hyperparameters, the root mean squared error (RMSE) on the testset is calculated, which measures the root averaged squared difference between the approximations from INSIDER and the real values, so a lower RMSE on the testset corresponds to a better model.</p>
      <p>In our applications, <italic toggle="yes">K</italic> was chosen from a sequence from 10 to 30 with step size 2. The range of <italic toggle="yes">K</italic> is enough in general and can be broadened to consider more complex models. For each try of <italic toggle="yes">K</italic> from the sequence, we run INSIDER for 30 iterations. In the process, <italic toggle="yes">λ</italic> is set to 0.1 to avoid singularity in matrix inverse, and <italic toggle="yes">α</italic> is fixed to 0. Then, we select the rank <italic toggle="yes">K</italic> corresponding to the lowest RMSE on the testset. Empirical evidence shows that 30 iterations are sufficient to give consistent selection results, compared with 50 iterations (Section IV in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Also, previous studies [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>] utilized a small number of iterations (e.g., 20 iterations) to select the rank <italic toggle="yes">K</italic> for the methods based on matrix factorization. Note that our method for selecting <italic toggle="yes">K</italic> is quite computationally efficient, since we set <italic toggle="yes">α</italic> = 0 and the update for all parameters can be computed in a closed form.</p>
      <p>After choosing <italic toggle="yes">K</italic>, we define a parameter grid for {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>}. For each set of candidate hyperparameters {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>},we also run alternating BCD for 30 iterations and choose the parameters with the best performance on the test set.</p>
      <p>In our study, the stopping criteria is defined as
<disp-formula id="pgen.1011189.e057"><alternatives><graphic xlink:href="pgen.1011189.e057.jpg" id="pgen.1011189.e057g" position="anchor"/><mml:math id="M57" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where <inline-formula id="pgen.1011189.e058"><alternatives><graphic xlink:href="pgen.1011189.e058.jpg" id="pgen.1011189.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ℒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>·</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes the loss at the <italic toggle="yes">i</italic>-th iteration, and <italic toggle="yes">δ</italic> is a predefined threshold and set to 10<sup>−10</sup> in our experiment.</p>
    </sec>
  </sec>
  <sec id="sec024" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pgen.1011189.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary Content.</title>
        <p>It provides technical details on enrichment analysis, gene selection in comparing expression differences between dementia and control across brain regions, and metagene selection for discovering heterogeneous effects of dementia on brain structures. Regarding the model selection of INSIDER, it demonstrates the effect of different numbers of iterations (e.g., 30, 50) on model selection. It also shows the capability of INSIDER to handle ordinal variables via simulation studies. Regarding the difference between INSIDER and PCA/factor analysis or GLM-based approaches, it presents an in-depth discussion on their differences. To demonstrate its wide applicability, results from analyzing gender differences in gene expression of the human brain with GTEx using INSIDER are provided. Further, derivations for random coordinate descent for elastic net problems and the RCD algorithm (Algorithm 1) for the elastic net with screening rules are also presented.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s001.docx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The top 30 up- and down-regulated BPs enriched by the 2nd and 17th metages.</title>
        <p>The top 30 up-regulated BPs (S1A Fig) enriched by the 2nd metagene and down-regulated BPs (S1D Fig) by the 17th metagene are related to learning, memory, cognition, and synaptic functions and neurotransmitter activities. The top 30 down-regulated BPs (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>) enriched by the 2nd metagene involve axon development, axonogenesis, myelination, and gliogenesis. The top 30 up-regulated BPs (S1C Fig) by the 17th metagene cover the BPs related to cell development and differentiation.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s002.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The trajectory of the least variable metagene and top 30 BPs enriched by metagenes.</title>
        <p>S2A Fig shows that the trajectory of the least variable metagene is negative and basically flat across human brain development. The top 30 down-regulated BPs (S2B Fig) encoded by the metagene involve cell and ATP metabolism and cell communication. Moreover, the top 30 up-regulated BPs (S2C Fig) enriched by the 5th metagene involve ossification and development of bone, muscle, and sensory systems, and the top 30 up-regulated BPs (S2D Fig) by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s003.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Supplement Figs for analysis of the aging, dementia, and TBI data.</title>
        <p>S3A Fig shows the dendrogram of hierarchical clustering on donor representation with the selected metagenes. We selected 3 subgroups for further analysis. The top 30 down-regulated BPs (S3B Fig) enriched by the 13th metagene involve cognitive functions, and the top 30 up-regulated BPs (S3C Fig) enriched by the 17th cover learning, memory, cognition, and synaptic functions. S3D Fig shows the top 30 down-regulated BPs enriched by the difference in gene expression of right HPC between dementia and control. Overall, the <italic toggle="yes">p</italic>-values for most down-regulated BPs in S3D Fig are significant at 2e-57, which are greater than those for the left HPC shown in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> from the manuscript (<italic toggle="yes">P</italic> at 1e-66). Moreover, the gene ratio in S3D Fig is also smaller than in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>. This leads to the finding that the left and right HPC may be affected differently by dementia. S3E and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4F</xref> Figs show the top 30 down-regulated BPs enriched by the difference in expression profiles for WM of the left and right forebrain, respectively. The BPs in S3E Fig are slightly more statistically significant than those in S3F Fig and the BPs in the two figures are basically the same.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s004.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s005" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Comparison of differences in the expression of three selected genes between dementia and control across brain regions.</title>
        <p>The figure compares the expression levels of three selected genes (NRGN, CAMK2A, and SHISA6) between dementia and control across brain regions, suggesting that dementia has potentially heterogeneous effects on the left and right HPC at gene levels.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s005.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s006" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Tab A. The loadings of all metagenes across brain development stages in the analysis of the BrainSpan dataset.</title>
        <p>The table shows that the loading of the 5th metagene for the early-mid fetal stage (the 5th stage) is highly positive, and its absolute value is much larger than that of the metagene for other developmental stages. Thus, the 5th metagene can be used to characterize the stage. <bold>Tab B. The loadings of all metagenes across all brain regions in the analysis of the BrainSpan dataset.</bold> The table shows that the loading of the 1st metagene for the striatum is highly positive, and its absolute value is much larger than that of the metagene for other brain regions. Thus, the 1st metagene can be used to characterize the brain region.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s007" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The loadings of all metagenes across all brain regions in the analysis of the aging, dementia, and TBI dataset.</title>
        <p>The table shows that the loadings of the 17th metagene are only negative for FWM (both left and right) and their absolute value is much larger than those for other brain regions. Therefore, this metagene can be utilized to reveal the functions of FWM in the brains of aged donors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s008" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Comparison of INSIDER with the other methods in their capabilities in accommodating different situations in the analysis of gene expression data.</title>
        <p>In the table, we compare INSIDER with other methods, including PCA/NMF, SDA, and the GLM-based methods for DEG analysis, in their abilities to handle more than 3-dimensional data, to incorporate interaction, to allow missing data, to reduce data dimensionality, to perform differential expression analysis, and to handle multidimensional (&gt; = 3 dimensions) data that cannot fit into tensors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s008.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1011189.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>. <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature reviews genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>57</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><?supplied-pmid 19015660?><pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lonsdale</surname><given-names>J</given-names></name>, <name><surname>Thomas</surname><given-names>J</given-names></name>, <name><surname>Salvatore</surname><given-names>M</given-names></name>, <name><surname>Phillips</surname><given-names>R</given-names></name>, <name><surname>Lo</surname><given-names>E</given-names></name>, <name><surname>Shad</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>(<issue>6</issue>):<fpage>580</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><?supplied-pmid 23715323?><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Ding</surname><given-names>S</given-names></name>, <name><surname>Sunkin</surname><given-names>SM</given-names></name>, <name><surname>Smith</surname><given-names>KA</given-names></name>, <name><surname>Ng</surname><given-names>L</given-names></name>, <name><surname>Szafer</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional landscape of the prenatal human brain</article-title>. <source>Nature</source>. <year>2014</year>;<volume>508</volume>(<issue>7495</issue>):<fpage>199</fpage>–<lpage>206</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature13185</pub-id><?supplied-pmid 24695229?><pub-id pub-id-type="pmid">24695229</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Akbarian</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Knowles</surname><given-names>JA</given-names></name>, <name><surname>Vaccarino</surname><given-names>FM</given-names></name>, <name><surname>Farnham</surname><given-names>PJ</given-names></name>, <name><surname>Crawford</surname><given-names>GE</given-names></name>, <etal>et al</etal>. <article-title>The psychencode project</article-title>. <source>Nat Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1707</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nn.4156</pub-id><?supplied-pmid 26605881?><pub-id pub-id-type="pmid">26605881</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Voineagu</surname><given-names>I</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Johnston</surname><given-names>P</given-names></name>, <name><surname>Lowe</surname><given-names>JK</given-names></name>, <name><surname>Tian</surname><given-names>Y</given-names></name>, <name><surname>Horvath</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Transcriptomic analysis of autistic brain reveals convergent molecular pathology</article-title>. <source>Nature</source>. <year>2011</year>;<volume>474</volume>(<issue>7351</issue>):<fpage>380</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10110</pub-id><?supplied-pmid 21614001?><pub-id pub-id-type="pmid">21614001</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ha</surname><given-names>S</given-names></name>, <name><surname>Sohn</surname><given-names>I</given-names></name>, <name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Sim</surname><given-names>HJ</given-names></name>, <name><surname>Cheon</surname><given-names>K</given-names></name>. <article-title>Characteristics of brains in autism spectrum disorder: structure, function and connectivity across the lifespan</article-title>. <source>Experimental neurobiology</source>. <year>2015</year>;<volume>24</volume>(<issue>4</issue>):<fpage>273</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.5607/en.2015.24.4.273</pub-id><?supplied-pmid 26713076?><pub-id pub-id-type="pmid">26713076</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lord</surname><given-names>C</given-names></name>, <name><surname>Cook</surname><given-names>EH</given-names></name>, <name><surname>Leventhal</surname><given-names>BL</given-names></name>, <name><surname>Amaral</surname><given-names>DG</given-names></name>. <article-title>Autism spectrum disorders</article-title>. <source>Neuron</source>. <year>2000</year>;<volume>28</volume>(<issue>2</issue>):<fpage>355</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/s0896-6273(00)00115-x</pub-id><?supplied-pmid 11144346?><pub-id pub-id-type="pmid">11144346</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ritchie</surname><given-names>ME</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Wu</surname><given-names>DI</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>. <article-title>Differential expression analysis for sequence count data</article-title>. <source>Nature Precedings</source>. <year>2010</year>:<fpage>1</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Duchi</surname><given-names>J</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous dimension reduction and adjustment for confounding variation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>51</issue>):<fpage>14662</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1617317113</pub-id><?supplied-pmid 27930330?><pub-id pub-id-type="pmid">27930330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>X</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>. <article-title>Batch effects correction with unknown subtypes</article-title>. <source>Journal of the American Statistical Association</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>WE</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Rabinovic</surname><given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name>. <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>. <year>1999</year>;<volume>401</volume>(<issue>6755</issue>):<fpage>788</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/44565</pub-id><?supplied-pmid 10548103?><pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Qian</surname><given-names>K</given-names></name>, <name><surname>Fu</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>WV</given-names></name>. <article-title>scINSIGHT for interpreting single-cell gene expression from biologically heterogeneous data</article-title>. <source>Genome Biol</source>. <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">34980209</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Gao</surname><given-names>C</given-names></name>, <name><surname>Sodicoff</surname><given-names>J</given-names></name>, <name><surname>Kozareva</surname><given-names>V</given-names></name>, <name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Welch</surname><given-names>JD</given-names></name>. <article-title>Jointly defining cell types from multiple single-cell datasets using LIGER</article-title>. <source>Nature protocols</source>. <year>2020</year>;<volume>15</volume>(<issue>11</issue>):<fpage>3632</fpage>–<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41596-020-0391-8</pub-id><?supplied-pmid 33046898?><pub-id pub-id-type="pmid">33046898</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name>, <name><surname>Arora</surname><given-names>R</given-names></name>, <name><surname>Culhane</surname><given-names>AC</given-names></name>, <name><surname>Favorov</surname><given-names>AV</given-names></name>, <name><surname>Garmire</surname><given-names>LX</given-names></name>, <name><surname>Greene</surname><given-names>CS</given-names></name>, <etal>et al</etal>. <article-title>Enter the matrix: factorization uncovers knowledge from omics</article-title>. <source>Trends in Genetics</source>. <year>2018</year>;<volume>34</volume>(<issue>10</issue>):<fpage>790</fpage>–<lpage>805</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2018.07.003</pub-id><?supplied-pmid 30143323?><pub-id pub-id-type="pmid">30143323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kolda</surname><given-names>TG</given-names></name>, <name><surname>Bader</surname><given-names>BW</given-names></name>. <article-title>Tensor decompositions and applications</article-title>. <source>SIAM Rev</source>. <year>2009</year>;<volume>51</volume>(<issue>3</issue>):<fpage>455</fpage>–<lpage>500</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hoff</surname><given-names>PD</given-names></name>. <article-title>Hierarchical multilinear models for multiway data</article-title>. <source>Comput Stat Data Anal</source>. <year>2011</year>;<volume>55</volume>(<issue>1</issue>):<fpage>530</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Yener</surname><given-names>B</given-names></name>, <name><surname>Acar</surname><given-names>E</given-names></name>, <name><surname>Aguis</surname><given-names>P</given-names></name>, <name><surname>Bennett</surname><given-names>K</given-names></name>, <name><surname>Vandenberg</surname><given-names>SL</given-names></name>, <name><surname>Plopper</surname><given-names>GE</given-names></name>. <article-title>Multiway modeling and analysis in stem cell systems biology</article-title>. <source>BMC systems biology</source>. <year>2008</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1752-0509-2-63</pub-id><?supplied-pmid 18625054?><pub-id pub-id-type="pmid">18171472</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hore</surname><given-names>V</given-names></name>, <name><surname>Vinuela</surname><given-names>A</given-names></name>, <name><surname>Buil</surname><given-names>A</given-names></name>, <name><surname>Knight</surname><given-names>J</given-names></name>, <name><surname>McCarthy</surname><given-names>MI</given-names></name>, <name><surname>Small</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Tensor decomposition for multiple-tissue gene expression experiments</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>9</issue>):<fpage>1094</fpage>–<lpage>100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3624</pub-id><?supplied-pmid 27479908?><pub-id pub-id-type="pmid">27479908</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the royal statistical society: series B (statistical methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Brunet</surname><given-names>J</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Golub</surname><given-names>TR</given-names></name>, <name><surname>Mesirov</surname><given-names>JP</given-names></name>. <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proceedings of the national academy of sciences</source>. <year>2004</year>;<volume>101</volume>(<issue>12</issue>):<fpage>4164</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id><?supplied-pmid 15016911?><pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HJ</given-names></name>, <name><surname>Kawasawa</surname><given-names>YI</given-names></name>, <name><surname>Cheng</surname><given-names>F</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal transcriptome of the human brain</article-title>. <source>Nature</source>. <year>2011</year>;<volume>478</volume>(<issue>7370</issue>):<fpage>483</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10523</pub-id><?supplied-pmid 22031440?><pub-id pub-id-type="pmid">22031440</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Stiles</surname><given-names>J</given-names></name>, <name><surname>Jernigan</surname><given-names>TL</given-names></name>. <article-title>The basics of brain development</article-title>. <source>Neuropsychol Rev</source>. <year>2010</year>;<volume>20</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11065-010-9148-4</pub-id><?supplied-pmid 21042938?><pub-id pub-id-type="pmid">21042938</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Thomason</surname><given-names>ME</given-names></name>, <name><surname>Hect</surname><given-names>J</given-names></name>, <name><surname>Waller</surname><given-names>R</given-names></name>, <name><surname>Manning</surname><given-names>JH</given-names></name>, <name><surname>Stacks</surname><given-names>AM</given-names></name>, <name><surname>Beeghly</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Prenatal neural origins of infant motor development: Associations between fetal brain and infant motor development</article-title>. <source>Dev Psychopathol</source>. <year>2018</year>;<volume>30</volume>(<issue>3</issue>):<fpage>763</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1017/S095457941800072X</pub-id><?supplied-pmid 30068433?><pub-id pub-id-type="pmid">30068433</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>SB</given-names></name>, <name><surname>Blum</surname><given-names>RW</given-names></name>, <name><surname>Giedd</surname><given-names>JN</given-names></name>. <article-title>Adolescent maturity and the brain: the promise and pitfalls of neuroscience research in adolescent health policy</article-title>. <source>Journal of adolescent health</source>. <year>2009</year>;<volume>45</volume>(<issue>3</issue>):<fpage>216</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jadohealth.2009.05.016</pub-id><?supplied-pmid 19699416?><pub-id pub-id-type="pmid">19699416</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kennedy</surname><given-names>MB</given-names></name>. <article-title>Synaptic signaling in learning and memory</article-title>. <source>Cold Spring Harbor perspectives in biology</source>. <year>2016</year>;<volume>8</volume>(<issue>2</issue>):<fpage>a016824</fpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Herlenius</surname><given-names>E</given-names></name>, <name><surname>Lagercrantz</surname><given-names>H</given-names></name>. <article-title>Development of neurotransmitter systems during critical periods</article-title>. <source>Exp Neurol</source>. <year>2004</year>;<volume>190</volume>:<fpage>8</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.expneurol.2004.03.027</pub-id><?supplied-pmid 15498537?><pub-id pub-id-type="pmid">15498537</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Balleine</surname><given-names>BW</given-names></name>, <name><surname>Delgado</surname><given-names>MR</given-names></name>, <name><surname>Hikosaka</surname><given-names>O</given-names></name>. <article-title>The role of the dorsal striatum in reward and decision-making</article-title>. <source>Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>(<issue>31</issue>):<fpage>8161</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1554-07.2007</pub-id><?supplied-pmid 17670959?><pub-id pub-id-type="pmid">17670959</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Siems</surname><given-names>SB</given-names></name>, <name><surname>Kusch</surname><given-names>K</given-names></name>, <name><surname>Hesse</surname><given-names>D</given-names></name>, <name><surname>Jung</surname><given-names>RB</given-names></name>, <name><surname>Liepold</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>The CNS myelin proteome: deep profile and persistence after post-mortem delay</article-title>. <source>Frontiers in Cellular Neuroscience</source>. <year>2020</year>;<volume>14</volume>:<fpage>239</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fncel.2020.00239</pub-id><?supplied-pmid 32973451?><pub-id pub-id-type="pmid">32973451</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Tenzer</surname><given-names>S</given-names></name>, <name><surname>Werner</surname><given-names>HB</given-names></name>. <article-title>Myelin proteomics: molecular anatomy of an insulating sheath</article-title>. <source>Mol Neurobiol</source>. <year>2009</year>;<volume>40</volume>:<fpage>55</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12035-009-8071-2</pub-id><?supplied-pmid 19452287?><pub-id pub-id-type="pmid">19452287</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Shamir</surname><given-names>A</given-names></name>, <name><surname>Kwon</surname><given-names>O</given-names></name>, <name><surname>Karavanova</surname><given-names>I</given-names></name>, <name><surname>Vullhorst</surname><given-names>D</given-names></name>, <name><surname>Leiva-Salcedo</surname><given-names>E</given-names></name>, <name><surname>Janssen</surname><given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>The importance of the NRG-1/ErbB4 pathway for synaptic plasticity and behaviors associated with psychiatric disorders</article-title>. <source>Journal of Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>9</issue>):<fpage>2988</fpage>–<lpage>97</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1899-11.2012</pub-id><?supplied-pmid 22378872?><pub-id pub-id-type="pmid">22378872</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Fauth</surname><given-names>M</given-names></name>, <name><surname>Wörgötter</surname><given-names>F</given-names></name>, <name><surname>Tetzlaff</surname><given-names>C</given-names></name>. <article-title>The formation of multi-synaptic connections by the interaction of synaptic and structural plasticity and their functional consequences</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004031</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004031</pub-id><?supplied-pmid 25590330?><pub-id pub-id-type="pmid">25590330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Guillozet-Bongaarts</surname><given-names>A</given-names></name>, <name><surname>Gibbons</surname><given-names>LE</given-names></name>, <name><surname>Postupna</surname><given-names>N</given-names></name>, <name><surname>Renz</surname><given-names>A</given-names></name>, <name><surname>Beller</surname><given-names>AE</given-names></name>, <etal>et al</etal>. <article-title>Neuropathological and transcriptomic characteristics of the aged brain</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e31126</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.31126</pub-id><?supplied-pmid 29120328?><pub-id pub-id-type="pmid">29120328</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Torres</surname><given-names>DMC</given-names></name>, <name><surname>Cardenas</surname><given-names>FP</given-names></name>. <article-title>Synaptic plasticity in Alzheimer’s disease and healthy aging</article-title>. <source>Rev Neurosci</source>. <year>2020</year>;<volume>31</volume>(<issue>3</issue>):<fpage>245</fpage>–<lpage>68</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1515/revneuro-2019-0058</pub-id><?supplied-pmid 32250284?><pub-id pub-id-type="pmid">32250284</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Clare</surname><given-names>R</given-names></name>, <name><surname>King</surname><given-names>VG</given-names></name>, <name><surname>Wirenfeldt</surname><given-names>M</given-names></name>, <name><surname>Vinters</surname><given-names>HV</given-names></name>. <article-title>Synapse loss in dementias</article-title>. <source>J Neurosci Res</source>. <year>2010</year>;<volume>88</volume>(<issue>10</issue>):<fpage>2083</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/jnr.22392</pub-id><?supplied-pmid 20533377?><pub-id pub-id-type="pmid">20533377</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Colom-Cadena</surname><given-names>M</given-names></name>, <name><surname>Spires-Jones</surname><given-names>T</given-names></name>, <name><surname>Zetterberg</surname><given-names>H</given-names></name>, <name><surname>Blennow</surname><given-names>K</given-names></name>, <name><surname>Caggiano</surname><given-names>A</given-names></name>, <name><surname>DeKosky</surname><given-names>ST</given-names></name>, <etal>et al</etal>. <article-title>The clinical promise of biomarkers of synapse damage or loss in Alzheimer’s disease</article-title>. <source>Alzheimer’s research &amp; therapy</source>. <year>2020</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13195-020-00588-4</pub-id><?supplied-pmid 32122400?><pub-id pub-id-type="pmid">32122400</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>M</given-names></name>, <name><surname>Hu</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>. <article-title>Alzheimer’s disease and impaired bone microarchitecture, regeneration and potential genetic links</article-title>. <source>Life</source>. <year>2023</year>;<volume>13</volume>(<issue>2</issue>):<fpage>373</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/life13020373</pub-id><?supplied-pmid 36836731?><pub-id pub-id-type="pmid">36836731</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>L</given-names></name>, <name><surname>Zeng</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>APP promotes osteoblast survival and bone formation by regulating mitochondrial function and preventing oxidative stress</article-title>. <source>Cell death &amp; disease</source>. <year>2018</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41419-018-1123-7</pub-id><?supplied-pmid 30349052?><pub-id pub-id-type="pmid">29298988</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hackett</surname><given-names>MJ</given-names></name>, <name><surname>Hollings</surname><given-names>AL</given-names></name>, <name><surname>Lam</surname><given-names>V</given-names></name>, <name><surname>Takechi</surname><given-names>R</given-names></name>, <name><surname>Mamo</surname><given-names>JC</given-names></name>, <name><surname>de Jonge</surname><given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Metallo-maze to Memory Loss: Does Neuronal Metal Ion Deficiency Contribute to Dementia? Yakugaku Zasshi</article-title>: <source>Journal of the Pharmaceutical Society of Japan</source>. <year>2021</year>;<volume>141</volume>(<issue>6</issue>):<fpage>835</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">34078791</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>GE</given-names></name>, <name><surname>Bendl</surname><given-names>J</given-names></name>, <name><surname>Voloudakis</surname><given-names>G</given-names></name>, <name><surname>Montgomery</surname><given-names>KS</given-names></name>, <name><surname>Sloofman</surname><given-names>L</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>CommonMind Consortium provides transcriptomic and epigenomic data for Schizophrenia and Bipolar Disorder</article-title>. <source>Scientific data</source>. <year>2019</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30647409</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Bien</surname><given-names>J</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Simon</surname><given-names>N</given-names></name>, <name><surname>Taylor</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Strong rules for discarding predictors in lasso-type problems</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2012</year>;<volume>74</volume>(<issue>2</issue>):<fpage>245</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01004.x</pub-id><?supplied-pmid 25506256?><pub-id pub-id-type="pmid">25506256</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>Y</given-names></name>, <name><surname>Bell</surname><given-names>R</given-names></name>, <name><surname>Volinsky</surname><given-names>C</given-names></name>. <article-title>Matrix factorization techniques for recommender systems</article-title>. <source>Computer</source>. <year>2009</year>;<volume>42</volume>(<issue>8</issue>):<fpage>30</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Mazumder</surname><given-names>R</given-names></name>, <name><surname>Lee</surname><given-names>JD</given-names></name>, <name><surname>Zadeh</surname><given-names>R</given-names></name>. <article-title>Matrix completion and low-rank SVD via fast alternating least squares</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>3367</fpage>–<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10208-009-9045-5</pub-id><?supplied-pmid 31130828?><pub-id pub-id-type="pmid">31130828</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Nov 2023</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>Thank you very much for submitting your Methods entitled 'INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis' to PLOS Genetics.</p>
    <p>The manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some concerns about the current manuscript. Based on the reviews, we will not be able to accept this version of the manuscript, but we would be willing to review a much-revised version. We cannot, of course, promise publication at that time.</p>
    <p>Should you decide to revise the manuscript for further consideration here, your revisions should address the specific points made by each reviewer. We will also require a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>If you decide to revise the manuscript for further consideration at PLOS Genetics, please aim to resubmit within the next 60 days, unless it will take extra time to address the concerns of the reviewers, in which case we would appreciate an expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments are included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist" ext-link-type="uri">Submission Checklist</ext-link>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>Please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link xlink:href="http://pace.apexcovantage.com/" ext-link-type="uri">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool.  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>PLOS has incorporated <ext-link xlink:href="http://www.crossref.org/crosscheck.html" ext-link-type="uri">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, use the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage. Please do not hesitate to contact us if you have any concerns or questions.</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This article proposed a dimension reduction approach for RNA expression data to decompose variation from different biological variables, which overcomes some limitations of the existing methods and was shown to be useful in the real data analysis. My comments are as follows.</p>
    <p>1. It is still not very clear to me how to interpret the metagenes together with the covariates, especially the matrix V. Because it seems that V has nothing to do with the covariates, but the metagenes from INSIDER would be different under the models with different covariates. Also, what is the difference in the interpretation of the metagenes obtained from INSIDER compared to those obtained from PCA or factor analysis?</p>
    <p>2. The article mentioned that “INSIDER decomposes variation from different biological variables”, but only the discrete covariates have been discussed. Is INSIDER also able to handle the continuous covariates?</p>
    <p>3. In the real data analysis of BrainSpan data, development stages and brain regions are used as covariates. However, the development stages are in chronological order. Does INSIDER handle the ordinal variables and the unordered categorical variables in the same manner?</p>
    <p>4. In the section “Metagenes reveal development trajectories”, it said “The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood”. I wonder how the expression level of the metagene is calculated. Is there an explicit formula of the metagene? Could the author give more details?</p>
    <p>5. In the enrichment analyse for a metagene, say the 2nd metagene, it is not clear to me how to conduct the analyse because the metagene is a latent variable. It would be beneficial if more details could be provided.</p>
    <p>Reviewer #2: Dimension reduction is critically important in data exploration analysis. Particularly it provides the stepstone to understand the biological signals in high dimensional RNA-seq data. In this paper, the authors propose INSIDER, a general and flexible statistical framework based on matrix factorization. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve dimension reduction of high-dimensional data (of &gt;=3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample ´ expression). Besides, it enables computing 'adjusted' expression profiles for specific biological variables while controlling variation from other variables.</p>
    <p>Overall, the idea is novel and to develop new method to explain the data. better. INSIDER is a general and flexible framework. It can capture interactions between variables or covariate and encourages sparsity in latent representations by imposing the elastic net penalty. The advantages have been highlighted. The paper is well written and the motivation is explained quite clear.</p>
    <p>My minor concern is as follows,</p>
    <p>1. To use INSIDER well, the users have to know the major variation sources. For example, it’s quite typical for expression data with donors, phenotypes, tissues information. But sometimes those information is not available. How should the method be used?</p>
    <p>2. The authors added the phenotype by tissue interactions as an example. To make the method more general, it’s better to having one version without interaction term. It’s also good to demonstrate how the interaction term improves the results.</p>
    <p>3. To highlight the high-dimensional data (of &gt;=3 dimensions), it’s better to have more examples to show high-dimensional data is common and quite general case in practice.</p>
    <p>4. The choice of K is a multi-scale problem. How should we choose it in practice.</p>
    <p>5. It’s better to provide software in Github.</p>
    <p>From the editorial board:</p>
    <p>Two reviewers and the editorial team have reviewed the manuscript. They showed overall enthusiasm for the proposed method as a general and principled approach to dimension reduction, while also offering several suggestions as follow. Please carefully review those questions and suggestions and respond to them accordingly.</p>
    <p>Firstly, the authors claim that the INSIDER method can manage missing data. However, this aspect isn't explored in depth. The effect of significant and complex missing data remains uncertain. It would be beneficial to conduct further evaluations through simulation studies.</p>
    <p>Additionally, as one reviewer highlighted, the process for determining the rank K in the latent space is vague. A more clear, justifiable, and efficient method for the choice is needed.</p>
    <p>Regarding the analysis of real data, the comparison to standard and frequently used methods like PCA or GLM-based approaches is inadequate. While some discussions are present, more detailed comparative analyses are required.</p>
    <p>Lastly, showing additional simulation results in cases of model misspecification would be informative.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pgen.1011189.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">22 Jan 2024</named-content>
    </p>
    <supplementary-material id="pgen.1011189.s009" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Insider_response_letter_v4.docx</named-content></p>
      </caption>
      <media xlink:href="pgen.1011189.s009.docx"/>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Feb 2024</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been editorially accepted for publication in PLOS Genetics. Congratulations!</p>
    <p>Before your submission can be formally accepted and sent to production you will need to complete our formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Please note: the accept date on your published article will reflect the date of this provisional acceptance, but your manuscript will not be scheduled for publication until the required changes have been made.</p>
    <p>Once your paper is formally accepted, an uncorrected proof of your manuscript will be published online ahead of the final version, unless you’ve already opted out via the online submission form. If, for any reason, you do not want an earlier version of your manuscript published online or are unsure if you have already indicated as such, please let the journal staff know immediately at <email>plosgenetics@plos.org</email>.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pgenetics/" ext-link-type="uri">https://www.editorialmanager.com/pgenetics/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process. Note that PLOS requires an ORCID iD for all corresponding authors. Therefore, please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to ‘Update my Information’ (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field.  This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p>
    <p>If you have a press-related query, or would like to know about making your underlying data available (as you will be aware, this is required for publication), please see the end of this email. If your institution or institutions have a press office, please notify them about your upcoming article at this point, to enable them to help maximise its impact. Inform journal staff as soon as possible if you are preparing a press release for your article and need a publication date.</p>
    <p>Thank you again for supporting open-access publishing; we are looking forward to publishing your work in PLOS Genetics!</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>
      <ext-link xlink:href="http://www.plosgenetics.org" ext-link-type="uri">www.plosgenetics.org</ext-link>
    </p>
    <p>Twitter: @PLOSGenetics</p>
    <p>----------------------------------------------------</p>
    <p>Comments from the reviewers (if applicable):</p>
    <p>The reviewers are satisfied with the revision and I would recommend to accept the work.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my comments. No more comments.</p>
    <p>Reviewer #2: The authors have fully addressed my concerns by performing additional experiments and adding discussions. The manuscript has been greatly improved.</p>
    <p>One follow-up suggesting for optimal k selection is as follows. The training and test data split and RMSE calculation is reasonable and rigorous. In dimension reduction, people use the variance explained by the k latent variables to better understand the data structure. It would be nice to provide this index for INSIDER method and also compare with different k choices with shuffled data.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Data Deposition</bold>
    </p>
    <p>If you have submitted a Research Article or Front Matter that has associated data that are not suitable for deposition in a subject-specific public repository (such as GenBank or ArrayExpress), one way to make that data available is to deposit it in the <ext-link xlink:href="http://www.datadryad.org/" ext-link-type="uri">Dryad Digital Repository</ext-link>. As you may recall, we ask all authors to agree to make data available; this is one way to achieve that. A full list of recommended repositories can be found on our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability#loc-recommended-repositories" ext-link-type="uri">website</ext-link>.</p>
    <p>The following link will take you to the Dryad record for your article, so you won't have to re‐enter its bibliographic information, and can upload your files directly: </p>
    <p>
      <ext-link xlink:href="http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1" ext-link-type="uri">http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1</ext-link>
    </p>
    <p>More information about depositing data in Dryad is available at <ext-link xlink:href="http://www.datadryad.org/depositing" ext-link-type="uri">http://www.datadryad.org/depositing</ext-link>. If you experience any difficulties in submitting your data, please contact <email>help@datadryad.org</email> for support.</p>
    <p>Additionally, please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying display items are included with the submission, and you will need to provide this before we can formally accept your manuscript, if not already present.</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Press Queries</bold>
    </p>
    <p>If you or your institution will be preparing press materials for this manuscript, or if you need to know your paper's publication date for media purposes, please inform the journal staff as soon as possible so that your submission can be scheduled accordingly. Your manuscript will remain under a strict press embargo until the publication date and time. This means an early version of your manuscript will not be published ahead of your final version. PLOS Genetics may also choose to issue a press release for your article. If there's anything the journal should know or you'd like more information, please get in touch via <email>plosgenetics@plos.org</email>.</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pgen.1011189.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Mar 2024</named-content>
    </p>
    <p>PGENETICS-D-23-01170R1 </p>
    <p>INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis </p>
    <p>Dear Dr Lin, </p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been formally accepted for publication in PLOS Genetics! Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out or your manuscript is a front-matter piece, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Genetics and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Genetics</p>
    <p>On behalf of:</p>
    <p>The PLOS Genetics Team</p>
    <p>Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom</p>
    <p><email>plosgenetics@plos.org</email> | +44 (0) 1223-442823</p>
    <p><ext-link xlink:href="http://plosgenetics.org" ext-link-type="uri">plosgenetics.org</ext-link> | Twitter: @PLOSGenetics</p>
  </body>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pgen.1011189.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10965063</article-id>
    <article-id pub-id-type="pmid">38484017</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-23-01170</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Organism Development</subject>
            <subj-group>
              <subject>Organogenesis</subject>
              <subj-group>
                <subject>Brain Development</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Phenotypes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Dementia</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Neurodegenerative Diseases</subject>
            <subj-group>
              <subject>Alzheimer's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognition</subject>
              <subj-group>
                <subject>Memory</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Learning and Memory</subject>
            <subj-group>
              <subject>Memory</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Critical Care and Emergency Medicine</subject>
          <subj-group>
            <subject>Trauma Medicine</subject>
            <subj-group>
              <subject>Traumatic Injury</subject>
              <subj-group>
                <subject>Neurotrauma</subject>
                <subj-group>
                  <subject>Traumatic Brain Injury</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>INSIDER: Interpretable sparse matrix decomposition for RNA expression data analysis</article-title>
      <alt-title alt-title-type="running-head">Insider</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2774-6326</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Kai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Sen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Cuichan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2533-7270</contrib-id>
        <name>
          <surname>Sham</surname>
          <given-names>Pak Chung</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>So</surname>
          <given-names>Hon-Cheong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Zhixiang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of System Engineering and Engineering Management, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Psychiatry, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Psychiatry, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Centre for Genomic Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>State Key Laboratory for Cognitive and Brain Sciences, University of Hong Kong, Pokfulam, Hong Kong, China</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>School of Biomedical Sciences, The Chinese University of Hong Kong, Shatin, Hong Kong SAR, China</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>KIZ-CUHK Joint Laboratory of Bioresources and Molecular Research of Common Diseases, Kunming Institute of Zoology and The Chinese University of Hong Kong, Hong Kong, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Case Western Reserve University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hcso@cuhk.edu.hk</email> (H-CS); <email>zhixianglin@cuhk.edu.hk</email> (ZL)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>3</issue>
    <elocation-id>e1011189</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhao et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhao et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1011189.pdf"/>
    <abstract>
      <p>RNA sequencing (RNA-Seq) is widely used to capture transcriptome dynamics across tissues, biological entities, and conditions. Currently, few or no methods can handle multiple biological variables (e.g., tissues/ phenotypes) and their interactions simultaneously, while also achieving dimension reduction (DR).</p>
      <p>We propose INSIDER, a general and flexible statistical framework based on matrix factorization, which is freely available at <ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve DR of high-dimensional data (of &gt; = 3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample × expression). Besides, it enables computing ’adjusted’ expression profiles for specific biological variables while controlling variation from other variables. INSIDER is computationally efficient and accommodates missing data. INSIDER also performed similarly or outperformed a close competing method, SDA, as shown in simulations and can handle complex missing data in RNA-Seq data. Moreover, unlike SDA, it can be used when the data cannot be structured into a tensor. Lastly, we demonstrate its usefulness via real data analysis, including clustering donors for disease subtyping, revealing neuro-development trajectory using the BrainSpan data, and uncovering biological processes contributing to variables of interest (e.g., disease status and tissue) and their interactions.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>The RNA-Seq studies aim to understand the contributing role of gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development. However, our ability to understand these key issues in high-dimensional settings is hampered by the limitations of currently available methods for analyzing RNA-seq data. To address these issues, we propose a novel statistical method to jointly model variation from multiple biological variables (e.g., donor, tissue, phenotype), to introduce interactions (tissue × phenotype), and to reduce dimensionality. The favorable properties of our method are discussed below. Its advantages over one closest existing computational tool and its wide applicability are shown via simulation and applications. A computationally efficient implementation of our method is provided.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4930181</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100021366</institution-id>
            <institution>Faculty of Science, Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRIMS 4620033</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004853</institution-id>
            <institution>Chinese University of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4053540, 4053586</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002920</institution-id>
            <institution>Research Grants Council, University Grants Committee</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GRF 14301120, GRF 14300923</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9301-947X</contrib-id>
          <name>
            <surname>Lin</surname>
            <given-names>Zhixiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>ZL has been supported by the Chinese University of Hong Kong startup grant (4930181), the Chinese University of Hong Kong Science Faculty’s Collaborative Research Impact Matching Scheme (CRIMS 4620033), the Chinese University of Hong Kong direct grants (4053540, 4053586), and Hong Kong Research Grant Council (GRF 14301120, 14300923). The funders play no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="4"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-03-26</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>o The BrainSpan data can be freely downloaded at its official website (<ext-link xlink:href="https://www.brainspan.org/static/download.html" ext-link-type="uri">https://www.brainspan.org/static/download.html</ext-link>), which includes normalized expression values and meta-data. The version of RNA-Seq Gencode v10 summarized to genes is used in our work. The RNA sequencing data and meta-data for the Aging, Dementia and Traumatic Brain Injury Study of 107 brains, including 377 samples from cortical grey (parietal and temporal), white matter (parietal) and hippocampus), is freely available at its official website (<ext-link xlink:href="http://aging.brain-map.org/download/index" ext-link-type="uri">http://aging.brain-map.org/download/index</ext-link>) or via <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE104687</ext-link>. The extracted GTEx (Genotype-Tissue Expression) data is obtained from the RNA sequencing data offered by the GTEx project. The RNA-Sequencing dataset is open access at its official portal (<ext-link xlink:href="https://gtexportal.org/home/downloads/adult-gtex/overview" ext-link-type="uri">https://gtexportal.org/home/downloads/adult-gtex/overview</ext-link>). The software for INSIDER is freely available on GitHub (<ext-link xlink:href="https://github.com/kai0511/insider" ext-link-type="uri">https://github.com/kai0511/insider</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA Sequencing (RNA-Seq), which has been developed for more than a decade, uses deep sequencing technology to offer a far more precise measurement of levels of transcripts and their isoforms than other methods [<xref rid="pgen.1011189.ref001" ref-type="bibr">1</xref>]. It is now widely used to measure transcriptome levels across different tissues from a number of donors and capture transcriptome dynamics across tissues or biological conditions. For example, the Genotype-Tissue Expression (GTEx) [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] project offers a valuable data resource to study tissue-specific gene expression and regulation. Moreover, there are many data resources related to brain development or psychiatric disorders across brain regions, including the BrainSpan [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>], PsychENCODE [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], and ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>]. The primary task of these studies is to link gene activities to phenotypes, especially human disorders, reveal important biological processes (BPs) that contribute to phenotypes, and understand the involvement of tissues (e.g., brain structures/regions) in disease development.</p>
    <p>However, variation in transcript levels due to covariates, such as donor and tissue, makes the task challenging. Let us take studies of autism spectrum disorder (ASD) as examples. Different brain regions may demonstrate wide differences in gene activities in ASD [<xref rid="pgen.1011189.ref006" ref-type="bibr">6</xref>]. On the other hand, no individuals with ASD have exactly the same genetic expression profiles [<xref rid="pgen.1011189.ref007" ref-type="bibr">7</xref>], which are influenced by individual characteristics such as age, sex, diet, and lifestyle. Thus, joint analyses of gene expression by RNA-Seq of multiple brain regions from several donors are hindered by the variation from donors and tissues.</p>
    <p>Tools for differential gene expression (DGE) analysis [<xref rid="pgen.1011189.ref008" ref-type="bibr">8</xref>, <xref rid="pgen.1011189.ref009" ref-type="bibr">9</xref>], typically built upon generalized linear models (GLM), have been widely employed to quantify changes in expression levels across experimental groups or biological conditions in analyzing RNA expression data. Such methods can also consider confounding variation from covariates, such as donor, and tissue. However, DGE analysis does not aim for dimension reduction and thus cannot help achieve the tasks that require reducing high dimensional data onto a low-rank latent space, such as clustering donors based on low-rank representations of donors (low-rank representations are preferred as the high dimension of genomic features often makes clustering analysis difficult), and other downstream analysis with low-rank representations of biological conditions (phenotype, tissue, or developmental stage).</p>
    <p>Traditional dimension reduction (DR) approaches, such as principal component analysis (PCA), factor analysis, and matrix factorization, cannot directly handle the variation from <italic toggle="yes">multiple</italic> covariates, such as donor, tissue, and other clinical or biological features, to facilitate further analysis. One study [<xref rid="pgen.1011189.ref010" ref-type="bibr">10</xref>] proposed a PCA-based approach with adjustment for confounding variables. Other approaches based on factor analysis have been proposed to adjust for technical artifacts or confounding variables [<xref rid="pgen.1011189.ref011" ref-type="bibr">11</xref>,<xref rid="pgen.1011189.ref012" ref-type="bibr">12</xref>]. These studies aim to remove technical artifacts or control confounding variations rather than interpret variations originating from biological conditions.</p>
    <p>Non-negative matrix factorization (NMF) [<xref rid="pgen.1011189.ref013" ref-type="bibr">13</xref>–<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>] has gained popularity in the analysis of genomic data. The conventional NMF method cannot be directly employed to model variations arising from <italic toggle="yes">multiple</italic> biological variables and their interactions, and to interpret variations from <italic toggle="yes">multiple</italic> biological features or conditions. Variants of NMF proposed for the analysis of bulk RNA-Seq data are rather limited, and most of them aim to correct batch effects in single-cell settings instead of interpreting variation from biological variables [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref015" ref-type="bibr">15</xref>]. On the other hand, NMF and its variants fail to directly infer down-regulations of elements in biological settings [<xref rid="pgen.1011189.ref016" ref-type="bibr">16</xref>], so its interpretability is hampered.</p>
    <p>To summarize, conventional DR methods such as PCA and NMF can usually only be used for two-dimensional (2D) data (e.g., sample × expression), and cannot directly handle <italic toggle="yes">multiple</italic> variables or biological conditions (e.g., donor × tissue × expression; donor × time × expression etc.), or interactions between these conditions. On the other hand, the new methodology we proposed below (INSIDER) can handle <italic toggle="yes">higher-dimensional data (of three or more dimensions)</italic>, as well as interactions between the variables of interest, while performing DR simultaneously.</p>
    <p>We note that most tensor decomposition approaches [<xref rid="pgen.1011189.ref017" ref-type="bibr">17</xref>–<xref rid="pgen.1011189.ref019" ref-type="bibr">19</xref>] can achieve DR with high-dimensional data, however most cannot handle missing data or invoke sparsity in the latent representations. This may impose limitations in analyzing gene expression data since the function of a particular biological pathway often only involves a subset of genes, and each latent dimension only encodes information related to a few pathways. Thus, a sparse Bayesian tensor decomposition approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] (Sparse Decomposition of Arrays [SDA]) was proposed to capture variation from donor and tissue in analyzing RNA-Seq data. However, Bayesian-based approaches face a heavy computational burden in analyzing large-scale genomic data, especially when optimizing with Markov Chain Monte Carlo.</p>
    <p>To model variation from <italic toggle="yes">multiple</italic> biological variables and to facilitate interpretation of the variation, we propose a general and flexible statistical framework, INSIDER, based on matrix decomposition (MF) without non-negative constraints to decompose the variation from covariates in high dimensional data into a shared low-rank latent space. INSIDER has the following favorable properties:</p>
    <list list-type="order">
      <list-item>
        <p>it is a general and flexible framework, in which various covariates and interaction terms can be defined based on research questions and study design. Importantly, it can accommodate <italic toggle="yes">multiple</italic> biological variables simultaneously, and achieve DR of <italic toggle="yes">high-dimensional</italic> data, as opposed to other conventional methods such as PCA and NMF which generally can only handle 2D data (e.g., sample × expression);</p>
      </list-item>
      <list-item>
        <p>it is able to consider <italic toggle="yes">interactions</italic> between different biological/clinical variables, enabling gaining insights into the effect of one variable on others. For example, modeling gene expression of various brain regions across neuropsychiatric disorders, the brain region × disorder interaction, can help understand how brain regions interact with the type of disorder to influence expression. Intuitively, the same disease may affect expression differently in different brain regions; such information may be missed if interactions are not modeled. Notably, interactions are usually ignored by conventional methods, such as PCA, NMF, and their variants. Interactions were also ignored in the recently developed SDA approach [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>];</p>
      </list-item>
      <list-item>
        <p>it allows one to compute the ’adjusted’ expression for one variable (e.g., phenotype) that controls for variation from other variables (e.g., donor). In addition, to consider the group effect among genes and invoke sparsity in gene expression, it introduces an elastic net penalty (combination of L1 and L2 penalty). Elastic net penalty is widely used in the regression setting where only a subset of features may contribute to the outcome, but it prefers highly correlated predictors to be included or excluded from the model together [<xref rid="pgen.1011189.ref021" ref-type="bibr">21</xref>] (instead of arbitrarily selecting one predictor over others as in LASSO);</p>
      </list-item>
      <list-item>
        <p>Results from it facilitate different downstream analyses, including clustering donors with donor representations, temporal dynamic analyses, and uncovering disease mechanisms. The potential of INSIDER in facilitating clinical and biological discoveries will be demonstrated in the Results section;</p>
      </list-item>
      <list-item>
        <p>it is computationally efficient and can also handle missing data well. These will be elaborated further in the sections below;</p>
      </list-item>
      <list-item>
        <p>it also performed similarly or outperformed one of the closest competing methods, SDA, as shown in our simulations. Moreover, unlike SDA, it can also be used where the data matrix cannot be neatly structured into a tensor, as explained below.</p>
      </list-item>
    </list>
    <p>To recap the uniqueness of INSIDER, it models variation arising from <italic toggle="yes">multiple</italic> biological variables and their interaction to comprehend their effects on gene expression in a complex biological setting instead of solely removing technical artifacts or controlling confounding variations. Moreover, it models the effect of specific biological variables while controlling for variation from other biological variables. Unlike GLM-based methods for DGE analysis, INSIDER is a statistical approach for dimension reduction, thus enabling performing the tasks that are challenging using high-dimensional features, such as clustering subjects with donor representations. In contrast to NMF, INSIDER considers the interaction between biological variables and does not impose non-negativity constraints on the latent representations, which allows for capturing down-regulation in gene expression and thus enhances model interpretability. Additionally, compared with tensor decomposition, it can handle situations where the data matrix cannot be structured into a tensor. Usually, for tensor decomposition approaches, we assume one observation/sample per each combination of the three (or more) dimensions, but this is not always the case in practice. To illustrate with an example, when analyzing the effect of neuropsychiatric disorders on expression in different brain regions, multiple samples may be taken from a specific brain region from donors with a certain disorder. The number of samples taken could also differ across donors. This scenario can be challenging for standard tensor decomposition or SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], but can be handled by our proposed method.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of INSIDER</title>
      <p>We propose a novel computational method called INSIDER (<underline>in</underline>terpretable <underline>s</underline>parse matr<underline>i</underline>x <underline>de</underline>composition for bulk <underline>R</underline>NA expression data analysis), summarized in <xref rid="pgen.1011189.g001" ref-type="fig">Fig 1</xref>. INSIDER considers that variation in RNA expression levels originates from several biological variables or covariates, such as donor, tissue, and phenotype (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1A</xref>). The variation is decomposed into a shared latent space of rank <italic toggle="yes">K</italic> by matrix factorization, and variation from unknow sources can also be considered by INSIDER (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). The effect of each covariate on expression can be measured by multiplying the corresponding latent representation with the gene representation <italic toggle="yes">V</italic> (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1B</xref>). Specifically, the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>, <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub>, is modelled as
<disp-formula id="pgen.1011189.e001"><alternatives><graphic xlink:href="pgen.1011189.e001.jpg" id="pgen.1011189.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>. <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the information is unavailable. The interaction effect between tissues and phenotypes is incorporated by introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. Let <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> denote the observed data matrix for <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The above equation can be rewritten in the following matrix representation
<disp-formula id="pgen.1011189.e002"><alternatives><graphic xlink:href="pgen.1011189.e002.jpg" id="pgen.1011189.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>We assume there are <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. For the purpose of representation, <inline-formula id="pgen.1011189.e003"><alternatives><graphic xlink:href="pgen.1011189.e003.jpg" id="pgen.1011189.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are introduced to be the indicator matrices for donors, phenotypes, tissues, phenotype by tissue interactions, and observations, which are the dummy design matrices for the samples. <italic toggle="yes">X</italic><sub><italic toggle="yes">U</italic></sub> is an identity matrix. <inline-formula id="pgen.1011189.e004"><alternatives><graphic xlink:href="pgen.1011189.e004.jpg" id="pgen.1011189.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the matrices for latent representations for the effects of donors, phenotypes, tissues, phenotype by tissue interactions, and observations on the <italic toggle="yes">K</italic> latent metagenes, respectively, and <italic toggle="yes">V</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> represents <italic toggle="yes">K</italic> metagenes across the <italic toggle="yes">M</italic> genes, which capture genes that tend to be co-expressed or work together to induce biological functions.</p>
      <p>In INSIDER, we seek to minimize the following objective
<disp-formula id="pgen.1011189.e005"><alternatives><graphic xlink:href="pgen.1011189.e005.jpg" id="pgen.1011189.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e006"><alternatives><graphic xlink:href="pgen.1011189.e006.jpg" id="pgen.1011189.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e007"><alternatives><graphic xlink:href="pgen.1011189.e007.jpg" id="pgen.1011189.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Here <italic toggle="yes">λ</italic>, <italic toggle="yes">α</italic> are tuning parameters for the elastic net regularization term,||·||<sub><italic toggle="yes">F</italic></sub> represents the Frobenius norm. Alternating block coordinate descent (BCD) is utilized to optimize the objective. INSIDER can incorporate observations with missing values. The technical details of INSIDER are presented in the Methods section.</p>
      <p>INSIDER enables various downstream analyses (<xref rid="pgen.1011189.g001" ref-type="fig">Fig 1C</xref>). For instance, cluster analysis on the donor representation can reveal characteristics of the donors and help find patients subgroups or disease subtyping, development trajectory can be more readily revealed with ‘metagenes’ (low-rank representations of gene expression), which capture the information of genes that tend to be co-expressed or work together to induce biological functions [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. Also, biological processes (BPs) enriched by results from INSIDER help to gain insights into mechanisms underlying covariates like phenotype and interactions between covariates. Details of these analyses are presented below.</p>
      <fig position="float" id="pgen.1011189.g001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of INSIDER.</title>
          <p>A. The RNA-seq data is usually obtained from samples of different tissues from several donors with different phenotypes. B. The variation in RNA-seq expression data can be decomposed into a shared <italic toggle="yes">K</italic>-rank latent space by INSIDER. The latent representation for observations <italic toggle="yes">U</italic> can be included when the donor, phenotype, and/or tissue information is unavailable. Note that INSIDER incorporates the interaction between covariates and that the gene representation <italic toggle="yes">V</italic> is shared. C. Various types of downstream analysis can be conducted on the result from INSIDER. The donor representations can be utilized for cluster analysis, development trajectories can be revealed in the analysis of the BrainSpan data, and biological mechanisms behind phenotypes of interest and interactions between covariates can be revealed. Details on these analyses will be demonstrated in the Result section.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Simulation study</title>
      <p>To our knowledge, there is no readily available computational tool for modeling the variation arising from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic>, while also performing dimension reduction (and having similar favorable properties as described earlier). Tensor decomposition is the closest existing computational tool to INSIDER. To showcase the advantages of INSIDER in capturing complex latent structures of gene expression data, it was compared to SDA[<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a sparse Bayesian tensor decomposition approach. We evaluated their abilities to accurately recover the underlying latent structures from <italic toggle="yes">multiple</italic> biological variables and their <italic toggle="yes">interactions</italic> with RMSE (root-mean-squared error).</p>
      <p>In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (250×200), and variation in the matrix comes from two biological variables (<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>), their interaction, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic></sub><italic toggle="yes">R</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and the dimension of <italic toggle="yes">R</italic> for the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> is 250×5. <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">E</italic>,<italic toggle="yes">F</italic>,<italic toggle="yes">R</italic>} are <inline-formula id="pgen.1011189.e008"><alternatives><graphic xlink:href="pgen.1011189.e008.jpg" id="pgen.1011189.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e009"><alternatives><graphic xlink:href="pgen.1011189.e009.jpg" id="pgen.1011189.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e010"><alternatives><graphic xlink:href="pgen.1011189.e010.jpg" id="pgen.1011189.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (250×200) was generated from a normal distribution <italic toggle="yes">N</italic>(0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. We considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1 in our simulations. Meanwhile, to introduce sparsity in gene expression, we randomly silence the expression of 30% of the genes.</p>
      <p>Subsequently, we employed INSIDER with and without considering the interaction between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> and SDA to decompose the matrix <italic toggle="yes">Z</italic>, and then evaluated their abilities to recover <italic toggle="yes">T</italic> using RMSE. For the implementation of SDA, the software provided by the original study [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>] was used. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. Results for the comparison are shown in <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparison of performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to INSIDER.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t001" id="pgen.1011189.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">2.21</td>
                <td align="center" rowspan="1" colspan="1">2.12</td>
                <td align="center" rowspan="1" colspan="1">1.82</td>
                <td align="center" rowspan="1" colspan="1">1.84</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
                <td align="center" rowspan="1" colspan="1">1.69</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.10</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t001" ref-type="table">Table 1</xref>, we see that SDA fails to capture the underlying relationship across different noise levels. Moreover, INSIDER without interaction outperforms SDA in recovering <italic toggle="yes">T</italic> using RMSE, even though both methods have a similar model complexity. Importantly, when considering the interactive effects between <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic>, INSIDER demonstrates substantially better performance in recovering <italic toggle="yes">T</italic>, compared with SDA, even as the level of noise increases.</p>
      <p>To show the performance of INSIDER in case of model misspecification, we first included simulation studies of INSIDER under the situation where the simulation data is generated according to SDA [<xref rid="pgen.1011189.ref020" ref-type="bibr">20</xref>], a tensor decomposition method. Specifically, we consider a tensor of gene expression <italic toggle="yes">Z</italic> of dimensions 50×5×200, which is generated according to <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <inline-formula id="pgen.1011189.e011"><alternatives><graphic xlink:href="pgen.1011189.e011.jpg" id="pgen.1011189.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Here the rank of latent space <italic toggle="yes">K</italic> is set to 5, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are matrices of dimensions 50×5 and 5×5, respectively, and <italic toggle="yes">V</italic> is a 5×200 matrix for gene latent representations. These matrices were generated from the standard normal distribution. The elements of Θ are generated from <italic toggle="yes">N</italic>(0, <italic toggle="yes">σ</italic>). In practice, we consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For the application of INSIDER to the simulated data, we flat the tensor <italic toggle="yes">Z</italic> by its first two dimensions and transform it into a 250×200 matrix. Then, we introduce two design matrices <inline-formula id="pgen.1011189.e012"><alternatives><graphic xlink:href="pgen.1011189.e012.jpg" id="pgen.1011189.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>and <inline-formula id="pgen.1011189.e013"><alternatives><graphic xlink:href="pgen.1011189.e013.jpg" id="pgen.1011189.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for the first two dimensions of <italic toggle="yes">Z</italic>, and the two design matrices are considered as covariates for INSIDER. Since SDA only has one hyperparameter, the latent rank <italic toggle="yes">K</italic> (<italic toggle="yes">num_comps</italic>), and does not allow missing entries, we adopt the following procedure in the simulation study. When running SDA, the parameters <italic toggle="yes">N</italic> and <italic toggle="yes">num_comps</italic> are set to 50 and 5, respectively, and default values are used for other parameters. For INSIDER, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as validation set and consider the left data trainset, select the hyperparameters with which INSIDER trained on the trainset performs the best on the validation set, and run INSIDER with selected hyperparameters on <italic toggle="yes">Z</italic>. Then we compared the performance of INSIDER with and without interactions to SDA in recovering the true pattern <italic toggle="yes">T</italic> using RMSE. The results of the simulation studies are presented in <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of the performance of INSIDER without or with interaction to that of SDA in recovering <italic toggle="yes">T</italic> using RMSE when the data is generated according to SDA.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t002" id="pgen.1011189.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDA</td>
                <td align="center" rowspan="1" colspan="1">0.04</td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER without interaction</td>
                <td align="center" rowspan="1" colspan="1">1.22</td>
                <td align="center" rowspan="1" colspan="1">1.57</td>
                <td align="center" rowspan="1" colspan="1">2.10</td>
                <td align="center" rowspan="1" colspan="1">1.66</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">INSIDER with interaction</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
                <td align="center" rowspan="1" colspan="1">0.16</td>
                <td align="center" rowspan="1" colspan="1">0.21</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From <xref rid="pgen.1011189.t002" ref-type="table">Table 2</xref>, we find that INSIDER without interaction did not perform well in the case of model misspecification. However, INSIDER with interaction demonstrated a performance similar to SDA, although the simulation data is generated according to the SDA model. This suggests that INSIDER performs well in the case of model specification when data is generated according to SDA.</p>
      <p>To further demonstrate the performance of INSIDER in case of model misspecification, we conducted further simulation analysis to examine its performance when the data is generated according to multivariate linear regression models. For illustration, the gene expression matrix <italic toggle="yes">Z</italic> of dimensions 100×200 is generated by <italic toggle="yes">Z</italic> = <italic toggle="yes">T</italic> + Θ, where <italic toggle="yes">T</italic> = <italic toggle="yes">X</italic><sub><italic toggle="yes">E</italic></sub><italic toggle="yes">E</italic>+<italic toggle="yes">X</italic><sub><italic toggle="yes">F</italic></sub><italic toggle="yes">F</italic>, <inline-formula id="pgen.1011189.e014"><alternatives><graphic xlink:href="pgen.1011189.e014.jpg" id="pgen.1011189.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1011189.e015"><alternatives><graphic xlink:href="pgen.1011189.e015.jpg" id="pgen.1011189.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the dummy matrices for two categorical variables, <italic toggle="yes">E</italic><sup>20×200</sup>,<italic toggle="yes">F</italic><sup>5×200</sup> are matrices for coefficients of the two categorical variables across 200 genes, and Θ<sup>100×200</sup> is the error matrix. In simulation, <italic toggle="yes">E</italic> and <italic toggle="yes">F</italic> are generated from <italic toggle="yes">N</italic>(0, 1) and Θ is generated from <italic toggle="yes">N</italic>(0,<italic toggle="yes">σ</italic>), where <italic toggle="yes">σ</italic> denotes the noise level. We consider <italic toggle="yes">σ</italic> to be 0.25, 0.5, 0.75, and 1. For INSIDER, we incorporate two categorical variables as covariates without considering their interaction. For linear regression, we fit ridge regression with the two categorical variables as predictors and <italic toggle="yes">Z</italic> as responses. For a fair comparison, we first draw 10% of the elements of <italic toggle="yes">Z</italic> without replacement as hold-out set, draw 10% of the elements of the left data without replacement as validation set, and consider other elements of the left data as trainset. To employ INSIDER and Ridge regression, we first train them on the trainset with different hyperparameters and select the parameters with which they perform the best on the validation set in terms of RMSE. Then, we fit them with the chosen hyperparameters on the left data (trainset + validation set) and report the RMSE of the fitted model on <italic toggle="yes">T</italic> for the testset. The baseline RMSE is the root-mean-square difference between <italic toggle="yes">T</italic> and the average of <italic toggle="yes">Z</italic> over the trainset and validation set. The results of the simulation are shown in <xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref>.</p>
      <table-wrap position="float" id="pgen.1011189.t003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Performance of INSIDER in recovering <italic toggle="yes">T</italic> over the hold-out set using RMSE when the data is generated according to a multivariate linear model.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t003" id="pgen.1011189.t003g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">RMSE</th>
                <th align="center" colspan="4" rowspan="1">noise variance <italic toggle="yes">δ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">0.25</th>
                <th align="center" rowspan="1" colspan="1">0.5</th>
                <th align="center" rowspan="1" colspan="1">0.75</th>
                <th align="center" rowspan="1" colspan="1">1.0</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Baseline</td>
                <td align="center" rowspan="1" colspan="1">1.4234</td>
                <td align="center" rowspan="1" colspan="1">1.4046</td>
                <td align="center" rowspan="1" colspan="1">1.4005</td>
                <td align="center" rowspan="1" colspan="1">1.4001</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Ridge regression</td>
                <td align="center" rowspan="1" colspan="1">0.1496</td>
                <td align="center" rowspan="1" colspan="1">0.2934</td>
                <td align="center" rowspan="1" colspan="1">0.4257</td>
                <td align="center" rowspan="1" colspan="1">0.5426</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">INSIDER</td>
                <td align="center" rowspan="1" colspan="1">0.1493</td>
                <td align="center" rowspan="1" colspan="1">0.2950</td>
                <td align="center" rowspan="1" colspan="1">0.4268</td>
                <td align="center" rowspan="1" colspan="1">0.5458</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pgen.1011189.t003" ref-type="table">Table 3</xref> shows that INSIDER performs similarly to ridge regression in terms of RMSE in recovering <italic toggle="yes">T</italic>. Moreover, compared with the baseline RMSE, INSIDER captures a large proportion of signals. This suggests that INSIDER performs well under the case of model specification when the simulated data is generated according to multivariate linear models.</p>
      <p>Further, we also explored the ability of INSIDER to handle missing values in simulation settings. There are mainly two types of missing in RNA-Seq studies. The first type is missing samples. For example, the biosamples of some tissues from donors are not available, and this leads to missing samples in RNA-Seq data. The second type is missing entries. That is, expression levels of some genes for samples are missing. In practice, the proportion of missing entries is usually small in RNA-Seq data. Here we studied the two types of missing in the simulation below.</p>
      <p>In our simulation study, we assume there are 50 donors with 2 different phenotypes, 8 tissues, and 1000 genes. The number of samples for our simulated data matrix is 400 (50×8). Moreover, we consider the interaction between phenotypes and tissues. In our simulation setup, we consider a gene expression matrix <italic toggle="yes">Z</italic> (400×1000), and variation in the matrix comes from three biological variables (<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>), the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic>, and random noise. Their relationship is described by <italic toggle="yes">Z</italic> = <italic toggle="yes">R</italic>+Θ, where R = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub><italic toggle="yes">D</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub><italic toggle="yes">P</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub><italic toggle="yes">T</italic> + <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub><italic toggle="yes">W</italic>)<italic toggle="yes">V</italic>. The rank of latent space is set to 5, <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, and <italic toggle="yes">T</italic> are matrices of dimensions 50×5, 2×5, and 8×5, respectively, and the dimension of <italic toggle="yes">W</italic> for the interaction between <italic toggle="yes">P</italic> and <italic toggle="yes">T</italic> is 16×5. <italic toggle="yes">V</italic> is a 5×1000 matrix for gene latent representations. All matrices for latent representation were generated from the standard normal distribution. The design matrices for {<italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>} are <inline-formula id="pgen.1011189.e016"><alternatives><graphic xlink:href="pgen.1011189.e016.jpg" id="pgen.1011189.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e017"><alternatives><graphic xlink:href="pgen.1011189.e017.jpg" id="pgen.1011189.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1011189.e018"><alternatives><graphic xlink:href="pgen.1011189.e018.jpg" id="pgen.1011189.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mn>400</mml:mn><mml:mo>×</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1011189.e019"><alternatives><graphic xlink:href="pgen.1011189.e019.jpg" id="pgen.1011189.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mn>250</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The noise matrix Θ (400×1000) was generated from a normal distribution <italic toggle="yes">N</italic> (0, <italic toggle="yes">δ</italic>), and <italic toggle="yes">δ</italic> is the variance of the distribution. In the simulation, we considered <italic toggle="yes">δ</italic> equal to 0.25, 0.5, 0.75, and 1.</p>
      <p>To better mimic the complex missing samples in real settings, we consider the setting based on the distribution of brain structures and phenotypes of samples of 50 donors similar to the ageing, dementia, and TBI data. Among 50 donors, 27 are healthy, and the other 23 are affected by a specific disease. For each donor, at least 4 out of 8 tissues are available. Then, we had 229 samples available, and 171 (42.75%) samples were missing. For comparison, we also conducted simulation studies on the scenario where 42.75% of samples are missing at random. Further, to introduce missing entries in the data matrix of samples available, we randomly drew 5% of the elements from it as missing entries. To evaluate the performance of INSIDER in handling missing, we examined the RMSE between the estimated <inline-formula id="pgen.1011189.e020"><alternatives><graphic xlink:href="pgen.1011189.e020.jpg" id="pgen.1011189.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER and <italic toggle="yes">R</italic> over missing entries and samples, and the result is presented in <xref rid="pgen.1011189.t004" ref-type="table">Table 4</xref>. In the table, the baseline RMSE is the root-mean-square difference between <italic toggle="yes">R</italic> for missing entries or samples and the average of <italic toggle="yes">Z</italic> over nonmissing entries. Since the baseline RMSE for missing entries and samples are roughly the same, we only show the baseline RMSE for missing samples for illustration.</p>
      <table-wrap position="float" id="pgen.1011189.t004">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The baseline RMSE and RMSE of the estimated <inline-formula id="pgen.1011189.e021"><alternatives><graphic xlink:href="pgen.1011189.e021" id="pgen.1011189.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by INSIDER against <italic toggle="yes">R</italic> on missing entries and samples across different simulation settings.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1011189.t004" id="pgen.1011189.t004g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">RMSE<break/>Noise</th>
                <th align="center" rowspan="1" colspan="1">Baseline</th>
                <th align="center" rowspan="1" colspan="1">Missing entries</th>
                <th align="center" rowspan="1" colspan="1">Random missing samples</th>
                <th align="center" rowspan="1" colspan="1">Missing samples (real)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.25</td>
                <td align="center" rowspan="1" colspan="1">4.5308</td>
                <td align="center" rowspan="1" colspan="1">0.0460</td>
                <td align="center" rowspan="1" colspan="1">0.0394</td>
                <td align="center" rowspan="1" colspan="1">0.0401</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">4.6308</td>
                <td align="center" rowspan="1" colspan="1">0.0907</td>
                <td align="center" rowspan="1" colspan="1">0.0780</td>
                <td align="center" rowspan="1" colspan="1">0.0803</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.75</td>
                <td align="center" rowspan="1" colspan="1">4.5998</td>
                <td align="center" rowspan="1" colspan="1">0.1397</td>
                <td align="center" rowspan="1" colspan="1">0.1207</td>
                <td align="center" rowspan="1" colspan="1">0.1206</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">4.4998</td>
                <td align="center" rowspan="1" colspan="1">0.1827</td>
                <td align="center" rowspan="1" colspan="1">0.1553</td>
                <td align="center" rowspan="1" colspan="1">0.1581</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From the table, we see that the RMSE for missing entries and samples increases slightly with increasing noise levels, and the RMSE for missing entries is slightly higher compared with the RMSE for missing samples. The RMSE for random missing samples and the designed missing samples based on the ageing, dementia, and TBI data is roughly the same. The simulation result suggests that the INSIDER has a good ability to recover underlying true patterns and the ability decreases slightly with increasing noise levels, even though complex missing exists.</p>
    </sec>
    <sec id="sec005">
      <title>Analysis of the BrainSpan data</title>
      <p>The BrainSpan study provides RNA-Seq data profiling up to sixteen cortical and subcortical structures across the entire course of human brain development [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>]. In this analysis, we aim to explore the development trajectories across human brain development, the BPs that function in different brain regions, and the involvement of brain regions in different development stages.</p>
      <p>The BrainSpan dataset was downloaded from the website provided in [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>]. The dimension of the data matrix for our analysis is 524×43411. In this analysis, we modeled development stages and brain regions as covariates but omitted interactions between development stages and brain regions, because many combinations of development stages and brain regions only have 1 or 0 RNA-seq sample, so inference of the interaction will be unreliable. For the definition of development stages, we follow the specifications defined in the original study [<xref rid="pgen.1011189.ref003" ref-type="bibr">3</xref>].</p>
      <p>In the application, even though the development stages are in chronological order, we consider development stages as unordered categorical variables. The main reason is that human brain development is nonlinear, so some metagenes may only be highly active in certain developmental stages and then are leveled down or turned off. For example, the study [<xref rid="pgen.1011189.ref024" ref-type="bibr">24</xref>] systematically discussed the development of different brain structures across developmental stages, suggesting that the development of brain structures is specific to certain development stages. For illustration, we denote <inline-formula id="pgen.1011189.e022"><alternatives><graphic xlink:href="pgen.1011189.e022.jpg" id="pgen.1011189.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>as the latent representations for development stages, brain regions, and genes, respectively. There are <italic toggle="yes">N</italic><sub>1</sub> development stages and <italic toggle="yes">N</italic><sub>2</sub> brain regions, and <italic toggle="yes">M</italic> is the number of genes included. The rank <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 19.</p>
    </sec>
    <sec id="sec006">
      <title>Metagenes reveal development trajectories</title>
      <p>We adopt the convention to consider the rows of <italic toggle="yes">V</italic> as metagenes [<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>]. We first looked at <inline-formula id="pgen.1011189.e023"><alternatives><graphic xlink:href="pgen.1011189.e023.jpg" id="pgen.1011189.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which are the levels of expression of <italic toggle="yes">K</italic> metagenes across <italic toggle="yes">N</italic><sub>1</sub> developmental stages, and computed the variance of the expression levels of each metagene across <italic toggle="yes">N</italic><sub>1</sub> developmental stages (the variances are computed with the columns in <italic toggle="yes">D</italic>). We chose the most variable (16<sup>th</sup>), 2<sup>nd</sup>, and 17<sup>th</sup> metagenes. We visualized the trajectories of the selected metagenes across human brain development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Meanwhile, we see a rapid surge in the level of the 2<sup>nd</sup> metagene between late fetal and childhood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>). Additionally, the loading of the 17<sup>th</sup> metagene is high at the early fetal and fluctuates around zero at later stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>).</p>
      <fig position="float" id="pgen.1011189.g002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Downstream analyses with results from the application to the BrainSpan data.</title>
          <p>A. The trajectories of the selected metagene across human brain development are displayed in the left of panel A. The definition of stages is provided in the table on the right of panel A. B. The top 30 up-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is presented. C. The top 30 down-regulated BPs enriched by the most variable (16<sup>th</sup>) metagene is displayed. D. The top 30 up-regulated BPs in the primary motor and somatosensory cortex (M1C-S1C) are shown in panel D. E. The top 30 down-regulated BPs in the M1C-S1C are shown in panel E. F. Trajectories of the adjusted expression for the selected genes at the whole brain level are shown in panel F. The definition of stages in the figure is the same as in panel A.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g002" position="float"/>
      </fig>
      <p>To decode biological mechanisms behind these metagenes, we carried out enrichment analyses to find up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2C</xref>) biological processes (BPs) encoded by them. Specifically, for a given metagene <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, the <italic toggle="yes">i</italic>-th row of <italic toggle="yes">V</italic>, we examine the BPs enriched by genes with large effects, that is, the genes with large absolute values for <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub>, since these genes encode primary biological functions of the metagene. Therefore, enrichment analyses were conducted on the set of genes in the upper or lower 2.5% quantile of <italic toggle="yes">V</italic><sub><italic toggle="yes">i</italic></sub> to explore up- or down-regulated BPs encoded by the metagene, respectively. Here up- or down-regulated BPs refer to BPs enriched by up- or down-regulated genes. Throughout our work, we use them to convey the meaning without loss of clarity. Other technical details for the enrichment analysis are presented in the Supplementary Content (<xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). The up- and down-regulated BPs for the 2<sup>nd</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1B Fig</xref>) and 17<sup>th</sup> (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C and S1D Fig</xref>) metagenes are also provided in <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1 Fig</xref>.</p>
      <p>On the one hand, a joint analysis of the trajectories of the (16<sup>th</sup>, 17<sup>th</sup>) metagenes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) with their corresponding up-regulated BPs shows that the embryo is under rapid differentiation and development at the early fetal (<xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C Fig</xref>) and that developments of brain regions, such as the hippocampus, pallium, and forebrain, are high before the mid-fetal period (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2B</xref>). As core systems of the brain are established before birth [<xref rid="pgen.1011189.ref025" ref-type="bibr">25</xref>], levels of BPs involved in cell development, axonogenesis, myelination, and gliogenesis fall rapidly after the late fetal period (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2B</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1C</xref>). The basic structure of human brains does not undergo substantial changes after birth, so we observed a decline in levels of BPs related to the development of brain regions, such as the forebrain, telencephalon, pallium, and hippocampus (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>). With its continued development, human brains mature well into the 20s [<xref rid="pgen.1011189.ref026" ref-type="bibr">26</xref>], corresponding to a relatively low level of these BPs in young adulthood (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2B</xref>).</p>
      <p>On the other hand, we observed that the BPs involved in learning, memory, and cognition are relatively low in fetal stages (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1D</xref>). With the development of human brains, we also noticed a rapid surge in the level of BPs related to learning, memory, and cognition during infancy (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A</xref> and <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A</xref>) and a stable rise in levels of these BPs after mid-fetal stages (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). After the maturation of human brains, these BPs maintain a high level (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A and 2C</xref>). During the development of learning, memory, and cognition, new neural networks form in the brain [<xref rid="pgen.1011189.ref027" ref-type="bibr">27</xref>], and the level of neurotransmitters increases simultaneously [<xref rid="pgen.1011189.ref028" ref-type="bibr">28</xref>]. Our findings also show that the BPs involved in synaptic functions and neurotransmitter activities follow a similar trajectory as those of learning, memory, and cognition (Figs <xref rid="pgen.1011189.g002" ref-type="fig">2A and 2C</xref>, <xref rid="pgen.1011189.s002" ref-type="supplementary-material">S1A and S1D</xref>).</p>
      <p>The trajectory of the least variable metagene is highly negative and flat across human brain development (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2A Fig</xref>). Subsequent enrichment analysis revealed that the down-regulated BPs enriched by metagene are involved in cell and ATP metabolism and cell communication (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>), which generally maintain a high level during brain development.</p>
    </sec>
    <sec id="sec007">
      <title>Metagenes characterize development stages and brain regions</title>
      <p>Previously, metagenes depicted the development trajectories of human brains. Moreover, metagenes also can characterize development stages and brain regions. This can be achieved by examining BPs enriched by metagenes with highly distinct values for development stages or brain regions. We highlighted several metagenes for demonstration (Tabs A and B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>).</p>
      <p>On the one hand, one metagene was highlighted to characterize development stages for demonstration. First, we observed that the expression level of the 5<sup>th</sup> metagene for the early mid-fetal (the 5<sup>th</sup> stage in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2A</xref>) is highly positive and much greater than for other stages (Tab A in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). Subsequently, the top up-regulated BPs by the 5<sup>th</sup> metagene involve ossification and development of bone, muscle, and sensory systems (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2C Fig</xref>). The results suggest that the mid-fetal period is vital for bone and muscle formation and contributes to sensory system development.</p>
      <p>On the other hand, we also highlighted one metagene to uncover the functions of brain regions. The loading of the 1st metagene for the striatum is highly positive. Furthermore, the absolute value of the metagene is much greater for the brain region than for other brain regions (Tab B in <xref rid="pgen.1011189.s006" ref-type="supplementary-material">S1 Table</xref>). As shown by subsequent enrichment analysis, the top 30 up-regulated BPs by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2D Fig</xref>), suggesting that the striatum is responsible for human emotion and cognition (e.g., reward system) [<xref rid="pgen.1011189.ref029" ref-type="bibr">29</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Reveal trajectories of genes expression across human brain development at the whole-brain level</title>
      <p>The development of the human brains is heterogenous across different individuals and not linear across different brain regions. Thus, the confounding variation from donors and tissues makes it difficult to reveal gene expression changes at the whole-brain level across human brain development. One can only show trajectories of gene expression in a tissue-wise manner, as displayed in the study [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>However, INSIDER allows us to obtain the ‘adjusted’ gene expression profiles across development stages by multiplying <italic toggle="yes">D</italic> with <italic toggle="yes">V</italic>. Note that variation from tissue and donor is controlled in the adjusted gene expression profiles, which cannot be readily computed from conventional approaches. Here we showed the trajectories of summarized expression changes for six selected genes (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>), which are chosen from genes in the top and bottom of the expression profile for the most variable (16<sup>th</sup>) metagene selected previously.</p>
      <p>The left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref> showed that the trajectory of <italic toggle="yes">DCX</italic>, expressed in neuronal progenitor cells and immature migrating neurons, is similar to that of BPs involved in human brain development discussed previously and consistent with its trend in the hippocampus [<xref rid="pgen.1011189.ref023" ref-type="bibr">23</xref>].</p>
      <p>Regarding <italic toggle="yes">Sox4</italic> and <italic toggle="yes">Sox11</italic>, known key controllers of embryonic and fetal development, our results suggested that they are expressed at high levels in the early development stages (left panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). Furthermore, they also demonstrate a similar trajectory across human brain development in the panel.</p>
      <p>Both <italic toggle="yes">MBP</italic> and <italic toggle="yes">PLP1</italic> are involved in the myelination in the CNS, which is vital to cognition development and function and is largely completed in early adulthood [<xref rid="pgen.1011189.ref030" ref-type="bibr">30</xref>,<xref rid="pgen.1011189.ref031" ref-type="bibr">31</xref>]. Another gene <italic toggle="yes">NRGN</italic> regulates synaptic plasticity crucial for synaptic function [<xref rid="pgen.1011189.ref032" ref-type="bibr">32</xref>]. The trends of trajectories of the three genes are similar and upward (right panel in <xref rid="pgen.1011189.g002" ref-type="fig">Fig 2F</xref>). This observation is consistent with the development of cognition discussed previously.</p>
    </sec>
    <sec id="sec009">
      <title>Uncover biological mechanisms underlying the development of specific brain regions</title>
      <p>The tissue representation from INSIDER enables us to explore BPs in specific brain regions by computing their adjusted gene expression profiles. Specifically, the adjusted gene expression profiles for brain regions were obtained by multiplying <italic toggle="yes">T</italic> with <italic toggle="yes">V</italic>. In the multiplication, two metagenes with the least variance across different brain regions were excluded because they aggregate the expression of cell metabolic and ATP metabolic processes and cell communication. Thus, excluding them enables us better uncover BPs related to brain development.</p>
      <p>Then, we conducted enrichment analyses on the adjusted gene expression profile of M1C-S1C (primary motor and somatosensory cortex) to explore up- (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and down-regulated (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>) BPs for the brain region. We have no particular preference for specific brain region for further analysis; the main reason for choosing M1C-S1C for presentation is that its function is probably more specific and has less overlap with other regions, so the biological relevance of our approach can be better demonstrated.</p>
      <p>The M1C-S1C is mainly responsible for generating signals to direct the body’s movement and processing somatic sensations. The development of this region involves axonogenesis and regulation of neuron projection development (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>) and thus increases connectivity between synapses. The levels of synaptic activities also increase with the increased connectivity [<xref rid="pgen.1011189.ref033" ref-type="bibr">33</xref>]. Therefore, it is reasonable to observe that BPs involved in synaptic activities, such as chemical synaptic transmission, trans−synaptic signaling, and synaptic plasticity, are upregulated in this brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2D</xref>). However, the levels of gene expression for BPs involved in the development of human organs, such as the kidney, renal system, spinal cord, and sensory organ (e.g., inner ear and ear), are low in the brain region (<xref rid="pgen.1011189.g002" ref-type="fig">Fig 2E</xref>).</p>
      <p>In summary, through the analysis of the BrainSpan data, the advantages of INSIDER have been demonstrated. It enables analyzing gene expression data that cannot be readily formatted into 3D tensors, as there could be several observations for some combinations of brain regions and developmental stages. Our approach reveals the brain developmental trajectories by metagenes, and up- and down-regulated BPs encoded by the metagenes. Our method also characterizes the molecular basis underlying neurodevelopment for different brain regions and developmental stages by examining their underlying up- and down-regulated BPs. However, standard PCA- and especially GLM-based methods are unapplicable for these tasks in RNA-seq data analysis. Moreover, NMF may not be readily applicable as it is not straightforward to directly infer down-regulations of gene expression.</p>
    </sec>
    <sec id="sec010">
      <title>Analysis of the aging, dementia, and TBI data</title>
      <p>Dementia is a kind of neurodegenerative disorder, and there are various underlying causes. Traumatic brain injury (TBI) may lead to dementia, but the most common cause is Alzheimer’s disease (AD). The Aging, Dementia, and TBI Study aims to characterize neuropathologic, molecular, and transcriptomic changes in the brains of controls and TBI cases from an aged population-based cohort [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>], which offers RNA-Seq data of temporal cortex (TC), parietal cortex (PC), cortical white matter (WM), and hippocampus (HPC) of controls and TBI cases.</p>
      <p>We downloaded the aging, dementia, and TBI data from the website provided in [<xref rid="pgen.1011189.ref034" ref-type="bibr">34</xref>]. The dimension of our dataset is 377 × 44,477, and the RNA-seq samples come from 107 donors. In this analysis, we seek to explore BPs contributing to the progression of dementia and discover BPs contributing to dementia in specific brain structures. Here we modeled four covariates: donor, brain structure, diagnosis of dementia, and gene, and incorporated interactions between brain structures and phenotype (dementia diagnosis). The number of ranks <italic toggle="yes">K</italic> of latent space selected by hyperparameter tuning is 23.</p>
    </sec>
    <sec id="sec011">
      <title>Clustering analysis of donor representations</title>
      <p>It is challenging to perform clustering analysis in high-dimensional settings, for example, with high-dimensional omics data. However, INSIDER enables us to cluster donors with donor representations to characterize donors and even identify disease subtypes, which is in line with personalized treatment delivery. In practice, we performed hierarchical clustering with latent donor representations (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3A</xref>) without the least variable metagene, which encodes BPs related to ATP metabolic processes. We selected two as the number of clusters. Subsequently, we examined the clinical or demographic relevance of the clusters. The two-tailed standard (<italic toggle="yes">P</italic> = 0.0251) and rank-based ANOVA tests (<italic toggle="yes">P</italic> = 0.0185) indicate that the clustering memberships statistically correlate with donor age distribution. We note that age itself was not included as an input for clustering, yet our clustering primarily based on expression data is able to identify subgroups with important clinical differences (e.g., age).</p>
      <fig position="float" id="pgen.1011189.g003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1011189.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Downstream analyses with results from the application to the aging, dementia, and TBI data.</title>
          <p>A. The figure shows the dendrogram of hierarchical clustering with donor representations. B. The top 30 down-regulated BPs enriched for the difference in gene expression between dementia and control are displayed. C. The top 30 down-regulated BPs enriched by the difference in gene expression of left HPC between dementia and control are presented.</p>
        </caption>
        <graphic xlink:href="pgen.1011189.g003" position="float"/>
      </fig>
      <p>We also explored whether donor representations enable us to reveal subgroups related to subtypes of dementia. Since not all metagenes are associated with dementia, we filtered off several metagenes that have little relevance to dementia by examining the relevance of the top 30 up- and down-regulated BPs to dementia by searching literatures. Then, we performed hierarchical clustering on donor representation with these kept metagenes. The dendrogram (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3A Fig</xref>) indicates three subgroups.</p>
      <p>Two-tailed standard (<italic toggle="yes">P</italic> = 0.0205) and rank-based (<italic toggle="yes">P</italic> = 0.0731) ANOVA tests yielded similar <italic toggle="yes">p</italic>-values when we examined the association between the clustering and age distribution. In further exploring its relevance to the clinical diagnoses of dementia, Fisher’s exact tests revealed that clusters have a statistically significant association with the Braak staging of dementia (<italic toggle="yes">P</italic> = 0.0025) and showed a trend of association with diagnoses of dementia by the NINCDS-ADRDA Alzheimer’s criteria (<italic toggle="yes">P</italic> = 0.108), one of the most widely used criteria in the diagnosis of Alzheimer’s disease. Note that clinical or pathological features related to staging are not used as input for the clustering, hence this serves as an ‘external validation’ of the validity of the clusters. In other words, our proposed clustering framework, primarily based on expression profiles with dimension reduction by INSIDER, might indeed be useful in identifying clinically distinct and meaningful subgroups, which are consistent with widely used clinical staging/diagnosis systems.</p>
    </sec>
    <sec id="sec012">
      <title>Metagenes reveal the biological mechanism of dementia</title>
      <p>Here we explored the BPs significantly down-regulated in dementia compared with controls to shed light on the mechanism of dementia. In practice, we selected the top 2 variable metagenes in phenotype representation, as they achieved the most significant <italic toggle="yes">p</italic>-values in the following enrichment analysis. Then, the adjusted gene expression profiles for dementia and control were obtained by multiplying phenotype representations by gene representation with only the selected metagenes. Subsequently, we examined down-regulated BPs enriched by the difference in gene expression between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>).</p>
      <p>The top 30 BPs enriched for down-regulated genes are statistically significant at the <italic toggle="yes">p&lt;</italic>5e-5 level. We observed that expression levels of genes for BPs involved in cognition, learning, and memory were significantly lower in the dementia brain than in the control brain (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). In addition, significant differences in BPs related to synaptic activities, such as trans-synaptic signaling, and chemical synaptic transmission, were also observed when comparing dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). This observation is supported by previous studies [<xref rid="pgen.1011189.ref035" ref-type="bibr">35</xref>–<xref rid="pgen.1011189.ref037" ref-type="bibr">37</xref>], suggesting that synaptic signaling and transmission play indispensable roles in the nervous system function, and their dysfunctions might be important contributing factors to dementia.</p>
      <p>Interestingly, expression levels of genes involved in ossification (bone tissue formation) are also significantly different between dementia and control (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>). The connection between impaired bone microarchitecture or regeneration and dementia has been reported [<xref rid="pgen.1011189.ref038" ref-type="bibr">38</xref>]. Moreover, a degree of comorbidity of AD and osteoporosis is also supported by epidemiological studies [<xref rid="pgen.1011189.ref039" ref-type="bibr">39</xref>]. On the other hand, several BPs related to metal ions are also identified in the enrichment analysis (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3B</xref>), suggesting that expression levels of genes involved in these BPs are lower in dementia than in normal. Since metal ions play essential roles in neurotransmitter synthesis and energy metabolism, their deficiencies may contribute to cognitive decline and memory loss [<xref rid="pgen.1011189.ref040" ref-type="bibr">40</xref>], which are the most common symptoms of dementia.</p>
    </sec>
    <sec id="sec013">
      <title>Metagenes characterize donors and functions of brain regions</title>
      <p>In addition to revealing the mechanism of dementia, metagenes can help us to characterize donors and reveal functions of brain regions among the aged donors.</p>
      <p>We first employed standard two-tailed t-tests to identify metagenes associated with donor characteristics. Statistical test results showed the most statistically significant difference in loadings for the 13<sup>th</sup> metagene between donors who experienced TBI with loss of consciousness (LOC) and those not experiencing TBI (<italic toggle="yes">P</italic> = 0.0242). Subsequent enrichment analysis with the 13<sup>th</sup> metagene reveals that the top 30 down-regulated BPs involve cognitive functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3B Fig</xref>), suggesting that experiencing TBI with LOC may be associated with cognitive dysfunction.</p>
      <p>For demonstration, we highlighted one metagene (17<sup>th</sup>) to reveal the functions of the white matter (WM) (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>) of the forebrain. The loadings of the 17<sup>th</sup> metagene are negative only for WMs of both the left and right forebrain (<xref rid="pgen.1011189.s007" ref-type="supplementary-material">S2 Table</xref>). Subsequent enrichment analysis with the 17<sup>th</sup> metagene revealed that the top 30 up-regulated BPs involve learning, memory, cognition, and synaptic functions (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3C Fig</xref>).</p>
      <p>This suggests that expression of genes involved in these BPs is relatively low in the WM of both the left and right forebrains, compared to other brain regions. Moreover, we noticed that the loading of this metagene is lower in the WM of the left forebrain than in its counterpart. However, this cannot help us lead to the claim that the WM of the left forebrain is less involved in these BPs than its counterpart, as a single metagene may not show the whole picture of the involvement of WMs.</p>
      <p>To further clarify the issue, we examined the top down-regulated BPs in WMs of the left and right forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E and S3F Fig</xref>, respectively). The BPs down-regulated in WM of the left forebrain (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3E Fig</xref>) are slightly more statistically significant than those in the right counterpart (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3F Fig</xref>). On the other hand, the BPs down-regulated in both areas are basically the same. Our analysis suggests that both areas of the WM may similarly involve in dementia.</p>
    </sec>
    <sec id="sec014">
      <title>Incorporating the interaction improves INSIDER</title>
      <p>To verify that the performance of INSIDER is significantly improved by considering interaction, we conducted the following statistical test. Generally, performance on held-out data is considered a golden standard to evaluate model performance. Thus, we examine whether incorporating interaction terms improves the performance of INSIDER on held-out data using RMSE. First, we randomly drew 10% of the elements without replacement from the data matrix as testset and considered the left elements as trainset. Second, we followed the same procedure to select hyperparameters for INSIDER with and without the interaction term. Then, we ran INSIDER on the trainset with the selected hyperparameters 50 times for 30 iterations with different parameter initializations and reported their RMSE on the testset. Finally, we examined whether the RMSE of INSIDER with interaction is statistically significantly lower than that of INSIDER without interaction with a one-sided <italic toggle="yes">t</italic>-test. The <italic toggle="yes">p</italic>-value (<italic toggle="yes">p</italic>-value &lt; 2.2e-16) from the test suggests that incorporating interaction improves the performance of INSIDER. The mean with standard error for INSIDER with and without interaction are 0.2297+0.0001 and 0.2302+0.0001, respectively. To our knowledge, the relatively small improvement in RMSE is due to the fact that only a small proportion of genes contribute to the interaction between dementia and brain structures.</p>
    </sec>
    <sec id="sec015">
      <title>Discover heterogeneous effects of dementia on brain structures</title>
      <p>Here we further show that the interaction term improves model interpretation of INSIDER. As dementia was shown to have potentially heterogeneous effects on the left and right HPC at gene levels (Section II in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4 Fig</xref>), we seek to compare BPs down-regulated by dementia in the left and right HPC to clarify the issue further.</p>
      <p>Here we will highlight how INSIDER with interaction is useful in unraveling interactions between biological variables (in this case, dementia diagnosis × brain structure). Compared to controls, dementia is associated with changes in gene expression, but the degree of change may not be uniform across different brain structures/regions. For instance, dementia may increase the expression of gene <italic toggle="yes">X</italic> by 1 unit, and the expression is also, on average, elevated by 1 unit across brain regions. However, dementia could be associated with a 5-unit increase in gene <italic toggle="yes">X</italic> expression in region <italic toggle="yes">Y</italic>, due to the presence of an interaction.</p>
      <p>First, we used the left HPC as an example to show how to obtain BPs down-regulated by dementia. First, we multiplied the submatrix <italic toggle="yes">W</italic><sub><italic toggle="yes">k</italic></sub> of interaction representation corresponding to the left HPC by gene representation <italic toggle="yes">V</italic>. In the operation, several metagenes with the least variance in the submatrix were excluded. Technical details of metagene selection are provided in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>. Then, we examined the down-regulated BPs enriched by genes showing significant differences in expression in the left HPC between dementia and controls (<xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>). Similarly, BPs down-regulated by dementia in the right HPC can be obtained (<xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>).</p>
      <p>Overall, most down-regulated BPs are more significant in the left HPC (<italic toggle="yes">P</italic> at 1e-66 in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>) than in the right (<italic toggle="yes">P</italic> at 2e-57 in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>). Moreover, the gene ratio in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> is also greater than in <xref rid="pgen.1011189.s004" ref-type="supplementary-material">S3D Fig</xref>. Here gene ratio is the proportion of genes enriched for a BP. Regarding BPs enriched for the two brain structures, there is little difference in general. This leads to a similar finding that the left and right HPC may be affected differently by dementia and supported by previous studies we discussed earlier.</p>
      <p>To summarize, INSIDER demonstrates the following advantages over existing methods in analyzing the aging, dementia, and TBI data. INSIDER enables clustering donors into disease subtypes. This task is inapplicable to GLM-based methods for DGE analysis. Moreover, INSIDER reduces dimension with respect to one variable (e.g., donor) while controlling for variation from other variables (e.g., brain regions) and helps gain insights into the interaction between brain regions and dementia diagnosis. However, PCA- and NMF-based methods are also not applicable for these tasks, as they cannot perform dimension reduction with respect to different covariates separately and consider the interaction between covariates. Moreover, tensor decomposition cannot be employed to explore the interaction, as there are several observations for different combinations of brain regions and diagnosis of dementia and thus the data cannot be formatted into order-3 tensors.</p>
    </sec>
    <sec id="sec016">
      <title>Computing time and memory requirements</title>
      <p>The computing time of INSIDER varies depending on the stopping criteria and computational resources allocated. In our study, with the defined stopping criteria, INSIDER takes approximately 5 hours and 8 hours to run the BrainSpan dataset (524×43,411) and the aging, dementia, and TBI dataset (377×44,477), respectively, when using 30 cores (Intel Xeon Gold 6230 CPU @2.10GHz).</p>
      <p>Owing to our implementation with RcppArmadillo for parallel computing, INSIDER has relatively low memory requirements. It requires less than 5GB of memory for the BrainSpan dataset and the aging, dementia, and TBI dataset.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Discussion</title>
    <p>We demonstrated the versatility and potential of INSIDER through applications in which various downstream analyses were performed. In the first application, the development trajectories across the human life span were revealed, and up- and down-regulated BPs underlying them were uncovered. Moreover, the implicated brain regions were characterized. In the other application, we explored the mechanisms contributing to dementia, identified subgroups among donors with latent donor representations, and examined the contribution of tissues (e.g., brain regions) to biological conditions (e.g., dementia). Our results are supported by the literature. For example, the interpretation of the development trajectories is consistent with findings from previous studies.</p>
    <p>INSIDER has the following advantages. First, it is general and flexible, in which covariates and interactions in modeling can be adjusted according to research interest. Second, it is versatile and interpretable in terms of downstream analysis. Various downstream analyses were carried out, such as revealing development trajectory, clustering donors, revealing disease mechanisms, and exploring interactions between covariates. Third, it encourages sparsity in gene representations by introducing elastic-net regularization, thus facilitating result interpretations. Fourth, it can capture interactions between covariates, common in biological settings. Finally, it has good scalability and allows missing values.</p>
    <p>Moreover, the advantages of INSIDER over existing methods have been demonstrated via applications. Compared with INSIDER, GLM-based methods for DGE analysis do not aim for dimension reduction and thus do not enable clustering donors in low-dimension, revealing developmental trajectories, and characterizing brain regions or development stages. Moreover, traditional PCA/factor analysis decomposes the variation of <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> by <italic toggle="yes">Z</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> = <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup>
<italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup>. Both <italic toggle="yes">H</italic><sup><italic toggle="yes">N</italic>×<italic toggle="yes">K</italic></sup> and <italic toggle="yes">L</italic><sup><italic toggle="yes">K</italic>×<italic toggle="yes">M</italic></sup> are unobserved. The <italic toggle="yes">L</italic> combines two or more variables into a single component/factor. Similarly, INSIDER combines several genes that tend to be co-expressed or work together to induce biological functions into a single metagene. Thus, <italic toggle="yes">V</italic> in INSIDER is analogous to <italic toggle="yes">L</italic> in factor analysis, the elements of <italic toggle="yes">V</italic> represent the effects of metagenes on individual genes, and the contribution of individual genes to each metagene is represented by the corresponding row of <italic toggle="yes">V</italic>. Moreover, INSIDER can be considered a generalization/extension of factor analysis, where the factors are modelled as being under the influence of some covariates. In INSIDER, we introduce a model of <italic toggle="yes">F</italic> in terms of covariates <italic toggle="yes">X</italic> by <italic toggle="yes">F</italic> = <italic toggle="yes">XB</italic>, where <italic toggle="yes">X</italic> is an indicator matrix of measured covariates and <italic toggle="yes">B</italic> is a matrix of coefficients. The covariates are classified into donor (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>), phenotype (<italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>), tissue (<italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>), and phenotype-by-tissue interactions (<italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>). However, these indicator matrices can be joined into a single matrix <italic toggle="yes">X</italic> = (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>), if the coefficient matrices are also joined together into a single matrix <italic toggle="yes">B</italic> = (<italic toggle="yes">D</italic><sup>⊺</sup>,<italic toggle="yes">P</italic><sup>⊺</sup>,<italic toggle="yes">T</italic><sup>⊺</sup>,<italic toggle="yes">W</italic><sup>⊺</sup>)<sup>⊺</sup>. Thus, this gives the overall INSIDER model by <italic toggle="yes">Z</italic> = <italic toggle="yes">XBV</italic> + Θ. Different from PCA/factor analysis, INSIDER directly associates the covariates (<italic toggle="yes">X</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">P</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">T</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">W</italic></sub>) with the metagenes through the matrices <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>, and this provides insights on how covariates affect the biological pathways. However, the estimation of <italic toggle="yes">V</italic> in PCA/factor analysis is not guided by the covariates and thus it cannot directly associate the components/factors with the covariates. In addition, INSIDER enables computing adjusted expression profiles for covariates, thus uncovering the effect of covariates on gene expression. In contrast with INSIDER, standard NMF-based methods cannot model variation from <italic toggle="yes">multiple</italic> variables separately and capture their interaction. and unable directly infer down-regulation in biological settings, which impairs its interpretability. Compared with tensor decomposition, the closest analog of INSIDER, INSIDER also demonstrates its superiority through simulation studies and is able to handle the situation where the data matrix cannot be formatted into tensors, as demonstrated via applications. A more explicitly comparison of the above capabilities of INSIDER with those of the other methods is displayed in <xref rid="pgen.1011189.s008" ref-type="supplementary-material">S3 Table</xref>.</p>
    <p>Bulk RNA-Seq techniques are popular in studying tissue-specific expression profiles. Usually, confounding variables (covariates) are inevitably introduced in the RNA-Seq expression data. For example, GTEx [<xref rid="pgen.1011189.ref002" ref-type="bibr">2</xref>] data contains confounding variables and other features leading to variations in expression, such as donor, gender, and age. However, few studies fully addressed the issue of <italic toggle="yes">multiple</italic> confounders or covariates while also achieving dimensionality reduction (DR). Existing approaches such as PCA, factor analysis, and non-negative matrix factorization only can reduce data dimensionality but have substantial limitations, as described above. The importance of an improved methodology to perform DR in high-dimensional data with <italic toggle="yes">multiple</italic> covariates has become more prominent with the increasing availability of RNA-seq data and the popularity of joint data analysis from different sources. For example, the PsychENCODE project [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>] is composited of several independent projects, such as ATP (the Autism Tissue Program) [<xref rid="pgen.1011189.ref005" ref-type="bibr">5</xref>], CMC (the CommonMind Consortium) [<xref rid="pgen.1011189.ref041" ref-type="bibr">41</xref>], and BrainGVEX [<xref rid="pgen.1011189.ref004" ref-type="bibr">4</xref>], with different study aims. INSIDER well addresses the challenge and takes account of sparsity in gene expression and the interaction between covariates simultaneously. More importantly, it has excellent interpretability and can be applied to large-scale data analysis.</p>
    <p>Meanwhile, we notice that the development stages are in chronological order. In practice, we consider them as unordered categorical variables because human brain development is nonlinear and the development of brain structures is specific to certain development stages, as we discussed previously. It is more reasonable to model development stages as unordered categorical variables. On the other hand, our simulation studies show that INSIDER can recover the monotonic trend for ordinal variables (Section VI in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Therefore, it is a feasible solution for INSIDER to consider ordinal variables as unordered categorical variables. It is ideal for INSIDER to consider ordinal variables explicitly. We would like to address this issue in future.</p>
    <p>Future works may also include further analysis of various bulk RNA-seq datasets and extend it to single-cell data analysis. In addition, further experimental studies to validate the findings from our applications will be an important future direction. We note that the biological findings should be considered tentative until further replicated by further experimental and clinical studies.</p>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Conclusion</title>
    <p>This article proposed a novel statistical approach, INSIDER, based on matrix decomposition, to model the variation contributed by confounding variables or covariates in bulk RNA-Seq data and decompose it into a shared low-rank latent space. The variation may originate differently, such as donor, gender, tissue, or other biological conditions. INSIDER is a general and flexible framework, which is robust to missing values. In particular, it can capture interactions between variables or covariates. Moreover, it encourages sparsity in latent representations by imposing the elastic net penalty, thus facilitating model interpretations. In our applications, various downstream analyses were carried out based on results from INSIDER. The broad applicability of INSIDER in biomedical and clinical settings was demonstrated in the applications.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec019">
    <title>Methods</title>
    <p>Here we propose INSIDER, based on additive matrix factorization, to decompose heterogeneous biological variation in RNA-Seq data into a low-rank latent space.</p>
    <sec id="sec020">
      <title>Model specifications</title>
      <p>Denote <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> as the expression level of gene <italic toggle="yes">m</italic> of sample <italic toggle="yes">s</italic> from tissue <italic toggle="yes">h</italic> of donor <italic toggle="yes">i</italic> with phenotype <italic toggle="yes">j</italic>. We assume that there are <italic toggle="yes">N</italic> observations, <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, and <italic toggle="yes">N</italic><sub>3</sub> tissues. <italic toggle="yes">z</italic><sub><italic toggle="yes">ijhm</italic></sub> is modelled as
<disp-formula id="pgen.1011189.e024"><alternatives><graphic xlink:href="pgen.1011189.e024.jpg" id="pgen.1011189.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>w</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>, <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>, <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>, <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> are vectors of length <italic toggle="yes">K</italic>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is usually ignored when donor, tissue, and phenotype information is available and can be included to capture variation from unknown sources when part or all of the source information is unavailable. Note that the above equation incorporates the interaction effect between tissues and phenotypes via introducing <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> on gene expression. For example, a certain disease may be associated with changes in gene expression, but the degree of change may differ by the tissue type. The objective function that we seek to minimize for <xref rid="pgen.1011189.e024" ref-type="disp-formula">Eq 1</xref> is defined as
<disp-formula id="pgen.1011189.e025"><alternatives><graphic xlink:href="pgen.1011189.e025.jpg" id="pgen.1011189.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e026"><alternatives><graphic xlink:href="pgen.1011189.e026.jpg" id="pgen.1011189.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pgen.1011189.e027"><alternatives><graphic xlink:href="pgen.1011189.e027.jpg" id="pgen.1011189.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be represented with matrix notations. Let <italic toggle="yes">Z</italic> ∈ ℝ<sup><italic toggle="yes">N</italic>×<italic toggle="yes">M</italic></sup> represent the data matrix for the expression profile of <italic toggle="yes">N</italic> samples and <italic toggle="yes">M</italic> genes. The matrices <inline-formula id="pgen.1011189.e028"><alternatives><graphic xlink:href="pgen.1011189.e028.jpg" id="pgen.1011189.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the rank <italic toggle="yes">K</italic> latent representations for <italic toggle="yes">N</italic><sub>1</sub> donors, <italic toggle="yes">N</italic><sub>2</sub> phenotypes, <italic toggle="yes">N</italic><sub>3</sub> tissues, <italic toggle="yes">N</italic><sub>2</sub> * <italic toggle="yes">N</italic><sub>3</sub> interactions, <italic toggle="yes">N</italic> observations, and <italic toggle="yes">M</italic> genes, respectively. <inline-formula id="pgen.1011189.e029"><alternatives><graphic xlink:href="pgen.1011189.e029.jpg" id="pgen.1011189.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>W</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are indicator matrices, representing the dummy design matrices for <italic toggle="yes">N</italic> samples. <italic toggle="yes"><inline-formula id="pgen.1011189.e030"><alternatives><graphic xlink:href="pgen.1011189.e030.jpg" id="pgen.1011189.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>U</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula></italic> is an identity matrix, which can be ignored and is added for the consideration of consistency in notations. <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> can be rewritten as:
<disp-formula id="pgen.1011189.e031"><alternatives><graphic xlink:href="pgen.1011189.e031.jpg" id="pgen.1011189.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:mrow><mml:msubsup><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e032"><alternatives><graphic xlink:href="pgen.1011189.e032.jpg" id="pgen.1011189.e032g" position="anchor"/><mml:math id="M32" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo>∥</mml:mo><mml:mi>D</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>P</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>T</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>∥</mml:mo><mml:mi>U</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pgen.1011189.e033"><alternatives><graphic xlink:href="pgen.1011189.e033.jpg" id="pgen.1011189.e033g" position="anchor"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∥</mml:mo><mml:mi>V</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Missing entries in <italic toggle="yes">Z</italic> are removed in the summation in the first line of the equation.</p>
    </sec>
    <sec id="sec021">
      <title>Model fitting</title>
      <p>Alternating block coordinate descent (BCD) was employed to optimize <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. In each iteration, we update all parameters of INSIDER sequentially. We repeat the process until the stop criteria meets.</p>
    </sec>
    <sec id="sec022">
      <title>Optimize the objective function</title>
      <p>First, we choose to maximize the objective function with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> in <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>. By fixing all <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub>,<italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub>,<italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub>,<italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub> and taking the derivative with respect to <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub>, we can have the update for <italic toggle="yes">p</italic><sub><italic toggle="yes">j</italic></sub> as follows
<disp-formula id="pgen.1011189.e034"><alternatives><graphic xlink:href="pgen.1011189.e034.jpg" id="pgen.1011189.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e035"><alternatives><graphic xlink:href="pgen.1011189.e035.jpg" id="pgen.1011189.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub> is the set of row indices of samples with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">j</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub>. Similarly, the update for <italic toggle="yes">t</italic><sub><italic toggle="yes">h</italic></sub> can be derived as
<disp-formula id="pgen.1011189.e036"><alternatives><graphic xlink:href="pgen.1011189.e036.jpg" id="pgen.1011189.e036g" position="anchor"/><mml:math id="M36" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e037"><alternatives><graphic xlink:href="pgen.1011189.e037.jpg" id="pgen.1011189.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub> is the set of row indices of samples from tissue <italic toggle="yes">h</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">h</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub>. Likewise, we can have the update for <italic toggle="yes">d</italic><sub><italic toggle="yes">i</italic></sub>:
<disp-formula id="pgen.1011189.e038"><alternatives><graphic xlink:href="pgen.1011189.e038.jpg" id="pgen.1011189.e038g" position="anchor"/><mml:math id="M38" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e039"><alternatives><graphic xlink:href="pgen.1011189.e039.jpg" id="pgen.1011189.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub> is the set of row indices of samples from donor <italic toggle="yes">i</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">i</italic></sub> denote the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub>. Besides, the update for <italic toggle="yes">w</italic><sub><italic toggle="yes">jh</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e040"><alternatives><graphic xlink:href="pgen.1011189.e040.jpg" id="pgen.1011189.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e041"><alternatives><graphic xlink:href="pgen.1011189.e041.jpg" id="pgen.1011189.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub> is the set of row indices of samples of tissue <italic toggle="yes">h</italic> with phenotype <italic toggle="yes">j</italic>, and <italic toggle="yes">N</italic><sub><italic toggle="yes">jh</italic></sub> is the number of elements in <italic toggle="yes">S</italic><sub><italic toggle="yes">jh</italic></sub>. Finally, the update for <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> can be derived as follows
<disp-formula id="pgen.1011189.e042"><alternatives><graphic xlink:href="pgen.1011189.e042.jpg" id="pgen.1011189.e042g" position="anchor"/><mml:math id="M42" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where<inline-formula id="pgen.1011189.e043"><alternatives><graphic xlink:href="pgen.1011189.e043.jpg" id="pgen.1011189.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pgen.1011189.e044"><alternatives><graphic xlink:href="pgen.1011189.e044.jpg" id="pgen.1011189.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the <italic toggle="yes">s</italic>-th row of <inline-formula id="pgen.1011189.e045"><alternatives><graphic xlink:href="pgen.1011189.e045.jpg" id="pgen.1011189.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <italic toggle="yes">u</italic><sub><italic toggle="yes">s</italic></sub> is latent representation for the <italic toggle="yes">s</italic>-th sample.</p>
      <p>In the above, we derived the updates for <italic toggle="yes">D</italic>,<italic toggle="yes">P</italic>,<italic toggle="yes">T</italic>,<italic toggle="yes">W</italic>,<italic toggle="yes">U</italic> for categorical covariates. In fact, INSIDER can also handle continuous covariate. For illustration, let denote <italic toggle="yes">q</italic> is a vector of length <italic toggle="yes">K</italic> for latent representation for a continuous covariate, and <inline-formula id="pgen.1011189.e046"><alternatives><graphic xlink:href="pgen.1011189.e046.jpg" id="pgen.1011189.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the variable across <italic toggle="yes">N</italic> observations.</p>
      <disp-formula id="pgen.1011189.e047">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e047.jpg" id="pgen.1011189.e047g" position="anchor"/>
          <mml:math id="M47" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi mathvariant="script">L</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>q</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>T</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>W</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>U</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>V</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mo>|</mml:mo>
              <mml:mo>|</mml:mo>
              <mml:mi>Z</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mfenced>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>D</mml:mi>
                  </mml:msub>
                  <mml:mi>D</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>q</mml:mi>
                  </mml:msub>
                  <mml:msup>
                    <mml:mi>q</mml:mi>
                    <mml:mo>⊤</mml:mo>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msub>
                  <mml:mi>T</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>W</mml:mi>
                  </mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mi>U</mml:mi>
                  </mml:msub>
                  <mml:mi>U</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mi>V</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:msubsup>
                <mml:mo>|</mml:mo>
                <mml:mi>F</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e048">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e048.jpg" id="pgen.1011189.e048g" position="anchor"/>
          <mml:math id="M48" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>q</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>W</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>U</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pgen.1011189.e049">
        <alternatives>
          <graphic xlink:href="pgen.1011189.e049.jpg" id="pgen.1011189.e049g" position="anchor"/>
          <mml:math id="M49" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msubsup>
                    <mml:mo>∥</mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>V</mml:mi>
                  <mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
      <p>In the equation, the meaning of other notations is the same as in the manuscript. With other parameters fixed, the objective function with respect to <italic toggle="yes">q</italic> can be simplified as follows:
<disp-formula id="pgen.1011189.e050"><alternatives><graphic xlink:href="pgen.1011189.e050.jpg" id="pgen.1011189.e050g" position="anchor"/><mml:math id="M50" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mi>q</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>Tr</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mi>V</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo>∥</mml:mo><mml:mi>q</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1011189.e051"><alternatives><graphic xlink:href="pgen.1011189.e051.jpg" id="pgen.1011189.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi></mml:mrow></mml:mfenced><mml:mi>V</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> By minimizing the objective with respect to <italic toggle="yes">q</italic>, the update for <italic toggle="yes">q</italic> can be obtained by
<disp-formula id="pgen.1011189.e052"><alternatives><graphic xlink:href="pgen.1011189.e052.jpg" id="pgen.1011189.e052g" position="anchor"/><mml:math id="M52" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>q</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi>V</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>⊤</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⊤</mml:mo></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>This feature has been incorporated into the software of INSIDER.</p>
      <p>When we seek to minimize the objective function defined by <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref> with respect to <italic toggle="yes">v</italic><sub><italic toggle="yes">m</italic></sub>, the <italic toggle="yes">m</italic>-th column of <italic toggle="yes">V</italic>, with all the other parameters fixed, the equation can be simplified into the following elastic net problem
<disp-formula id="pgen.1011189.e053"><alternatives><graphic xlink:href="pgen.1011189.e053.jpg" id="pgen.1011189.e053g" position="anchor"/><mml:math id="M53" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Here <inline-formula id="pgen.1011189.e054"><alternatives><graphic xlink:href="pgen.1011189.e054.jpg" id="pgen.1011189.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> is the expression levels of the <italic toggle="yes">m</italic>-th gene across the <italic toggle="yes">N</italic> samples, and missing entries in <italic toggle="yes">Z</italic><sub><italic toggle="yes">m</italic></sub> are removed in the calculation. The randomized coordinate descent (RCD) algorithm proposed in Algorithm 1 in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref> is employed to optimize each column of <italic toggle="yes">V</italic> in parallel.</p>
      <p>In practice, optimizing the subproblems defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> is computationally intensive. The safe rules for screening are adopted to accelerate the computation, which discard variables with coefficients that are shrunk to zero in optimization. To illustrate with <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref>, the rules defined by Eq. 24 in the study [<xref rid="pgen.1011189.ref042" ref-type="bibr">42</xref>] for discarding predictor <italic toggle="yes">j</italic> is
<disp-formula id="pgen.1011189.e055"><alternatives><graphic xlink:href="pgen.1011189.e055.jpg" id="pgen.1011189.e055g" position="anchor"/><mml:math id="M55" display="block" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pgen.1011189.e056"><alternatives><graphic xlink:href="pgen.1011189.e056.jpg" id="pgen.1011189.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic toggle="yes">u</italic><sub><italic toggle="yes">j</italic></sub> is the <italic toggle="yes">j</italic>-th column of <italic toggle="yes">U</italic>.</p>
    </sec>
    <sec id="sec023">
      <title>Initialization, hyperparameter tuning and the stopping criterion</title>
      <p>Regarding initialization of <italic toggle="yes">D</italic>, <italic toggle="yes">P</italic>, <italic toggle="yes">T</italic>, <italic toggle="yes">W</italic>, <italic toggle="yes">U</italic>, <italic toggle="yes">V</italic> defined in the <xref rid="pgen.1011189.e026" ref-type="disp-formula">Eq 2</xref>, they are initiated from normal distribution <italic toggle="yes">N</italic>(0, 0.001). We consider the solution from the previous iteration as warm start for the subproblem defined by <xref rid="pgen.1011189.e053" ref-type="disp-formula">Eq 3</xref> in optimization.</p>
      <p>In model selection, we use the following procedure to select the hyperparameters {<italic toggle="yes">K</italic>,<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>} for INSIDER. Specifically, we first randomly draw 10% of elements without replacement from the data matrix as testset and consider the left data as trainset. Only the trainset is used to train INSIDER, and the testset is independent from model training and utilized for model selection. Specifically, we first train INSIDER on the trainset and then examine whether our approximations for the testset by the trained model can well approximate their real values. This practice is also consistent with the idea of cross-validation, which performs model selection based on model performance on held-out data. In fact, it is also widely used in recommendation systems [<xref rid="pgen.1011189.ref043" ref-type="bibr">43</xref>] and matrix completion [<xref rid="pgen.1011189.ref044" ref-type="bibr">44</xref>]. To evaluate the performance of INSIDER with different hyperparameters, the root mean squared error (RMSE) on the testset is calculated, which measures the root averaged squared difference between the approximations from INSIDER and the real values, so a lower RMSE on the testset corresponds to a better model.</p>
      <p>In our applications, <italic toggle="yes">K</italic> was chosen from a sequence from 10 to 30 with step size 2. The range of <italic toggle="yes">K</italic> is enough in general and can be broadened to consider more complex models. For each try of <italic toggle="yes">K</italic> from the sequence, we run INSIDER for 30 iterations. In the process, <italic toggle="yes">λ</italic> is set to 0.1 to avoid singularity in matrix inverse, and <italic toggle="yes">α</italic> is fixed to 0. Then, we select the rank <italic toggle="yes">K</italic> corresponding to the lowest RMSE on the testset. Empirical evidence shows that 30 iterations are sufficient to give consistent selection results, compared with 50 iterations (Section IV in <xref rid="pgen.1011189.s001" ref-type="supplementary-material">S1 Text</xref>). Also, previous studies [<xref rid="pgen.1011189.ref014" ref-type="bibr">14</xref>,<xref rid="pgen.1011189.ref022" ref-type="bibr">22</xref>] utilized a small number of iterations (e.g., 20 iterations) to select the rank <italic toggle="yes">K</italic> for the methods based on matrix factorization. Note that our method for selecting <italic toggle="yes">K</italic> is quite computationally efficient, since we set <italic toggle="yes">α</italic> = 0 and the update for all parameters can be computed in a closed form.</p>
      <p>After choosing <italic toggle="yes">K</italic>, we define a parameter grid for {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>}. For each set of candidate hyperparameters {<italic toggle="yes">λ</italic>,<italic toggle="yes">α</italic>},we also run alternating BCD for 30 iterations and choose the parameters with the best performance on the test set.</p>
      <p>In our study, the stopping criteria is defined as
<disp-formula id="pgen.1011189.e057"><alternatives><graphic xlink:href="pgen.1011189.e057.jpg" id="pgen.1011189.e057g" position="anchor"/><mml:math id="M57" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where <inline-formula id="pgen.1011189.e058"><alternatives><graphic xlink:href="pgen.1011189.e058.jpg" id="pgen.1011189.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ℒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>·</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes the loss at the <italic toggle="yes">i</italic>-th iteration, and <italic toggle="yes">δ</italic> is a predefined threshold and set to 10<sup>−10</sup> in our experiment.</p>
    </sec>
  </sec>
  <sec id="sec024" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pgen.1011189.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary Content.</title>
        <p>It provides technical details on enrichment analysis, gene selection in comparing expression differences between dementia and control across brain regions, and metagene selection for discovering heterogeneous effects of dementia on brain structures. Regarding the model selection of INSIDER, it demonstrates the effect of different numbers of iterations (e.g., 30, 50) on model selection. It also shows the capability of INSIDER to handle ordinal variables via simulation studies. Regarding the difference between INSIDER and PCA/factor analysis or GLM-based approaches, it presents an in-depth discussion on their differences. To demonstrate its wide applicability, results from analyzing gender differences in gene expression of the human brain with GTEx using INSIDER are provided. Further, derivations for random coordinate descent for elastic net problems and the RCD algorithm (Algorithm 1) for the elastic net with screening rules are also presented.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s001.docx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The top 30 up- and down-regulated BPs enriched by the 2nd and 17th metages.</title>
        <p>The top 30 up-regulated BPs (S1A Fig) enriched by the 2nd metagene and down-regulated BPs (S1D Fig) by the 17th metagene are related to learning, memory, cognition, and synaptic functions and neurotransmitter activities. The top 30 down-regulated BPs (<xref rid="pgen.1011189.s003" ref-type="supplementary-material">S2B Fig</xref>) enriched by the 2nd metagene involve axon development, axonogenesis, myelination, and gliogenesis. The top 30 up-regulated BPs (S1C Fig) by the 17th metagene cover the BPs related to cell development and differentiation.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s002.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The trajectory of the least variable metagene and top 30 BPs enriched by metagenes.</title>
        <p>S2A Fig shows that the trajectory of the least variable metagene is negative and basically flat across human brain development. The top 30 down-regulated BPs (S2B Fig) encoded by the metagene involve cell and ATP metabolism and cell communication. Moreover, the top 30 up-regulated BPs (S2C Fig) enriched by the 5th metagene involve ossification and development of bone, muscle, and sensory systems, and the top 30 up-regulated BPs (S2D Fig) by the 1st metagene cover learning or memory, cognition, and hormone (e.g., dopamine, monoamine, and catecholamine) secretion and transport.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s003.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Supplement Figs for analysis of the aging, dementia, and TBI data.</title>
        <p>S3A Fig shows the dendrogram of hierarchical clustering on donor representation with the selected metagenes. We selected 3 subgroups for further analysis. The top 30 down-regulated BPs (S3B Fig) enriched by the 13th metagene involve cognitive functions, and the top 30 up-regulated BPs (S3C Fig) enriched by the 17th cover learning, memory, cognition, and synaptic functions. S3D Fig shows the top 30 down-regulated BPs enriched by the difference in gene expression of right HPC between dementia and control. Overall, the <italic toggle="yes">p</italic>-values for most down-regulated BPs in S3D Fig are significant at 2e-57, which are greater than those for the left HPC shown in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref> from the manuscript (<italic toggle="yes">P</italic> at 1e-66). Moreover, the gene ratio in S3D Fig is also smaller than in <xref rid="pgen.1011189.g003" ref-type="fig">Fig 3C</xref>. This leads to the finding that the left and right HPC may be affected differently by dementia. S3E and <xref rid="pgen.1011189.s005" ref-type="supplementary-material">S4F</xref> Figs show the top 30 down-regulated BPs enriched by the difference in expression profiles for WM of the left and right forebrain, respectively. The BPs in S3E Fig are slightly more statistically significant than those in S3F Fig and the BPs in the two figures are basically the same.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s004.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s005" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Comparison of differences in the expression of three selected genes between dementia and control across brain regions.</title>
        <p>The figure compares the expression levels of three selected genes (NRGN, CAMK2A, and SHISA6) between dementia and control across brain regions, suggesting that dementia has potentially heterogeneous effects on the left and right HPC at gene levels.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1011189.s005.tif"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s006" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Tab A. The loadings of all metagenes across brain development stages in the analysis of the BrainSpan dataset.</title>
        <p>The table shows that the loading of the 5th metagene for the early-mid fetal stage (the 5th stage) is highly positive, and its absolute value is much larger than that of the metagene for other developmental stages. Thus, the 5th metagene can be used to characterize the stage. <bold>Tab B. The loadings of all metagenes across all brain regions in the analysis of the BrainSpan dataset.</bold> The table shows that the loading of the 1st metagene for the striatum is highly positive, and its absolute value is much larger than that of the metagene for other brain regions. Thus, the 1st metagene can be used to characterize the brain region.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s007" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The loadings of all metagenes across all brain regions in the analysis of the aging, dementia, and TBI dataset.</title>
        <p>The table shows that the loadings of the 17th metagene are only negative for FWM (both left and right) and their absolute value is much larger than those for other brain regions. Therefore, this metagene can be utilized to reveal the functions of FWM in the brains of aged donors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pgen.1011189.s008" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Comparison of INSIDER with the other methods in their capabilities in accommodating different situations in the analysis of gene expression data.</title>
        <p>In the table, we compare INSIDER with other methods, including PCA/NMF, SDA, and the GLM-based methods for DEG analysis, in their abilities to handle more than 3-dimensional data, to incorporate interaction, to allow missing data, to reduce data dimensionality, to perform differential expression analysis, and to handle multidimensional (&gt; = 3 dimensions) data that cannot fit into tensors.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1011189.s008.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1011189.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>. <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature reviews genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>57</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><?supplied-pmid 19015660?><pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lonsdale</surname><given-names>J</given-names></name>, <name><surname>Thomas</surname><given-names>J</given-names></name>, <name><surname>Salvatore</surname><given-names>M</given-names></name>, <name><surname>Phillips</surname><given-names>R</given-names></name>, <name><surname>Lo</surname><given-names>E</given-names></name>, <name><surname>Shad</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>(<issue>6</issue>):<fpage>580</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><?supplied-pmid 23715323?><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Ding</surname><given-names>S</given-names></name>, <name><surname>Sunkin</surname><given-names>SM</given-names></name>, <name><surname>Smith</surname><given-names>KA</given-names></name>, <name><surname>Ng</surname><given-names>L</given-names></name>, <name><surname>Szafer</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional landscape of the prenatal human brain</article-title>. <source>Nature</source>. <year>2014</year>;<volume>508</volume>(<issue>7495</issue>):<fpage>199</fpage>–<lpage>206</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature13185</pub-id><?supplied-pmid 24695229?><pub-id pub-id-type="pmid">24695229</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Akbarian</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Knowles</surname><given-names>JA</given-names></name>, <name><surname>Vaccarino</surname><given-names>FM</given-names></name>, <name><surname>Farnham</surname><given-names>PJ</given-names></name>, <name><surname>Crawford</surname><given-names>GE</given-names></name>, <etal>et al</etal>. <article-title>The psychencode project</article-title>. <source>Nat Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1707</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nn.4156</pub-id><?supplied-pmid 26605881?><pub-id pub-id-type="pmid">26605881</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Voineagu</surname><given-names>I</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Johnston</surname><given-names>P</given-names></name>, <name><surname>Lowe</surname><given-names>JK</given-names></name>, <name><surname>Tian</surname><given-names>Y</given-names></name>, <name><surname>Horvath</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Transcriptomic analysis of autistic brain reveals convergent molecular pathology</article-title>. <source>Nature</source>. <year>2011</year>;<volume>474</volume>(<issue>7351</issue>):<fpage>380</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10110</pub-id><?supplied-pmid 21614001?><pub-id pub-id-type="pmid">21614001</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ha</surname><given-names>S</given-names></name>, <name><surname>Sohn</surname><given-names>I</given-names></name>, <name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Sim</surname><given-names>HJ</given-names></name>, <name><surname>Cheon</surname><given-names>K</given-names></name>. <article-title>Characteristics of brains in autism spectrum disorder: structure, function and connectivity across the lifespan</article-title>. <source>Experimental neurobiology</source>. <year>2015</year>;<volume>24</volume>(<issue>4</issue>):<fpage>273</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.5607/en.2015.24.4.273</pub-id><?supplied-pmid 26713076?><pub-id pub-id-type="pmid">26713076</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lord</surname><given-names>C</given-names></name>, <name><surname>Cook</surname><given-names>EH</given-names></name>, <name><surname>Leventhal</surname><given-names>BL</given-names></name>, <name><surname>Amaral</surname><given-names>DG</given-names></name>. <article-title>Autism spectrum disorders</article-title>. <source>Neuron</source>. <year>2000</year>;<volume>28</volume>(<issue>2</issue>):<fpage>355</fpage>–<lpage>63</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/s0896-6273(00)00115-x</pub-id><?supplied-pmid 11144346?><pub-id pub-id-type="pmid">11144346</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ritchie</surname><given-names>ME</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Wu</surname><given-names>DI</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>. <article-title>Differential expression analysis for sequence count data</article-title>. <source>Nature Precedings</source>. <year>2010</year>:<fpage>1</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Duchi</surname><given-names>J</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous dimension reduction and adjustment for confounding variation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>51</issue>):<fpage>14662</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1617317113</pub-id><?supplied-pmid 27930330?><pub-id pub-id-type="pmid">27930330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>X</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>. <article-title>Batch effects correction with unknown subtypes</article-title>. <source>Journal of the American Statistical Association</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>WE</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Rabinovic</surname><given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name>. <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>. <year>1999</year>;<volume>401</volume>(<issue>6755</issue>):<fpage>788</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/44565</pub-id><?supplied-pmid 10548103?><pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Qian</surname><given-names>K</given-names></name>, <name><surname>Fu</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>WV</given-names></name>. <article-title>scINSIGHT for interpreting single-cell gene expression from biologically heterogeneous data</article-title>. <source>Genome Biol</source>. <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">34980209</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Gao</surname><given-names>C</given-names></name>, <name><surname>Sodicoff</surname><given-names>J</given-names></name>, <name><surname>Kozareva</surname><given-names>V</given-names></name>, <name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Welch</surname><given-names>JD</given-names></name>. <article-title>Jointly defining cell types from multiple single-cell datasets using LIGER</article-title>. <source>Nature protocols</source>. <year>2020</year>;<volume>15</volume>(<issue>11</issue>):<fpage>3632</fpage>–<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41596-020-0391-8</pub-id><?supplied-pmid 33046898?><pub-id pub-id-type="pmid">33046898</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name>, <name><surname>Arora</surname><given-names>R</given-names></name>, <name><surname>Culhane</surname><given-names>AC</given-names></name>, <name><surname>Favorov</surname><given-names>AV</given-names></name>, <name><surname>Garmire</surname><given-names>LX</given-names></name>, <name><surname>Greene</surname><given-names>CS</given-names></name>, <etal>et al</etal>. <article-title>Enter the matrix: factorization uncovers knowledge from omics</article-title>. <source>Trends in Genetics</source>. <year>2018</year>;<volume>34</volume>(<issue>10</issue>):<fpage>790</fpage>–<lpage>805</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2018.07.003</pub-id><?supplied-pmid 30143323?><pub-id pub-id-type="pmid">30143323</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kolda</surname><given-names>TG</given-names></name>, <name><surname>Bader</surname><given-names>BW</given-names></name>. <article-title>Tensor decompositions and applications</article-title>. <source>SIAM Rev</source>. <year>2009</year>;<volume>51</volume>(<issue>3</issue>):<fpage>455</fpage>–<lpage>500</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hoff</surname><given-names>PD</given-names></name>. <article-title>Hierarchical multilinear models for multiway data</article-title>. <source>Comput Stat Data Anal</source>. <year>2011</year>;<volume>55</volume>(<issue>1</issue>):<fpage>530</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Yener</surname><given-names>B</given-names></name>, <name><surname>Acar</surname><given-names>E</given-names></name>, <name><surname>Aguis</surname><given-names>P</given-names></name>, <name><surname>Bennett</surname><given-names>K</given-names></name>, <name><surname>Vandenberg</surname><given-names>SL</given-names></name>, <name><surname>Plopper</surname><given-names>GE</given-names></name>. <article-title>Multiway modeling and analysis in stem cell systems biology</article-title>. <source>BMC systems biology</source>. <year>2008</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1752-0509-2-63</pub-id><?supplied-pmid 18625054?><pub-id pub-id-type="pmid">18171472</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hore</surname><given-names>V</given-names></name>, <name><surname>Vinuela</surname><given-names>A</given-names></name>, <name><surname>Buil</surname><given-names>A</given-names></name>, <name><surname>Knight</surname><given-names>J</given-names></name>, <name><surname>McCarthy</surname><given-names>MI</given-names></name>, <name><surname>Small</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Tensor decomposition for multiple-tissue gene expression experiments</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>9</issue>):<fpage>1094</fpage>–<lpage>100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3624</pub-id><?supplied-pmid 27479908?><pub-id pub-id-type="pmid">27479908</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the royal statistical society: series B (statistical methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Brunet</surname><given-names>J</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Golub</surname><given-names>TR</given-names></name>, <name><surname>Mesirov</surname><given-names>JP</given-names></name>. <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proceedings of the national academy of sciences</source>. <year>2004</year>;<volume>101</volume>(<issue>12</issue>):<fpage>4164</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id><?supplied-pmid 15016911?><pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HJ</given-names></name>, <name><surname>Kawasawa</surname><given-names>YI</given-names></name>, <name><surname>Cheng</surname><given-names>F</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal transcriptome of the human brain</article-title>. <source>Nature</source>. <year>2011</year>;<volume>478</volume>(<issue>7370</issue>):<fpage>483</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature10523</pub-id><?supplied-pmid 22031440?><pub-id pub-id-type="pmid">22031440</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Stiles</surname><given-names>J</given-names></name>, <name><surname>Jernigan</surname><given-names>TL</given-names></name>. <article-title>The basics of brain development</article-title>. <source>Neuropsychol Rev</source>. <year>2010</year>;<volume>20</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11065-010-9148-4</pub-id><?supplied-pmid 21042938?><pub-id pub-id-type="pmid">21042938</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Thomason</surname><given-names>ME</given-names></name>, <name><surname>Hect</surname><given-names>J</given-names></name>, <name><surname>Waller</surname><given-names>R</given-names></name>, <name><surname>Manning</surname><given-names>JH</given-names></name>, <name><surname>Stacks</surname><given-names>AM</given-names></name>, <name><surname>Beeghly</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Prenatal neural origins of infant motor development: Associations between fetal brain and infant motor development</article-title>. <source>Dev Psychopathol</source>. <year>2018</year>;<volume>30</volume>(<issue>3</issue>):<fpage>763</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1017/S095457941800072X</pub-id><?supplied-pmid 30068433?><pub-id pub-id-type="pmid">30068433</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>SB</given-names></name>, <name><surname>Blum</surname><given-names>RW</given-names></name>, <name><surname>Giedd</surname><given-names>JN</given-names></name>. <article-title>Adolescent maturity and the brain: the promise and pitfalls of neuroscience research in adolescent health policy</article-title>. <source>Journal of adolescent health</source>. <year>2009</year>;<volume>45</volume>(<issue>3</issue>):<fpage>216</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jadohealth.2009.05.016</pub-id><?supplied-pmid 19699416?><pub-id pub-id-type="pmid">19699416</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kennedy</surname><given-names>MB</given-names></name>. <article-title>Synaptic signaling in learning and memory</article-title>. <source>Cold Spring Harbor perspectives in biology</source>. <year>2016</year>;<volume>8</volume>(<issue>2</issue>):<fpage>a016824</fpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Herlenius</surname><given-names>E</given-names></name>, <name><surname>Lagercrantz</surname><given-names>H</given-names></name>. <article-title>Development of neurotransmitter systems during critical periods</article-title>. <source>Exp Neurol</source>. <year>2004</year>;<volume>190</volume>:<fpage>8</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.expneurol.2004.03.027</pub-id><?supplied-pmid 15498537?><pub-id pub-id-type="pmid">15498537</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Balleine</surname><given-names>BW</given-names></name>, <name><surname>Delgado</surname><given-names>MR</given-names></name>, <name><surname>Hikosaka</surname><given-names>O</given-names></name>. <article-title>The role of the dorsal striatum in reward and decision-making</article-title>. <source>Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>(<issue>31</issue>):<fpage>8161</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1554-07.2007</pub-id><?supplied-pmid 17670959?><pub-id pub-id-type="pmid">17670959</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Siems</surname><given-names>SB</given-names></name>, <name><surname>Kusch</surname><given-names>K</given-names></name>, <name><surname>Hesse</surname><given-names>D</given-names></name>, <name><surname>Jung</surname><given-names>RB</given-names></name>, <name><surname>Liepold</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>The CNS myelin proteome: deep profile and persistence after post-mortem delay</article-title>. <source>Frontiers in Cellular Neuroscience</source>. <year>2020</year>;<volume>14</volume>:<fpage>239</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fncel.2020.00239</pub-id><?supplied-pmid 32973451?><pub-id pub-id-type="pmid">32973451</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Jahn</surname><given-names>O</given-names></name>, <name><surname>Tenzer</surname><given-names>S</given-names></name>, <name><surname>Werner</surname><given-names>HB</given-names></name>. <article-title>Myelin proteomics: molecular anatomy of an insulating sheath</article-title>. <source>Mol Neurobiol</source>. <year>2009</year>;<volume>40</volume>:<fpage>55</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s12035-009-8071-2</pub-id><?supplied-pmid 19452287?><pub-id pub-id-type="pmid">19452287</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Shamir</surname><given-names>A</given-names></name>, <name><surname>Kwon</surname><given-names>O</given-names></name>, <name><surname>Karavanova</surname><given-names>I</given-names></name>, <name><surname>Vullhorst</surname><given-names>D</given-names></name>, <name><surname>Leiva-Salcedo</surname><given-names>E</given-names></name>, <name><surname>Janssen</surname><given-names>MJ</given-names></name>, <etal>et al</etal>. <article-title>The importance of the NRG-1/ErbB4 pathway for synaptic plasticity and behaviors associated with psychiatric disorders</article-title>. <source>Journal of Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>9</issue>):<fpage>2988</fpage>–<lpage>97</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1899-11.2012</pub-id><?supplied-pmid 22378872?><pub-id pub-id-type="pmid">22378872</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Fauth</surname><given-names>M</given-names></name>, <name><surname>Wörgötter</surname><given-names>F</given-names></name>, <name><surname>Tetzlaff</surname><given-names>C</given-names></name>. <article-title>The formation of multi-synaptic connections by the interaction of synaptic and structural plasticity and their functional consequences</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004031</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004031</pub-id><?supplied-pmid 25590330?><pub-id pub-id-type="pmid">25590330</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Guillozet-Bongaarts</surname><given-names>A</given-names></name>, <name><surname>Gibbons</surname><given-names>LE</given-names></name>, <name><surname>Postupna</surname><given-names>N</given-names></name>, <name><surname>Renz</surname><given-names>A</given-names></name>, <name><surname>Beller</surname><given-names>AE</given-names></name>, <etal>et al</etal>. <article-title>Neuropathological and transcriptomic characteristics of the aged brain</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e31126</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.31126</pub-id><?supplied-pmid 29120328?><pub-id pub-id-type="pmid">29120328</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Torres</surname><given-names>DMC</given-names></name>, <name><surname>Cardenas</surname><given-names>FP</given-names></name>. <article-title>Synaptic plasticity in Alzheimer’s disease and healthy aging</article-title>. <source>Rev Neurosci</source>. <year>2020</year>;<volume>31</volume>(<issue>3</issue>):<fpage>245</fpage>–<lpage>68</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1515/revneuro-2019-0058</pub-id><?supplied-pmid 32250284?><pub-id pub-id-type="pmid">32250284</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Clare</surname><given-names>R</given-names></name>, <name><surname>King</surname><given-names>VG</given-names></name>, <name><surname>Wirenfeldt</surname><given-names>M</given-names></name>, <name><surname>Vinters</surname><given-names>HV</given-names></name>. <article-title>Synapse loss in dementias</article-title>. <source>J Neurosci Res</source>. <year>2010</year>;<volume>88</volume>(<issue>10</issue>):<fpage>2083</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/jnr.22392</pub-id><?supplied-pmid 20533377?><pub-id pub-id-type="pmid">20533377</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Colom-Cadena</surname><given-names>M</given-names></name>, <name><surname>Spires-Jones</surname><given-names>T</given-names></name>, <name><surname>Zetterberg</surname><given-names>H</given-names></name>, <name><surname>Blennow</surname><given-names>K</given-names></name>, <name><surname>Caggiano</surname><given-names>A</given-names></name>, <name><surname>DeKosky</surname><given-names>ST</given-names></name>, <etal>et al</etal>. <article-title>The clinical promise of biomarkers of synapse damage or loss in Alzheimer’s disease</article-title>. <source>Alzheimer’s research &amp; therapy</source>. <year>2020</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13195-020-00588-4</pub-id><?supplied-pmid 32122400?><pub-id pub-id-type="pmid">32122400</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>M</given-names></name>, <name><surname>Hu</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>. <article-title>Alzheimer’s disease and impaired bone microarchitecture, regeneration and potential genetic links</article-title>. <source>Life</source>. <year>2023</year>;<volume>13</volume>(<issue>2</issue>):<fpage>373</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/life13020373</pub-id><?supplied-pmid 36836731?><pub-id pub-id-type="pmid">36836731</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>F</given-names></name>, <name><surname>Xiong</surname><given-names>L</given-names></name>, <name><surname>Zeng</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>APP promotes osteoblast survival and bone formation by regulating mitochondrial function and preventing oxidative stress</article-title>. <source>Cell death &amp; disease</source>. <year>2018</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41419-018-1123-7</pub-id><?supplied-pmid 30349052?><pub-id pub-id-type="pmid">29298988</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hackett</surname><given-names>MJ</given-names></name>, <name><surname>Hollings</surname><given-names>AL</given-names></name>, <name><surname>Lam</surname><given-names>V</given-names></name>, <name><surname>Takechi</surname><given-names>R</given-names></name>, <name><surname>Mamo</surname><given-names>JC</given-names></name>, <name><surname>de Jonge</surname><given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Metallo-maze to Memory Loss: Does Neuronal Metal Ion Deficiency Contribute to Dementia? Yakugaku Zasshi</article-title>: <source>Journal of the Pharmaceutical Society of Japan</source>. <year>2021</year>;<volume>141</volume>(<issue>6</issue>):<fpage>835</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">34078791</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>GE</given-names></name>, <name><surname>Bendl</surname><given-names>J</given-names></name>, <name><surname>Voloudakis</surname><given-names>G</given-names></name>, <name><surname>Montgomery</surname><given-names>KS</given-names></name>, <name><surname>Sloofman</surname><given-names>L</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>CommonMind Consortium provides transcriptomic and epigenomic data for Schizophrenia and Bipolar Disorder</article-title>. <source>Scientific data</source>. <year>2019</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30647409</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Bien</surname><given-names>J</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Simon</surname><given-names>N</given-names></name>, <name><surname>Taylor</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Strong rules for discarding predictors in lasso-type problems</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2012</year>;<volume>74</volume>(<issue>2</issue>):<fpage>245</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01004.x</pub-id><?supplied-pmid 25506256?><pub-id pub-id-type="pmid">25506256</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>Y</given-names></name>, <name><surname>Bell</surname><given-names>R</given-names></name>, <name><surname>Volinsky</surname><given-names>C</given-names></name>. <article-title>Matrix factorization techniques for recommender systems</article-title>. <source>Computer</source>. <year>2009</year>;<volume>42</volume>(<issue>8</issue>):<fpage>30</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1011189.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Mazumder</surname><given-names>R</given-names></name>, <name><surname>Lee</surname><given-names>JD</given-names></name>, <name><surname>Zadeh</surname><given-names>R</given-names></name>. <article-title>Matrix completion and low-rank SVD via fast alternating least squares</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>3367</fpage>–<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10208-009-9045-5</pub-id><?supplied-pmid 31130828?><pub-id pub-id-type="pmid">31130828</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Nov 2023</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>Thank you very much for submitting your Methods entitled 'INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis' to PLOS Genetics.</p>
    <p>The manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some concerns about the current manuscript. Based on the reviews, we will not be able to accept this version of the manuscript, but we would be willing to review a much-revised version. We cannot, of course, promise publication at that time.</p>
    <p>Should you decide to revise the manuscript for further consideration here, your revisions should address the specific points made by each reviewer. We will also require a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>If you decide to revise the manuscript for further consideration at PLOS Genetics, please aim to resubmit within the next 60 days, unless it will take extra time to address the concerns of the reviewers, in which case we would appreciate an expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments are included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist" ext-link-type="uri">Submission Checklist</ext-link>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>Please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link xlink:href="http://pace.apexcovantage.com/" ext-link-type="uri">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool.  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>PLOS has incorporated <ext-link xlink:href="http://www.crossref.org/crosscheck.html" ext-link-type="uri">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, use the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage. Please do not hesitate to contact us if you have any concerns or questions.</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This article proposed a dimension reduction approach for RNA expression data to decompose variation from different biological variables, which overcomes some limitations of the existing methods and was shown to be useful in the real data analysis. My comments are as follows.</p>
    <p>1. It is still not very clear to me how to interpret the metagenes together with the covariates, especially the matrix V. Because it seems that V has nothing to do with the covariates, but the metagenes from INSIDER would be different under the models with different covariates. Also, what is the difference in the interpretation of the metagenes obtained from INSIDER compared to those obtained from PCA or factor analysis?</p>
    <p>2. The article mentioned that “INSIDER decomposes variation from different biological variables”, but only the discrete covariates have been discussed. Is INSIDER also able to handle the continuous covariates?</p>
    <p>3. In the real data analysis of BrainSpan data, development stages and brain regions are used as covariates. However, the development stages are in chronological order. Does INSIDER handle the ordinal variables and the unordered categorical variables in the same manner?</p>
    <p>4. In the section “Metagenes reveal development trajectories”, it said “The expression level of the most variable metagene is high before late fetal stages and decreases to a low level after early childhood”. I wonder how the expression level of the metagene is calculated. Is there an explicit formula of the metagene? Could the author give more details?</p>
    <p>5. In the enrichment analyse for a metagene, say the 2nd metagene, it is not clear to me how to conduct the analyse because the metagene is a latent variable. It would be beneficial if more details could be provided.</p>
    <p>Reviewer #2: Dimension reduction is critically important in data exploration analysis. Particularly it provides the stepstone to understand the biological signals in high dimensional RNA-seq data. In this paper, the authors propose INSIDER, a general and flexible statistical framework based on matrix factorization. INSIDER decomposes variation from different biological variables and their interactions into a shared low-rank latent space. Particularly, it introduces the elastic net penalty to induce sparsity while considering the grouping effects of genes. It can achieve dimension reduction of high-dimensional data (of &gt;=3 dimensions), as opposed to conventional methods (e.g., PCA/NMF) which generally only handle 2D data (e.g., sample ´ expression). Besides, it enables computing 'adjusted' expression profiles for specific biological variables while controlling variation from other variables.</p>
    <p>Overall, the idea is novel and to develop new method to explain the data. better. INSIDER is a general and flexible framework. It can capture interactions between variables or covariate and encourages sparsity in latent representations by imposing the elastic net penalty. The advantages have been highlighted. The paper is well written and the motivation is explained quite clear.</p>
    <p>My minor concern is as follows,</p>
    <p>1. To use INSIDER well, the users have to know the major variation sources. For example, it’s quite typical for expression data with donors, phenotypes, tissues information. But sometimes those information is not available. How should the method be used?</p>
    <p>2. The authors added the phenotype by tissue interactions as an example. To make the method more general, it’s better to having one version without interaction term. It’s also good to demonstrate how the interaction term improves the results.</p>
    <p>3. To highlight the high-dimensional data (of &gt;=3 dimensions), it’s better to have more examples to show high-dimensional data is common and quite general case in practice.</p>
    <p>4. The choice of K is a multi-scale problem. How should we choose it in practice.</p>
    <p>5. It’s better to provide software in Github.</p>
    <p>From the editorial board:</p>
    <p>Two reviewers and the editorial team have reviewed the manuscript. They showed overall enthusiasm for the proposed method as a general and principled approach to dimension reduction, while also offering several suggestions as follow. Please carefully review those questions and suggestions and respond to them accordingly.</p>
    <p>Firstly, the authors claim that the INSIDER method can manage missing data. However, this aspect isn't explored in depth. The effect of significant and complex missing data remains uncertain. It would be beneficial to conduct further evaluations through simulation studies.</p>
    <p>Additionally, as one reviewer highlighted, the process for determining the rank K in the latent space is vague. A more clear, justifiable, and efficient method for the choice is needed.</p>
    <p>Regarding the analysis of real data, the comparison to standard and frequently used methods like PCA or GLM-based approaches is inadequate. While some discussions are present, more detailed comparative analyses are required.</p>
    <p>Lastly, showing additional simulation results in cases of model misspecification would be informative.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pgen.1011189.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">22 Jan 2024</named-content>
    </p>
    <supplementary-material id="pgen.1011189.s009" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Insider_response_letter_v4.docx</named-content></p>
      </caption>
      <media xlink:href="pgen.1011189.s009.docx"/>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pgen.1011189.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Feb 2024</named-content>
    </p>
    <p>Dear Dr Lin,</p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been editorially accepted for publication in PLOS Genetics. Congratulations!</p>
    <p>Before your submission can be formally accepted and sent to production you will need to complete our formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Please note: the accept date on your published article will reflect the date of this provisional acceptance, but your manuscript will not be scheduled for publication until the required changes have been made.</p>
    <p>Once your paper is formally accepted, an uncorrected proof of your manuscript will be published online ahead of the final version, unless you’ve already opted out via the online submission form. If, for any reason, you do not want an earlier version of your manuscript published online or are unsure if you have already indicated as such, please let the journal staff know immediately at <email>plosgenetics@plos.org</email>.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pgenetics/" ext-link-type="uri">https://www.editorialmanager.com/pgenetics/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process. Note that PLOS requires an ORCID iD for all corresponding authors. Therefore, please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to ‘Update my Information’ (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field.  This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p>
    <p>If you have a press-related query, or would like to know about making your underlying data available (as you will be aware, this is required for publication), please see the end of this email. If your institution or institutions have a press office, please notify them about your upcoming article at this point, to enable them to help maximise its impact. Inform journal staff as soon as possible if you are preparing a press release for your article and need a publication date.</p>
    <p>Thank you again for supporting open-access publishing; we are looking forward to publishing your work in PLOS Genetics!</p>
    <p>Yours sincerely,</p>
    <p>Lin Chen, Ph.D.</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>
      <ext-link xlink:href="http://www.plosgenetics.org" ext-link-type="uri">www.plosgenetics.org</ext-link>
    </p>
    <p>Twitter: @PLOSGenetics</p>
    <p>----------------------------------------------------</p>
    <p>Comments from the reviewers (if applicable):</p>
    <p>The reviewers are satisfied with the revision and I would recommend to accept the work.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my comments. No more comments.</p>
    <p>Reviewer #2: The authors have fully addressed my concerns by performing additional experiments and adding discussions. The manuscript has been greatly improved.</p>
    <p>One follow-up suggesting for optimal k selection is as follows. The training and test data split and RMSE calculation is reasonable and rigorous. In dimension reduction, people use the variance explained by the k latent variables to better understand the data structure. It would be nice to provide this index for INSIDER method and also compare with different k choices with shuffled data.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Data Deposition</bold>
    </p>
    <p>If you have submitted a Research Article or Front Matter that has associated data that are not suitable for deposition in a subject-specific public repository (such as GenBank or ArrayExpress), one way to make that data available is to deposit it in the <ext-link xlink:href="http://www.datadryad.org/" ext-link-type="uri">Dryad Digital Repository</ext-link>. As you may recall, we ask all authors to agree to make data available; this is one way to achieve that. A full list of recommended repositories can be found on our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability#loc-recommended-repositories" ext-link-type="uri">website</ext-link>.</p>
    <p>The following link will take you to the Dryad record for your article, so you won't have to re‐enter its bibliographic information, and can upload your files directly: </p>
    <p>
      <ext-link xlink:href="http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1" ext-link-type="uri">http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-23-01170R1</ext-link>
    </p>
    <p>More information about depositing data in Dryad is available at <ext-link xlink:href="http://www.datadryad.org/depositing" ext-link-type="uri">http://www.datadryad.org/depositing</ext-link>. If you experience any difficulties in submitting your data, please contact <email>help@datadryad.org</email> for support.</p>
    <p>Additionally, please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying display items are included with the submission, and you will need to provide this before we can formally accept your manuscript, if not already present.</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Press Queries</bold>
    </p>
    <p>If you or your institution will be preparing press materials for this manuscript, or if you need to know your paper's publication date for media purposes, please inform the journal staff as soon as possible so that your submission can be scheduled accordingly. Your manuscript will remain under a strict press embargo until the publication date and time. This means an early version of your manuscript will not be published ahead of your final version. PLOS Genetics may also choose to issue a press release for your article. If there's anything the journal should know or you'd like more information, please get in touch via <email>plosgenetics@plos.org</email>.</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pgen.1011189.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1011189.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Lin</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2024 Chen, Zhu</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Chen, Zhu</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1011189" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Mar 2024</named-content>
    </p>
    <p>PGENETICS-D-23-01170R1 </p>
    <p>INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis </p>
    <p>Dear Dr Lin, </p>
    <p>We are pleased to inform you that your manuscript entitled "INSIDER: Interpretable Sparse Matrix Decomposition for RNA Expression Data Analysis" has been formally accepted for publication in PLOS Genetics! Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out or your manuscript is a front-matter piece, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Genetics and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Genetics</p>
    <p>On behalf of:</p>
    <p>The PLOS Genetics Team</p>
    <p>Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom</p>
    <p><email>plosgenetics@plos.org</email> | +44 (0) 1223-442823</p>
    <p><ext-link xlink:href="http://plosgenetics.org" ext-link-type="uri">plosgenetics.org</ext-link> | Twitter: @PLOSGenetics</p>
  </body>
</sub-article>
