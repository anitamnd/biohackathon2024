<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4569514</article-id>
    <article-id pub-id-type="pmid">26368549</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0137436</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-29083</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SATRAP: SOLiD Assembler TRAnslation Program</article-title>
      <alt-title alt-title-type="running-head">SATRAP: SOLiD Assembler TRAnslation Program</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Campagna</surname>
          <given-names>Davide</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gasparini</surname>
          <given-names>Fabio</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Franchi</surname>
          <given-names>Nicola</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manni</surname>
          <given-names>Lucia</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Telatin</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vitulo</surname>
          <given-names>Nicola</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ballarin</surname>
          <given-names>Loriano</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valle</surname>
          <given-names>Giorgio</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>CRIBI Biotechnology Centre, Università di Padova, Padova, Italy</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Biology, Università di Padova, Padova, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Jordan</surname>
          <given-names>I. King</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Georgia Institute of Technology, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: DC. Performed the experiments: DC. Analyzed the data: DC AT NV GV. Contributed reagents/materials/analysis tools: DC AT NV GV. Wrote the paper: DC FG NF LM AT NV LB GV.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>davide@cribi.unipd.it</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>10</volume>
    <issue>9</issue>
    <elocation-id>e0137436</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2015 Campagna et al</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Campagna et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0137436.pdf"/>
    <abstract>
      <p>SOLiD DNA sequences are typically analyzed using a reference genome, while they are not recommended for <italic>de novo</italic> assembly of genomes or transcriptomes. This is mainly due to the difficulty in translating the SOLiD color-space data into normal base-space sequences. In fact, the nature of color-space is such that any misinterpreted color leads to a chain of further translation errors, producing totally wrong results. Here we describe SATRAP, a computer program designed to efficiently translate <italic>de novo</italic> assembled color-space sequences into a base-space format. The program was tested and validated using simulated and real transcriptomic data; its modularity allows an easy integration into more complex pipelines, such as Oases for RNA-seq <italic>de novo</italic> assembly. SATRAP is available at <ext-link ext-link-type="uri" xlink:href="http://satrap.cribi.unipd.it/">http://satrap.cribi.unipd.it</ext-link>, either as a multi-step pipeline incorporating several tools for RNA-seq assembly or as an individual module for use with the Oases package.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was funded by Università degli Studi di Padova, Progetto Strategico 2011 BIOINFOGEN (to GV) (<ext-link ext-link-type="uri" xlink:href="http://www.unipd.it/ricerca/finanziamenti/finanziamenti-ateneo/progetti-strategici-ateneo">http://www.unipd.it/ricerca/finanziamenti/finanziamenti-ateneo/progetti-strategici-ateneo</ext-link>); Consiglio Nazionale delle Ricerche, Progetto EPIGEN (to GV) (<ext-link ext-link-type="uri" xlink:href="http://www.epigen.it/">http://www.epigen.it/</ext-link>); and Fondazione Cassa di Risparmio di Padova e Rovigo, Progetti di eccellenza 2008 (to LB) (<ext-link ext-link-type="uri" xlink:href="http://www.fondazionecariparo.net/">http://www.fondazionecariparo.net/</ext-link>).</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="2"/>
      <page-count count="7"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Satrap source code and user manual can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/satrap01/">http://sourceforge.net/projects/satrap01/</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://satrap.cribi.unipd.it/">http://satrap.cribi.unipd.it/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Satrap source code and user manual can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/satrap01/">http://sourceforge.net/projects/satrap01/</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://satrap.cribi.unipd.it/">http://satrap.cribi.unipd.it/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>SOLiD DNA sequencers produce “color-space” reads, using 2-base encoding [<xref rid="pone.0137436.ref001" ref-type="bibr">1</xref>]. In essence, a sequence is represented as a series of transitions between adjacent bases. Since there are 16 combinations of 2 bases and there are only four available colors, each color represents four possible 2-base words, as shown in <xref rid="pone.0137436.t001" ref-type="table">Table 1</xref>
</p>
    <table-wrap id="pone.0137436.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0137436.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>2-base encoding table.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0137436.t001g" xlink:href="pone.0137436.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="1" colspan="1">Color</th>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">AA</td>
              <td align="center" rowspan="1" colspan="1">CC</td>
              <td align="center" rowspan="1" colspan="1">GG</td>
              <td align="center" rowspan="1" colspan="1">TT</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">AC</td>
              <td align="center" rowspan="1" colspan="1">CA</td>
              <td align="center" rowspan="1" colspan="1">GT</td>
              <td align="center" rowspan="1" colspan="1">TG</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">AG</td>
              <td align="center" rowspan="1" colspan="1">CT</td>
              <td align="center" rowspan="1" colspan="1">GA</td>
              <td align="center" rowspan="1" colspan="1">TC</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">3</td>
              <td align="center" rowspan="1" colspan="1">AT</td>
              <td align="center" rowspan="1" colspan="1">CG</td>
              <td align="center" rowspan="1" colspan="1">GC</td>
              <td align="center" rowspan="1" colspan="1">TA</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>Colors are defined by numerical values (0, 1, 2, 3). Each color represents four possible dinucleotides.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>For instance, the five base long sequence ACTAA is represented as 1230 because the encoding is AC = 1, CT = 2, TA = 3 and AA = 0, but it should be noticed that also the sequences CAGCC, GTCGG, TGATT would be represented by the same color sequence. However, the knowledge of the first base allows the selection of the right frame. Indeed, color space reads start from the last base of the adaptor, which is known, thus allowing the translation into bases. Therefore, in the given example, our read would be A1230 and the first color '1' will be translated into the first translated base (FTB) 'C' because AC corresponds to color 1. Potentially, reads could be entirely translated into bases, but any sequencing error would put the translation out of frame. Thus, while the first translated base is generally reliable, the risk of continuing with a completely wrong sequence increases progressively as we move away from the first position.</p>
    <p>For the above reason, most SOLiD users do not translate color-space to base-space. Instead, it is preferable to translate the reference genome into color-space (which can be done unambiguously) and map the 2-base encoded reads on the color-space genome. The lack of a robust tool for translating colors into bases has hampered the use of SOLiD for <italic>de novo</italic> assembly applications. Some success has been obtained with the assembly of small genomes [<xref rid="pone.0137436.ref002" ref-type="bibr">2</xref>], using high coverage. In the case of RNA-seq data, where many transcripts are present at low levels, color translation is unfeasible with the software currently available.</p>
    <p><italic>De novo</italic> assembly of transcriptomes is in any case a complex process. Several programs have been developed for normal base-space reads, including Trinity [<xref rid="pone.0137436.ref003" ref-type="bibr">3</xref>] and Oases [<xref rid="pone.0137436.ref004" ref-type="bibr">4</xref>], but only Oases can be used to process color-space reads. Oases is based on the general assembler Velvet that is able to process SOLiD reads by “double encoding” [<xref rid="pone.0137436.ref005" ref-type="bibr">5</xref>]. Double encoding (DE) involves direct replacement of the four color symbols with A, C, G and T. The resulting sequence is still a color-space sequence, but since it uses the same symbols of normal DNA sequences, it can be processed by standard software. The main adaptation of Velvet for SOLiD sequences is related to kmer-counting, as color-space has a different strand complementarity.</p>
    <p>Velvet and Oases do not implement color-space to base-space translation that until now could be done either with ASID (Applied Biosystems, unpublished) or SOPRA [<xref rid="pone.0137436.ref006" ref-type="bibr">6</xref>]. Both programs take advantage of the reliability of the base translated on the first color, giving satisfactory results only with high sequence coverage; therefore, they are not suitable for <italic>de novo</italic> transcriptome assembly. Here we present SATRAP, a color-space translation program designed to solve this problem. First SATRAP performs the analysis of color-space coherency, then it translates low covered transcripts with high accuracy, recognizing and correcting common types of assembly errors.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>SATRAP takes as input a double encoded assembly. The aforementioned Oases is ideal for transcriptome assembly, while Velvet or SSAKE [<xref rid="pone.0137436.ref007" ref-type="bibr">7</xref>] could be used for <italic>de novo</italic> genomic assembly. Then SATRAP takes full advantage of color-space to resolve conflicts due to incoherency in color assembly. Three main steps are implemented in the pipeline: 1) mapping FTBs onto the assembly; 2) analysis of color coherence; 3) error correction.</p>
    <sec id="sec003">
      <title>Mapping FTBs onto the assembly</title>
      <p>This process requires multiple steps because the first color of the read depends on the last base of the adaptor and may not align on the target. For this reason, mapping algorithms for SOLiD reads ignore the first color and align the reads starting from the second color. Therefore, in the resulting alignment, the first color is missing, thus complicating the recovery of the FTB. To allow the retrieval of FTBs, the reads are aligned on the assembled transcripts using a special option of PASS [<xref rid="pone.0137436.ref008" ref-type="bibr">8</xref>] that includes the FTB information in the read name of each alignment. Finally, Satrap uses this information to place the FTB just before the color alignment (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Step 1).</p>
      <fig id="pone.0137436.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137436.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Flowchart of the color-translation process.</title>
          <p>Step1: the first base (FTB) of each read can be translated from color-space with high accuracy; for each read the FTB is mapped on the contig. Step 2: check color coherence with neighboring FTBs; three conditions can be detected: a) FTBs coherent with their neighboring FTBs on both sides (such as the 'A' at the centre of the figure); FTB coherent only on one side (such as the 'G' that is coherent with the 'A', but not with the 'C'); FTBs with no coherence on both sides (such as the 'A' circled in red). The latter are removed from the assembly. Step 3 and 4: find regions delimited by two reliable start sites and translate color-space into base-space. Any remaining regions will be incoherent in terms of color compatibility. To resolve these regions the threshold for color reliability is calculated (Step 5) and the resulting value is used to establish the critical regions of the contig (Step 6).</p>
        </caption>
        <graphic xlink:href="pone.0137436.g001"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Analysis of color coherence</title>
      <p>We define as reliable regions those which are delimited by two adjacent FTBs joined by a coherent stretch of colors (double arrows in <xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>). If more FTBs map on the same position then the most frequent base will be considered. After a first scan (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Step 2) some FTBs may have unreliable regions on both sides (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, 'A' in the red circle). Such FTBs will be discarded and the new resulting regions will be reconsidered for color coherence (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Step 3). All the reliable regions are then translated from colors to bases (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Step 4). The remaining regions (shown as question marks in the figure) are not coherent with the sequence of colors, but are delimited by two reliable regions. For those cases an internal error correction is possible.</p>
    </sec>
    <sec id="sec005">
      <title>Error correction</title>
      <p>The error correction is completing the SATRAP pipeline (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Steps 5 and 6). The regions enclosed within FTBs that are not coherent with the color sequence are selected and analyzed in detail. In a position corresponding to an assembly error we expect a lower percentage of matched colors. For each position enclosed within FTBs, the number of colors that match with the reference is compared to a threshold (1) specifically calculated for each transcript.
<disp-formula id="pone.0137436.e001"><alternatives><graphic xlink:href="pone.0137436.e001.jpg" id="pone.0137436.e001g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M1"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mi>Z</mml:mi><mml:mo>⋅</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula>
In the above equation T is the threshold to discriminate unreliable colors, M is the mean of matched colors confirming the consensus of each position, σ is the standard deviation of M and Z is the set Z-score.</p>
      <p>Once the quality threshold is calculated (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, Step 5) it can be applied to discriminate unreliable colors (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, step 6). When only one color is below threshold the two related bases can be inferred from the adjacent colors and a full correction can be achieved (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, case 1). If more colors are found below threshold then the entire region enclosed between the unreliable colors will be translated into N's (<xref rid="pone.0137436.g001" ref-type="fig">Fig 1</xref>, case 2 and 3).</p>
    </sec>
  </sec>
  <sec id="sec006">
    <title>Results and Discussion</title>
    <p>The validation of the program was done both with simulated and real datasets. To assess how the sequence coverage affects the translation process we used dwgsim (<ext-link ext-link-type="uri" xlink:href="https://github.com/nh13/">https://github.com/nh13/</ext-link>) to generate simulated reads (<xref rid="pone.0137436.s001" ref-type="supplementary-material">S1 Text</xref>) that were assembled with Velvet (<xref rid="pone.0137436.s002" ref-type="supplementary-material">S2 Text</xref>) and then color-translated with SATRAP, ASID and SOPRA (<xref rid="pone.0137436.s003" ref-type="supplementary-material">S3 Text</xref>). To make it more critical, the reads were generated with a relatively high rate of sequencing errors (from 0.001 to 0.2 linearly applied to the base positions of each read) and mutations (0.03) that include 10% of insertions and deletions. To generate the simulated set of reads we took the transcriptome of <italic>Ciona intestinalis</italic>, composed by 15,852 transcripts. A base-space assembly was also processed as a positive control, using a set of reads corresponding to those in color-space. The fraction of translated assemblies that entirely mapped (<xref rid="pone.0137436.s004" ref-type="supplementary-material">S4 Text</xref>) onto the <italic>C</italic>. <italic>intestinalis</italic> reference transcripts are shown in <xref rid="pone.0137436.g002" ref-type="fig">Fig 2</xref>.</p>
    <fig id="pone.0137436.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0137436.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Effect of sequence coverage on color translation.</title>
        <p>ASID, SATRAP and SOPRA were used to translate the color-space assemblies produced at different sequence coverage into base-space. The same set of reads was also assembled in base-space as a control.</p>
      </caption>
      <graphic xlink:href="pone.0137436.g002"/>
    </fig>
    <p>SATRAP was also tested for its ability to recognize specific assembly errors. The simulation was performed using 1,000 random base-space sequences with a size range between 200 and 650 bases. The base-space sequences were used to produce a data set of simulated color-space reads that had a sequence coverage up to 100X. The 1,000 random base-space sequences were converted to color-space through reverse 2-base encoding and then a single error was inserted in the middle of each color sequence. One thousand errors were introduced: 334 substitutions, 344 deletions and 322 insertions (<xref rid="pone.0137436.s005" ref-type="supplementary-material">S5 Text</xref>). These parameters make this simulation particularly challenging for color translation because about 2/3 of errors are indels. After translation, the subsequent base-space sequences were globally aligned onto the original error-free base-space dataset using PASS (<xref rid="pone.0137436.s006" ref-type="supplementary-material">S6 Text</xref>). The results shown in <xref rid="pone.0137436.t002" ref-type="table">Table 2</xref> were obtained with Z = 3 and indicate that there is a very high efficiency of translation at all coverages.</p>
    <table-wrap id="pone.0137436.t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0137436.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Statistics of identified errors at different sequence coverage.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0137436.t002g" xlink:href="pone.0137436.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="1" colspan="1">Coverage</th>
              <th align="center" rowspan="1" colspan="1">Substitution</th>
              <th align="center" rowspan="1" colspan="1">Deletion</th>
              <th align="center" rowspan="1" colspan="1">Insertion</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">10X</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">0.988</td>
              <td align="center" rowspan="1" colspan="1">0.994</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">20X</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">0.988</td>
              <td align="center" rowspan="1" colspan="1">0.997</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">50X</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">100X</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">0.997</td>
              <td align="center" rowspan="1" colspan="1">0.997</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Finally, SATRAP was evaluated on a Human RNA-seq set of data publicly available (ERR200630). The reads were assembled using Oases and then translated using SATRAP (<xref rid="pone.0137436.s007" ref-type="supplementary-material">S7 Text</xref>). As expected, the number of FTBs with unreliable regions on both sides was extremely low (997 out of 9,657,411 FTBs), indicating very high accuracy in FTB translation. The majority of corrections were related to single color errors (85%) and at the end of the process SATRAP corrected 485,391 bases while 47,424 bases remained undefined (N's). As a result, 95.6% of translated contigs totally mapped on the reference Human genome. Furthermore, about 29.2% of non-mapping contigs mapped on the non-redundant sequence database using Blastx [<xref rid="pone.0137436.ref009" ref-type="bibr">9</xref>]. These results compare quite well with the Illumina RNA-seq run (SRR090440) where 95.4% of the reads mapped on the reference genome and 1.9% of the remaining sequences mapped on the nr database.</p>
  </sec>
  <sec sec-type="conclusions" id="sec007">
    <title>Conclusion</title>
    <p>The translation of the ERR200630 assembly required less than 1 Gb of RAM and one hour of elaboration time using a 64 bits Intel Xeon E5645 CPU working at 2.4 GHz. It is notable that the total time spent by Satrap is only a small fraction of that taken by the assembly process.</p>
    <p>All the computer programs are written in the C++ language and released into public domain under the GNU general public license.</p>
    <p>The results presented in this paper show that, with SATRAP, the final color assembly converted into bases is essentially equivalent to those obtained with base-space reads. We conclude that it is now possible to achieve <italic>de novo</italic> assembly of color-space reads as efficiently as using base-space.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec008">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0137436.s001">
      <label>S1 Text</label>
      <caption>
        <title>SOPRA, SATRAP and Asid comparison: simulated datasets.</title>
        <p>Information regarding the production of the simulated dataset (setting and criteria) for SOPRA, SATRAP and Asid comparison.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s002">
      <label>S2 Text</label>
      <caption>
        <title>SOPRA, SATRAP and Asid comparison: simulated assemblies.</title>
        <p>Setting information about the assembly of the simulated dataset reported in S1.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s003">
      <label>S3 Text</label>
      <caption>
        <title>SOPRA, SATRAP and Asid comparison: translation setting.</title>
        <p>Information about the setting of SOPRA, SATRAP and Asid programs for the translation of the simulated assemblies.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s004">
      <label>S4 Text</label>
      <caption>
        <title>SOPRA, SATRAP and Asid comparison: comparison of results.</title>
        <p>Mapping information of the translated assemblies reported in <xref rid="pone.0137436.g002" ref-type="fig">Fig 2</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s005">
      <label>S5 Text</label>
      <caption>
        <title>Evaluation of SATRAP to identify different assembly errors: dataset production.</title>
        <p>Information about programs and setting to produce the simulated dataset for the assembly error detection.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s006">
      <label>S6 Text</label>
      <caption>
        <title>Evaluation of SATRAP to identify different assembly errors: translation and global mapping.</title>
        <p>Information regarding both translation and mapping of simulated data that are described in S5. The mapping information is used to calculate the information reported in <xref rid="pone.0137436.t001" ref-type="table">Table 1</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0137436.s007">
      <label>S7 Text</label>
      <caption>
        <title>Evaluation of SOLiD and ILLUMINA RNA-seq assemblies.</title>
        <p>Comparison of real base-space and color-space translated assemblies in terms of total mappable contigs.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0137436.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0137436.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>McKernan</surname><given-names>KJ</given-names></name>, <name><surname>Peckham</surname><given-names>HE</given-names></name>, <name><surname>Costa</surname><given-names>GL</given-names></name>, <name><surname>McLaughlin</surname><given-names>SF</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Tsung</surname><given-names>EF</given-names></name>, <etal>et al</etal><article-title>Sequence and structural variation in a human genome uncovered by short-read, massively parallel ligation sequencing using two-base encoding</article-title>. <source>Genome Research</source>. <year>2009</year>;<volume>19</volume>: <fpage>1527</fpage>–<lpage>1541</lpage>. <pub-id pub-id-type="doi">10.1101/gr.091868.109</pub-id><?supplied-pmid 19546169?><pub-id pub-id-type="pmid">19546169</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Umemura</surname><given-names>M</given-names></name>, <name><surname>Koyama</surname><given-names>Y</given-names></name>, <name><surname>Takeda</surname><given-names>I</given-names></name>, <name><surname>Hagiwara</surname><given-names>H</given-names></name>, <name><surname>Ikegami</surname><given-names>T</given-names></name>, <name><surname>Koike</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Fine de novo sequencing of a fungal genome using only SOLiD short read data: verification on Aspergillus oryzae RIB40</article-title>. <source>PLOS ONE</source>. <year>2013</year>;<volume>8</volume>: <fpage>e63673</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0063673</pub-id><?supplied-pmid 23667655?><pub-id pub-id-type="pmid">23667655</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Grabherr</surname><given-names>MG</given-names></name>, <name><surname>Haas</surname><given-names>BJ</given-names></name>, <name><surname>Yassour</surname><given-names>M</given-names></name>, <name><surname>Levin</surname><given-names>JZ</given-names></name>, <name><surname>Thompson</surname><given-names>DA</given-names></name>, <name><surname>Amit</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Full-length transcriptome assembly from RNA-seq data without a reference genome</article-title>. <source>Nat Biotechnology</source>. <year>2011</year>;<volume>29</volume>: <fpage>644</fpage>–<lpage>652</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0137436.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Schulz</surname><given-names>MH</given-names></name>, <name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Vingron</surname><given-names>M</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>. <article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>1086</fpage>–<lpage>1092</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts094</pub-id><?supplied-pmid 22368243?><pub-id pub-id-type="pmid">22368243</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name>. <article-title>Using the Velvet de novo Assembler for Short‐Read Sequencing Technologies</article-title>. <source>Current Protocols in Bioinformatics</source>. <year>2010</year>;<volume>11</volume>: <fpage>5.1</fpage>–<lpage>5.12</lpage>.<pub-id pub-id-type="pmid">20836074</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Dayarian</surname><given-names>A</given-names></name>, <name><surname>Michael</surname><given-names>TP</given-names></name>, <name><surname>Sengupta</surname><given-names>AM</given-names></name>. <article-title>SOPRA: Scaffolding algorithm for paired reads via statistical optimization</article-title>. <source>BMC Bioinformatics</source><year>2010</year>;<volume>11</volume>: <fpage>345</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-345</pub-id><?supplied-pmid 20576136?><pub-id pub-id-type="pmid">20576136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Warren</surname><given-names>RL</given-names></name>, <name><surname>Sutton</surname><given-names>GG</given-names></name>, <name><surname>Jones</surname><given-names>SJM</given-names></name>, <name><surname>Holt</surname><given-names>RA</given-names></name>. <article-title>Assembling millions of short DNA sequences using SSAKE</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>: <fpage>500</fpage>–<lpage>501</lpage>.
<?supplied-pmid 17158514?><pub-id pub-id-type="pmid">17158514</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Campagna</surname><given-names>D</given-names></name>, <name><surname>Albiero</surname><given-names>A</given-names></name>, <name><surname>Bilardi</surname><given-names>A</given-names></name>, <name><surname>Caniato</surname><given-names>E</given-names></name>, <name><surname>Forcato</surname><given-names>C</given-names></name>, <name><surname>Manavski</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>PASS: a program to align short sequences</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>967</fpage>–<lpage>968</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp087</pub-id><?supplied-pmid 19218350?><pub-id pub-id-type="pmid">19218350</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137436.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>D.J</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol.</source><year>1990</year>;<volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>.
<?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
