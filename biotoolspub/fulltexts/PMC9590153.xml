<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9590153</article-id>
    <article-id pub-id-type="publisher-id">4989</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04989-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PolyHaplotyper: haplotyping in polyploids based on bi-allelic marker dosage data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4388-9244</contrib-id>
        <name>
          <surname>Voorrips</surname>
          <given-names>Roeland E.</given-names>
        </name>
        <address>
          <email>roeland.voorrips@wur.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tumino</surname>
          <given-names>Giorgio</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.4818.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0791 5666</institution-id><institution>Wageningen University and Research – Plant Breeding, </institution></institution-wrap>Wageningen, The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>442</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">For genetic analyses, multi-allelic markers have an advantage over bi-allelic markers like SNPs (single nucleotide polymorphisms) in that they carry more information about the genetic constitution of individuals. This is especially the case in polyploids, where individuals carry more than two alleles at each locus. Haploblocks are multi-allelic markers that can be derived by phasing sets of closely-linked SNP markers. Phased haploblocks, similarly to other multi-allelic markers, will therefore be advantageous in genetic tasks like linkage mapping, QTL mapping and genome-wide association studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present a new method to reconstruct haplotypes from SNP dosages derived from genotyping arrays, which is applicable to polyploids. This method is implemented in the software package PolyHaplotyper. In contrast to existing packages for polyploids it makes use of full-sib families among the samples to guide the haplotyping process. We show that in this situation it is much more accurate than other available software, using experimental hexaploid data and simulated tetraploid data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Our method and the software package PolyHaplotyper in which it is implemented extend the available tools for haplotyping in polyploids. They perform especially well in situations where one or more full-sib families are present.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04989-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Haplotype</kwd>
      <kwd>SNP array</kwd>
      <kwd>Multi-allelic marker</kwd>
      <kwd>Polyploid</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Ministry of Agriculture, Nature and Food Quality of the Netherlands</institution>
        </funding-source>
        <award-id>BO-50-002-022</award-id>
        <award-id>LWV20.112</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Over the last two decades, tools for genetic analysis of polyploid species (species with more than the usual two complements of chromosomes) have been developed, including tools for linkage mapping, allele dosage scoring, haplotyping and QTL mapping (reviewed by [<xref ref-type="bibr" rid="CR1">1</xref>]). Among those tools, some address the problem of identifying short-range haplotypes in populations and identifying the haplotype compositions of individuals in populations, together known as haplotyping. If we consider a set of tightly linked bi-allelic markers (e.g. single-nucleotide polymorphisms, SNPs with only two alleles in the population studied) as one genetic locus, then the haplotypes covering these markers can be interpreted as the alleles of that locus. Such a locus, which we will call a haploblock, can then be considered a multi-allelic marker locus, because generally more than two haplotypes may occur (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Haploblocks and haplotyping.pdf). Recombination within such a haploblock should be very rare over the population studied. This can be achieved by selecting SNP markers known to be located on the same contig or very closely spaced according to a physical or genetic linkage map; the more diverse the population, the closer the SNPs in haploblocks should be spaced. Due to varying SNP density the number of SNPs available to create haploblocks can vary. In diploids, but even more so in polyploids, multi-allelic markers are more informative than bi-allelic markers. Especially for quantitative trait locus (QTL) detection through linkage mapping or genome-wide associating studies (GWAS) and for subsequent selection of specific QTL genotypes, one-to-one associations between marker alleles and QTL alleles are very informative, and these associations are far more likely with multi-allelic markers such as haploblocks than with bi-allelic markers such as SNPs. Even without such one-to-one associations multi-allelic markers will provide increased power of detection over the underlying single SNPs. Associations between multi-allelic markers and QTL alleles are also more likely to be valid in wider germplasm than that in which the association was established. Also linkage mapping might benefit from the additional information provided by haploblocks compared to single SNPs. Other types of multi-allelic markers have been used for these purposes, especially Short-Sequence Repeats (SSRs or microsatellites; [<xref ref-type="bibr" rid="CR2">2</xref>]), but their application is limited by the low throughput of SSR assays and the limited number of SSRs available compared to SNPs.</p>
    <p id="Par11">Several short-range SNP phasing methods have been proposed for polyploids and implemented in software. Most of these are based on sequence reads, including HapCompass [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], HAPLOSWEEP [<xref ref-type="bibr" rid="CR5">5</xref>], Tripoly [<xref ref-type="bibr" rid="CR6">6</xref>] and PopPoly [<xref ref-type="bibr" rid="CR7">7</xref>], and Poly-Harch [<xref ref-type="bibr" rid="CR8">8</xref>]. Here in contrast we focus on haplotyping based on SNP allele dosages derived from SNP arrays. Such methods have been published for diploids, e.g. HaploView [<xref ref-type="bibr" rid="CR9">9</xref>], Beagle [<xref ref-type="bibr" rid="CR10">10</xref>], AlphaImpute [<xref ref-type="bibr" rid="CR11">11</xref>] and PedrPoly [<xref ref-type="bibr" rid="CR12">12</xref>]. In polyploids the problem is considerably more complex. Some methods have been implemented in software packages including SATlotyper [<xref ref-type="bibr" rid="CR13">13</xref>], polyHap [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>] SHEsisPlus [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] and Happy-inf [<xref ref-type="bibr" rid="CR19">19</xref>]. These packages however do not use known pedigree relations among the individuals and therefore often return sub-optimal results. Our work aims to fill this gap with a method that uses any full-sib (FS) families present in the data to guide the imputation of haplotypes.</p>
    <p id="Par12">SNP allele dosages obtained from arrays are quite accurate, but they are not error-free and may include missing data; therefore an approach based on dosages must be able to deal with these problems.</p>
    <p id="Par13">Here we describe a method, implemented in R package PolyHaplotyper, and evaluate its results with simulated and real data from data sets with different pedigree structures. The examples were chosen to represent the situations for which PolyHaplotyper was designed, i.e. polyploid populations that include full-sib families. We also compare its performance to that of other software for performing haplotyping from unphased SNP dosage data.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Data set 1: hexaploid Chrysanthemum population</title>
      <p id="Par14">Since the true haplotype compositions in this Chrysanthemum population were not known, we focused on the number of haplotyped individuals and the frequency of non-matching parent and offspring genotypes to evaluate the results of PolyHaplotyper.</p>
      <p id="Par15">In Table <xref rid="Tab1" ref-type="table">1</xref> we present the results separately for the 26 haploblocks with 4 SNP markers and the 17 haploblocks with 5 SNP markers, and for the 3 categories of individuals treated differently by PolyHaplotyper (FS individuals, FS parents and other individuals).<table-wrap id="Tab1"><label>Table 1</label><caption><p>PolyHaplotyper results with Data set 1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">SNP markers per haploblock</th></tr><tr><th align="left">4</th><th align="left">5</th><th align="left">All</th></tr></thead><tbody><tr><td align="left">Nr of haploblocks</td><td align="left">26</td><td align="left">17</td><td align="left">43</td></tr><tr><td align="left">Mean nr of haplotypes</td><td align="left">5.6</td><td align="left">5.9</td><td align="left">5.7</td></tr><tr><td align="left" colspan="4">Fullsib individuals (571)</td></tr><tr><td align="left"> Mean % fully genotyped</td><td align="left">77.2</td><td align="left">74.1</td><td align="left">76.0</td></tr><tr><td align="left"> Mean % haplotyped</td><td align="left">75.9</td><td align="left">80.0</td><td align="left">77.6</td></tr><tr><td align="left" colspan="4">Fullsib parents (7)</td></tr><tr><td align="left"> Mean % fully genotyped</td><td align="left">93.4</td><td align="left">91.6</td><td align="left">92.7</td></tr><tr><td align="left"> Mean % haplotyped</td><td align="left">79.7</td><td align="left">84.9</td><td align="left">81.7</td></tr><tr><td align="left" colspan="4">Other individuals (53)</td></tr><tr><td align="left"> Mean % fully genotyped</td><td align="left">58.1</td><td align="left">58.4</td><td align="left">58.2</td></tr><tr><td align="left"> Mean % haplotyped</td><td align="left">41.0</td><td align="left">52.1</td><td align="left">45.4</td></tr><tr><td align="left" colspan="4">All individuals (631)</td></tr><tr><td align="left"> Mean % fully genotyped</td><td align="left">75.8</td><td align="left">72.9</td><td align="left">74.7</td></tr><tr><td align="left"> Mean % haplotyped</td><td align="left">73.0</td><td align="left">77.7</td><td align="left">74.9</td></tr><tr><td align="left"> Mean % checkable</td><td align="left">69.0</td><td align="left">73.1</td><td align="left">70.6</td></tr><tr><td align="left"> Mean % matching parent(s) (of all checkable)</td><td align="left">99.9</td><td align="left">100.0</td><td align="left">99.9</td></tr><tr><td align="left"> Total nr matching parent(s)</td><td align="left">11,306</td><td align="left">7845</td><td align="left">19,151</td></tr><tr><td align="left"> Total nr conflicting with parents</td><td align="left">9</td><td align="left">1</td><td align="left">10</td></tr><tr><td align="left"> Total nr non-checkable</td><td align="left">5091</td><td align="left">2881</td><td align="left">7972</td></tr></tbody></table></table-wrap></p>
      <p id="Par16">The percentage of fully genotyped individuals (individuals with no missing SNP dosages in the haploblock) was larger with 4 than with 5 SNPs per haploblock, as expected. In contrast, the percentage of haplotyped individuals was larger in the haploblocks with 5 SNP markers, probably because there were less cases where two solutions were equally likely, and therefore also the number of individuals whose inferred haplotype could be checked against that of their parent(s) was larger. Almost no parent–offspring conflicts were present.</p>
      <p id="Par17">Some individuals were not haplotyped even if they had no missing SNP dosages, because multiple haplotype combinations were allowed by the SNP data and the other constraints (Mendelian inheritance, parsimonious haplotype sets). Among FS individuals also the reverse occurred: individuals were haplotyped while some SNP dosages were missing. In these cases the non-missing SNP genotypes allowed only one haplotype combination that was compatible with the inferred parental genotypes.</p>
      <p id="Par18">The number of haplotypes estimated to be present was slightly higher in haploblocks of 5 than of 4 markers, but not as much as might be expected from the theoretically possible numbers of haplotypes (16 for 4 markers, 32 for 5 markers).</p>
      <p id="Par19">The highest percentage of fully genotyped individuals was found among the parents. This is due to the fact that the parents were genotyped in multiple replicates, while all other individuals were genotyped only once; by merging the SNP dosage data of the replicates a consensus genotype with less missing data was obtained. The FS individuals were more often fully genotyped than the other (non-parent, non-FS) individuals, probably because the SNP array was developed using sequencing data from 5 of the 7 FS parents and some other genotypes [<xref ref-type="bibr" rid="CR20">20</xref>]. The percentage of haplotyped individuals was highest among the FS parents, lower among the FS individuals and lowest among the other material. In all cases, the haplotyping results agreed with the observed marker dosages.</p>
      <p id="Par20">In order to assess the importance of using the information about the FS family structure we also haplotyped the individuals as if they were unrelated, but used the pedigree information to check for parent–offspring conflicts. Over all 43 haploblocks, without FS information 46.7% of the individuals were haplotyped, versus 74.9% with FS information, and 40.8% (versus 70.6%) could be checked. Of the checkable individuals 99.1% (versus 99.9%) matched with their parents.</p>
      <p id="Par21">We analyzed the same data set with two other haplotyping packages: SATlotyper [<xref ref-type="bibr" rid="CR13">13</xref>] and Happy-inf [<xref ref-type="bibr" rid="CR19">19</xref>] (Table <xref rid="Tab2" ref-type="table">2</xref>). The results of Happy-inf vary somewhat between runs with the same input data, but not much; in Table <xref rid="Tab2" ref-type="table">2</xref> we show the results of a typical run. The results of SATlotyper, like these of PolyHaplotyper, do not vary. Because these packages do not use FS families or other substructure in the population, we present the results for all individuals together.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Haplotyping results of SATlotyper and Happy-inf with Data set 1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">SATlotyper</th><th align="left" colspan="3">Happy-inf</th></tr><tr><th align="left">SNP markers per haploblock</th><th align="left">4</th><th align="left">5</th><th align="left">All</th><th align="left">4</th><th align="left">5</th><th align="left">All</th></tr></thead><tbody><tr><td align="left">Nr of haploblock</td><td align="left">26</td><td align="left">17</td><td align="left">43</td><td align="left">26</td><td align="left">17</td><td align="left">43</td></tr><tr><td align="left">Mean nr of haplotypes</td><td align="left">5.4</td><td align="left">6.4</td><td align="left">5.8</td><td align="left">8.0</td><td align="left">9.9</td><td align="left">8.7</td></tr><tr><td align="left">Nr of individuals</td><td align="left">631</td><td align="left">631</td><td align="left">631</td><td align="left">631</td><td align="left">631</td><td align="left">631</td></tr><tr><td align="left">mean % fully genotyped</td><td align="left">75.8</td><td align="left">72.9</td><td align="left">74.7</td><td align="left">75.8</td><td align="left">72.9</td><td align="left">74.7</td></tr><tr><td align="left">mean % haplotyped</td><td align="left">100.0</td><td align="left">100.0</td><td align="left">100.0</td><td align="left">75.8</td><td align="left">72.9</td><td align="left">74.7</td></tr><tr><td align="left">Mean % checkable</td><td align="left">93.7</td><td align="left">93.7</td><td align="left">93.7</td><td align="left">71.3</td><td align="left">68.6</td><td align="left">70.2</td></tr><tr><td align="left">Mean % matching parent(s) (of all checkable)</td><td align="left">81.5</td><td align="left">81.9</td><td align="left">81.7</td><td align="left">91.6</td><td align="left">91.9</td><td align="left">91.7</td></tr><tr><td align="left">Total nr matching parent(s)</td><td align="left">12,525</td><td align="left">8231</td><td align="left">20,756</td><td align="left">10,712</td><td align="left">6734</td><td align="left">17,446</td></tr><tr><td align="left">Total nr conflicting with parents</td><td align="left">2841</td><td align="left">1816</td><td align="left">4657</td><td align="left">984</td><td align="left">628</td><td align="left">1612</td></tr><tr><td align="left">Total nr non-checkable</td><td align="left">1040</td><td align="left">680</td><td align="left">1720</td><td align="left">4710</td><td align="left">3365</td><td align="left">8075</td></tr></tbody></table></table-wrap></p>
      <p id="Par22">In contrast to PolyHaplotyper, SATlotyper haplotypes all individuals and Happy-inf haplotypes all fully genotyped individuals. However, in both cases the percentage matching their parents (81.7% and 91.7%) is much lower than that obtained by PolyHaplotyper (99.9%). In absolute terms the numbers of individuals matching their parents are not very different (19,151, 20,756 and 17,446 for PolyHaplotyper, SATlotyper and Happy-inf, respectively) but the number of individuals conflicting with their parents is much lower for PolyHaplotyper (10) than for SATlotyper (4657) and Happy-inf (1612). The computation time was 22 min for SATlotyper and 59 min for Happy-inf, versus 2 min for PolyHaplotyper (and 2.3 s for PolyHaplotyper without specified FS families).</p>
      <p id="Par23">The total number of haplotyped individuals matching their parents is higher for SATlotyper (20,756) and lower for Happy-inf (17,446), compared to that for PolyHaplotyper (19,151). The total number of conflicting haplotyping results is much higher for both packages (4657 and 1612) than for PolyHaplotyper (10).</p>
      <p id="Par24">Like for PolyHaplotyper, the haplotyping results of both these packages matched with the observed marker dosages, although in one haploblock 3 individuals without any marker dosages were also haplotyped by SATlotyper, with different haplotype combinations.</p>
      <p id="Par25">We also compared the PolyHaplotyper results with those of ShesisPlus [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], which is accessible through a web interface [<xref ref-type="bibr" rid="CR21">21</xref>]. Using this web interface is cumbersome, as it requires to enter the parameters and data, and to download the results, for each haploblock separately. Like Happy-inf, ShesisPlus is not deterministic: with the same input it generates different outputs. For that reason, we limited our use of ShesisPlus to two haploblocks with 4, and two haploblocks with 5 SNP markers, submitted each haploblock 3 times, and compared the results with those of PolyHaplotyper (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1) as these appeared to be quite reliable, based on the high level of parent–offspring matching (100%, 100%, 99.8% and 100% for haploblocks ctg001, ctg002, ctg003 and ctg004, respectively). ShesisPlus does not produce haplotyping results for individuals but only aggregated data over the entire population. The results of ShesisPlus are quite variable between runs; some haplotypes are inferred in some runs but not in others. Overall, there is a rough agreement between the results of the ShesisPlus runs and the PolyHaplotyper results.</p>
    </sec>
    <sec id="Sec4">
      <title>Data set 2: simulated tetraploid population with 9 full-sib families</title>
      <p id="Par26">The simulated tetraploid population was composed of 9 FS families of 50 individuals. All FS families had one parent in common, so there were 10 parents and 450 FS individuals. As the correct genotypes were known from the simulation, the inferred haplotype genotypes of the individuals could be directly checked. We used PolyHaplotyper, SATlotyper and Happy-inf to analyze haploblocks of different sizes (3, 4, 5, 6 and 7 SNP markers). For each size 12 haploblocks were used. The results of all haploblocks are summarized in Table <xref rid="Tab3" ref-type="table">3</xref>. In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 we show the results separately for haploblocks of different sizes.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Haplotyping results of PolyHaplotyper, SATlotyper and Happy-inf with Data set 2</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">PolyHaplotyper</th><th align="left">SATlotyper</th><th align="left">Happy-inf</th></tr></thead><tbody><tr><td align="left">Nr of haploblocks</td><td align="left">60</td><td align="left">60</td><td align="left">60</td></tr><tr><td align="left">Mean nr of haplotypes inferred</td><td align="left">13.7</td><td align="left">12.9</td><td align="left">31.8</td></tr><tr><td align="left">Mean true nr of haplotypes</td><td align="left">13.9</td><td align="left">13.9</td><td align="left">13.9</td></tr><tr><td align="left">Mean % haplotyped</td><td align="left">89.6</td><td align="left">100.0</td><td align="left">100.0</td></tr><tr><td align="left">Mean % correct (of all haplotyped)</td><td align="left">98.7</td><td align="left">42.4</td><td align="left">33.4</td></tr><tr><td align="left">Total nr correct</td><td align="left">24,402</td><td align="left">11,700</td><td align="left">9220</td></tr><tr><td align="left">Total nr incorrect</td><td align="left">316</td><td align="left">15,900</td><td align="left">18,380</td></tr><tr><td align="left">Total nr not haplotyped</td><td align="left">2882</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">Run time (s)</td><td align="left">5898</td><td align="left">7024</td><td align="left">1166</td></tr></tbody></table></table-wrap></p>
      <p id="Par27">As in the Chrysanthemum data set, SATlotyper and Happy-inf haplotyped all fully genotyped individuals. In the simulated data set, with no missing marker data and no dosage errors, PolyHaplotyper haplotyped 89.6% of the individuals, which is more than the 74.9% haplotyped in the experimental data set. Another parallel between the two data sets is that the percentage individuals haplotyped correctly by PolyHaplotyper is very high (99.9% non-conflicting with parents in the Chrysanthemum data set, 98.7% correct in the simulated data), while these percentages were much lower with SATlotyper (81.7% and 42.4%) and with Happy-inf (86.2% and 33.4%, respectively). While for PolyHaplotyper the percentage of correct haplotypes was very high for all the haploblock sizes, an opposite trend was observed for SATlotyper (performing better in long haploblocks) and Happy-inf (performing better in short haploblocks) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). For PolyHaplotyper there appears to be an upward trend in the percentage haplotyped and the percentage correctly haplotyped individuals, from haploblocks of 3 up to 6 SNP markers, but the results with 7 markers are worse. In the haploblocks with 7 markers 27 of the 12*9 = 108 FS families were treated as unrelated material because there were more than 150,000 possible parental haplotype combinations (150,000 being the default threshold), while this was the case for none of the FS families in haploblocks of 3, 4, and 5 markers and for only 2 FS families in haploblocks of 6 markers (results not shown).</p>
      <p id="Par28">Also for Dataset 2 we checked the effect of ignoring the FS families in PolyHaplotyper. Over the 60 haploblocks, without FS information only 37.3% of the individuals were haplotyped, versus 89.6% with FS information, and only 38.0% (versus 98.7%) of these were haplotyped correctly.</p>
    </sec>
    <sec id="Sec5">
      <title>Data set 3: simulated tetraploid population with 2 full-sib families and other material</title>
      <p id="Par29">The simulated tetraploid population was composed of 2 FS families of 50 individuals, sharing one parent, and 100 other individuals from the same random mating populations as the FS parents; in all there were 3 parents, 100 FS individuals and 100 other individuals. As in Dataset 2 the correct genotypes were known from the simulation, so the inferred haplotype genotypes of the individuals could be directly checked. We used PolyHaplotyper, SATlotyper and Happy-inf to analyze haploblocks of different sizes (3, 4, 5, 6 and 7 SNP markers). For each size 12 haploblocks were used. The results of all haploblocks are summarized in Table <xref rid="Tab4" ref-type="table">4</xref>. In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 we show the results separately for haploblocks of different sizes and in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4 for the different categories of material (FS individuals, FS parents, other material).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Haplotyping results of PolyHaplotyper, SATlotyper and Happy-inf with Data set 3</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">PolyHaplotyper</th><th align="left">SATlotyper</th><th align="left">Happy-inf</th></tr></thead><tbody><tr><td align="left">Nr of haploblocks</td><td align="left">60</td><td align="left">60</td><td align="left">60</td></tr><tr><td align="left">Mean nr of haplotypes inferred</td><td align="left">16.0</td><td align="left">13.9</td><td align="left">33.3</td></tr><tr><td align="left">Mean true nr of haplotypes</td><td align="left">16.2</td><td align="left">16.2</td><td align="left">16.2</td></tr><tr><td align="left">Mean % haplotyped</td><td align="left">76.4</td><td align="left">100.0</td><td align="left">100.0</td></tr><tr><td align="left">Mean % correct (of all haplotyped)</td><td align="left">87.3</td><td align="left">51.5</td><td align="left">32.0</td></tr><tr><td align="left">Total nr correct</td><td align="left">8127</td><td align="left">6272</td><td align="left">3893</td></tr><tr><td align="left">Total nr incorrect</td><td align="left">1181</td><td align="left">5908</td><td align="left">8287</td></tr><tr><td align="left">Total nr not haplotyped</td><td align="left">2872</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">Run time (s)</td><td align="left">1662</td><td align="left">2095</td><td align="left">527</td></tr></tbody></table></table-wrap></p>
      <p id="Par30">Again SATlotyper and Happy-inf haplotyped all individuals, while PolyHaplotyper haplotyped less individuals than in Data set 2 (76.4% vs. 89.6%). The percentage individuals haplotyped correctly by PolyHaplotyper (87.3%) is again much higher that with SATlotyper (51.5%) and Happy-inf (32.0%), but lower than in Data set 2 (98.7%). The results of PolyHaplotyper were very good for the FS individuals and FS parents, but less good for the other (non-FS) material: only 59% of this was haplotyped on average, with 71.1% haplotyped correctly (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4). The PolyHaplotyper results were somewhat worse for haplotypes of 7 markers than for the smaller haploblocks. Among the haploblocks with 7 markers 9 of the 12*2 = 24 FS families were treated as unrelated material because there were more than 150,000 possible parental haplotype combinations, while this was not the case in any of the smaller haploblocks (results not shown). Apart from this effect in haploblocks of 7 markers, the percentage of individuals correctly haplotyped by PolyHaplotyper and SATlotyper was not clearly affected by block size, but Happy-inf performed much better in small than in larger haploblocks (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).</p>
      <p id="Par31">Without using FS information only 44.4% of the individuals were haplotyped, versus 76.4% with FS information, and only 56.8% (versus 87.3%) of these were haplotyped correctly.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par32">In this paper we consider short-range haplotyping. This is different from long-range or full chromosome haplotyping, where the aim is to characterize the different homologues in specific individuals. Such full-length haplotyping or phasing is often the result or by-product of linkage mapping, whereas our short-range haplotyping aims to generate multi-allelic data that can be used in downstream genetic analyses including linkage mapping. Some examples of software that can perform long-range haplotyping in polyploids are TetraploidSNPmap [<xref ref-type="bibr" rid="CR22">22</xref>], TetraOrigin [<xref ref-type="bibr" rid="CR23">23</xref>] and polymapR [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
    <p id="Par33">We describe a new approach for short-range haplotyping in polyploids, based on dosage data of bi-allelic markers, such as obtained from SNP genotyping arrays. In principle, SNP dosages could be obtained from sequence data as well, although current sequencing technologies result in less accurate dosage estimation compared to SNP arrays. This approach is implemented in the R package PolyHaplotyper. Although several methods and software packages have been published that are able to do this, our method is the first and so far the only that makes use of the presence of full-sib families (possibly linked through common parents). The use of this extra information results in a far lower rate of incorrectly haplotyped individuals, compared with two other packages (SATlotyper [<xref ref-type="bibr" rid="CR13">13</xref>] and Happy-inf [<xref ref-type="bibr" rid="CR19">19</xref>]) that do not use this information, and also compared to the results of PolyHaplotyper when the full-sib families are not specified. The low error rates make the haplotyping results of our method suitable for genetic analyses such as QTL analyses and linkage mapping, provided that the populations include one or more full-sib populations.</p>
    <p id="Par34">PolyHaplotyper is restricted to relatively small haploblocks: in practice the maxima are 8 markers in tetraploids and 6 markers in hexaploids. This theoretically allows to distinguish many different haplotypes, precisely 256 for 8 markers and 64 for 6 markers. However, depending on the variability in the population it may not always be possible to uniquely tag all different alleles of a gene. Other software, like Happy-inf which can deal with much larger haploblocks, is more suitable for that.</p>
    <p id="Par35">A possible future extension of PolyHaplotyper may involve a “smart” selection of bi-allelic markers to combine in a haploblock for the most informative result. A simple example is to avoid multiple markers that have the same dosages over the whole population, but more elaborate strategies are conceivable.</p>
    <p id="Par36">For PolyHaplotyper a slight upward trend appears in the percentage haplotyped and the percentage correctly haplotyped individuals with increasing numbers of markers per haploblock (Table <xref rid="Tab1" ref-type="table">1</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2A, although not in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3A), but with 7 markers per haploblock the results become worse (although still better than those of SATlotyper and Happy-inf). Most likely this is due to the fact that with 7 markers per haploblock, many FS families were analyzed as unrelated material because the number of parental haplotype combinations exceeded the default threshold of 150,000. This could be improved by raising the threshold, but at a cost in computation time.</p>
    <p id="Par37">Another difference between PolyHaplotyper and the other packages to which we compared it, is the number of non-haplotyped individuals. SATlotyper haplotypes all individuals, including those where some or even all marker dosages are missing; Happy-inf haplotypes all fully genotyped individuals. In contrast, PolyHaplotyper only haplotypes the individuals where one haplotype combination is much more likely to be correct than all others. This may introduce a bias: for a given haploblock it may happen that some individuals are haplotyped and other are not, depending on their SNP dosage combination.</p>
    <p id="Par38">Further, individuals with some missing marker dosages are haplotyped by PolyHaplotyper if they are members of a full-sib family and there is only one possible haplotype combination, given the haplotyped parents, that matches the non-missing marker dosages.</p>
    <p id="Par39">This design choice explains part of the difference in the fraction of incorrectly genotyped individuals between PolyHaplotyper and the other packages. If individuals are haplotyped where multiple solutions are more or less equally likely, this results in less missing data but more incorrectly haplotyped individuals.</p>
    <p id="Par40">The enormous number of possible haplotyping solutions means that not all possibilities can be checked. In contrast to other methods, PolyHaplotyper approaches this problem as a puzzle with decisions at several stages involving different thresholds, aiming to prioritize the more likely solutions, rather than as a mathematical optimization in some high-dimensional landscape.</p>
    <p id="Par41">For efficient operation, PolyHaplotyper needs pre-calculated lists that contain all possible haplotype combinations, given the ploidy and the marker dosages. These tables take some time to compute, but once they are available they can be re-used for all analyses. For that reason, the time needed to compute these lists is not included in the run times mentioned earlier.</p>
  </sec>
  <sec id="Sec7">
    <title>Conclusion</title>
    <p id="Par42">PolyHaplotyper is an addition to the suite of polyploid haplotyping software. Like other software it has its own niche in which it performs well. For PolyHaplotyper, this niche involves the analysis of SNP array data to produce multi-allelic markers for use in downstream genetic analysis, in populations that include one or more full-sib families.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>PolyHaplotyper algorithm</title>
      <sec id="Sec10">
        <title>Population structure</title>
        <p id="Par43">In principle, populations with any genetic structure can be haplotyped by our method. However, the algorithm takes advantage of the presence of full-sib (FS) families and their parents, where groups of FS families sharing common parents are jointly taken into account. FS families include any progenies of crosses between two parental plants and as such include F<sub>2</sub> progenies derived from the selfing of one F<sub>1</sub> plant, backcross progenies derived from the cross of one F<sub>1</sub> plant and one recurrent parent plant, etc. All individuals not belonging to one of the specified FS families or their parents are considered to be unrelated. All individuals must be of the same, even ploidy level.</p>
      </sec>
      <sec id="Sec11">
        <title>Input data</title>
        <p id="Par44">The input includes the population structure, the haploblock compositions and the biallelic marker dosage data. The population structure indicates parents and progeny belonging to each FS family. The same individual may be the parent of more than one FS family. All other individuals occurring in the marker data are haplotyped as if they were unrelated, even if a pedigree is available. The haploblock composition describes which biallelic markers belong to each haploblock. The marker data consist of a matrix that for each biallelic marker gives the dosages of one of its alleles for all individuals; missing data are allowed.</p>
        <p id="Par45">We use the symbols <italic>nmrk</italic> for the number of bi-allelic markers (SNPs) in the haploblock and <italic>nhap</italic> for the total number of possible haplotypes, where <italic>nhap</italic> = 2<sup><italic>nmrk</italic></sup>. A (phasing) “solution” for an individual is a combination of haplotypes that fits (results in) the observed SNP marker dosages. Finally <italic>Gmrk</italic> is the genotype of an individual expressed as the allele dosages of all markers in the haploblock (where the dosage of each marker is in 0—ploidy), and <italic>Ghap</italic> is the genotype of an individual expressed as the dosages of all haplotypes (these dosages sum to ploidy). <italic>Gmrk</italic> are the observed SNP marker dosages and are the input of the haplotyping process; <italic>Ghap</italic> are the inferred haplotype combinations, the result of the haplotyping.</p>
        <p id="Par46">The main function, inferHaplotypes, is essentially a wrapper that performs the haplotyping for each haploblock separately; linkage between haploblocks is not taken into account. In short, the algorithm applied to each haploblock (in function hapOneBlock) consists of three stages:<list list-type="bullet"><list-item><p id="Par47">Stage 1: an inventory is made of haplotypes that are very likely present in the population, based on necessity (e.g. homozygous individuals) and a parsimony criterion</p></list-item><list-item><p id="Par48">Stage 2: full-sib families and their parents are haplotyped based on observed segregation ratios; any new inferred haplotypes are added to the inventory of haplotypes; FS families that cannot be haplotyped as such are re-defined as unrelated material</p></list-item><list-item><p id="Par49">Stage 3: the unrelated material (including any FS families added in stage 2) are haplotyped based on the inventory of known haplotypes and a parsimony criterion</p></list-item></list></p>
        <p id="Par50">These stages are elaborated below.</p>
      </sec>
      <sec id="Sec12">
        <title>Stage 1: inventory of likely haplotypes</title>
        <p id="Par51">In this initial step, implemented in function inferHaps_noFS, we attempt to find a minimal set of haplotypes that together explain a large subset of the observed bi-allelic marker dosages. We apply an algorithm inspired by that of [<xref ref-type="bibr" rid="CR25">25</xref>], developed for diploid populations, which aims to identify a parsimonious set of haplotypes. When there is a priori information available about haplotypes that are likely to be present in the population, this information is used.</p>
        <p id="Par52">This stage results in both a set of haplotypes known with some certainty to be present, and <italic>Ghap</italic> for many of the individuals. However, the purpose of this stage is only to obtain a set of haplotypes as input for the analysis of FS families (Stage 2) and the <italic>Ghap</italic> are ignored. If no FS families are present Stage 1 and 2 are skipped.<list list-type="alpha-lower"><list-item><p id="Par53">Initially we identify haplotypes that are certain to be present in some minimum number of individuals. Individuals where all markers in the haploblock have a dosage equal to 0 or ploidy must be homozygous for a haplotype. Similarly, if only one of the markers has a dosage different from 0 or ploidy, two haplotypes are certain to be present. This can be generalized: if all combinations of haplotypes that explain the marker dosages of an individual contain a certain haplotype, that haplotype is known to be present. The use of a minimum threshold for the number of individuals (by default: 10%) reduces the chances to infer the presence of a haplotype due to dosage scoring errors.</p><p id="Par54">This step results in a number of confirmed haplotypes, that are added to a priori known haplotypes (if provided).</p></list-item><list-item><p id="Par55">Next, for each individual that cannot be completely explained by the already known haplotypes, we find the solutions that involve the least number of additional haplotypes, and we determine which haplotypes are required in all of these solutions. Haplotypes that are required in some minimum number of individuals (also by default 10%), together with haplotypes defined in step a, become the new set of known haplotypes.</p></list-item></list></p>
        <p id="Par56">We repeat step b until the set of known haplotypes does not change anymore. It may happen that the repetitions of this step do not converge to a single set of known haplotypes but cycle through a few different sets. In that case we use the results of the first execution of this step, which are based on the haplotypes identified with (almost) complete certainty in step a.</p>
      </sec>
      <sec id="Sec13">
        <title>Stage 2: haplotyping of full-sib families</title>
        <p id="Par57">If FS families are specified, perhaps along with unrelated material, we first group the FS families into groups where the families are linked through shared parents. For each group we find an optimal solution, using the procedure described below. All haplotypes present in the parents according to the optimal solutions for all groups are assumed to be confirmed and are used as input for the haplotyping of the unrelated material (Stage 3). Stage 2 is summarized in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S1.</p>
        <p id="Par58">For each FS family we rely on the parental marker dosages to be non-missing and correct. If one or both parents have missing dosages for one or more markers in the haploblock, then for this haploblock the FS family and its parents are considered to be unrelated material. This is also the case for FS families where no acceptable solution is found, as will usually be the case if there are errors in the parental genotypes.</p>
        <p id="Par59">For FS families where both parents have full marker dosage information we apply function solveOneFS: consider the possible combinations of parental <italic>Ghap</italic>, each of which leads to a prediction of the haplotype segregation in the FS progeny. In calculating the expected haplotype segregation a specified frequency of double reduction is taken into account (default 2.5%). We convert the expected haplotype segregation into an expected segregation of marker allele dosage genotypes, taking into account a small probability of errors in dosage scores (default: 2.5%). We test the observed <italic>Gmrk</italic> segregation in the FS against this expected segregation, using a chi-squared test. In order to limit the bias of this test caused by categories with small number of expected individuals we group all expected <italic>Gmrk</italic> with less than 1 expected individual, together with the observed but unexpected <italic>Gmrk</italic>, in a single group. After this step we select the best parental <italic>Ghap</italic> combinations: those whose chi-squared <italic>P</italic> value is not less than 0.001 * the <italic>P</italic> value of the best combination and larger than some minimum threshold (default 10<sup>–8</sup>).</p>
        <p id="Par60">Depending on the <italic>Gmrk</italic> of the parents there may be a large number of possible parental <italic>Ghap</italic> combinations. Checking one parental <italic>Ghap</italic> combination takes appreciable time (a standard desktop computer with Intel i5 processor at 1.60 GHz, Windows10 can check about 200,000 parental <italic>Ghap</italic> combinations per hour). Therefore we try to consider the most likely parental <italic>Ghap</italic> first, which are the ones that involve only the haplotypes determined to be present after Stage 1. If no good solution is obtained with these selected haplotype combinations we consider all other possible <italic>Ghap</italic> as well, although it is possible to specify a maximum number of parental <italic>Ghap</italic> combinations (default: 150,000), above which the FS family will be treated as unrelated material.</p>
        <p id="Par61">Once all FS families in a group with shared parents have been analyzed, some of the FS families may have more than one possible solution and/or the solutions of FS families with a shared parent may be incompatible (i.e. each specifying a different <italic>Ghap</italic> for the shared parent). The best solution over the group is selected in function resolveGroupConflicts as follows. First we get rid of the incompatible solutions by iterating the following steps.<list list-type="alpha-lower"><list-item><p id="Par62">For each parent in the group of linked FS families we consider all <italic>Ghap</italic> that are a potential solution for any of the FS families of which it is a parent. For each of these <italic>Ghap</italic> we determine for which of the FS families it is NOT a solution and we sum the numbers of individuals in these FSs. In this way for each potential <italic>Ghap</italic> of each parent in the group we know how many FS individuals in the group are not explained by it.</p></list-item><list-item><p id="Par63">If no such <italic>Ghap</italic> have unexplained FS families, all remaining FS families in the group are compatible and we stop this process. Else we remove the parental <italic>Ghap</italic> with most incompatible FS progeny from the set of possible solutions of each of the FS families of which this parent is a parent. If this was the last remaining solution of an FS family, the entire FS family is considered as incompatible and is removed from the group. All FS progeny in that population and its other parent (if not shared by other FS families in the group) are removed from the group and the process is repeated. The removed FS family and parent will be treated as unrelated material for this haploblock.</p></list-item></list></p>
        <p id="Par64">After this iteration there are one or more sets of <italic>Ghap</italic> for all parents that together are solutions for the entire (remaining) group. If more than one such set exists, we select the optimal one. The optimal solution is found by multiplying the chi-squared <italic>P</italic> values over all (remaining) FS families in the group and selecting the one(s) with the maximum combined <italic>P</italic> value. If multiple overall solutions are equally optimal, we assign <italic>Ghap</italic> to all parents and FS individuals that have the same, unique <italic>Ghap</italic> under all these solutions and leave the others unassigned.</p>
        <p id="Par65">For FS families where a single solution is found all possible marker genotypes (<italic>Gmrk</italic>) are known. For FS individuals with one or more missing marker dosages these are imputed (function imputeFSindiv) if the remaining markers allow only one of these possible <italic>Gmrk</italic>. In order to avoid over-interpretation, the imputed marker genotypes are accepted only if less than half of the FS family is imputed, and if the chi-squared fit including the imputed progeny is not too much worse than without these individuals (the chi-squared <italic>P</italic> value with imputation must be &gt; 0.1 * the <italic>P</italic> value without imputation).</p>
      </sec>
      <sec id="Sec14">
        <title>Stage 3: haplotyping of remaining material</title>
        <p id="Par66">After all groups of FS families have been considered we may be left with FS families (and parents) for which no solution was found or that had a solution incompatible with the other FS families in their group. These individuals, together with any material that was not part of a FS family, are jointly analyzed as a group of unrelated material. This is also the case if no FS families were defined in the original population.</p>
        <p id="Par67">In this analysis all haplotypes present in the now haplotyped FS families and any haplotypes specified as known are taken as known haplotypes. The initial analysis of this material in stage 3 is identical to stage 1 and also performed by function inferHaps_noFS. After this analysis some of the selected <italic>Ghap</italic> may contain haplotypes that are not in the set of known haplotypes because they occur in less than the minimum number of individuals. If so, we run one extra cycle of step b (described under stage 1) with a lower threshold (by default 1%, but at least 2 individuals, instead of 10%) for the number of individuals in which a haplotype should occur to be considered “known”. If this results in more individuals with a unique solution and if no individuals that had a unique solution now don’t have one anymore, then we accept the result of this final cycle.</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Implementation</title>
      <p id="Par68">The algorithm described above is implemented in an R package [<xref ref-type="bibr" rid="CR26">26</xref>] named PolyHaplotyper which is available from CRAN [<xref ref-type="bibr" rid="CR27">27</xref>]. The entire haplotyping process over multiple haploblocks in a single population (which may consist of multiple FS families, their parents and unrelated material) is performed through a single call to function inferHaplotypes. Apart from this function the package provides functions that help to format the data set, to merge replicate samples from the same individuals and to produce overviews and statistics.</p>
      <p id="Par69">Apart from the relations between FS families and their (possibly shared) parents, the haplotyping process does not make use of known pedigree relations. However, if a pedigree is available, PolyHaplotyper allows to check for each parents-offspring trio (or pair, if only one parent is available) whether the inferred haplotype composition of the offspring is compatible with that of the parents.</p>
      <p id="Par70">An important characteristic of our method is that it relies on considering all possible combinations of haplotypes that yield the observed marker dosages. The number of haplotype combinations quickly becomes astronomical with increasing ploidy level and increasing number of markers per haploblock. The implementation allows to generate the combinations as required, but the computation time then quickly becomes prohibitive. It is much more efficient to tabulate all haplotype combinations for all marker dosage combinations in advance, so that the table for the desired ploidy can be loaded at the start of a run. The package also provides functions to calculate these tables. In practice, these pre-calculated tables are currently limited to 8 markers per haploblock for tetraploids and 6 for hexaploids. Larger numbers would require a different access method as it would become impossible to store these tables in memory and the indices to the tables would overrun the capacity of the 32-bit integers in R.</p>
    </sec>
    <sec id="Sec16">
      <title>Comparisons with other software</title>
      <p id="Par71">Our software is not the first that is aimed at short-range haplotyping in polyploids based on SNP dosage data, but to our knowledge it is the first that makes use of known FS families in the data. We compared the results of our software with those of SATlotyper [<xref ref-type="bibr" rid="CR13">13</xref>] downloaded from [<xref ref-type="bibr" rid="CR28">28</xref>], Happy-inf [<xref ref-type="bibr" rid="CR19">19</xref>] downloaded from [<xref ref-type="bibr" rid="CR29">29</xref>] and SHEsisPlus [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] accessed online at [<xref ref-type="bibr" rid="CR21">21</xref>]. All were used with their recommended or default settings. Functions are supplied in the PolyHaplotyper package to convert PolyHaplotyper-formatted input data to the formats required by these packages, and to reformat their output to PolyHaplotyper output format. Further, PolyHaplotyper contains functions to convert marker data simulated with PedigreeSim (Voorrips and Maliepaard, 2012) to the input format of PolyHaplotyper, and to compare haplotyping results with “true” simulated genotypes generated by PedigreeSim.</p>
    </sec>
    <sec id="Sec17">
      <title>Data sets</title>
      <sec id="Sec18">
        <title>Data set 1: hexaploid Chrysanthemum population</title>
        <p id="Par72">Data set 1 contains SNP dosage data obtained from chrysanthemum using a dedicated Axiom SNP array [<xref ref-type="bibr" rid="CR20">20</xref>]. The hexaploid population consists of four FS families of 405, 53, 76 and 37 individuals, with 7 parents (families 1 and 4 share a common parent) and 53 unrelated individuals. For this population the true genotypes are unknown, but a pedigree is available that allows to check for inconsistent haplotype assignments. The data set contains 189 SNP markers, grouped in 43 haploblocks of 4 or 5 SNPs. Markers grouped in a haploblock mapped on the same sequence contig, based on sequence data generated prior to the array development.</p>
      </sec>
      <sec id="Sec19">
        <title>Data set 2: simulated tetraploid population with 9 FS families</title>
        <p id="Par73">This tetraploid data set is the result of a simulation performed using PedigreeSim [<xref ref-type="bibr" rid="CR30">30</xref>]. The population consists of 9 FS families of 50 individuals each, all sharing one common parent. The parents have been simulated so that they are genetically structured into three groups of related individuals. The number of founder alleles segregating per locus ranges between 14 and 26. However, the number of haploblock alleles is lower, due to the limited information content of small-size haploblocks. SNP-based heterozygosity per individual (i.e. the percentage of heterozygous calls over the total number of SNPs per individual) ranges from 73 to 85%. Results are presented for 300 biallelic (SNP) markers grouped in 60 haploblocks of 3—7 markers; all markers in a haploblock were simulated at the same genetic map position, i.e. no recombination could occur within haploblocks. The haplotyping results were compared to the true haplotype compositions, which are known from the simulation results.</p>
      </sec>
      <sec id="Sec20">
        <title>Data set 3: simulated tetraploid population with 2 FS families and other material</title>
        <p id="Par74">This tetraploid data set is the result of a simulation performed using PedigreeSim [<xref ref-type="bibr" rid="CR30">30</xref>]. The population consists of 2 FS families of 50 individuals each, sharing one common parent. The parents have been simulated as originating from two distinct random-mating populations. In addition there are two groups of 50 individuals, one group belonging to each of these two random-mating populations. Results are presented for 300 biallelic (SNP) markers grouped in 60 haploblocks of 3–7 markers; all markers in a haploblock were simulated at the same genetic map position, i.e. no recombination could occur within haploblocks. The number of haplotypes per haploblock ranges from 7 to 29, with an average of 16.2. The haplotyping results were compared to the true haplotype compositions, which are known from the simulation results.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4989_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> A basic explanation of the concepts of haploblocks and haplotyping, as used in this article.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_4989_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2. Table S1.</bold> Total haplotype counts in three runs of ShesisPlus and of PolyHaplotyper, for four haploblocks of Data set 1. <bold>Table S2.</bold> Haplotyping results with Data set 2, separated by haploblock size. <bold>Table S3.</bold> Haplotyping results with Data set 3, separated by haploblock size. <bold>Table S4.</bold> Haplotyping results with Data set 3, separated by material.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2022_4989_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3. Fig. S1.</bold> Stage 2 of the haplotyping process.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2022_4989_MOESM4_ESM.rdata">
            <caption>
              <p><bold>Additional file 4.</bold> Dataset1_chrysanthemum.RData: A file containing Data set 1 in a format that can be loaded in R.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2022_4989_MOESM5_ESM.r">
            <caption>
              <p><bold>Additional file 5.</bold> Dataset1_script.R: An R script illustrating how Data set 1 was processed with PolyHaplotyper, and how the comparisons with SATlotyper, Happy-inf and SHEsisPlus were made.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2022_4989_MOESM6_ESM.r">
            <caption>
              <p><bold>Additional file 6.</bold> Dataset2_script.R: An R script illustrating how Data set 2 was processed with PolyHaplotyper, and how the comparisons with SATlotyper and Happy_inf were made.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2022_4989_MOESM7_ESM.rdata">
            <caption>
              <p><bold>Additional file 7.</bold> Dataset2_sim_9_FS_families.RData: A file containing Data set 2 in a format that can be loaded in R.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2022_4989_MOESM8_ESM.r">
            <caption>
              <p><bold>Additional file 8.</bold> Dataset3_script.R: An R script illustrating how Data set 3 was processed with PolyHaplotyper, and how the comparisons with SATlotyper and Happy_inf were made.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2022_4989_MOESM9_ESM.rdata">
            <caption>
              <p><bold>Additional file 9.</bold> Dataset3_sim_2_FS_and_other.RData: A file containing Data set 3 in a format that can be loaded in R.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CRAN</term>
        <def>
          <p id="Par4">The Comprehensive R Archive Network</p>
        </def>
      </def-item>
      <def-item>
        <term>FS</term>
        <def>
          <p id="Par5">Full-sib</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par6">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>QTL</term>
        <def>
          <p id="Par7">Quantitative trait locus</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par8">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>SSR</term>
        <def>
          <p id="Par9">Short sequence repeat</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The Chrysanthemum data used in Data set 1 were made available by Deliflor Chrysanten, Maasdijk, The Netherlands.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RV developed the algorithm and the software, performed the analyses and drafted the manuscript. GT contributed ideas and tested the software, generated the simulated data in Data set 2 and contributed to the manuscript. Both authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Ministry of Agriculture, Nature and Food Quality of the Netherlands, through TKI projects ‘Novel genetic and genomic tools for polyploid crops’ (BO-50-002-022) and ‘Application of sequence-based multi-allelic markers in genetics and breeding of polyploids’ (LWV20.112).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data sets used in the current study, and R scripts detailing how they were analyzed are included in this article as Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM8" ref-type="media">8</xref> and <xref rid="MOESM9" ref-type="media">9</xref>. The algorithm described in this article is implemented in an R package named PolyHaplotyper which is publicly available from CRAN [<xref ref-type="bibr" rid="CR27">27</xref>] at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/PolyHaplotyper/">https://cran.r-project.org/web/packages/PolyHaplotyper/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par75">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par76">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par77">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourke</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>RGF</given-names>
          </name>
          <name>
            <surname>Maliepaard</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Tools for genetic studies in experimental populations of polyploids</article-title>
        <source>Front Plant Sci</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>513</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2018.00513</pub-id>
        <pub-id pub-id-type="pmid">29720992</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pagliarani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pikunova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Noordijk</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yilmaz-Temel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meulenbroek</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic rearrangements and signatures of breeding in the allo-octoploid strawberry as revealed through an allele dose based SSR linkage map</article-title>
        <source>BMC Plant Biol</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">24387633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguiar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Istrail</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>HapCompass: A fast cycle basis algorithm for accurate haplotype assembly of sequence data</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>577</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0084</pub-id>
        <pub-id pub-id-type="pmid">22697235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguiar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Istrail</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Haplotype assembly in polyploid genomes and identical by descent shared tracts</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>352</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clevenger</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Korani</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ozias-Akins</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-based genotyping in polyploids</article-title>
        <source>Front Plant Sci</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>564</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2018.00564</pub-id>
        <pub-id pub-id-type="pmid">29755500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Motazedi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>De Ridder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Finkers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Monaghan</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TriPoly: haplotype estimation for polyploids using sequencing data of related individuals</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3864</fpage>
        <lpage>3872</lpage>
        <?supplied-pmid 29868858?>
        <pub-id pub-id-type="pmid">29868858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Motazedi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Maliepaard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Finkers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>De Ridder</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Family-based haplotype estimation and allele dosage correction for polyploids using short sequence reads</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>335</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00335</pub-id>
        <pub-id pub-id-type="pmid">31040862</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Finkers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Parida</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for polyploid haplotype phasing</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>171</fpage>
        <lpage>180</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4464-9</pub-id>
        <pub-id pub-id-type="pmid">29764361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Fry</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Haploview: analysis and visualization of LD and haplotype maps</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>263</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth457</pub-id>
        <?supplied-pmid 15297300?>
        <pub-id pub-id-type="pmid">15297300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous genotype calling and haplotype phasing improves genotype accuracy and reduces false-positive associations for genome-wide association studies</article-title>
        <source>Am J Hum Genet</source>
        <year>2009</year>
        <volume>85</volume>
        <fpage>847</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.11.004</pub-id>
        <?supplied-pmid 19931040?>
        <pub-id pub-id-type="pmid">19931040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kinghorn</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Tier</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>van der Werf</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Cleveland</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>A phasing and imputation method for pedigreed populations that results in a single-stage genomic evaluation</article-title>
        <source>Genet Sel Evol</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-44-9</pub-id>
        <pub-id pub-id-type="pmid">22462519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graça</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lynce</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Marques-Silva</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oliveira</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Efficient and accurate haplotype inference by combining parsimony and pedigree information</article-title>
        <source>Algebr Numer Biol Lect Notes Comput Sci</source>
        <year>2012</year>
        <volume>6479</volume>
        <fpage>38</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-642-28067-2_3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neigenfind</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gyetvai</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Basekow</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Diehl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Achenbach</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Gebhardt</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype inference from unphased SNP data in heterozygous polyploids based on SAT</article-title>
        <source>BMC Genomics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>356</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-9-356</pub-id>
        <pub-id pub-id-type="pmid">18667059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>LJM</given-names>
          </name>
        </person-group>
        <article-title>Inference of haplotypic phase and missing genotypes in polyploid organisms and variable copy number genomic regions</article-title>
        <source>BMC Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Asher</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Jarvelin</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Froguel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Blakemore</surname>
            <given-names>AIF</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring combined CNV/SNP haplotypes from genotype data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1437</fpage>
        <lpage>1445</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq157</pub-id>
        <pub-id pub-id-type="pmid">20406911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SHEsis, a powerful software platform for analyses of linkage disequilibrium, haplotype construction, and genetic association at polymorphism loci</article-title>
        <source>Cell Res</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>97</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.cr.7290272</pub-id>
        <pub-id pub-id-type="pmid">15740637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Li Z, Zhang Z, He Z, Tang W, Li T, Zeng Z, et al. A partition-ligation-combination-subdivision EM algorithm for haplotype inference with multiallelic markers: update of the SHEsis (<ext-link ext-link-type="uri" xlink:href="http://analysis.bio-x.cn">http://analysis.bio-x.cn</ext-link>). Cell Res. 2009;19:519–23.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SHEsisPlus, a toolset for genetic studies on polyploid species</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">28442746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Willemsen JH, Visser RGF, Van Eck HJ. Chapter 4. Haplotype inference in polyploid species and application to genetic analysis in potato. In: Willemsen J, editor. The identification of allelic variation in potato. PhD Thesis, Wageningen University. 2018.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Geest</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Esselink</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Post</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>RGF</given-names>
          </name>
          <name>
            <surname>Arens</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Conclusive evidence for hexasomic inheritance in chrysanthemum based on analysis of a 183 k SNP array</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">28049423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">SHEsisPlus—a web-based platform for association test on polyploid and multiallelic species. <ext-link ext-link-type="uri" xlink:href="http://shesisplus.bio-x.cn/SHEsis.html">http://shesisplus.bio-x.cn/SHEsis.html</ext-link>. Accessed 1–4 May 2020.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hackett</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Boskamp</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vogogias</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Preedy</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Milne</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>TetraploidSNPMap: software for linkage analysis and QTL mapping in autotetraploid populations using SNP dosage data</article-title>
        <source>J Hered</source>
        <year>2017</year>
        <volume>108</volume>
        <fpage>438</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esx022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hackett</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bink</surname>
            <given-names>MCAM</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic multilocus haplotype reconstruction in outcrossing tetraploids</article-title>
        <source>Genetics</source>
        <year>2016</year>
        <volume>203</volume>
        <fpage>119</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.115.185579</pub-id>
        <pub-id pub-id-type="pmid">26920758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourke</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Van Geest</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kranenburg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shahin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PolymapR—linkage analysis and genetic map construction from F1 populations of outcrossing polyploids</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3496</fpage>
        <lpage>3502</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty371</pub-id>
        <pub-id pub-id-type="pmid">29722786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>Inference of haplotypes from PCR-amplified samples of diploid populations</article-title>
        <source>Mol Biol Evol</source>
        <year>1990</year>
        <volume>7</volume>
        <fpage>111</fpage>
        <lpage>122</lpage>
        <?supplied-pmid 2108305?>
        <pub-id pub-id-type="pmid">2108305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing. 2020. <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">The Comprehensive R Archive Network. 2021. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/">https://cran.r-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">SATlotyper web page. <ext-link ext-link-type="uri" xlink:href="http://www.gabipd.org/projects/satlotyper/">http://www.gabipd.org/projects/satlotyper/</ext-link>. Accessed 19 January 2019.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Willemsen JH. Happy-haplotype-inference V1 download link. <ext-link ext-link-type="uri" xlink:href="https://git.wageningenur.nl/wille094/Happy-haplotype-inference/-/tree/master/V1">https://git.wageningenur.nl/wille094/Happy-haplotype-inference/-/tree/master/V1</ext-link>. Accessed 14 September 2020.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Maliepaard</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>The simulation of meiosis in diploid and tetraploid organisms using various genetic models</article-title>
        <source>BMC Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>248</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-248</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
