<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9883676</article-id>
    <article-id pub-id-type="pmid">31400221</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz640</article-id>
    <article-id pub-id-type="publisher-id">btz640</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Alternating EM algorithm for a bilinear model in isoform quantification from RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Wenjiang</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics</institution>, Karolinska Institutet, Stockholm 17177, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mou</surname>
          <given-names>Tian</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics</institution>, Karolinska Institutet, Stockholm 17177, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kalari</surname>
          <given-names>Krishna R</given-names>
        </name>
        <aff><institution>Department of Health Sciences Research</institution>, MN 55905, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niu</surname>
          <given-names>Nifang</given-names>
        </name>
        <aff><institution>Department of Molecular Pharmacology and Experimental Therapeutics</institution>, Mayo Clinic, Rochester, MN 55905, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Liewei</given-names>
        </name>
        <aff><institution>Department of Molecular Pharmacology and Experimental Therapeutics</institution>, Mayo Clinic, Rochester, MN 55905, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pawitan</surname>
          <given-names>Yudi</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics</institution>, Karolinska Institutet, Stockholm 17177, <country country="SE">Sweden</country></aff>
        <xref rid="btz640-cor1" ref-type="corresp"/>
        <!--yudi.pawitan@ki.se-->
        <xref rid="btz640-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Vu</surname>
          <given-names>Trung Nghia</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics</institution>, Karolinska Institutet, Stockholm 17177, <country country="SE">Sweden</country></aff>
        <xref rid="btz640-cor1" ref-type="corresp"/>
        <!--trungnghia.vu@ki.se-->
        <xref rid="btz640-FM1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btz640-FM1">
        <p>Yudi Pawitan and Trung Nghia Vu wish it to be known that, in their opinion, the last two authors should be regarded as Joint last Authors.</p>
      </fn>
      <corresp id="btz640-cor1">To whom correspondence should be addressed. <email>yudi.pawitan@ki.se</email> or <email>trungnghia.vu@ki.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date iso-8601-date="2019-08-10" pub-type="epub">
      <day>10</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <volume>36</volume>
    <issue>3</issue>
    <fpage>805</fpage>
    <lpage>812</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bioinformatics_36_3_805.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Estimation of isoform-level gene expression from RNA-seq data depends on simplifying assumptions, such as uniform read distribution, that are easily violated in real data. Such violations typically lead to biased estimates. Most existing methods provide bias correction step(s), which is based on biological considerations—such as GC content—and applied in single samples separately. The main problem is that not all biases are known.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed a novel method called XAEM based on a more flexible and robust statistical model. Existing methods are essentially based on a linear model <italic toggle="yes">Xβ</italic>, where the design matrix <italic toggle="yes">X</italic> is known and is computed based on the simplifying assumptions. In contrast XAEM considers <italic toggle="yes">Xβ</italic> as a bilinear model with both <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> unknown. Joint estimation of <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> is made possible by a simultaneous analysis of multi-sample RNA-seq data. Compared to existing methods, XAEM automatically performs empirical correction of potentially unknown biases. We use an alternating expectation-maximization (AEM) algorithm, alternating between estimation of <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic>. For speed XAEM utilizes quasi-mapping for read alignment, thus leading to a fast algorithm. Overall XAEM performs favorably compared to recent advanced methods. For simulated datasets, XAEM obtains higher accuracy for multiple-isoform genes. In a differential-expression analysis of a real single-cell RNA-seq dataset, XAEM achieves substantially better rediscovery rates in independent validation sets.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The method and pipeline are implemented as a tool and freely available for use at <ext-link xlink:href="http://fafner.meb.ki.se/biostatwiki/xaem/" ext-link-type="uri">http://fafner.meb.ki.se/biostatwiki/xaem/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>Swedish Cancer Fonden, the Swedish Research Council (VR)</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>Swedish Foundation for Strategic Research (SSF)</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>China Scholarship Council (CSC)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Alternative splicing is a regulated process where inclusion and exclusion of exons from the same gene produce multiple transcripts. Alternative gene transcripts can also arise from alternative start or stop locations. Transcripts originating from the same gene have mostly similar sequences, but can have distinct biological functions (<xref rid="btz640-B2" ref-type="bibr">Christofk <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btz640-B16" ref-type="bibr">Steinberg, 2008</xref>). Thus, variability in alternative transcription greatly increases the biodiversity and functional complexity in higher eukaryotes. Alternative transcripts are also known as isoforms, so for convenience we use these terms interchangeably. Quantifying gene expression at isoform level is an important step in studies of molecular processes and cancer research, e.g. tumor-subtype classification and stage tracking in cancer progression (<xref rid="btz640-B24" ref-type="bibr">Weinstein <italic toggle="yes">et al.</italic>, 2013</xref>). Therefore, development of computational methods to estimate isoform-level expression accurately and efficiently is of great importance.</p>
    <p>All methods of isoform expression estimation start with basic simplifying assumptions, such as uniform read distribution (<xref rid="btz640-B6" ref-type="bibr">Jiang and Wong, 2009</xref>; <xref rid="btz640-B9" ref-type="bibr">Mortazavi <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>). In reality such assumptions are easy to violate: e.g. the read distribution can be non-uniform due to a number of experimental and technical biases. When generating the cDNA fragments from RNA transcripts, there is a possibility of a preference to the 5′ or 3′, which produces more reads at the start/end of a fragment. Other factors such as GC bias and sequence-specific biases may also negatively affect the quantification. The accuracy of isoform expression inference can deteriorate if the biases are not taken into account. So bias is a well-known issue in isoform quantification.</p>
    <p>In fact most isoform quantification methods employ bias correction steps. Salmon (<xref rid="btz640-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>) implements a two-step procedure, with a sample specific model to correct bias in the second step. Cufflinks starts with a uniformity assumption, but provides a likelihood-based approach for bias correction (<xref rid="btz640-B14" ref-type="bibr">Roberts <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btz640-B20" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2010</xref>). The correction in Kallisto (<xref rid="btz640-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>) is similar to that in Cufflinks, while it measures the sequence-specific bias from the first 1 million reads. In our previous work (<xref rid="btz640-B18" ref-type="bibr">Suo <italic toggle="yes">et al.</italic>, 2014</xref>), we demonstrated that there is a high correlation of relative abundances of reads between samples, suggesting that summarizing distribution information across samples could correct for the underlying non-uniform read distribution. All these methods attempt to identify the sources of biases explicitly and provide specific corrections for them. The main problem is that not all biases are known, and there is still no general approach that can adapt to unknown biases in RNA-seq data.</p>
    <p>Read mapping or alignment is also a source of problems in isoform quantification using RNA-seq data. Due to the nature of isoforms, an aligner must take into account the splicing mechanism in alignment of read. A wide range of splice-aware aligners have been developed for this purpose, e.g. Tophat (<xref rid="btz640-B19" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2009</xref>), STAR (<xref rid="btz640-B3" ref-type="bibr">Dobin <italic toggle="yes">et al.</italic>, 2013</xref>) and HISAT (<xref rid="btz640-B7" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2015</xref>). Although these tools facilitate the read alignment and significantly reduce memory usage, the alignment step remains time consuming, especially when they report optimal alignments with comprehensive information, e.g. CIGAR string.</p>
    <p>Recently, a variety of methods have been used to reduce the burden of the read alignment step. These approaches can increase the speed by orders of magnitude, while achieving similar estimation accuracy as the traditional method. For example, Sailfish (<xref rid="btz640-B12" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2014</xref>) introduces the concept of <italic toggle="yes">lightweight-alignment</italic>, which supports the idea that precise alignment is not necessary to assign the potential origin of a sequencing read. Similarly, Kallisto (<xref rid="btz640-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>) introduces a <italic toggle="yes">pseudo-alignment</italic> to skip the read alignment step. Salmon (<xref rid="btz640-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>) implements a <italic toggle="yes">quasi-mapping</italic> to allow fast and accurate alignment of fragments to the reference transcriptome. It makes use of a hash table and suffix array (SA) to locate the potential transcript of origin of a sequenced read. This quasi-mapping is also implemented as an independent mapper, i.e. Rapmap, and applied to the updated versions of Sailfish (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>To address these issues, we have developed a novel method called XAEM for isoform expression estimation based on a more flexible and robust statistical model. Existing methods are essentially based on a linear model <italic toggle="yes">Xβ</italic>, with known design matrix <italic toggle="yes">X</italic> derived using simplifying assumptions such as uniform read distribution, and the unknown isoform abundance <italic toggle="yes">β</italic> is estimated using the EM algorithm. Explicit bias correction is then performed as an extra step, and applied sample-by-sample, using separate considerations. In contrast, XAEM considers <italic toggle="yes">Xβ</italic> as a bilinear model with both <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> unknown. Joint estimation of <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> is made possible by a simultaneous analysis of multi-sample RNA-seq data. Compared to existing methods, the bilinear model automatically performs empirical correction of potentially unknown biases. We use an alternating expectation-maximization (AEM) algorithm, alternating between estimation of <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic>. For speed XAEM utilizes the quasi-mapping approach for ultra-fast read mapping. We compare XAEM with several state-of-the-art quantification tools including Salmon (<xref rid="btz640-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>), Kallisto (<xref rid="btz640-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>), Sailfish (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>) and Cufflinks (<xref rid="btz640-B20" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2010</xref>). The comparison is performed on both simulated and real RNA-seq datasets. To illustrate XAEM’s ability to deal with potentially unknown biases, the real data are single-cell (sc)RNA-seq data from breast-cancer cells. The results show that XAEM achieves overall better performances in both quantification of isoform-level expression and detection of differentially expressed isoforms.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 General isoform quantification model</title>
      <p>A major problem in conventional isoform quantification is how to quantify reads that map to an exon shared by different isoforms. The simple illustration in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> shows three single-end reads mapped to exon1 shared by three transcripts: tx1, tx2 and tx4. It is not obvious which transcript these reads originate from. In this context we also use ’isoform’ which refers to alternative gene transcript. We extend the idea of the exon-sharing to a more general concept: sequence-sharing. Due to the sequence similarity, one fragment can map to several reference sequences. Thus, any highly similar sequence could lead to exon-sharing, but the exons are not necessarily within the same gene. We can call the similar sequence as <italic toggle="yes">quasi-exon</italic>. Thus throughout the text, the term exon indicates quasi-exon. In order to describe exon-sharing in isoform expression estimation, we use the concept of ‘equivalence class’ (eqclass) from a recent paper (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>). An equivalence class is generated from reads mapping statistics, so it does not need to have direct biological meaning, especially for paired-end data. For single-end data, the simplest interpretation of an eqclass is as a list of transcripts sharing the same exon, so the class may represent the exon.</p>
      <p>We first summarize the number of reads that map to different eqclasses using Rapmap (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>) from an input RNA-seq sample. Let <italic toggle="yes">y<sub>j</sub></italic> be the number of reads (read-count) that are mapped to eqclass <italic toggle="yes">j</italic>. For a specific set of eqclasses <italic toggle="yes">J</italic> with <italic toggle="yes">T</italic> transcripts, let <italic toggle="yes">β<sub>t</sub></italic> be the expression level of transcript <italic toggle="yes">t</italic>. The key statistical problem is to estimate transcript abundances <italic toggle="yes">β<sub>t</sub></italic> from the read-count data <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. By adding up the contribution of multiple transcripts, we model the expected number of reads in eqclass <italic toggle="yes">j</italic> as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which, in matrix notation, can be written as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>β</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mi>w</mml:mi><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here <italic toggle="yes">w</italic> refers to the total number of mapped reads divided by 10<sup>9</sup> (per kilobase per million reads), <italic toggle="yes">a<sub>jt</sub></italic> is the isoform-specific bias/non-uniformity effect, <italic toggle="yes">L<sub>t</sub></italic> is effective length and <italic toggle="yes">p<sub>jt</sub></italic> is the proportion of reads in eqclass <italic toggle="yes">j</italic> under uniform distribution. For identifiability we set <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≡</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for every transcript <italic toggle="yes">t</italic>. It is conventionally assumed that <italic toggle="yes">y<sub>j</sub></italic> has Poisson distribution with mean <italic toggle="yes">μ<sub>j</sub></italic>.</p>
      <p>In general both <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> in <xref rid="E2" ref-type="disp-formula">equation (2)</xref> are unknown parameters, so we have a bilinear model. Under the uniform read distribution assumption, we have <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, so (1) becomes
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mi>w</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>The simple model (3) is either explicitly or implicitly used by most existing RNAseq quantification tools (<xref rid="btz640-B6" ref-type="bibr">Jiang and Wong, 2009</xref>; <xref rid="btz640-B9" ref-type="bibr">Mortazavi <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>). We also use it to generate the starting value of the design matrix <italic toggle="yes">X</italic>, as described in the next section.</p>
    </sec>
    <sec>
      <title>2.2 Construction of the starting design matrix <italic toggle="yes">X</italic></title>
      <p>The starting value of <italic toggle="yes">X</italic> in the XAEM algorithm is derived by assuming the uniform read distribution. From <xref rid="E3" ref-type="disp-formula">equation (3)</xref>, <italic toggle="yes">X</italic> contains three components: (i) a list of transcripts connected due to exon-sharing, (ii) a set of exons shared by these transcripts and (iii) the proportion of read counts from the eqclasses that contribute to the total reads of each transcript. As an illustration, suppose the corresponding design matrix for <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> is given by (4), which contains four transcripts: tx1, tx2, tx3 and tx4 (columns) and three eqclasses (rows). The values <italic toggle="yes">x<sub>jt</sub></italic> in the matrix indicate the proportion of reads originating from eqclass <italic toggle="yes">j</italic> for transcript <italic toggle="yes">t</italic>. Note that the sum of proportions for each transcript <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is equal to 1.
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.02</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.12</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.85</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.88</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.13</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.85</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>We now describe in detail how to construct the design matrix in (4) using simulated RNA-seq data. The full set of design matrices for all transcripts in the transcriptome can be generated in the same way.</p>
      <sec>
        <label>2.2.1</label>
        <title>Construction of transcription clusters (TCs)</title>
        <p>The eqclass shows the connection between a set of transcripts sharing the same exon. To investigate this connection, we use Polyester (<xref rid="btz640-B4" ref-type="bibr">Frazee <italic toggle="yes">et al.</italic>, 2015</xref>) to generate simulated reads for each transcript across the transcriptome. For example, we first simulate sample1 for transcript tx1. In sample1, we set tx1 to be the only transcript expressed, and the read count is assigned a large number <italic toggle="yes">L</italic>. In practice, we used <italic toggle="yes">L </italic>=<italic toggle="yes"> </italic>2× transcript length, but with a minimum of 1000. For this simulated data, reads with uniform distribution are generated with base error rate set to 0.005. We then use Rapmap (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>) to align the reads to the reference transcriptome and summarize the mapping results into a matrix. We denote this matrix as <italic toggle="yes">transcript response profile</italic> (TRP), which defines a set of transcripts sharing exons with the source transcript, which is tx1 in this example.</p>
        <p><xref rid="btz640-T1" ref-type="table">Table 1</xref> shows an example of TRP of tx1. There are four transcripts sharing exons with tx1 by three eqclasses. The three rows in <xref rid="btz640-T1" ref-type="table">Table 1</xref> represent the three eqclasses and the values indicate the proportion of reads originating from each eqclass. From the table, we observe that other than tx1, which is the only transcript that is supposed to be expressed, there are four extra transcripts having mapped reads due to exon-sharing. This information is useful to capture the exon-sharing between different transcripts. When there is more than one transcript in the TRP, we denote these transcripts as <italic toggle="yes">transcript neighbors</italic> (TNs). To remove the false positives, the neighbors with reads less than a threshold <italic toggle="yes">H</italic> (e.g. 2.5% of total reads from the source transcript) are filtered out. Thus, in this example tx5 is discarded, and tx1 has three remaining neighbors: tx2, tx3 and tx4. We also evaluate the effect when we set the <italic toggle="yes">H</italic> as 0, which means all the neighbors are kept in a TRP. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, the performance is almost the same with <italic toggle="yes">H </italic>=<italic toggle="yes"> </italic>2.5%. However, we would still suggest to use a threshold to filter false positive neighbors in the TRPs.
</p>
        <table-wrap position="float" id="btz640-T1">
          <label>Table 1.</label>
          <caption>
            <p>An example of transcript response profile (TRP) matrix for tx1 based on simulated sample1</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Eqclass</th>
                <th rowspan="1" colspan="1">tx1</th>
                <th rowspan="1" colspan="1">tx2</th>
                <th rowspan="1" colspan="1">tx3</th>
                <th rowspan="1" colspan="1">tx4</th>
                <th rowspan="1" colspan="1">tx5</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">eqclass1</td>
                <td rowspan="1" colspan="1">20</td>
                <td rowspan="1" colspan="1">20</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">20</td>
                <td rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eqclass2</td>
                <td rowspan="1" colspan="1">850</td>
                <td rowspan="1" colspan="1">850</td>
                <td rowspan="1" colspan="1">850</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eqclass3</td>
                <td rowspan="1" colspan="1">130</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">130</td>
                <td rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Sum</td>
                <td rowspan="1" colspan="1">1000</td>
                <td rowspan="1" colspan="1">870</td>
                <td rowspan="1" colspan="1">850</td>
                <td rowspan="1" colspan="1">150</td>
                <td rowspan="1" colspan="1">20</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn1">
              <p><italic toggle="yes">Note</italic>: In this sample1 we set only tx1 expressed and we use Rapmap for read mapping. Next we summarize the read alignment results into the TRP matrix. The exon-sharing is presented by equivalence class (eqclass) as the rows in the matrix. Transcript tx5 is filtered out because it fails the false positive threshold of H = 2.5%.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Similarly, we generate TRP and TN for each transcript (<xref rid="btz640-F1" ref-type="fig">Fig. 1a and b</xref>). To expand the list of transcripts that have connections, we group the TRPs of connected transcripts together as <italic toggle="yes">transcription clusters</italic> (TCs). As shown in <xref rid="btz640-F1" ref-type="fig">Figure 1c</xref>, starting with tx1, we integrate the TNs of tx1, tx2, tx3, tx4 and summarize the connections into one TC. Thus each TC defines one unique design matrix with the list of mutually connected transcripts.
</p>
        <fig position="float" id="btz640-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>Steps to construct the starting design matrix <italic toggle="yes">X</italic>. (<bold>a</bold>) TRPs of tx1, tx2, tx3 and tx4, and the summary of binary occupancy patterns from the TRPs. Transcript tx5 does not pass the filtering (H = 2.5%) and is filtered out from TRP1. In each binary pattern, digit 1 means there are reads originating from an eqclass, and 0 otherwise. For example, there are three eqclasses in TRP1: eqclass1, eqclass2 and eqclass3. For eq1 the binary pattern is 1101, which means three transcripts, i.e. tx1, tx2 and tx4 have reads from eq1. (<bold>b</bold>) Transcript neighbors (TNs) for tx1 to tx4. (<bold>c</bold>) Illustration of construction of transcription cluster (TC) from the TNs. We first collect the TNs of tx1, tx2, tx3 and tx4, and then add the connections between transcripts into the TC. For example, from TN1, we add the connection of tx1-tx2, tx1-tx3 and tx1-tx4. In the end, a TC would contain all connections between transcripts sharing exons. (<bold>d</bold>) The unique set of binary patterns are kept, so three unique patterns remain: 1101, 1001, 1110. We then fill in the read counts from each source TRP. For example, for pattern 1101, in TRP1 the read count is 20 for tx1, in TRP2 the read count is 120 for tx2 and in TRP4 the read count is 150 for tx4. (<bold>e</bold>) The total reads of each transcript in (d) are standardized to sum to 1 to create the starting design matrix <italic toggle="yes">X</italic></p>
          </caption>
          <graphic xlink:href="bioinformatics_36_3_805_f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>Computing <italic toggle="yes">X</italic> for each TC</title>
        <p>We combine the information of TC and TRPs to create a design matrix <italic toggle="yes">X</italic>. Particularly, we summarize the reads from the TRPs into one table (<xref rid="btz640-F1" ref-type="fig">Fig. 1d</xref>). In this table we convert the names of eqclasses to a binary occupancy pattern. The digits 1 and 0 indicate whether a transcript has supporting reads from an eqclass or not. We then keep the final set of binary patterns as the eqclasses in the rows of the <italic toggle="yes">X</italic> matrix. The original read counts of each transcript originated from different eqclasses, which are highlighted by the bold numbers in <xref rid="btz640-F1" ref-type="fig">Figure 1a</xref>, are transferred to the corresponding positions in the matrix (<xref rid="btz640-F1" ref-type="fig">Fig. 1d</xref>). Finally the total reads for each transcript is standardized to sum to 1, which is shown in <xref rid="btz640-F1" ref-type="fig">Figure 1e</xref>. The final <italic toggle="yes">X</italic> matrix is exactly the design matrix in formula (4).</p>
      </sec>
      <sec>
        <label>2.2.3</label>
        <title>Merging paralogs</title>
        <p>Paralogs are isoforms that have high similarity in their sequences. Paralogs complicate the quantification of isoform expression due to the difficulty in distinguishing them from each other. If there are paralogs in <italic toggle="yes">X</italic> matrix, the columns of the corresponding transcripts can be extremely similar to each other, thus making the <italic toggle="yes">X</italic> matrix singular and the <italic toggle="yes">β</italic> parameter non-identifiable. To deal with this issue, we implement the k-means clustering to combine the paralogs into one transcript. Theoretically, exact paralogs will produce zero singular values, so the number of clusters <italic toggle="yes">k</italic> is the number of non-zero singular values in the singular-value decomposition of <italic toggle="yes">X</italic>. But in practice, we may get values very close to zero. As shown in Supplementary Section S2, based on our numerical studies, we set <italic toggle="yes">k</italic> as the number of singular values greater than 0.02. An illustrative example of the merging process can be seen in the Supplementary Section S3. The final set of processed <italic toggle="yes">X</italic> matrices is used as the starting <italic toggle="yes">X</italic> in the model (2).</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Estimation using the alternating EM algorithm</title>
      <p><xref rid="btz640-F2" ref-type="fig">Figure 2</xref> shows the workflow of XAEM for isoform expression estimation. First, we summarize the observed read counts <italic toggle="yes">y<sub>jn</sub></italic> from input RNA-seq sample <italic toggle="yes">n</italic>. The RNA-seq reads are mapped to the reference transcriptome using the quasi-mapping algorithm. We extract the list of eqclasses and their read counts <italic toggle="yes">y<sub>jn</sub></italic>, then match them in accordance with the eqclasses in the design matrices. To be concise we simply denote <italic toggle="yes">y<sub>jn</sub></italic> as <italic toggle="yes">y<sub>j</sub></italic> in the following text. We then summarize the read counts <italic toggle="yes">y<sub>j</sub></italic> across multiple samples and construct matrix <italic toggle="yes">Y</italic> as described in <xref rid="btz640-F2" ref-type="fig">Figure 2a</xref>. Next, joint estimation of <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> is done using the alternating expectation-maximization (AEM) algorithm, as shown in <xref rid="btz640-F2" ref-type="fig">Figure 2c</xref>. Given the starting value of <italic toggle="yes">X</italic>, the transcript abundance <italic toggle="yes">β<sub>t</sub></italic> can be estimated from the model in formula (5):
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
Thus, the estimation can be performed iteratively as follows:</p>
      <fig position="float" id="btz640-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Pipeline of XAEM for isoform expression estimation. (<bold>a</bold>) Construction of <italic toggle="yes">Y</italic> matrix from the input RNA-seq data of multiple samples. (<bold>b</bold>) An example of <italic toggle="yes">X</italic> or design matrix as the input of the model. (<bold>c</bold>) The step to estimate <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> iteratively using the AEM algorithm. In the last step, XAEM outputs the updated design matrix <italic toggle="yes">X</italic> and isoform expression <italic toggle="yes">β</italic></p>
        </caption>
        <graphic xlink:href="bioinformatics_36_3_805_f2" position="float"/>
      </fig>
      <p>A. Given <italic toggle="yes">x<sub>jt</sub></italic>, estimate <italic toggle="yes">β<sub>t</sub></italic> for multiple samples using (5)</p>
      <p>B. Given <italic toggle="yes">β<sub>t</sub></italic>, estimate <italic toggle="yes">x<sub>jt</sub></italic> using model:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
      <p>C. Iterate steps A and B until convergence.</p>
      <p>Specifically, in step A, given <italic toggle="yes">x<sub>jt</sub></italic> to estimate <italic toggle="yes">β<sub>t</sub></italic>, we calculate the value of <italic toggle="yes">β<sub>t</sub></italic> using
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:msubsup><mml:mo>β</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula>where
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>ψ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>ψ</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>ψ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the digamma function used in the E-step of the modified EM algorithm (<xref rid="btz640-B11" ref-type="bibr">Nariai <italic toggle="yes">et al.</italic>, 2013</xref>); <italic toggle="yes">β</italic><sub>0</sub> is a starting estimate for <italic toggle="yes">β<sub>t</sub></italic>, e.g. the mean read counts among <italic toggle="yes">T</italic> transcripts. In step B, for the updated <italic toggle="yes">X</italic> we standardize <italic toggle="yes">x<sub>jt</sub></italic> for each eqclass to calculate the proportion of read counts from observed counts <italic toggle="yes">y<sub>j</sub></italic>. The parameter <italic toggle="yes">β<sub>t</sub></italic> is then re-estimated using the proportion multiplied by <italic toggle="yes">y<sub>j</sub></italic>. The iteration procedure is considered to be converged when both <italic toggle="yes">x<sub>jt</sub></italic> and <italic toggle="yes">β<sub>t</sub></italic> have less than 1% difference between successive iterations. The 1% threshold is for maximal differences across the matrix elements, and if a matrix element is &lt;0.01 then the threshold is set to 1% of 0.01.</p>
      <p>It is worth noting here that XAEM does not individually deal with different types of biases. The effect of biases generally changes the proportion of reads to transcripts in the design matrix. By updating the design matrix <italic toggle="yes">X</italic> during the isoform quantification in AEM, XAEM automatically adjusts the design matrix for bias correction using the variation information from multiple samples. We have tested the robustness of the <italic toggle="yes">X</italic> matrix using different tissue data from the genotype-tissue expression (GTEx) project (<xref rid="btz640-B8" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic>, 2013</xref>). As shown in Supplementary Sections S4 and S5, the performance of XAEM is robust with respect to the heterogeneity of input samples.</p>
    </sec>
    <sec>
      <title>2.4 Datasets</title>
      <sec>
        <label>2.4.1</label>
        <title>Simulated RNA-seq data</title>
        <p>RNA-seq simulation is commonly used for the comparison of estimation accuracy among different tools. To investigate the estimation performance in a situation where the true expression levels are known, we use a simulator named Polyester (<xref rid="btz640-B4" ref-type="bibr">Frazee <italic toggle="yes">et al.</italic>, 2015</xref>) to generate synthetic datasets. To mimic a real RNA-seq dataset, we use scRNA-seq data from a human colon cancer cell line HCT116 (<xref rid="btz640-B25" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>) as the source of true <italic toggle="yes">β</italic> values. We first derive the isoform-level expression using Sailfish (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>) and implement the four-parameter beta-Poisson model to fit isoform abundance (<xref rid="btz640-B23" ref-type="bibr">Vu <italic toggle="yes">et al.</italic>, 2016</xref>). Next, we collect the well-fitted models (Monte-Carlo <italic toggle="yes">P</italic>-value &gt;0.05) as the baseline distribution for isoform expression. The models are assigned to isoforms in the transcriptome. For each isoform, the expression level across samples is generated from the assigned beta-Poisson model.</p>
        <p>Read counts are calculated by scaling the expression values to the predefined library size of samples. The library size are also derived from the HCT116 cell line, which ranges from 1 to 2.8 million. We notice that more than 70% of isoforms are unexpressed. We first compare the performance of XAEM and Salmon using this original data. The comparison shows that XAEM still has higher accuracy for paralogs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). But in this comparison only 2607 multiple isoforms are used, which cover only 8% of all multiple isoforms existing in the transcriptome (total 31 950). To simulate a more heterogeneous dataset, we assign the read counts from expressed isoforms to those unexpressed. The aims for this re-distribution are: (i) creating a more heterogeneous and comprehensive dataset for the comparison; (ii) preserving the distribution of read counts and expression patterns as in the original cell line. Note that the re-distribution procedure is conceptually related to a non-zero prior belief of transcript expression, and is thus theoretically justifiable. Furthermore, we re-distribute the read counts randomly to those unexpressed isoforms, and do not pick specific isoforms for the re-distribution. Polyester allows users to specify positional bias so that the read distribution can be uniform or non-uniform. In order to compare the quantification accuracy in different scenarios, we simulate 100 samples with uniform distribution and another 100 samples with non-uniform distribution. Paired-end reads are simulated with read length 100 bp, mean fragment length of 250 bp and standard deviation of fragment lengths of 25 bp. The probability that the sequencer records the wrong nucleotide at any given base is set to 0.005. In this study we use the hg19 as reference for data simulation and analysis.</p>
      </sec>
      <sec>
        <label>2.4.2</label>
        <title>Real RNA-seq data</title>
        <p>The first real RNA-seq dataset includes 384 cells from a triple-negative breast cancer cell line (MDA-MB-231), half of which were treated with metformin. Two independent cell batches were captured and prepared using the Fluidigm C1 system with 96-well plate. Each batch consists of 96 treated cells and 96 untreated cells. For batch 1, two Illumina HiSeq 2500 machines are used for sequencing of the treated and control cells separately. For batch 2 the order of machines is reversed. The length of sequence reads is 100 bp. We remove samples with 0 cells; the library sizes of the rest of the samples range from 1 to 10 million.</p>
        <p>A second real RNA-seq dataset with qPCR validated expression is obtained from the Sequencing Quality Control Consortium (SEQC) project (<xref rid="btz640-B17" ref-type="bibr">Su <italic toggle="yes">et al.</italic>, 2014</xref>). The dataset includes two RNA samples: sample A (universal human reference tissue, UHRR) and sample B (human brain tissue, HBRR). Replicates of these two samples were distributed to multiple laboratory sites for RNA-seq library construction and read sequencing. We select four replicates for each sample which were sequenced at the official sequencing site at Beijing Genomics Institute (BGI). The reads were sequenced using Illumina HiSeq 2000 and can be downloaded from the Sequence Read Archive (SRA). For sample A, the accession numbers of the four replicates are SRR896664, SRR896679, SRR896695 and SRR896711; for sample B they are SRR896743, SRR896759, SRR896775 and SRR896791. We also download another set of RNA-seq data sequenced by the SOLiD 5500 platform. For sample A, the accession numbers of the four replicates are SRR898783, SRR898784, SRR898790 and SRR898803; for sample B they are SRR898887, SRR898847, SRR898848 and SRR898855. The expression at gene level has been quantified independently with RT-qPCR. The validation profile contains a total of 20 801 records for each sample, which is obtained from Gene Expression Omnibus (GEO). The GEO accession numbers of sample A and sample B are GSM1361812 and GSM1361813, respectively.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Method comparisons</title>
      <p>Many computational tools have been developed for isoform quantification in recent years (<xref rid="btz640-B26" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). To evaluate the performance of XAEM, we select four recent advanced tools and use their latest available versions, including Salmon v0.12.0 (<xref rid="btz640-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>), Kallisto v0.45.0 (<xref rid="btz640-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>), Sailfish v0.10.0 (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>) and Cufflinks v2.2.1 (<xref rid="btz640-B21" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2012</xref>). Cufflinks has been widely used for isoform-level expression quantification. Salmon, Kallisto and Sailfish implement the alignment-free approach that avoids precise alignments for isoform expression quantification. The latter three methods show superior performance in both speed and accuracy (<xref rid="btz640-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btz640-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>). The commands to run each method for both indexing and quantification are presented in Supplementary Section S6. As a measure of estimation accuracy, we calculate the absolute proportion error (APE) using the estimated expression value (E) divided by the true value (T) as shown in formula (9). For simulated data, we report the median error of each isoform across 100 simulated samples as the final APE:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 XAEM achieves higher accuracy compared with other methods in simulated data</title>
      <p>We start the evaluation of XAEM’s performance using the simulated datasets under two scenarios of read distribution, i.e. the uniform (without bias) and non-uniform (with bias) settings. Under the uniform setting we expect the methods to perform similarly, while we would expect some differences between methods under the non-uniform setting.</p>
      <sec>
        <label>3.1.1</label>
        <title>Uniform setting</title>
        <p>To get a comprehensive comparison, the isoforms are divided into three categories according to the source genes: (i) singletons, (ii) multiple isoforms excluding paralogs (‘non-paralogs group’) and (iii) multiple isoforms which are paralogs (‘paralogs group’). ‘Singletons’ are isoforms originating from the genes with only one isoform, while ‘multiple isoforms’ are those from genes with more than one isoform. Paralogs, which have been discussed in more detail in Section 2.2.3, are isoforms with extremely similar sequences, which are difficult to distinguish from each other. The expression estimation for singletons is trivial, simply counting the fragments aligned to the gene, but the quantification for multiple isoforms is more complex due to exon-sharing. There is a total of 14 446 singletons and 31 950 multiple isoforms, where 25 838 are non-paralogs and 6112 paralogs.</p>
        <p><xref rid="btz640-T2" ref-type="table">Table 2A</xref> shows that the median APE of each quantification method for the uniform RNA-seq data. For the singleton group, the median error of XAEM, Salmon, Kallisto and Sailfish is 0, indicating these methods estimate the expression accurately. Cufflinks has the worst performance with an APE at 0.28. For the non-paralog group, XAEM and Salmon have a median APE at 0.18, which is slightly better than Kallisto and Sailfish (0.20). For the comparison of the paralog group, we keep the default output of each method, which means the paralogs are merged in XAEM, but remain as separate isoforms in the other methods. So this is not exactly a fair comparison, but it is given only to illustrate the problem of not considering the paralog information. <xref rid="btz640-T2" ref-type="table">Table 2A</xref> shows that XAEM has a median APE of 0.12 for paralogs, significantly better than that of all the other methods (≥0.45). The comparison shows the value of discovering the sets of paralogs and their expressions, and the difficulty of estimating the expression of the individual members of the paralogs.
</p>
        <table-wrap position="float" id="btz640-T2">
          <label>Table 2.</label>
          <caption>
            <p>Comparison of median absolute proportion error (APE) between XAEM, Salmon, Kallisto, Sailfish and Cufflinks</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
              <col align="char" char="." valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1"/>
                <th colspan="2" rowspan="1">Multiple isoforms<hr/></th>
              </tr>
              <tr>
                <th rowspan="1" colspan="1">Methods</th>
                <th rowspan="1" colspan="1">Singletons</th>
                <th rowspan="1" colspan="1">Non-paralogs</th>
                <th rowspan="1" colspan="1">Paralogs</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">(A) Uniform</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=14 446)</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=25 838)</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=6112)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">XAEM</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.18</td>
                <td rowspan="1" colspan="1">0.12</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Salmon</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.18</td>
                <td rowspan="1" colspan="1">0.45</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Kallisto</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.20</td>
                <td rowspan="1" colspan="1">0.47</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Sailfish</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.20</td>
                <td rowspan="1" colspan="1">0.47</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Cufflinks</td>
                <td rowspan="1" colspan="1">0.28</td>
                <td rowspan="1" colspan="1">0.36</td>
                <td rowspan="1" colspan="1">0.54</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">(B) Non-uniform</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=14 446)</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=18 597)</td>
                <td align="left" rowspan="1" colspan="1">(<italic toggle="yes">N</italic>=13 353)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">XAEM</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.37</td>
                <td rowspan="1" colspan="1">0.15</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Salmon</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.42</td>
                <td rowspan="1" colspan="1">0.966</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Kallisto</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.44</td>
                <td rowspan="1" colspan="1">0.969</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Sailfish</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0.45</td>
                <td rowspan="1" colspan="1">0.968</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Cufflinks</td>
                <td rowspan="1" colspan="1">0.45</td>
                <td rowspan="1" colspan="1">0.69</td>
                <td rowspan="1" colspan="1">0.970</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn2">
              <p><italic toggle="yes">Note</italic>: The isoforms are divided into three categories: singletons, multiple isoforms with non-paralogs and paralogs. The errors are calculated under (A) uniform setting and (B) non-uniform setting.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Non-uniform setting</title>
        <p>We also compare the performance of XAEM and other methods under the non-uniform setting in <xref rid="btz640-T2" ref-type="table">Table 2B</xref>. Similar to the uniform setting, XAEM, Salmon, Kallisto and Sailfish achieve high accuracy for the trivial group of singletons with zero median APE. However, for the multiple isoforms, all methods produce worse results under the non-uniform setting. For the non-paralogs group, XAEM achieves the best performance (median APE = 0.37). The median APE of Salmon, Kallisto, Sailfish and Cufflinks are 0.42, 0.44, 0.45 and 0.69, respectively. For the paralogs group, the median APE of XAEM is 0.15, which is significantly lower than the other methods. From <xref rid="btz640-T2" ref-type="table">Table 2</xref> we observe that Salmon, Kallisto and Sailfish have really similar performance; this is in agreement with the comparison results from another recent study (<xref rid="btz640-B26" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). We compare the correlations between the true values and estimated values for different methods. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>, XAEM estimates have a higher correlation with the true values for non-paralogs and paralogs.</p>
        <p>We note that the number of non-paralogs (18 597) and paralogs (13 353) are different from the uniform setting. In XAEM we update the X matrix to learn the bias structure from the observed data. For different datasets, i.e. uniform and non-uniform, the biases are not the same, leading to different X matrices. Thus, the final X matrix might be different for different input datasets. When we merge the paralogs within the updated X matrix, the number of paralogs might vary between datasets. Compared to Salmon, XAEM achieves higher accuracy in 71% of the multiple isoforms (22 740 out of 31 950). <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2a</xref> shows the comparison for the non-paralogs group. For the paralogs group, the out-performance of XAEM can be clearly observed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2b</xref>. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>, we calculate an error ratio using the APE of XAEM against Salmon for the 8933 multiple-isoform CRPs. The result also shows that XAEM has higher accuracy for the multiple isoforms. With the true values available, we find that for some paralogs, Salmon, Kallisto and Sailfish assign the total read counts from the member isoforms to only one isoform, which leads to an inferior estimation. In Supplementary Section S7, we show an example that Salmon and Kallisto allocate the total reads of paralogs NR_120496 and NR_120497 to only NR_120497, while for NR_120496 it is zero. We use the BLAST tool to compare their sequence composition (<xref rid="btz640-B27" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2000</xref>). The alignment shows that there are 112 bp discrepancies between these two paralogs, which means they are not the same isoforms. It is unclear how Salmon and Kallisto distribute the reads to the member of a paralog set even that they have different sequences.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 XAEM outperforms other methods in qPCR-validated data</title>
      <p>The SEQC study (<xref rid="btz640-B17" ref-type="bibr">Su <italic toggle="yes">et al.</italic>, 2014</xref>) provides a unique resource of RNA-seq data with qPCR values available for independent validation. Since the validated expression values are at gene level, we first convert the expression to gene level by adding up the expression at isoform level. We calculate the correlation between the estimates and true values, and use the median absolute correlation as the measurement for each method. As shown in <xref rid="btz640-T3" ref-type="table">Table 3A and B</xref>, the correlations of XAEM, Salmon, Kallisto and Sailfish are similar (all 0.85 for Illumina and ∼0.8 for SOLiD). This is possibly due to the comparison is done at gene level, by which there is no advantage for any of these methods. In these comparisons Cufflinks performs poorly.
</p>
      <table-wrap position="float" id="btz640-T3">
        <label>Table 3.</label>
        <caption>
          <p>Correlation at gene level between qPCR-validated values and estimates from different methods</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
            <col align="char" char="." valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">XAEM</th>
              <th rowspan="1" colspan="1">Salmon</th>
              <th rowspan="1" colspan="1">Kallisto</th>
              <th rowspan="1" colspan="1">Sailfish</th>
              <th rowspan="1" colspan="1">Cufflinks</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">(A) Illumina data</td>
              <td rowspan="1" colspan="1">0.85</td>
              <td rowspan="1" colspan="1">0.85</td>
              <td rowspan="1" colspan="1">0.85</td>
              <td rowspan="1" colspan="1">0.85</td>
              <td rowspan="1" colspan="1">0.22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(B) SOLiD data</td>
              <td rowspan="1" colspan="1">0.82</td>
              <td rowspan="1" colspan="1">0.80</td>
              <td rowspan="1" colspan="1">0.80</td>
              <td rowspan="1" colspan="1">0.80</td>
              <td rowspan="1" colspan="1">0.23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(C) Illumina versus SOLiD</td>
              <td rowspan="1" colspan="1">0.73</td>
              <td rowspan="1" colspan="1">0.62</td>
              <td rowspan="1" colspan="1">0.62</td>
              <td rowspan="1" colspan="1">0.62</td>
              <td rowspan="1" colspan="1">0.19</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic toggle="yes">Note</italic>: (A) The correlation is calculated using the estimates from Illumina RNA-seq data. (B) The correlation is calculated using the SOLiD data. (C) Agreement between estimates using Illumina data and SOLiD data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We also compare the agreement between the estimates using Illumina data and SOLiD data for different methods. As shown in <xref rid="btz640-T3" ref-type="table">Table 3C</xref>, the correlation for XAEM is 0.73 at gene level, while for Salmon, Kallisto, Sailfish and Cufflinks they are 0.62, 0.62, 0.62 and 0.19, respectively. Since there are potentially different biases between Illumina and SOLiD platforms, the results indicate that the bias correction in XAEM is better than the other methods.</p>
      <p>The SEQC project provides the qPCR primer sequence data. Some primers map uniquely to single isoforms, so these can be used to compare the methods at isoform level. We obtain the qPCR primer sequences and map them to the isoforms using Rapmap (<xref rid="btz640-B15" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2016</xref>). Since all methods perform similarly for singleton genes, we first select 2540 qPCR primers that map uniquely to single isoforms in multiple-isoform genes. However, unique <italic toggle="yes">in-silico</italic> mapping to an isoform is not sufficient to guarantee biologically specific binding, since this isoform may also bind to other primers. In the terminology of Section 2, it might be a neighbor of other isoforms, thus increasing the chance of non-specific binding. So, to increase specificity, we add an extra requirement that the isoform does not appear in the equivalent classes of other primers. This reduces the number of uniquely mapped isoforms to 331. For this subset, the correlations between the qPCR values and XAEM, Salmon, Sailfish, Kallisto and Cufflinks estimates are 0.84, 0.81, 0.81, 0.81 and 0.18, respectively. The results show a slight advantage of XAEM over the other methods at isoform level.</p>
    </sec>
    <sec>
      <title>3.3 XAEM outperforms other methods in differential-expression analysis of real scRNA-seq data</title>
      <p>Differential expression analysis is a common downstream analysis following isoform quantification. Here we compare the control versus treated groups in the MDA-MB-231 scRNA-seq dataset for the analysis. Since there is no gold standard to assess the power of detection of the differentially expressed (DE) isoforms, we perform the analysis in a training set and then validate the results in an independent validation set. We use two different settings: (i) a simple setting, where the training and validation sets are random splits within one batch; and (ii) a more demanding setting, where we use batch 1 data for training and batch2 data for validation.</p>
      <p>To assess different methods, we calculate the rediscovery rate (RDR), which is the proportion of significant DE isoforms from the training set that are also significant in the validation set (Ganna <italic toggle="yes">et al.</italic>, 2014). Since the quantification accuracy of Salmon, Sailfish and Kallisto is similar (<xref rid="btz640-B26" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>), here we select Salmon, Cufflinks and XAEM for comparison. A counts-per-million (CPM) value is calculated to standardize the raw read count, which is then log scaled and normalized by the median CPM. The expression levels between the control and treated groups are compared using t-test with a threshold of <italic toggle="yes">P</italic>-value &lt;0.05. For each method, we take the top <italic toggle="yes">M</italic> statistically significant DE isoforms observed from the training set to the validation set and calculate the RDR. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, we first show that the RDRs of all the methods are unbiased by performing the DE analysis under the null hypothesis. A completely inaccurate quantification method will generate mostly noise and have a low RDR ≈ 0.05; thus a higher RDR indicates better quantification (<xref rid="btz640-B5" ref-type="bibr">Ganna <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      <p>We first investigate results of DE analysis within the same batch, thus removing potential batch-related effects. This is done for both batch 1 and 2 separately. Here we show the results using batch 1, which contains 96 treated and 96 untreated cells. A total of 40 treated and 40 control samples are randomly selected from batch 1 to generate the training set, then <italic toggle="yes">a different set of 40 treated and 40 control samples are selected for the validation set.</italic> To avoid the effect of randomness in the selection of training and validation sets, the whole analysis procedure is repeated 50 times. The RDR is calculated by comparing the top 100, 500 and 1000 DE isoforms from the training set with all the significant DE isoforms from the validation set. We exclude the paralogs in the comparisons since Salmon and Cufflinks can have poor estimates; the result for paralogs is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>. <xref rid="btz640-F3" ref-type="fig">Figure 3a and b</xref> show the results using the samples from batch 1. In <xref rid="btz640-F3" ref-type="fig">Figure 3a</xref> all methods are run without bias correction. For XAEM, this means that the <italic toggle="yes">X</italic> matrix is not updated. <xref rid="btz640-F3" ref-type="fig">Figure 3a</xref> shows that the methods perform similarly without bias correction, and the performance of Salmon is even slightly worse than Cufflinks.
</p>
      <fig position="float" id="btz640-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Detection and validation of differentially expressed (DE) isoforms using the MDA-MB-231 scRNA-seq dataset. XAEM, Salmon and Cufflinks are presented in blue-solid, red-dashed and grey-dotted lines, respectively. The x-axis shows the number of top DE isoforms in the training set; the y-axis is the proportion of rediscovery in the validation set. The rediscovery rate (RDR) is calculated by comparing the top 100, 500 and 1000 DE isoforms from the training set with all the significant DE isoforms from the validation set. The boxplots show the RDR from 50 times’ run. (<bold>a</bold>) Both training set and validation set are constructed using cells from batch 1. The quantification of XAEM, Salmon and Cufflinks is performed without bias correction. (<bold>b</bold>) The quantification from the three methods are bias-corrected. (<bold>c</bold>) The training set is constructed using cells from batch 1, while the validation set uses cells from batch 2. The RDR is calculated for only singleton isoforms. (<bold>d</bold>) The training set is constructed using cells from batch 1, and the validation set using cells from batch 2. The RDR is calculated using only non-paralogs. (Color version of this figure is available at <italic toggle="yes">Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bioinformatics_36_3_805_f3" position="float"/>
      </fig>
      <p>In <xref rid="btz640-F3" ref-type="fig">Figure 3b</xref>, the bias correction step is applied to all methods. For XAEM it means that the full AEM algorithm is used to estimate both the design matrix <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic>. <xref rid="btz640-F3" ref-type="fig">Figure 3b</xref> shows a notable improvement of the RDR in XAEM. For the top 100 DE isoforms, the RDRs for XAEM, Salmon and Cufflinks are 1.0, 0.56 and 0.50, respectively. Almost all the 100 DE isoforms from the training set are re-discovered in the validation set by XAEM, while only 56 are re-discovered using Salmon and 50 using Cufflinks. The same pattern can be observed from the results for batch 2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). For the top 500 DE isoforms, the RDR of XAEM is 0.73, which is higher than Salmon at 0.28 and Cufflinks at 0.26. The RDR decreases along the x-axis, which means that when the number of top DE isoforms increases, a smaller proportion of them can be validated from the training set to the validation set. Overall, the bias correction works well for XAEM. The results in <xref rid="btz640-F3" ref-type="fig">Figure 3b</xref> indicate that the bias correction by updating <italic toggle="yes">X</italic> matrix using the AEM algorithm is the key feature that makes XAEM achieve better performance.</p>
      <p>We further compare the performance across batches, which is harder to achieve. In the MDA-MB-231 dataset, the control and treated samples are separately sequenced in two different machines. In batch 1, the control samples are sequenced in machine 1, and the treated samples in machine 2. However, in batch 2, the machines are reversed: the control samples are sequenced in machine 2 and the treated samples in machine 1. Thus, there might be a machine effect between the two batches. We estimate the machine effect and remove it ahead of the differential-expression analysis. The details of this adjustment is illustrated in Supplementary Section S8. In this comparison we split the isoforms into two groups: (i) singletons, in which we do not expect a difference between methods, and (ii) multiple isoforms, which are non-paralogs. For each method, we calculate the RDR based on the top 100 to 1000 significant DE isoforms in the training set. <xref rid="btz640-F3" ref-type="fig">Figure 3c</xref> shows the result for the singletons. As expected, the RDRs of XAEM and Salmon are similar. This is in agreement with what we observe from <xref rid="btz640-T2" ref-type="table">Table 2</xref>, where the quantification of singletons is the same for these two methods. However, for multiple isoforms, <xref rid="btz640-F3" ref-type="fig">Figure 3d</xref> shows that XAEM achieves a much higher RDR than Salmon and Cufflinks. For the top 100 DE isoforms, the RDR for XAEM, Salmon and Cufflinks is 0.97, 0.38 and 0.32, respectively. The overall RDR across the top 100, 500 and 1000 DE isoforms of XAEM (0.77) is about three-fold higher than that in Salmon (0.26) and Cufflinks (0.22).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>We have developed a novel method called XAEM to estimate isoform expression from multiple RNA-seq samples. Compared to existing methods, which are implicitly based on a linear model <italic toggle="yes">Xβ</italic> with known <italic toggle="yes">X</italic>, XAEM is based on a more flexible and richer bilinear model that treats both <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> as unknown parameters. Instead of adding a correction step of presumed known biases, as is commonly done in existing methods, XAEM automatically corrects for potentially unknown biases using an AEM approach. The AEM makes use of the variation of expression from the multiple samples. XAEM also utilizes the state-of-the-art quasi-mapping to speed up the overall quantification of isoform expression. We have reported a test of computational resource usage of XAEM in Supplementary Section S9, which shows that XAEM is fast and memory efficient. Overall, we show that better statistical modelling helps XAEM achieve significantly better results in comparison with recent advanced methods in both simulated and real RNA-seq datasets.</p>
    <p>The key difference between XAEM and existing methods such as Sailfish is in the explicit formulation of the design matrix <italic toggle="yes">X</italic>. Technically, as done in existing methods, it is possible to perform the EM algorithm without knowing <italic toggle="yes">X</italic> explicitly. However, with such an approach, it is not obvious how to generalize the linear model into a much richer bilinear model as we have described. The existing methods also use a transcriptome-wide <italic toggle="yes">X</italic>, which would be too high-dimensional to treat as an unknown parameter. XAEM uses the concept of transcription clusters, thus breaking the transcriptome into smaller units; this limits the number of <italic toggle="yes">X</italic>-parameters substantially, and makes the procedure computationally and statistically feasible. The initial <italic toggle="yes">X</italic> matrix in XAEM is generated using uniform assumption. We have also investigated the effects using the biased assumptions. As shown in Supplementary Section S10, the results are similar to those based on the uniform assumption. We have used the VBEM algorithm inside XAEM, but in principle any version of EM algorithm can be used, e.g. the alternative squared-EM (<xref rid="btz640-B22" ref-type="bibr">Varadhan and Roland, 2008</xref>). Using other EM algorithms within XAEM is worth further investigations.</p>
    <p>The comparison in <xref rid="btz640-T2" ref-type="table">Table 2</xref> shows that XAEM achieves a better performance for the multiple isoforms. In this analysis we used the same simulation tool Polyester as we used to construct the X matrix. There might be some potential effects on the comparison analysis. However, as expected in the uniform case, XAEM performs similarly with Salmon for singletons and non-paralogs. This shows that there is no special advantage for XAEM in the simulation setup. In the comparison of the agreement between Illumina data and SOLiD data, XAEM achieves a higher correlation than the other methods. Given the potential differences of the biases between the two platforms, the result shows that XAEM has a better performance in the bias correction of real RNA-seq data.</p>
    <p>From the comparison we also see the difficulty to quantify the expression of individual paralogs. It is not obvious how paralogs should be used in pathway enrichment analysis; this merits further studies. As XAEM reports the complete set of paralogs, users can try out several methods. For example, suppose there is a merged paralog involving three genes: A, B and C. If there is a pathway involving any of these genes, say gene C, then we might consider using the total paralog-level expression for this gene, or the average expression (total/3). Without the paralog information, we do not have this option, and may unknowingly use inappropriate expression value. The merging of paralogs in XAEM at least makes the quantification process transparent.</p>
    <p>In principle XAEM can be used for any bilinear model <italic toggle="yes">μ</italic> = <italic toggle="yes">Xβ</italic>, which, for example, looks appropriate to the data from tiling microarrays. As before, <italic toggle="yes">β</italic> represents the underlying transcript intensity; <italic toggle="yes">μ</italic> represents the probe intensities; the <italic toggle="yes">X</italic> matrix represents the mapping of the set of transcripts that theoretically can contribute to each probe. The starting <italic toggle="yes">X</italic> matrix must be derived from the assumed gene model in the transcriptome annotation file rather than learned computationally as we have described. One weakness is that the gene model may not tell us much about paralogs, which will likely lead to a lot of non-specific binding. Mueckstein <italic toggle="yes">et al.</italic> present an improved thermodynamic model for microarray hybridization, which may allow assessment of non-specific binding due to the cross-hybridization among paralogs (<xref rid="btz640-B10" ref-type="bibr">Mueckstein <italic toggle="yes">et al.</italic>, 2010</xref>). Showing how this works in practice will be worth further investigations.</p>
    <p>Performances of XAEM depend on multiple samples for updating the design matrix <italic toggle="yes">X</italic>, so it is desirable to make XAEM more robust against sample heterogeneity. We can do this by extending the model to allow multiple <italic toggle="yes">X</italic> matrices within each gene (CRP); for example, we can start with a clustering step to the samples, and assign one <italic toggle="yes">X</italic> for each cluster. Theoretically, distinct <italic toggle="yes">X</italic> matrices should produce distinct vector spaces, and these are likely learnable from the observed count data. Developing such an extension is a worthy project, but beyond the scope of the current paper. For now, in practice we recommend the use of the algorithm in batches of reasonably homogenous samples such as the same tissue or cancer type.</p>
    <p>In summary, we have introduced XAEM, an efficient and accurate method to estimate isoform expression from multiple RNA-seq samples. Compared with other competing methods, XAEM achieves better performance in estimation accuracy and rediscovery rate of DE isoform from RNA-seq data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work is partially supported by funding from the Swedish Cancer Fonden, the Swedish Research Council (VR), the Swedish Foundation for Strategic Research (SSF) and China Scholarship Council (CSC).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btz640_Supplementary_Data</label>
      <media xlink:href="bioinformatics_36_3_805_s4.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz640-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bray</surname>
 <given-names>N.L.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>525.</fpage><pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Christofk</surname>
 <given-names>H.R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2008</year>) 
<article-title>The m2 splice isoform of pyruvate kinase is important for cancer metabolism and tumour growth</article-title>. <source>Nature</source>, <volume>452</volume>, <fpage>230.</fpage><pub-id pub-id-type="pmid">18337823</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dobin</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Star: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazee</surname>
 <given-names>A.C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2778</fpage>–<lpage>2784</lpage>.<pub-id pub-id-type="pmid">25926345</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ganna</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Rediscovery rate estimation for assessing the validation of significant findings in high-throughput studies</article-title>. <source>Brief. Bioinf</source>., <volume>16</volume>, <fpage>563</fpage>–<lpage>575</lpage>.</mixed-citation>
    </ref>
    <ref id="btz640-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname>
 <given-names>H.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>W.H.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>Statistical inferences for isoform expression in RNA-seq</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1026</fpage>–<lpage>1032</lpage>.<pub-id pub-id-type="pmid">19244387</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Hisat: a fast spliced aligner with low memory requirements</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>357.</fpage><pub-id pub-id-type="pmid">25751142</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonsdale</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>580.</fpage><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mortazavi</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2008</year>) 
<article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title>. <source>Nat. Methods</source>, <volume>5</volume>, <fpage>621</fpage>–<lpage>628</lpage>.<pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mueckstein</surname>
 <given-names>U.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2010</year>) 
<article-title>Hybridization thermodynamics of nimblegen microarrays</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>35.</fpage><pub-id pub-id-type="pmid">20085625</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nariai</surname>
 <given-names>N.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Tigar: transcript isoform abundance estimation method with gapped alignment of RNA-seq data by variational Bayesian inference</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2292</fpage>–<lpage>2299</lpage>.<pub-id pub-id-type="pmid">23821651</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname>
 <given-names>R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>462.</fpage><pub-id pub-id-type="pmid">24752080</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname>
 <given-names>R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>417.</fpage><pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Improving RNA-seq expression estimates by correcting for fragment bias</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R22.</fpage><pub-id pub-id-type="pmid">21410973</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Rapmap: a rapid, sensitive and accurate tool for mapping RNA-seq reads to transcriptomes</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i192</fpage>–<lpage>i200</lpage>.<pub-id pub-id-type="pmid">27307617</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinberg</surname>
 <given-names>S.F.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>Structural basis of protein kinase c isoform function</article-title>. <source>Physiol. Rev</source>., <volume>88</volume>, <fpage>1341</fpage>–<lpage>1378</lpage>.<pub-id pub-id-type="pmid">18923184</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname>
 <given-names>Z.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the sequencing quality control consortium</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>903</fpage>.<pub-id pub-id-type="pmid">25150838</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suo</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>Joint estimation of isoform expression and isoform-specific read distribution using multisample RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>506</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">24307704</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>Tophat: discovering splice junctions with RNA-seq</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1105</fpage>–<lpage>1111</lpage>.<pub-id pub-id-type="pmid">19289445</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2010</year>) 
<article-title>Transcript assembly and quantification by RNA-seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat. Biotechnol</source>., <volume>28</volume>, <fpage>511.</fpage><pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2012</year>) 
<article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and cufflinks</article-title>. <source>Nat. Protoc</source>., <volume>7</volume>, <fpage>562</fpage>–<lpage>578</lpage>.<pub-id pub-id-type="pmid">22383036</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Varadhan</surname>
 <given-names>R.</given-names></string-name>, <string-name><surname>Roland</surname><given-names>C.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>Simple and globally convergent methods for accelerating the convergence of any EM algorithm</article-title>. <source>Scand. J. Stat</source>., <volume>35</volume>, <fpage>335</fpage>–<lpage>353</lpage>.</mixed-citation>
    </ref>
    <ref id="btz640-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vu</surname>
 <given-names>T.N.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Beta-Poisson model for single-cell RNA-seq data analyses</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2128</fpage>–<lpage>2135</lpage>.<pub-id pub-id-type="pmid">27153638</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weinstein</surname>
 <given-names>J.N.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>The cancer genome atlas pan-cancer analysis project</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>1113.</fpage><pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>
 <given-names>A.R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>Quantitative assessment of single-cell RNA-sequencing methods</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>41</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">24141493</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Evaluation and comparison of computational tools for RNA-seq isoform quantification</article-title>. <source>BMC Genomics</source>, <volume>18</volume>, <fpage>583.</fpage><pub-id pub-id-type="pmid">28784092</pub-id></mixed-citation>
    </ref>
    <ref id="btz640-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>
 <given-names>Z.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2000</year>) 
<article-title>A greedy algorithm for aligning DNA sequences</article-title>. <source>J. Comput. Biol</source>., <volume>7</volume>, <fpage>203</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">10890397</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
