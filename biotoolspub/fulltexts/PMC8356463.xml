<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8356463</article-id>
    <article-id pub-id-type="publisher-id">2429</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02429-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAAPER: model-based analysis of alternative polyadenylation using 3′ end-linked reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2087-2709</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Wei Vivian</given-names>
        </name>
        <address>
          <email>vivian.li@rutgers.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Dinghai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ruijia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tian</surname>
          <given-names>Bin</given-names>
        </name>
        <address>
          <email>btian@wistar.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.430387.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8796</institution-id><institution>Department of Biostatistics and Epidemiology, </institution><institution>Rutgers School of Public Health, Rutgers, The State University of New Jersey, </institution></institution-wrap>Piscataway, NJ 08854 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430387.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8796</institution-id><institution>Department of Microbiology, Biochemistry and Molecular Genetics, </institution><institution>Rutgers New Jersey Medical School, </institution></institution-wrap>Newark, NJ 07103 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.251075.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 6678</institution-id><institution>Program in Gene Expression and Regulation, and Center for Systems and Computational Biology, </institution><institution>The Wistar Institute, </institution></institution-wrap>Philadelphia, PA 19104 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>222</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Most eukaryotic genes express alternative polyadenylation (APA) isoforms. A growing number of RNA sequencing methods, especially those used for single-cell transcriptome analysis, generate reads close to the polyadenylation site (PAS), termed <italic>nearSite</italic> reads, hence inherently containing information about APA isoform abundance. Here, we present a probabilistic model-based method named MAAPER to utilize nearSite reads for APA analysis. MAAPER predicts PASs with high accuracy and sensitivity and examines different types of APA events with robust statistics. We show MAAPER’s performance with both bulk and single-cell data and its applicability in unpaired or paired experimental designs.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02429-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Alternative polyadenylation</kwd>
      <kwd>RNA sequencing</kwd>
      <kwd>Bioinformatic tool</kwd>
      <kwd>3′ end reads</kwd>
      <kwd>Cellular stress</kwd>
      <kwd>Trophoblasts</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM084089</award-id>
        <award-id>R01GM129069</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tian</surname>
            <given-names>Bin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>New Jersey Alliance for Clinical and Translational Science</institution>
        </funding-source>
        <award-id>UL1TR0030117</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Wei Vivian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100011132</institution-id>
            <institution>Rutgers, The State University of New Jersey</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Busch Biomedical Grant</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Wei Vivian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Well over half of the eukaryotic protein-coding genes and many long non-coding genes harbor multiple cleavage and polyadenylation sites, or PASs, resulting in expression of alternative polyadenylation (APA) isoforms [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. While most of the APA events occur in the 3′-most exon of genes, leading to isoforms with variable 3′ untranslated regions (3′UTRs), a sizable fraction of APA sites, e.g., ~20% in the human genome, are located in regions upstream of the last exon, almost exclusively in introns. Intronic polyadenylation (IPA) leads to alternation of coding sequence (CDS) as well as 3′UTR. APA is increasingly being appreciated as a major mechanism for gene regulation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], diversifying the transcriptome in different cell types and under various pathological and physiological conditions. Accurate and sensitive profiling of APA isoforms is of great importance in understanding the mechanisms and consequences of APA and can have diagnostic values in clinical settings [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">The advent of RNA sequencing (RNA-seq) technologies has enabled comprehensive transcriptome analysis. RNA-seq data have also been used to examine APA isoform profiles, either by taking advantage of RNA-seq read coverage changes at the PASs [<xref ref-type="bibr" rid="CR4">4</xref>] or by using annotated PASs [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. However, because regular RNA-seq data are not designed to identify PASs, these approaches lack high accuracy and sensitivity for PAS identification and APA profiling.</p>
    <p id="Par4">RNA sequencing methods that generate reads biased to the 3′ end of transcripts, collectively called 3′ end sequencing, are increasingly being used to study gene expression in bulk RNA samples or in single cells [<xref ref-type="bibr" rid="CR8">8</xref>]. Some methods generate reads that end at the PASs, such as PAS-seq [<xref ref-type="bibr" rid="CR9">9</xref>], PolyA-seq [<xref ref-type="bibr" rid="CR10">10</xref>], 3′-seq [<xref ref-type="bibr" rid="CR11">11</xref>], and QuantSeq REV [<xref ref-type="bibr" rid="CR12">12</xref>]. For simplicity, we name those reads <italic>onSite</italic> reads. As such, the PASs can be directly identified after mapping the reads to the reference genome (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). While straightforward for PAS identification, these methods typically require a custom primer containing an oligo(T) region for sequencing [<xref ref-type="bibr" rid="CR12">12</xref>], limiting their applications. By contrast, some other methods generate reads that are close to but do not necessarily contain the PASs, such as QuantSeq FWD [<xref ref-type="bibr" rid="CR12">12</xref>] and PAT-seq [<xref ref-type="bibr" rid="CR13">13</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). For simplicity, those reads are named <italic>nearSite</italic> reads. Conceivably, nearSite reads are “3′ end-linked”, because they contain information about the PAS positions. Notably, several 3′ end counting protocols used in single-cell RNA sequencing (scRNA-seq), such as 10x Genomics [<xref ref-type="bibr" rid="CR14">14</xref>] and Drop-Seq [<xref ref-type="bibr" rid="CR15">15</xref>], also generate nearSite reads [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. As such, the number of nearSite read data sets has increased drastically in recent years because of the rapid adoption of scRNA-seq methods. However, mining nearSite reads for APA analysis has hitherto been limited due to lack of suitable methods. The major challenge of using nearSite reads for APA analysis is accurate assignment of reads to specific PASs. Here we present a computational method named MAAPER (<underline>m</underline>odel-based <underline>a</underline>nalysis of <underline>a</underline>lternative <underline>p</underline>olyadenylation using 3′ <underline>e</underline>nd-linked <underline>r</underline>eads), which accurately assigns nearSite reads to PASs through statistical modeling and generates multiple statistics for APA analysis.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the MAAPER method. <bold>A</bold> A schematic illustrating the generation of <italic>nearSite</italic> reads (e.g., QuantSeq FWD, 10x Genomics) and <italic>onSite</italic> reads (e.g., QuantSeq REV). <bold>B</bold> Outline of the MAAPER method. MAAPER takes aligned <italic>nearSite</italic> reads and a PAS database (polyA_DB) and outputs predicted PAS positions and APA analysis results. Two APA metrics are generated, namely, relative expression difference (RED) and relative lengthen difference (RLD)</p></caption><graphic xlink:href="13059_2021_2429_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Design of MAAPER</title>
      <p id="Par5">While nearSite reads do not directly map to PASs, they inherently contain information about the PASs that give rise to the reads. We reasoned that the distance between the 5′ end of a nearSite read and PAS reflects the cDNA fragment size of a sequencing library and thus could be statistically modeled. We further reasoned that genes containing only a single PAS would provide a clear picture for studying the read-PAS relationship, and the derived information can be useful to examine genes containing multiple PASs. To these ends, we developed a strategy to first predict PASs (stage 1) and then use them for APA analysis (stage 2). We named our method MAAPER (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B).</p>
      <p id="Par6">At the PAS prediction stage, MAAPER first uses genes that contain only a single PAS to learn the distribution of read-PAS distance (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). PolyA_DB database, a comprehensive PAS database we previously constructed [<xref ref-type="bibr" rid="CR18">18</xref>], is used to identify those genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). It is worth noting that the current version (v3) of PolyA_DB contains PASs identified by the highly accurate 3′ end sequencing method, 3′ end extraction and sequencing (3′READS) [<xref ref-type="bibr" rid="CR19">19</xref>], ensuring data quality. Statistical learning is carried out with a Gaussian kernel function for non-parametric estimation of read-PAS distances, which captures the distributional characteristic of the distances without assuming data uniformness. Next, based on the learned read-PAS relationship, a likelihood model predicts PASs for each nearSite read mapped to a given gene. As such, each read has a set of probability scores indicating the likelihood for all PASs of the gene annotated in PolyA_DB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2).</p>
      <p id="Par7">At the APA analysis stage, MAAPER uses the predicted PASs for quantitative analysis of APA difference between samples (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). For each gene, the expression of a given PAS is based on the proportion of corresponding RNA isoform in a sample. Two types of statistics are generated, relative expression difference (RED) and relative length difference (RLD). With RED, the relative abundance of two APA isoforms with the greatest change in expression levels are compared across samples. With RLD, the relative lengths of all APA isoforms weighted by expression levels are compared across samples. These two scores are generated for 3′UTR APA and intronic APA, separately (see below and the “<xref rid="Sec10" ref-type="sec">Materials and methods</xref>” section).</p>
      <p id="Par8">To generate <italic>P</italic> values, MAAPER uses a likelihood ratio test (LRT) to determine if a gene’s overall PAS profile differs between samples and a Fisher’s exact test is used to determine if two selected PAS differ in their isoform abundance between samples. Both paired and unpaired tests are available (see below and the “<xref rid="Sec10" ref-type="sec">Materials and methods</xref>” section).</p>
    </sec>
    <sec id="Sec4">
      <title>Accurate and sensitive PAS prediction by MAAPER</title>
      <p id="Par9">To aid in MAAPER development, we used the QuantSeq FWD method to generate nearSite read data from mouse NIH3T3 cells under four conditions, namely, nontreated cells (NT), cells treated with arsenite stress (AS), and cells recovered from AS treatment for 4 or 8 h (RC4 or RC8, respectively) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, see the “<xref rid="Sec10" ref-type="sec">Materials and methods</xref>” section for detail). We chose these four conditions because we previously found substantial APA changes across these conditions [<xref ref-type="bibr" rid="CR20">20</xref>]. We generated ~28 million (M) mapped reads per sample (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For comparison and validation, we subjected the same RNA samples to sequencing by QuantSeq REV, a method that generates onSite reads. Importantly, QuantSeq FWD and REV methods have the same protocols except for the sequencing step, allowing us to compare nearSite reads and onSite reads more accurately without technical noise coming from variations in sample acquisition or processing.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Accurate and sensitive PAS prediction by MAAPER. <bold>A</bold> Schematic of experimental design using QuantSeq FWD (QS-FWD) and QuantSeq REV (QS-REV) to examine APA in NIH3T3 cells treated with arsenic stress (AS) or undergoing recovery for 4 h (RC4) or 8 h (RC8) after AS. NT, non-treated cells. <bold>B</bold> Left, distribution of read-PAS distances based on genes with a single PAS. Right, as in the left plot, except that genes are divided into &gt;400 nt (top) and ≤400 nt (bottom) groups. <bold>C</bold> Number of genes with a varying number of predicted PASs by MAAPER from the QS-FWD data. Bars denote the average gene number across all samples, and error bars denote SD. <bold>D</bold> Proportions of predicted PASs and QS-FWD reads based on their genomic positions. Proportions are averaged across all samples. <bold>E</bold> Precision rates of MAAPER’s PAS prediction for genes with a varying number of PASs. Bars denote the average precision across all samples. Error bars denote SD. <bold>F</bold> Proportions of four types of reads based on PAS prediction by MAAPER as well PAS identification by using QS-REV data. Mean and SD are based on all samples. <bold>G</bold> Nucleotide frequencies around three types of predicted PASs listed in <bold>F</bold></p></caption><graphic xlink:href="13059_2021_2429_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">Using the nearSite reads from QuantSeq FWD, we detected 7870 genes on average from all four samples. Of these, 361 were annotated as single-PAS genes in the PolyA_DB database [<xref ref-type="bibr" rid="CR18">18</xref>], which we then focused on for modeling of the read-PAS distance. Interestingly, we found that read-PAS distance had two modes, one centered around 190 nucleotides (nt) from the PAS and another 250 nt from the PAS. Further analysis indicated that the 250-nt peak came from short genes (≤400 nt) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). Therefore, we only used the first peak to represent read-PAS distribution in our analysis.</p>
      <p id="Par11">On average, 44.3% of the genes had a single PAS with detectable expression in the four samples and 34.4%, 13.9%, and 7.4% had 2, 3, and &gt;3 PASs detected, respectively (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). These numbers are consistent across all four samples, with a standard deviation (SD) of 3.9%, 1.1%, 1.3%, and 0.4%, respectively. Of all the predicted PASs, 89.3% were in the 3′-most exons (including single-exon genes) and 8.6% were in introns (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, left), corresponding to 91.4% and 6.0%, respectively, of all read numbers (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, right).</p>
      <p id="Par12">We next used the onSite reads from QuantSeq REV to validate the predicted PASs, based on the 3′-most position of each read. Because data were generated from the same samples, the onSite reads practically served as an <italic>ad hoc</italic> PAS database in the same biological context, in lieu of PolyA_DB. With the 11 M mapped onSite reads from QuantSeq REV (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), we identified ~16 thousand (K) PASs in the four samples. Using these PASs, we calculated precision and recall rates, with precision being defined as the percentage of PASs identified by nearSite reads that matched those by onSite reads, and recall as the percentage of PASs identified by onSite reads that matched those by nearSite reads. MAAPER achieved an overall precision of 90.7% (SD = 2.0%) across the four samples, and 87.2–100% for genes with different numbers of PAS (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E); the overall recall for all genes was 75.5% (SD = 2.5%), and 81.9% (SD = 1.7%) for genes with ≤3 PASs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3A-C).</p>
      <p id="Par13">We found that the PASs identified by both onSite reads and MAAPER (“MAAPER &amp; QS-REV,” 84.9% of nearSite reads) and PASs that were identified by MAAPER only (“MAAPER only,” 3.9% of nearSite reads) showed similar nucleotide profiles around the PASs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F, G and Additional file 1: Figure S<xref rid="MOESM1" ref-type="media">4</xref>), with upstream A-rich and downstream U-rich peaks that are characteristic of PASs [<xref ref-type="bibr" rid="CR21">21</xref>]. By contrast, the PASs identified by onSite reads but not by MAAPER (“QS-REV only,” 5.7% of nearSite reads) showed A-rich peaks both in upstream and downstream regions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>G and Additional file 1: Figure S<xref rid="MOESM1" ref-type="media">4</xref>). These results indicate that “QS-REV only” reads were likely to have been generated by priming of oligo(dT) at internal A-rich sequences instead at the poly(A) tail, a problem known as <italic>internal priming</italic>. The internal priming issue is commonly associated with methods using oligo(dT) for cDNA construction [<xref ref-type="bibr" rid="CR22">22</xref>], but is well addressed in methods that do not depend on oligo(dT) for making cDNAs, such as 3′READS [<xref ref-type="bibr" rid="CR19">19</xref>]. Because PolyA_DB database v3 contains 3′READS-mapped PASs only, the PASs predicted by MAAPER are not affected by the internal priming issue (Fig. <xref rid="Fig2" ref-type="fig">2</xref>G). As expected, MAAPER achieved an even higher overall recall of 86.6% (SD = 2.0%) after the “QS-REV only” reads were excluded (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3D-F).</p>
    </sec>
    <sec id="Sec5">
      <title>Differential APA analysis by MAAPER</title>
      <p id="Par14">MAAPER examines two types of APA, i.e., 3′UTR APA and intronic APA (illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A), separately. MAAPER produces REDu and RLDu scores for 3′UTR APA, and REDi and RLDi scores for intronic APA. REDu measures the relative expression levels between the top two most differentially expressed isoforms in the 3′-most exon only, and RLDu measures the relative 3′UTR size change based on all PASs in the 3′-most exon. By contrast, REDi measures the relative expression levels between the top differentially expressed isoform in the 3′-most exon and the top differentially expressed isoform in an intron or middle exon. RLDi measures the relative pre-mRNA size change when there are intronic PASs (all PASs upstream of the last exon are included, see the “<xref rid="Sec10" ref-type="sec">Materials and methods</xref>” section for detail).
<fig id="Fig3"><label>Fig. 3.</label><caption><p>Differential APA analysis by MAAPER using QuantSeq FWD data. <bold>A</bold> Schematic illustrating the calculation of relative expression difference (RED) and relative length difference (RLD) scores. REDu and RLDu are for 3′UTR APA, whereas REDi and RLDi are for intronic APA. ORF, open reading frame. <bold>B</bold> Distribution of -log<sub>10</sub>(FDR-adjusted <italic>P</italic>) in differential APA analysis. The plotted data are based on the average across all samples. The adjusted <italic>P</italic> = 0.01 was used as a threshold to identify significant APA events. <bold>C</bold> Distributions of REDu (left) and RLDu (right) scores calculated for AS, RC4, and RC8 samples compared with NT. Only genes that showed significant APA changes in at least one sample were included. <bold>D</bold> Read coverage and PAS prediction results for the gene <italic>Nmt1.</italic>
<bold>E</bold> Distributions of REDi (left) and RLDi (right) scores calculated for AS, RC4, and RC8 samples compared with NT. Only genes that showed significant APA changes in at least one sample were included. <bold>F</bold> Read coverage and PAS prediction results for the gene <italic>Zfp444</italic></p></caption><graphic xlink:href="13059_2021_2429_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">Using FDR-adjusted <italic>P</italic> value = 0.01 as the threshold, we identified significant APA events in AS, RC4, or RC8 samples compared with the NT sample (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). In line with our previous findings [<xref ref-type="bibr" rid="CR20">20</xref>], AS, RC4, and RC8 samples all displayed preferential expression of isoforms using proximal PASs compared with distal PASs in 3′UTRs (median REDu = − 0.31, − 0.57, and − 0.29, respectively, Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, left). Consistently, RLDu values indicated that 3′UTR length overall shortened in all samples after stress, with the RC4 sample showing the greatest extent (median RLDu = − 0.07, − 0.14, and − 0.05 for AS, RC4, and RC8, respectively, Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, right). One example gene <italic>Nmt1</italic> is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>D, and several additional ones, including <italic>Calm1, Timp2,</italic> and <italic>Purb</italic>, are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A. These results are in good agreement with our previous results based on 3′READS and RT-qPCR data [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p id="Par16">Notably, based on REDi and RLDi, MAAPER revealed global upregulation of intronic polyadenylation (IPA) isoforms and overall pre-mRNA shortening in AS and RC4 samples (median REDi = − 0.22 and − 0.58, respectively; median RLDi = − 0.13 and − 0.35, respectively; Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). By contrast, the RC8 sample showed the opposite trend (median REDi and RLDi = 0.21 and 0.15, respectively; Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). One example gene <italic>Zfp444</italic> is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>F, and several additional ones, including <italic>Taf6, Nup155, and Elf1,</italic> are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B. These results, which have not been reported before, indicate that cellular stress activates IPA, leading to shortening of pre-mRNAs.</p>
    </sec>
    <sec id="Sec6">
      <title>MAAPER enables APA analysis with single-cell data</title>
      <p id="Par17">A growing number of scRNA-seq experiments generate nearSite reads [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. To apply MAAPER to APA analysis in single cell populations, we downloaded two 10x Genomics scRNA-seq datasets for placental samples generated by Vento-Tormo et al. [<xref ref-type="bibr" rid="CR23">23</xref>] and by Tsang et al. [<xref ref-type="bibr" rid="CR24">24</xref>]. We were interested in placental samples because we recently found substantial APA differences among the three trophoblast cell types in placenta [<xref ref-type="bibr" rid="CR25">25</xref>], namely, villous cytotrophoblasts (VCTs), extravillous trophoblasts (EVTs), and syncytiotrophoblasts (SCTs). The Vento-Tormo et al. dataset contained five donors at the 1st trimester [<xref ref-type="bibr" rid="CR23">23</xref>] and the Tsang et al. dataset were from four donors at the 3rd trimester [<xref ref-type="bibr" rid="CR24">24</xref>]. Thus, these two datasets represent trophoblasts at different stages of pregnancy.</p>
      <p id="Par18">We first isolated cells that belonged to VCTs, EVTs, and SCTs in each sample using cell type labels reported in the original publications (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, B and Figure S<xref rid="MOESM1" ref-type="media">6</xref>). We then used MAAPER to identify PASs. For the Vento-Tormo et al. dataset, MAAPER on average identified 12,674 expressed genes in the three trophoblast cell populations, among which 44.0%, 25.2%, 14.7%, and 16.1% had 1, 2, 3, and &gt;3 PASs, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). Overall, 75.2% of predicted PASs were in the 3′-most exons (including single-exon genes) and 21.7% were in introns, accounting for 78.6% and 13.6% of all reads, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Differential APA analysis of single-cell data by MAAPER. <bold>A</bold> Outline of APA analysis of placental data (10x Genomics) using MAAPER. <bold>B</bold> tSNE plot of the three trophoblast cell types based on gene expression in the Vento-Tormo et al. data. <bold>C</bold> Number of genes with a varying number of predicted PASs based on the Vento-Tormo et al. data. Bars denote the average gene number across three cell types; error bars denote SD. <bold>D</bold> Proportions of predicted PASs and nearSite reads based on their genomic positions. Proportions were averaged across all Vento-Tormo et al. samples. <bold>E</bold> Distributions of REDu scores calculated for EVTs vs. VCTs (left) and SCTs vs. VCTs (right). The 1st trimester (Vento-Tormo et al.) results are shown on the top, and the 3rd trimester (Tsang et al.) results at the bottom. Only genes that showed significant APA changes in the corresponding samples are included. <bold>F</bold> Sankey plots showing APA changes between the two trimesters in EVTs vs. VCTs (left) or SCTs vs. VCTs (right). Gene numbers are marked on the two sides of the Sankey plots. Genes are categorized as lengthened or shortened based on REDu scores (genes without significant changes are labeled as “unchanged”). Only genes with significant changes in at least one condition, either 1st trimester or 3rd trimester, are shown. S/L = no. of genes showing 3′UTR shortening/no. of genes showing 3′UTR lengthening. <bold>G</bold> As in <bold>E</bold>, except that REDi scores are shown</p></caption><graphic xlink:href="13059_2021_2429_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par19">Using FDR-adjusted <italic>P</italic> = 0.01 as the threshold, MAAPER identified significant APA changes in 6382 genes between EVTs and VCTs and 4796 genes between SCTs and VCTs in the 1st trimester (Vento-Tormo et al. data). The averaged median REDu across the five donors was − 0.46 for EVTs vs. VCTs and − 0.47 for SCTs vs. VCTs, indicating 3′UTR shortening in both EVTs and SCTs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). Interestingly, in the 3rd trimester (Tsang et al. data), while SCTs showed greater 3′UTR shortening (median REDu = − 0.90, Fig. <xref rid="Fig4" ref-type="fig">4</xref>E), EVTs displayed global 3′UTR lengthening (median REDu = 0.53; Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). Consistent with RED results, the ratios of gene number for genes showing 3′UTR shortening to those showing 3′UTR lengthening (or S/L) were 1.8 and 2.9 for SCTs (vs. VCTs) in 1st and 3rd trimesters, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>F). By contrast, they were 2.3 and 0.7 for EVTs (vs. VCTs) in 1st and 3rd trimesters, respectively (Fig. <xref rid="Fig4" ref-type="fig">4</xref>F).</p>
      <p id="Par20">In line with 3′UTR APA results, EVTs showed greater REDi score differences between the two trimesters (median REDi = 0.09 and 0.97 for 1st and 3rd trimester samples, respectively) than did SCTs (median REDi = −0.15 and 0.41 for 1st and 3rd trimester samples, respectively) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>G). Consistently, Gene Ontology (GO) analysis of gene expression changes between the two trimesters showed more significant GO terms associated with EVTs than with SCTs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). Taken together, our MAAPER analysis results of placental single-cell data not only confirmed previous finding of 3′UTR shortening in SCT differentiation in placenta [<xref ref-type="bibr" rid="CR25">25</xref>], but also revealed dynamics of APA changes in both EVTs and SCTs during pregnancy.</p>
    </sec>
    <sec id="Sec7">
      <title>MAAPER conducts both unpaired and paired tests.</title>
      <p id="Par21">While EVTs and SCTs both showed global 3′UTR shortening compared to VCTs in the 1st trimester, some genes showed 3′UTR lengthening (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). Using the Vento-Tormo et al. dataset, which contained five donors, we found that whereas the number of genes showing 3′UTR shortening increased along with the number of donors having significant APA regulation in both EVTs and SCTs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A), an opposite trend was observed for genes showing 3′UTR lengthening (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). This result indicates that 3′UTR shortening is more reliable than 3′UTR lengthening across donors, and APA regulation can differ across individuals.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Single-cell analysis by MAAPER using a paired test. <bold>A</bold> Number of genes with significant 3′UTR shortening in EVTs vs. VCTs (left) or SCTs vs. VCTs (right) for the number of donors showing significant regulation. <bold>B</bold> As in <bold>A</bold> except that number of genes with significant 3′UTR lengthening is shown. <bold>C</bold> Median REDu scores calculated for SCTs vs. VCTs and EVTs vs. VCTs (Vento-Tormo et al. data) across five individuals. Only genes that showed significant APA changes in corresponding samples are included for plotting. Error bars indicate the SD of median values across donors, and <italic>P</italic> values are based on the one-sided t tests. <bold>D</bold> SD of REDu scores using significant genes identified by paired or unpaired tests for EVTs vs. VCTs (left) or SCTs vs. VCTs (right). FDR-adjusted <italic>P</italic> value = 0.1 is used as a threshold to select significant genes. Displayed <italic>P</italic> values are based on the Wilcoxon rank sum tests. <bold>E</bold>, <bold>F</bold>
<italic>P</italic>-value distributions in paired or unpaired tests for EVTs vs. VCTs (<bold>E</bold>) or SCTs vs. VCTs (<bold>F</bold>). <bold>G</bold>, <bold>H</bold> Example genes <italic>MUC15</italic> (<bold>G</bold>) and <italic>CEP120</italic> (<bold>H</bold>). Aggregated reads from two donors (D8 and D11) are displayed. <italic>P</italic> values of RED scores are based on the one-sided t tests</p></caption><graphic xlink:href="13059_2021_2429_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par22">To more directly address individual differences in APA, we used the paired test function in MAAPER, by which EVTs or SCTs were compared to VCTs from the same donor. MAAPER uses an <italic>F</italic> test to account for the correlation structure and to detect consistent APA changes between samples/individuals (see the “<xref rid="Sec10" ref-type="sec">Materials and methods</xref>” section for detail). As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>C, while both EVTs and SCTs showed a negative median REDu value (median across genes) averaged over the five donors, indicating 3′UTR shortening, the error bars were quite large. Indeed, analysis of standard deviation (SD) across five donors indicated that unpaired tests contained higher data variability than paired tests (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). As expected, paired-tests overall resulted in larger <italic>P</italic> values than did unpaired tests (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E, F).</p>
      <p id="Par23">To illustrate individual differences in APA, we show two example genes, <italic>MUC15</italic> and <italic>CEP120</italic>. <italic>MUC15</italic> displayed significant 3′UTR shortening in SCTs vs. VCTs based on both unpaired and paired tests (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G and Additional file 1: Figure S<xref rid="MOESM1" ref-type="media">8</xref>A), indicating individual consistency. By contrast, <italic>CEP120</italic> displayed significant 3′UTR shortening in SCTs vs. VCTs based on unpaired test only but not paired test (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G and Additional file 1: Figure S<xref rid="MOESM1" ref-type="media">8</xref>B), indicating individual variation. Two additional example genes, <italic>ETNK1</italic> and <italic>PATJ</italic>, similar to <italic>MUC15</italic> and <italic>CEP120</italic>, respectively, are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9. Together, our data indicate that individual APA variations can be well addressed by the paired test function of MAAPER.</p>
    </sec>
    <sec id="Sec8">
      <title>MAAPER improves accuracy of APA analysis with single-cell data</title>
      <p id="Par24">To further evaluate the applicability and performance of MAAPER in single-cell analysis, we compared our method with two other APA analysis methods that were specifically developed for single-cell data, scAPA [<xref ref-type="bibr" rid="CR17">17</xref>] and Sierra [<xref ref-type="bibr" rid="CR16">16</xref>]. MAAPER is distinct in several aspects from these two programs (summarized in Table <xref rid="Tab1" ref-type="table">1</xref>). First, due to the use of PolyA_DB, MAAPER identifies PAS locations with single-nucleotide resolution, while scAPA and Sierra, which conduct de novo PAS prediction, provide genomic ranges with predicted peaks. Second, while all three methods perform differential analysis using single-cell clusters, only MAAPER offers paired test, taking into consideration inter-sample/individual variation. Notable also is that both PAS prediction and APA analysis in MAAPER are based on cell clusters, whereas Sierra and scAPA identifies PASs in single cells (Table <xref rid="Tab1" ref-type="table">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of various features of MAAPER, scAPA, and Sierra</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>MAAPER</th><th>scAPA</th><th>Sierra</th></tr></thead><tbody><tr><td>Input data type</td><td>Bulk RNA-seq or scRNA-seq</td><td>scRNA-seq</td><td>scRNA-seq</td></tr><tr><td>Applicable to multiple samples</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>PAS resolution</td><td>Individual PAS</td><td>Range based on read peak</td><td>Range based on read peak</td></tr><tr><td>PAS identification method</td><td>Modeling based on known PASs</td><td>De novo</td><td>Do novo</td></tr><tr><td>Basis for PAS quantification</td><td>Cell cluster</td><td>Single cell</td><td>Single cell</td></tr><tr><td>Basis for APA analysis</td><td>Cell cluster</td><td>Cell cluster</td><td>Cell cluster</td></tr><tr><td>Individual-based paired test</td><td>Yes</td><td>No</td><td>No</td></tr></tbody></table></table-wrap></p>
      <p id="Par25">To quantitatively compare method performance, we applied scAPA and Sierra to the same 10x Genomics data of 1st trimester placental samples we used in the above analyses [<xref ref-type="bibr" rid="CR23">23</xref>]. MAAPER identified the highest number of genes (12,674) and PASs (31,850), which were comparable with those by Sierra (11,591 genes and 28,093 PASs). By contrast, scAPA had a much lower detection rate (4979 genes and 5479 PASs) (Figure S<xref rid="MOESM1" ref-type="media">10</xref>A-B). In addition, 84% of the reads can be assigned by MAAPER to its identified PASs, while scAPA and Sierra assigned 65.3% and 57.7%, respectively (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A). Importantly, we found that the PASs predicted by MAAPER had discrete upstream A-rich and downstream U-rich peaks that are characteristic of genuine PASs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B) [<xref ref-type="bibr" rid="CR26">26</xref>]. By contrast, these peaks were less distinct for Sierra-predicted PASs and were almost not discernable for scAPA-predicted ones (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B). Taken together, these data indicate that MAAPER is more sensitive and accurate in PAS identification than Sierra and scAPA.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparisons of MAAPER, scAPA, and Sierra. <bold>A</bold> Proportion of scRNA-seq reads explained by the predicted PASs of the three methods. The Vento-Tormo et al. data were used. Data from EVTs, SCTs, and VCTs were combined. <bold>B</bold> Nucleotide frequencies around predicted PASs by the three methods. Data from EVTs, SCTs, and VCTs were combined. <bold>C</bold> Venn diagrams showing overlaps of significant genes with 3′UTR lengthening or shortening in EVTs vs. VCTs as identified by MAAPER and Sierra. <bold>D</bold> As in <bold>C</bold>, except that SCTs vs. VCTs data are shown. <bold>E</bold> S/L ratios calculated using significant genes identified by both MAAPER and Sierra, by only MAAPER, or by only Sierra</p></caption><graphic xlink:href="13059_2021_2429_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par26">Next, we compared significant APA events identified by the three methods. With a universal threshold of FDR-adjusted <italic>P</italic> = 0.01, scAPA identified only &lt;50 significant APA events in both EVTs and SCTs whereas MAAPER and Sierra on average reported 5589 and 1214 significant APA events, respectively. This result indicates that MAAPER is the most sensitive method for APA analysis among the three methods. We found that, in both SCTs and EVTs, &gt;87% of genes with significant 3′UTR changes identified by Sierra were also detected by MAAPER (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C, D). Interestingly, the events identified by both methods or by MAAPER only showed similar REDu scores, while events identified by Sierra only had smaller absolute REDu values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10C), indicating that MAAPER is more selective than Sierra.</p>
      <p id="Par27">Based on the ratio of number of genes showing 3′UTR shortening to genes showing 3′UTR lengthening, or S/L, we found that MAAPER and Sierra reported S/L = 2.3 and 2.7, respectively, for EVTs vs. VCTs, and S/L = 1.8 and 3.2, respectively, for SCTs vs. VCTs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E). Using commonly regulated events, the S/L values increased to 2.9 and 3.5 for EVTs vs. VCTs and for SCTs vs. VCTs, respectively (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E), indicating that combining the two methods could make the overall APA direction even more obvious.</p>
      <p id="Par28">Lastly, we compared the computational efficiency of the three methods using a computer with the Ubuntu 16.04.5 operating system and Intel Xeon “Gold” 6230R processor (16 cores). MAAPER on average had 12.9% less memory usage, but took 112% more time compared with Sierra (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). scAPA showed the lowest performance among the three, with the most memory usage and time consumption (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par29">Here we present MAAPER, a computational tool that predicts PASs and conducts APA analysis using nearSite reads from bulk RNA-seq or scRNA-seq data. By incorporating well-annotated PASs in the PolyA_DB database [<xref ref-type="bibr" rid="CR18">18</xref>], MAAPER identifies PASs located in 3'UTRs and introns with high accuracy and sensitivity. With a rigorous statistical framework based on a likelihood model, MAAPER provides statistically interpretable results and multiple metrics evaluating APA changes. In addition, paired APA analysis, first in its class to the best of our knowledge, identifies common and distinct APA events in cell populations from multiple individuals.</p>
    <p id="Par30">We applied MAAPER to QuantSeq FWD and 10x Genomics data in this work, showing that MAAPER can be used for analysis of both bulk RNA-seq and scRNA-seq data. While RNA-seq by QuantSeq FWD is a commonly used method, the volume of scRNA-seq data is increasing much more rapidly in recent years. We could therefore imagine that the application of MAAPER to scRNA-seq data will be more common than bulk RNA-seq data in the future.</p>
    <p id="Par31">MAAPER is an annotation-assisted method. It incorporates the large set of annotated PASs in the PolyA_DB database for PAS prediction. We show that this approach ensures data quality and achieves both high precision and recall. On the other hand, dependence on PolyA_DB limits the application of MAAPER. First, only the four species currently available in the database can be analyzed, including human, mouse, rat, and chicken. Second, PASs that have not been annotated by PolyA_DB, e.g., those utilized in specialized cells or under specific conditions, are not used in PAS prediction by MAAPER. One remedy is to extend the PAS prediction to novel sites. Alternatively, using additional PAS databases, such as PolyASite [<xref ref-type="bibr" rid="CR27">27</xref>], can help mitigate this issue. Nevetheless, we also expect the sensitivity of MAAPER to increase when PAS coverage in PolyA_DB expands in the future.</p>
    <p id="Par32">For single-cell analysis, the current MAAPER version uses aggregated single cells of the same type and treats them as pseudo-bulk samples. This approach is in contrast to the two other methods we have compared with in this study, namely, scAPA and Sierra. Our rationale is that read counts summarized from scRNA-seq data often contain missing values due to biological and technical reasons [<xref ref-type="bibr" rid="CR28">28</xref>]. As such, single cell-based APA analysis could have high noise levels [<xref ref-type="bibr" rid="CR29">29</xref>]. With improvement in sensitivity of scRNA-seq methods, one future direction for MAAPER is to incorporate statistical tests for APA changes in individual cells.</p>
    <p id="Par33">Single cells from a given sample are naturally paired by sample identity. The paired test in MAAPER is useful in revealing cell-to-cell differences and distinctions among individuals. In this study, we show distinct cell populations in placenta could be compared within each individual and the differences across individuals could be analyzed to derive inter-individual variation. One limitation in this study is the number of individuals available for analysis, which negatively impacts the statistical power. We expect the paired test to have higher power as more individuals are included in analysis.</p>
    <p id="Par34">APA changes could provide additional information to gene-based analysis to distinguish cell types. A case in point is our finding that 3′UTR sizes differ substantially between first and third trimesters in EVTs, which is also coupled with global gene expression changes. By contrast, while gene expression changes also take place between first and third trimesters in SCTs, the 3′UTR size appears more consistent between the two trimesters. These results are in line with the notion that trophoblast cells at different stages of pregnancy have different biological characteristics, including invasiveness and proliferative activity in different trimesters [<xref ref-type="bibr" rid="CR30">30</xref>]. Further, our results highlight the dynamic nature of APA in different cells under distinct conditions, supporting their value in defining cell identity.</p>
  </sec>
  <sec id="Sec10">
    <title>Materials and methods</title>
    <sec id="Sec11">
      <title>Cell culture and RNA sequencing</title>
      <p id="Par35">NIH3T3 cells were cultured in high glucose Dulbecco’s modified Eagle’s medium (DMEM) supplemented with 10% calf serum, 100 IU/ml penicillin, and 100 μg/ml streptomycin at 37 °C. For stress induction, cells were cultured in medium containing 250 μM of sodium arsenite (NaASO<sub>2</sub>) for 1 h. For recovery, stressed cells were washed twice with phosphate-buffered saline (PBS) to remove NaASO<sub>2</sub>, followed by culturing in regular medium for 4 h or 8 h. Total RNA was extracted using TRIzol. QuantSeq 3′ mRNA-Seq Library Prep Kits (FWD or REV) were used to prepare libraries. Sequencing was carried out on an Illumina NextSeq.</p>
    </sec>
    <sec id="Sec12">
      <title>Summary of the MAAPER method</title>
      <p id="Par36">MAAPER is a novel method for predicting PAS locations and comparing APA usage using nearSite reads, and it has four unique features which contribute to its high accuracy and broad applicability. First, the statistical model of MAAPER is flexible. Unlike most existing PAS prediction tools (develop for RNA-seq) that use a simplified model of only two PASs (proximal and distal), MAAPER predicts a comprehensive set of expressed PASs for each gene, including those located in 3'UTRs, internal exons, and introns. Second, MAAPER has high accuracy in PAS prediction. On the one hand, it achieves a high recall rate by incorporating the large collection of PASs annotated in PolyA_DB database, which contains more than 85,000 and 120,000 PASs for human and mouse genes in its current version (v3). On the other, it achieves a high precision by a forward-selection procedure, which screens for a conservative set of PASs that adequately explain the observed reads. Third, MAAPER is statistically principled. It detects differential PAS usage between sample groups using rigorous and flexible statistical tests. Most existing methods for RNA-seq or onSite reads use the Fisher’s exact test [<xref ref-type="bibr" rid="CR31">31</xref>] for differential PAS usage, which is limited to comparisons between two samples and two PASs [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. In contrast, for unpaired samples, MAAPER formulates an LRT based on its likelihood model to accurately detect if a gene’s PAS proportions change between conditions; for paired samples, MAAPER uses an <italic>F</italic>-test to account for the correlation structures and detects consistent APA changes between conditions. Fourth, MAAPER facilitates the interpretation of differential analysis of PAS usage. In addition to estimated PAS proportions, it calculates two scores to measure the differences in relative transcript length and relative PAS expression, providing a convenient approach to quantifying APA regulation.</p>
    </sec>
    <sec id="Sec13">
      <title>Likelihood model for PAS prediction</title>
      <p id="Par37">MAAPER uses a rigorous and flexible likelihood-based framework to identify PASs and quantify APA isoform abundance with 3′ end-linked RNA sequencing data (nearSite reads). There are two steps at the PAS prediction stage. At the first step, MAAPER learns the distance of nearSite reads to PASs using only genes with a single PAS. At the second step, MAAPER uses a likelihood model to predict PASs for all reads. MAAPER uses data from the PolyA_DB database (v3), a comprehensive PAS database based on 3′READS data [<xref ref-type="bibr" rid="CR18">18</xref>], at both steps. Specifically, for each sample, after aligning reads to the reference genome, we extract all the reads mapped to the single PAS genes (annotated in PolyA_DB) and calculate the distances (excluding intronic regions) between the 5′ end positions of these reads and their corresponding PASs. Next, we non-parametrically estimate the probability density of the distances using a Gaussian kernel function. This is achieved with the density function in R. This approach allows us to capture the distributional characteristic of the distances without assuming uniformness, which is often violated in real data [<xref ref-type="bibr" rid="CR32">32</xref>]. In our analysis, we learned distances for genes ≤400 nt and genes &gt;400 nt separately, as we have found that the distances for short genes displayed different distributional properties (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B).</p>
      <p id="Par38">At the second step, MAAPER constructs a likelihood model to identify PASs and quantify isoform abundance. Suppose a given gene has <italic>J</italic> annotated PASs in PolyA_DB, then we denote their proportions in the mRNAs transcribed from this gene as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_1,\dots, {\alpha}_J\ \left({\sum}_{j=1}^J{\alpha}_j=1\right). $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq1.gif"/></alternatives></inline-formula> Note that the model aims to detect all PASs in all samples. For sample replicates, we denote the replicate number as <italic>K</italic><sub>1</sub> in condition 1 and as <italic>K</italic><sub>2</sub> in condition 2. When there is no replicate, <italic>K</italic><sub>1</sub> = <italic>K</italic><sub>2</sub> = 1. In addition, we use <italic>n</italic><sub><italic>ck</italic></sub> to denote the number of reads mapped to the gene in the <italic>k</italic>-th replicate in condition <italic>c</italic> (<italic>c</italic> = 1 or 2). Given the above notations, the joint likelihood of nearSite reads mapped to this gene can be derived as
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L={\prod}_{c=1}^2{\prod}_{k=1}^{K_c}{\prod}_{i=1}^{n_{ck}}{\sum}_{j=1}^J{\left({P}_{ck i j}{\alpha}_j\right)}^{\mathbbm{I}\left\{{Z}_{ck i}=j\right\}}, $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext mathvariant="italic">ckij</mml:mtext></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">cki</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">where <italic>Z</italic><sub><italic>cki</italic></sub> ∈ {1, …, <italic>J</italic>} is the unobserved PAS index and <italic>Z</italic><sub><italic>cki</italic></sub> = <italic>j</italic> if the <italic>i</italic>-th read in the <italic>k</italic>-th replicate in condition <italic>c</italic> comes from a transcript using the <italic>j</italic>-th PAS. <italic>P</italic><sub><italic>ckij</italic></sub> denotes the probability of observing a read at read <italic>i</italic>’s 5′ position in the <italic>k</italic>-th replicate in condition <italic>c</italic>, given that the read comes from a transcript using the <italic>j</italic>-th PAS; <italic>P</italic><sub><italic>ckij</italic></sub> is calculated based on the distance densities learned from the first step.</p>
      <p id="Par40">Given the above likelihood function, we developed an Expectation-Maximization (EM) algorithm [<xref ref-type="bibr" rid="CR33">33</xref>] to maximize the log-likelihood
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ l={\sum}_{c=1}^2{\sum}_{k=1}^{K_c}{\sum}_{i=1}^{n_{ck}}{\sum}_{j=1}^J\mathbbm{I}\left\{{Z}_{ck i}=j\right\}\log \left({P}_{ck i j}{\alpha}_j\right), $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">cki</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext mathvariant="italic">ckij</mml:mtext></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">and estimate the PAS proportions. We use <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_j^{(0)},\dots, {\alpha}_J^{(0)} $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>J</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq2.gif"/></alternatives></inline-formula> to denote initial values and use <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_j^{(t)},\dots, {\alpha}_J^{(t)} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>J</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq3.gif"/></alternatives></inline-formula> to denote estimated values in the <italic>t</italic>-th iteration of the EM algorithm. Then, in the (<italic>t</italic> + 1)-th iteration, we can update the estimators as
<disp-formula id="Equc"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_j^{\left(t+1\right)}=\frac{1}{\sum_{c=1}^2{\sum}_{k=1}^{K_c}{n}_{ck}}{\sum}_{c=1}^2{\sum}_{k=1}^{K_c}{\sum}_{i=1}^{n_{ck}}\frac{P_{ij}{\alpha}_j^{(t)}}{\sum_{j^{\prime }=1}^J{P}_{i{j}^{\prime }}{\upalpha}_{j^{\prime}}^{(t)}}\ \left(j=1,\dots, J\right). $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="normal">α</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="(" separators=",,"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>…</mml:mo><mml:mi>J</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">We use the above algorithm to update estimated PAS proportions until convergence.</p>
      <p id="Par43">Some genes have a large number of annotated PASs in PolyA_DB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). The above EM algorithm would give most PASs non-zero proportions even though some isoforms have a very low abundance. To address this issue, MAAPER uses a forward selection procedure to select PASs into the model based on their statistical significance. MAAPER first ranks all PASs based on their supporting read numbers and starts the selection process with the PAS with the largest read number. At each subsequent step, the likelihood ratio test is carried out to determine if addition of a PAS would significantly lead to increase of the likelihood. The process is terminated when no such an increase can be achieved. In essence, MAAPER selects a minimal set of annotated PASs that can sufficiently explain the observed nearSite reads. Our previous work has shown that a similar stepwise selection procedure is very efficient in identifying truly expressed RNA isoforms from RNA-seq data [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Unpaired statistical test for differential APA profiles</title>
      <p id="Par44">With the predicted PASs, MAAPER analyzes differential APA isoform abundances between the two conditions. Suppose there are <italic>J</italic> PASs in a given gene. We denote their proportions in condition <italic>c</italic> (<italic>c</italic> = 1 or 2) as <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_{c1},\dots, {\alpha}_{cJ}\ \left({\sum}_{j=1}^J{\alpha}_{cj}=1\right). $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">cJ</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">cj</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq4.gif"/></alternatives></inline-formula> Following the notations described above, the joint likelihood of nearSite reads mapped to the gene can be derived as
<disp-formula id="Equd"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L={\prod}_{c=1}^2{\prod}_{k=1}^{K_c}{\prod}_{i=1}^{n_{ck}}{\sum}_{j=1}^J{\left({P}_{ck i j}{\alpha}_{cj}\right)}^{\mathbbm{I}\left\{{Z}_{ck i}=j\right\}}. $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext mathvariant="italic">ckij</mml:mtext></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">cj</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">cki</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par45">Unlike tools that focus on proximal and distal PASs only, we designed a likelihood ratio test to detect differential abundances for all PASs. The null hypothesis is <italic>H</italic><sub>0</sub> : <italic>α</italic><sub>1<italic>j</italic></sub> = <italic>α</italic><sub>2<italic>j</italic></sub> (<italic>j</italic> = 1, …, <italic>J</italic>); the alternative hypothesis is <italic>H</italic><sub><italic>a</italic></sub> :  ∃ <italic>j</italic> ∈ {1, …, <italic>J</italic>} s. t. <italic>α</italic><sub>1<italic>j</italic></sub> ≠ <italic>α</italic><sub>2<italic>j</italic></sub>. Under <italic>H</italic><sub>0</sub>, the proportions can be estimated using the EM algorithm described above, and we denote the estimated values after convergence as <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\alpha}}_1^0,\dots, {\hat{\alpha}}_J^0 $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>J</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq5.gif"/></alternatives></inline-formula>. Under <italic>H</italic><sub><italic>a</italic></sub>, we can also use an EM algorithm to update the estimators using the following rule:
<disp-formula id="Eque"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_{cj}^{\left(t+1\right)}=\frac{1}{\sum_{k=1}^{K_c}{n}_{ck}}{\sum}_{k=1}^{K_c}{\sum}_{i=1}^{n_{ck}}\frac{P_{ij}{\alpha}_j^{(t)}}{\sum_{j^{\prime }=1}^J{P}_{i{j}^{\prime }}{\alpha}_{j^{\prime}}^{(t)}}\ \left(c=1,2;j=1,\dots, J\right). $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msubsup><mml:mi>α</mml:mi><mml:mi mathvariant="italic">cj</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ck</mml:mi></mml:msub></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msubsup><mml:mi>α</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mi>α</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mfenced close=")" open="(" separators=",;,,"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>…</mml:mo><mml:mi>J</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par46">We denote the estimated values after convergence as <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\alpha}}_{c1}^a,\dots, {\hat{\alpha}}_{cJ}^a $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">cJ</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq6.gif"/></alternatives></inline-formula>. Under <italic>H</italic><sub>0</sub>, the statistic below follows a chi-square distribution:
<disp-formula id="Equf"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ -2\log \frac{L\left({\alpha}_{1j}={\alpha}_{2j}={\hat{\alpha}}_1^0,\dots, {\alpha}_{1J}={\alpha}_{2J}={\hat{\alpha}}_J^0\right)}{L\left({\alpha}_{1j}={\hat{\alpha}}_{11}^a,{\alpha}_{2j}={\hat{\alpha}}_{21}^a,\dots, {\alpha}_{1J}={\hat{\alpha}}_{1J}^a,{\alpha}_{2J}={\hat{\alpha}}_{2J}^a\right)}\sim {\chi}^2(J). $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>J</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=",,,,"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>11</mml:mn><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>21</mml:mn><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>~</mml:mo><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mi>J</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par47">The <italic>P</italic> values of the likelihood ratio tests can then be obtained based on the above test statistic and are adjusted by the Benjamini and Hochberg method [<xref ref-type="bibr" rid="CR34">34</xref>] to correct for the multiple testing issue and derive false discovery rate (FDR). In our analysis, we use the adjusted <italic>P</italic> value = 0.01 as the threshold for identifying genes with significantly differential APA isoform abundances. In addition to the LRT, MAAPER also provides the Fisher’s exact test to examine if the differences are significant for the two PASs with the largest proportion changes. When there are replicates, reads are first pooled from the replicates to carry out the Fisher’s test.</p>
    </sec>
    <sec id="Sec15">
      <title>Paired statistical test for differential APA profiles</title>
      <p id="Par48">In scRNA-seq experiments, comparison of APA profiles is often within the same group of subjects. For example, it is often of interest to test for differential APA expression between two cell types from the same subjects, or between pre- and post-treatment cells from the same subjects. To address this type of questions, we propose a test for differential APA profiles among paired subjects. Suppose there are <italic>J</italic> predicted PASs in a given gene. We denote their proportions in sample <italic>i</italic> (<italic>i</italic> = 1, 2, …, <italic>n</italic>) in condition <italic>c</italic> (<italic>c</italic> = 1 or 2) as <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\alpha}}_{ci}={\left({\alpha}_{ci1},\dots, {\alpha}_{ci J}\right)}^T\ \left({\sum}_{j=1}^J{\alpha}_{ci j}=1\right). $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=",,"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ci</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">ciJ</mml:mi></mml:msub></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">cij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq7.gif"/></alternatives></inline-formula> The reads mapped to the given gene in each nearSite read sample are assigned to the PASs based on the read-PAS probabilities calculated in the prediction stage. We denote the read counts as <bold><italic>X</italic></bold><sub>1<italic>i</italic></sub> ∈ <italic>ℕ</italic><sup><italic> J</italic></sup> and <bold><italic>X</italic></bold><sub>2<italic>i</italic></sub> ∈ <italic>ℕ</italic><sup><italic> J</italic></sup>, where <italic>X</italic><sub><italic>cij</italic></sub> is the read count of PAS <italic>j</italic> in sample <italic>i</italic> in condition <italic>c</italic>.</p>
      <p id="Par49">We assume that both <bold><italic>X</italic></bold><sub>1<italic>i</italic></sub> and <bold><italic>X</italic></bold><sub>2<italic>i</italic></sub> follow a Multinomial distribution
<disp-formula id="Equg"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{X}}_{ci}\sim \mathrm{Multinomial}\left({N}_{ci},{\boldsymbol{\alpha}}_{ci}\right), $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par50">where <inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {N}_{ci}={\sum}_{j=1}^J{X}_{ci j} $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="italic">cij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq8.gif"/></alternatives></inline-formula>. In addition, we assume that the PAS proportions in samples of the same condition independently follow the same distribution, where
<disp-formula id="Equh"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left({\boldsymbol{\alpha}}_{ci}\right)={\boldsymbol{\uppi}}_c,\kern0.5em \mathrm{Var}\left({\boldsymbol{\alpha}}_{ci}\right)={\boldsymbol{\Sigma}}_c. $$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">π</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mi>Var</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">To account for the correlation between APA profiles of the same subject, we further assume that
<disp-formula id="Equi"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Cov\left({\boldsymbol{\alpha}}_{1i},{\boldsymbol{\alpha}}_{2i}\right)={\boldsymbol{\Sigma}}_{12}. $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi mathvariant="italic">Cov</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par52">It follows from the above assumptions that
<disp-formula id="Equj"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left({\boldsymbol{X}}_{ci}\right)={N}_{ci}{\boldsymbol{\uppi}}_c, $$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">π</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equj.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equk"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Var}\left({\boldsymbol{X}}_{ci}\right)={N}_{ci}\left(\mathrm{Diag}\left({\boldsymbol{\uppi}}_c\right)-{\boldsymbol{\uppi}}_c{\boldsymbol{\uppi}}_c^T\right)+{N}_{ci}\left({N}_{ci}-1\right){\boldsymbol{\Sigma}}_c, $$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mi>Var</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Diag</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">π</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold">π</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">π</mml:mi><mml:mi>c</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equk.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equl"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Cov}\left({\boldsymbol{X}}_{1i},{\boldsymbol{X}}_{2i}\right)={N}_{1i}{N}_{2i}{\boldsymbol{\Sigma}}_{12}. $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mi>Cov</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par53">In out paired test, the null hypothesis is <italic>H</italic><sub>0</sub> : <italic>π</italic><sub>1<italic>j</italic></sub> = <italic>π</italic><sub>2<italic>j</italic></sub> (<italic>j</italic> = 1, …, <italic>J</italic>); the alternative hypothesis is <italic>H</italic><sub><italic>a</italic></sub> :  ∃ <italic>j</italic> ∈ {1, …, <italic>J</italic>} s. t. <italic>π</italic><sub>1<italic>j</italic></sub> ≠ <italic>π</italic><sub>2<italic>j</italic></sub>. Based on [<xref ref-type="bibr" rid="CR35">35</xref>], we can construct the following <italic>F</italic> statistic to test the hypotheses
<disp-formula id="Equm"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ F=\frac{n-d+1}{\left(n-1\right)\left(\mathrm{d}-1\right)}{\left({\hat{\boldsymbol{\pi}}}_1-{\hat{\boldsymbol{\pi}}}_2\right)}^T\boldsymbol{\Theta} \left({\hat{\boldsymbol{\pi}}}_1-{\hat{\boldsymbol{\pi}}}_2\right), $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">Θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">where <bold>Θ</bold> is the Moore-Penrose pseudoinverse of <inline-formula id="IEq9"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{\Sigma}}}_{\hat{\pi}} $$\end{document}</tex-math><mml:math id="M44" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq9.gif"/></alternatives></inline-formula>. In addition,
<disp-formula id="Equn"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{\Sigma}}}_{\hat{\pi}}={\sum}_{c=1}^2\left\{\frac{{\boldsymbol{S}}_c+\left({M}_c-1\right){\boldsymbol{G}}_c}{M_c\ {N}_c}+\frac{\sum_{i=1}^n{N}_{ci}^2-{N}_c}{M_c\ {N}_c^2}\left({\boldsymbol{S}}_c-{\boldsymbol{G}}_c\right)\right\}-\frac{\sum_{i=1}^n{N}_{1i}{N}_{2i}}{\ {N}_1{N}_2}\left({\hat{\boldsymbol{\Sigma}}}_{12}+{\hat{\boldsymbol{\Sigma}}}_{12}^T\right), $$\end{document}</tex-math><mml:math id="M46" display="block"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mfenced close="}" open="{"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>12</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>12</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par55">where <inline-formula id="IEq10"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{\pi}}}_c={\sum}_{i=1}^n{\boldsymbol{X}}_{ci} $$\end{document}</tex-math><mml:math id="M48" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq10.gif"/></alternatives></inline-formula>/<inline-formula id="IEq11"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sum}_{i=1}^n{N}_{ci}, $$\end{document}</tex-math><mml:math id="M50" display="inline"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq11.gif"/></alternatives></inline-formula>
<inline-formula id="IEq12"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{\pi}}}_{ci}={\boldsymbol{X}}_{ci} $$\end{document}</tex-math><mml:math id="M52" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq12.gif"/></alternatives></inline-formula>/<italic>N</italic><sub><italic>ci</italic></sub>, <inline-formula id="IEq13"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {N}_c={\sum}_{i=1}^n{N}_{ci}, $$\end{document}</tex-math><mml:math id="M54" display="inline"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq13.gif"/></alternatives></inline-formula>
<inline-formula id="IEq14"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}_c=\frac{1}{\left(n-1\right){N}_c}\left({N}_c^2-{\sum}_{i=1}^n{N}_{ci}^2\right), $$\end{document}</tex-math><mml:math id="M56" display="inline"><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq14.gif"/></alternatives></inline-formula> and
<disp-formula id="Equo"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{S}}_c=\frac{1}{n-1}{\sum}_{i=1}^n{N}_{ci}\left({\hat{\boldsymbol{\pi}}}_{ci}-{\hat{\boldsymbol{\pi}}}_c\right){\left({\hat{\boldsymbol{\pi}}}_{ci}-{\hat{\boldsymbol{\pi}}}_c\right)}^T, $$\end{document}</tex-math><mml:math id="M58" display="block"><mml:msub><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equo.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equp"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{G}}_c=\frac{1}{N_c-n}{\sum}_{i=1}^n{N}_{ci}\left(\mathrm{Diag}\left({\hat{\boldsymbol{\pi}}}_{ci}\right)-{\hat{\boldsymbol{\pi}}}_{ci}{\hat{\boldsymbol{\pi}}}_{ci}^T\right), $$\end{document}</tex-math><mml:math id="M60" display="block"><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Diag</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ci</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equp.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equq"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{\Sigma}}}_{12}=\frac{1}{n-1}{\sum}_{i=1}^n\frac{N_{1i}+{N}_{2i}}{M_1+{M}_2}\left({\hat{\boldsymbol{\pi}}}_{1i}-{\hat{\boldsymbol{\pi}}}_1\right){\left({\hat{\boldsymbol{\pi}}}_{2i}-{\hat{\boldsymbol{\pi}}}_2\right)}^T. $$\end{document}</tex-math><mml:math id="M62" display="block"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>12</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2429_Article_Equq.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par56">Under <italic>H</italic><sub>0</sub>, the <italic>F</italic> statistic follows an asymptotic <italic>F</italic>-distribution with degrees with freedom <italic>J</italic> − 1 and <italic>n</italic> − <italic>J</italic> − 1. The <italic>P</italic> values can then be obtained based on the above test statistic, and are adjusted by the Benjamini and Hochberg method to correct for the multiple testing issue.</p>
    </sec>
    <sec id="Sec16">
      <title>APA regulation scores</title>
      <p id="Par57">MAAPER calculates four scores for APA regulation, namely relative length difference (RLD) for 3′UTR size difference (RLDu, considering 3′-most exon PASs only), RLD for pre-mRNA size difference (RLDi, considering internal PASs), relative expression difference (RED) for 3′UTR size difference (REDu, considering 3′-most exon PASs only), and RED for relative expression of internal PASs (REDi).</p>
      <p id="Par58">For RLDu, where we only consider 3′UTR PASs, suppose a gene has <italic>J</italic> 3′UTR PASs, ordered from 5′ to 3′ on the chromosome. Their proportions are denoted as <italic>α</italic><sub>11</sub>, …, <italic>α</italic><sub>1<italic>J</italic></sub> in condition 1 and <italic>α</italic><sub>21</sub>, …, <italic>α</italic><sub>2<italic>J</italic></sub> in condition 2. We use <italic>l</italic><sub><italic>j</italic></sub> to denote the relative 3'UTR length of the <italic>j</italic>-th PAS, with <italic>l</italic><sub>1</sub> = 1 nt for the 5′-most PAS and <italic>l</italic><sub><italic>j</italic></sub> (<italic>j</italic> &gt; 1) is the nucleotide distance between the first and the <italic>j</italic>-th PASs on the 3′UTR. The RLDu score between conditions 1 and 2 is calculated as <inline-formula id="IEq15"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{RLDu}={\log}_2\left({\sum}_{j=1}^J{\alpha}_{2j}{l}_j/{\sum}_{j=1}^J{\alpha}_{1j}{l}_j\right) $$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq15.gif"/></alternatives></inline-formula>. As such, RLDu measures the relative length of 3'UTR between the two conditions.</p>
      <p id="Par59">For RLDi, where we consider PASs located in introns and internal exons in addition to 3′-most exons, suppose a gene has <italic>J</italic> PASs, ordered from 5′ to 3′ on the chromosome. <italic>J</italic><sub>1</sub> is the number of PASs located in introns or internal exons and <italic>J</italic><sub>2</sub> is the number of PASs in the 3′-most exon (<italic>J</italic><sub>1</sub> + <italic>J</italic><sub>2</sub> = <italic>J</italic>). <italic>l</italic><sub><italic>j</italic></sub> denotes the length of the pre-mRNA transcript for the <italic>j</italic>-th PAS, i.e., the genomic distance between transcription start site and the <italic>j</italic>-th PAS. Then, the RLDi score can be calculated as <inline-formula id="IEq16"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{RLDi}={\log}_2\left({\sum}_{j={J}_1+1}^{J_1+{J}_2}{\alpha}_{2j}{l}_j/{\sum}_{j=1}^{J_1}{\alpha}_{2j}{l}_j\right)-{\log}_2\left({\sum}_{j={J}_1+1}^{J_1+{J}_2}{\alpha}_{1j}{l}_j/{\sum}_{j=1}^{J_1}{\alpha}_{1j}{l}_j\right) $$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2021_2429_Article_IEq16.gif"/></alternatives></inline-formula>. As such, RLDi measures the relative length of pre-mRNA transcripts with internal polyadenylation between the two conditions.</p>
      <p id="Par60">For the RED score, we use the two PASs with the largest proportion changes between two conditions. For REDu, we select the top two PASs in the 3′UTR; for REDi, we select one PAS from introns/internal exons and the other from 3′UTR. We refer to the two PASs as the distal PAS and proximal PAS based on their chromosomal positions relative to the transcription start site. Suppose the proportions of the proximal PAS in conditions 1 and 2 are denoted as <italic>α</italic><sub>1<italic>p</italic></sub> and <italic>α</italic><sub>2<italic>p</italic></sub>, and the proportions of the distal PAS are denoted as <italic>α</italic><sub>1<italic>d</italic></sub> and <italic>α</italic><sub>2<italic>d</italic></sub>. The RED score between conditions 1 and 2 is calculated as RED = log<sub>2</sub>(<italic>α</italic><sub>2<italic>d</italic></sub>/<italic>α</italic><sub>2<italic>p</italic></sub>) − log<sub>2</sub>(<italic>α</italic><sub>1<italic>d</italic></sub>/<italic>α</italic><sub>1<italic>p</italic></sub>). Therefore, a negative RED value indicates transcript shortening in condition 2 comapred with condition 1 and a positive value transcript lengthening.</p>
    </sec>
    <sec id="Sec17">
      <title>QuantSeq data analysis</title>
      <p id="Par61">The processing of QuantSeq data followed the protocol on the website of Lexogen (<ext-link ext-link-type="uri" xlink:href="https://www.lexogen.com">https://www.lexogen.com</ext-link>). Briefly, the adapter contamination, polyA read through, and low quality tails were first trimmed using bbmap [<xref ref-type="bibr" rid="CR36">36</xref>]. The cleaned reads were then mapped to the RefSeq mm9 genome using STAR [<xref ref-type="bibr" rid="CR37">37</xref>] with the parameters of “--outFilterType BySJout --outFilterMultimapNmax 20 --alignSJoverhangMin 8 --alignSJDBoverhangMin 1 --outFilterMismatchNmax 999 --outFilterMismatchNoverLmax 0.1 --alignIntronMin 20 --alignIntronMax 1000000 --alignMatesGapMax 1000000 --outSAMattributes NH HI NM MD”. MAAPER was applied to aligned QuantSeq FWD reads from NT, AS, RC4, and RC8 samples separately for PAS prediction and differential APA analysis. Only genes with at least 50 mapped reads were considered. At the PAS prediction stage, a proportion of 5% was used as the threshold to select PASs. We evaluated the accuracy of MAAPER by varying this threshold between 1 and 10%, and found that MAAPER’s precision was consistently above 85% and recall above 80%, demonstrating robustness of MAAPER (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11). At the APA analysis stage, an FDR-adjusted <italic>P</italic> value of 0.01 was used as the threshold to select significant cases. For PAS identification with QuantSeq REV data, the PAS positions were directly determined as the 3′-most positions of mapped reads.</p>
    </sec>
    <sec id="Sec18">
      <title>scRNA-seq data analysis</title>
      <p id="Par62">10x Genomics scRNA-seq data of first-trimester placental cells were generated by Vento-tormo et al. [<xref ref-type="bibr" rid="CR23">23</xref>], which contained five donors. Reads were aligned against the hg19 human reference genome using the Cell Ranger Single-Cell Software Suite (version 3.0, 10x Genomics). Reads from three cell types (VCTs, EVT, and SCTs) were individually aggregated into pseudo-bulk bam files for each donor. Cell type annotations were obtained from Vento-tormo et al. [<xref ref-type="bibr" rid="CR23">23</xref>]. MAAPER (v1.1.0) was then applied to the pseudo-bulk bam files for PAS prediction and differential APA analysis. Same thresholds were used as in the QuantSeq FWD data analysis. Data representation by tSNE based on gene expression levels was carried out using the R package Seurat (version 3.1.2) [<xref ref-type="bibr" rid="CR38">38</xref>]. For method comparison, scAPA (v0.1.0) and Sierra (v0.99.24) were applied to the same bam files using default parameters.</p>
      <p id="Par63">10x Genomics scRNA-seq data of third-trimester placental cells were generated by Tsang et al. [<xref ref-type="bibr" rid="CR24">24</xref>], which included four donors. Reads were processed in the same way as the first-trimester data. MAAPER (v1.1.0) was then applied to the pseudo-bulk bam files of VCTs, EVTs, and SCTs. For the differential expression analysis between the two trimesters, we first normalized the read counts by the library sizes of individual cells. Since the two datasets were generated from two independent studies, we calculated gene expression levels in each donor as the log2 ratio of normalized read counts between EVTs (or SCTs) and VCTs to control for technical variability. Then, the expression levels were compared using two-sided t tests and the 1000 most significant genes were used for GO enrichment analysis.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2429_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Supplementary materials.</bold> It includes all supplementary tables and figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2429_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Andrew Kossenkov, Chuwei Zhong, and Luyang Wang for helpful comments and testing of our program. Computational resources were provided by the Office of Advanced Research Computing (OARC) at Rutgers, The State University of New Jersey.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par64">Barbara Cheifet was the primary editor of this article and managed the editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par65">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>WVL and BT conceived the analyses. DZ and BT designed the QuantSeq experiments and DZ performed the experiments. WVL and BT developed the method and WVL implemented the method and software. WVL and RW analyzed the data. WVL and BT wrote the paper. The authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ information</title>
      <p id="Par66">Twitter handles: @vivianstats (Wei Vivian Li); @BinTian_Lab (Bin Tian).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by NIH grants (R01 GM 084089 and R01 GM129069) to BT, and NJ ACTS BERD Mini-Method Grant (a component of the NIH under Award Number UL1TR0030117), Rutgers Busch Biomedical Grant, and Rutgers School of Public Health Pilot Grant to WVL.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The MAAPER method has been implemented as an R package, which is available at Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/Vivianstats/MAAPER">https://github.com/Vivianstats/MAAPER</ext-link>) [<xref ref-type="bibr" rid="CR39">39</xref>]. The source code is available at the zenodo repository (DOI: 10.5281/zenodo.4760264) under the GPLv2 license [<xref ref-type="bibr" rid="CR40">40</xref>]. QuantSeq FWD and REV datasets generated in this study have been deposited into the GEO database under the accession number GSE164958 [<xref ref-type="bibr" rid="CR41">41</xref>]. 10x Genomics scRNA-seq data of first-trimester placental cells were generated by Vento-tormo et al. [<xref ref-type="bibr" rid="CR23">23</xref>] and downloaded from ArrayExpress with accession number E-MTAB-6701. 10x Genomics scRNA-seq data of third-trimester placental cells were generated by Tsang et al. [<xref ref-type="bibr" rid="CR24">24</xref>] and downloaded from the European Genome-Phenome Archive with accession number EGAS00001002449.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par67">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par68">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Manley</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Alternative polyadenylation of mRNA precursors</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.116</pub-id>
        <?supplied-pmid 27677860?>
        <pub-id pub-id-type="pmid">27677860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruber</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Alternative cleavage and polyadenylation in health and disease</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>10</issue>
        <fpage>599</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0145-z</pub-id>
        <?supplied-pmid 31267064?>
        <pub-id pub-id-type="pmid">31267064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Nourse J, Spada S, Danckwardt S. Emerging roles of RNA 3'-end cleavage and polyadenylation in pathogenesis, diagnosis and therapy of human disorders. Biomolecules. 2020;10(6). 10.3390/biom10060915.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Donehower</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Neilson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Dynamic analyses of alternative polyadenylation from RNA-seq reveal a 3'-UTR landscape across seven tumour types</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>5274</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms6274</pub-id>
        <?supplied-pmid 25409906?>
        <pub-id pub-id-type="pmid">25409906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grassi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mariella</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lembo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Molineris</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Provero</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Roar: detecting alternative polyadenylation with standard mRNA sequencing libraries</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>423</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1254-8</pub-id>
        <?supplied-pmid 27756200?>
        <pub-id pub-id-type="pmid">27756200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ha</surname>
            <given-names>KCH</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>QAPA: a new method for the systematic analysis of alternative polyadenylation from RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1414-4</pub-id>
        <?supplied-pmid 29592814?>
        <pub-id pub-id-type="pmid">29592814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>APAlyzer: a bioinformatics package for analysis of alternative polyadenylation isoforms</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>12</issue>
        <fpage>3907</fpage>
        <lpage>3909</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa266</pub-id>
        <?supplied-pmid 32321166?>
        <pub-id pub-id-type="pmid">32321166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of droplet-based ultra-high-throughput single-cell RNA-seq systems</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <issue>1</issue>
        <fpage>130</fpage>
        <lpage>142</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.10.020</pub-id>
        <?supplied-pmid 30472192?>
        <pub-id pub-id-type="pmid">30472192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shepard</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Flanagan</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Hertel</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Complex and dynamic landscape of RNA polyadenylation revealed by PAS-Seq</article-title>
        <source>RNA</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>761</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.2581711</pub-id>
        <?supplied-pmid 21343387?>
        <pub-id pub-id-type="pmid">21343387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garrett-Engele</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Macisaac</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Sriram</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rohl</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Babak</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A quantitative atlas of polyadenylation in five mammals</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>1173</fpage>
        <lpage>1183</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.132563.111</pub-id>
        <?supplied-pmid 22454233?>
        <pub-id pub-id-type="pmid">22454233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lianoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Ubiquitously transcribed genes use alternative polyadenylation to achieve tissue-specific expression</article-title>
        <source>Genes Dev</source>
        <year>2013</year>
        <volume>27</volume>
        <issue>21</issue>
        <fpage>2380</fpage>
        <lpage>2396</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.229328.113</pub-id>
        <?supplied-pmid 24145798?>
        <pub-id pub-id-type="pmid">24145798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moll</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ante</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reda</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>QuantSeq 3′ mRNA sequencing for RNA quantification</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>i</fpage>
        <lpage>iii</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Clancy</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Preiss</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Boag</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Traven</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Seemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Beilharz</surname>
            <given-names>TH</given-names>
          </name>
        </person-group>
        <article-title>PAT-seq: a method to study the integration of 3'-UTR dynamics with gene expression in the eukaryotic transcriptome</article-title>
        <source>RNA</source>
        <year>2015</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>1502</fpage>
        <lpage>1510</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.048355.114</pub-id>
        <?supplied-pmid 26092945?>
        <pub-id pub-id-type="pmid">26092945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>14049</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Humphreys</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Janbandhu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>JWK</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>KK</given-names>
          </name>
        </person-group>
        <article-title>Sierra: discovery of differential transcript usage from polyA-captured single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>167</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02071-7</pub-id>
        <?supplied-pmid 32641141?>
        <pub-id pub-id-type="pmid">32641141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shulman</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Elkon</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Cell-type-specific analysis of alternative polyadenylation using single-cell transcriptomics data</article-title>
        <source>Nucleic acids research</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>19</issue>
        <fpage>10027</fpage>
        <lpage>10039</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz781</pub-id>
        <?supplied-pmid 31501864?>
        <pub-id pub-id-type="pmid">31501864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nambiar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>PolyA_DB 3 catalogs cleavage and polyadenylation sites identified by deep sequencing in multiple genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D315</fpage>
        <lpage>d319</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1000</pub-id>
        <?supplied-pmid 29069441?>
        <pub-id pub-id-type="pmid">29069441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoque</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>You</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Yehia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Analysis of alternative cleavage and polyadenylation by 3' region extraction and deep sequencing</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>133</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2288</pub-id>
        <?supplied-pmid 23241633?>
        <pub-id pub-id-type="pmid">23241633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Cellular stress alters 3'UTR landscape through alternative polyadenylation and isoform-specific degradation</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2268</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04730-7</pub-id>
        <?supplied-pmid 29891946?>
        <pub-id pub-id-type="pmid">29891946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Graber</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Signals for pre-mRNA cleavage and polyadenylation</article-title>
        <source>Wiley Interdiscip Rev RNA</source>
        <year>2012</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>385</fpage>
        <lpage>396</lpage>
        <pub-id pub-id-type="doi">10.1002/wrna.116</pub-id>
        <?supplied-pmid 22012871?>
        <pub-id pub-id-type="pmid">22012871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rowley</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Oligo(dT) primer generates a high frequency of truncated cDNAs through internal poly(A) priming during reverse transcription</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>9</issue>
        <fpage>6152</fpage>
        <lpage>6156</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.092140899</pub-id>
        <?supplied-pmid 11972056?>
        <pub-id pub-id-type="pmid">11972056</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Botting</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Turco</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Polanski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goncalves</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell reconstruction of the early maternal-fetal interface in humans</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>563</volume>
        <issue>7731</issue>
        <fpage>347</fpage>
        <lpage>353</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0698-6</pub-id>
        <?supplied-pmid 30429548?>
        <pub-id pub-id-type="pmid">30429548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsang</surname>
            <given-names>JCH</given-names>
          </name>
          <name>
            <surname>Vong</surname>
            <given-names>JSL</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>LCY</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lui</surname>
            <given-names>KO</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>YB</given-names>
          </name>
          <collab>To KF</collab>
          <name>
            <surname>Cheng</surname>
            <given-names>YKY</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>RWK</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>YMD</given-names>
          </name>
        </person-group>
        <article-title>Integrative single-cell and cell-free plasma RNA transcriptomics elucidates placental cellular dynamics</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>37</issue>
        <fpage>E7786</fpage>
        <lpage>E7795</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1710470114</pub-id>
        <?supplied-pmid 28830992?>
        <pub-id pub-id-type="pmid">28830992</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baljinnyam</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ogami</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Hoque</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Manley</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Widespread transcript shortening through alternative polyadenylation in secretory cell differentiation</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>3182</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16959-2</pub-id>
        <?supplied-pmid 32576858?>
        <pub-id pub-id-type="pmid">32576858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>A large-scale analysis of mRNA polyadenylation of human and mouse genes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>201</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki158</pub-id>
        <?supplied-pmid 15647503?>
        <pub-id pub-id-type="pmid">15647503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrmann</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kanitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Artimo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gruber</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PolyASite 2.0: a consolidated atlas of polyadenylation sites from 3' end sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>D1</issue>
        <fpage>D174</fpage>
        <lpage>d179</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz918</pub-id>
        <?supplied-pmid 31617559?>
        <pub-id pub-id-type="pmid">31617559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>WV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>997</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03405-7</pub-id>
        <?supplied-pmid 29520097?>
        <pub-id pub-id-type="pmid">29520097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Gao Y, Li L, Amos CI, Li W. Analysis of alternative polyadenylation from single-cell RNA-seq using scDaPars reveals cell subpopulations invisible to gene expression. Genome Res.  2021;pp.gr-271346. 10.1101/gr.271346.120.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Rango</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kertschanska</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alfer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beier</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <article-title>Apoptosis of extravillous trophoblast cells limits the trophoblast invasion in uterine but not in tubal pregnancy during first trimester</article-title>
        <source>Placenta</source>
        <year>2003</year>
        <volume>24</volume>
        <issue>10</issue>
        <fpage>929</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="doi">10.1016/S0143-4004(03)00168-1</pub-id>
        <pub-id pub-id-type="pmid">14580375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>On the interpretation of χ 2 from contingency tables, and the calculation of P</article-title>
        <source>J R Stat Soc</source>
        <year>1922</year>
        <volume>85</volume>
        <issue>1</issue>
        <fpage>87</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.2307/2340521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>WV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>AIDE: annotation-assisted isoform discovery with high precision</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>12</issue>
        <fpage>2056</fpage>
        <lpage>2072</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.251108.119</pub-id>
        <?supplied-pmid 31694868?>
        <pub-id pub-id-type="pmid">31694868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Stat Soc Ser B (Methodological)</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the False Discovery Rate - a Practical and Powerful Approach to Multiple Testing</article-title>
        <source>J R Stat Soc Ser B Stat Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A model for paired-multinomial data and its application to analysis of data on a taxonomic tree</article-title>
        <source>Biometrics</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>1266</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12681</pub-id>
        <?supplied-pmid 28369713?>
        <pub-id pub-id-type="pmid">28369713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bushnell</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>BBMap: a fast, accurate, splice-aware aligner</source>
        <year>2014</year>
        <publisher-loc>Berkeley</publisher-loc>
        <publisher-name>Lawrence Berkeley National Lab. (LBNL)</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Li WV: Github repository of MAAPER. Github. 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/Vivianstats/MAAPER">https://github.com/Vivianstats/MAAPER</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Li WV: Source code of MAAPER analyses. zenodo. 2021. 10.5281/zenodo.4760264.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Li WV, Zheng D, Wang R, Tian B: QuantSeq FWD and QuantSeq REV using RNA samples from mouse NIH3T3 cells. Gene Expression Omnibus. 2021. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE164958">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE164958</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
