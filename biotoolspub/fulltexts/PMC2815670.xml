<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2815670</article-id>
    <article-id pub-id-type="publisher-id">dz5186</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444909052925</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444909052925</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>PHENIX</italic>: a comprehensive Python-based system for macromolecular structure solution</article-title>
      <alt-title>
        <italic>PHENIX</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Adams</surname>
          <given-names>Paul D.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="aff" rid="b">b</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Afonine</surname>
          <given-names>Pavel V.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bunkóczi</surname>
          <given-names>Gábor</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Vincent B.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davis</surname>
          <given-names>Ian W.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
        <xref ref-type="author-notes" rid="aunote1">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Echols</surname>
          <given-names>Nathaniel</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Headd</surname>
          <given-names>Jeffrey J.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hung</surname>
          <given-names>Li-Wei</given-names>
        </name>
        <xref ref-type="aff" rid="e">e</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kapral</surname>
          <given-names>Gary J.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grosse-Kunstleve</surname>
          <given-names>Ralf W.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCoy</surname>
          <given-names>Airlie J.</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moriarty</surname>
          <given-names>Nigel W.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oeffner</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Read</surname>
          <given-names>Randy J.</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>David C.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>Jane S.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Terwilliger</surname>
          <given-names>Thomas C.</given-names>
        </name>
        <xref ref-type="aff" rid="e">e</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwart</surname>
          <given-names>Peter H.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <aff id="a"><label>a</label>Lawrence Berkeley National Laboratory, Berkeley, CA 94720, <country>USA</country></aff>
      <aff id="b"><label>b</label>Department of Bioengineering, UC Berkeley, CA 94720, <country>USA</country></aff>
      <aff id="c"><label>c</label>Department of Haematology, University of Cambridge, Cambridge Institute for Medical Research, Wellcome Trust/MRC Building, Cambridge CB2 0XY, <country>England</country></aff>
      <aff id="d"><label>d</label>Department of Biochemistry, Duke University Medical Center, Durham, NC 27710, <country>USA</country></aff>
      <aff id="e"><label>e</label>Los Alamos National Laboratory, Los Alamos, NM 87545, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>pdadams@lbl.gov</email></corresp>
      <fn id="aunote1">
        <label>‡</label>
        <p>Current address: GrassRoots Biotechnology, 598 Airport Boulevard, Morrisville, NC 27560, USA.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>66</volume>
    <issue>Pt 2</issue>
    <issue-id pub-id-type="publisher-id">d100200</issue-id>
    <fpage>213</fpage>
    <lpage>221</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>10</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>12</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Adams et al. 2010</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444909052925">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>The <italic>PHENIX</italic> software for macromolecular structure determination is described.</p>
    </abstract>
    <abstract>
      <p>Macromolecular X-ray crystallography is routinely applied to understand biological processes at a molecular level. How­ever, significant time and effort are still required to solve and complete many of these structures because of the need for manual interpretation of complex numerical data using many software packages and the repeated use of interactive three-dimensional graphics. <italic>PHENIX</italic> has been developed to provide a comprehensive system for macromolecular crystallo­graphic structure solution with an emphasis on the automation of all procedures. This has relied on the development of algorithms that minimize or eliminate subjective input, the development of algorithms that automate procedures that are traditionally performed by hand and, finally, the development of a framework that allows a tight integration between the algorithms.</p>
    </abstract>
    <kwd-group>
      <kwd>
        <italic>PHENIX</italic>
      </kwd>
      <kwd>Python</kwd>
      <kwd>macromolecular crystallography</kwd>
      <kwd>algorithms</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Foundations</title>
    <sec id="sec1.1">
      <label>1.1.</label>
      <title><italic>PHENIX</italic> architecture</title>
      <p>The <italic>PHENIX</italic> (Adams <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb2"> ▶</xref>) architecture is designed from the ground up as a hybrid system of tightly integrated interpreted (‘scripted’) and compiled software modules. A mix of scripted and compiled components is invariably found in all major successful crystallographic packages, but often the scripting is added as an afterthought in an <italic>ad hoc</italic> fashion using tools that predate the object-oriented programming era. While such <italic>ad hoc</italic> systems are quickly established, they tend to become a severe maintenance burden as they grow. In addition, users are often forced into many time-consuming routine tasks such as manually converting file formats. In <italic>PHENIX</italic>, the scripting layer is the heart of the system. With only a few exceptions, all major functionality is implemented as modules that are exclusively accessed <italic>via</italic> the scripting interfaces. The object-oriented Python scripting language (Lutz &amp; Ascher, 1999<xref ref-type="bibr" rid="bb29"> ▶</xref>) is used for this purpose. In about two decades, a large developer/user community has produced millions of lines of highly uniform, interoperable, mature and openly available sources covering all aspects of programming ranging from simple file handling to highly sophisticated network communication and fully featured cross-platform graphical interfaces. Embedding crystallographic methods into this environment enables an unprecedented degree of automation, stability and portability. By design, the object-oriented programming model fosters shared collaborative development by multiple groups. It is routine practice to hierarchically recombine modules written by different groups into ever more complex procedures that appear uniform from the outside. A more detailed overview of the key software technology leading to all these advances, presented in the context of crystallography, can be found in Grosse-Kunstleve <italic>et al.</italic> (2002<xref ref-type="bibr" rid="bb18"> ▶</xref>).</p>
      <p>In addition to the advantages outlined in the previous paragraph, the scripting language is generally most efficient for the rapid development of new algorithms. However, run­time performance considerations often dictate that numerically intensive calculations are eventually implemented in a compiled language. The first choice of a compiled language is of course to reuse the same language environment as used for the scripting language itself, which is a C/C++ environment. Not only is this the mainstream software environment on all major platforms used today, but with probably hundreds of millions of lines of C/C++ sources in existence it is an environment that is virtually guaranteed to thrive in the long term. An in-depth discussion of the combined use of Python and C++ can be found in Grosse-Kunstleve <italic>et al.</italic> (2002<xref ref-type="bibr" rid="bb18"> ▶</xref>) and Abrahams &amp; Grosse-Kunstleve (2003<xref ref-type="bibr" rid="bb1"> ▶</xref>). This model is used throughout the <italic>PHENIX</italic> system.</p>
    </sec>
    <sec id="sec1.2">
      <label>1.2.</label>
      <title>Graphical user interface</title>
      <p>A new graphical user interface (GUI) for <italic>PHENIX</italic> was introduced in version 1.4. It uses the open-source wxPython toolkit, which provides a ‘native’ look on each operating system. Development has focused on providing interfaces around the existing command-line programs with minimal modification, using the same underlying configuration system (<italic>libtbx.phil</italic>) as used by most <italic>PHENIX</italic> programs as a template to automatically generate controls. Because these programs are implemented primarily as Python modules, complex data including models, reflections and other viewable data may be exchanged with the GUI without resorting to parsing log files. The current <italic>PHENIX</italic> release (version 1.5) includes GUIs for <italic>phenix.refine</italic> (Afonine <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb5"> ▶</xref>), <italic>phenix.xtriage</italic> (Zwart <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb75"> ▶</xref>), the <italic>AutoSol</italic> (Terwilliger <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb60"> ▶</xref>), <italic>AutoBuild</italic> (Terwilliger, Grosse-Kunstleve, Afonine, Moriarty, Adams <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb62"> ▶</xref>) and <italic>LigandFit</italic> (Terwilliger <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb65"> ▶</xref>) wizards, the restraints editor <italic>REEL</italic>, all of the validation tools and several utilities for creating and manipulating maps and reflection files. More recent builds of <italic>PHENIX</italic> contain a new GUI for the <italic>AutoMR</italic> wizard and future releases will include a new interface for <italic>Phaser</italic> (McCoy <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb31"> ▶</xref>).</p>
      <p>Intrinsically graphical data is visualized with embedded graphs (using the free matplotlib Python library) or a simple OpenGL viewer. This simplifies the most complex parameters, such as atom selections in <italic>phenix.refine</italic>, which can be visual­ized or picked interactively with the built-in viewer. The GUI also serves as a platform for additional automation and user customization. Similarly to the <italic>CCP</italic>4 interface (<italic>CCP</italic>4<italic>i</italic>; Potterton <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb77"> ▶</xref>), <italic>PHENIX</italic> manages data and task history for separate user-defined projects. Default parameters and input files can be specified for each project; for instance, the generation of ligand restraints from the <italic>phenix.refine</italic> GUI gives the user the option of automatically loading these restraints in future runs.</p>
      <p>The popularity of Python as a scientific programming language has led to its use in many other structural-biology applications, especially molecular-graphics software. The <italic>PHENIX</italic> GUI includes extension modules for the modeling programs <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb15"> ▶</xref>) and <italic>PyMOL</italic> (DeLano, 2002<xref ref-type="bibr" rid="bb14"> ▶</xref>), both of which are controlled remotely from <italic>PHENIX</italic> using the XML-RPC protocol. This allows the interfaces to integrate seamlessly; any model or map in <italic>PHENIX</italic> can be automatically opened in <italic>Coot</italic> with a single click. In programs that iteratively rebuild or refine structures, such as <italic>AutoBuild</italic> and <italic>phenix.refine</italic>, the current model and maps will be continually updated in <italic>Coot</italic> and/or <italic>PyMOL</italic> as soon as they are available. In the validation utilities, clicking on any atom or residue flagged for poor statistics will recentre the graphics windows on that atom. Remote control of the <italic>PHENIX</italic> GUI is also simple using the same protocol and simple extensions to the <italic>Coot</italic> interface provide direct launching of <italic>phenix.refine</italic> with a model pre-loaded.</p>
    </sec>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Analysis of experimental data</title>
    <p><italic>PHENIX</italic> has a range of tools for the analysis, validation and manipulation of X-ray diffraction data. A comprehensive tool for analyzing X-ray diffraction data is <italic>phenix.xtriage</italic> (Zwart <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb75"> ▶</xref>), which carries out tests ranging from space-group determination and detection of twinning to detection of anomalous signal. These tests provide the user and the various wizards with a set of statistics that characterize a data set. For analysis of twinning, <italic>phenix.xtriage</italic> consolidates a number of statistics to provide a balanced verdict of possible symmetry and twin-related issues with the data. <italic>Phenix.xtriage</italic> provides the user with feedback on the overall characteristics of the data. Routine usage of <italic>phenix.xtriage</italic> during or immediately after data collection has resulted in the timely discovery of twinning or other issues (Flynn <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb16"> ▶</xref>; Kostelecky <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb23"> ▶</xref>). Detection of these idiosyncrasies in the data typically reduces the overall effort in a successful structure determination.</p>
    <p>A likelihood-based estimation of the overall anisotropic scale factor is performed using the likelihood formalism described by Popov &amp; Bourenkov (2003<xref ref-type="bibr" rid="bb41"> ▶</xref>). Database-derived standard Wilson plots for proteins and nucleic acids are used to detect anomalies in the mean intensity. These anomalies may arise from ice rings or other issues (Morris <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb40"> ▶</xref>). Data strength and low-resolution completeness are also analysed. The presence of anomalous signal is detected by analysis of the measurability, a quantity expressing the fraction of statistically significant Bijvoet differences in a data set (Zwart, 2005<xref ref-type="bibr" rid="bb74"> ▶</xref>). The native Patterson function is used to detect the presence of pseudo-translational symmetry. A database-derived empirical distribution of maximum peak heights is used to assign significance to detected peaks in the Patterson function.</p>
    <p>A comprehensive automated twinning analysis is per­formed. Twin laws are derived from first principles to facilitate the identification of pseudo-merodehral cases. Amplitude and intensity ratios, 〈|<italic>E</italic>
            <sup>2</sup> − 1|〉 values, the <italic>L</italic>-statistic (Padilla &amp; Yeates, 2003<xref ref-type="bibr" rid="bb38"> ▶</xref>) and <italic>N</italic>(<italic>Z</italic>) plots are derived from data cut to the resolution limit suggested by the data-strength analysis. The removal of shells of data with relatively high noise content greatly improves the automated interpretation of these statistics. A Britton plot, <italic>H</italic>-test and a likelihood-derived approach are used to estimate twin fractions when twin laws are present. If a model has been supplied, an <italic>R versus R</italic> (Lebedev <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb24"> ▶</xref>) analysis is carried out. This type of analysis is of particular use when dealing with pseudo-symmetry, space-group problems and twinning (Zwart <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb76"> ▶</xref>).</p>
    <p>To test for inconsistent indexing between different data sets, a set of reindexing laws is derived from first principles given the unit cells and space groups of the sample and reference data sets. A correlation analysis suggests the most likely choice of reindexing of the data. Analysis of the metric symmetry of the unit cell provides a number of likely point groups. A likelihood-inspired method is used to suggest the most likely point group of the data. Subsequent analysis of systematic absences in a likelihood framework ranks subsequent space-group possibilities (details to be published).</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Substructure determination, phasing and molecular replacement</title>
    <p>After ensuring that the diffraction data are sound and understood, the next critical necessity for solving a structure is the determination of phases using one of several strategies (Adams, Afonine <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb3"> ▶</xref>).</p>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Substructure determination</title>
      <p>The substructure-determination procedure implemented as <italic>phenix.hyss</italic> (<italic>Hybrid Substructure Search</italic>; Grosse-Kunstleve &amp; Adams, 2003<xref ref-type="bibr" rid="bb19"> ▶</xref>) combines the multi-trial dual-space recycling approaches pioneered by <italic>Shake-and-Bake</italic> (Miller <italic>et al.</italic>, 1994<xref ref-type="bibr" rid="bb34"> ▶</xref>) and later <italic>SHELXD</italic> (Sheldrick, 2008<xref ref-type="bibr" rid="bb48"> ▶</xref>) with the use of the fast translation function (Navaza &amp; Vernoslova, 1995<xref ref-type="bibr" rid="bb37"> ▶</xref>; Grosse-Kunstleve &amp; Brunger, 1999<xref ref-type="bibr" rid="bb20"> ▶</xref>). The fast translation function is the basis for a systematic search in the Patterson function (performed in reciprocal space), in contrast to the stochastic alternative of <italic>SHELXD</italic> (performed in direct space). <italic>Phenix.hyss</italic> is the only substructure-determination program to fully integrate automatic comparison of the substructures found in multiple trials <italic>via</italic> a Euclidean Model Matching procedure (part of the <italic>cctbx</italic> open-source libraries). This allows <italic>phenix.hyss</italic> to detect if the same solution was found multiple times and to terminate automatically if this is the case. Extensive tests with a variety of SAD data sets (Grosse-Kunstleve &amp; Adams, 2003<xref ref-type="bibr" rid="bb19"> ▶</xref>) have led to a parameterization of the procedure that balances runtime considerations and the likelihood that repeated solutions present the correct substructure. In many cases the procedure finishes in seconds if the substructure is detectable from the input data.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Phasing</title>
      <p><italic>Phaser</italic>, available in <italic>PHENIX</italic> as <italic>phenix.phaser</italic>, applies the principle of maximum likelihood to solving crystal structures by molecular replacement, by single-wavelength anomalous diffraction (SAD) or by a combination of both. The likelihood targets take proper account of the effects of different sources of error (and, in the case of SAD phasing, their correlations) and allow different sources of information to be combined. In solving a molecular-replacement problem with a number of different components, the information gained from a partial solution increases the signal in the search for subsequent components. Because the likelihood scores for different models can be directly compared, decisions among models can readily be made as part of automation strategies (discussed below).</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Noncrystallographic symmetry (NCS)</title>
      <p>Noncrystallographic symmetry is an important feature of many macromolecular crystals that can be used to greatly improve electron-density maps. <italic>PHENIX</italic> has tools for the identification of NCS and for using NCS and multiple crystal forms of a macromolecule in phase improvement.</p>
      <p><italic>Phenix.find_ncs</italic> and <italic>phenix.simple_ncs_from_pdb</italic> are tools for the identification of noncrystallographic symmetry in a structure using information from a heavy-atom substructure or an atomic model. <italic>Phenix.simple_ncs_from_pdb</italic> will identify NCS and generate transformations from the chains in a model in a PDB file. <italic>Phenix.find_ncs</italic> will identify NCS from either a heavy-atom substructure (Terwilliger, 2002<italic>a</italic>
               <xref ref-type="bibr" rid="bb53"> ▶</xref>) or the chains in a PDB file and will then compare this NCS with the density in a map to verify that the NCS is actually present.</p>
      <p><italic>Phenix.multi_crystal_average</italic> is a method for combining information from several crystal forms of a structure. It is especially well suited to cases where each crystal form has its own NCS, adjusting phases for each crystal form so that all the NCS copies in all crystals are as similar as possible.</p>
      <p>NCS restraints should normally be applied in density modification and model building in all cases except where there is clear evidence that NCS is not present. In density modification within <italic>PHENIX</italic> the presence of NCS is identified from the heavy-atom sites or from an atomic model if available. The local correlation of density in NCS-related locations is then used automatically to set variable restraints on NCS symmetry in the map. In refinement, NCS symmetry is applied through coordinate restraints, targeting the positions of each NCS copy relative to those of the other NCS-related chains. The default NCS restraints in <italic>PHENIX</italic> are very tight, with targets of 0.05 Å r.m.s. At resolutions lower than about 2.5 Å these tight restraints on NCS should usually be applied. At higher resolutions it may be appropriate to use looser restraints or to remove them altogether. Additionally, if there are segments of the chains that clearly do not obey the NCS relationships they should be excluded from the NCS restraints. Normally this is performed automatically, but it can also be specified explicitly.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Model building, ligand fitting and nucleic acids</title>
    <p>Key steps in the analysis of a macromolecular crystal structure are building an initial core model, identification and fitting of ligands into the electron-density map and building an atomic model for loop regions that are less well defined than the majority of the structure. <italic>PHENIX</italic> has tools for rapid model building of secondary structure and main-chain tracing (<italic>phenix.find_helices_strands</italic>) and for the fitting of flexible ligands (<italic>phenix.ligandfit</italic>) as well as for fitting a set of ligands to a map (<italic>phenix.find_all_ligands</italic>) and for the identification of ligands in a map (<italic>phenix.ligand_identification</italic>). <italic>PHENIX</italic> additionally has a tool for the fitting of missing loops (<italic>phenix.fit_loops</italic>). Validation tools are provided so that the models produced can be validated at each step along the way.</p>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Model building</title>
      <p><italic>Phenix.find_helices_strands</italic> will rapidly build a secondary-structure-only model into a map or very rapidly trace the polypeptide backbone of a model into a map. To build secondary structure in a map, <italic>phenix.find_helices_strands</italic> identifies α-helical regions and β-strand segments, models idealized helices and strands into the corresponding density, allowing for bending of the helices and strands, and assembles these into a composite model. To very rapidly trace the main chain in a map,<italic> phenix.find_helices_strands</italic> finds points along ridgelines of high density where C<sub>α</sub> atoms might be located, identifies pairs and then triplets of these C<sub>α</sub> atoms that have density between the atoms and plausible geometry, constructs all possible connections of these C<sub>α</sub> atoms into nonamers and then identifies all the longest possible chains that can be made by joining the nonamers. This process can build a C<sub>α</sub> model at a rate of about 20 residues per second, yielding a backbone model that can readily be interpreted visually or automatically to evaluate the quality of the map that it is based on.</p>
      <p><italic>Phenix.fit_loops</italic> will fit missing loops in an atomic model. It uses <italic>RESOLVE</italic> model building (Terwilliger, 2003<italic>a</italic>
               <xref ref-type="bibr" rid="bb55"> ▶</xref>,<italic>b</italic>
               <xref ref-type="bibr" rid="bb56"> ▶</xref>,<italic>c</italic>
               <xref ref-type="bibr" rid="bb57"> ▶</xref>) to extend the chain from either end where a loop is missing and to connect the chains into a loop with the expected number of residues.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Ligand fitting</title>
      <p><italic>Phenix.ligandfit</italic> is a tool for fitting a flexible ligand into an electron-density map (Terwilliger <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb65"> ▶</xref>). The key approaches used are breaking the ligand into its component rigid-body parts, finding where each of these can be placed into density, tracing the remainder of the ligand based on the positions of these core rigid-body parts and recombining the best parts of multiple fits while scoring based on the fit to the density.</p>
      <p><italic>Phenix.find_all_ligands</italic> is a tool for finding all the instances of each of several ligands in an electron-density map. <italic>Phenix.find_all_ligands</italic> finds the largest contiguous region of unused density in a map and uses <italic>phenix.ligandfit</italic> to fit each supplied ligand into that density. It then chooses the ligand that has the highest real-space correlation to the density (Terwilliger, Adams <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb59"> ▶</xref>). It then repeats this process until no ligands can be satisfactorily fitted into any remaining density in the map.</p>
      <p><italic>Phenix.ligand_identification</italic> is a tool for identifying which ligands are compatible with unknown electron density in a map (Terwilliger, Adams <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb59"> ▶</xref>). It can search using the 200 most common ligands from the PDB or from a user-supplied list of ligands. <italic>Phenix.ligand_identification</italic> uses <italic>phenix.ligandfit</italic> to fit each ligand to the map and identifies the best-fitting ligand using the real-space correlation and surface complementarity of the ligand and the atoms in the structure surrounding the ligand-binding site.</p>
    </sec>
    <sec id="sec4.3">
      <label>4.3.</label>
      <title>RNA and DNA</title>
      <p>In common with most macromolecular crystallographic tools, <italic>PHENIX</italic> was originally developed with protein structures primarily in mind. Now that nucleic acids, and especially RNA, are increasingly important in large biological structures, the system is being modified in places where subtle differences in procedure are needed rather than just the relevant libraries.</p>
      <p>Model building in <italic>phenix.autobuild</italic> now has a preliminary set of nucleic acid procedures that take advantage of the relatively well determined phosphate and base positions, as well as the preponderance of double helix, and that make use of the RNA backbone conformers recently defined by the RNA Ontology Consortium (Richardson <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb46"> ▶</xref>). Nucleic acid structures benefit significantly from torsion-angle refinement, which has recently been added to the options in <italic>phenix.refine</italic>. A principal problem in RNA models is getting the ribose pucker correct, although it is known to consist almost entirely of either C3′-<italic>endo</italic> (which is commoner and that found in the A-form helix) or C2′-<italic>endo</italic> (Altona &amp; Sundaralingam, 1972<xref ref-type="bibr" rid="bb8"> ▶</xref>). <italic>MolProbity</italic> uses the perpendicular distance from the 3′ phosphate to the line of the C1′—N1/9 glycosidic bond as a reliable diagnostic of ribose pucker (Davis <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb13"> ▶</xref>; Chen <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb12"> ▶</xref>). This same test has now been built into <italic>phenix.refine</italic> to allow the use of pucker-specific target parameters for bond lengths, angles and torsions (Gelbin <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb17"> ▶</xref>) rather than the uneasy compromise values (Parkinson <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb39"> ▶</xref>) used in most pucker-agnostic refinement. Currently, if an incorrect pucker is diagnosed it must usually be fixed by user rebuilding, for instance in <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb15"> ▶</xref>) or in <italic>RNABC</italic> (Wang <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb71"> ▶</xref>). A rebuilding functionality will probably be incorporated into <italic>PHENIX</italic> soon, but in the meantime the refinement will now correctly maintain the geometry of a C2′-<italic>­endo</italic> pucker once it has been built and identified using conformation-specific residue names.</p>
    </sec>
    <sec id="sec4.4">
      <label>4.4.</label>
      <title>Maps, models and avoiding bias</title>
      <p><italic>Phenix.refine</italic> (and the graphical tool <italic>phenix.create_maps</italic>) can produce various types of maps, including anomalous difference, maximum-likelihood weighted (<italic>p</italic>*<italic>mF</italic>
               <sub>obs</sub> − <italic>q</italic>*<italic>DF</italic>
               <sub>model</sub>)exp(<italic>i</italic>α<sub>model</sub>) and regular (<italic>p</italic>*<italic>F</italic>
               <sub>obs</sub> − <italic>q</italic>*<italic>F</italic>
               <sub>model</sub>)exp(<italic>i</italic>α<sub>model</sub>), where <italic>p</italic> and <italic>q</italic> are any user-defined numbers, filled and kick maps. The coefficients <italic>m</italic> and <italic>D</italic> of likelihood-weighted maps (Read, 1986<xref ref-type="bibr" rid="bb43"> ▶</xref>) are computed using test-set reflections as described in Lunin &amp; Skovoroda (1995<xref ref-type="bibr" rid="bb28"> ▶</xref>) and Urzhumtsev <italic>et al.</italic> (1996<xref ref-type="bibr" rid="bb68"> ▶</xref>).</p>
      <p>Data incompleteness, especially systematic incompleteness, can cause map distortions (Lunin, 1988<xref ref-type="bibr" rid="bb27"> ▶</xref>; Tronrud, 1997<xref ref-type="bibr" rid="bb66"> ▶</xref>). An approach to remedying this problem is to replace (‘fill’) missing observations with nonzero values. One can use <italic>DF</italic>
               <sub>model</sub> (similarly to <italic>REFMAC</italic>; Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb36"> ▶</xref>) to replace the missing <italic>F</italic>
               <sub>obs</sub> or use 〈<italic>F</italic>
               <sub>obs</sub>〉, where the <italic>F</italic>
               <sub>obs</sub> are averaged across a resolution bin around the missing <italic>F</italic>
               <sub>obs</sub> value. Based on a limited number of tests, both ‘filling’ schemes produce similar results, reiterating the importance of phases. However, it is important to keep in mind that by replacing missing <italic>F</italic>
               <sub>obs</sub> there is a risk of introducing bias and obviously the more incomplete the data is the larger the risk. At present it is advisable to use both maps simultaneously: filled and not filled.</p>
      <p>An average kick map (AK map; Gunčar <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb21"> ▶</xref>; Turk, 2007<xref ref-type="bibr" rid="bb67"> ▶</xref>; Pražnikar <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb42"> ▶</xref>) is the result of the following procedure. A large ensemble of structures is created where the coordinates of each structure from the ensemble are all randomly shaken. A map is then computed for each structure. Finally, all maps are averaged to generate one AK map. An AK map is expected to have less bias and less noise and to enhance the existing signal and can potentially clarify some initially bad densities.</p>
      <p>A computationally intensive but powerful method of creating a very low-bias map is to carry out iterative model building and refinement while omitting one region of the map from all calculations of structure factors (Terwilliger, Grosse-Kunstleve, Afonine, Moriarty, Adams <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb62"> ▶</xref>). The <italic>phenix.autobuild</italic> iterative-build OMIT map procedure carries this out automatically for either a single OMIT region or for overlapping OMIT regions to create a composite iterative-build OMIT map.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Model, and model-to-data, validation</title>
    <p>The result of crystallographic structure determination is the atomic model. There are three principal components in assessing model quality: the covalent model geometry, the model stereochemistry and the quality of fit between the model and experimental data in both real space and in reciprocal space. All three provide overall measures, and the first two plus the real-space aspect of the third also provide checks for local outliers, which give the best leverage for user intervention to actively improve model accuracy (Arendall <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb9"> ▶</xref>). (Validation of the experimental data was described in §<xref ref-type="sec" rid="sec2"/>2 above.) <italic>PHENIX</italic> includes many individual tools for specific aspects of validation, plus several systems that combine those results into overall summaries. Validation is provided both for user evaluation of the progress and results of a structure solution and also to help inform the automated choices made by other parts of the system.</p>
    <p>Most aspects of the <italic>MolProbity</italic> model-validation tools (Davis <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb13"> ▶</xref>; Chen <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb12"> ▶</xref>) have been adapted or rewritten for integrated use within <italic>PHENIX</italic> and are pre­sented to the user by the new GUI (§<xref ref-type="sec" rid="sec1.2"/>1.2). H atoms are added by <italic>phenix.reduce</italic>, with optimization of entire local hydrogen-bond networks, consideration of the first layer of crystallo­graphic waters and optional correction of side-chain amide or histidine 180° ‘flips’ (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb73"> ▶</xref>). All-atom contacts (Word, Lovell, LaBean <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb72"> ▶</xref>) are calculated by <italic>phenix.probe</italic>, which provides the atomic overlap information needed for the validation of serious all-atom steric clashes and can also be visualized in <italic>Coot</italic>. For the <italic>PHENIX</italic> GUI, the set of <italic>MolProbity</italic>-based tools provides both overall model statistics, such as clashscore and percentage of outliers, and detailed lists of the Ramachandran (Lovell <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb25"> ▶</xref>), rotamer (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb26"> ▶</xref>), C<sub>β</sub> deviation (Lovell <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb25"> ▶</xref>) and clash outliers. Command-line tools are available for these validation methods: <italic>phenix.rotalyze</italic>, <italic>phenix.ramalyze</italic>, <italic>phenix.cbetadev</italic>, <italic>phenix.clashscore</italic>, <italic>phenix.reduce</italic> and <italic>phenix.probe</italic>. Additionally, <italic>phenix.validate_model</italic>, which analyzes the deviations of bond lengths, bond angles, planarity <italic>etc</italic>. from ideal library values, complements the <italic>MolProbity</italic> torsional and atomic clash tools.</p>
    <p><italic>Phenix.real_space_correlation</italic> asserts the local model-to-data correspondence by providing a quantitative measure of how the atomic model fits the electron-density map at the residue or atom level (depending on the resolution). Rapidly obtaining a snapshot of global figures of merit for a crystallo­graphic model and associated experimental data is a frequent task that is performed at all stages of structure solution. This task can be complicated for several reasons: the presence of novel ligands or nonstandard residues in the PDB-format (Berman <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb10"> ▶</xref>) coordinate file, data collected from twinned crystals, various reflection datafile formats, different representation of atomic displacement parameters in the presence of TLS (Schomaker &amp; Trueblood, 1968<xref ref-type="bibr" rid="bb47"> ▶</xref>), experimental data type (X-­ray and/or neutron), files with multiple models and various formatting issues. <italic>Phenix.model_vs_data</italic> is designed to automatically handle all these complications with minimal user input (a PDB file and a reflection data file) and provide a concise summary output. <italic>Phenix.polygon</italic> (Urzhumtseva <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb69"> ▶</xref>) is a graphical tool that is designed to indicate the similarity of validation parameters, such as free <italic>R</italic> value, for a particular structure compared with those deposited in the PDB. This comparison is performed for all other structures solved at similar resolution limits. The result is presented graphically. <italic>Phenix.validation</italic> combines all of the tools described above in one GUI, providing a single place for assessing the results of structure determination.</p>
    <sec id="sec5.1">
      <label>5.1.</label>
      <title>Model and structure-factor manipulation and analysis</title>
      <p><italic>PHENIX</italic> has a range of tools for displaying, analyzing and manipulating structure-factor and model information. <italic>Phenix.mtz.dump</italic> and <italic>phenix.cif_as_mtz</italic> display and convert structure-factor data. <italic>Phenix.print_sequence</italic>, <italic>phenix.pdb_atom_selection</italic> and <italic>phenix.pdbtools</italic> display and manipulate coordinate files.</p>
      <p><italic>Phenix.tls</italic> is a tool for the extraction and manipulation of TLS information. Using this tool, TLS matrices and selections can be extracted from <italic>REFMAC</italic>- or <italic>PHENIX</italic>-formatted PDB file headers and the total or residual atomic <italic>B</italic> factors can be computed and output. Future functionality will include the complete analysis of TLS matrices and their graphical visual­ization.</p>
      <p><italic>Phenix.get_cc_mtz_mtz</italic> and <italic>phenix.get_cc_mtz_pdb</italic> are tools for analyzing the agreement between maps based on a pair of MTZ files or between maps calculated from an MTZ file and a PDB file. The key attributes of these tools are that they automatically search all allowed origin shifts that might relate the two maps and that they write out a modified version of one of the MTZ files or of the PDB file, shifted to match the other.</p>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Structure refinement</title>
    <p><italic>Phenix.refine</italic> is the state-of-the-art crystallographic structure-refinement engine of <italic>PHENIX</italic>. The foundational refinement machinery is a combination of highly efficient programming tools and new or rethought crystallographic algorithms. <italic>Phenix.refine</italic> possesses an extensive set of tools that cover the majority of refinement scenarios at any data resolution from low to ultrahigh. Various reflection-data formats (for example, <italic>CNS</italic>, MTZ and <italic>SHELX</italic>) are recognized automatically. The input experimental data are checked for outliers (Read, 1999<xref ref-type="bibr" rid="bb44"> ▶</xref>; Zwart <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb75"> ▶</xref>) and any reflections identified as such are excluded from the refinement calculations. Twinning can also be taken into account by providing a twin-law operator, which can be obtained using <italic>phenix.xtriage</italic>. Both X-ray and/or neutron diffraction data can be used and an option for joint XN refinement is available (simultaneous refinement against X-­ray and neutron data; Adams, Mustyakimov <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb4"> ▶</xref>). Each refinement run begins with robust mask-based bulk-solvent correction and anisotropic scaling (Afonine <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb5"> ▶</xref>). Tools such as efficient rigid-body refinement (multiple-zones algorithm; Afonine <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb7"> ▶</xref>), simulated-annealing refinement (Brünger <italic>et al.</italic>, 1987<xref ref-type="bibr" rid="bb11"> ▶</xref>) in Cartesian or torsion-angle space (Grosse-Kunstleve <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb78"> ▶</xref>), automatic NCS detection and its use as restraints in refinement are important at low resolution and in the initial stages of refinement. A broad range of atomic displacement parameterizations are available, including grouped isotropic, constrained anisotropic (TLS) and individual atomic isotropic or anisotropic, allowing efficient modelling of atomic displacement parameters at any resolution. Occupancy refinement (grouped, individual, group constrained for alternative conformations or any mixture) can be performed for any user-defined atoms. Atoms in alternative conformations are recognized automatically based on altLoc identifiers in the input PDB file and their occupancies are refined by default. Ordered solvent (water) model updating is integrated into the refinement process.</p>
    <p>The availability of ultrahigh-resolution data makes it possible to visualize the residual density arising from bonding effects; <italic>phenix.refine</italic> employs a novel interatomic scatterers model (Afonine <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb6"> ▶</xref>) to adequately account for these features. A flexible parameterization of H atoms allows their use at any resolution from subatomic (where their parameters can be refined individually) to low resolution (where a riding model is used). Refinement can be performed using a variety of refinement target functions, including maximum likelihood, maximum likelihood with experimental phase information and amplitude least squares. The refinement of coordinates can be performed in real or reciprocal space (allowing dual-space refinement). Novel ligands can easily be included in refinement by providing a corresponding CIF file as input (the CIF file can be automatically created using <italic>phenix.ready_set</italic>).</p>
    <p>Manual fixing of amino-acid side-chain rotamers can be time-consuming, especially for large structures. Although the use of simulated-annealing refinement increases the convergence radius, it can still fail to fit incorrectly modelled side chains into the correct density. <italic>Phenix.refine</italic> has an option for automatic selection of the best rotamer based on a rotamer library (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb26"> ▶</xref>) and optimal fit into the density (details to be published elsewhere). Furthermore, coupling real-space refinement with the built-in rotamer library and available <italic>MolProbity</italic> tools allows the automated identification and robust correction of common systematic errors involving backward-fit conformations for Leu, Thr, Val, Ile and Arg side chains, as developed and tested in the <italic>Autofix</italic> method (Headd <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb22"> ▶</xref>).</p>
    <p><italic>Phenix.refine</italic> allows multi-step complex refinement protocols in which most of the available refinement strategies can be combined with each other and applied to any selected part of the model. For example, a run of <italic>phenix.refine</italic> may perform rigid-body refinement, simulated annealing, individual and grouped <italic>B</italic> factors combined with TLS refinement, constrained occupancy refinement and automatic water picking.</p>
    <p>The output of <italic>phenix.refine</italic> includes various maps (maximum-likelihood weighted, kicked, incompleteness corrected, anomalous difference and those with any user-defined coefficients), complete model and data statistics and PDB file with a formatted REMARK 3 header ready for PDB deposition. The <italic>phenix.refine</italic> GUI is integrated with <italic>Coot</italic> and <italic>PyMOL</italic>, allowing seamless visual analysis of the refined model and associated maps.</p>
    <p><italic>Phenix.refine</italic> is tightly integrated with other <italic>PHENIX</italic> components, making structure solution, building and refinement a one-step process (for example, in the <italic>AutoMR</italic> and <italic>AutoBuild</italic> wizards). It is routinely tested by automatic re-refinement of all models in the PDB for which the experimental data are available.</p>
    <sec id="sec6.1">
      <label>6.1.</label>
      <title>Ligand-coordinate and restraint-geometry generation</title>
      <p>The <italic>electronic Ligand Builder and Optimization Builder</italic> (<italic>eLBOW</italic>; Moriarty <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb35"> ▶</xref>) is a suite of tools designed for the reliable generation of Cartesian coordinates and geometry restraints for both novel and known ligands. In line with the rest of the <italic>PHENIX</italic> package, the <italic>eLBOW</italic> modules are written in Python, with the numerically intensive portions of the code written in C++. <italic>eLBOW</italic> is a flexible platform for converting a majority of common chemical inputs to optimized three-dimensional coordinates and geometry restraints for refinement. Ligand geometries can be minimized using the semi-empirical AM1 quantum-chemical method (Stewart, 2004<xref ref-type="bibr" rid="bb49"> ▶</xref>), a numerically efficient and chemically accurate technique for the class of molecules commonly complexed with or bound to proteins.</p>
      <p>In addition, a graphical user interface for editing geometry restraints and simple geometry manipulation of ligands has been developed. The <italic>Restraints Editor, Especially Ligands</italic> (<italic>REEL</italic>) removes the tedium of manually editing a restraints file by providing a number of commonly performed actions <italic>via</italic> pull-down menus and other interactive features. The effect of changes in the restraints can be immediately reflected in the molecule view to provide user feedback.</p>
      <p>A tool that uses many of the features of <italic>eLBOW</italic> to quickly and easier prepare a protein model for refinement is known as <italic>ReadySet!</italic> The flexibility of the Python interface is exemplified by the use of <italic>Reduce</italic>, <italic>eLBOW</italic> and several smaller portions of the <italic>cctbx</italic> toolkit to add H and/or D atoms to the model, ligands and water and to generate metal-coordination files and geometry restraints for unknown ligands. The files required for covalently bound ligands are also generated.</p>
    </sec>
  </sec>
  <sec id="sec7">
    <label>7.</label>
    <title>Integrated structure determination</title>
    <sec id="sec7.1">
      <label>7.1.</label>
      <title>Why automation?</title>
      <p>Automation has dramatically changed macromolecular crystallography over the past decade, both by greatly speeding up the process of structure solution, model building and refinement and by bringing the tools for structure determination to a much wider group of scientists. As automation becomes increasingly comprehensive, it will allow users to test many more possibilities for structure determination, will allow improved estimation of uncertainties in the final structures and will allow the determination of ever more complex and difficult structures.</p>
      <p>The <italic>PHENIX</italic> environment has been developed with automation as a key and defining feature. Each tool within <italic>PHENIX</italic> can seamlessly and nearly effortlessly be incorporated as part of any other tool or process in <italic>PHENIX</italic>. This means that very complex tasks can be built up from well tested and characterized tools and that tools and higher-level methods can be re-used in many different contexts. With a full automatic regression testing system as an integral part of the <italic>PHENIX</italic> environment, all these tasks and high-level methods are tested daily to ensure the integrity of the entire <italic>PHENIX</italic> system.</p>
    </sec>
    <sec id="sec7.2">
      <label>7.2.</label>
      <title>Automated structure solution</title>
      <p><italic>PHENIX</italic> has fully integrated structure-solution capability for both experimental phasing (MAD, SAD, MIR and com­binations of these), carried out by <italic>phenix.autosol</italic>, and for molecular replacement, performed by <italic>phenix.automr</italic>. Each of these automated procedures feeds directly into the iterative model building, density modification and refinement of <italic>phenix.autobuild</italic>.</p>
      <p><italic>Phenix.autosol</italic> is designed to allow complete automation of experimental phasing while allowing a high degree of flexibility for advanced users. Beginning with structure-factor amplitudes and the sequence of the macromolecule, <italic>phenix.autosol</italic> uses <italic>phenix.solve</italic> (Terwilliger &amp; Berendzen, 1999<xref ref-type="bibr" rid="bb61"> ▶</xref>) to scale all data sets, <italic>phenix.xtriage</italic> (Zwart <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb75"> ▶</xref>) to analyze the data for twinning and to correct any anisotropy in the data and <italic>phenix.hyss</italic> (Grosse-Kunstleve &amp; Adams, 2003<xref ref-type="bibr" rid="bb19"> ▶</xref>) to find potential heavy-atom or anomalously scattering atoms. <italic>Phenix.autosol</italic> carries out experimental phasing with <italic>phenix.phaser</italic> (McCoy <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb33"> ▶</xref>, 2007<xref ref-type="bibr" rid="bb31"> ▶</xref>) or <italic>phenix.solve</italic> (Terwilliger &amp; Berendzen, 1999<xref ref-type="bibr" rid="bb61"> ▶</xref>), density modification with <italic>phenix.resolve</italic> (Terwilliger, 1999<xref ref-type="bibr" rid="bb51"> ▶</xref>) and preliminary model building using the methods in <italic>phenix.autobuild</italic> (Terwilliger, Grosse-Kunstleve, Afonine, Moriarty, Zwart <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb64"> ▶</xref>).</p>
      <p>A key step in automated structure solution is the identification of which of several possible space-group and heavy-atom or anomalously scattering-atom substructures is correct. <italic>Phenix.autosol</italic> uses a Bayesian scoring algorithm based on analysis of the experimental electron-density maps to identify which substructures lead to the best maps (Terwilliger <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb60"> ▶</xref>). The main features of the maps that are used in this evaluation are the skewness of the electron density (non-Gaussian histogram of density with more density in the positive tail than the negative tail) and the correlation of local r.m.s. density (large contiguous regions of high variation where the molecule is located and separate large contiguous regions of low variation where the solvent is located).</p>
      <p><italic>Phenix.autosol</italic> is highly flexible, allowing any combination of experimental data, such as MAD + SIRAS or several SAD data sets. Although it is fully automated, the user can control nearly all aspects of the operation of the procedure, including the scoring criteria and decisions about how certain <italic>phenix.autosol</italic> should be that the correct solution is contained in the current lists of solutions.</p>
      <p><italic>Phenix.autosol</italic> can carry out phasing using a combination of experimental SAD data and molecular-replacement information. If a molecular-replacement model is available, <italic>phenix.autosol</italic> will use <italic>phenix.phaser</italic> (McCoy <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb33"> ▶</xref>, 2007<xref ref-type="bibr" rid="bb31"> ▶</xref>) to complete the anomalous substructure iteratively by con­structing log-likelihood gradient maps for the anomalous scatterers based on the model of the non-anomalous structure and any anomalous scatterers that have already been found. The anomalous substructure is then used along with the model to calculate phases with <italic>phenix.phaser</italic>.</p>
      <p><italic>Phenix.automr</italic> carries out automated likelihood-based molecular replacement using <italic>phenix.phaser</italic> (Read, 2001<xref ref-type="bibr" rid="bb45"> ▶</xref>; McCoy <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb32"> ▶</xref>, 2007<xref ref-type="bibr" rid="bb31"> ▶</xref>; McCoy, 2007<xref ref-type="bibr" rid="bb30"> ▶</xref>). The procedure is highly automated, allowing several copies of each of several components to be placed in a single run, which can also test different possible choices of space group. If there are alternative choices of model for a component, the molecular-replacement calculation can try each of them in turn or combine them as a statistically weighted ensemble. Although the evaluation of the likelihood targets is slow (Read, 2001<xref ref-type="bibr" rid="bb45"> ▶</xref>), the use of fast approximations for the rotation search (Storoni <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb50"> ▶</xref>) and the translation search (McCoy <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb32"> ▶</xref>) gives run times that are competitive with traditional Patterson-based methods. Likelihood has been demonstrated to be more sensitive to the correct solution, particularly in difficult cases (Read, 2001<xref ref-type="bibr" rid="bb45"> ▶</xref>). When there are several copies or several components to place, the ability of the likelihood functions to take advantage of preliminary partial solutions can provide a crucial increase in the signal.</p>
    </sec>
    <sec id="sec7.3">
      <label>7.3.</label>
      <title>Iterative model building, density modification and refinement</title>
      <p><italic>Phenix.autobuild</italic> is a highly integrated and automated procedure for model building and model improvement through iterative model building, density modification and refinement. <italic>Phenix.autobuild</italic> uses <italic>phenix.resolve</italic> (Terwilliger, 2003<italic>a</italic>
               <xref ref-type="bibr" rid="bb55"> ▶</xref>,<italic>b</italic>
               <xref ref-type="bibr" rid="bb56"> ▶</xref>) to carry out model building, model extension, model assembly, loop fitting and building outside existing models. It further uses <italic>phenix.resolve</italic> to improve electron-density maps with statistical density modification, including information from the newly built models as well as that obtained from experiment (<italic>e.g. phenix.autosol</italic>), from NCS (Terwilliger, 2002<italic>b</italic>
               <xref ref-type="bibr" rid="bb54"> ▶</xref>) and from other expected features of electron-density maps such as a flat solvent (Wang, 1985<xref ref-type="bibr" rid="bb70"> ▶</xref>), the presence of secondary-structural features (Terwilliger, 2001<xref ref-type="bibr" rid="bb52"> ▶</xref>) and the presence of local patterns of density characteristic of macromolecules (Terwilliger, 2003<italic>c</italic>
               <xref ref-type="bibr" rid="bb57"> ▶</xref>). To reduce model bias in the procedure, prime-and-switch phasing can also be used (Terwilliger, 2004<xref ref-type="bibr" rid="bb58"> ▶</xref>). <italic>Phenix.autobuild</italic> uses <italic>phenix.refine</italic> (Afonine <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb5"> ▶</xref>) throughout this process to improve the quality of the models that are built.</p>
      <p><italic>Phenix.autobuild</italic> provides two complementary approaches to model building. For cases in which no model or only a preliminary model has been built, <italic>phenix.autobuild</italic> will con­struct a new model considering the main chain of any supplied models as potential coordinates. In cases where a nearly final model is available, <italic>phenix.autobuild</italic> can apply a rebuild-in-place approach in which the polypeptide chain is rebuilt a few residues at a time without changing the register or the overall features of the model.</p>
      <p>The rebuild-in-place approach in <italic>phenix.autobuild</italic> provides a powerful method for the assessment of uncertainties in an atomic model by repetitive rebuilding of the model using different random seeds for each iteration (Terwilliger, Grosse-Kunstleve <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb63"> ▶</xref>). The variability in the coordinates of each atom in the ensemble that is created is a lower bound on the uncertainty of the position of that atom.</p>
    </sec>
  </sec>
  <sec id="sec8" sec-type="conclusions">
    <label>8.</label>
    <title>Conclusions</title>
    <p>Advances in computational methods and algorithms have made it possible to automate the solution of many structures with <italic>PHENIX</italic>. However, many challenges still exist. In particular, the development of automated methods that can be applied at low resolution (worse than 3.0 Å) remains a priority. In this resolution range there are typically too few experimental data to uniquely define the macromolecular structure for automated <italic>ab initio</italic> model building. Thus, methods are required that rely on prior knowledge from existing macromolecular structures to permit productive automated data interpretation. These methods will need to be developed and applied for all stages of structure solution and tightly integrated to maximize the information extracted from the experimental data.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank the <funding-source>NIH</funding-source> (grant <award-id>GM063210</award-id>) and the Phenix Industrial Consortium for support of the Phenix project. This work was supported in part by the US Department of Energy under Contract No. DE-AC02-05CH11231. RJR is supported by a Principal Research Fellowship from the Wellcome Trust (UK). We are grateful to Luc Bourhis and Marat Mustyakimov for contributions to the computational crystallography toolbox and <italic>PHENIX</italic>, Paul Emsley and Bernhard Lohkamp for their guidance interfacing <italic>PHENIX</italic> with <italic>Coot</italic>, the <italic>CCP</italic>4 developers for making the CCP4 library available for inclusion in <italic>PHENIX</italic>, Kevin Cowtan for providing C++ sequence-alignment code, Garib Murshudov and Alexei Vagin for making the monomer library available and our colleagues in the crystallographic community for numerous scientific discussions. We are deeply indebted to David Abrahams for numerous discussions and for accommodating our requirements when developing the Boost.Python library.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Abrahams, D. &amp; Grosse-Kunstleve, R. W. (2003). <italic>C/C++ Users J.</italic><bold>21</bold>, 29–36.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Adams, P. D., Afonine, P., Grosse-Kunstleve, R. W., Read, R. J., Richardson, J. S., Richardson, D. C. &amp; Terwilliger, T. C. (2009). <italic>Curr. Opin. Struct. Biol.</italic><bold>19</bold>, 566–572.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Adams, P. D., Grosse-Kunstleve, R. W., Hung, L.-W., Ioerger, T. R., McCoy, A. J., Moriarty, N. W., Read, R. J., Sacchettini, J. C., Sauter, N. K. &amp; Terwilliger, T. C. (2002). <italic>Acta Cryst.</italic> D<bold>58</bold>, 1948–1954.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Adams, P. D., Mustyakimov, M., Afonine, P. V. &amp; Langan, P. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 567–573.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Afonine, P. V., Grosse-Kunstleve, R. W. &amp; Adams, P. D. (2005). <italic>CCP4 Newsl.</italic><bold>42</bold>, contribution 8.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Afonine, P. V., Grosse-Kunstleve, R. W., Adams, P. D., Lunin, V. Y. &amp; Urzhumtsev, A. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 1194–1197.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Afonine, P. V., Grosse-Kunstleve, R. W., Urzhumtsev, A. &amp; Adams, P. D. (2009). <italic>J. Appl. Cryst.</italic><bold>42</bold>, 607–615.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Altona, C. &amp; Sundaralingam, M. (1972). <italic>J. Am. Chem. Soc.</italic><bold>94</bold>, 8205.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Arendall, W. B., Tempel, W., Richardson, J. S., Zhou, W., Wang, S., Davis, I. W., Liu, Z.-J., Rose, J. P., Carson, W. M., Luo, M., Richardson, D. C. &amp; Wang, B.-C. (2005). <italic>J. Struct. Funct. Genomics</italic>, <bold>6</bold>, 1–11.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., Shindyalov, I. N. &amp; Bourne, P. E. (2000). <italic>Nucleic Acids Res.</italic><bold>28</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Brünger, A. T., Kuriyan, J. &amp; Karplus, M. (1987). <italic>Science</italic>, <bold>235</bold>, 458–460.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Chen, V. B., Arendall, W. B. III, Headd, J. J., Keedy, D. A., Immormino, R. M., Kapral, G. J., Murray, L. W., Richardson, J. S. &amp; Richardson, D. C. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 12–21.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Davis, I. W., Leaver-Fay, A., Chen, V. B., Block, J. N., Kapral, G. J., Wang, X., Murray, L. W., Arendall, W. B. III, Snoeyink, J., Richardson, J. S. &amp; Richardson, D. C. (2007). <italic>Nucleic Acids Res.</italic><bold>35</bold>, W375–W383.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">DeLano, W. L. (2002). <italic>The PyMOL Molecular Graphics System.</italic> DeLano Scientific LLC, Palo Alto, California, USA. http://www.pymol.org.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Flynn, G. E., Black, K. D., Islas, L. D., Sankaran, B. &amp; Zagotta, W. N. (2007). <italic>Structure</italic>, <bold>15</bold>, 671–682.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Gelbin, A., Schneider, B., Clowney, L., Hsieh, S.-H., Olson, W. K. &amp; Berman, H. M. (1996). <italic>J. Am. Chem. Soc.</italic><bold>118</bold>, 519–528.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Grosse-Kunstleve, R. W. &amp; Adams, P. D. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1966–1973.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Grosse-Kunstleve, R. W. &amp; Brunger, A. T. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 1568–1577.</mixed-citation>
    </ref>
    <ref id="bb78">
      <mixed-citation publication-type="other">Grosse-Kunstleve, R. W., Moriarty, N. W. &amp; Adams, P. D. (2009). <italic>Proceedings of ASME 2009 International Design Engineering Technical Conferences</italic>, San Diego, California, 30 August–2 September 2009. Paper #DETC2009-87737. ASME Press.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Grosse-Kunstleve, R. W., Sauter, N. K., Moriarty, N. W. &amp; Adams, P. D. (2002). <italic>J. Appl. Cryst.</italic><bold>35</bold>, 126–136.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Gunčar, G., Klemenčič, I., Turk, B., Turk, V., Karaoglanovic Carmona, A., Juliano, L. &amp; Turk, D. (2000). <italic>Structure</italic>, <bold>8</bold>, 305–313.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Headd, J. J., Immormino, R. M., Keedy, D. A., Emsley, P., Richardson, D. C. &amp; Richardson, J. S. (2009). <italic>J. Struct. Funct. Genomics</italic>, <bold>10</bold>, 83–93.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Kostelecky, B., Saurin, A. T., Purkiss, A., Parker, P. J. &amp; McDonald, N. Q. (2009). <italic>EMBO Rep.</italic><bold>10</bold>, 983–989.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Lebedev, A. A., Vagin, A. A. &amp; Murshudov, G. N. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 83–95.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Lovell, S. C., Davis, I. W., Arendall, W. B. III, de Bakker, P. I. W., Word, J. M., Prisant, M. G., Richardson, J. S. &amp; Richardson, D. C. (2003). <italic>Proteins</italic>, <bold>50</bold>, 437–450.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Lovell, S. C., Word, J. M., Richardson, J. S. &amp; Richardson, D. C. (2000). <italic>Proteins</italic>, <bold>40</bold>, 389–408.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Lunin, V. Yu. (1988). <italic>Acta Cryst.</italic> A<bold>44</bold>, 144–150.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Lunin, V. Yu. &amp; Skovoroda, T. P. (1995). <italic>Acta Cryst.</italic> A<bold>51</bold>, 880–887.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Lutz, M. &amp; Ascher, D. (1999). <italic>Learning Python.</italic> Sebastopol, California, USA: O’Reilly &amp; Associates.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">McCoy, A. J. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 32–41.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">McCoy, A. J., Grosse-Kunstleve, R. W., Adams, P. D., Winn, M. D., Storoni, L. C. &amp; Read, R. J. (2007). <italic>J. Appl. Cryst.</italic><bold>40</bold>, 658–674.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">McCoy, A. J., Grosse-Kunstleve, R. W., Storoni, L. C. &amp; Read, R. J. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 458–464.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">McCoy, A. J., Storoni, L. C. &amp; Read, R. J. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 1220–1228.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Miller, R., Gallo, S. M., Khalak, H. G. &amp; Weeks, C. M. (1994). <italic>J. Appl. Cryst.</italic><bold>27</bold>, 613–621.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Moriarty, N. W., Grosse-Kunstleve, R. W. &amp; Adams, P. D. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 1074–1080.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Morris, R. J., Zwart, P. H., Cohen, S., Fernandez, F. J., Kakaris, M., Kirillova, O., Vonrhein, C., Perrakis, A. &amp; Lamzin, V. S. (2004). <italic>J. Synchrotron Rad.</italic><bold>11</bold>, 56–59.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Murshudov, G. N., Vagin, A. A. &amp; Dodson, E. J. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 240–255.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Navaza, J. &amp; Vernoslova, E. (1995). <italic>Acta Cryst.</italic> A<bold>51</bold>, 445–449.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Padilla, J. E. &amp; Yeates, T. O. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1124–1130.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Parkinson, G., Vojtechovsky, J., Clowney, L., Brünger, A. T. &amp; Berman, H. M. (1996). <italic>Acta Cryst.</italic> D<bold>52</bold>, 57–64.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Popov, A. N. &amp; Bourenkov, G. P. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1145–1153.</mixed-citation>
    </ref>
    <ref id="bb77">
      <mixed-citation publication-type="other">Potterton, E., Briggs, P., Turkenburg, M. &amp; Dodson, E. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1131–1137.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Pražnikar, J., Afonine, P. V., Gunčar, G., Adams, P. D. &amp; Turk, D. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 921–931.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Read, R. J. (1986). <italic>Acta Cryst.</italic> A<bold>42</bold>, 140–149.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Read, R. J. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 1759–1764.</mixed-citation>
    </ref>
    <ref id="bb45">
      <mixed-citation publication-type="other">Read, R. J. (2001). <italic>Acta Cryst.</italic> D<bold>57</bold>, 1373–1382.</mixed-citation>
    </ref>
    <ref id="bb46">
      <mixed-citation publication-type="other">Richardson, J. S., Schneider, B., Murray, L. W., Kapral, G. J., Immormino, R. M., Headd, J. J., Richardson, D. C., Ham, D., Hershkovits, E., Williams, L. D., Keating, K. S., Pyle, A. M., Micallef, D., Westbrook, J. &amp; Berman, H. M. (2008). <italic>RNA</italic>, <bold>14</bold>, 465–481.</mixed-citation>
    </ref>
    <ref id="bb47">
      <mixed-citation publication-type="other">Schomaker, V. &amp; Trueblood, K. N. (1968). <italic>Acta Cryst.</italic> B<bold>24</bold>, 63–76.</mixed-citation>
    </ref>
    <ref id="bb48">
      <mixed-citation publication-type="other">Sheldrick, G. M. (2008). <italic>Acta Cryst.</italic> A<bold>64</bold>, 112–122.</mixed-citation>
    </ref>
    <ref id="bb49">
      <mixed-citation publication-type="other">Stewart, J. J. P. (2004). <italic>J. Mol. Model.</italic><bold>10</bold>, 155–164.</mixed-citation>
    </ref>
    <ref id="bb50">
      <mixed-citation publication-type="other">Storoni, L. C., McCoy, A. J. &amp; Read, R. J. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 432–438.</mixed-citation>
    </ref>
    <ref id="bb51">
      <mixed-citation publication-type="other">Terwilliger, T. C. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 1863–1871.</mixed-citation>
    </ref>
    <ref id="bb52">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2001). <italic>Acta Cryst.</italic> D<bold>57</bold>, 1755–1762.</mixed-citation>
    </ref>
    <ref id="bb53">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2002<italic>a</italic>). <italic>Acta Cryst.</italic> D<bold>58</bold>, 2213–2215.</mixed-citation>
    </ref>
    <ref id="bb54">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2002<italic>b</italic>). <italic>Acta Cryst.</italic> D<bold>58</bold>, 2082–2086.</mixed-citation>
    </ref>
    <ref id="bb55">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2003<italic>a</italic>). <italic>Acta Cryst.</italic> D<bold>59</bold>, 38–44.</mixed-citation>
    </ref>
    <ref id="bb56">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2003<italic>b</italic>). <italic>Acta Cryst.</italic> D<bold>59</bold>, 45–49.</mixed-citation>
    </ref>
    <ref id="bb57">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2003<italic>c</italic>). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1688–1701.</mixed-citation>
    </ref>
    <ref id="bb58">
      <mixed-citation publication-type="other">Terwilliger, T. C. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2144–2149.</mixed-citation>
    </ref>
    <ref id="bb59">
      <mixed-citation publication-type="other">Terwilliger, T. C., Adams, P. D., Moriarty, N. W. &amp; Cohn, J. D. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 101–107.</mixed-citation>
    </ref>
    <ref id="bb60">
      <mixed-citation publication-type="other">Terwilliger, T. C., Adams, P. D., Read, R. J., McCoy, A. J., Moriarty, N. W., Grosse-Kunstleve, R. W., Afonine, P. V., Zwart, P. H. &amp; Hung, L.-W. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 582–601.</mixed-citation>
    </ref>
    <ref id="bb61">
      <mixed-citation publication-type="other">Terwilliger, T. C. &amp; Berendzen, J. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 849–861.</mixed-citation>
    </ref>
    <ref id="bb63">
      <mixed-citation publication-type="other">Terwilliger, T. C., Grosse-Kunstleve, R. W., Afonine, P. V., Adams, P. D., Moriarty, N. W., Zwart, P., Read, R. J., Turk, D. &amp; Hung, L.-W. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 597–610.</mixed-citation>
    </ref>
    <ref id="bb64">
      <mixed-citation publication-type="other">Terwilliger, T. C., Grosse-Kunstleve, R. W., Afonine, P. V., Moriarty, N. W., Adams, P. D., Read, R. J., Zwart, P. H. &amp; Hung, L.-W. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 515–524.</mixed-citation>
    </ref>
    <ref id="bb62">
      <mixed-citation publication-type="other">Terwilliger, T. C., Grosse-Kunstleve, R. W., Afonine, P. V., Moriarty, N. W., Zwart, P. H., Hung, L.-W., Read, R. J. &amp; Adams, P. D. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 61–69.</mixed-citation>
    </ref>
    <ref id="bb65">
      <mixed-citation publication-type="other">Terwilliger, T. C., Klei, H., Adams, P. D., Moriarty, N. W. &amp; Cohn, J. D. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 915–922.</mixed-citation>
    </ref>
    <ref id="bb66">
      <mixed-citation publication-type="other">Tronrud, D. E. (1997). <italic>Methods Enzymol.</italic><bold>277</bold>, 306–319.</mixed-citation>
    </ref>
    <ref id="bb67">
      <mixed-citation publication-type="other">Turk, D. (2007). <italic>Evolving Methods for Macromolecular Crystallo­graphy</italic>, edited by R. J. Read &amp; J. L. Sussman, pp. 111–122. Heidelberg: Springer.</mixed-citation>
    </ref>
    <ref id="bb68">
      <mixed-citation publication-type="other">Urzhumtsev, A. G., Skovoroda, T. P. &amp; Lunin, V. Y. (1996). <italic>J. Appl. Cryst.</italic><bold>29</bold>, 741–744.</mixed-citation>
    </ref>
    <ref id="bb69">
      <mixed-citation publication-type="other">Urzhumtseva, L., Afonine, P. V., Adams, P. D. &amp; Urzhumtsev, A. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 297–300.</mixed-citation>
    </ref>
    <ref id="bb70">
      <mixed-citation publication-type="other">Wang, B.-C. (1985). <italic>Methods Enzymol.</italic><bold>115</bold>, 90–112.</mixed-citation>
    </ref>
    <ref id="bb71">
      <mixed-citation publication-type="other">Wang, X., Kapral, G. J., Murray, L. W., Richardson, D. C., Richardson, J. S. &amp; Snoeyink, J. (2008). <italic>J. Math. Biol.</italic><bold>56</bold>, 253–278.</mixed-citation>
    </ref>
    <ref id="bb72">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., LaBean, T. H., Taylor, H. C., Zalis, M. E., Presley, B. K., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1711–1733.</mixed-citation>
    </ref>
    <ref id="bb73">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1735–1747.</mixed-citation>
    </ref>
    <ref id="bb74">
      <mixed-citation publication-type="other">Zwart, P. H. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 1437–1448.</mixed-citation>
    </ref>
    <ref id="bb75">
      <mixed-citation publication-type="other">Zwart, P. H., Grosse-Kunstleve, R. W. &amp; Adams, P. D. (2005). <italic>CCP4 Newsl.</italic><bold> 43</bold>, contribution 7.</mixed-citation>
    </ref>
    <ref id="bb76">
      <mixed-citation publication-type="other">Zwart, P. H., Grosse-Kunstleve, R. W., Lebedev, A. A., Murshudov, G. N. &amp; Adams, P. D. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 99–107.</mixed-citation>
    </ref>
  </ref-list>
</back>
