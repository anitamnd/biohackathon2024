<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5408808</article-id>
    <article-id pub-id-type="pmid">27993774</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw705</article-id>
    <article-id pub-id-type="publisher-id">btw705</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>KODAMA: an R package for knowledge discovery and data mining</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cacciatore</surname>
          <given-names>Stefano</given-names>
        </name>
        <xref ref-type="aff" rid="btw705-aff1">1</xref>
        <xref ref-type="corresp" rid="btw705-cor1"/>
        <!--<email>s.cacciatore@imperial.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tenori</surname>
          <given-names>Leonardo</given-names>
        </name>
        <xref ref-type="aff" rid="btw705-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luchinat</surname>
          <given-names>Claudio</given-names>
        </name>
        <xref ref-type="aff" rid="btw705-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bennett</surname>
          <given-names>Phillip R</given-names>
        </name>
        <xref ref-type="aff" rid="btw705-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>MacIntyre</surname>
          <given-names>David A</given-names>
        </name>
        <xref ref-type="aff" rid="btw705-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btw705-aff1"><label>1</label>Institute of Reproductive and Developmental Biology, Imperial College London, London, UK</aff>
    <aff id="btw705-aff2"><label>2</label>Department of Clinical and Experimental Medicine, University of Florence, Florence, Italy</aff>
    <aff id="btw705-aff3"><label>3</label>Centro Risonanze Magnetiche, University of Florence, Florence, Italy</aff>
    <author-notes>
      <corresp id="btw705-cor1">To whom correspondence should be addressed. Email: <email>s.cacciatore@imperial.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2016-11-30">
      <day>30</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>4</issue>
    <fpage>621</fpage>
    <lpage>623</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>2</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>11</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw705.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>KODAMA, a novel learning algorithm for unsupervised feature extraction, is specifically designed for analysing noisy and high-dimensional datasets. Here we present an R package of the algorithm with additional functions that allow improved interpretation of high-dimensional data. The package requires no additional software and runs on all major platforms.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>KODAMA is freely available from the R archive CRAN (<ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org">http://cran.r-project.org</ext-link>). The software is distributed under the GNU General Public License (version 3 or later).</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">SPARKS Children’s Medical Research Charity</named-content>
        </funding-source>
        <award-id>P48061</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Career Development Award from the Medical Research Council</named-content>
        </funding-source>
        <award-id>MR/L009226/1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EC funded project PhenoMeNal</named-content>
        </funding-source>
        <award-id>654241</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Knowledge Discovery and Data Mining is an interdisciplinary area focusing upon methodologies for extracting useful knowledge from complex data. With the explosive growth of high-throughput experimental data, data-based solutions are increasingly crucial. We recently published KODAMA, a novel learning algorithm for unsupervised feature extraction, specifically designed for analysing noisy and high-dimensional datasets (<xref rid="btw705-B4" ref-type="bibr">Cacciatore <italic>et al.</italic>, 2014</xref>). This versatile method has been successfully applied to a wide range of disciplines including genomics (<xref rid="btw705-B4" ref-type="bibr">Cacciatore <italic>et al.</italic>, 2014</xref>) and metabolomics (<xref rid="btw705-B10" ref-type="bibr">Priolo <italic>et al.</italic>, 2014</xref>) and has even been used in the analysis of hyper-spectral images (<xref rid="btw705-B6" ref-type="bibr">Cao <italic>et al.</italic>, 2016</xref>). Here, we present for the first time the <italic>KODAMA</italic> package developed for use in the R programming environment.</p>
    <p>The core of the algorithm consists of two main parts. The first step involves random assignment of each sample to a different class. In the second step, the cross-validated accuracy is maximized by an iterative procedure by swapping the class labels (no <italic>a priori</italic> information is needed). The cross-validated accuracy can be calculated by using any supervized classifier. In the current version of KODAMA, two classifiers are implemented: <italic>k</italic>-Nearest Neighbors (<italic>k</italic>NN) and Partial Least Squares (PLS)—Discriminant Analysis (DA). The iterative procedure used in KODAMA leads to suboptimal solutions and must be repeated (100 as default) to average the effects owing to randomness. External class information can be integrated in KODAMA before performing the iterative procedure thereby supporting a semi-supervized approach for highlighting otherwise hidden features of interest. After each run of the procedure, a classification vector with high cross-validated accuracy is obtained. KODAMA subsequently collects and processes these results by constructing a dissimilarity matrix to provide a holistic view of the data while maintaining their intrinsic structure.</p>
    <p>Here, we show that KODAMA demonstrates high capacity to detect different underlying relationships in experimental datasets including patient phenotypes (<xref rid="btw705-B4" ref-type="bibr">Cacciatore <italic>et al.</italic>, 2014</xref>; <xref rid="btw705-B10" ref-type="bibr">Priolo <italic>et al.</italic>, 2014</xref>). We also introduce the possibility of using KODOMA to correlate extracted features describing phenotype with accompanying metadata.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>The revised <italic>KODAMA</italic> package includes improvements in the implementation of the code and seven major new functions: <italic>pls.kodama</italic>, <italic>knn.kodama</italic>, <italic>pls.double.cv</italic>, <italic>knn.double.cv, k.test</italic>, <italic>loads</italic> and <italic>mcplot</italic>.</p>
    <p>The package is computationally efficient with the workhorse functions written in C ++ using Rcpp (<xref rid="btw705-B7" ref-type="bibr">Eddelbuettel, 2011</xref>), RcppArmadillo (<xref rid="btw705-B8" ref-type="bibr">Eddelbuettel and Sanderson, 2014</xref>) and integrating the Approximate Nearest Neighbour Searching (ANN) library (<xref rid="btw705-B2" ref-type="bibr">Arya <italic>et al.</italic>, 1998</xref>). Functions coded in C ++ include <italic>k</italic>NN (<italic>knn.kodama</italic>) and PLS-DA (<italic>pls.kodama</italic>) classifiers and the iterative procedure of KODAMA. The <italic>pls.double.cv</italic> and <italic>knn.double.cv</italic> functions perform double cross-validation procedures using PLS-DA or <italic>k</italic>NN as classifiers, respectively (<xref rid="btw705-B3" ref-type="bibr">Bertini <italic>et al.</italic>, 2012</xref>). The internal parameter (i.e. number of components or <italic>k</italic>) is optimized by maximising the cross-validated coefficient of determination (Q<sup>2</sup>y) obtained by an inner cross-validation on the training sets.</p>
    <p>The <italic>loads</italic> function can be used to extract the variable ranking. After each maximization of the cross-validated accuracy the final label set is used to calculate the loadings of PLS-DA or the logarithm of the <italic>P</italic>-value from the Kruskal-Wallis Rank Sums test. The output of <italic>LOADS</italic> function is the average of these values for each variable of the dataset. The highest values indicate the most important variables.</p>
    <p>The <italic>k.test</italic> function performs a statistical test to assess association between the KODAMA output and any additional related parameters such as clinical metadata. The coefficient of determination (<italic>R</italic><sup>2</sup>) is used to assess the proportion of the variance in the dependent variable (KODAMA output) that is predictable from the independent variable (e.g. clinical parameter) and can thus be used as a measure of the goodness of fit (<xref rid="btw705-B5" ref-type="bibr">Cameron <italic>et al.</italic>, 1997</xref>). A permutation test is performed by randomly sampling the value of the labels to estimate the significance of the observed association.</p>
    <p>The <italic>mcplot</italic> function is now included as a diagnostic solution of the iterative process for maximization of cross-validated accuracy. This function visualizes the values of accuracy step-by-step through each separate iterative process.</p>
    <p>The Shannon Entropy (<xref rid="btw705-B11" ref-type="bibr">Shannon, 1948</xref>), is now implemented as output of the <italic>KODAMA</italic> function and can be used as a measure of unpredictability of information content to select the optimal classifier and its relative parameter.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To demonstrate briefly the performance of the <italic>KODAMA</italic> package, we used the <italic>MetRef</italic> dataset (included in this package), a collection of 873 nuclear magnetic resonance spectra of urine samples from a cohort of 22 healthy donors (11 male and 11 female). <xref ref-type="fig" rid="btw705-F1">Figure 1</xref> shows a comparison between KODAMA and Principal Component Analysis (PCA), an unsupervised method widely used in metabolic profiling (<xref rid="btw705-B1" ref-type="bibr">Aimetti <italic>et al.</italic>, 2012</xref>; <xref rid="btw705-B9" ref-type="bibr">MacIntyre <italic>et al.</italic>, 2010</xref>). As can be observed in <xref ref-type="fig" rid="btw705-F1">Figure 1a</xref>, PCA provides comparatively poor description of the underlying variation in metabolic profiles of urine collected from healthy individuals. In contrast, KODAMA (<xref ref-type="fig" rid="btw705-F1">Fig. 1b</xref>) permits identification of the underlying patient-specific signature of the urine metabolome in an unsupervised fashion. This important biologically relevant information would have been otherwise lost using PCA. The script for generating <xref ref-type="fig" rid="btw705-F1">Figure 1a, b</xref> is included in <xref ref-type="supplementary-material" rid="sup1">Supplementary material</xref>. <xref ref-type="fig" rid="btw705-F1">Figure 1c</xref> highlights spectral features most responsible for separation of patient samples obtained with the <italic>loads</italic> function. Further analysis using the <italic>k.test</italic> function shows a statistically significant association between the KODAMA output with clinical metadata including donor (<italic>P </italic>&lt;<italic> </italic>0.0001) and gender (<italic>P </italic>&lt;<italic> </italic>0.0001).</p>
    <fig id="btw705-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) PCA and (<bold>b</bold>) KODAMA of MetRef dataset. Color coding indicates samples from the same donor. (<bold>c</bold>) Average NMR spectrum of MetRef dataset. Color-code represents the output of the LOADS function. The spectral features with the highest contribution to the spatial separation observed in the KODAMA output are represented in yellow</p>
      </caption>
      <graphic xlink:href="btw705f1"/>
    </fig>
  </sec>
  <sec>
    <title>4 Summary and outlook</title>
    <p>KODAMA represents a valuable tool for performing feature extraction on noisy and high-dimensional datasets. Addition functions facilitate the identification of key features associated with the generated output and are easily interpretable for the user. The K-test permits the identification of significant associations between the KODAMA output and related information.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw705_supp.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank KODAMA users for reporting bugs and usability problems. We thank Svitlana Tyekucheva for useful comments. We also acknowledge Abigail Walker for testing the package.</p>
    <sec>
      <title>Funding</title>
      <p>SC, PRB and DAM are supported by SPARKS Children’s Medical Research Charity (P48061) and Imperial NIHR Biomedical Research Centre. DAM is supported by a Career Development Award from the Medical Research Council (MR/L009226/1). LT is supported by the EC funded project PhenoMeNal (contract 654241).</p>
      <p><italic>Conflict of interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btw705-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aimetti</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Metabonomic analysis of saliva reveals generalized chronic periodontitis signature</article-title>. <source>Metabolomics</source>, <volume>8</volume>, <fpage>465</fpage>–<lpage>474</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Arya</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>An optimal algorithm for approximate nearest neighbor searching</article-title>. <source>J. ACM</source>, <volume>45</volume>, <fpage>891</fpage>–<lpage>923</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bertini</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Metabolomic NMR fingerprinting to identify and predict survival of patients with metastatic colorectal cancer</article-title>. <source>Cancer Res</source>., <volume>72</volume>, <fpage>356</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">22080567</pub-id></mixed-citation>
    </ref>
    <ref id="btw705-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cacciatore</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Knowledge discovery by accuracy maximization</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>., <volume>111</volume>, <fpage>5117</fpage>–<lpage>5122</lpage>.<pub-id pub-id-type="pmid">24706821</pub-id></mixed-citation>
    </ref>
    <ref id="btw705-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cameron</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>An R-squared measure of goodness of fit of some common nonlinear regression models</article-title>. <source>J. Econometrics</source>, <volume>77</volume>, <fpage>1790</fpage>–<lpage>1792</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Automatic band selection using spatial-structure information and classifier-based clustering</article-title>. <source>IEEE J. Stars</source>, <volume>PP</volume>, <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddelbuettel</surname><given-names>D.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Rcpp: seamless R and C ++ integration</article-title>. <source>J. Stat. Softw</source>., <volume>40</volume>, <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddelbuettel</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Sanderson</surname><given-names>C.</given-names></name></person-group> (<year>2014</year>) 
<article-title>RcppArmadillo: accellerating R with high-performance C ++ linear algebra</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>71</volume>, <fpage>1054</fpage>–<lpage>1063</lpage>.</mixed-citation>
    </ref>
    <ref id="btw705-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>MacIntyre</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Serum metabolome analysis by 1H-NMR reveals differences between chronic lymphocytic leukaemia molecular subgroups</article-title>. <source>Leukemia</source>, <volume>24</volume>, <fpage>788</fpage>–<lpage>797</lpage>.<pub-id pub-id-type="pmid">20090781</pub-id></mixed-citation>
    </ref>
    <ref id="btw705-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Priolo</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>AKT1 and MYC induce distinctive metabolic fingerprints in human prostate cancer</article-title>. <source>Cancer Res</source>., <volume>74</volume>, <fpage>7198</fpage>–<lpage>7204</lpage>.<pub-id pub-id-type="pmid">25322691</pub-id></mixed-citation>
    </ref>
    <ref id="btw705-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shannon</surname><given-names>C.E.</given-names></name></person-group> (<year>1948</year>) 
<article-title>A mathematical theory of communication</article-title>. <source>Bell Syst. Tech. J</source>., <volume>27</volume>, <fpage>379</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
