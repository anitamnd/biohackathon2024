<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Biomed Res Int</journal-id>
    <journal-id journal-id-type="iso-abbrev">Biomed Res Int</journal-id>
    <journal-id journal-id-type="publisher-id">BMRI</journal-id>
    <journal-title-group>
      <journal-title>BioMed Research International</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">2314-6133</issn>
    <issn pub-type="epub">2314-6141</issn>
    <publisher>
      <publisher-name>Hindawi Publishing Corporation</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4065698</article-id>
    <article-id pub-id-type="doi">10.1155/2014/910390</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>biomvRhsmm:</italic> Genomic Segmentation with Hidden Semi-Markov Model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5707-513X</contrib-id>
        <name>
          <surname>Du</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murani</surname>
          <given-names>Eduard</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ponsuksili</surname>
          <given-names>Siriluck</given-names>
        </name>
        <xref ref-type="aff" rid="I2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9523-6790</contrib-id>
        <name>
          <surname>Wimmers</surname>
          <given-names>Klaus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="I1"><sup>1</sup>Institute for Genome Biology, Leibniz Institute for Farm Animal Biology, 18196 Dummerstorf, Germany</aff>
    <aff id="I2"><sup>2</sup>Research Group Functional Genomics, Leibniz Institute for Farm Animal Biology, 18196 Dummerstorf, Germany</aff>
    <author-notes>
      <corresp id="cor1">*Klaus Wimmers: <email>wimmers@fbn-dummerstorf.de</email></corresp>
      <fn fn-type="other">
        <p>Academic Editor: Stanley Brul</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <volume>2014</volume>
    <elocation-id>910390</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>11</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Yang Du et al.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="https://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an open access article distributed under the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>High-throughput technologies like tiling array and next-generation sequencing (NGS) generate continuous homogeneous segments or signal peaks in the genome that represent transcripts and transcript variants (transcript mapping and quantification), regions of deletion and amplification (copy number variation), or regions characterized by particular common features like chromatin state or DNA methylation ratio (epigenetic modifications). However, the volume and output of data produced by these technologies present challenges in analysis. Here, a hidden semi-Markov model (HSMM) is implemented and tailored to handle multiple genomic profile, to better facilitate genome annotation by assisting in the detection of transcripts, regulatory regions, and copy number variation by holistic microarray or NGS. With support for various data distributions, instead of limiting itself to one specific application, the proposed hidden semi-Markov model is designed to allow modeling options to accommodate different types of genomic data and to serve as a general segmentation engine. By incorporating genomic positions into the sojourn distribution of HSMM, with optional prior learning using annotation or previous studies, the modeling output is more biologically sensible. The proposed model has been compared with several other state-of-the-art segmentation models through simulation benchmarking, which shows that our efficient implementation achieves comparable or better sensitivity and specificity in genomic segmentation.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>http://dx.doi.org/10.13039/501100001659 Deutsche Forschungsgemeinschaft</funding-source>
        <award-id>DFGWi 1754/14-1</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>1. Introduction</title>
    <p>
The advent of high-throughput technologies like tiling array and massively parallel sequencing has produced a windfall of large-scale genomic data. Analysis of genome-wide data from these experiments generally requires researchers to search for continuous homogeneous segments or signal peaks. These features can represent regulatory regions [<xref rid="B1" ref-type="bibr">1</xref>, <xref rid="B2" ref-type="bibr">2</xref>], transcripts [<xref rid="B3" ref-type="bibr">3</xref>–<xref rid="B6" ref-type="bibr">6</xref>], or regions of deletion or amplification [<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B8" ref-type="bibr">8</xref>]. The objective of these investigations is, in general, the segmentation or partitioning of the genome into nonoverlapping homogeneous segments and the assignation of a biologically sensible class to each segment.</p>
    <p>Various models and computational tools have been developed to handle either the general segmentation problem or particular types of partitioning. Most commonly, the approaches address the detection of chromosomal alterations with array-based comparative genomic hybridization (aCGH) [<xref rid="B9" ref-type="bibr">9</xref>–<xref rid="B18" ref-type="bibr">18</xref>] or SNP array [<xref rid="B19" ref-type="bibr">19</xref>–<xref rid="B23" ref-type="bibr">23</xref>], transcript [<xref rid="B24" ref-type="bibr">24</xref>, <xref rid="B25" ref-type="bibr">25</xref>] and protein-binding site detection [<xref rid="B26" ref-type="bibr">26</xref>, <xref rid="B27" ref-type="bibr">27</xref>] with tiling array, and the identification of gene expression domains [<xref rid="B28" ref-type="bibr">28</xref>, <xref rid="B29" ref-type="bibr">29</xref>]. In recent years, more effort has been devoted to the development of computational tools to deal with read-count data generated from next-generation sequencing (NGS) [<xref rid="B30" ref-type="bibr">30</xref>–<xref rid="B35" ref-type="bibr">35</xref>].</p>
    <p>Many of these computational tools utilize hidden Markov model (HMM) [<xref rid="B9" ref-type="bibr">9</xref>, <xref rid="B13" ref-type="bibr">13</xref>, <xref rid="B19" ref-type="bibr">19</xref>, <xref rid="B20" ref-type="bibr">20</xref>, <xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B23" ref-type="bibr">23</xref>, <xref rid="B26" ref-type="bibr">26</xref>, <xref rid="B32" ref-type="bibr">32</xref>, <xref rid="B33" ref-type="bibr">33</xref>] because of its inherent capability of resolving segmentation tasks. However, a standard HMM cannot easily account for one basic property of genomic data—the physical position of the feature. To our knowledge, there have been few limited attempts to incorporate this positional information into HMM [<xref rid="B13" ref-type="bibr">13</xref>, <xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B23" ref-type="bibr">23</xref>, <xref rid="B26" ref-type="bibr">26</xref>] or to adopt more complex dynamic Bayesian network models [<xref rid="B34" ref-type="bibr">34</xref>]. On the other hand, a hidden semi-Markov model (HSMM), a more generalized form of HMM, could be applied to utilize positional information. Indeed, HSMM was proposed for modeling aCGH data [<xref rid="B18" ref-type="bibr">18</xref>], but the tool did not actually utilize positional information and the implementation is no longer publicly available.</p>
    <p>Here, we implement in the R/Bioconductor [<xref rid="B36" ref-type="bibr">36</xref>, <xref rid="B37" ref-type="bibr">37</xref>] package<italic> biomvRCNS</italic> a novel hidden semi-Markov model,<italic> biomvRhsmm</italic>. This model is specially designed to handle genomic data and tailored to serve as a general segmentation tool for various types of genomic profiles arising from both traditional microarray-based experiments and the recent NGS platform, with native support for modeling spatial patterns carried by genomic position. We also compare the proposed model with several other state-of-the-art segmentation models through simulation benchmarking, which shows that our efficient implementation achieves comparable or better sensitivity and specificity in genomic segmentation.</p>
  </sec>
  <sec id="sec2">
    <title>2. Materials and Methods</title>
    <sec id="sec2.1">
      <title>2.1. Hidden Semi-Markov Model</title>
      <p>A brief summary of the concepts involved and a definition of the hidden semi-Markov model follow. For some experimental data <italic>X</italic>, we have a vector of observations <italic>x</italic>
<sub><italic>t</italic></sub> = (<italic>x</italic>
<sub><italic>t</italic></sub>
<sup>1</sup>,…, <italic>x</italic>
<sub><italic>t</italic></sub>
<sup><italic>N</italic></sup>) made for <italic>N</italic> samples at each time or position <italic>t</italic>, <italic>t</italic> = 1,…, <italic>T</italic>. At each <italic>t</italic>, there is an underlying unobserved state <italic>S</italic>
<sub><italic>t</italic></sub> ∈ <italic>S</italic> = {1,…, <italic>J</italic>}, which depends only on the previous state at <italic>t</italic> − 1, thus forming a length <italic>T</italic> discrete Markov chain with a finite number <italic>J</italic> of possible states. The initial state probability is determined by vector <italic>π</italic>, <italic>π</italic>
<sub><italic>j</italic></sub> = <italic>P</italic>(<italic>S</italic>
<sub>1</sub> = <italic>j</italic>), <italic>j</italic> = 1,…, <italic>J</italic>, with ∑<sub><italic>j</italic>=1</sub>
<sup><italic>J</italic></sup>
<italic>π</italic>
<sub><italic>j</italic></sub> = 1 and <italic>π</italic>
<sub><italic>j</italic></sub> ≥ 0. The conditional probability of the observed variable <italic>x</italic>
<sub><italic>t</italic></sub> given the unobserved (or hidden) state <italic>j</italic> is referred to as the emission density <italic>B</italic>, <italic>b</italic>
<sub><italic>tj</italic></sub> = <italic>P</italic>(<italic>X</italic>
<sub><italic>t</italic></sub> = <italic>x</italic>
<sub><italic>t</italic></sub> | <italic>S</italic>
<sub><italic>t</italic></sub> = <italic>j</italic>). The transition matrix <italic>A</italic>, giving the probabilities of moving from one state to another, is formulated as <italic>a</italic>
<sub><italic>ij</italic></sub> = <italic>P</italic>(<italic>S</italic>
<sub><italic>t</italic>+1</sub> = <italic>j</italic> | <italic>S</italic>
<sub><italic>t</italic></sub> = <italic>i</italic>), with ∑<sub><italic>j</italic>=1</sub>
<sup><italic>J</italic></sup>
<italic>a</italic>
<sub><italic>ij</italic></sub> = 1 and <italic>a</italic>
<sub><italic>ij</italic></sub> ≥ 0. Thus an HMM can be defined by <italic>θ</italic> = (<italic>π</italic>, <italic>A</italic>, <italic>B</italic>).</p>
      <p>A semi-Markov chain can be considered as a two-layer mixture, an embedded first-order Markov chain representing the transitions between distinct states—which follows the standard definition of HMM—and an occupancy distribution attached to each nonabsorbing state of the embedded first-order Markov chain.</p>
      <p>The discrete state occupancy distribution or the sojourn distribution, <italic>D</italic>, is defined as the probability of spending <italic>u</italic> consecutive time steps in state <italic>j</italic>, which is geometrically distributed for a normal HMM, <italic>d</italic>
<sub><italic>j</italic></sub>(<italic>u</italic>) = <italic>a</italic>
<sub><italic>jj</italic></sub>
<sup><italic>u</italic>−1</sup>(1 − <italic>a</italic>
<sub><italic>jj</italic></sub>). The hidden semi-Markov model, with the sojourn distribution explicitly specified using a common distribution, can be defined by <italic>θ</italic> = (<italic>π</italic>, <italic>A</italic>, <italic>B</italic>, <italic>D</italic>). The explicit modeling of sojourn time immediately enables the full inclusion of genomic distance in the segmentation process. A complete likelihood (<xref ref-type="disp-formula" rid="EEq1">1</xref>) of the HSMM is given in [<xref rid="B38" ref-type="bibr">38</xref>] with survivor function <italic>D</italic>
<sub><italic>i</italic></sub>(<italic>u</italic>) = ∑<sub><italic>v</italic>≥<italic>u</italic></sub>
<italic>d</italic>
<sub><italic>i</italic></sub>(<italic>v</italic>) representing the sojourn time spent in the last state.</p>
      <p>Consider
<disp-formula id="EEq1"><label>(1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo stretchy="false">∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="normal">2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo stretchy="false">∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>With likelihood function defined, the optimal model parameters could then be estimated using the expectation-maximization (EM) algorithm. A forward-backward algorithm for the estimation step and a Viterbi algorithm to derive the most likely state sequence are explained in [<xref rid="B38" ref-type="bibr">38</xref>], where the author also shows the possibility of replacing the nonparametric M-step of the EM algorithm in sojourn distribution parameters reestimation with a parametric M-step in practice, to simplify the model and prevent overfitting. The E-step of the forward-backward EM procedure and the Viterbi algorithm have been implemented as C library in the package. We also attempted to provide support for parametric reestimations of the M-step based on continuous and discrete distributions like Gamma, Poisson, and negative binomial distribution, which is done<italic> ad hoc</italic> using point estimation methods. More detail about the estimation of HSMM can be found in the Supplementary Material available online at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1155/2014/910390">http://dx.doi.org/10.1155/2014/910390</ext-link>.</p>
    </sec>
    <sec id="sec2.2">
      <title>2.2. Implementation</title>
      <p>The batch function<italic> biomvRhsmm</italic> accepts both the basic R data matrix and the more encapsulated<italic> GenomicRanges</italic>-like object as input, for better interfacing with other Bioconductor classes and methods [<xref rid="B39" ref-type="bibr">39</xref>]. The function will sequentially process each region identified by the distinctive sequence names in the positional input. A second layer of stratification is introduced by a grouping argument, assigning each profile to a group, which could be used to reflect experimental design. Sample columns within the same group could be treated simultaneously in the modeling process as well as iteratively. The assumption is that profiles from the same group could be considered homogeneous and, thus, processed together in a multivariate fashion. Simultaneous treatment of multiple profiles is currently available for emission type set to multivariate normal distribution or multivariate <italic>t</italic> distribution. Additionally, there is a built-in automatic grouping method by hierarchical clustering.</p>
      <p>The prior distribution of the sojourn density will be initialized as flat or be estimated from another related data source by calling the function<italic> sojournAnno</italic>. State number could be either assigned explicitly or inferred during the sojourn learning. The model complexity is limited by a constant <italic>M</italic>, denoting the upper bound to the time spent in a state, which is quite similar to the approach adapted in the segmentation model in<italic> tilingArray</italic> [<xref rid="B24" ref-type="bibr">24</xref>]. The constant could be explicitly given by the argument max⁡<italic>k</italic> or inferred by another constant max⁡<italic>bp</italic> together with positional information. The modeling of sojourn time is done using positional information like genomic distance between markers and regresses to a rank-based position setting, like the original design in [<xref rid="B38" ref-type="bibr">38</xref>], when positional information is not available. Starting state probabilities will be initialized as a flat vector. Initial parameters for the emission distribution could be estimated using different levels of quantile of the input or via a clustering process, assuming different states tend to have different levels of emitted signals.</p>
      <p>The function will then call the C library to compute the smoothed-state probability profile in the E-step, after which model parameters will be reestimated in an M-step. Eventually, the most likely state sequence could be inferred from the smoothed-state probability profile or estimated with the Viterbi algorithm. The complexity of the forward-backward algorithm used in the E-step and the Viterbi algorithm is <italic>O</italic>(<italic>JT</italic>(<italic>J</italic> + <italic>T</italic>)) time in the worst case and <italic>O</italic>(<italic>JT</italic>
<italic>M</italic>) space. To relax the high memory burden from NGS data of base-pair resolution, we attempt to use run-length encoding (RLE) for the storage and handling of sequencing count data, since the feature distribution is normally sparse across the genome. Also, to speed up computation, parallel processing of multiple chromosomes or contigs could be enabled, to take advantage of the multicore infrastructure of modern PC.</p>
      <p>After the batch run, results are combined and returned together with input data plus model parameters as a<italic> biomvRCNS</italic> class object, for which a plot method has been implemented to provide integrative visualization of the segmentation results with optional annotation.</p>
    </sec>
    <sec id="sec2.3">
      <title>2.3. Performance Comparison with Other Segmentation Methods</title>
      <p>To show the reliability and relative performance of the proposed model, we compared our implementation with several other state-of-the-art segmentation algorithms (<xref ref-type="table" rid="tab1">Table 1</xref>), using a similar approach as in [<xref rid="B38" ref-type="bibr">38</xref>], by calculating the receiver operating characteristic (ROC) curves on simulated data.</p>
      <p>Some of the models reviewed in [<xref rid="B40" ref-type="bibr">40</xref>] have evolved over the years. Venkatraman and Olshen [<xref rid="B14" ref-type="bibr">14</xref>] present a faster, modified version of circular binary segmentation (CBS) [<xref rid="B11" ref-type="bibr">11</xref>] in R/Bioconductor package<italic> DNAcopy</italic>. Picard et al. [<xref rid="B17" ref-type="bibr">17</xref>] extend the univariate dynamic programming procedure [<xref rid="B12" ref-type="bibr">12</xref>] to joint analysis of multiple CGH profiles in R package<italic> cghseg</italic> and adopt the modified Bayesian information criterion [<xref rid="B41" ref-type="bibr">41</xref>] for model selection. We also included the unsupervised hidden Markov model described in R package<italic> aCGH</italic> [<xref rid="B9" ref-type="bibr">9</xref>] (labeled<italic> HMM</italic> hereafter) and the local adaptive weights smoothing procedure in R package<italic> GLAD</italic> [<xref rid="B10" ref-type="bibr">10</xref>] in our comparison; these are considered to be early efforts in the field, thus they can serve as baselines to show advances in the approaches.</p>
      <p>In recent years, several new methods and computational tools have also been introduced. In R package<italic> bcp</italic> [<xref rid="B16" ref-type="bibr">16</xref>], Erdman and Emerson implement an efficient Bayesian change point model described by Barry and Hartigan [<xref rid="B42" ref-type="bibr">42</xref>]. Ben-Yaacov and Eldar suggest an ultrafast segmentation model based on wavelet decomposition and thresholding in R package<italic> HaarSeg </italic>[<xref rid="B15" ref-type="bibr">15</xref>]. Marioni et al. implement a heterogeneous hidden Markov model<italic> bioHMM</italic> [<xref rid="B13" ref-type="bibr">13</xref>] in R package<italic> snapCGH</italic>, which can utilize positional information or clone quality in the modeling process and, thus, could be considered as an extension of the<italic> HMM</italic> in package<italic> aCGH</italic>. Among these models, there has been no comparison study between<italic> bcp</italic>,<italic> bioHMM</italic>, and<italic> HaarSeg</italic> in recent literature. We did not include implementations that are specific to SNP data in our comparison, mainly due to the unique nature of the platform, which is less general in terms of segmentation and may require more inputs like B Allele Frequency (BAF) or genotype call, in addition to the copy number profile in the form of Log R Ratio (LRR).</p>
    </sec>
    <sec id="sec2.4">
      <title>2.4. Data Simulation for Algorithm Comparison</title>
      <p>For the data simulation, we attempt to make it conceptually similar to the scenario one may encounter in real experiments. For copy number studies using CGH or using sequencing with matched case-control sample, three states are commonly assumed, and regions of copy gain and loss are of major interest when sizes range from about 1 kb to several megabases [<xref rid="B43" ref-type="bibr">43</xref>]. For this purpose, we first create pools of segments for each state; lengths of the segments are sampled from three Poisson distributions, with lambda equal to 20, 270, and 10, respectively. The distance between data points is assumed to be regular and equal to 1. Signal intensities are sampled from three normal distributions, <italic>N</italic>
<sub>1</sub>(<italic>r</italic>, 1), <italic>N</italic>
<sub>2</sub>(2 × <italic>r</italic>, 1), and <italic>N</italic>
<sub>3</sub>(3 × <italic>r</italic>, 1) for each state, respectively, with state mean controlled via a ratio factor <italic>r</italic> varying from 1 to 3 at a step of 1. Segments from different states are then randomly sampled and joined together to form one data sequence.</p>
      <p>For sequencing data, to check for splicing and novel transcripts or detect peaks for transcript factor binding sites, one would be interested in distinguishing the true expression signal from the background. Normally, annotated coding or noncoding transcripts are relatively much shorter compared to intergenic regions. In this case, we also first create pools of segments for three virtual states, intergenic, short, and relatively lowly-expressed gene and protein coding sequence with high abundance; lengths of the segments are sampled from three Poisson distributions, with lambda equal to 285, 5, and 10, respectively. Signal intensities for each segment are then sampled from three pools of Poisson distribution, <italic>P</italic>
<sub>1</sub>(1), <italic>P</italic>
<sub>2</sub>(<italic>r</italic>), and <italic>P</italic>
<sub>3</sub>(<italic>r</italic>
<sup>2</sup>), with mean controlled via a ratio parameter <italic>r</italic> varying from 1.5 to 2 at a step of 0.25 for each pool of segments. Segments from different states are then randomly sampled and joined together to form one data sequence, representing one targeted region.</p>
    </sec>
    <sec id="sec2.5">
      <title>2.5. Performance Comparison Using ROC Curves</title>
      <p>In this work, we compare our model with several well-tested segmentation algorithms, all of which are available as R packages. Since different algorithms tend to be tuned differently to suit their own methodologies for better sensitivity, here we do not attempt to alter their default settings and feed only the simulated signals without other information to the models, thus achieving an essentially fair comparison and mimicking a common-use case for normal users.</p>
      <p>We use simulated data with varying levels of interstate ratio <italic>r</italic>, which is conceptually similar to signal-to-noise ratio (SNR); since, for both simulations, states with extreme values are of interest, the differences in mean between the extreme states and the intermediate states could be considered as signal, while the variation associated with the intermediate state could be considered as noise. We calculate the true-positive rates (TPR) and the false-positive rates (FPR) over 10000 iterations (100 simulations for each of the 100 random segments formation) of simulation for each level of <italic>r</italic>.</p>
      <p>The TPR is defined as the number of points that are from the states of interest and fall into the predicted states of interest, divided by the total number of points from the states of interest. The FPR is defined as the number of points that are not from the states of interest but fall into the predicted states of interest, divided by the total number of points not from the states of interest. The true states of interest depend on the type of simulation; for normal data in simulation 1, this is assigned to the first and the third states, namely the gain and loss states, respectively. For count data in simulation 2, this is assigned to the third state, which is used to represent signal peak. The prediction is done by comparing the estimated segment mean with a threshold (<italic>t</italic>) varying from the maximum to the minimum of the simulated value. For abnormal state of gain in simulation 1 and peak in simulation 2, the segment with estimated value above the threshold is considered as positive; for state of loss in simulation 1, the segment with estimated value below the threshold is considered as positive. Definitions of TPR and FPR are formulated as follows:
<disp-formula id="EEq2"><label>(2)</label><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mtext>TP</mml:mtext><mml:msub><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loss</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:malignmark/><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>FP</mml:mtext><mml:msub><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loss</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:malignmark/><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>TP</mml:mtext><mml:msub><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow><mml:mrow><mml:mtext>gain</mml:mtext><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:malignmark/><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>FP</mml:mtext><mml:msub><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow><mml:mrow><mml:mtext>gain</mml:mtext><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:malignmark/><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>∣</mml:mo><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>≠</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>All calculations were carried out in the statistical language R (version 3.0.1). Area under the curve (AUC) was estimated using Bioconductor package ROC (version 1.36.0). The system used for benchmarking is a standard 64 bits Linux desktop with Intel Core i7 with 3.07 GHz and 6 GB DDR3 memory.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>3. Results</title>
    <sec id="sec3.1">
      <title>3.1. Performance Comparison with Simulated Data</title>
      <p>After two extensive simulation runs, we show the resulting ROC curves under different signal-to-noise ratios for all compared models in <xref ref-type="fig" rid="fig1">Figure 1</xref>. In <xref ref-type="fig" rid="fig2">Figure 2</xref>, two sets of randomly simulated data (chosen from the 50th random grid formation and the 50th iteration of that formation), one from each simulation run (using the intermediate <italic>r</italic> level, 2 for simulation 1 and 1.75 for simulation 2), have been illustrated as an example together with estimated segments from competing models.</p>
      <p>In simulation 1 (<xref ref-type="table" rid="tab2">Table 2</xref>), most algorithms—except for<italic> HMM</italic>—perform comparably well at intermediate- and low-noise scenarios. The difference in detecting gain and loss is consistent with our simulation setup, where we intentionally set the loss region to be relatively longer, making it easier to detect. In general, the competing algorithms can be categorized into three performance groups: our model,<italic> bioHMM</italic>, and<italic> HaarSeg</italic> perform best, followed by<italic> CBS</italic> and<italic> cghseg</italic>, and the last three algorithms perform less satisfactorily. Notably, in simulation 1,<italic> bioHMM</italic> has surprisingly high power in a high-noise setting. However, the advantage essentially disappears when signals get stronger. This phenomenon could result from its model selection process, where it attempts to assign a higher number of states, thus more segments, to compensate for the random noise. Additionally,<italic> HaarSeg</italic> has difficulty detecting short gain segments, which could be related to the default model setting that is not well adapted to short aberrations [<xref rid="B15" ref-type="bibr">15</xref>].</p>
      <p>A smoothing algorithm like<italic> GLAD</italic> only operates well under higher signal-to-noise ratio. Smoothing results in less accurate segment boundaries. Further, as mentioned in [<xref rid="B40" ref-type="bibr">40</xref>],<italic> GLAD</italic> is sensitive to single outliers, which explains the minor deficiency of sensitivity in detecting gain regions even for low-noise cases. The behavior of<italic> bcp</italic> indicates that to achieve higher power specificity must be lost, even with a high signal-to-noise setting.<italic> HMM</italic> achieves a high area under the curve (AUC) when high noise exists (<italic>r</italic> = 1) in simulation 1 and performs comparably worse when signals are stronger, eventually failing to identify most segments. This is in accordance with [<xref rid="B40" ref-type="bibr">40</xref>], where<italic> HMM</italic> failed to identify any region in Glioblastoma Multiforme (GBM) data. It also fails to make any meaningful segmentation in simulation 2.</p>
      <p>In simulation 2 (<xref ref-type="table" rid="tab3">Table 3</xref>), when data contain a mixture of Poisson distributions, we failed to run<italic> bioHMM</italic> due to an error in a foreign function call to the C library. We have to assume that the implementation cannot work on discrete count data. However, all other implementations are still operable and achieve similar performance as in simulation 1. Though the mean parameter for Poisson data simulation is not considerably large, the normal approximation could still achieve reasonably good power. Nonetheless, our explicit modeling of count data remains advantageous for segmenting count data, which has the highest weighted average rank (<xref ref-type="table" rid="tab4">Table 4</xref>), followed by<italic> bcp</italic> and<italic> HaarSeg</italic>. Compared to<italic> HaarSeg</italic>, the power boost for<italic> bcp</italic> essentially occurs under higher FPR. It is possible that algorithms like<italic> bcp</italic> perform better when a stronger signal exists, which could be due to the normal error assumption in the model.</p>
      <p>For both simulations we could confirm that, as has been shown in [<xref rid="B40" ref-type="bibr">40</xref>],<italic> cghseg</italic> and<italic> CBS</italic> perform consistently well under various scenarios. Two of the newly introduced methods,<italic> bioHMM</italic> and<italic> HaarSeg</italic>, also exhibit comparable or better performance; in contrast, our model consistently ranks among the top 3 performing algorithms. Across the two simulations,<italic> HMM</italic> and<italic> GLAD </italic>are considered to possess lowest power, while for<italic> bcp</italic> an associated high error rate is observed.</p>
      <p>Concerning computation time,<italic> HaarSeg</italic> is the fastest algorithm among all implementations, by a factor of 50–100;<italic> bioHMM</italic> is the slowest due to its internal model selection process.<italic> bcp</italic> is the second slowest, as a result of long Markov chain Monte Carlo (MCMC) run. The processing time of our model is similar to<italic> cghseg</italic> and is slower than<italic> CBS</italic>, which is about two times faster.</p>
      <p>We also took a closer look at the overall accuracy of estimated segment number, in <xref ref-type="table" rid="tab4">Table 4</xref>. For both simulations, we joined, on average, 14 segments into one sequence. Occam's razor states that the best model should be the simplest yet still retain the same power. In simulation 1, our model achieves the lowest rooted mean-squared error (RMSE) and mean absolute error (MAE); in simulation 2, our model finds fewer segments: the median number of detected segments was only 6 across three noise levels. Taking into account the power advantage of our method in the performance comparison, this finding indicates that the estimated segment boundaries are more accurate in our model. Simulated aberrant segments are sampled from the same distribution, and the sojourn modeling in our method takes advantage of this property. In the second simulation,<italic> HaarSeg</italic> achieves the lowest error estimates for both RMSE and MAE.<italic> cghseg</italic> gives error estimates similar to our model. For<italic> HaarSeg</italic> and<italic> cghseg</italic>, this is essentially achieved by fitting more segments. As has been pointed out in [<xref rid="B12" ref-type="bibr">12</xref>], assumptions of the mean-variance relationship imposed on the model may lead to more segments to satisfy such requirements.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>4. Example of Differentially Methylated Region (DMR) Detection</title>
    <p>Differentially methylated regions (DMRs) are genomic regions with different methylation status, that is, variable degrees of DNA methylation between different samples, which has been considered to have regulatory functions for gene transcription [<xref rid="B44" ref-type="bibr">44</xref>] and is associated with cell differentiation and proliferation [<xref rid="B45" ref-type="bibr">45</xref>, <xref rid="B46" ref-type="bibr">46</xref>]. Such regions can be surveyed using high-throughput technologies like tiling array [<xref rid="B47" ref-type="bibr">47</xref>] and sequencing [<xref rid="B48" ref-type="bibr">48</xref>].</p>
    <p>As an example, we include a set of data extracted from<italic> BiSeq</italic> [<xref rid="B49" ref-type="bibr">49</xref>], which contains a small subset of a published study [<xref rid="B50" ref-type="bibr">50</xref>], comprising intermediate differential methylation results before DMR detection. We first load the “variosm” data,<list list-type="simple"><list-item><label> &gt;</label><p><italic>library (biomvRCNS)</italic></p></list-item><list-item><label> &gt;</label><p><italic>data (variosm)</italic></p></list-item></list>The data contains a<italic> GRanges</italic> object<italic> variosm</italic> with two meta columns: “<italic>meth.diff</italic>,” methylation difference between the two sample groups and “<italic>p.val</italic>,” significance level from the Wald test. Our model could be applied on data from other pipelines as well, using similar data input.</p>
    <p>In the<italic> BiSeq</italic> workflow, they use an approach similar to the max-gap-min-run algorithm to define DMR boundaries, by prior filtering and comparing the differential test statistics with a user-specified significance level in the candidate regions. The positional information for methylation sites is accounted for by locating and testing highly correlated cluster regions in the filtering process.</p>
    <p>With<italic> biomvRhsmm</italic>, we utilize both types of information to detect DMRs: (1) the difference in the methylation ratio and (2) the significance level from the differential test. The methylation difference gives information about the directionality of the change as well as the size, and the significance level gives the confidence in claiming differential events. We implicitly ask the model to give 3 states, since <italic>J</italic> is default to 3. Regarding the methylation ratio “<italic>meth.diff</italic>,” these levels may be hypomethylated regions, undefined null regions, or hypermethylated regions, respectively. When modeling significance levels “<italic>p.val</italic>,” these states would represent high confidence regions, low confidence regions, or null results. For both scenarios, we are more interested in extreme states, where we have consistent direction of differences and low<italic> P</italic> values. However, the distributions of observation values in “<italic>meth.diff</italic>” and “<italic>p.val</italic>” are both nonuniform and asymmetric around 0 (for “<italic>meth.diff</italic>”) and 0.5 (for “<italic>p.val</italic>”), thus we enable the cluster mode for emission prior to initialization by setting<italic> prior.m=</italic>“<italic>cluster</italic>.” The “<italic>cluster</italic>” mode will employ the method described in [<xref rid="B51" ref-type="bibr">51</xref>] to divide data into clusters and then use the centroid of each cluster to represent the mean parameter; further, the variance structure or other distributional parameters can be estimated using the corresponding clusters.</p>
    <p>Due to the nonuniformly located CpG sites, one may split inter-spreading long segments with parameter max gap = 100 (see code chunk in <xref ref-type="fig" rid="figbox1">Box 1</xref>).</p>
    <p>After the model fitting, by intersecting regions with extreme “<italic>meth.diff</italic>” and regions with low “<italic>p.val</italic>,” we can locate those detected DMRs, returned with their average “<italic>meth.diff</italic>” and “<italic>p.val</italic>”. Compared to the regions detected in the<italic> BiSeq</italic> vignette, the two sets of regions are largely similar except for two regions. First chr1: 872335, 872386 had highly asymmetric distribution of “<italic>meth.diff</italic>.” Another region, chr2: 46915, 46937, resides in the tail of chromosome 2 and has only 2 methylation sites; this was sorted into the intermediate state due to the lack of support from both the emission level and the sojourn time. However, due to the filtering applied in<italic> BiSeq</italic> workflow, they built wider regions out of a smaller set of more significant sites; in contrast, our approach has more refined regions, and we identified two hypomethylated regions (chr1: 876807, 876958 and chr1: 877684, 877738). The two segmented profiles are depicted in <xref ref-type="fig" rid="fig3">Figure 3</xref>, using the default plot method.</p>
  </sec>
  <sec id="sec5">
    <title>5. Discussion</title>
    <p>The segmentation problem, in general, occurs in many types of biological experiments and can naturally fit into the hidden Markov model framework with segment boundaries modeled as transitions between hidden states.</p>
    <p>As a generalization of the hidden Markov model, HSMM allows the sojourn distribution to be specified other than the Geometric distribution implicitly used in common HMM. Given the complexity of the genome, such an implicit assumption could be easily violated. Though the true underlying sojourn distributions involving various genomic features remains unknown, our implementation gives more flexible options in the modeling and, thus, might provide more insight.</p>
    <p>In this package, several types of sojourn distribution are implemented. For example, with gamma-distributed sojourn, the neighboring position will tend to stay in the same state and transit to other states if far apart. Differing from the original design in [<xref rid="B38" ref-type="bibr">38</xref>], our implementation utilizes the positional information naturally associated with most genomic features for the sojourn density estimation. Such an integrative approach is advantageous over simply using the rank of feature positions, since mapping positions are not always uniformly distributed and the spatial patterns may be of interest in experiments like DMR detection. Further, HSMM differs from those models that embed positions in a nonparametric fashion, like<italic> BioHMM</italic> [<xref rid="B13" ref-type="bibr">13</xref>] and QuantiSNP [<xref rid="B19" ref-type="bibr">19</xref>], or as in the “instability-selection” model for LOH analysis [<xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B23" ref-type="bibr">23</xref>]; these all employ variations of exponential function to account for feature position. Our HSMM is closer to the DBN model employed in Segway [<xref rid="B34" ref-type="bibr">34</xref>] but is less experiment-specific and easier to interpret and has convenient communication with other analytical and visualization tools within the Bioconductor community.</p>
    <p>The explosion of data availability provides another possibility of learning from previous studies. Other than the flat prior commonly used in Bayesian inference, prior information for the sojourn density could be estimated from annotation or previous studies, thus it can be effectively utilized together with positional information of features to guide the estimation of the most likely state sequence.</p>
    <p>With its full probabilistic model, various emission densities are provided, enabling the model to handle normally distributed data from traditional array platforms as well as counting data from sequencing experiments. The proposed model has also been applied on a well-studied aCGH dataset from Coriell cell lines [<xref rid="B7" ref-type="bibr">7</xref>] and from RNA-seq data generated by the ENCODE project [<xref rid="B52" ref-type="bibr">52</xref>, <xref rid="B53" ref-type="bibr">53</xref>] to illustrate its other functionalities in the package vignette.</p>
  </sec>
  <sec id="sec6">
    <title>6. Conclusions</title>
    <p>In this work, we present a novel hidden semi-Markov model designed specifically for genomic data analysis. The proposed model has been compared with several other state-of-the-art segmentation methods; our implementation is efficient and achieves comparable or better sensitivity and specificity in genomic segmentation. Further, our model has flexible data distribution assumption, enabling a unified interface for segmenting data generated from different experimental platforms. By incorporating genomic positions into the sojourn distribution of HSMM, with optional prior learning using annotation or previous studies, model output is more biologically sensible. To this end we would like to present our model as a general segmentation engine to serve in a wide range of genomic research.</p>
  </sec>
  <sec id="sec7">
    <title>7. Availability and Requirements</title>
    <p>Function<italic> biomvRhsmm</italic> is implemented as part of the R/Bioconductor package<italic> biomvRCNS</italic>, which is available from the Bioconductor project.<list list-type="simple"><list-item><label> </label><p>Function name:<italic> biomvRhsmm</italic>
</p></list-item><list-item><label> </label><p>Package name:<italic> biomvRCNS</italic>
</p></list-item><list-item><label> </label><p>Project home page:</p></list-item><list-item><label> </label><p><ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/devel/bioc/html/biomvRCNS.html">http://bioconductor.org/packages/devel/bioc/html/biomvRCNS.html</ext-link></p></list-item><list-item><label> </label><p>Operating system(s): Linux, Mac OS X, Windows</p></list-item><list-item><label> </label><p>Programming language: R, C</p></list-item><list-item><label> </label><p>Other requirements: R (≥ 3.0.0)</p></list-item><list-item><label> </label><p>License: GPL (≥2).</p></list-item></list>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplementary-material-sec">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="f1">
      <caption>
        <p>Further mathematical details of the forward-backward EM procedure and the Viterbi algorithm implemented in the proposed hidden semi-Markov model.</p>
      </caption>
      <media xlink:href="910390.f1.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" id="d35e1837" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgment</title>
    <p>This research was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft, DFG Wi 1754/14-1).</p>
  </ack>
  <sec sec-type="conflict">
    <title>Conflict of Interests</title>
    <p>The authors declare that they have no conflict of interests.</p>
  </sec>
  <sec>
    <title>Authors' Contribution</title>
    <p>Yang Du implemented the package, performed data analysis, and wrote the paper. Eduard Murani, Siriluck Ponsuksili, and Klaus Wimmers tested the application and provided scientific advice. Klaus Wimmers conceived this study and critically revised the paper. All authors contributed to the discussions for the improvement of the original draft and approved the final paper.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Rinaldi</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional regulatory networks in Saccharomyces cerevisiae</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2002</year>
        <volume>298</volume>
        <issue>5594</issue>
        <fpage>799</fpage>
        <lpage>804</lpage>
        <pub-id pub-id-type="other">2-s2.0-0037174671</pub-id>
        <pub-id pub-id-type="pmid">12399584</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>I-H</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential methylation of tissue-and cancer-specific CpG island shores distinguishes human induced pluripotent stem cells, embryonic stem cells and fibroblasts</article-title>
        <source>
          <italic>Nature Genetics</italic>
        </source>
        <year>2009</year>
        <volume>41</volume>
        <issue>12</issue>
        <fpage>1350</fpage>
        <lpage>1353</lpage>
        <pub-id pub-id-type="other">2-s2.0-70649095120</pub-id>
        <pub-id pub-id-type="pmid">19881528</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>TE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global identification of human transcribed sequences with genome tiling arrays</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2004</year>
        <volume>306</volume>
        <issue>5705</issue>
        <fpage>2242</fpage>
        <lpage>2246</lpage>
        <pub-id pub-id-type="other">2-s2.0-19944376457</pub-id>
        <pub-id pub-id-type="pmid">15539566</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Samanta</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of transcribed sequences in Arabidopsis thaliana by using high-resolution genone tiling arrays</article-title>
        <source>
          <italic>Proceedings of the National Academy of Sciences of the United States of America</italic>
        </source>
        <year>2005</year>
        <volume>102</volume>
        <issue>12</issue>
        <fpage>4453</fpage>
        <lpage>4458</lpage>
        <pub-id pub-id-type="other">2-s2.0-20144386497</pub-id>
        <pub-id pub-id-type="pmid">15755812</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>David</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Granovskaia</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution map of transcription in the yeast genome</article-title>
        <source>
          <italic>Proceedings of the National Academy of Sciences of the United States of America</italic>
        </source>
        <year>2006</year>
        <volume>103</volume>
        <issue>14</issue>
        <fpage>5320</fpage>
        <lpage>5325</lpage>
        <pub-id pub-id-type="other">2-s2.0-33645785104</pub-id>
        <pub-id pub-id-type="pmid">16569694</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>
          <italic>Nature Reviews Genetics</italic>
        </source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="other">2-s2.0-57749195712</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snijders</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Segraves</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of microarrays for genome-wide measurement of DNA copy number</article-title>
        <source>
          <italic>Nature Genetics</italic>
        </source>
        <year>2001</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>263</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="other">2-s2.0-0035179871</pub-id>
        <pub-id pub-id-type="pmid">11687795</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudmant</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Antonacci</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity of human copy number variation and multicopy genes</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2010</year>
        <volume>330</volume>
        <issue>6004</issue>
        <fpage>641</fpage>
        <lpage>646</lpage>
        <pub-id pub-id-type="other">2-s2.0-78049412267</pub-id>
        <pub-id pub-id-type="pmid">21030649</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fridlyand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Snijders</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Hidden Markov models approach to the analysis of array CGH data</article-title>
        <source>
          <italic>Journal of Multivariate Analysis</italic>
        </source>
        <year>2004</year>
        <volume>90</volume>
        <issue>1</issue>
        <fpage>132</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="other">2-s2.0-9244229940</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hupé</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thiery</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Analysis of array CGH data: from signal ratio to gain and loss of DNA regions</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2004</year>
        <volume>20</volume>
        <issue>18</issue>
        <fpage>3413</fpage>
        <lpage>3422</lpage>
        <pub-id pub-id-type="other">2-s2.0-12344259648</pub-id>
        <pub-id pub-id-type="pmid">15381628</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lucito</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wigler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>
        <source>
          <italic>Biostatistics</italic>
        </source>
        <year>2004</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="other">2-s2.0-3543105225</pub-id>
        <pub-id pub-id-type="pmid">15475419</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picard</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lavielle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaisse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daudin</surname>
            <given-names>J-J</given-names>
          </name>
        </person-group>
        <article-title>A statistical approach for array CGH data analysis</article-title>
        <source>
          <italic>BMC Bioinformatics</italic>
        </source>
        <year>2005</year>
        <volume>6, article 27</volume>
        <pub-id pub-id-type="other">2-s2.0-25444531432</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Thorne</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BioHMM: a heterogeneous hidden Markov model for segmenting array CGH data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2006</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="other">2-s2.0-33646163019</pub-id>
        <pub-id pub-id-type="pmid">16533818</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>A faster circular binary segmentation algorithm for the analysis of array CGH data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2007</year>
        <volume>23</volume>
        <issue>6</issue>
        <fpage>657</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="other">2-s2.0-34147104969</pub-id>
        <pub-id pub-id-type="pmid">17234643</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Yaacov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eldar</surname>
            <given-names>YC</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible method for the segmentation of aCGH data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2008</year>
        <volume>24</volume>
        <issue>16</issue>
        <fpage>i139</fpage>
        <lpage>i145</lpage>
        <pub-id pub-id-type="other">2-s2.0-49549085311</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erdman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>A fast Bayesian change point analysis for the segmentation of microarray data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2008</year>
        <volume>24</volume>
        <issue>19</issue>
        <fpage>2143</fpage>
        <lpage>2148</lpage>
        <pub-id pub-id-type="other">2-s2.0-52949087226</pub-id>
        <pub-id pub-id-type="pmid">18667443</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picard</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lebarbier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hoebeke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rigaill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Thiam</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Joint segmentation, calling, and normalization of multiple CGH profiles</article-title>
        <source>
          <italic>Biostatistics</italic>
        </source>
        <year>2011</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>413</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="other">2-s2.0-79959397907</pub-id>
        <pub-id pub-id-type="pmid">21209153</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Robust hidden semi-Markov modeling of array CGH data</article-title>
        <conf-name>Proceedings of the IEEE International Conference on Bioinformatics and Biomedicine (BIBM '10)</conf-name>
        <conf-date>December 2010</conf-date>
        <conf-loc>Hong Kong, China</conf-loc>
        <fpage>603</fpage>
        <lpage>608</lpage>
        <pub-id pub-id-type="other">2-s2.0-79952385421</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Colella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QuantiSNP: an objective bayes hidden-markov model to detect and accurately map copy number variation using SNP genotyping data</article-title>
        <source>
          <italic>Nucleic Acids Research</italic>
        </source>
        <year>2007</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>2013</fpage>
        <lpage>2025</lpage>
        <pub-id pub-id-type="other">2-s2.0-34247877877</pub-id>
        <pub-id pub-id-type="pmid">17341461</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hadley</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PennCNV: an integrated hidden Markov model designed for high-resolution copy number variation detection in whole-genome SNP genotyping data</article-title>
        <source>
          <italic>Genome Research</italic>
        </source>
        <year>2007</year>
        <volume>17</volume>
        <issue>11</issue>
        <fpage>1665</fpage>
        <lpage>1674</lpage>
        <pub-id pub-id-type="other">2-s2.0-35948984173</pub-id>
        <pub-id pub-id-type="pmid">17921354</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Manié</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stoppa-Lyonnet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rigaill</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Genome Alteration Print (GAP): a tool to visualize and mine complex cancer genomic profiles obtained by SNP arrays</article-title>
        <source>
          <italic>Genome Biology</italic>
        </source>
        <year>2009</year>
        <volume>10</volume>
        <issue>11, article R128</issue>
        <pub-id pub-id-type="other">2-s2.0-76249097734</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beroukhim</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring loss-of-heterozygosity from unpaired tumors using high-density oligonucleotide SNP arrays</article-title>
        <source>
          <italic>PLoS Computational Biology</italic>
        </source>
        <year>2006</year>
        <volume>2</volume>
        <issue>5, article e40</issue>
        <pub-id pub-id-type="other">2-s2.0-33646911907</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scharpf</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Parmigiani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pevsner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Hidden Markov models for the assessment of chromosomal alterations using high-throughput SNP arrays</article-title>
        <source>
          <italic>The Annals of Applied Statistics</italic>
        </source>
        <year>2008</year>
        <volume>2</volume>
        <issue>2, article 687</issue>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Toedling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Transcript mapping with high-density oligonucleotide tiling arrays</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2006</year>
        <volume>22</volume>
        <issue>16</issue>
        <fpage>1963</fpage>
        <lpage>1970</lpage>
        <pub-id pub-id-type="other">2-s2.0-33747856481</pub-id>
        <pub-id pub-id-type="pmid">16787969</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piccolboni</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multivariate segmentation in the analysis of transcription tiling array data</article-title>
        <source>
          <italic>Journal of Computational Biology</italic>
        </source>
        <year>2008</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>845</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="other">2-s2.0-51349103136</pub-id>
        <pub-id pub-id-type="pmid">18707537</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A supervised hidden markov model framework for efficiently segmenting tiling array data in transcriptional and chIP-chip experiments: systematically incorporating validated biological knowledge</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2006</year>
        <volume>22</volume>
        <issue>24</issue>
        <fpage>3016</fpage>
        <lpage>3024</lpage>
        <pub-id pub-id-type="other">2-s2.0-33845369532</pub-id>
        <pub-id pub-id-type="pmid">17038339</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toedling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sklyar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Ringo—an R/Bioconductor package for analyzing ChIP-chip readouts</article-title>
        <source>
          <italic>BMC Bioinformatics</italic>
        </source>
        <year>2007</year>
        <volume>8, article 221</volume>
        <pub-id pub-id-type="other">2-s2.0-34447277157</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lercher</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Urrutia</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Hurst</surname>
            <given-names>LD</given-names>
          </name>
        </person-group>
        <article-title>Clustering of housekeeping genes provides a unified model of gene order in the human genome</article-title>
        <source>
          <italic>Nature Genetics</italic>
        </source>
        <year>2002</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>180</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="other">2-s2.0-0036613754</pub-id>
        <pub-id pub-id-type="pmid">11992122</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caron</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Schaik</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Van der Mee</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human transcriptome map: clustering of highly expressed genes in chromosomal domains</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2001</year>
        <volume>291</volume>
        <issue>5507</issue>
        <fpage>1289</fpage>
        <lpage>1292</lpage>
        <pub-id pub-id-type="other">2-s2.0-0035895502</pub-id>
        <pub-id pub-id-type="pmid">11181992</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>
          <italic>Genome Biology</italic>
        </source>
        <year>2008</year>
        <volume>9</volume>
        <issue>9, article R137</issue>
        <pub-id pub-id-type="other">2-s2.0-53849146020</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spyrou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BayesPeak: bayesian analysis of chip-seq data</article-title>
        <source>
          <italic>BMC Bioinformatics</italic>
        </source>
        <year>2009</year>
        <volume>10</volume>
        <issue>article 299</issue>
        <pub-id pub-id-type="other">2-s2.0-70449434105</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HPeak: an HMM-based algorithm for defining read-enriched regions in ChIP-Seq data</article-title>
        <source>
          <italic>BMC Bioinformatics</italic>
        </source>
        <year>2010</year>
        <volume>11, article 369</volume>
        <pub-id pub-id-type="other">2-s2.0-77954041808</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>
          <italic>Nature Methods</italic>
        </source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="other">2-s2.0-84857707318</pub-id>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="B34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>
          <italic>Nature Methods</italic>
        </source>
        <year>2012</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>473</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="other">2-s2.0-84860378095</pub-id>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schwarzbauer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>cn.MOPS: mixture of Poissons for discovering copy number variations in next-generation sequencing data with a low false discovery rate</article-title>
        <source>
          <italic>Nucleic Acids Research</italic>
        </source>
        <year>2012</year>
        <volume>40</volume>
        <issue>9, article e69</issue>
      </element-citation>
    </ref>
    <ref id="B36">
      <label>36</label>
      <element-citation publication-type="book">
        <collab>R Core Team</collab>
        <source>
          <italic>R: A Language and Environment For Statistical Computing</italic>
        </source>
        <year>2013</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
      </element-citation>
    </ref>
    <ref id="B37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>
          <italic>Genome Biology</italic>
        </source>
        <year>2004</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>p. R80</fpage>
        <pub-id pub-id-type="other">2-s2.0-28744458859</pub-id>
      </element-citation>
    </ref>
    <ref id="B38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guédon</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Estimating hidden semi-markov chains from discrete sequences</article-title>
        <source>
          <italic>Journal of Computational and Graphical Statistics</italic>
        </source>
        <year>2003</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>604</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="other">2-s2.0-0141907306</pub-id>
      </element-citation>
    </ref>
    <ref id="B39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>
          <italic>PLOS Computational Biology</italic>
        </source>
        <year>2013</year>
        <volume>9</volume>
        <issue>8</issue>
        <pub-id pub-id-type="publisher-id">e1003118</pub-id>
      </element-citation>
    </ref>
    <ref id="B40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kucherlapati</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of algorithms for identifying amplifications and deletions in array CGH data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2005</year>
        <volume>21</volume>
        <issue>19</issue>
        <fpage>3763</fpage>
        <lpage>3770</lpage>
        <pub-id pub-id-type="other">2-s2.0-27544483495</pub-id>
        <pub-id pub-id-type="pmid">16081473</pub-id>
      </element-citation>
    </ref>
    <ref id="B41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Siegmund</surname>
            <given-names>DO</given-names>
          </name>
        </person-group>
        <article-title>A modified Bayes information criterion with applications to the analysis of comparative genomic hybridization data</article-title>
        <source>
          <italic>Biometrics</italic>
        </source>
        <year>2007</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="other">2-s2.0-34247243220</pub-id>
        <pub-id pub-id-type="pmid">17447926</pub-id>
      </element-citation>
    </ref>
    <ref id="B42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barry</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hartigan</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian analysis for change point problems</article-title>
        <source>
          <italic>Journal of the American Statistical Association</italic>
        </source>
        <year>1993</year>
        <volume>88</volume>
        <issue>421</issue>
        <fpage>309</fpage>
        <lpage>319</lpage>
      </element-citation>
    </ref>
    <ref id="B43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stankiewicz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lupski</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Structural variation in the human genome and its role in disease</article-title>
        <source>
          <italic>Annual Review of Medicine</italic>
        </source>
        <year>2010</year>
        <volume>61</volume>
        <fpage>437</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="other">2-s2.0-77949831756</pub-id>
      </element-citation>
    </ref>
    <ref id="B44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bestor</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Jaenisch</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Targeted mutation of the DNA methyltransferase gene results in embryonic lethality</article-title>
        <source>
          <italic>Cell</italic>
        </source>
        <year>1992</year>
        <volume>69</volume>
        <issue>6</issue>
        <fpage>915</fpage>
        <lpage>926</lpage>
        <pub-id pub-id-type="other">2-s2.0-0026708177</pub-id>
        <pub-id pub-id-type="pmid">1606615</pub-id>
      </element-citation>
    </ref>
    <ref id="B45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic reprogramming in mammalian development</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2001</year>
        <volume>293</volume>
        <issue>5532</issue>
        <fpage>1089</fpage>
        <lpage>1093</lpage>
        <pub-id pub-id-type="other">2-s2.0-0035839126</pub-id>
        <pub-id pub-id-type="pmid">11498579</pub-id>
      </element-citation>
    </ref>
    <ref id="B46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Ladd-Acosta</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human colon cancer methylome shows similar hypo- and hypermethylation at conserved tissue-specific CpG island shores</article-title>
        <source>
          <italic>Nature Genetics</italic>
        </source>
        <year>2009</year>
        <volume>41</volume>
        <issue>2</issue>
        <fpage>178</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="other">2-s2.0-59149084538</pub-id>
        <pub-id pub-id-type="pmid">19151715</pub-id>
      </element-citation>
    </ref>
    <ref id="B47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shiu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Borevitz</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>Global analysis of genetic, epigenetic and transcriptional polymorphisms in <italic>Arabidopsis thaliana</italic> using whole genome tiling arrays</article-title>
        <source>
          <italic>PLoS Genetics</italic>
        </source>
        <year>2008</year>
        <volume>4</volume>
        <issue>3</issue>
        <pub-id pub-id-type="other">2-s2.0-41949131536</pub-id>
        <pub-id pub-id-type="publisher-id">e1000032</pub-id>
      </element-citation>
    </ref>
    <ref id="B48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cokus</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>
        <source>
          <italic>Nature</italic>
        </source>
        <year>2008</year>
        <volume>452</volume>
        <issue>7184</issue>
        <fpage>215</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="other">2-s2.0-40749109894</pub-id>
        <pub-id pub-id-type="pmid">18278030</pub-id>
      </element-citation>
    </ref>
    <ref id="B49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>H-U</given-names>
          </name>
        </person-group>
        <article-title>Detection of significantly differentially methylated regions in targeted bisulfite sequencing data</article-title>
        <source>
          <italic>Bioinformatics</italic>
        </source>
        <year>2013</year>
        <volume>29</volume>
        <issue>13</issue>
        <fpage>1647</fpage>
        <lpage>1653</lpage>
        <pub-id pub-id-type="pmid">23658421</pub-id>
      </element-citation>
    </ref>
    <ref id="B50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoofs</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rohde</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA methylation changes are a late event in acute promyelocytic leukemia and coincide with loss of transcription factor binding</article-title>
        <source>
          <italic>Blood</italic>
        </source>
        <year>2013</year>
        <volume>121</volume>
        <issue>1</issue>
        <fpage>178</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="pmid">23152544</pub-id>
      </element-citation>
    </ref>
    <ref id="B51">
      <label>51</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <source>
          <italic>Finding Groups in Data: An Introduction to Cluster Analysis</italic>
        </source>
        <year>2009</year>
        <volume>344</volume>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="B52">
      <label>52</label>
      <element-citation publication-type="journal">
        <collab>Consortium TEP</collab>
        <article-title>The ENCODE (ENCyclopedia of DNA elements) project</article-title>
        <source>
          <italic>Science</italic>
        </source>
        <year>2004</year>
        <volume>306</volume>
        <issue>5696</issue>
        <fpage>636</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="pmid">15499007</pub-id>
      </element-citation>
    </ref>
    <ref id="B53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>ENCODE Project Consortium</surname>
            <given-names>EPC</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A user’s guide to the encyclopedia of DNA elements (ENCODE)</article-title>
        <source>
          <italic>PLoS Biology</italic>
        </source>
        <year>2011</year>
        <volume>9</volume>
        <issue>4</issue>
        <pub-id pub-id-type="publisher-id">e1001046</pub-id>
        <pub-id pub-id-type="other">2-s2.0-80051954134</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>ROC curves for performance comparison. Receiver operating characteristic (ROC) curves for segmentation algorithm comparison under different signal-to-noise settings (<italic>r</italic>). Curves were generated by measuring the sensitivity and specificity at different threshold levels. The <italic>x</italic>-axis and <italic>y</italic>-axis show the false-positive rate (FPR) and true-positive rate (TPR), respectively. The upper panel (a) shows simulation 1, similar to an aCGH analysis, and the lower panel shows simulation 2, similar to peak identification using NGS. Compared algorithms are color-coded as indicated in the figure legend, while the up-triangle represents segment of gain in simulation 1 and peak in simulation 2, and hollow down-triangle represents segment of loss in simulation 1. Models are labeled using lowercase letters of their name. Our proposed model is coded as “<italic>hsmm</italic>” for simplicity and the hidden Markov model in package<italic> aCGH</italic> is labeled as “<italic>hmm.</italic>”</p>
    </caption>
    <graphic xlink:href="BMRI2014-910390.001"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Examples of stimulated data and estimated segments. Two sets of randomly simulated data (chosen from the 50th random grid formation and the 50th iteration of that formation), one for each simulation run (using the intermediate <italic>r</italic> level, 2 for simulation 1 and 1.75 for simulation 2), are illustrated as an example with estimated segments from competing models. Segments are represented using the estimated segment averages. The true underlying grid used for data simulation is shown as the solid line in beige.</p>
    </caption>
    <graphic xlink:href="BMRI2014-910390.002"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Detected differentially methylated regions (DMRs) in the example data, together with estimated segmentation profiles. DMRs could be located by intersecting resulting states “1” or “3” in “<italic>meth.diff</italic>” and segment “1” in “<italic>p.val</italic>,” like has been shown in the code chunk, indicated by boxes in the third row.</p>
    </caption>
    <graphic xlink:href="BMRI2014-910390.003"/>
  </fig>
  <fig id="figbox1" orientation="portrait" position="float">
    <label>Box 1</label>
    <caption>
      <p>Code chunk.</p>
    </caption>
    <graphic xlink:href="BMRI2014-910390.004"/>
  </fig>
  <table-wrap id="tab1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <p>List of algorithms compared in this paper.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1">Name</th>
          <th align="center" rowspan="1" colspan="1">Reference</th>
          <th align="center" rowspan="1" colspan="1">Method</th>
          <th align="center" rowspan="1" colspan="1">R package (version)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bcp </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Erdman and Emerson (2008) [<xref rid="B16" ref-type="bibr">16</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Product Partition Model</td>
          <td align="center" rowspan="1" colspan="1">bcp_3.0.1</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bioHMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Marioni et al. (2006) [<xref rid="B13" ref-type="bibr">13</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Heterogeneous HMM</td>
          <td align="center" rowspan="1" colspan="1">snapCGH_1.30.0</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CBS </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Venkatraman and Olshen (2007) [<xref rid="B14" ref-type="bibr">14</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Modified Circular Binary Segmentation</td>
          <td align="center" rowspan="1" colspan="1">DNAcopy_1.34.0</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>cghseg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Picard et al. (2011) [<xref rid="B17" ref-type="bibr">17</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Joint CGH Segmentation </td>
          <td align="center" rowspan="1" colspan="1">cghseg_1.0.1</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>GLAD </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Hupé et al. (2004) [<xref rid="B10" ref-type="bibr">10</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Adaptive Weights Smoothing </td>
          <td align="center" rowspan="1" colspan="1">GLAD_2.24.0</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HaarSeg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Ben-Yaacov and Eldar (2008) [<xref rid="B15" ref-type="bibr">15</xref>]</td>
          <td align="center" rowspan="1" colspan="1">Wavelet Decomposition and Thresholding</td>
          <td align="center" rowspan="1" colspan="1">HaarSeg_0.0.3</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">Fridlyand et al. (2004) [<xref rid="B9" ref-type="bibr">9</xref>] </td>
          <td align="center" rowspan="1" colspan="1">Homogeneous HMM</td>
          <td align="center" rowspan="1" colspan="1">aCGH_1.38.0</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="tab2" orientation="portrait" position="float">
    <label>Table 2</label>
    <caption>
      <p>Area under the ROC curves of simulation 1 data.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1"> </th>
          <th align="center" colspan="2" rowspan="1"><italic>r</italic> = 1</th>
          <th align="center" colspan="2" rowspan="1"><italic>r</italic> = 2</th>
          <th align="center" colspan="2" rowspan="1"><italic>r</italic> = 3</th>
          <th align="center" rowspan="2" colspan="1">Weighted avg. rank</th>
        </tr>
        <tr>
          <th align="left" rowspan="1" colspan="1"> </th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>g</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>l</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>g</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>l</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>g</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub>l</sub>
</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>hsmm </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.619487</td>
          <td align="center" rowspan="1" colspan="1">0.729668</td>
          <td align="center" rowspan="1" colspan="1">0.982176</td>
          <td align="center" rowspan="1" colspan="1">0.988689</td>
          <td align="center" rowspan="1" colspan="1">0.999141</td>
          <td align="center" rowspan="1" colspan="1">0.998519</td>
          <td align="center" rowspan="1" colspan="1">3.528400</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bcp </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.675283</td>
          <td align="center" rowspan="1" colspan="1">0.758042</td>
          <td align="center" rowspan="1" colspan="1">0.912009</td>
          <td align="center" rowspan="1" colspan="1">0.956031</td>
          <td align="center" rowspan="1" colspan="1">0.921090</td>
          <td align="center" rowspan="1" colspan="1">0.963401</td>
          <td align="center" rowspan="1" colspan="1">6.416511</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bioHMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.685575</td>
          <td align="center" rowspan="1" colspan="1">0.875202</td>
          <td align="center" rowspan="1" colspan="1">0.977079</td>
          <td align="center" rowspan="1" colspan="1">0.990215</td>
          <td align="center" rowspan="1" colspan="1">0.995062</td>
          <td align="center" rowspan="1" colspan="1">0.997551</td>
          <td align="center" rowspan="1" colspan="1">3.408419</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CBS </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.633272</td>
          <td align="center" rowspan="1" colspan="1">0.795941</td>
          <td align="center" rowspan="1" colspan="1">0.974008</td>
          <td align="center" rowspan="1" colspan="1">0.985508</td>
          <td align="center" rowspan="1" colspan="1">0.996065</td>
          <td align="center" rowspan="1" colspan="1">0.995409</td>
          <td align="center" rowspan="1" colspan="1">4.491084</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CGHseg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.586505</td>
          <td align="center" rowspan="1" colspan="1">0.696329</td>
          <td align="center" rowspan="1" colspan="1">0.960183</td>
          <td align="center" rowspan="1" colspan="1">0.991765</td>
          <td align="center" rowspan="1" colspan="1">0.996045</td>
          <td align="center" rowspan="1" colspan="1">0.998051</td>
          <td align="center" rowspan="1" colspan="1">4.621081</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>GLAD </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.506588</td>
          <td align="center" rowspan="1" colspan="1">0.548763</td>
          <td align="center" rowspan="1" colspan="1">0.833011</td>
          <td align="center" rowspan="1" colspan="1">0.962862</td>
          <td align="center" rowspan="1" colspan="1">0.986098</td>
          <td align="center" rowspan="1" colspan="1">0.996577</td>
          <td align="center" rowspan="1" colspan="1">6.907573</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HaarSeg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.649687</td>
          <td align="center" rowspan="1" colspan="1">0.763682</td>
          <td align="center" rowspan="1" colspan="1">0.923416</td>
          <td align="center" rowspan="1" colspan="1">0.993653</td>
          <td align="center" rowspan="1" colspan="1">0.995908</td>
          <td align="center" rowspan="1" colspan="1">0.998408</td>
          <td align="center" rowspan="1" colspan="1">3.886978</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.717595</td>
          <td align="center" rowspan="1" colspan="1">0.854783</td>
          <td align="center" rowspan="1" colspan="1">0.749492</td>
          <td align="center" rowspan="1" colspan="1">0.887209</td>
          <td align="center" rowspan="1" colspan="1">0.526358</td>
          <td align="center" rowspan="1" colspan="1">0.573611</td>
          <td align="center" rowspan="1" colspan="1">6.589848</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>AUC<sub>g</sub> and AUC<sub>l</sub> are area under the receiver operating characteristic (ROC) curves for simulated gain and loss segments, respectively, for each <italic>r</italic>.</p>
      </fn>
      <fn>
        <p>Weighted avg. rank is calculated as <italic>n</italic> + 1 − ∑<sub><italic>j</italic>=1</sub>
<sup><italic>j</italic>=<italic>c</italic></sup>AUC<sub><italic>i</italic></sub> × rank<sup><italic>j</italic></sup>(AUC<sub><italic>i</italic></sub>)/<italic>c</italic> for each model <italic>i</italic>, where <italic>c</italic> is the number of AUC columns and <italic>n</italic> is the number of competing models.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tab3" orientation="portrait" position="float">
    <label>Table 3</label>
    <caption>
      <p>Area under the ROC curves of simulation 2 data.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1"> </th>
          <th align="center" rowspan="1" colspan="1">AUC<sub><italic>r</italic>=1.5</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub><italic>r</italic>=1.75</sub>
</th>
          <th align="center" rowspan="1" colspan="1">AUC<sub><italic>r</italic>=2</sub>
</th>
          <th align="center" rowspan="1" colspan="1">Weighted avg. rank</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>hsmm </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.7623442</td>
          <td align="center" rowspan="1" colspan="1">0.9423881</td>
          <td align="center" rowspan="1" colspan="1">0.9849165</td>
          <td align="center" rowspan="1" colspan="1">2.232382</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bcp </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.8219388</td>
          <td align="center" rowspan="1" colspan="1">0.9280808</td>
          <td align="center" rowspan="1" colspan="1">0.9656302</td>
          <td align="center" rowspan="1" colspan="1">2.616598</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CBS </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.6828102</td>
          <td align="center" rowspan="1" colspan="1">0.874411</td>
          <td align="center" rowspan="1" colspan="1">0.954873</td>
          <td align="center" rowspan="1" colspan="1">5.487906</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CGHseg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.7292456</td>
          <td align="center" rowspan="1" colspan="1">0.8982693</td>
          <td align="center" rowspan="1" colspan="1">0.9594827</td>
          <td align="center" rowspan="1" colspan="1">4.550670</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>GLAD </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.5418485</td>
          <td align="center" rowspan="1" colspan="1">0.7366826</td>
          <td align="center" rowspan="1" colspan="1">0.8971196</td>
          <td align="center" rowspan="1" colspan="1">6.730182</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HaarSeg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.7728192</td>
          <td align="center" rowspan="1" colspan="1">0.9114189</td>
          <td align="center" rowspan="1" colspan="1">0.9786983</td>
          <td align="center" rowspan="1" colspan="1">2.977933</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.6243222</td>
          <td align="center" rowspan="1" colspan="1">0.5872855</td>
          <td align="center" rowspan="1" colspan="1">0.5259849</td>
          <td align="center" rowspan="1" colspan="1">7.212695</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>Weighted avg. rank is calculated as <italic>n</italic> + 1 − ∑<sub><italic>j</italic>=1</sub>
<sup><italic>j</italic>=<italic>c</italic></sup>AUC<sub><italic>i</italic></sub> × rank<sup><italic>j</italic></sup>(AUC<sub><italic>i</italic></sub>)/<italic>c</italic> for each model <italic>i</italic>, where <italic>c</italic> is the number of AUC columns and <italic>n</italic> is the number of competing models.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tab4" orientation="portrait" position="float">
    <label>Table 4</label>
    <caption>
      <p>Processing time and error estimate of the compared models.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1"> </th>
          <th align="center" rowspan="2" colspan="1">avg.<italic>t</italic>
</th>
          <th align="center" colspan="3" rowspan="1">Simulation 1</th>
          <th align="center" colspan="3" rowspan="1">Simulation 2</th>
        </tr>
        <tr>
          <th align="left" rowspan="1" colspan="1"> </th>
          <th align="center" rowspan="1" colspan="1">avg.cp</th>
          <th align="center" rowspan="1" colspan="1">MAE</th>
          <th align="center" rowspan="1" colspan="1">RMSE</th>
          <th align="center" rowspan="1" colspan="1">avg.cp</th>
          <th align="center" rowspan="1" colspan="1">MAE</th>
          <th align="center" rowspan="1" colspan="1">RMSE</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>hsmm </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.25645</td>
          <td align="center" rowspan="1" colspan="1">12/11.16</td>
          <td align="center" rowspan="1" colspan="1">5.756</td>
          <td align="center" rowspan="1" colspan="1">3.476</td>
          <td align="center" rowspan="1" colspan="1">6/6.50</td>
          <td align="center" rowspan="1" colspan="1">18.73</td>
          <td align="center" rowspan="1" colspan="1">6.31</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bcp </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">1.46298</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>bioHMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">6.96811</td>
          <td align="center" rowspan="1" colspan="1">14/14.71</td>
          <td align="center" rowspan="1" colspan="1">8.655</td>
          <td align="center" rowspan="1" colspan="1">7.376</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
          <td align="center" rowspan="1" colspan="1">NA</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CBS </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.12168</td>
          <td align="center" rowspan="1" colspan="1">12/11.02</td>
          <td align="center" rowspan="1" colspan="1">7.444</td>
          <td align="center" rowspan="1" colspan="1">4.178</td>
          <td align="center" rowspan="1" colspan="1">5/4.93</td>
          <td align="center" rowspan="1" colspan="1">20.762</td>
          <td align="center" rowspan="1" colspan="1">7.068</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>CGHseg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.28938</td>
          <td align="center" rowspan="1" colspan="1">12/9.89</td>
          <td align="center" rowspan="1" colspan="1">9.059</td>
          <td align="center" rowspan="1" colspan="1">4.783</td>
          <td align="center" rowspan="1" colspan="1">7/7.00</td>
          <td align="center" rowspan="1" colspan="1">14.83</td>
          <td align="center" rowspan="1" colspan="1">5.533</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>GLAD </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.23725</td>
          <td align="center" rowspan="1" colspan="1">10/8.22</td>
          <td align="center" rowspan="1" colspan="1">13.128</td>
          <td align="center" rowspan="1" colspan="1">6.071</td>
          <td align="center" rowspan="1" colspan="1">3/4.15</td>
          <td align="center" rowspan="1" colspan="1">22.139</td>
          <td align="center" rowspan="1" colspan="1">7.668</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HaarSeg </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.00268</td>
          <td align="center" rowspan="1" colspan="1">17/15.57</td>
          <td align="center" rowspan="1" colspan="1">12.896</td>
          <td align="center" rowspan="1" colspan="1">4.984</td>
          <td align="center" rowspan="1" colspan="1">10/10.65</td>
          <td align="center" rowspan="1" colspan="1">10.117</td>
          <td align="center" rowspan="1" colspan="1">4.018</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">
            <italic>HMM </italic>
          </td>
          <td align="center" rowspan="1" colspan="1">0.28008</td>
          <td align="center" rowspan="1" colspan="1">7/38.97</td>
          <td align="center" rowspan="1" colspan="1">94.666</td>
          <td align="center" rowspan="1" colspan="1">80.792</td>
          <td align="center" rowspan="1" colspan="1">1/60.05</td>
          <td align="center" rowspan="1" colspan="1">144.83</td>
          <td align="center" rowspan="1" colspan="1">97.178</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>avg.<italic>t</italic> is calculated as the mean run time of 20000 simulation iterations. </p>
      </fn>
      <fn>
        <p>avg.cp is the median/mean number of segments estimated across 3 SNR settings.</p>
      </fn>
      <fn>
        <p>MAE is calculated as the mean absolute error ∑|no.seg − true.no.seg|/<italic>n</italic>.</p>
      </fn>
      <fn>
        <p>RMSE is the rooted mean squared error <inline-formula><mml:math id="M3"><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>no.seg</mml:mtext><mml:mo>-</mml:mo><mml:mtext>true.no.seg</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn mathvariant="normal">2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p>
      </fn>
      <fn>
        <p>NA indicates that the measurement is not applicable for this algorithm. For <italic>bcp</italic>, the model output posterior means for each position that does not tend to form segments with constant mean. For <italic>bioHMM</italic>, the model cannot be run, thus no results were collected.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
