<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7671371</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqz004</article-id>
    <article-id pub-id-type="publisher-id">lqz004</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Standard Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Rapid Peptides Generator: fast and efficient <italic>in silico</italic> protein digestion</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Maillet</surname>
          <given-names>Nicolas</given-names>
        </name>
        <!--<email>nicolas.maillet@pasteur.fr</email>-->
        <xref ref-type="aff" rid="AFF1"/>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><institution>Hub de Bioinformatique et Biostatistique - Département Biologie Computationnelle, Institut Pasteur</institution>, USR 3756 CNRS, Paris, <country country="FR">France</country></aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +33 145688805; Email: <email>nicolas.maillet@pasteur.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-10-05">
      <day>05</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>lqz004</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqz004.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Recent developments in mass spectrometry techniques used in proteomics and proteogenomics have led to a constantly increasing interest in proteases. These proteases are used in different mass spectrometry analyses requiring protein digestions. To perform such digestions, one or multiple proteases are used. Few software exist that predict cleavage sites of proteases and simulate <italic>in silico</italic> digestions. In this work, Rapid Peptides Generator (RPG), a new software developed in order to predict proteases-induced cleavage sites on sequences, is presented. RPG offers extra features and overcomes most issues of existing software in different ways. First, for each generated peptide, RPG gives its sequence, length and estimation of mass, measurements already provided by other software, as well as the peptide’s isoelectric point. Moreover, contrary to existing software that limit the option of proteases to be used to a predefined list, users of RPG are able to easily define new proteases using a simple yet powerful grammar. This feature allows users to stay up-to-date to new or more specific proteases available on the market and optimizes time and effort before the actual mass spectrometry experiment. RPG is freely available through the well established package management system ‘pip’ and follows the standards for software development.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Proteases, also known as proteolytic enzymes, have been studied for more than 80 years (<xref rid="B1" ref-type="bibr">1</xref>). They are widely used in industry, medicine as well as a biological research tool, for example in protein characterization, proteomics and proteogenomics (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>Recent developments in mass spectrometry (MS) techniques used in proteomics and proteogenomics have led to a constantly increasing interest in proteases. In ‘bottom-up’ analysis, using tandem mass spectrometry (MS/MS), the optimal peptide size range is 600–5000 Da (<xref rid="B3" ref-type="bibr">3</xref>) when protein sizes are usually more than 10 000 Da. Therefore, for bottom-up approaches, protein digestions are required. To perform such digestions, one or multiple proteases, like trypsin, pepsin or thrombin, are used. Each protease has specific cleavage sites depending on solvent accessibility, pH, temperature etc. The use of different proteases individually or in combination creates a unique set of peptides. Performing multiple digestions can increase overall confidence in protein identification, if cleaving sites are different. It is not straightforward to determine which combination of proteases will lead to a set of peptides suitable for MS/MS analysis. However, the cost of some proteases does not allow for easily trying multiple combinations in order to avoid redundancy of cleaving sites. To this end, few software that predict cleavage sites of proteases in protein sequences have been developed. Among those, the most commonly used are PeptideCutter from ExPASy Server (<xref rid="B4" ref-type="bibr">4</xref>) and a module integrated in MaxQuant (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>PeptideCutter performs a digestion using one or multiple proteases, among a total list of 38, and provides detailed results, including positions of cleavage sites, peptide sequences, lengths and masses. Despite the valuable information provided by this software, three main features are missing. First, in order to thoroughly analyze the behavior of a specific combination of proteases, it is important to try this combination on many different proteins. With PeptideCutter, the user cannot perform parallel or automatic sequential digestions of different proteins sequence and thus this procedure is time consuming and not efficient. The second drawback of this tool is how a combination of proteases is assessed. In PeptideCutter, all selected proteases are assumed to be present at the same time during digestion. It is therefore difficult to simulate distinct digestions, i.e. digestions of the same sequence using different proteases separately. This means that instead of an automatic succession of distinct digestions, one has to run the software as many times as the number of distinct digestions, multiplied by the number of sequences. Last but not least, in PeptideCutter it is not possible to input novel protease definitions, which is not adapted to the increasing number of new or more specific proteases (denoted as ‘Sequencing Grade’ or SG). Depending on the company manufacturing those SG proteases, specificity and definition can change. Hence, it is important for the user to easily adapt the software by including novel definitions of proteases. The alternative, MaxQuant, partially overcomes some of those issues. The user can input new protease definitions by specifying between which amino acids cleavages occur. Unfortunately, this definition is not sufficient to properly define some proteases. For example, definition of trypsin in MaxQuant lacks some exceptions, e.g. it is defined as cleaving after K or R, but not before P (see Table <xref rid="tbl1" ref-type="table">1</xref> for amino acid designation). However, it has been reported that although most of the times P blocks the cleavage when found after K, this is not true when K is preceded by W: a cleavage occurs after K in ‘WKP’ motif (<xref rid="B6" ref-type="bibr">6</xref>). Currently, it is not possible to create such rules in MaxQuant.</p>
    <table-wrap id="tbl1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Molecular weight of amino acid and p<italic>K</italic><sub><italic>a</italic></sub> values of ionizable groups in proteins</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Amino acid</th>
            <th rowspan="1" colspan="1">1-letter</th>
            <th rowspan="1" colspan="1">Mass value*</th>
            <th rowspan="1" colspan="1">Typical p<italic>K</italic><sub><italic>a</italic></sub>**</th>
            <th rowspan="1" colspan="1">p<italic>K</italic><sub><italic>a</italic></sub> from</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Abbreviation</th>
            <th rowspan="1" colspan="1">(Da)</th>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">IPC_peptide</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">N-terminal</td>
            <td rowspan="1" colspan="1">n</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">8.0</td>
            <td rowspan="1" colspan="1">9.564</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Alanine</td>
            <td rowspan="1" colspan="1">A</td>
            <td rowspan="1" colspan="1">71.0788</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Cysteine</td>
            <td rowspan="1" colspan="1">C</td>
            <td rowspan="1" colspan="1">103.1388</td>
            <td rowspan="1" colspan="1">8.3</td>
            <td rowspan="1" colspan="1">8.297</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Aspartic acid</td>
            <td rowspan="1" colspan="1">D</td>
            <td rowspan="1" colspan="1">115.0886</td>
            <td rowspan="1" colspan="1">4.1</td>
            <td rowspan="1" colspan="1">3.887</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Glutamic acid</td>
            <td rowspan="1" colspan="1">E</td>
            <td rowspan="1" colspan="1">129.1155</td>
            <td rowspan="1" colspan="1">4.1</td>
            <td rowspan="1" colspan="1">4.317</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Phenylalanine</td>
            <td rowspan="1" colspan="1">F</td>
            <td rowspan="1" colspan="1">147.1766</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Glycine</td>
            <td rowspan="1" colspan="1">G</td>
            <td rowspan="1" colspan="1">57.0519</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Histidine</td>
            <td rowspan="1" colspan="1">H</td>
            <td rowspan="1" colspan="1">137.1411</td>
            <td rowspan="1" colspan="1">6.0</td>
            <td rowspan="1" colspan="1">6.018</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Isoleucine</td>
            <td rowspan="1" colspan="1">I</td>
            <td rowspan="1" colspan="1">113.1594</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Lysine</td>
            <td rowspan="1" colspan="1">K</td>
            <td rowspan="1" colspan="1">128.1741</td>
            <td rowspan="1" colspan="1">10.8</td>
            <td rowspan="1" colspan="1">10.517</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Leucine</td>
            <td rowspan="1" colspan="1">L</td>
            <td rowspan="1" colspan="1">113.1594</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Methionine</td>
            <td rowspan="1" colspan="1">M</td>
            <td rowspan="1" colspan="1">131.1926</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Asparagine</td>
            <td rowspan="1" colspan="1">N</td>
            <td rowspan="1" colspan="1">114.1038</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Pyrrolysine</td>
            <td rowspan="1" colspan="1">O</td>
            <td rowspan="1" colspan="1">237.3018</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Proline</td>
            <td rowspan="1" colspan="1">P</td>
            <td rowspan="1" colspan="1">97.1167</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Glutamine</td>
            <td rowspan="1" colspan="1">Q</td>
            <td rowspan="1" colspan="1">128.1307</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Arginine</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">156.1875</td>
            <td rowspan="1" colspan="1">12.5</td>
            <td rowspan="1" colspan="1">12.503</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Serine</td>
            <td rowspan="1" colspan="1">S</td>
            <td rowspan="1" colspan="1">87.0782</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Threonine</td>
            <td rowspan="1" colspan="1">T</td>
            <td rowspan="1" colspan="1">101.1051</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Selenocysteine</td>
            <td rowspan="1" colspan="1">U</td>
            <td rowspan="1" colspan="1">150.0388</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Valine</td>
            <td rowspan="1" colspan="1">V</td>
            <td rowspan="1" colspan="1">99.1326</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Tryptophan</td>
            <td rowspan="1" colspan="1">W</td>
            <td rowspan="1" colspan="1">186.2132</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">–</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Tyrosine</td>
            <td rowspan="1" colspan="1">Y</td>
            <td rowspan="1" colspan="1">163.1760</td>
            <td rowspan="1" colspan="1">10.9</td>
            <td rowspan="1" colspan="1">10.071</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">C-terminal</td>
            <td rowspan="1" colspan="1">c</td>
            <td rowspan="1" colspan="1">–</td>
            <td rowspan="1" colspan="1">3.1</td>
            <td rowspan="1" colspan="1">2.383</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="T1TFN1">
          <p>*Average molecular weight as defined in ExPASy web server (<ext-link ext-link-type="uri" xlink:href="https://web.expasy.org/findmod/findmod_masses.html#aas">https://web.expasy.org/findmod/findmod_masses.html#aas</ext-link>)</p>
        </fn>
        <fn id="T1TFN2">
          <p>**p<italic>K</italic><sub><italic>a</italic></sub> values as defined in Biochemistry (<xref rid="B10" ref-type="bibr">10</xref>) . Values depend on temperature, ionic strength and the microenvironment of the ionizable group.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>In this paper, a novel software developed to predict proteases-induced cleavage sites on sequences is presented, Rapid Peptides Generator (RPG), overcoming most issues of existing programs. First, RPG computes an accurate estimation of the molecular weight and isoelectric point of each generated peptide. Second, RPG takes into account miscleavages and importantly, it assigns to each proteases a probability of miscleavage event. Third, RPG introduces two distinct digestion modes. In the first one, each selected protease acts independently, simulating different experiments on multiple proteins. In the second mode, all selected proteases are acting at the same time, simulating multiple proteases digestions of a protein. Finally, the main contribution of RPG is the possibility for the user to easily define new proteases and use them in the software.</p>
    <p>RPG is freely available through the well established package management system <bold>pip</bold> (<italic>pip3 install rpg</italic>) and follows the standards for software development with continuous integration on Gitlab (<ext-link ext-link-type="uri" xlink:href="https://gitlab.pasteur.fr/nmaillet/rpg">https://gitlab.pasteur.fr/nmaillet/rpg</ext-link>) and automatic on-line documentation (<ext-link ext-link-type="uri" xlink:href="https://rapid-peptide-generator.readthedocs.io">https://rapid-peptide-generator.readthedocs.io</ext-link>).</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <p>RPG is a python tool that takes (multi-)fasta/fastq file of proteins as input and digests each of them. Digestion mode can be either ‘concurrent’, i.e. all proteases are present at the same time during digestion or ‘sequential’. In sequential mode, each sequence is digested by each protease, one by one. In both modes, the output information is the same as in PeptideCutter, plus an important property: an estimation of isoelectric point (pI) of each generated peptide. Shortly, the isoelectric point is the pH at which a peptide carries no net electrical charge and a good approximation can be computed on small molecules (<xref rid="B7" ref-type="bibr">7</xref>). The results are outputted in multi-fasta, CSV or TSV file.</p>
    <p>At the moment, 42 proteases and chemical compounds are included in RPG. The user can easily design new proteases, using a simple yet powerful grammar. This grammar enables the user to design complex proteases like trypsin or thrombin, including many exceptions and different cleavage sites. User-defined proteases are then interpreted by RPG and included in the local installation of the software.</p>
    <p>In the rest of the text, nomenclature of Schechter and Berger (<xref rid="B8" ref-type="bibr">8</xref>) is used. Amino acids before the cleavage site are designated as P1, P2, P3, etc. in the N-terminal direction, and as P1’, P2’, P3’, etc. in the C-terminal direction. For example, with cleavage site represented by an arrow (<sc>↓</sc>), amino acids are designated as:</p>
    <p>...P3-P2-P1-↓-P1’-P2’-P3’...</p>
    <p>Note that in RPG, this nomenclature is represented as:</p>
    <p>...(P3)(P2)(P1)(,)(P1’)(P2’)(P3’)...</p>
    <sec id="SEC2-1">
      <title>Definition of cleaving site: the RPG <italic>rule</italic> object</title>
      <p>The main structure of RPG is a recursive object named <italic>rule</italic>. A <italic>rule</italic> is defined by an amino acid of interest (<monospace>amino_acid</monospace> in all following examples), at a relative position (<monospace>index</monospace>), and by a Boolean indicating if the program should cleave (<monospace>cleavage</monospace>) before or after (<monospace>position</monospace>) this specific amino acid. For example, the <italic>rule</italic><sc>rule_a = (a, 0, True, Before)</sc> indicates to cleave before the current position (0), when an alanine (<sc>a</sc>) is encountered. The <italic>rule</italic><sc>rule_b = (e, 0, True, After)</sc> will cleave just after a glutamate acid (<sc>e</sc>).</p>
      <p>The <italic>rule</italic> also contains a list of <italic>rule</italic> objects (<monospace>sub-rules</monospace>), hence its recursivity. This list represents exceptions to the main <italic>rule</italic> they are linked to. In the previous example, i.e. <sc>rule_b = (e, 0, True, After)</sc>, one can add an exception that specifies not to cleave if the glutamic acid is preceded by another glutamic acid. To do so, the <italic>rule</italic><sc>sub_rule_b = (e, -1, False, None)</sc> must be added to the <italic>sub-rules</italic> list of <sc>rule_b</sc>. It should be noted that for the <italic>sub-rules</italic>, the cleaving indication (before or after) is not relevant and the position is relative to the position of the amino acid in the main <italic>rule</italic>. The <sc>sub_rule_b</sc> indicates to look at the <italic>n</italic> − 1 position: if an <sc>e</sc> is found there, no cleavage occurs after the <sc>e</sc> at the current position. Finally, the <sc>rule_b</sc> defines a protease that cleaves after an <sc>e</sc> if this <sc>e</sc> is not directly preceded by another <sc>e</sc>. This protease reproduces the behavior of staphylococcal-peptidase-I that preferentially cleaves after <sc>e</sc> (P1). It will not cleave after <sc>e</sc> in P1 preceded by <sc>e</sc> in P2, but it cleaves after <sc>e</sc> in P1 followed by <sc>e</sc> in P1’ (<sc>e↓e</sc>). The sequence <sc>aeert</sc> will be cleaved by staphylococcal-peptidase-I only after the first <sc>e</sc>, resulting in two peptides: <sc>ae</sc> and <sc>ert</sc>. A way of representing staphylococcal-peptidase-I with RPG <italic>rule</italic> objects is show on Rule 1.</p>
      <p>
        <graphic xlink:href="lqz004ufig1.jpg" mimetype="image" position="float" orientation="portrait"/>
      </p>
      <p>This sub-rules system can also work the other way: cleaving if a specific amino acid is present after/before another specific one. For example, hydroxylamine preferentially cleaves after <sc>n</sc> (P1) followed by <sc>g</sc> in P1’ (<sc>n↓g</sc>). To define this protease (see Rule 2), the main <italic>rule</italic> will specify to ‘not’ cleave after <sc>n</sc> while the sub-rule will specify to actually cleave if <sc>g</sc> is following:</p>
      <p>
        <graphic xlink:href="lqz004ufig2.jpg" mimetype="image" position="float" orientation="portrait"/>
      </p>
      <p>Note that sub-rules are <italic>rules</italic>, hence the possibility to assign sub-rules to sub-rules. For example, thrombin SG as defined in RPG preferentially cleaves after <sc>r</sc> (P1) preceded by <sc>p</sc> in P2, <sc>v</sc> in P3 and <sc>l</sc> in P4, and followed by <sc>g</sc> in P1’ and <sc>s</sc> in P2’. As shown in Rule 3, only the deepest sub-rule will contain the information to cleave as all upper amino acids are required. This means that thrombin SG will only cleave after <sc>r</sc> on the specific sequence <sc>lvpr↓gs</sc>: if one amino acid is missing, no cleavage occurs.</p>
      <p>
        <graphic xlink:href="lqz004ufig3.jpg" mimetype="image" position="float" orientation="portrait"/>
      </p>
      <p>In the previous examples, a protease is defined in RPG as a single rule, with potential sub-rules. More generally, a protease is defined by a list of <italic>rule</italic>. To fully describe the chymotrypsin (high specificity) in RPG, three rules are needed: chymotrypsin (high specificity) preferentially cleaves after <sc>f</sc>, <sc>y</sc> or <sc>w</sc> (P1) if those amino acids are not followed by <sc>p</sc> in P1’. Moreover, it will not cleave after <sc>w</sc> followed by <sc>m</sc> in P1’. Thus, three <italic>rules</italic> are defined, one for <sc>f</sc>, one for <sc>y</sc> and one for <sc>w</sc>. Those three <italic>rules</italic> have an identical sub-rule, defining the exception when <sc>p</sc> is following their amino acid. The above mentioned <italic>rule</italic> for <sc>w</sc> also contains a second sub-rule, preventing the cleavage when an <sc>m</sc> is following it. Rule 4 presents the <italic>rules</italic> in RPG for chymotrypsin (high specificity).</p>
      <p>
        <graphic xlink:href="lqz004ufig4.jpg" mimetype="image" position="float" orientation="portrait"/>
      </p>
      <p>No database is needed to store proteases as each protease is just composed of Python executable code. This code is used by RPG engine to deduce where cleavages occur on a sequence.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Cleaving sequences: RPG engine</title>
      <p>The second key part of RPG is the engine interpreting proteases defined by <italic>rules</italic>. This main function takes a sequence and a protease as input. The sequence is then processed amino acid by amino acid. For each position, all main <italic>rules</italic> of the protease are analyzed to check if the current amino acid corresponds to one of them. Note that sub-rules are not taken into account at this point: the program just verifies if the current amino acid is involved by a potential cleavage.</p>
      <p>When an amino acid corresponds to one of the main <italic>rules</italic>, the sub-rules are recursively tested to define if a cleavage occurs. If a cleavage occurs, the peptide corresponding to the left part of the original sequence until the cleavage position is generated and the current position is kept in memory. Note that the original sequence is not truncated, as potential future cleavage points may require information from previous amino acids (for example, staphylococcal-peptidase-I, see Rule 1). When another cleavage occurs, the new peptide will be generated from the previous stored position until the current cleavage position. At the end of the sequence, the last peptide is generated from the last stored position until the end of the sequence.</p>
      <p>When a peptide is generated, several estimations are computed as explained in the following section.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Molecular mass and isoelectric point estimations</title>
      <p>For each generated peptide, three measurements are computed: the length of the peptide, its estimated molecular weight and its estimated isoelectric point (pI). The length is simply the number of amino acids composing the peptide.</p>
      <p>The molecular mass of a peptide is less direct to compute. Since proteolysis requires a molecule of water, after a cleavage the chemical structure of the resulting peptide is slightly modified: a hydrogen is added at the N-terminus and a hydroxyl group is added at the C-terminus. The mass of two hydrogens and one oxygen must then be added to the total mass of the peptide. The resulting mass of a peptide is calculated by adding up the average isotopic masses of each amino acid present in the peptide and the average isotopic mass of one water molecule. Note that in RPG, no post-translational or digestion-induced modifications are included in the results.</p>
      <p>The pI of a peptide is the pH at which this peptide is electrically neutral. The pI is of great relevance in biochemistry, especially in liquid chromatography mass spectrometry. As its net charge is directly related to the pH of the solution, the isoelectric point can be computed by solving the following rearranged Henderson–Hasselbalch equations (<xref rid="B9" ref-type="bibr">9</xref>), which calculate the charge of a peptide at a certain pH:<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} {\rm pI} = \left\lbrace \begin{array}{rcr}\sum \limits _{i=1}^{n}\frac{-1}{1+10^{pK_a-pH}} \text{, for negatively charged amino acids}\\ \sum \limits _{i=1}^{n}\frac{1}{1+10^{pH-pK_a}} \text{, for positively charged amino acids}\\ \end{array} \right. \end{eqnarray*}$$\end{document}</tex-math></disp-formula>where p<italic>K</italic><sub><italic>a</italic></sub> is the acid dissociation constant of the given charged amino acid (see Table <xref rid="tbl1" ref-type="table">1</xref>) and <italic>n</italic> the number of amino acids.</p>
      <p>Note that in those equations, only the pH is variable while the p<italic>K</italic><sub><italic>a</italic></sub> values are fixed. Given fixed p<italic>K</italic><sub><italic>a</italic></sub> values, the net charge of a peptide at a given pH is simply the sum of positive and negative charges of all amino acids composing it.</p>
      <p>Typical p<italic>K</italic><sub><italic>a</italic></sub> values of ionizable groups are well-defined in literature (<xref rid="B10" ref-type="bibr">10</xref>). A recent paper (IPC – Isoelectric Point Calculator (<xref rid="B7" ref-type="bibr">7</xref>)) showed that p<italic>K</italic><sub><italic>a</italic></sub> values can be more accurately defined for different classes of macromolecules.</p>
      <p>As mentioned earlier, no post-translational or digestion-induced modifications are included in RPG, leading to a result almost certainly different from the exact pI (<xref rid="B9" ref-type="bibr">9</xref>). Nevertheless, given appropriate p<italic>K</italic><sub><italic>a</italic></sub> values, the calculated approximation is ±0.5 of the exact pI of proteins and it is even better for short peptides (<xref rid="B7" ref-type="bibr">7</xref>). In RPG, p<italic>K</italic><sub><italic>a</italic></sub> values from IPC_peptides are used by default, with the possibility for the user to select more typical p<italic>K</italic><sub><italic>a</italic></sub> values. The pI is computed using binary search. The computation starts by solving Henderson–Hasselbalch equations for the mean pH 7. If the result is &lt;0 (respectively, &gt;0), the pH corresponding to this pI is most certainly &lt;7, so between pH 0 and 7 (&gt;7, so between pH 7 and 14). Henderson–Hasselbalch equations are then solved using the mean pH of the resulting interval: pH 3.5 (pH 10.5). This computation will continue until a suitable pH value is found, with an accuracy of 0.01.</p>
    </sec>
    <sec id="SEC2-4">
      <title>New protease creation</title>
      <p>One of the main features of RPG is the possibility for users to easily define new proteases. As explained in section <bold>Definition of cleaving site</bold>, proteases are defined in RPG as instructions of Python code. To simplify the description of new proteases without having to write code, a new formal grammar has been created. This grammar, as any formal grammar, is composed of an alphabet, a syntax and a set of production rules to form valid strings, according to the grammar definition.</p>
      <p>To stay as close as possible to the nomenclature of Schechter and Berger, the grammar of RPG introduces only minor modifications, allowing it to be formal and easier to use. For example, hydroxylamine, which cleaves between <sc>n</sc> and <sc>g</sc> (<sc>n↓g</sc>), and represented as <sc>n</sc>(P1) <sc>g</sc>(P1’) using the nomenclature of Schechter and Berger, is defined as <sc><monospace>(n,)(g)</monospace></sc> in RPG’s grammar. A protease definition is composed of one or several rules, expressed using the grammar.</p>
      <sec id="SEC2-4-1">
        <title>Basic core of the grammar</title>
        <p>Each inputed rule consists of sequences of involved amino acids. The first modification is the formal definition of the position of the cleavage site. As a matter of fact, even if a rule is composed of only one amino acid, there is still possibility to cleave before or after this amino acid. Hence, the formalism of RPG’s grammar necessitates a comma ‘,’ to indicate the cleavage site. For example, hydroxylamine will be defined as <sc><monospace><sc>n,g</sc></monospace></sc>, indicating that cleavage must occur between <sc>n</sc>(P1) and <sc>g</sc>(P1’). Note that each rule must contain only one comma, i.e. one cleavage site: if a protease cleaves at different positions, several rules must be defined. This beginning of formalism induces the concept of <sc>and</sc> between amino acid: <sc><monospace><sc>n,g</sc></monospace></sc> represent a cleavage if <sc>n</sc><bold><sc>and</sc></bold><sc>g</sc> are both present, in this specific order.</p>
        <p>In order to facilitate the definition of more complex proteases, two adjustments were included.</p>
      </sec>
      <sec id="SEC2-4-2">
        <title>The <sc>or</sc> keyword and parenthesis</title>
        <p>With the basic grammar defined above, one can input rules corresponding to Bromelain that preferentially cleaves after <sc>k</sc>, <sc>a</sc> or <sc>y</sc> (P1). To do so, one must input three rules: <sc><monospace><sc>k,</sc></monospace></sc>, <sc><monospace><sc>a,</sc></monospace></sc> then <sc><monospace><sc>y,</sc></monospace></sc>. To simplify this procedure, the <sc><monospace>or</monospace></sc> keyword was introduced. Bromelain can then be defined with a single rule: <sc><monospace><sc>k, or a, or y,</sc></monospace></sc>.</p>
        <p>There are, however, cases where this straightforward and simple rule can lead to ambiguous definitions: does the rule <sc><monospace><sc>ac, or d,</sc></monospace></sc> define a cleavage occurring after <sc>ac</sc> or <sc>d</sc>, or occurring after <sc>ac</sc> or <sc>ad</sc>? To resolve this ambiguity and simplify the reading, parentheses were introduced. A parenthesis system, which is everything between an opening parenthesis and a closing parenthesis, represents a position, like P1, P2, P1’, etc. This constrains the grammar and thus the previous example will not be valid anymore. It will either be the rule <sc><monospace><sc>(a)(c or d,)</sc></monospace></sc>, simulating a protease cleaving after <sc>c</sc> or <sc>d</sc> (P1) when <sc>a</sc> is in P2, or the two rules <sc><monospace><sc>(a)(c,)</sc></monospace></sc> and <sc><monospace><sc>(d,)</sc></monospace></sc>, cleaving after <sc>c</sc> (P1) when <sc>a</sc> is in P2 or always after <sc>d</sc> (P1). With this parentheses system, Bromelain definition becomes <sc><monospace><sc>(k or a or y,)</sc></monospace></sc>. Note that there is now a single comma, indicating whereas <sc>k</sc>, <sc>a</sc> and <sc>y</sc> are in P1 or in P1’ and that the <sc><monospace>or</monospace></sc> keyword is evaluated before the comma.</p>
      </sec>
      <sec id="SEC2-4-3">
        <title>Two commas</title>
        <p>With the parentheses system only one comma is required per rule; a comma is where the cleavage occurs, before or after the involved position. For an easier usage, a rule can contain two commas as long as they are in the same parentheses system; this corresponds to a cleavage occurring before and after a specific amino acid. For example pepsin, used when pH is &gt;2, preferentially cleaves around <sc>f</sc>, <sc>l</sc>, <sc>w</sc> or <sc>y</sc> (P1 or P1’). This can be defined in RPG as a set of two rules: <sc><monospace><sc>(,f or l or w or y)</sc></monospace></sc> and <sc><monospace><sc>(f or l or w or y,)</sc></monospace></sc>. Using two commas, this becomes the single rule: <sc><monospace><sc>(,f or l or w or y,)</sc></monospace></sc>. Note that in reality pepsin cleavage rules are more complicated and contain many exceptions in its corresponding RPG full definition.</p>
      </sec>
      <sec id="SEC2-4-4">
        <title>Exceptions</title>
        <p>The last important part of protease definition in RPG is the notion of exceptions. An exception is a rule modifying the behavior of a normal cleavage. For example, staphylococcal-peptidase-I cleaves after <sc>e</sc> (P1) when there is no <sc>e</sc> in P2. The main rule is to cleave after <sc>e</sc> and the exception is to not cleave if another <sc>e</sc> precedes it. An exception in RPG follows the same grammar as a classical rule. The only difference is RPG's interpretation: an exception is a sub-rule of a normal rule, i.e. it will be added in the list of rules of the involved main rules (see section <bold>Definition of cleaving site</bold>). This requires for the main rule to be already defined in the current protease definition, as every exception must be linked to a main rule. Note that a normal rule can already contain exceptions; for example in the hydroxylamine definition (<sc><monospace><sc>(n,)(g)</sc></monospace></sc>), <sc>g</sc> is an exception added to the sub-rule list of the main rule <sc>n</sc> (see Rule 2). In hydroxylamine, this mechanism is transparent for the user, as no proper exceptions are defined by her/him. The exception mechanism described here allows the user to manually define an exception that is impossible to describe using normal rules.</p>
      </sec>
    </sec>
    <sec id="SEC2-5">
      <title>Miscleavage</title>
      <p>It is possible that a protease does not cleave at a given position even if all requirements are fulfilled. This event is called miscleavage and can have biological, chemical or physical origins. Despite the existence of some empirical miscleavage rules, there is an uncertainty concerning which sites will be cleaved or not (<xref rid="B11" ref-type="bibr">11</xref>). Moreover, depending on the protease, the experimental conditions and exposure time, the miscleavage events probability may vary from very small to high. In RPG, a simple method is used in order to take into account these miscleavage events: when running RPG, one can assign a miscleavage probability to each selected protease, expressed as a percentage. Then, every time RPG finds a cleavage position, a random number that reflects the miscleavage probability is generated: if the generated number is below the percentage probability, no cleavage occurs. For example, for a specific and aggressive protease, such as trypsin in optimal conditions, the number of miscleavages is low: thus a value of 0 to 1% is appropriate. For a non-specific protease like pepsin, used at a low concentration and exposure time, a value of 20% can be considered. While this method does not take into account the biological, chemical or physical origins it does incorporate the concept of miscleavage, which is crucial. Indeed, without it, RPG delivers a perfect cleaving situation, that rarely occurs in reality.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>In the following, RPG is compared to PeptideCutter, the current gold standard for <italic>in silico</italic> digestion. RPG and PeptideCutter are compared in terms of results and execution time. RPG is then applied on two protein families with three different sets of proteases. Results exhibit how the choice of proteases greatly conditions the nature of the generated peptides.</p>
    <sec id="SEC3-1">
      <title>Comparison between RPG and PeptideCutter</title>
      <p>The 38 proteases available in PeptideCutter are also available in RPG and are compared in this section. As PeptideCutter can only work on one protein at a time, one of the largest proteins has been chosen to run the following benchmark: the Human muscle protein Titin (UniProtKB id: A0A0A0MTS7), which consists of 35 991 amino acids (<xref rid="B12" ref-type="bibr">12</xref>).</p>
      <p>RPG's execution time was obtained using the <monospace>time</monospace> command of the Unix system. PeptideCutter's execution time is the effective time needed for the web server to fully output the result page in the browser. In both cases, execution time includes the computation time and the time to output results. The mean execution time of RPG for digesting Titin with one protease is 0.467 s (see Table <xref rid="tbl2" ref-type="table">2</xref>). For PeptideCutter the mean time is computed without caspases 3 to 10 as the computation for those proteases was long and aborted after 30s. PeptideCutter’s mean time is 3.446 s and execution time of RPG is, on average, 7.379 times faster than PeptideCutter.</p>
      <table-wrap id="tbl2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Comparison of PeptideCutter and RPG in terms of execution time, number of generated peptides and results</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Protease</th>
              <th colspan="2" align="center" rowspan="1">Execution time (s)</th>
              <th colspan="2" align="center" rowspan="1">Number of peptides</th>
              <th rowspan="1" colspan="1">Identical</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Name</th>
              <th align="center" rowspan="1" colspan="1">RPG</th>
              <th align="center" rowspan="1" colspan="1">PepC</th>
              <th align="center" rowspan="1" colspan="1">RPG</th>
              <th align="center" rowspan="1" colspan="1">PepC</th>
              <th rowspan="1" colspan="1">Results</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Arg-C</td>
              <td align="center" rowspan="1" colspan="1">0.415</td>
              <td align="center" rowspan="1" colspan="1">2.86</td>
              <td align="center" rowspan="1" colspan="1">1665</td>
              <td align="center" rowspan="1" colspan="1">1665</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Asp-N</td>
              <td align="center" rowspan="1" colspan="1">0.463</td>
              <td align="center" rowspan="1" colspan="1">3.99</td>
              <td align="center" rowspan="1" colspan="1">2261</td>
              <td align="center" rowspan="1" colspan="1">1739</td>
              <td rowspan="1" colspan="1">False</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Asp-N-pepc*</td>
              <td align="center" rowspan="1" colspan="1">0.421</td>
              <td align="center" rowspan="1" colspan="1">3.99</td>
              <td align="center" rowspan="1" colspan="1">1739</td>
              <td align="center" rowspan="1" colspan="1">1739</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Asp-N-Glu-N</td>
              <td align="center" rowspan="1" colspan="1">0.594</td>
              <td align="center" rowspan="1" colspan="1">4.43</td>
              <td align="center" rowspan="1" colspan="1">5175</td>
              <td align="center" rowspan="1" colspan="1">5175</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BNPS-Skatole</td>
              <td align="center" rowspan="1" colspan="1">0.371</td>
              <td align="center" rowspan="1" colspan="1">2.59</td>
              <td align="center" rowspan="1" colspan="1">470</td>
              <td align="center" rowspan="1" colspan="1">470</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase1</td>
              <td align="center" rowspan="1" colspan="1">0.346</td>
              <td align="center" rowspan="1" colspan="1">3.8</td>
              <td align="center" rowspan="1" colspan="1">22</td>
              <td align="center" rowspan="1" colspan="1">22</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase2</td>
              <td align="center" rowspan="1" colspan="1">0.364</td>
              <td align="center" rowspan="1" colspan="1">2.86</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase3</td>
              <td align="center" rowspan="1" colspan="1">0.389</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase4</td>
              <td align="center" rowspan="1" colspan="1">0.372</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase5</td>
              <td align="center" rowspan="1" colspan="1">0.356</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase6</td>
              <td align="center" rowspan="1" colspan="1">0.362</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase7</td>
              <td align="center" rowspan="1" colspan="1">0.365</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase8</td>
              <td align="center" rowspan="1" colspan="1">0.357</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase9</td>
              <td align="center" rowspan="1" colspan="1">0.406</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Caspase10</td>
              <td align="center" rowspan="1" colspan="1">0.409</td>
              <td align="center" rowspan="1" colspan="1">&gt;30</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Chymotrypsin-high</td>
              <td align="center" rowspan="1" colspan="1">0.488</td>
              <td align="center" rowspan="1" colspan="1">3.23</td>
              <td align="center" rowspan="1" colspan="1">2334</td>
              <td align="center" rowspan="1" colspan="1">2334</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Chymotrypsin-low</td>
              <td align="center" rowspan="1" colspan="1">0.661</td>
              <td align="center" rowspan="1" colspan="1">4.73</td>
              <td align="center" rowspan="1" colspan="1">5188</td>
              <td align="center" rowspan="1" colspan="1">5188</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Clostripain</td>
              <td align="center" rowspan="1" colspan="1">0.414</td>
              <td align="center" rowspan="1" colspan="1">3.35</td>
              <td align="center" rowspan="1" colspan="1">1665</td>
              <td align="center" rowspan="1" colspan="1">1665</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CNBr</td>
              <td align="center" rowspan="1" colspan="1">0.360</td>
              <td align="center" rowspan="1" colspan="1">2.42</td>
              <td align="center" rowspan="1" colspan="1">409</td>
              <td align="center" rowspan="1" colspan="1">409</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Enterokinase</td>
              <td align="center" rowspan="1" colspan="1">0.338</td>
              <td align="center" rowspan="1" colspan="1">3.16</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">False</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Enterokinase-pepc*</td>
              <td align="center" rowspan="1" colspan="1">0.348</td>
              <td align="center" rowspan="1" colspan="1">3.16</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Factor-Xa</td>
              <td align="center" rowspan="1" colspan="1">0.344</td>
              <td align="center" rowspan="1" colspan="1">2.53</td>
              <td align="center" rowspan="1" colspan="1">8</td>
              <td align="center" rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Formic-acid</td>
              <td align="center" rowspan="1" colspan="1">0.416</td>
              <td align="center" rowspan="1" colspan="1">2.99</td>
              <td align="center" rowspan="1" colspan="1">1739</td>
              <td align="center" rowspan="1" colspan="1">1739</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Glutamyl</td>
              <td align="center" rowspan="1" colspan="1">0.495</td>
              <td align="center" rowspan="1" colspan="1">3.37</td>
              <td align="center" rowspan="1" colspan="1">3437</td>
              <td align="center" rowspan="1" colspan="1">3437</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GranzymeB</td>
              <td align="center" rowspan="1" colspan="1">0.349</td>
              <td align="center" rowspan="1" colspan="1">2.28</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Hydroxylamine</td>
              <td align="center" rowspan="1" colspan="1">0.345</td>
              <td align="center" rowspan="1" colspan="1">2.88</td>
              <td align="center" rowspan="1" colspan="1">50</td>
              <td align="center" rowspan="1" colspan="1">50</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Iodosobenzoic-acid</td>
              <td align="center" rowspan="1" colspan="1">0.362</td>
              <td align="center" rowspan="1" colspan="1">2.39</td>
              <td align="center" rowspan="1" colspan="1">470</td>
              <td align="center" rowspan="1" colspan="1">470</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Lys-C</td>
              <td align="center" rowspan="1" colspan="1">0.493</td>
              <td align="center" rowspan="1" colspan="1">3.41</td>
              <td align="center" rowspan="1" colspan="1">3187</td>
              <td align="center" rowspan="1" colspan="1">3187</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Lys-N</td>
              <td align="center" rowspan="1" colspan="1">0.491</td>
              <td align="center" rowspan="1" colspan="1">3.47</td>
              <td align="center" rowspan="1" colspan="1">3187</td>
              <td align="center" rowspan="1" colspan="1">3187</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">NTCB</td>
              <td align="center" rowspan="1" colspan="1">0.363</td>
              <td align="center" rowspan="1" colspan="1">2.53</td>
              <td align="center" rowspan="1" colspan="1">523</td>
              <td align="center" rowspan="1" colspan="1">523</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Neutrophil-elastase</td>
              <td align="center" rowspan="1" colspan="1">0.612</td>
              <td align="center" rowspan="1" colspan="1">3.97</td>
              <td align="center" rowspan="1" colspan="1">5645</td>
              <td align="center" rowspan="1" colspan="1">5645</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pepsin-pH1.3</td>
              <td align="center" rowspan="1" colspan="1">0.603</td>
              <td align="center" rowspan="1" colspan="1">3.99</td>
              <td align="center" rowspan="1" colspan="1">4399</td>
              <td align="center" rowspan="1" colspan="1">4399</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pepsin-pHg2</td>
              <td align="center" rowspan="1" colspan="1">0.771</td>
              <td align="center" rowspan="1" colspan="1">4.45</td>
              <td align="center" rowspan="1" colspan="1">6482</td>
              <td align="center" rowspan="1" colspan="1">6482</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Proline</td>
              <td align="center" rowspan="1" colspan="1">0.362</td>
              <td align="center" rowspan="1" colspan="1">2.61</td>
              <td align="center" rowspan="1" colspan="1">408</td>
              <td align="center" rowspan="1" colspan="1">408</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Proteinase-K</td>
              <td align="center" rowspan="1" colspan="1">1.298</td>
              <td align="center" rowspan="1" colspan="1">6.96</td>
              <td align="center" rowspan="1" colspan="1">18393</td>
              <td align="center" rowspan="1" colspan="1">18393</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Staphylococcal-p-I</td>
              <td align="center" rowspan="1" colspan="1">0.482</td>
              <td align="center" rowspan="1" colspan="1">3.35</td>
              <td align="center" rowspan="1" colspan="1">3092</td>
              <td align="center" rowspan="1" colspan="1">3092</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Thermolysin</td>
              <td align="center" rowspan="1" colspan="1">0.831</td>
              <td align="center" rowspan="1" colspan="1">4.48</td>
              <td align="center" rowspan="1" colspan="1">8835</td>
              <td align="center" rowspan="1" colspan="1">8835</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Thrombin</td>
              <td align="center" rowspan="1" colspan="1">0.346</td>
              <td align="center" rowspan="1" colspan="1">2.54</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td align="center" rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TEV</td>
              <td align="center" rowspan="1" colspan="1">0.344</td>
              <td align="center" rowspan="1" colspan="1">2.96</td>
              <td align="center" rowspan="1" colspan="1">3</td>
              <td align="center" rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">False</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TEV-pepc*</td>
              <td align="center" rowspan="1" colspan="1">0.347</td>
              <td align="center" rowspan="1" colspan="1">2.96</td>
              <td align="center" rowspan="1" colspan="1">7</td>
              <td align="center" rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Trypsin</td>
              <td align="center" rowspan="1" colspan="1">0.566</td>
              <td align="center" rowspan="1" colspan="1">4.27</td>
              <td align="center" rowspan="1" colspan="1">4425</td>
              <td align="center" rowspan="1" colspan="1">4425</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Arg-C-LysN-BNPS</td>
              <td align="center" rowspan="1" colspan="1">0.803</td>
              <td align="center" rowspan="1" colspan="1">4.19</td>
              <td align="center" rowspan="1" colspan="1">5163</td>
              <td align="center" rowspan="1" colspan="1">5163</td>
              <td rowspan="1" colspan="1">True</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T2TFN1">
            <p>*Proteases locally defined in RPG and not available in default installation.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Contrary to PeptideCutter, RPG can run sequentially multiple proteases, where PeptideCutter performs as if all selected proteases were cleaving at the same time. This mode of RPG allows to calculate all the cleaving operations in a single run. Simulating the cleaving site and generating the peptides for the 38 tested proteases of Table <xref rid="tbl2" ref-type="table">2</xref> took 6.141 s with RPG.</p>
      <p>Except for three proteases, all results are strictly identical, with exactly the same mass for each generated peptide (precision of three numbers induced by PeptideCutter) and the same number and content of peptides. The three proteases with different results are Asp-N endopeptidase, enterokinase and Tobacco etch virus protease (TEV). The definition of Asp-N endopeptidase as established in PeptideCutter cleaves specifically before aspartic acid, whereas the definition in RPG is less restrictive, cleaving before aspartic acid or cysteine, as defined in several publications (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>).</p>
      <p>In theory, enterokinase and TEV have long cleavage definitions, i.e. a succession of five amino acids for enterokinase (<sc><monospace><sc>(d or e)(d or e)(d or e)(d or e)(k,)</sc></monospace></sc>) and seven for TEV (<sc><monospace><sc>(e)()()(y)()(q,)(g or s)</sc></monospace></sc>). As mentioned in the documentation of PeptideCutter, it does not take into account positions P5 and later, leading to implemented definitions shorter than theoretical ones. RPG, on the contrary, implements the full definitions.</p>
      <p>Because RPG gives the opportunity to easily add new proteases, those three proteases were added in the local RPG installation and are represented in Table <xref rid="tbl2" ref-type="table">2</xref> as Asp-N-pepc, enterokinase-pepc and TEV-pepc. Those results are strictly identical to peptidCutter results.</p>
      <p>The last entry of Table <xref rid="tbl2" ref-type="table">2</xref>, namely Arg-C-LysN-BNPS, is the digestion of Titin by three proteases: Arg-C, Lys-N and BNPS-Skatole. PeptideCutter performs this operation as if all proteases cleave together simultaneously. This corresponds to RPG's concurrent mode. Results are identical for a total of 5163 peptides.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Real case studies</title>
      <p>RPG was used on two protein families: Actins and Globins. The Representative Proteome (RP15) of Actins and Globins were retrieved from Pfam (<xref rid="B15" ref-type="bibr">15</xref>) (id: PF00022 and PF00042). Actin dataset is composed of 5704 sequences for a total of 1 545 777 residues. Globin dataset is composed of 1678 sequences for a total of 161 696 residues.</p>
      <p>On these datasets, RPG was used with two different sets of proteases. The results were then analyzed to determine the proportion of generated peptides for each set having a suitable molecular weight for tandem mass spectrometry analysis (600–5000 Da).</p>
      <p>The first set (set A, in blue on Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref>) is composed of the three proteases Bromelain, Chymotrypsin-low and Thermolysin, used sequentially. The second set (set B, in orange on Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref>) is composed of the three proteases CNBr, Lys-N and Papain, used sequentially.</p>
      <fig id="F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Number of generated peptides by proteases set A (Bromelain, Chymotrypsin-low and Thermolysin) and proteases set B (CNBr, Lys-N and Papain) in the optimal peptide size range (600–5000 Da) for the Actin protein family. Set A is more appropriate to obtain peptides in the analyzed range.</p>
        </caption>
        <graphic xlink:href="lqz004fig1"/>
      </fig>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Number of generated peptides by proteases set A (Bromelain, Chymotrypsin-low and Thermolysin) and proteases set B (CNBr, Lys-N and Papain) in the optimal peptide size range (600–5000 Da) for the Globin protein family. Set B is more appropriate to obtain peptides in the analyzed range.</p>
        </caption>
        <graphic xlink:href="lqz004fig2"/>
      </fig>
      <sec id="SEC3-2-1">
        <title>Actin family</title>
        <p>Set A generates 1 037 886 peptides on Actin RP15 (total of 4 637 331 residues: three proteases, three times each sequence). Among these peptides, 302 694 have a molecular mass between 600 and 5000 Da (29.16%), see Figure <xref ref-type="fig" rid="F1">1</xref>. These peptides are composed of 2 846 676 residues (61.39% of the total number of residues).</p>
        <p>Set B generates 187 796 peptides (total of 4 637 331 residues). Among these peptides, 125 419 have a molecular mass between 600 and 5000 Da (66.78%). These peptides are composed of 2 422 798 residues (52.25% of the total number of residues).</p>
        <p>Interestingly, set A generates many short peptides: 70.82% have a molecular weight inferior to 600 Da. Nevertheless, these peptides contain only 38.42% of the total number of residues and the vast majority of the generated residues are inside the desired molecular weight range. On the contrary, set B generates bigger peptides: 15.32% are actually too heavy, accounting for 45.78% of the total number of residues. Even if the majority of peptides generated by set B lies in the desired range, less residues are actually involved as compared to set A, with a difference of more than 400 000 residues. Compared to set B, the combination of Bromelain, Chymotrypsin-low and Thermolysin is more appropriate to properly digest proteins of the Actin family, in order to perform MS/MS analysis.</p>
      </sec>
      <sec id="SEC3-2-2">
        <title>Globin family</title>
        <p>Set A generates 129 616 peptides on Globin RP15 (total of 485 088 residues). Among these peptides, 30 990 have a molecular mass between 600 and 5000 Da (23.91%), see Figure <xref ref-type="fig" rid="F2">2</xref>. These peptides are composed of 261 524 residues (53.91% of the total number of residues).</p>
        <p>Set B generates 27 725 peptides (total of 485 088 residues). Among these peptides, 19 185 have a molecular mass between 600 and 5000 Da (69.2%). These peptides are composed of 325 476 residues (67.1% of the total number of residues).</p>
        <p>Similarly to the case of Actins, set A generates many short peptides (76.09%). Set B also leads to bigger peptides, but for the Globins the big majority of generated peptides (69.2%) are in the desired range and correspond to 67.1% of the total number of residues. Compared to set A, the combination of CNBr, Lys-N and Papain is more appropriate to properly digest proteins of the Globin family, in order to perform MS/MS analysis.</p>
      </sec>
      <sec id="SEC3-2-3">
        <title>Other combination</title>
        <p>Another combination of proteases (Chymotrypsin-high/Ficin/Trypsin) leads to better results for both Actins and Globins. For Actins, it leads to 275 647 desired peptides among the 434 452 generated (63.45%), which represent 4 000 384 of the 4 637 331 total residues (86.26%). For Globins, 30 740 peptides among the 51 893 generated (63.45%) are desired, representing 407 299 of the 485 088 total residues (83.96%).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>The recent increase of interest in proteases, linked to advancements in mass spectrometry techniques, can be enhanced by software tools. In ‘bottom-up’ analysis, protein digestions are required. <italic>In silico</italic> digestions are a quick and inexpensive way of selecting proteases for a particular class of proteins. To be efficient, <italic>in silico</italic> digestion must be realistic, accurate and easily adapted to user’s proteases. In the following, contributions of RPG are discussed, in terms of functionalities and results.</p>
    <sec id="SEC4-1">
      <title>Digestion modes</title>
      <p>RPG introduces two distinct digestion modes. The first one (sequential) simulates distinct digestions with different proteases. Each selected protease cleaves independently and produces distinct results. This mechanism is, in terms of results, identical to running <italic>N</italic> times RPG, <italic>N</italic> being the number of different proteases. This first digestion mode simplifies operations and speeds up the process of obtaining results for <italic>N</italic> distinct proteases. The second digestion mode (concurrent) also takes several proteases but simulates the behavior of those proteases as if they were all digesting at the same time, for an infinite time. The particularity of this digestion mode is the ability for one protease to access a cleavage site that it normally not available. This happens when a protease cleaves a protein and the resulting peptides are then cleaved by another protease that would not have been able to cleave the original protein. For example, a protease cleaving before <sc>p</sc> (P1’), if this amino acid is not followed by <sc>k</sc> in P2’, will not be able to cleave a pattern <sc>xxpkxx</sc> where <sc>x</sc> represents any amino acid. In concurrent mode, the user can mix this protease with Lys-N, which cleaves before <sc>k</sc> (P1’). Lys-N will then cleave the pattern, leading to two peptides: <sc>xxp</sc> and <sc>kxx</sc>. The first protease can then access the <sc>p</sc> and will cleave the first peptide, leading to a global result of three peptides: <sc>xx</sc>, <sc>p</sc> and <sc>kxx</sc>. While this example is trivial, some combinations of proteases can lead to behaviors that are difficult to assess without a proper simulation. The concurrent mode of RPG is useful to analyze these situations.</p>
    </sec>
    <sec id="SEC4-2">
      <title>Accuracy of molecular weight and isoelectric point</title>
      <p>Molecular weight and isoelectric point are two important measures to assess the behavior of a mass spectrometry pipeline. RPG gives accurate estimations of these two measures.</p>
      <p>Molecular weight is critical for mass spectrometry analysis, since the composition of studied proteins is estimated based on this weight. Hence, it is important for <italic>in silico</italic> digestion to perform a good approximation of the peptide’s weight. RPG delivers a precision of four digits. Note that the computation of mass is based on the average masses of the amino acids.</p>
      <p>Similarly, the computation of isoelectric point is of great importance. Before the mass spectrometry analysis, peptides are separated into fractions, using for example chromatography. This separation is usually based on isoelectric point and fractions allow to reduce mass spectrometry analysis complexity. An accurate estimation of pI is then necessary to properly simulate <italic>in silico</italic> digestion for purposes of mass spectrometry analysis. RPG delivers a good estimation of pI, based on previous works.</p>
    </sec>
    <sec id="SEC4-3">
      <title>Designing new proteases with RPG grammar</title>
      <p>The grammar of RPG gives the user the possibility to use the <sc>and</sc> operator (see <bold>Basic core of the grammar</bold>), the <sc>or</sc> operator (see <bold>The</bold><sc><bold>or</bold></sc><bold>keyword and parenthesis</bold>) and the <sc>not</sc> operator (see <bold>Exceptions</bold>). The combination of these three operators offers the possibility to the user to easily define any kind of complex protease.</p>
      <p>One complex example is trypsin. According to PeptideCutter (<xref rid="B4" ref-type="bibr">4</xref>), trypsin preferentially cleaves at <sc>k</sc> and <sc>r</sc> in position P1. This is expressed in RPG grammar as <sc><monospace>(k or r,)</monospace></sc>. <sc>p</sc> usually blocks the action when found in position P1’ (exception <sc><monospace>(k or r,)(p)</monospace></sc>), but not when <sc>k</sc> is in position P1 and <sc>w</sc> is in position P2 at the same time (rule <sc><monospace>(w)(k,)(p)</monospace></sc>). This blocking of cleavage due to <sc>p</sc> in position P1’ is also negligible when <sc>r</sc> is in position P1 and <sc>m</sc> is in position P2 at the same time (rule <sc><monospace>(m)(r,)(p)</monospace></sc>). Furthermore, if <sc>k</sc> is found in position P1, the following situations considerably block the action of trypsin:</p>
      <p>- Either <sc>d</sc> in position P2 and <sc>d</sc> in position P1’ (exception <sc><monospace><sc>(d)(k,)(d)</sc></monospace></sc>)</p>
      <p>- <sc>c</sc> in position P2 and <sc>d</sc> in position P1’ (exception <sc><monospace><sc>(c)(k,)(d)</sc></monospace></sc>)</p>
      <p>- <sc>c</sc> in position P2 and <sc>h</sc> in position P1’ (exception <sc><monospace><sc>(c)(k,)(h)</sc></monospace></sc>)</p>
      <p>- <sc>c</sc> in position P2 and <sc>y</sc> in position P1’ (exception <sc><monospace><sc>(c)(k,)(y)</sc></monospace></sc>)</p>
      <p>Likewise, if <sc>r</sc> is found in P1, the following situations considerably block the action of trypsin:</p>
      <p>- Either <sc>r</sc> in position P2 and <sc>h</sc> in position P1’ (exception <sc><monospace><sc>(r)(r,)(h)</sc></monospace></sc>)</p>
      <p>- <sc>c</sc> in position P2 and <sc>k</sc> in position P1’ (exception <sc><monospace><sc>(c)(r,)(k)</sc></monospace></sc>)</p>
      <p>- <sc>r</sc> in position P2 and <sc>r</sc> in position P1’ (exception <sc><monospace><sc>(r)(r,)(r)</sc></monospace></sc>).</p>
      <p>Trypsin can be defined in RPG grammar using the following rules and exceptions:</p>
      <p>Rules:</p>
      <p>
        <sc>
          <monospace>
            <sc>(k,)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(r,)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(w)(k,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(m)(r,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>Exceptions:</p>
      <p>
        <sc>
          <monospace>
            <sc>(k,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(r,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(d)(k,)(d)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(k,)(d)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(k,)(h)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(k,)(y)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(r)(r,)(h)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(r,)(k)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(r)(r,)(r)</sc>
          </monospace>
        </sc>
      </p>
      <p>Note that several rules and exceptions can be merged using the <sc><monospace>or</monospace></sc> keyword leading to this more compact definition:</p>
      <p>Rules:</p>
      <p>
        <sc>
          <monospace>
            <sc>(k or r,)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(w)(k,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(m)(r,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>Exceptions:</p>
      <p>
        <sc>
          <monospace>
            <sc>(k or r,)(p)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(d)(k,)(d)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(k,)(d or h or y)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(r)(r,)(h or r)</sc>
          </monospace>
        </sc>
      </p>
      <p>
        <sc>
          <monospace>
            <sc>(c)(r,)(k)</sc>
          </monospace>
        </sc>
      </p>
      <p>Other definitions of trypsin are possible using this grammar: each of these will produce the exact same result in RPG. By abstracting the programming side of new protease creation, the user can focus on the formal definition of the protease: creating new proteases is then accessible to anyone and does not require any particular programming skills.</p>
    </sec>
    <sec id="SEC4-4">
      <title>Comparison with existing programs</title>
      <p>Few software exist that predict cleavage sites of proteases. Among those, the most commonly used are PeptideCutter and MaxQuant. The latter does not allow to directly digest fasta files. Moreover, while the user can design new proteases, the definition in MaxQuant only concerns the cleavage zone. Therefore, many proteases cannot be properly define.</p>
      <p>PeptideCutter does not allow to define new proteases. The already defined proteases were thoroughly tested using RPG. All but three proteases of PeptideCutter are identically defined in RPG. The last three were defined in the local installation of RPG using the internal grammar. Despite a completely different way of expressing and defining proteases, all results of RPG are strictly identical to peptidCutter, with a better accuracy on the calculation of the molecular weight. The grammar approach of RPG can perfectly reproduce the behavior of proteases of PeptideCutter, and allows users to easily define new proteases.</p>
    </sec>
    <sec id="SEC4-5">
      <title>The choice of proteases</title>
      <p>From the results in <bold>Real case studies</bold>, it appears that the choice of proteases is not trivial. The same combination of proteases can lead to different results depending on the nature of analyzed proteins. Here, the Actin and Globin families reveal different behaviors on two different sets of proteases. One set leads to better results for Actins, the second one for Globins. A third set leads to even better results for both families. This highlights that the digestion step of MS/MS analyses should be handled with care and should be adapted to the targeted proteins. To the best of my knowledge, there is currently no methodology nor software dedicated to this task. In the growing field of new proteases development, an ideal software should: (i) be customizable to fit user-already-acquired proteases, (ii) allow the user to employ the exact definition given by the producers, contrary to general definitions that may vary and (iii) be able to identify the optimal combination of proteases to be used for a specific set of proteins. RPG meets the first two needs.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC5">
    <title>CONCLUSION</title>
    <p>RPG is a new software dedicated to predict protease-induced cleavage sites. The main novelty of RPG is that it provides the user with the ability to define new proteases, hence to not be limited by RPG’s predefined proteases. To define proteases, RPG proposes an innovating yet simple grammar. This grammar uses <sc>and</sc>, <sc>or</sc> and <sc>not</sc> operators giving to the user the possibility to easily define any kind of complex proteases and yet does not require any particular programming skills. Apart from peptides, the result of a digestion includes approximations of molecular weight and isoelectric point, computed with a better accuracy than other existing software. RPG also includes two distinct digestion modes: these modes can simulate either independent digestion experiments or a single experiment of concurrent digestions by several proteases. Another advantage of RPG is that it allows the user to run all-at-once independent digestions of many proteins. Moreover, miscleavage events are taken into account in RPG. This information is of great relevance to simulate certain experimental conditions. Finally, RPG runs more than seven times faster than PeptideCutter on a single protein. Because RPG can digest multiple proteins with multiple proteases in a single run, it outperforms PeptideCutter in terms of execution time, ease of use, accuracy and functionality.</p>
    <p>While it is beyond the scope of this article, there are two natural improvements of RPG. The first will be the creation of a dedicated website to make RPG easier to use than the current command-line program. Also, a well-conceived web interface could help the user to define new proteases. This interface could show on-the-fly the configuration of a cleaving site while rules and exceptions are inputed. A second improvement will be to automatically compute which combination of proteases leads to the best result on inputed proteins. This improvement necessitates to define what the ‘best’ result is, taking into account the number of generated peptides in a certain mass range, but also the number of the amino acids that compose those peptides. It will also require a consequent combinatorial optimization. Trying naively all possible combinations of <italic>N</italic> proteases requires 2<sup><italic>n</italic></sup> − 1 operations: with <italic>n</italic> = 42 (number of available proteases by default in RPG), this leads to approximately 4.4*10<sup>12</sup> operations and does not scale up. RPG was developed with adaptability in mind and these possible evolutions will not require to re-write its core.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>This work used the computational and storage services (TARS cluster) provided by the IT department at Institut Pasteur, Paris. The author would like to thank Paraskevi Gkeka and Gael Millot for constructive criticism of the manuscript.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Neurath</surname><given-names>H.</given-names></name></person-group><article-title>Proteolytic enzymes, past and future</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>1999</year>; <volume>96</volume>:<fpage>10962</fpage>–<lpage>10963</lpage>.<pub-id pub-id-type="pmid">10500108</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nesvizhskii</surname><given-names>A.I.</given-names></name></person-group><article-title>Proteogenomics: concepts, applications and computational strategies</article-title>. <source>Nat. Methods</source>. <year>2014</year>; <volume>11</volume>:<fpage>1114</fpage>–<lpage>1125</lpage>.<pub-id pub-id-type="pmid">25357241</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Engel</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Saveliev</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Urh</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Simpson</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Wood</surname><given-names>K.</given-names></name></person-group><article-title>Using Endoproteinases Asp-N and Glu-C to Improve Protein Characterization</article-title>. <source>Promega Corporation Web site</source>. <year>2019</year>; <uri xlink:href="https://www.france.promega.com/resources/pubhub/using-endoproteinases-asp-n-and-glu-c-to-improve-protein-characterization/">https://france.promega.com/resources/pubhub/using-endoproteinases-asp-n-and-glu-c-to-improve-protein-characterization/</uri>.</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gasteiger</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Hoogland</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Gattiker</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Duvaud</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Wilkins</surname><given-names>M.R.</given-names></name>, <name name-style="western"><surname>Appel</surname><given-names>R.D.</given-names></name>, <name name-style="western"><surname>Bairoch</surname><given-names>A.</given-names></name></person-group><person-group person-group-type="editor"><name name-style="western"><surname>Walker</surname><given-names>JM</given-names></name></person-group><article-title>Protein Identification and Analysis Tools on the ExPASy Server</article-title>. <source>The Proteomics Protocols Handbook</source>. <year>2005</year>; <publisher-name>Humana Press</publisher-name><fpage>571</fpage>–<lpage>607</lpage>.</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cox</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Mann</surname><given-names>M.</given-names></name></person-group><article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>. <source>Nat. Biotechnol.</source><year>2008</year>; <volume>26</volume>:<fpage>1367</fpage>–<lpage>1372</lpage>.<pub-id pub-id-type="pmid">19029910</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Keil</surname><given-names>B.</given-names></name></person-group><source>Specificity of Proteolysis</source>. <year>1992</year>; <publisher-loc>Berlin</publisher-loc><publisher-name>Springer-Verlag Berlin Heidelberg</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kozlowski</surname><given-names>L.P.</given-names></name></person-group><article-title>IPC – Isoelectric Point Calculator</article-title>. <source>Biol. Direct</source>. <year>2016</year>; <volume>11</volume>:<fpage>55</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">27769290</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schechter</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>A.</given-names></name></person-group><article-title>On the size of the active site in proteases. I. Papain</article-title>. <source>Biochem. Biophys. Res. Commun.</source><year>1967</year>; <volume>2</volume>:<fpage>157</fpage>–<lpage>162</lpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Henry</surname><given-names>N.P.</given-names></name>, <name name-style="western"><surname>Senozan</surname><given-names>N.M.</given-names></name></person-group><article-title>The Henderson-Hasselbalch equation: its history and limitations</article-title>. <source>J. Chem. Educ.</source><year>2001</year>; <volume>78</volume>:<fpage>1499</fpage>–<lpage>1504</lpage>.</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Berg</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Tymoczko</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Stryer</surname><given-names>L.</given-names></name></person-group><source>Biochemistry 7th edn</source>. <year>2011</year>; <publisher-loc>NY</publisher-loc><publisher-name>Freeman &amp; Company, W. H</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chiva</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Ortega</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Sabid</surname><given-names>E.</given-names></name></person-group><article-title>Influence of the Digestion Technique, Protease, and Missed Cleavage Peptides in Protein Quantitation</article-title>. <source>J. Proteome Res.</source><year>2014</year>; <volume>13</volume>:<fpage>3979</fpage>–<lpage>3986</lpage>.<pub-id pub-id-type="pmid">24986539</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Opitz</surname><given-names>C.A.</given-names></name>, <name name-style="western"><surname>Kulke</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Leake</surname><given-names>M.C.</given-names></name>, <name name-style="western"><surname>Neagoe</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Hinssen</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Hajjar</surname><given-names>R.J.</given-names></name>, <name name-style="western"><surname>Linke</surname><given-names>W.A.</given-names></name></person-group><article-title>Damped elastic recoil of the Titin spring in of human myocardium</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2013</year>; <volume>22</volume>:<fpage>12688</fpage>–<lpage>12693</lpage>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ingrosso</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Fowler</surname><given-names>A.V.</given-names></name>, <name name-style="western"><surname>Bleibaum</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Clarke</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Mann</surname><given-names>M.</given-names></name></person-group><article-title>Specificity of endoproteinase Asp-N (Pseudomonas fragi): cleavage at glutamyl residues in two proteins</article-title>. <source>Biochem. Biophys. Res. Commun.</source><year>1989</year>; <volume>162</volume>:<fpage>1528</fpage>–<lpage>1534</lpage>.<pub-id pub-id-type="pmid">2669754</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drapeau</surname><given-names>G.R.</given-names></name></person-group><article-title>Substrate specificity of a proteolytic enzyme isolated from a mutant of Pseudomonase fragi</article-title>. <source>J. Biol. Chem.</source><year>1980</year>; <volume>255</volume>:<fpage>839</fpage>–<lpage>840</lpage>.<pub-id pub-id-type="pmid">7188696</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>El-Gebali</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Bateman</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Luciani</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Potter</surname><given-names>S.C.</given-names></name>, <name name-style="western"><surname>Qureshi</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Richardson</surname><given-names>L.J.</given-names></name>, <name name-style="western"><surname>Salazar</surname><given-names>G.A.</given-names></name>, <name name-style="western"><surname>Smart</surname><given-names>A.</given-names></name><etal>et al</etal>.</person-group><article-title>The Pfam protein families database in 2019</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>427</fpage>–<lpage>432</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
