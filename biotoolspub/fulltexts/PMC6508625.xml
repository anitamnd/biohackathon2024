<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6508625</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-04788</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0216471</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Metadata</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>DNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>DNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Nanotechnology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Science and Technology Workforce</subject>
          <subj-group>
            <subject>Careers in Research</subject>
            <subj-group>
              <subject>Scientists</subject>
              <subj-group>
                <subject>Biologists</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>People and Places</subject>
        <subj-group>
          <subject>Population Groupings</subject>
          <subj-group>
            <subject>Professions</subject>
            <subj-group>
              <subject>Scientists</subject>
              <subj-group>
                <subject>Biologists</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Biotechnology</subject>
            <subj-group>
              <subject>Bionanotechnology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Biotechnology</subject>
            <subj-group>
              <subject>Bionanotechnology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Nanotechnology</subject>
          <subj-group>
            <subject>Bionanotechnology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognitive Psychology</subject>
              <subj-group>
                <subject>Language</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Cognitive Psychology</subject>
            <subj-group>
              <subject>Language</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Cognitive Psychology</subject>
            <subj-group>
              <subject>Language</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NanoR: A user-friendly R package to analyze and compare nanopore sequencing data</article-title>
      <alt-title alt-title-type="running-head">NanoR: An R package to analyze nanopore sequencing data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8735-8093</contrib-id>
        <name>
          <surname>Bolognini</surname>
          <given-names>Davide</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Bartalucci</surname>
          <given-names>Niccolò</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mingrino</surname>
          <given-names>Alessandra</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vannucchi</surname>
          <given-names>Alessandro Maria</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Magi</surname>
          <given-names>Alberto</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Experimental and Clinical Medicine, University of Florence, Largo Brambilla 3, Florence, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Benos</surname>
          <given-names>Panayiotis V.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Pittsburgh, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>davidebolognini7@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>5</issue>
    <elocation-id>e0216471</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Bolognini et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Bolognini et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0216471.pdf"/>
    <abstract>
      <p>MinION and GridION X5 from Oxford Nanopore Technologies are devices for real-time DNA and RNA sequencing. On the one hand, MinION is the only real-time, low cost and portable sequencing device and, thanks to its unique properties, is becoming more and more popular among biologists; on the other, GridION X5, mainly for its costs, is less widespread but highly suitable for researchers with large sequencing projects. Despite the fact that Oxford Nanopore Technologies’ devices have been increasingly used in the last few years, there is a lack of high-performing and user-friendly tools to handle the data outputted by both MinION and GridION X5 platforms. Here we present NanoR, a cross-platform R package designed with the purpose to simplify and improve nanopore data visualization. Indeed, NanoR is built on few functions but overcomes the capabilities of existing tools to extract meaningful informations from MinION sequencing data; in addition, as exclusive features, NanoR can deal with GridION X5 sequencing outputs and allows comparison of both MinION and GridION X5 sequencing data in one command. NanoR is released as free package for R at <ext-link ext-link-type="uri" xlink:href="https://github.com/davidebolo1993/NanoR">https://github.com/davidebolo1993/NanoR</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003196</institution-id>
            <institution>Ministero della Salute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GR-2011-02352026</award-id>
        <principal-award-recipient>
          <name>
            <surname>Magi</surname>
            <given-names>Alberto</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100005010</institution-id>
            <institution>Associazione Italiana per la Ricerca sul Cancro</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Investigator Grant 20307</award-id>
        <principal-award-recipient>
          <name>
            <surname>Magi</surname>
            <given-names>Alberto</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Alberto Magi has been supported by Ministero della Salute (GR-2011-02352026 to AM), and by Associazione Italiana per la Ricera sul Cancro (Investigator Grant 20307 to AM). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <page-count count="12"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Software: <ext-link ext-link-type="uri" xlink:href="https://github.com/davidebolo1993/NanoR">https://github.com/davidebolo1993/NanoR</ext-link>. Data: <ext-link ext-link-type="uri" xlink:href="https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=">https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Software: <ext-link ext-link-type="uri" xlink:href="https://github.com/davidebolo1993/NanoR">https://github.com/davidebolo1993/NanoR</ext-link>. Data: <ext-link ext-link-type="uri" xlink:href="https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=">https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>During the last decade, second-generation sequencing technologies have definitely improved our ability to detect genetic variants in any organism. However, the short reads (100-500 base pairs) generated by these platforms do not allow to detect complex structural variants such as copy number variations [<xref rid="pone.0216471.ref001" ref-type="bibr">1</xref>]. In the last few years, third-generation sequencing (TGS) technologies have risen to prominence; Oxford Nanopore Technologies (ONT) and Pacific Biosciences [<xref rid="pone.0216471.ref002" ref-type="bibr">2</xref>] allow single-molecule and long-read sequencing with different strategies: while Pacific Biosciences uses a single-molecule real-time approach, ONT’s devices (MinION, GridION X5 and PromethION) analyze the transit of each DNA molecule through a nanoscopic pore and measure its effect on an electric current.</p>
    <p>Among ONT’s devices, MinION and GridION X5 are noteworthies.</p>
    <p>MinION is the only low-cost (commercially available by paying a starter-pack fee of $1,000), portable (∼ 10 cm in length and weighs under 100 g) and real-time DNA and RNA sequencer: each MinION Flow Cell, which contains the proprietary sensor array Application-Specific Integrated Circuit (ASIC) and 2048 R9.4 (for sequencing kits 1D) or R9.5 (for sequencing kits 1D<sup>2</sup>) nanopores arranged in 512 channels, is capable to generate 10–20 Gb of DNA sequence data over a 48 hours sequencing run [<xref rid="pone.0216471.ref003" ref-type="bibr">3</xref>]. For its unique properties, from the launch of MinION Access Programme (April 2014), MinION has become increasingly popular among biologists.</p>
    <p>Although it is definitely more expensive (∼$50,000.00), GridION X5 fills the gap between MinION and ONT’s top-of-the-range PromethION. Indeed, GridION X5 is a small benchtop sequencer that allows to use up to five MinION Flow Cells at the same time; as result, GridION X5 drastically increases the ouput of a single MinION experiment to more than 100 Gb of DNA sequence data over a 48 hours sequencing run, making this instrument suitable for researchers with broader scope projects.</p>
    <p>While library preparation is fast and easy when working with ONT’s devices, the biggest problem researchers have to face when dealing with these TGS technologies is certainly the analysis of their outputs.</p>
    <p>The main output of ONT platforms are binary <italic>hdf5</italic> files [<xref rid="pone.0216471.ref004" ref-type="bibr">4</xref>] organized in a hierarchical structure with groups, datasets and attributes and stored using the .<italic>fast5</italic> extension. After MinION release 18.12 and GridION X5 release 18.12.1, .<italic>fast5</italic> files generated by this platforms are basecalled using the GPU-enhanced basecaller Guppy, which is more than an order of magnitude faster than previous CPU-based basecalling softwares, and stored into passed and failed folders according to their quality: passed .<italic>fast5</italic> files have mean quality ≥ 7 while failed .<italic>fast5</italic> files have quality &lt; 7. Moreover, even if MinION and GridION X5 produce by default a single .<italic>fast5</italic> file per read (single-read .<italic>fast5</italic> files), since ONT sequencing experiments frequently generate millions of reads, a new multi-read .<italic>fast5</italic> files format has been introduced, which is more practical for data transfer and data querying considerations. For each sequencing experiment, in addition, a sequencing summary .<italic>txt</italic> file and .<italic>fastq</italic> files, splitted into passed .<italic>fastq</italic> files and failed .<italic>fastq</italic> files according to the aforementioned quality creteria, are generated.</p>
    <p>As for the other next-generation sequencing platforms, data generated by ONT’s devices must be rapidly assessed in order to determine how useful the data may be in making biological discoveries as higher the quality of data is, more confident the conclusions are.</p>
    <p>In the past years a number of tools designed specifically for MinION single-read .<italic>fast5</italic> files visualization became available, including poretools [<xref rid="pone.0216471.ref005" ref-type="bibr">5</xref>], poRe [<xref rid="pone.0216471.ref006" ref-type="bibr">6</xref>] and HPG pore [<xref rid="pone.0216471.ref007" ref-type="bibr">7</xref>].</p>
    <p>Poretools was the first tool released for MinION data analysis and it implements several functions to compute statistics and extract key informations (<italic>i.e</italic>. metadata) both from entire .<italic>fast5</italic> files datasets and single .<italic>fast5</italic> files; however, most of poretools’ functions designed to return an overview of the sequencing experiment need to be run on the entire .<italic>fast5</italic> file dataset, which basically means reading the same dataset multiple times to extract different informations, causing a waste of time when the user need to call multiple functions. Poretools implements also a function to return a metadata table from a dataset of .<italic>fast5</italic> files in a single run, but does not provide any function to compute/plot statistics from this table.</p>
    <p>PoRe shares most of poretools’ features and in 2017 a GUI for parallel and real-time extraction of metadata from MinION reads has been released [<xref rid="pone.0216471.ref008" ref-type="bibr">8</xref>]: by using multiple cores, the GUI version makes it faster to extract informations from .<italic>fast5</italic> files but, again, its downstream statistical analysis is extremely limited.</p>
    <p>HPG pore, at last, features the capability to extract metadata from .<italic>fast5</italic> files and plot some statistics by parallelizing the job inside an Hadoop distributed file system, which lets you store and handle massive amount of data on a cloud of machines: for this reasons, HPG pore’s true potentiality can be exploited only in a Hadoop cluster. In addition, HPG pore can only be run on Linux machines.</p>
    <p>Taking all this into account, we developed NanoR, an up-to-date package for the cross-platform statistical language and environment R [<xref rid="pone.0216471.ref009" ref-type="bibr">9</xref>], which is growing more and more popular with researchers, to analyze and compare both MinION and GridION X5 1D sequencing data. Our package, which has been tested on all the three main computer operating systems (Linux, MacOSX and Windows), is designed to be extremely easy to use and allows users to retrive a complete overview of their sequencing runs within acceptable time frames, offering the possibility to parallelize the extraction of metadata from .<italic>fast5</italic> files, which is the most time-consuming step of the analysis process.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>NanoR is built on 4 main functions:</p>
    <list list-type="bullet">
      <list-item>
        <p><italic>NanoPrepare()</italic>: prepares MinION/GridION X5 data for the following analyses</p>
      </list-item>
      <list-item>
        <p><italic>NanoTable()</italic>: generates a table that contains metadata for every sequenced read</p>
      </list-item>
      <list-item>
        <p><italic>NanoStats()</italic>: plots statistics for the sequencing run</p>
      </list-item>
      <list-item>
        <p><italic>NanoFastq()</italic>: extract/filter .<italic>fastq</italic> sequences from MinION/GridION X5 data</p>
      </list-item>
    </list>
    <p>Each of these functions exists both in a “M” version and in a “G” version (<italic>e.g</italic>. for <italic>NanoPrepare()</italic> exists both the <italic>NanoPrepareM()</italic> and the <italic>NanoPrepareG()</italic> version). This identifiers refer to the original behaviour of MinION and GridION X5. Indeed, on the one hand, MinION originally outputted only basecalled .<italic>fast5</italic> files from which metadata could be extracted in order to generate an overview of the sequencing run; on the other, GridION X5 outputted .<italic>fast5</italic> files without basecalling informations added, causing the need to use the simultaneosuly generated sequencing summary files to get a thorough analysis of the experimental run. After MinION release 18.12 and GridION X5 release 18.12.1, the format of the data generated by the aforementioned platforms have been standardized. Using the “M”/“G” notation, NanoR offers the possibility to choose if the analysis will be done starting from basecalled .<italic>fast5</italic> files (“M” version) or from sequencing summaries and .<italic>fastq</italic> files (“G” version). Backward compatibility with previous MinION and GridION X5 releases is also guaranteed. In addition, we provide <italic>NanoCompare()</italic> to allow a quick comparison of MinION and GridION X5 analyzed data. Below are described two possible workflows (also summarized in <xref ref-type="fig" rid="pone.0216471.g001">Fig 1</xref>) for users wishing to analyze their MinION or GridION X5 data with NanoR.</p>
    <fig id="pone.0216471.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>NanoR workflow.</title>
        <p>NanoR can work with both basecalled .<italic>fast5</italic> files and sequencing summary/.<italic>fastq</italic> files. Users have to rely on <italic>NanoFastqM()</italic> to direclty extract .<italic>fastq</italic> sequences from basecalled .<italic>fast5</italic> files and on <italic>NanoFastqG()</italic> to filter .<italic>fastq</italic> files. <italic>NanoPrepare()</italic> functions, as well as <italic>NanoTable()</italic> and <italic>NanoStats()</italic> can be used one after another to generate a complete overview for the sequencing run, starting from basecalled .<italic>fast5</italic> files (“M” version) or from sequencing summary and .<italic>fastq</italic> files (“G” version). <italic>NanoCompare()</italic>, at last, allows one-command comparison of MinION/GridION X5 analyzed sequencing experiments.</p>
      </caption>
      <graphic xlink:href="pone.0216471.g001"/>
    </fig>
    <sec id="sec003">
      <title>Basecalled .<italic>fast5</italic> files analysis</title>
      <p>ONT’s MinION and GridION X5 output Guppy-basecalled .<italic>fast5</italic> files, which optionally can be stored into multi-read .<italic>fast5</italic> files, from which key informations on the sequencing experiment can be retrived. The “M” version of NanoR can be used for this purpose.</p>
      <sec id="sec004">
        <title>Data preparation</title>
        <p>In order to prepare MinION and GridION X5 basecalled .<italic>fast5</italic> files for further analyses, we provide <italic>NanoPrepareM()</italic>: <italic>NanoPrepareM()</italic> organizes the input files so that they can be easily accessed by other “M” functions from this package. The user must provide to <italic>NanoPrepareM()</italic> the path to passed basecalled .<italic>fast5</italic> reads and a label that will be used to identify the experiment, while the path to failed .<italic>fast5</italic> reads is optional. By default, basecalled .<italic>fast5</italic> files given as input are considered single-read but multi-read .<italic>fast5</italic> files are also supported after switching to <italic>TRUE</italic> the <italic>MultiRead</italic> parameter of this function. <italic>NanoPrepareM()</italic> returns an object of class list required by other functions from this package.</p>
      </sec>
      <sec id="sec005">
        <title>Extraction of .<italic>fastq</italic> and .<italic>fasta</italic> files</title>
        <p>As explained in the <italic>Introduction</italic> section of this article, MinION and GridION X5 generate .<italic>fastq</italic> files for both passed and failed reads using a quality treshold of 7 (sequences with quality ≥ 7 are considered passed, the others are considered failed). NanoR offers the possibility to extract .<italic>fastq</italic> sequences directly from passed basecalled .<italic>fast5</italic> files using a user-defined treshold (which is meant to be higher then the default one) and, optionally, to convert them to .<italic>fasta</italic> by using <italic>NanoFastqM()</italic>. The .<italic>fastq</italic> extraction process can be accellerated using multiple cores.</p>
      </sec>
      <sec id="sec006">
        <title>Extraction of .<italic>fast5</italic> files metadata</title>
        <p>Each basecalled .<italic>fast5</italic> file contains metadata such as the read identifier, the number of both channel and mux that generate the read, its generation time as well as its length and quality score; <italic>NanoTableM()</italic> extracts all these informations from each passed .<italic>fast5</italic> read, optionally calculating its GC content. As metadata extraction from .<italic>fast5</italic> sequences can be slow for large datasets, <italic>NanoTableM()</italic> can be accelerated using multiple cores. Starting from the object of class list returned by <italic>NanoPrepareM()</italic> and a path to a folder inside which the output will be saved, <italic>NanoTableM()</italic> returns a metadata table with 7 columns that describes each passed .<italic>fast5</italic> read.</p>
      </sec>
      <sec id="sec007">
        <title>Plot statistics</title>
        <p><italic>NanoStatsM()</italic> is the main function of the NanoR package for the basecalled .<italic>fast5</italic> files data analysis; the user must provide to <italic>NanoStatsM()</italic> the object of class list returned by <italic>NanoPrepareM()</italic> and the table returned by <italic>NanoTableM()</italic> together with the path to the same folder specified for <italic>NanoTableM()</italic>. Main outputs from <italic>NanoTableM()</italic> are a table containing an overview of the sequencing run (<italic>ShortSummary.txt</italic>), and 5 .<italic>pdf</italic> files representing:</p>
        <list list-type="bullet">
          <list-item>
            <p>plots of cumulative reads and base pairs produced during the experiment</p>
          </list-item>
          <list-item>
            <p>plots of reads number, base pairs number, reads length (min, average and max) and reads quality (min, average and max) calculated every half an hour of experiment (<xref ref-type="fig" rid="pone.0216471.g002">Fig 2</xref>)</p>
          </list-item>
          <list-item>
            <p>plot of read length and read quality compared jointly (<xref ref-type="fig" rid="pone.0216471.g003">Fig 3</xref>)</p>
          </list-item>
          <list-item>
            <p>plots of channels and muxes activity with respect to their real disposition on the MinION flowcell (these plots are useful to diagnose problems in particular areas of the flowcell) (<xref ref-type="fig" rid="pone.0216471.g004">Fig 4</xref>)</p>
          </list-item>
          <list-item>
            <p>plots that summarize number and percentage of passed and failed/skipped .<italic>fast5</italic> reads as well as GC content count (if computed by <italic>NanoTableM()</italic>) calculated for passed ones</p>
          </list-item>
        </list>
        <fig id="pone.0216471.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Reads number, base pairs number, reads length and reads quality per-time bin.</title>
            <p>The plots show the number of reads (<bold>Panel A</bold>) and basepairs (<bold>Panel B</bold>), the maximum, average and minimum length of reads in log<sub>10</sub> scale (<bold>Panel C</bold>) and the maximum, average and minimum quality of reads (<bold>Panel D</bold>), all calculated every 30 minutes of an experimental MinION run.</p>
          </caption>
          <graphic xlink:href="pone.0216471.g002"/>
        </fig>
        <fig id="pone.0216471.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Reads length and reads quality compared jointly.</title>
            <p>The plot shows the correlation between length (x axis) and quality (y axis) for ∼ 100000 MinION reads. The regression line highlights that longer the reads are, higher their quality score is.</p>
          </caption>
          <graphic xlink:href="pone.0216471.g003"/>
        </fig>
        <fig id="pone.0216471.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Heatmap of channels and muxes activity.</title>
            <p>The plots show the base pairs productivity of channels (<bold>Panel A</bold>) and muxes (<bold>Panel B</bold>) with respect to their real disposition on the Flow Cell (as described in <ext-link ext-link-type="uri" xlink:href="https://community.nanoporetech.com/technical_documents/hardware/v/hwtd_5000_v1_revh_03may2016/flow-cell-chip">https://community.nanoporetech.com/technical_documents/hardware/v/hwtd_5000_v1_revh_03may2016/flow-cell-chip</ext-link>) for a MinION run; inactive channels and muxes are grey-colored.</p>
          </caption>
          <graphic xlink:href="pone.0216471.g004"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Sequencing summary and .<italic>fastq</italic> files analysis</title>
      <p>Together with basecalled .<italic>fast5</italic> files, MinION and GridION X5 output a single sequencing summary file which contains metadata that describe each sequenced read. This sequencing summary file can be used, together with .<italic>fastq</italic> files, as input to generate a complete overview for the experimental run. The “G” version of NanoR is built on 4 functions specular to those described for the “M” version. Briefly, <italic>NanoPrepareG()</italic> organizes the sequencing summary and .<italic>fastq</italic> files so that they can be easily accessed by other “G” functions from this package, <italic>NanoTableG()</italic> retain the most useful informations from the sequencing summary file and, optionally, calculates GC contentent for passed .<italic>fastq</italic>; <italic>NanoStatG()</italic> plots statistics and <italic>NanoFastqG()</italic> filters passed .<italic>fastq</italic> files using a user-defined treshold, optionally converting them to .<italic>fasta</italic> as well.</p>
    </sec>
    <sec id="sec009">
      <title>Compare MinION/GridION X5 data</title>
      <p>When dealing with 2 or more MinION/GridION X5 experiments, users may wish to compare their sequencing runs: to this purpose we provide <italic>NanoCompare()</italic>. <italic>NanoCompare()</italic> takes, as inputs, a vector containing the paths to the <italic>DataForComparison</italic> folders generated by <italic>NanoStatsM()</italic>/<italic>NanoStatsG()</italic>, an ordered vector contaning identifiers to name each experiment and the path to the folder in which <italic>NanoCompare()</italic> plots will be saved. <italic>NanoCompare()</italic> returns a .<italic>pdf</italic> file containing violin plots (<xref ref-type="fig" rid="pone.0216471.g005">Fig 5</xref>) that compare reads number, base pairs number, reads length and reads quality for the given experiments.</p>
      <fig id="pone.0216471.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Violin plots for comparison between experiments.</title>
          <p>From top to bottom, the plots show the comparison 3 ONT experiments (first 2 are GridION X5 experiments, producing multi-read and single-read .<italic>fast5</italic> files respectively and last is a MinION experiment producing multi-read .<italic>fast5</italic> files) in terms of reads number, base pairs number, reads mean length and reads mean quality. Comparison is done every 10 hours of experiment using time bins of 30 minutes.</p>
        </caption>
        <graphic xlink:href="pone.0216471.g005"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Discussion</title>
    <p>As described in detail in the previous section, NanoR is based on very few functions (4 for basecalled data analysis, 4 for sequencing summary and .<italic>fastq</italic> files analysis and 1 to compare MinION/GridION X5 experiments), thus being intuitive and easy to use, even for biologists with little knowledge of R language. It also produces meaningful data within acceptable time frames. Indeed, the most time-consuming step when dealing with basecalled .<italic>fast5</italic> files is the metadata extraction. In order to demonstrate how our tool performs compared to other tools that run in the same environment, we compared the user waiting-time when extracting metadata from single-read MinION basecalled .<italic>fast5</italic> files with 3 different R packages: the NanoR package (using <italic>NanoTableM()</italic>, with and without GC content calculation), the poRe package (using <italic>extract.fast5()</italic>, taken from the poRe parallel GUI and used to extract only metadata (<italic>i.e</italic>. the read filename, the channel number, the read number, the read start time, the length of the sequence, the run identifier, the read identifier, the experiment start time and a logical expression indicating whether the read is passed (T) or not (F).) and the IONiseR [<xref rid="pone.0216471.ref010" ref-type="bibr">10</xref>] package (using <italic>readFast5Summary()</italic> and <italic>readInfo()</italic>: combined, these functions from IONiseR return the filename, the number of both channel and mux that generate a certain sequence and its pass/fail status). In particular we randomly sampled increasing number of reads (25000,50000,100000,500000,1000000) from a total of ∼ 2000000 reads taken from 5 different MinION sequencing runs and we calculated the user waiting-time when extracting metadata from them. The aforementioned functions were parallelized with the R “parallel” package using 10 Intel<sup>®</sup>Xeon<sup>®</sup>CPU E5-46100 @ 2.40GHz cores on a 48 cores SUSE Linux Enterprise Server 11.</p>
    <p>For each number of reads analyzed, we repeated the sampling-extraction step 5 times (all the time measures, together with their averages and standard deviations are attached in <xref ref-type="supplementary-material" rid="pone.0216471.s001">S1 File</xref>). Cache was cleaned after each metadata extraction.</p>
    <p><xref ref-type="fig" rid="pone.0216471.g006">Fig 6</xref> shows these results as LOESS curves: as expected, the user waiting-time increases, for all the three packages, when increases the number of the reads analyzed, with IONiseR that turned out to be the slowest and NanoR the fastest, if it doesn’t have to read the .<italic>fastq</italic> information to compute GC content.</p>
    <fig id="pone.0216471.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0216471.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>LOESS curves comparing NanoR (dark blue, light blue), poRe (red) and IONiseR (green) performances when extracting metadata informations from increasing number of .<italic>fast5</italic> reads (25000,50000,100000,500000,1000000) randomly sanpled from ∼ 2000000 reads coming from 5 MinION runs, using 10 Intel<sup>®</sup>Xeon<sup>®</sup>CPU E5-46100 @ 2.40GHz cores.</title>
        <p>Each sampling-extraction step was repeated 5 times. Under the same conditions (<italic>i.e</italic>. without GC content calculation), NanoR is the fastest in extracting metadata informations for all the groups of .<italic>fast5</italic> files considered (<italic>e.g</italic>. NanoR takes approximately 60 minutes to extract metadata from 1000000 .<italic>fast5</italic> files, poRe takes approximately 80 minutes and IONiseR takes over 10 hours) while the extraction of metadata together with GC content computation (light blue line) makes NanoR working slightly slower (it takes approximatley 100 minutes to both extract metadata informations from 1000000 .<italic>fast5</italic> files and calculate their GC content). Data on x and y axes are log<sub>10</sub>-scaled.</p>
      </caption>
      <graphic xlink:href="pone.0216471.g006"/>
    </fig>
    <p>Indeed, <italic>NanoTableM()</italic> function, instead of dumping .<italic>fast5</italic> files, which requires to stream each file entirely, makes use of pointers, which allow direct access to that part of the file structure that contains the required information. This behaviour, also known as “lazy evaluation principle”, allows users to save time when retrieving informations from files with nested architectures, as it avoids to stream the entire file before fetching the desired informations. Moreover, NanoR pre-allocates a portion of computer memory to store informations from each read before the extraction and fills in values as it goes, making it fast to save retrived metadata. We have also assessed the user waiting-time when retrieving metadata from reads of different size, as the length-independent speed of analysis can be an useful feature when dealing with ultra-long reads [<xref rid="pone.0216471.ref011" ref-type="bibr">11</xref>]; in this case, all the three tools perform equally, as there isn’t, as expected, an increase of the user-waiting time when the size of the reads increases (except for NanoR if it had to read the .<italic>fastq</italic> information to compute GC content: in that case, the user-waiting time increases in a length-dependent manner). NanoR has a number of features in common with other tools built to deal with MinION sequencing data such as poRe, IONiseR, poretools and HPG pore. <xref rid="pone.0216471.t001" ref-type="table">Table 1</xref> summarizes NanoR features and compares them to those implemented in the aformentioned tools. As shown in <xref rid="pone.0216471.t001" ref-type="table">Table 1</xref>, NanoR reproduces most of the output generated by the other tools for MinION single-read data analysis, overcoming their limitations. In particular, it extends the statistical analysis carried out by all the other tools (<italic>e.g</italic>., it allows users to check the trend of the sequencing run every 30-minutes (<xref ref-type="fig" rid="pone.0216471.g002">Fig 2</xref>) and to compare reads length and reads quality jointly (<xref ref-type="fig" rid="pone.0216471.g003">Fig 3</xref>) as exclusive features) and is also faster then competitors in the R environment. Moreover, NanoR allows easy parallelization without the need to rely on distributed clusters, as it strictly depends for that on the R base package “parallel”. As other unique features, NanoR is, at the moment, the only tool capable to deal with outputs coming from all MinION and GridION X5 releases and allows quick comparison of MinION/GridION X5 analyzed experiments, making it easy to visualize differences between experimental sequencing runs. An example of application of NanoR on GridION X5 data is shown in <xref ref-type="supplementary-material" rid="pone.0216471.s002">S2 File</xref>.</p>
    <table-wrap id="pone.0216471.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0216471.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison between NanoR, poRe, IONiseR, poretools and HPG pore.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0216471.t001g" xlink:href="pone.0216471.t001"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Feature</th>
              <th align="center" rowspan="1" colspan="1">NanoR</th>
              <th align="center" rowspan="1" colspan="1">poRe</th>
              <th align="center" rowspan="1" colspan="1">IONiseR</th>
              <th align="center" rowspan="1" colspan="1">poretools</th>
              <th align="center" rowspan="1" colspan="1">HPG Pore</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Extract .<italic>fastq</italic> from .<italic>fast5</italic> files<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Extract .<italic>fasta</italic> from .<italic>fast5</italic> files<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Extract metadata from .<italic>fast5</italic> files<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Calculate/plot GC content<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot yield<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot reads and base pairs number per time bin<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot min/mean/max reads quality and length per time bin<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot reads length versus reads quality<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot reads length histograms<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔<xref ref-type="table-fn" rid="t001fn001"><sup>1</sup></xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot reads quality histograms<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔<xref ref-type="table-fn" rid="t001fn002"><sup>2</sup></xref></td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot channels and muxes occupancy<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1">✔<xref ref-type="table-fn" rid="t001fn003"><sup>3</sup></xref></td>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot reads and base pairs number per channel histograms<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">✔</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Plot pass/fail/skip .<italic>fast5</italic> files number and percentage<xref ref-type="table-fn" rid="t001fn004">*</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Analyze GridION X5 outputs<xref ref-type="table-fn" rid="t001fn005">**</xref></td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Analyze MinION/GridION X5 multi-read .<italic>fast5</italic> files</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Compare MinION/GridION X5 data</td>
              <td align="center" rowspan="1" colspan="1">✔</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p><sup>1</sup> NanoR plots reads length histograms for each experiment when plotting reads length versus reads quality</p>
        </fn>
        <fn id="t001fn002">
          <p><sup>2</sup> NanoR plots reads quality histograms for each experiment when plotting reads length versus reads quality</p>
        </fn>
        <fn id="t001fn003">
          <p><sup>3</sup> Poretools does not plot muxes occupancy</p>
        </fn>
        <fn id="t001fn004">
          <p>* These features refers to MinION single-read data analysis</p>
        </fn>
        <fn id="t001fn005">
          <p>** poRe, IONiseR, poretools and HPG pore are not specifically designed to work with GridION X5 outputs; however, since from release 18.12.1 MinION and GridION X5 outputs are the same, theoretically these tools can work with GridION X5 single-read basecalled .<italic>fast5</italic> files while they cannot work with default outputs from previous releases.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Conclusion</title>
    <p>MinION and GridION X5 from ONT are real-time sequencing devices capable to generate very long reads required for precise characterisation of complex structural variants such as copy number alterations. While library preparation is not the “hard part” when working with these devices, researchers may have some difficulties in analyzing their outputted data. Here we presented NanoR, a cross-platform package for the widespread statistical language R, that allows easy and fast analysis of MinION and GridION X5 outputs. Currently, NanoR has been extensively tested on the following 1D sequencing data:</p>
    <list list-type="bullet">
      <list-item>
        <p>MinION and GridION X5 basecalled .<italic>fast5</italic> files (from any release till MinION 18.2 and GridION 18.2.1)</p>
      </list-item>
      <list-item>
        <p>MinION and GridION X5 sequencing summary and .<italic>fastq</italic> files (from any release till MinION 18.2 and GridION 18.2.1)</p>
      </list-item>
    </list>
    <p>NanoR can be easily improved in the future in order to be up-to-date with the expected releases of MinION and GridION X5 softwares and to extend its data analysis capability and, even though there are other programs that can be used to analyze MinION data such as poRe, IONiseR, poretools and HPG pore, NanoR has unique features that make this tool extremely useful for researchers that work with ONT’s sequencing data.</p>
  </sec>
  <sec id="sec012">
    <title>Software availability and requirements</title>
    <list list-type="bullet">
      <list-item>
        <p>Project name: NanoR</p>
      </list-item>
      <list-item>
        <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/davidebolo1993/NanoR">https://github.com/davidebolo1993/NanoR</ext-link></p>
      </list-item>
      <list-item>
        <p>Operating systems: Linux, Windows, MacOSX</p>
      </list-item>
      <list-item>
        <p>Programming language: R</p>
      </list-item>
      <list-item>
        <p>Other requirements: <italic>R</italic> ≥ 3.1.3, <italic>ggplot</italic>2 ≥ 2.2.1, <italic>reshape</italic>2 ≥ 1.4.3, <italic>RColorBrewer</italic> ≥ 1.1.2, <italic>scales</italic> ≥ 0.5.0, <italic>gridExtra</italic> ≥ 2.3, <italic>ShortRead</italic> ≥ 1.24.0, <italic>rhdf</italic>5 ≥ 2.14</p>
      </list-item>
      <list-item>
        <p>License: GPLv3</p>
      </list-item>
    </list>
    <p>A dataset (∼ 11 GB) of MinION single-read passed .<italic>fast5</italic> files supporting the figures of this article together with a dataset (∼ 17 GB) coming from a GridION X5 run supporting data shown in<xref ref-type="supplementary-material" rid="pone.0216471.s002">S2 File</xref> can be found at <ext-link ext-link-type="uri" xlink:href="https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=">https://faspex.embl.de/aspera/faspex/external_deliveries/823?passcode=c4aa66d379850be32163f8517fa04750aec7a3bf&amp;expiration=MjAxOS0wNS0wMlQwNjo1Nzo0MFo=</ext-link>. The aforementioned dataset contains MinION and GridION X5 runs performed before MinION 18.2 and GridION X5 18.2.1 releases. The complete set of plots returned by NanoR as well as exhaustive installation istructions and examples of how to run NanoR functions and a folder containing all the functions on which NanoR is built can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/davidebolo1993/NanoR">https://github.com/davidebolo1993/NanoR</ext-link>, together with the manual of the tool.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec013">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0216471.s001">
      <label>S1 File</label>
      <caption>
        <title>Comparison between NanoR, poRe and IONiseR.</title>
        <p>S1 File contains detailed statistics for NanoR, poRe and IONiseR, calculated while extracting metadata from MinION .<italic>fast5</italic> files.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0216471.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0216471.s002">
      <label>S2 File</label>
      <caption>
        <title>Example of application of NanoR on GridION X5 data.</title>
        <p>S2 File contains a detailed example of application of NanoR (“G” version) on GridION X5’s .<italic>fastq</italic> files filtering.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0216471.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0216471.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Magi</surname><given-names>A</given-names></name>, <name><surname>Semeraro</surname><given-names>R</given-names></name>, <name><surname>Mingrino</surname><given-names>A</given-names></name>, <name><surname>Giusti</surname><given-names>B</given-names></name>, <name><surname>D’Aurizio</surname><given-names>R</given-names></name>. <article-title>Nanopore sequencing data analysis: state of the art, applications and challenges</article-title>. <source>Brief Bioinform</source>. <year>2018</year><month>11</month><day>27</day>;<volume>19</volume>(<issue>6</issue>):<fpage>1256</fpage>–<lpage>1272</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbx062</pub-id><?supplied-pmid 28637243?><pub-id pub-id-type="pmid">28637243</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Korlach</surname><given-names>J</given-names></name>, <name><surname>Bjornson</surname><given-names>KP</given-names></name>, <name><surname>Chaudhuri</surname><given-names>BP</given-names></name>, <name><surname>Cicero</surname><given-names>RL</given-names></name>, <name><surname>Flusberg</surname><given-names>BA</given-names></name>, <name><surname>Gray</surname><given-names>JJ</given-names></name>, <name><surname>Holden</surname><given-names>D</given-names></name>, <name><surname>Saxena</surname><given-names>R</given-names></name>, <name><surname>Wegener</surname><given-names>J</given-names></name>, <name><surname>Turner</surname><given-names>SW</given-names></name>. <article-title>Real-time DNA sequencing from single polymerase molecules</article-title>. <source>Methods Enzymol</source>. <year>2010</year>;<volume>472</volume>:<fpage>431</fpage>–<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1016/S0076-6879(10)72001-2</pub-id><?supplied-pmid 20580975?><pub-id pub-id-type="pmid">20580975</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Jain</surname><given-names>M</given-names></name>, <name><surname>Olsen</surname><given-names>HE</given-names></name>, <name><surname>Paten</surname><given-names>B</given-names></name>, <name><surname>Akeson</surname><given-names>M</given-names></name>. <article-title>The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community</article-title>. <source>Genome Biol</source>. <year>2016</year><month>11</month><day>25</day>;<volume>17</volume>(<issue>1</issue>):<fpage>239</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1103-0</pub-id><?supplied-pmid 27887629?><pub-id pub-id-type="pmid">27887629</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref004">
      <label>4</label>
      <mixed-citation publication-type="other">The HDF Group. Hierarchical Data Format, version 5.</mixed-citation>
    </ref>
    <ref id="pone.0216471.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Loman</surname><given-names>NJ</given-names></name>, <name><surname>Quinlan</surname><given-names>AR</given-names></name>. <article-title>Poretools: a toolkit for analyzing nanopore sequence data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>23</issue>):<fpage>3399</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu555</pub-id><?supplied-pmid 25143291?><pub-id pub-id-type="pmid">25143291</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Watson</surname><given-names>M</given-names></name>, <name><surname>Thomson</surname><given-names>M</given-names></name>, <name><surname>Risse</surname><given-names>J</given-names></name>, <name><surname>Talbot</surname><given-names>R</given-names></name>, <name><surname>Santoyo-Lopez</surname><given-names>J</given-names></name>, <name><surname>Gharbi</surname><given-names>K</given-names></name>, <name><surname>Blaxter</surname><given-names>M</given-names></name>. <article-title>poRe: an R package for the visualization and analysis of nanopore sequencing data</article-title>. <source>Bioinformatics</source>. <year>2015</year><month>1</month><day>1</day>;<volume>31</volume>(<issue>1</issue>):<fpage>114</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu590</pub-id><?supplied-pmid 25173419?><pub-id pub-id-type="pmid">25173419</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Tarraga</surname><given-names>J</given-names></name>, <name><surname>Gallego</surname><given-names>A</given-names></name>, <name><surname>Arnau</surname><given-names>V</given-names></name>, <name><surname>Medina</surname><given-names>I</given-names></name>, <name><surname>Dopazo</surname><given-names>J</given-names></name>. <article-title>HPG pore: an efficient and scalable framework for nanopore sequencing data</article-title>. <source>BMC Bioinformatics</source>. <year>2016</year><month>2</month><day>27</day>;<volume>17</volume>:<fpage>107</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-0966-0</pub-id><?supplied-pmid 26921234?><pub-id pub-id-type="pmid">26921234</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Stewart</surname><given-names>RD</given-names></name>, <name><surname>Watson</surname><given-names>M</given-names></name>. <article-title>poRe GUIs for parallel and real-time processing of MinION sequence data</article-title>. <source>Bioinformatics</source>. <year>2017</year><month>7</month><day>15</day>;<volume>33</volume>(<issue>14</issue>):<fpage>2207</fpage>–<lpage>2208</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx136</pub-id><?supplied-pmid 28334395?><pub-id pub-id-type="pmid">28334395</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216471.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">R Core Team A Language and Environment for Statistical Computing.</mixed-citation>
    </ref>
    <ref id="pone.0216471.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">Smith M. Quality Assessment Tools for Oxford Nanopore MinION data.</mixed-citation>
    </ref>
    <ref id="pone.0216471.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Jain</surname><given-names>M</given-names></name>, <name><surname>Koren</surname><given-names>S</given-names></name>, <name><surname>Miga</surname><given-names>KH</given-names></name>, <name><surname>Quick</surname><given-names>J</given-names></name>, <name><surname>Rand</surname><given-names>AC</given-names></name>, <name><surname>Sasani</surname><given-names>TA</given-names></name>, <name><surname>Tyson</surname><given-names>JR</given-names></name>, <name><surname>Beggs</surname><given-names>AD</given-names></name>, <name><surname>Dilthey</surname><given-names>AT</given-names></name>, <name><surname>Fiddes</surname><given-names>IT</given-names></name>, <name><surname>Malla</surname><given-names>S</given-names></name>, <name><surname>Marriott</surname><given-names>H</given-names></name>, <name><surname>Nieto</surname><given-names>T</given-names></name>, <name><surname>O’Grady</surname><given-names>J</given-names></name>, <name><surname>Olsen</surname><given-names>HE</given-names></name>, <name><surname>Pedersen</surname><given-names>BS</given-names></name>, <name><surname>Rhie</surname><given-names>A</given-names></name>, <name><surname>Richardson</surname><given-names>H</given-names></name>, <name><surname>Quinlan</surname><given-names>AR</given-names></name>, <name><surname>Snutch</surname><given-names>TP</given-names></name>, <name><surname>Tee</surname><given-names>L</given-names></name>, <name><surname>Paten</surname><given-names>B</given-names></name>, <name><surname>Phillippy</surname><given-names>AM</given-names></name>, <name><surname>Simpson</surname><given-names>JT</given-names></name>, <name><surname>Loman</surname><given-names>NJ</given-names></name>, <name><surname>Loose</surname><given-names>M</given-names></name>. <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>. <source>Nat Biotechnol</source>. <year>2018</year><month>4</month>;<volume>36</volume>(<issue>4</issue>):<fpage>338</fpage>–<lpage>345</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id><?supplied-pmid 29431738?><pub-id pub-id-type="pmid">29431738</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
