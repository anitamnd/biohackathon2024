<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10111838</article-id>
    <article-id pub-id-type="publisher-id">5280</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05280-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyAGH: a python package to fast construct kinship matrices based on different levels of omic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qadri</surname>
          <given-names>Qamar Raza</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhenyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Yuchun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Qishan</given-names>
        </name>
        <address>
          <email>wangqishan@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhe</given-names>
        </name>
        <address>
          <email>zhe_zhang@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Animal Science, College of Animal Sciences, </institution><institution>Zhejiang University, </institution></institution-wrap>866# Yuhangtang Road, Hangzhou, 310058 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Department of Animal Science, School of Agriculture and Biology, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>800# Dongchuan Road, Shanghai, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Hainan Research Institute, </institution><institution>Zhejiang University, </institution></institution-wrap>11# Yonyou Industrial Park, Yazhou Bay Science and Technology City, Sanya, 572025 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>153</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Construction of kinship matrices among individuals is an important step for both association studies and prediction studies based on different levels of omic data. Methods for constructing kinship matrices are becoming diverse and different methods have their specific appropriate scenes. However, software that can comprehensively calculate kinship matrices for a variety of scenarios is still in an urgent demand.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this study, we developed an efficient and user-friendly python module, PyAGH, that can accomplish (1) conventional additive kinship matrces construction based on pedigree, genotypes, abundance data from transcriptome or microbiome; (2) genomic kinship matrices construction in combined population; (3) dominant and epistatic effects kinship matrices construction; (4) pedigree selection, tracing, detection and visualization; (5) visualization of cluster, heatmap and PCA analysis based on kinship matrices. The output from PyAGH can be easily integrated in other mainstream software based on users’ purposes. Compared with other softwares, PyAGH integrates multiple methods for calculating the kinship matrix and has advantages in terms of speed and data size compared to other software. PyAGH is developed in python and C +  + and can be easily installed by pip tool. Installation instructions and a manual document can be freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaow-01/PyAGH">https://github.com/zhaow-01/PyAGH</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">PyAGH is a fast and user-friendly Python package for calculating kinship matrices using pedigree, genotype, microbiome and transcriptome data as well as processing, analyzing and visualizing data and results. This package makes it easier to perform predictions and association studies processes based on different levels of omic data.
</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Kinship matrices</kwd>
      <kwd>Python package</kwd>
      <kwd>Omic data</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>32102503</award-id>
        <award-id>32102503</award-id>
        <award-id>32102503</award-id>
        <award-id>32102503</award-id>
        <award-id>32102503</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhao</surname>
            <given-names>Wei</given-names>
          </name>
          <name>
            <surname>Qadri</surname>
            <given-names>Qamar Raza</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Yuchun</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Qishan</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Zhe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Zhejiang Provincial Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2021C02008</award-id>
        <award-id>2021C02008</award-id>
        <award-id>2021C02008</award-id>
        <award-id>2021C02008</award-id>
        <award-id>2021C02008</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Zhenyang</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Zhen</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Yuchun</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Qishan</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Zhe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Kinship matrix, a symmetrical matrix representing the pairwise relatedness between individuals, was initially proposed to account for variance–covariance structure of breeding values (additive genetic effects) implemented in the best linear unbiased prediction (BLUP) method using pedigree information. With the development of high throughput genotyping methods during the last two decades, the kinship matrices were calculated using genome-wide markers and can be used to account for cryptic relatedness between pairwise individuals in genome wide association studies (GWAS) and to fit polygenicity in genomic prediction (GP), such as genomic best linear unbiased prediction (GBLUP) method [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Therefore, how to construct kinship matrix is an important factor to control false discoveries in GWAS and obtain high accuracy in GP for different traits or diseases.</p>
    <p id="Par13">Actually, methods for constructing kinship matrices are becoming diverse and different methods have their specific appropriate application scenarios. For instance, under the occasion that only part of individuals are genotyped in the population, the kinship matrix can be calculated in combination of pedigree and genotypes, which can be further implemented in GP [<xref ref-type="bibr" rid="CR3">3</xref>] and GWAS [<xref ref-type="bibr" rid="CR4">4</xref>], which are well known as single-step methods in animal and plant breeding area. Meanwhile, when GWAS or GP is applied in a large cohort composed of multiple populations, Wientjes et al. (2017) suggested to construct a kinship matrix considering the heterogenous minor alle frequencies (MAF) across different populations. And the results obtained by simulated data showed that when the across-population genomic relationships ﻿were scaled by the within-population allele frequency, the genetic correlation was estimated unbiasedly. In addition, nonadditive effects, including the interaction between the effects of alleles either at the same locus (dominance) or between the allels of multiple genetic loci (epistasis), contributes significantly to phenotypic variation associated with the expression of polygenic complex traits [<xref ref-type="bibr" rid="CR5">5</xref>]. Nonadditive effects are considered as a possible explanation for the "missing heritability", that is, marginal genetic effects that cannot be accounted for in GWAS or GP. Some studies have shown that considering nonadditive effects can improve the accuracy of predictions [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. However, the mainstream GWAS and GP software such as GCTA [<xref ref-type="bibr" rid="CR8">8</xref>] or DMU [<xref ref-type="bibr" rid="CR9">9</xref>] either fail to calculate such extended kinship matrices or can’t output these matrices, which limits its further application.</p>
    <p id="Par14">Furthermore, due to the development of multi-omics, kinship matrix can be calculated not only at the genomic level, but actually at multi-omic level. The concept of kinship should therefore be extended to improve its application in association and prediction studies. For instance, prediction of phenotypes based on transcriptome [<xref ref-type="bibr" rid="CR10">10</xref>] or microbiome [<xref ref-type="bibr" rid="CR11">11</xref>] improves the accuracy by utilizing more data. Microbiome-wide association studies [<xref ref-type="bibr" rid="CR12">12</xref>] and transcriptome association studies [<xref ref-type="bibr" rid="CR13">13</xref>] can further explore the mechanism of different omics on polygenic complex traits. However, there is no software available to meet such a need to calculate kinship matrices based on abundance data from transcriptome or microbiome.</p>
    <p id="Par15">Therefore, we developed the PyAGH package to calculate kinship matrices using a variety of methods based on different levels of omics data for different application scenarios. PyAGH can calculate additive, dominant and epistatic kinship matrices based on genomic data within one population and different additive kinship matrices across multiple populations efficiently. It also supports construction of kinship matrices using pedigree, microbiome and transcriptome data. In addition, the output of PyAGH can be easily provided to downstream mainstream software, such as DMU [<xref ref-type="bibr" rid="CR9">9</xref>], GCTA [<xref ref-type="bibr" rid="CR8">8</xref>], GEMMA [<xref ref-type="bibr" rid="CR14">14</xref>] and BOLT-LMM [<xref ref-type="bibr" rid="CR15">15</xref>]. Thus, these user-friendly features allow novice users to focus on the analysis rather than technical aspects of installation and execution.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par16">The PyAGH package is implemented in Python programming language. It contains multiple Python3 and C +  + scripts with all the functions required for the program to execute. Some functions are written in C +  + via pybind11 (<ext-link ext-link-type="uri" xlink:href="https://github.com/pybind/pybind11">https://github.com/pybind/pybind11</ext-link>) to accelerate the computation speed. To be able to handle high-density genomic data, PyAGH supports multi-threaded computation, as well as split-chromosome computation based on the chunk matrix theory. In addition, for large-scale pedigree data, sparse matrices are used to save memory as well as to increase speed through multithreading. PyAGH has been successfully tested on machines running Unix-based operation system (OS) (macOS/Linux) and Windows. A detailed description of all algorithms and functions of PyAGH is provided in the user manual available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaow-01/PyAGH">https://github.com/zhaow-01/PyAGH</ext-link>. Basic information of PyAGH’s functions has been summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of PyAGH’s functions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Category</th><th align="left">Function</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left" rowspan="4">Pedigree</td><td align="left">sortPed()</td><td align="left">Sort the pedigree data according to the correct birth date of individuals and check for various errors in the pedigree like offspring born before its parents, same offspring have different parents, loop in pedigree and etc</td></tr><tr><td align="left">selectPed()</td><td align="left">Select pedigree based on specific individuals and generations</td></tr><tr><td align="left">makeA()</td><td align="left">Construct kinship matrix based on pedigree information for additive effect. Option to use sparse matrix for memory saving</td></tr><tr><td align="left">makeD()</td><td align="left">Construct kinship matrix based on pedigree information for dominant effect. Option to use multithreading when there are multiple CPU</td></tr><tr><td align="left" rowspan="3">Genome</td><td align="left">makeG()</td><td align="left">Construct kinship matrix based on genotype data for additive effect. Option to use different methods</td></tr><tr><td align="left">makeG_inter()</td><td align="left">Construct kinship matrix based on genotype data for dominance and epistatic effect. Option to use multithreading</td></tr><tr><td align="left">makeH()</td><td align="left">Combine information of pedigree and genotypes to construct kinship matrix for both genotyped and ungenotyped individuals</td></tr><tr><td align="left">Microbiome</td><td align="left">makeM()</td><td align="left">Construct kinship matrix based on microbiome data</td></tr><tr><td align="left">Transcriptome</td><td align="left">makeT()</td><td align="left">Construct kinship matrix based on transcriptome data</td></tr><tr><td align="left" rowspan="6">Composition analysis and visualization</td><td align="left">coefKinship()</td><td align="left">Calculate the ancestry coefficients using kinship matrix</td></tr><tr><td align="left">coefInbreeding()</td><td align="left">Calculate the inbreeding coefficients using kinship matrix</td></tr><tr><td align="left">cluster()</td><td align="left">Cluster analysis of the kinship matrix and plot the result</td></tr><tr><td align="left">pca()</td><td align="left">Principal component analysis of kinship matrix and plot the result</td></tr><tr><td align="left">heat()</td><td align="left">Plot the heatmap of a kinship matrix</td></tr><tr><td align="left">gragh()</td><td align="left">Plot family tree tracing back up to three generations of an individual</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec3">
      <title>Construction of kinship matrix based on pedigree data</title>
      <p id="Par17">Kinship matrix is the core of traditional breeding in best linear unbiased prediction (BLUP) which is a famous classical method and widely used in breeding since 1950s [<xref ref-type="bibr" rid="CR16">16</xref>]. <italic>makeA() and makeD()</italic> are the functions in PyAGH used to construct kinship matrices based on pedigree information for additive and dominant effects, respectively. The additive effect refers to the cumulative effect between alleles and non-alleles, which is a fixed component of intergenerational inheritance and is also called breeding value in breeding. The dominant effect refers to the difference between the effect value of each gene and its additive effect value, which is derived from the effect of the interaction between alleles and is a non-additive effect, called dominant deviation. This effect can be inherited but not fixed and is the main part of the heterozygous advantage. The program for function <italic>makeA()</italic> improves the speed of computation by referring to the algorithm propose by Meuwissen and Luo [<xref ref-type="bibr" rid="CR17">17</xref>]. And <italic>makeD()</italic> further calculates the dominant effects on the basis of <italic>makeA().</italic> To improve the speed of computation, both functions were written in C +  + and support multi-threaded operation, while using sparse matrices to save memory.</p>
    </sec>
    <sec id="Sec4">
      <title>Construction of kinship matrix based on genomic data</title>
      <p id="Par18">With the development of genotyping technology, more and more genomic data are available for GP, like GBLUP method [<xref ref-type="bibr" rid="CR18">18</xref>]. The <italic>makeG()</italic> function provides four methods for calculating the additive effects kinship matrix. In a single population, the first method to calculate G matrix was developed by VanRaden [<xref ref-type="bibr" rid="CR1">1</xref>]:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}G=\frac{\sum \left({x}_{ij}-2{p}_{i}\right)\left({x}_{ik}-2{p}_{i}\right)}{\sum 2{p}_{i}\left(1-{p}_{i}\right)}\end{array}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{ij}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{ik}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq2.gif"/></alternatives></inline-formula> are the genotypes of the <italic>i</italic>th marker in individuals <italic>j</italic> and <italic>k</italic> (denoted as 0, 1 and 2). <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq3.gif"/></alternatives></inline-formula> is the minor allele frequency (MAF) of the <italic>i</italic>th marker. The second method of calculating G matrix was developed by Yang et al. [<xref ref-type="bibr" rid="CR2">2</xref>]:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}G=\frac{1}{m}\times \sum \frac{\left({x}_{ij}-2{p}_{i}\right)\left({x}_{ik}-2{p}_{i}\right)}{2{p}_{i}\left(1-{p}_{i}\right)}\end{array}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo>×</mml:mo><mml:mo>∑</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>m</italic> is the number of markers, while other symbols represent the same meaning as formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>). When computing G matrix in a combined popualtion, due to the differences in MAF between different populations, the direct use of the above method may bring bias. PyAGH provides two alternative methods to consider the heterogeneity of genetic structure of the combined population. One method for calculationg G matrix considering MAF differences between populations was developed by Chen et al. [<xref ref-type="bibr" rid="CR19">19</xref>]:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}G=\left[\begin{array}{cc}{\mathbf{G}}_{11}&amp; {\mathbf{G}}_{12}\\ {\mathbf{G}}_{21}&amp; {\mathbf{G}}_{22}\end{array}\right]=\left[\begin{array}{cc}\frac{{\mathbf{W}}_{1}{\mathbf{W}}_{1}^{\mathrm{T}}}{\sum 2{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right)}&amp; \frac{{\mathbf{W}}_{1}{\mathbf{W}}_{2}^{\mathrm{T}}}{\sum 2\sqrt{{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right){\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}}\\ \frac{{\mathbf{W}}_{2}{\mathbf{W}}_{1}^{\mathrm{T}}}{\sum 2\sqrt{{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right){\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}}&amp; \frac{{\mathbf{W}}_{2}{\mathbf{W}}_{2}^{\mathrm{T}}}{\sum 2{\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}\end{array}\right]\end{array}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mrow><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mrow><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{11}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{22}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq5.gif"/></alternatives></inline-formula> represent the genomic kinship matrix of individuals in two independent populations, respectively. <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{12}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{21}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq7.gif"/></alternatives></inline-formula> represent the genomic kinship matrix of individuals cross two populations. <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{W}}_{1}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{W}}_{2}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq9.gif"/></alternatives></inline-formula> are standardized genotypes of individuals in two populations, respectively. <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{p}}_{1\mathrm{j}}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{p}}_{2\mathrm{j}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq11.gif"/></alternatives></inline-formula> are the minor allele frequencies of the <italic>j</italic>th marker calculated based on population 1 and population 2, respectively. Another method calculationg G matrix in combined populations was developed by Wientjes et al. [<xref ref-type="bibr" rid="CR20">20</xref>]:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}G=\left[\begin{array}{cc}{\mathbf{G}}_{11}&amp; {\mathbf{G}}_{12}\\ {\mathbf{G}}_{21}&amp; {\mathbf{G}}_{22}\end{array}\right]=\left[\begin{array}{cc}\frac{{\mathbf{W}}_{1}{\mathbf{W}}_{1}^{\mathrm{T}}}{\sum 2{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right)}&amp; \frac{{\mathbf{W}}_{1}{\mathbf{W}}_{2}^{\mathrm{T}}}{\sqrt{\sum 2{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right)}\sqrt{\sum 2{\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}}\\ \frac{{\mathbf{W}}_{2}{\mathbf{W}}_{1}^{\mathrm{T}}}{\sqrt{\sum 2{\mathrm{p}}_{1\mathrm{j}}\left(1-{\mathrm{p}}_{1\mathrm{j}}\right)}\sqrt{\sum 2{\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}}&amp; \frac{{\mathbf{W}}_{2}{\mathbf{W}}_{2}^{\mathrm{T}}}{\sum 2{\mathrm{p}}_{2\mathrm{j}}\left(1-{\mathrm{p}}_{2\mathrm{j}}\right)}\end{array}\right]\#\end{array}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>#</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where the symbols represent the same meaning as formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>).</p>
      <p id="Par19">The <italic>makeG_inter()</italic> function calculates the dominant effect and epistatic effect kinship matrix based on genomic data according to algorithms proposed by Xu [<xref ref-type="bibr" rid="CR21">21</xref>]. Epistatic effects refer to the effects of interactions between non-allelic genes at different loci, where one pair of genes suppresses or masks the other pair of genes. The formulas for dominant kinship matrix (d) and four epistatic kinship matrices (aa, dd, ad, da) are show in Table <xref rid="Tab2" ref-type="table">2</xref>, where the <bold>Z</bold> and <bold>W</bold> represent the genotype matrices of different coding modes. For <italic>k</italic>th marker in individual <italic>j</italic>:<table-wrap id="Tab2"><label>Table 2</label><caption><p>Formulas used to calculate marker generated kinship matrices</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Type of effect</th><th align="left">Original kinship matrix</th><th align="left">Kinship matrix</th></tr></thead><tbody><tr><td align="left">Dominance(d)</td><td align="left"><inline-formula id="IEq29"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}^{*}=\sum_{k=1}^{m}{W}_{k}{W}_{k}^{T}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq29.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq30"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}=(\frac{1}{mean[diag\left({K}_{d}^{*}\right)]}) {K}_{d}^{*}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq30.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Additive × additive (aa)</td><td align="left"><inline-formula id="IEq31"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{aa}^{*}=\sum_{k=1}^{m-1}\sum_{{k}^{^{\prime}}=k+1}^{m}({Z}_{k}\#{Z}_{{k}^{^{\prime}}}){({Z}_{k}\#{Z}_{{k}^{^{\prime}}})}^{T}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">aa</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq31.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq32"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{aa}=(\frac{1}{mean[diag\left({K}_{aa}^{*}\right)]}) {K}_{aa}^{*}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">aa</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">aa</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">aa</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq32.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Dominance × dominance (dd)</td><td align="left"><inline-formula id="IEq33"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{dd}^{*}=\sum_{k=1}^{m-1}\sum_{{k}^{^{\prime}}=k+1}^{m}({W}_{k}\#{W}_{{k}^{^{\prime}}}){({W}_{k}\#{W}_{{k}^{^{\prime}}})}^{T}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">dd</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq33.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq34"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{dd}=(\frac{1}{mean[diag\left({K}_{dd}^{*}\right)]}) {K}_{dd}^{*}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">dd</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">dd</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">dd</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq34.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Additive × dominance (ad)</td><td align="left"><inline-formula id="IEq35"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{ad}^{*}=\sum_{k=1}^{m-1}\sum_{{k}^{^{\prime}}=k+1}^{m}({Z}_{k}\#{W}_{{k}^{^{\prime}}}){({Z}_{k}\#{W}_{{k}^{^{\prime}}})}^{T}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ad</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq35.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq36"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{ad}=(\frac{1}{mean[diag\left({K}_{ad}^{*}\right)]}) {K}_{ad}^{*}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ad</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ad</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">ad</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq36.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Dominance × additive (da)</td><td align="left"><inline-formula id="IEq37"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{dd}^{*}=\sum_{k=1}^{m-1}\sum_{{k}^{^{\prime}}=k+1}^{m}({W}_{k}\#{Z}_{{k}^{^{\prime}}}){({W}_{k}\#{Z}_{{k}^{^{\prime}}})}^{T}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">dd</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq37.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq38"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{da}=(\frac{1}{mean[diag\left({K}_{da}^{*}\right)]}) {K}_{da}^{*}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">da</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">da</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="italic">da</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq38.gif"/></alternatives></inline-formula></td></tr></tbody></table></table-wrap><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{Z}_{jk}=\left\{\begin{array}{l}+1\quad for\; A\\ 0\quad\;\; \;for H\\ -1\quad for\; B\end{array}\right. {W}_{jk}=\left\{\begin{array}{c}0\quad for\; A\\ 1\quad for\; H\\ 0\quad for\; B\end{array}\right.\end{array}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>H</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par20"><inline-formula id="IEq12"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{jk}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{jk}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq13.gif"/></alternatives></inline-formula> represent the codes for additive and dominance effects, respectively, and<italic> A</italic> (the first homozygote),<italic> H</italic> (heterozygote), and <italic>B</italic> (the second homozygote) indicate the three genotypes. Z<sub>k</sub> # W<sub>k</sub> represents element-wise vector multiplication.</p>
      <p id="Par21">The original kinship matrix were normalized by dividing the mean of all diagonal elements of the original matrix so that the diagonal elements are approximately equal to 1. Using the normalized kinship matrix will result in the estimated genetic variance having the same scale as the residual variance.</p>
      <p id="Par22">The <italic>makeH()</italic> function combines information of pedigree and genotypes to construct kinship matrix <bold>H</bold> for both genotyped and ungenotyped individuals used in single-step genomic best linear unbiased prediction (ssGBLUP) method [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The formula for <bold>H</bold> matrix is:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}H=\left[\begin{array}{cc}{\mathbf{H}}_{11}&amp; {\mathbf{H}}_{12}\\ {\mathbf{H}}_{21}&amp; {\mathbf{H}}_{22}\end{array}\right]=\left[\begin{array}{cc}{\mathbf{A}}_{11}+{\mathbf{A}}_{12}{\mathbf{A}}_{22}^{-1}\left({\mathbf{G}}_{\mathbf{w}}-{\mathbf{A}}_{22}\right){\mathbf{A}}_{22}^{-1}{\mathbf{A}}_{21}&amp; {\mathbf{A}}_{12}{\mathbf{A}}_{22}^{-1}{\mathbf{G}}_{\mathbf{w}}\\ {\mathbf{G}}_{\mathbf{w}}{\mathbf{A}}_{22}^{-1}{\mathbf{A}}_{21}&amp; {\mathbf{G}}_{\mathbf{w}}\end{array}\right]\end{array}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mfenced><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where subscript 1 represent the individuals without genotypes and subscript 2 represent the individuals with genotypes. <inline-formula id="IEq14"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{11}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{12}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{21}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{22}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq17.gif"/></alternatives></inline-formula> are constructed by pedigree information.<inline-formula id="IEq18"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{\mathbf{w}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq18.gif"/></alternatives></inline-formula> is calculated by <inline-formula id="IEq19"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}_{\mathbf{w}}=\left(1-w\right){\mathbf{G}}^{\mathbf{*}}+w{\mathbf{A}}_{22}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq19.gif"/></alternatives></inline-formula>. The parameter <italic>w</italic> is used adjust the relative weights of the <bold>G</bold> matrix and the <bold>A</bold> matrix. <inline-formula id="IEq20"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{G}}^{\mathbf{*}}=a+b\mathbf{G}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi mathvariant="bold">G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq20.gif"/></alternatives></inline-formula>, a and b are achieved by:<disp-formula id="Equa"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Avg\left(diag\left(\mathbf{G}\right)\right)\times b+a=Avg\left(diag\left({\mathbf{A}}_{22}\right)\right)$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">G</mml:mi></mml:mfenced></mml:mfenced><mml:mo>×</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}Avg\left(offdiag\left(\mathbf{G}\right)\right)\times b+a=Avg\left(offdiag\left({\mathbf{A}}_{22}\right)\right)\end{array}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">G</mml:mi></mml:mfenced></mml:mfenced><mml:mo>×</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{22}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq21.gif"/></alternatives></inline-formula> is a submatrix of <bold>A</bold> related to the genotyped individuals; <bold>G</bold> is a additive genomic relationship matrix of genotyped individuals. <inline-formula id="IEq22"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{A}vg\left(diag\left(\mathbf{G}\right)\right)$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">G</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq22.gif"/></alternatives></inline-formula> is the average of the diagonal of the <bold>G</bold> matrix. And <inline-formula id="IEq23"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Avg\left(offdiag\left(\mathbf{G}\right)\right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">G</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq23.gif"/></alternatives></inline-formula> is the average of the off-diagonal of the <bold>G</bold> matrix.</p>
    </sec>
    <sec id="Sec5">
      <title>Construction of kinship matrix based on microbiome and transcriptome data</title>
      <p id="Par23">The host associated microbiome is known to influence many traits. A number of studies have reported that combining microbiome and genomic information could improve the prediction accuracy compared with only genomic data [<xref ref-type="bibr" rid="CR23">23</xref>]. The <italic>makeM()</italic> function can easily normalize operational taxonomic units (OTU) as well as calculate the kinship matrix based on microbiome data. The formula for <bold>M</bold> matrix is as follows:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}M=\frac{\mathbf{O}{\mathbf{O}}^{\mathbf{T}}}{n}\#\end{array}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">O</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">O</mml:mi></mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>#</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the number of OUT in population. <bold>O</bold> is the original OTU matrix after natural logarithmic variation and normalization. And for each OUT <italic>j</italic> of individual <italic>i,</italic> the transformation formula is:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{O}_{ij}=\frac{\mathit{log}\left({X}_{ij}\right)-{\overline{\mathit{log }\left({X}_{ij}\right)}}_{j}}{{sd\left(\mathit{log}\left({X}_{ij}\right)\right)}_{j}}\#\end{array}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:mo>#</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq24"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{X}}_{\mathrm{ij}}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq24.gif"/></alternatives></inline-formula> is the abundance of the <italic>j</italic>th OTU of the <italic>i</italic>th individual. <inline-formula id="IEq25"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{sd}\left(\mathrm{log}\left({\mathrm{X}}_{\mathrm{ij}}\right)\right)}_{\mathrm{j}}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi mathvariant="normal">sd</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="normal">X</mml:mi><mml:mi mathvariant="normal">ij</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq25.gif"/></alternatives></inline-formula> is the standard deviation of <italic>j</italic>th OUT in all individuals.</p>
      <p id="Par24">In addition, modeling transcriptome data as predictors in genomic prediction is expected to explain more nonlinear variation or complex biological regulatory processes and has the potential to improve the accuracy of prediction [<xref ref-type="bibr" rid="CR24">24</xref>]. The <italic>makeT()</italic> function in PyAGH can simply calculate the kinship matrix based on transcriptome data. The formula for <bold>T</bold> matrix is as follows:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}T=R{\mathbf{R}}^{\mathbf{T}}\#\end{array}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:msup><mml:mo>#</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par25"><bold>R</bold> is the normalized gene expression matrix, and the normalization formula is:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{r}_{ij}=\frac{{X}_{ij}-\overline{{X }_{j}}}{{sd}_{j}}\#\end{array}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">sd</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:mo>#</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5280_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq26"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq26.gif"/></alternatives></inline-formula> is the expression of gene<italic> j</italic> in individual <italic>i</italic>, <inline-formula id="IEq27"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{X }_{j}}$$\end{document}</tex-math><mml:math id="M98"><mml:mover><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq27.gif"/></alternatives></inline-formula> is the mean of the expression of gene <italic>j</italic> in all individuals, and <inline-formula id="IEq28"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${sd}_{j}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi mathvariant="italic">sd</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5280_Article_IEq28.gif"/></alternatives></inline-formula> is the standard deviation of the expression of gene <italic>j</italic> in all individuals.</p>
    </sec>
    <sec id="Sec6">
      <title>Pedigree and composition analysis and visualization</title>
      <p id="Par26">Pedigree provides important information for estimating breeding values in the field of plant and animal breeding. To make it easier to use such information, PyAGH provides targeted tools for specific demands, such as detecting common pedigree errors (like offspring born before its parents, individual with two genders, same offspring have different parents, and etc.), selection target individuals (a subset of the whole pedigree), sorting pedigree by birthdate, pedigree visualization, calculating inbreeding coefficients and ancestry coefficients. In addition, principal component analysis (PCA), heatmap and cluster analysis functions were involved in PyAGH to reveal population structure conveniently.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par27">To support the robustness and speed of the package, we tested the performance of main functions with different cases data in a Linux machine with Intel(R) Xeon(R) Gold 5218 CPU @ 2.30 GHz and 256 GB RAM. First, we compared the makeA function with the Nadiv (<ext-link ext-link-type="uri" xlink:href="https://github.com/matthewwolak/nadiv">https://github.com/matthewwolak/nadiv</ext-link>) package using a dataset containing 100,000 pedigree records. Nadiv is a widely used R package for processing pedigree data. The results of the comparison between the two softwares were shown in Table <xref rid="Tab3" ref-type="table">3</xref>. When the number of records is small, the computational speed of PyAGH and Nadiv is not much different, and even Nadiv is slightly faster than PyAGH. But PyAGH can support a larger number of pedigree data. For example, when the number of records reache 100,000, Nadiv was unable to perform the calculation, while PyAGH took only about 13 min to complete the calculation. This indicates that PyAGH can support a larger amount of pedigree data while maintaining speed compared to Nadiv package when calculating the pedigree additive kinship matrix. In addition, because the first step in calculating the dominance effect kinship matrix based on pedigree data is to calculate the additive effect kinship matrix, i.e., the makeA function is the basis of the makeD function, PyAGH can also support a larger amount of pedigree data for the calculation of the dominance effect kinship matrix.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Runtime and RAM of construction kinship matrix based on pedigree in PyAGH and Nadiv</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of records</th><th align="left">PyAGH</th><th align="left">Nadiv</th></tr></thead><tbody><tr><td align="left">10,000</td><td align="left">3 s (0.3 GB)</td><td align="left">2 s (0.3 GB)</td></tr><tr><td align="left">20,000</td><td align="left">32 s (1.5 GB)</td><td align="left">23 s (1.6 GB)</td></tr><tr><td align="left">50,000</td><td align="left">2min8s (11.9 GB)</td><td align="left">1min47s (16.4 GB)</td></tr><tr><td align="left">100,000</td><td align="left">13min35s (100.6 GB)</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>The numbers of pedigree records verify from 10,000 to 100,000</p><p>– means that it cannot be calculated</p></table-wrap-foot></table-wrap></p>
    <p id="Par28">Next, we tested functions that perform calculations based on genomic data. We compared the makeG function with GCTA software using a dataset containing 10,000 individuals and 1 million SNPs for one chromosome. The runing time for the two software to calculate the additive genomic kinship matrix for different number of individuals are shown in Table <xref rid="Tab4" ref-type="table">4</xref>. Regardless of the number of individuals, PyAGH computed the G matrix faster than GCTA. In addition, PyAGH provides two additional methods for calculating additive kinship matrices in combined populations, whereas GCTA does not calculate. Therefore, using PyAGH makes it easier and faster to perform matrix calculations based on research needs.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Running time of constructing kinship matrices based on genotypic data in PyAGH and GCTA</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of individuals</th><th align="left">PyAGH</th><th align="left">GCTA</th></tr></thead><tbody><tr><td align="left">1000</td><td align="left">10 s</td><td align="left">2min32s</td></tr><tr><td align="left">3000</td><td align="left">51 s</td><td align="left">2min36s</td></tr><tr><td align="left">5000</td><td align="left">1min39s</td><td align="left">3min44s</td></tr><tr><td align="left">10,000</td><td align="left">4min50s</td><td align="left">7min40s</td></tr></tbody></table><table-wrap-foot><p>Both PyAGH and GCTA used all 64 threads of the machine for computation</p><p>We fixing the number of snps at 1,000,000 while varying the numbers of individuals from 1,000 to 10,000</p></table-wrap-foot></table-wrap></p>
    <p id="Par29">The function makeG_inter in PyAGH, which calculates the dominance effect kinship matrix based on genomic data, was compared with PEPIS platform [<xref ref-type="bibr" rid="CR25">25</xref>]. PEPIS is a pipeline for estimating epistatic effects in quantitative trait locus mapping and genome-wide association studies. Since PEPIS is a cloud-based platform, we used the test data provided by PEPIS including 1000 individuals and 40,000 SNP for PyAGH testing. Table <xref rid="Tab5" ref-type="table">5</xref> shows the running time for PyAGH and PEPIS to calculate the kinship matrices of the four dominance effects aa, dd, ad, da, from which it can be seen that the advantage of PyAGH over PEPIS increases as the number of loci increases. At 40,000 loci, the computational speed of PyAGH was about 3 ~ 4 times faster than that of PEPIS. Whether using pedigree or genomic information, PyAGH has speed advantages over other softwares and can support larger data sizes.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Running time of construction kinship matrix for epistatic effect in PyAGH and PEPIS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of SNPs</th><th align="left">PyAGH</th><th align="left">PEPIS</th></tr></thead><tbody><tr><td align="left">4000</td><td align="left">4 min</td><td align="left">5 min</td></tr><tr><td align="left">10,000</td><td align="left">16 min</td><td align="left">34 min</td></tr><tr><td align="left">20,000</td><td align="left">48 min</td><td align="left">121 min</td></tr><tr><td align="left">40,000</td><td align="left">140 min</td><td align="left">488 min</td></tr></tbody></table><table-wrap-foot><p>The test data is simulation data used in PEPIS (<ext-link ext-link-type="uri" xlink:href="http://bioinfo.noble.org/PolyGenic_QTL/">http://bioinfo.noble.org/PolyGenic_QTL/</ext-link>). We fixing the number of individuals at 1,000 while varying the numbers of SNPs from 4,000 to 40,000</p></table-wrap-foot></table-wrap></p>
    <p id="Par30">Because there is no software to calculate the kinship matrix based on microbiome data, we tested PyAGH in a dataset containing 16 s RNA sequencing data of 4500 pigs [<xref ref-type="bibr" rid="CR26">26</xref>]. The results show that the package can quickly calculate the <bold>M</bold> matrix in the case of meeting the data size of a conventional study. When we fix the number of OTU at 100,000 and the number of individuals varies from 1,000 to 4,500, the time taken increases linearly (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). When we fix the number of individuals at 4,500 while varying the numbers of OTU from 10,000 to 100,000, the time taken increases as a quadratic function (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). For all 4,500 individuals and 100,000 OTU, PyAGH took about 20 s, and it can be seen that our software can quickly normalize the OUT matirx and calculate the kinship matrix.<fig id="Fig1"><label>Fig. 1</label><caption><p>Running time of PyAGH function makeM in different data. <bold>A</bold> fix the number of OTU at 100,000 while varying the numbers of individuals from 1,000 to 4,500. <bold>B</bold> fix the number of individuals at 4,500 while varying the numbers of OTU from 10,000 to 100,000</p></caption><graphic xlink:href="12859_2023_5280_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par31">Gene expression data can provide additional information in genomic prediction and can also be used to further explore the genetic mechanisms of traits in association studies. With the increase of transcriptome sequencing data, the application of transcriptome data in GP and GWAS will increase. PyAGH can quickly and easily calculate kinship matrix based on gene expression abundance data. And we used the gene expression data in muscle tissue of 1321 pigs from FarmGTEx (<ext-link ext-link-type="uri" xlink:href="https://www.farmgtex.org/">https://www.farmgtex.org/</ext-link>) as an example [<xref ref-type="bibr" rid="CR27">27</xref>]. We performed PCA of the kinship matrices based on genomic data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and transcriptomic data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), respectively. The results show that the kinship matrices calculated based on the two data were different, indicating that the transcriptome data provide additional information different from the genome.<fig id="Fig2"><label>Fig. 2</label><caption><p>Scatter plots of the first and the second principal components from kinship matrices based on genome (<bold>A</bold>) and transcriptome (<bold>B</bold>), respectively</p></caption><graphic xlink:href="12859_2023_5280_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par32">In addition to calculating a variety of kinship matrices, PyAGH can also quickly check pedigree data, extract specific subsets of individuals on demand, and calculate ancestry coefficients and inbreeding coefficients. These features allow the user to easily organize the pedigree data to focus on the next analysis process. At the same time, PyAGH allows for a variety of visualizations including PCA, Heatmap, clustering and family trees. Figure <xref rid="Fig3" ref-type="fig">3</xref>A, B shows the heat map and clustering diagram drawn using the example data in the package. Figure <xref rid="Fig3" ref-type="fig">3</xref>C shows the results of PCA analysis of the genomic data of two populations using PyAGH. Data were obtained from previous study of two large white pig populations [<xref ref-type="bibr" rid="CR28">28</xref>]. The left figure is PCA variance explained based on custom PCA. The right figure is PCA plot of top 2 PCs. Figure <xref rid="Fig3" ref-type="fig">3</xref>D was a family tree of one specific individual in three generations. This function is useful in production practice.<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>A</bold> Heat-map of a kinship matrix. <bold>B</bold> The pedigree dendograms of the cluster results. <bold>C</bold> PCA analysis results. The left figure is PCA variance explained based on custom PCA. The right figure is PCA plot of top 2 PCs. <bold>D</bold> Family tree of one individual in three generations</p></caption><graphic xlink:href="12859_2023_5280_Fig3_HTML" id="MO3"/></fig></p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par33">In this study, we have presented PyAGH, which is a robust and fast Python package for calculating kinship matrices using pedigree, genotype, microbiome and transcriptome data as well as processing, analyzing and visualizing data and results. This package provides various methods for kinship matrices construction based on additive, dominant and epistatic effects in a single population or combined populations. The PyAGH package has been intensively tested to guarantee the computation correctness and speed. Compared to existing tools, PyAGH exhibited the best performance for constructing a variety of matrices. And the calculation results can be easily used in other softwares, making the process of genome prediction and association studies more convenient. PyAGH is a python package that completes the process of using python for bioinformatics analysis. In the future work, we plan to apply more comprehensive kinship matrix calculation methods and multi-omics data processing to the coming version of PyAGH. In conclusion, PyAGH simplifies the procedure of calculating kinship matrices that are important for prediction or association studies.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p id="Par34">Project name: PyAGH.</p>
    <p id="Par35">Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaow-01/PyAGH">https://github.com/zhaow-01/PyAGH</ext-link></p>
    <p id="Par36">Operating System(s): Mac Os, Linux, Windows.</p>
    <p id="Par37">Programming language: Python, C +  + .</p>
    <p id="Par38">Other requirements: All dependencies are handled during the installation.</p>
    <p id="Par39">License: MIT.</p>
    <p id="Par40">Any restrictions to use by non-academic: PyAGH has no restriction.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BLUP</term>
        <def>
          <p id="Par4">Best linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par5">Genome wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>GP</term>
        <def>
          <p id="Par6">Genomic prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>GBLUP</term>
        <def>
          <p id="Par7">Genomic best linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p id="Par8">Minor alle frequencies</p>
        </def>
      </def-item>
      <def-item>
        <term>ssGBLUP</term>
        <def>
          <p id="Par9">Single-step genomic best linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p id="Par10">Operational taxonomic units</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par11">Principal component analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>W.Z. and Z.Y.Z. wrote the code; Z.Z., Q.R.Q. and Q.S.W. tested the code and prepared the diagrams and figures; W.Z. wrote the manuscript. W.Z., Y.C.P. and Z.Z. helped check and improve the manuscript. All authors contributed into design of the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by National Natural Science Foundation of China [32102503], Zhejiang Provincial Key R&amp;D Program of China [2021C02008, 2021C02068] and Shanghai Agricultural Science and technology innovation project No.1-5 (2020).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The pedigree data underlying this article are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaow-01/PyAGH/tree/main/PyAGH/data">https://github.com/zhaow-01/PyAGH/tree/main/PyAGH/data</ext-link>. The two pig populations genomic data are available in Alphaindex platform at <ext-link ext-link-type="uri" xlink:href="http://alphaindex.zju.edu.cn/ALPHADB/download.html">http://alphaindex.zju.edu.cn/ALPHADB/download.html</ext-link>. The 16 s RNA sequencing data are available in GSA at <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/gsa/">https://ngdc.cncb.ac.cn/gsa/</ext-link> database, and can be accessed with accession numbers: CRA006230, CRA006239, CRA006240, CRA006216. The transcriptome data are available in FarmGTEx at <ext-link ext-link-type="uri" xlink:href="http://piggtex.farmgtex.org/">http://piggtex.farmgtex.org/</ext-link>. The source code of PyAGH is deposited in a Github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaow-01/PyAGH/tree/main/PyAGH">https://github.com/zhaow-01/PyAGH/tree/main/PyAGH</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par41">No ethics approval and consent required for this study.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par42">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par43">The authors declare no competing fnancial interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanRaden</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Efficient methods to compute genomic predictions</article-title>
        <source>J Dairy Sci</source>
        <year>2008</year>
        <volume>91</volume>
        <fpage>4414</fpage>
        <lpage>4423</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id>
        <?supplied-pmid 18946147?>
        <pub-id pub-id-type="pmid">18946147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benyamin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McEvoy</surname>
            <given-names>BP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>565</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.608</pub-id>
        <?supplied-pmid 20562875?>
        <pub-id pub-id-type="pmid">20562875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christensen</surname>
            <given-names>OF</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Genomic prediction when some animals are not genotyped</article-title>
        <source>Genet Sel Evol</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-42-2</pub-id>
        <?supplied-pmid 20105297?>
        <pub-id pub-id-type="pmid">20105297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Misztal</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Aguilar</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association mapping including phenotypes from relatives without genotypes</article-title>
        <source>Genet Res</source>
        <year>2012</year>
        <volume>94</volume>
        <fpage>73</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1017/S0016672312000274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Varona L, Legarra A, Toro MA, et al. Genomic prediction methods accounting for nonadditive genetic effects. genomic predict. Complex Traits Methods Protoc. 2022; 219–243</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Momen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morota</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Quantifying genomic connectedness and prediction accuracy from additive and non-additive gene actions</article-title>
        <source>Genet Sel Evol GSE</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-018-0415-9</pub-id>
        <?supplied-pmid 30223766?>
        <pub-id pub-id-type="pmid">30223766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calleja-Rodriguez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Suontama</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic predictions with nonadditive effects improved estimates of additive effects and predictions of total genetic values in <italic>Pinus</italic>
<italic>sylvestris</italic></article-title>
        <source>Front Plant Sci</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>666820</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2021.666820</pub-id>
        <?supplied-pmid 34305966?>
        <pub-id pub-id-type="pmid">34305966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2011</year>
        <volume>88</volume>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id>
        <?supplied-pmid 21167468?>
        <pub-id pub-id-type="pmid">21167468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Madsen P, Jensen J. A package for analysing multivariate mixed models. Version 6, release 5.2. 2013;</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azodi</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>VanBuren</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-based prediction of complex traits in maize</article-title>
        <source>Plant Cell</source>
        <year>2020</year>
        <volume>32</volume>
        <fpage>139</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="doi">10.1105/tpc.19.00332</pub-id>
        <?supplied-pmid 31641024?>
        <pub-id pub-id-type="pmid">31641024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Marco</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The role of the gut microbiome in predicting response to diet and the development of precision nutrition models—part I: overview of current methods</article-title>
        <source>Adv Nutr</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>953</fpage>
        <lpage>978</lpage>
        <pub-id pub-id-type="doi">10.1093/advances/nmz022</pub-id>
        <?supplied-pmid 31225589?>
        <pub-id pub-id-type="pmid">31225589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Awany</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Allali</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dalvie</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host and microbiome genome-wide association studies: current state and challenges</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>637</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2018.00637</pub-id>
        <?supplied-pmid 30723493?>
        <pub-id pub-id-type="pmid">30723493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wainberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mancuso</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opportunities and challenges for transcriptome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>592</fpage>
        <lpage>599</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0385-z</pub-id>
        <?supplied-pmid 30926968?>
        <pub-id pub-id-type="pmid">30926968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>821</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2310</pub-id>
        <?supplied-pmid 22706312?>
        <pub-id pub-id-type="pmid">22706312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>P-R</given-names>
          </name>
          <name>
            <surname>Kichaev</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gazal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mixed-model association for biobank-scale datasets</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>906</fpage>
        <lpage>908</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0144-6</pub-id>
        <?supplied-pmid 29892013?>
        <pub-id pub-id-type="pmid">29892013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henderson</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Estimation of variance and covariance components</article-title>
        <source>Biometrics</source>
        <year>1953</year>
        <volume>9</volume>
        <fpage>226</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="doi">10.2307/3001853</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Computing inbreeding coefficients in large populations</article-title>
        <source>Genet Sel Evol</source>
        <year>1992</year>
        <volume>24</volume>
        <fpage>305</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-24-4-305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
        <source>Genetics</source>
        <year>2001</year>
        <volume>157</volume>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <pub-id pub-id-type="doi">10.1093/genetics/157.4.1819</pub-id>
        <?supplied-pmid 11290733?>
        <pub-id pub-id-type="pmid">11290733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schenkel</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vinsky</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accuracy of predicting genomic breeding values for residual feed intake in Angus and Charolais beef cattle</article-title>
        <source>J Anim Sci</source>
        <year>2013</year>
        <volume>91</volume>
        <fpage>4669</fpage>
        <lpage>4678</lpage>
        <pub-id pub-id-type="doi">10.2527/jas.2013-5715</pub-id>
        <?supplied-pmid 24078618?>
        <pub-id pub-id-type="pmid">24078618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Wientjes Y, Bijma P, Vandenplas J, et al. Multi-population genomic relationships for estimating current genetic variances within and genetic correlations between populations. Genetics 2017; genetics.300152.2017</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mapping quantitative trait loci by controlling polygenic background effects</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>195</volume>
        <fpage>1209</fpage>
        <lpage>1222</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.113.157032</pub-id>
        <?supplied-pmid 24077303?>
        <pub-id pub-id-type="pmid">24077303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Legarra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguilar</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Misztal</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>A relationship matrix including full pedigree and genomic information</article-title>
        <source>J Dairy Sci</source>
        <year>2009</year>
        <volume>92</volume>
        <fpage>4656</fpage>
        <lpage>4663</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2009-2061</pub-id>
        <?supplied-pmid 19700729?>
        <pub-id pub-id-type="pmid">19700729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic predictions: a review 10 years on</article-title>
        <source>Front Genet</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>865765</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2022.865765</pub-id>
        <?supplied-pmid 35938022?>
        <pub-id pub-id-type="pmid">35938022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Li Z, Gao N, Martini JWR, et al. Integrating gene expression data into genomic prediction. Front. Genet. 2019; 10:</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEPIS: a pipeline for estimating epistatic effects in quantitative trait locus mapping and genome-wide association studies</article-title>
        <source>PLOS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1004925</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004925</pub-id>
        <?supplied-pmid 27224861?>
        <pub-id pub-id-type="pmid">27224861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ABO genotype alters the gut microbiota by regulating GalNAc levels in pigs</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>606</volume>
        <fpage>358</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04769-z</pub-id>
        <?supplied-pmid 35477154?>
        <pub-id pub-id-type="pmid">35477154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Consortium TF-P, Teng J, Gao Y, et al. A compendium of genetic regulatory effects across pig tissues. 2022; 2022.11.11.516073</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Zhao W, Zhang Z, Ma P, et al. The effect of high-density genotypic data and different methods on joint genomic prediction: a case study in large white pigs. Anim. Genet. n/a:</mixed-citation>
    </ref>
  </ref-list>
</back>
