<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">RNA</journal-id>
    <journal-id journal-id-type="iso-abbrev">RNA</journal-id>
    <journal-id journal-id-type="publisher-id">RNA</journal-id>
    <journal-title-group>
      <journal-title>RNA</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1355-8382</issn>
    <issn pub-type="epub">1469-9001</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6348988</article-id>
    <article-id pub-id-type="pmid">30420522</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="publisher-id">RA</article-id>
    <article-id pub-id-type="doi">10.1261/rna.067678.118</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Barnaba: software for analysis of nucleic acid structures and trajectories</article-title>
      <alt-title alt-title-type="left-running">Bottaro et al.</alt-title>
      <alt-title alt-title-type="right-running">A Python library for analyzing RNA simulations</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1606-890X</contrib-id>
        <name>
          <surname>Bottaro</surname>
          <given-names>Sandro</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9216-5782</contrib-id>
        <name>
          <surname>Bussi</surname>
          <given-names>Giovanni</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pinamonti</surname>
          <given-names>Giovanni</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1224-6967</contrib-id>
        <name>
          <surname>Reißer</surname>
          <given-names>Sabine</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8257-3827</contrib-id>
        <name>
          <surname>Boomsma</surname>
          <given-names>Wouter</given-names>
        </name>
        <xref ref-type="aff" rid="af4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4750-6039</contrib-id>
        <name>
          <surname>Lindorff-Larsen</surname>
          <given-names>Kresten</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Structural Biology and NMR Laboratory and Linderstrøm-Lang Centre for Protein Science, Department of Biology, University of Copenhagen, Copenhagen 2200, Denmark</aff>
    <aff id="af2"><label>2</label>International School for Advanced Studies, 34136 Trieste, Italy</aff>
    <aff id="af3"><label>3</label>Department of Mathematics and Computer Science, Freie Universität, 14195 Berlin, Germany</aff>
    <aff id="af4"><label>4</label>Department of Computer Science, University of Copenhagen, Copenhagen 2200, Denmark</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>sandro.bottaro@iit.it</email>, <email>bussi@sissa.it</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <volume>25</volume>
    <issue>2</issue>
    <fpage>219</fpage>
    <lpage>231</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>11</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/site/misc/terms.xhtml">© 2019 Bottaro et al.; Published by Cold Spring Harbor Laboratory Press for the RNA Society</ext-link>
      </copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by the RNA Society for the first 12 months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://rnajournal.cshlp.org/site/misc/terms.xhtml">http://rnajournal.cshlp.org/site/misc/terms.xhtml</ext-link>). After 12 months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="219.pdf"/>
    <abstract>
      <p>RNA molecules are highly dynamic systems characterized by a complex interplay between sequence, structure, dynamics, and function. Molecular simulations can potentially provide powerful insights into the nature of these relationships. The analysis of structures and molecular trajectories of nucleic acids can be nontrivial because it requires processing very high-dimensional data that are not easy to visualize and interpret. Here we introduce Barnaba, a Python library aimed at facilitating the analysis of nucleic acid structures and molecular simulations. The software consists of a variety of analysis tools that allow the user to (i) calculate distances between three-dimensional structures using different metrics, (ii) back-calculate experimental data from three-dimensional structures, (iii) perform cluster analysis and dimensionality reductions, (iv) search three-dimensional motifs in PDB structures and trajectories, and (v) construct elastic network models for nucleic acids and nucleic acids–protein complexes. In addition, Barnaba makes it possible to calculate torsion angles, pucker conformations, and to detect base-pairing/base-stacking interactions. Barnaba produces graphics that conveniently visualize both extended secondary structure and dynamics for a set of molecular conformations. The software is available as a command-line tool as well as a library, and supports a variety of file formats such as PDB, dcd, and xtc files. Source code, documentation, and examples are freely available at <uri xlink:href="https://github.com/srnas/barnaba">https://github.com/srnas/barnaba</uri> under GNU GPLv3 license.</p>
    </abstract>
    <kwd-group>
      <kwd>MD trajectories</kwd>
      <kwd>molecular dynamics</kwd>
      <kwd>RNA 3D structure</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>The Velux Foundations</funding-source>
      </award-group>
      <award-group id="funding-2">
        <funding-source>Hallas-Møller Stipend</funding-source>
      </award-group>
      <award-group id="funding-3">
        <funding-source>
          <institution-wrap>
            <institution>Novo Nordisk Foundation </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100009708</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-4">
        <funding-source>Lundbeck Foundation BRAINSTRUC initiative</funding-source>
      </award-group>
      <award-group id="funding-5">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council (ERC) </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-6">
        <funding-source>European Union's Seventh Framework Programme</funding-source>
        <award-id>FP/2007-2013</award-id>
        <award-id>306662</award-id>
        <award-id>S-RNA-S</award-id>
      </award-group>
      <award-group id="funding-7">
        <funding-source>
          <institution-wrap>
            <institution>Villum Fonden </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100008398</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>VKR023445</award-id>
      </award-group>
      <award-group id="funding-8">
        <funding-source>
          <institution-wrap>
            <institution>Danish Council for Independent Research </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100004836</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DFF-4181-00344</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="s1">
    <title>INTRODUCTION</title>
    <p>Despite their simple four-letter alphabet, RNA molecules can adopt amazingly complex three-dimensional architectures. RNA structure is often described in terms of a few simple degrees of freedom such as backbone torsion angles, sugar puckering, base–base interactions, and helical parameters (<xref rid="RNA067678BOTC13" ref-type="bibr">Dickerson 1989</xref>; <xref rid="RNA067678BOTC27" ref-type="bibr">Leontis and Westhof 2001</xref>; <xref rid="RNA067678BOTC43" ref-type="bibr">Richardson et al. 2008</xref>). Given a known three-dimensional structure, the calculation of these properties can be accurately performed using available tools such as MC-annotate (<xref rid="RNA067678BOTC16" ref-type="bibr">Gendron et al. 2001</xref>), 3DNA (<xref rid="RNA067678BOTC29" ref-type="bibr">Lu and Olson 2008</xref>), fr3D (<xref rid="RNA067678BOTC46" ref-type="bibr">Sarver et al. 2008</xref>), or DSSR (<xref rid="RNA067678BOTC30" ref-type="bibr">Lu et al. 2015</xref>). These software packages allow for a detailed description of experimentally derived RNA structures, but are less suitable for analyzing and comparing large numbers of three-dimensional conformations.</p>
    <p>The importance of large-scale analysis tools is critical when considering that many RNA molecules are not static, but highly dynamic entities, and multiple conformations are required to describe their properties. In molecular dynamics (MD) simulations (<xref rid="RNA067678BOTC48" ref-type="bibr">Šponer et al. 2018</xref>), for example, it is often necessary to analyze several hundreds of thousands of structures. The analysis and comparison of results from structure–prediction algorithms poses similar challenges (<xref rid="RNA067678BOTC12" ref-type="bibr">Dawson and Bujnicki 2016</xref>; <xref rid="RNA067678BOTC31" ref-type="bibr">Magnus 2016</xref>; <xref rid="RNA067678BOTC35" ref-type="bibr">Miao et al. 2017</xref>). In order to rationalize and generate scientific insights, it is therefore fundamental to use specific analysis and visualization tools that can handle such highly dimensional data. This need has been long recognized in the field of protein simulations, leading to the development of several software packages for the analysis of MD trajectories (<xref rid="RNA067678BOTC36" ref-type="bibr">Michaud-Agrawal et al. 2011</xref>; <xref rid="RNA067678BOTC33" ref-type="bibr">McGibbon et al. 2015</xref>; <xref rid="RNA067678BOTC50" ref-type="bibr">Tiberti et al. 2015</xref>). While these software packages can be in principle used to analyze generic simulations, they do not support the calculation of nucleic acids-specific quantities out of the box. Notable exceptions are CPPTRAJ (<xref rid="RNA067678BOTC44" ref-type="bibr">Roe and Cheatham 2013</xref>) and the driver tool in PLUMED (<xref rid="RNA067678BOTC52" ref-type="bibr">Tribello et al. 2014</xref>), which support the calculation of nucleic acids structural properties, among other features.</p>
    <p>A limited number of software packages have been developed with the main purpose of analyzing simulations of nucleic acids. Curves+ (<xref rid="RNA067678BOTC25" ref-type="bibr">Lavery et al. 2009</xref>) calculates parameters in DNA/RNA double helices as well as torsion backbone angles. <italic>do</italic><sub><italic>x</italic></sub><sub>3<italic>dna</italic></sub> (<xref rid="RNA067678BOTC23" ref-type="bibr">Kumar and Grubmüller 2015</xref>) extends the capability of the 3DNA package to calculate several base pairs/helical parameters and torsion angles from GROMACS (<xref rid="RNA067678BOTC1" ref-type="bibr">Abraham et al. 2015</xref>) trajectories. The detection of hydrogen bonds/stacking in simulations and the identification of motifs such as helices, junctions, loops, and pseudoknots can be performed using the Motif Identifier for Nucleic acids Trajectory (MINT) software (<xref rid="RNA067678BOTC17" ref-type="bibr">Górska et al. 2015</xref>).</p>
    <p>Here we present Barnaba, a Python library to analyze nucleic acid structures and trajectories. The library contains routines to calculate various structural parameters (e.g., distances, torsion angles, base-pair, and base-stacking detection), to perform dimensionality reduction and clustering, to back-calculate experimental quantities from structures, and to construct elastic network models (ENM). Barnaba utilizes the capabilities of MDTraj (<xref rid="RNA067678BOTC33" ref-type="bibr">McGibbon et al. 2015</xref>) for reading/writing trajectory files, and thus supports many different formats, including PDB, dcd, xtc, and trr.</p>
    <p>In this paper, we show the capabilities of Barnaba by analyzing a long MD simulation of an RNA stem–loop structure. We first calculate distances from a reference frame. Second, we consider a subset of dihedral angles and compare <sup>3</sup><italic>J</italic> scalar couplings calculated from simulations with nuclear magnetic resonance (NMR) data. We then perform a cluster analysis of the trajectory, identifying a number of clusters that are visualized using a dynamic secondary structure representation. Finally, we search for structural motifs similar to cluster centroids in the entire protein data bank (PDB) database. In addition, we show how to construct an elastic network model (ENM) of RNA molecules and protein–nucleic acid complexes with Barnaba, and how to use it to estimate RNA local fluctuations. Source code and documentation are freely available at <uri xlink:href="https://github.com/srnas/barnaba">https://github.com/srnas/barnaba</uri> under GNU GPLv3 license.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <p>First we provide a list of tools for the analysis of nucleic acid three-dimensional structures supported in Barnaba. All the calculations can be executed from the command-line, as described in <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 1</ext-link>. For each functionality, practical examples are provided in <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material</ext-link> and in the documentation:
<list list-type="order"><list-item><p>Calculate the eRMSD (<xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. 2014</xref>) between structures (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 2</ext-link>).</p></list-item><list-item><p>Calculate the heavy-atom/backbone-only root mean squared distance (RMSD) after optimal superposition (<xref rid="RNA067678BOTC21" ref-type="bibr">Kabsch 1976</xref>) between structures (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 2</ext-link>).</p></list-item><list-item><p>Calculate the relative position and orientations between nucleobases (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 3</ext-link>).</p></list-item><list-item><p>Identify base-pairing and base-stacking interactions in structures and trajectories (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 4</ext-link>).</p></list-item><list-item><p>Calculate backbone, sugar, and pseudorotation torsion angles (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 5</ext-link>).</p></list-item><list-item><p>Back-calculate <sup>3</sup><italic>J</italic> scalar couplings from structures (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 6</ext-link>).</p></list-item><list-item><p>Search for single-stranded and double-stranded three-dimensional motifs within PDB structures or trajectories (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 7, 8</ext-link>).</p></list-item><list-item><p>Extract fragments with a given sequence from PDB structures. This can be useful to investigate the conformational variability of RNA at a fixed sequence or to perform a stop-motion modeling (SMM) analysis (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 9</ext-link>; <xref rid="RNA067678BOTC7" ref-type="bibr">Bottaro et al. 2016b</xref>).</p></list-item><list-item><p>Perform cluster analysis of RNA structures using the eRMSD (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 10</ext-link>).</p></list-item><list-item><p>Generate “dynamic secondary structure” figures that display the extended secondary structure, together with the population of each interaction within a collection of three-dimensional structures (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 11</ext-link>).</p></list-item><list-item><p>Construct ENM of RNA molecules and protein–nucleic acid complexes (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 12</ext-link>).</p></list-item><list-item><p>Calculate the scoring function eSCORE (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 13</ext-link>; <xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. 2014</xref>; <xref rid="RNA067678BOTC41" ref-type="bibr">Poblete et al. 2018</xref>).</p></list-item></list></p>
    <p>In the following, we present the different features of Barnaba by analyzing a 180 µsec long simulation of an RNA 14-mers with sequence GGCACUUCGGUGCC performed by <xref rid="RNA067678BOTC49" ref-type="bibr">Tan et al. (2018)</xref> using a simulated tempering protocol where the temperature is used as a dynamic variable to enhance sampling. Experimentally, this sequence is known to form an A-form stem composed of five consecutive Watson–Crick base pairs, capped by a UUCG tetraloop (<xref ref-type="fig" rid="RNA067678BOTF1">Fig. 1</xref>A). In order to make the results described in this paper fully reproducible, we provide in <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 14</ext-link> the Jupyter Notebooks to conduct the analyses and to produce the figures described below.</p>
    <fig id="RNA067678BOTF1" orientation="portrait" position="float">
      <label>FIGURE 1.</label>
      <caption>
        <p>(<italic>A</italic>) Extended secondary structure representation of the UUCG stem–loop. Watson–Crick base pairs are shown in blue; <italic>trans</italic>-Sugar-Watson base pair between U6 and G9 is shown in red. (<italic>B</italic>) RMSD from native over time of the UUCG simulation. The corresponding histogram is shown in the <italic>right</italic> panel. The dashed line at RMSD = 0.23 nm separates native-like from nonnative-like structures. The colors indicate the presence of native base–base interactions, as shown in the secondary structure representation. Structures where all Watson–Crick interactions in the stem and the <italic>trans</italic>-Sugar-Watson base pair in loop are formed are shown in red. Blue indicates structures where only the stem is formed. All other conformations are shown in gray. (<italic>C</italic>) eRMSD from native structure over time. Color scheme is identical to panel <italic>B</italic>. Dashed line at eRMSD = 0.7 separates native-like from nonnative conformations.</p>
      </caption>
      <graphic xlink:href="219f01"/>
    </fig>
    <sec id="s2a">
      <title>RMSD, eRMSD calculation, and detection of base–base interactions</title>
      <p>We start the analysis by calculating the distance of each frame in the simulation from the reference experimental structure (PDB code 2KOC, <xref rid="RNA067678BOTC37" ref-type="bibr">Nozinovic et al. 2010</xref>) and detecting base–base interactions. <xref ref-type="fig" rid="RNA067678BOTF1">Figure 1</xref>B shows the time series of heavy-atom RMSD after optimal superposition (<xref rid="RNA067678BOTC21" ref-type="bibr">Kabsch 1976</xref>). During this simulation, multiple folding events occur: In line with previous analyses (<xref rid="RNA067678BOTC49" ref-type="bibr">Tan et al. 2018</xref>), we thus observe both structures close to the reference as well as unfolded/misfolded ones. We identify the base–base interactions in each frame using the annotation functionality in Barnaba (see Materials and Methods). Structures where the stem is completely formed together with the native <italic>trans</italic>-sugar-Watson (tSW) interaction between U6 and G9 in the loop are shown in red. Blue points indicate structures in which all base pairs in the stem, but not in the loop, are present. All the other structures are colored in gray. From the histogram in <xref ref-type="fig" rid="RNA067678BOTF1">Figure 1</xref>B, it can be seen that RMSD &lt; 0.23 nm roughly corresponds to native-like structures. A second sharp peak around 0.3 nm corresponds to structures in which only the stem is correctly formed. All other conformations have RMSD larger than 0.6 nm.</p>
      <p>One of the features of Barnaba is the possibility to calculate the eRMSD (<xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. 2014</xref>). The eRMSD only considers the relative arrangements between nucleobases in a molecule, and quantifies the differences in the interaction network between two structures. In this perspective, eRMSD is similar to the Interaction Fidelity Network (<xref rid="RNA067678BOTC38" ref-type="bibr">Parisien et al. 2009</xref>) that quantifies the discrepancy in the set of base-pairs and base-stacking interactions. The eRMSD, however, is a continuous, symmetric, positive definite metric distance that satisfies the triangular inequality. Additionally, it does not require detection of the interactions (annotation) and is hence particularly well suited for analyzing MD trajectories and unstructured RNA molecules. <xref ref-type="fig" rid="RNA067678BOTF1">Figure 1</xref>C shows the eRMSD from native for the UUCG simulation. We notice that, similarly to the RMSD case, the histogram displays three main peaks. In this case, the correspondence between peaks and structures can be readily identified: when eRMSD &lt; 0.7, native stem and loop are formed; if 0.7 &lt; eRMSD &lt; 1.3, stem is formed but the loop is in a nonnative configuration. Other structures typically have eRMSD &gt; 1.3. We observe that the separation between the two main peaks (native structure, red; native stem, blue) is sharper in <xref ref-type="fig" rid="RNA067678BOTF1">Figure 1</xref>C, confirming that eRMSD is more suitable than RMSD to distinguish structures with different base-pairings (<xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. 2014</xref>).</p>
      <p>Note that a significant number of low-RMSD/eRMSD structures lack one or more native base-pair interactions, and are therefore shown in gray. This is because the detection of base–base interactions critically depends on a set of geometrical parameters (e.g., distance, base–base orientation, etc.) that were calibrated on high-resolution structures. The criteria used in Barnaba (as well as the ones used in other annotation tools) may not always be accurate when considering intermediate states and partially formed interactions that are often observed in molecular simulations (<xref rid="RNA067678BOTC26" ref-type="bibr">Lemieux and Major 2002</xref>).</p>
    </sec>
    <sec id="s2b">
      <title>Transition paths</title>
      <p>We now analyze the folding/unfolding paths in order to understand what is the nature and order of events leading to folding. In particular, we consider the formation of the native base pairs in the stem and the rotameric state of the <italic>χ</italic> angle in G9 that is related to the formation of the Sugar-Watson base pair between G9 and U6. Following <xref rid="RNA067678BOTC28" ref-type="bibr">Lindorff-Larsen et al. (2011)</xref>, we extract the transition paths (TP) from the simulation, resulting in four folding and four unfolding events. The time evolution for one of the folding events is shown in <xref ref-type="fig" rid="RNA067678BOTF2">Figure 2</xref>A,B. In the unfolded state, no base pairs are formed and <italic>χ</italic> freely fluctuates from <italic>anti</italic> to <italic>syn</italic>. The three base pairs at the termini form early during the TP, followed by the other two Watson–Crick base pairs. When the native state is reached, all native base pairs are formed, and <italic>χ</italic> is in <italic>syn</italic> conformation.</p>
      <fig id="RNA067678BOTF2" orientation="portrait" position="float">
        <label>FIGURE 2.</label>
        <caption>
          <p>Formation of base pairs and G9-<italic>χ</italic> angle during RNA folding. (<italic>A</italic>) Formation of the five WC base pairs over time and of the tSW interaction during one of the folding events. Green indicates that the interaction is formed; gray, not formed. Nonnative interactions are shown in red. (<italic>B</italic>) Time evolution of the <italic>χ</italic> angle in G9 for the same folding event shown in panel <italic>A</italic>. (<italic>C</italic>) Order of events relative to the formation of the native base pairs and transition to <italic>syn</italic>. High values correspond to early formation of the corresponding quantity during a folding event. The average over each TP is shown as a gray dot, and the average over the eight TPs is shown as a red bar.</p>
        </caption>
        <graphic xlink:href="219f02"/>
      </fig>
      <p>The order of the events can be quantified by calculating the average presence of base pair (assuming values of 1 = formed or 0 = not formed) and the normalized distance from <italic>syn</italic> conformation <italic>q</italic> = 0.5(1 + cos (χ − 63°)). Quantities that reach a native-like value (i.e., one) early during folding have a high value, and those that form late get a low value (<xref rid="RNA067678BOTC28" ref-type="bibr">Lindorff-Larsen et al. 2011</xref>). In <xref ref-type="fig" rid="RNA067678BOTF2">Figure 2</xref>C, we can see that the Watson–Crick 1–14, 2–13, 3–12 form very early in folding, followed by 4–11 and 3–10.The transition of the <italic>χ</italic> angle to <italic>syn</italic> occurs at a later stage, and folding is finally achieved with the formation of the tSW base pair.</p>
      <p>The TP analysis is here performed for illustrative purposes. In real applications, it is important to take into consideration a number of aspects, such as the quality of the force-field, the assumption that the simulated tempering trajectory is compatible with the real folding pathway, and the employed criteria defining folded/unfolded states (<xref rid="RNA067678BOTC28" ref-type="bibr">Lindorff-Larsen et al. 2011</xref>). Note also that this type of analysis is carried out to describe the properties on the energy barrier, while we here describe the properties of the intermediate state.</p>
    </sec>
    <sec id="s2c">
      <title>Torsion angle and <sup>3</sup><italic>J</italic> scalar coupling calculations</title>
      <p>Another important class of structural parameters is torsion angles. Similarly to other software, Barnaba contains routines to calculate backbone torsion angles (<italic>α</italic>, <italic>β</italic>, <italic>γ</italic>, <italic>ε</italic>, <italic>ζ</italic>), the glycosidic angle <italic>χ</italic>, and the pseudorotation sugar parameters (<xref rid="RNA067678BOTC2" ref-type="bibr">Altona and Sundaralingam 1972</xref>; <xref rid="RNA067678BOTC42" ref-type="bibr">Rao et al. 1981</xref>).</p>
      <p>In <xref ref-type="fig" rid="RNA067678BOTF3">Figure 3</xref>, left panels, we plot the probability distributions of four angles (<italic>β</italic>, <italic>γ</italic>, <italic>δ</italic>, <italic>ε</italic>) for three different residues: U6, U7, and G9. We can see from the distribution of <italic>γ</italic> angles that U6 and U7 mainly populate the <italic>gauche</italic><sup>+</sup> rotameric state (0° &lt; γ ≤ 120°), while G9 significantly populates the <italic>trans</italic> state as well (120° &lt; γ ≤ 240°). Different rotameric states can also be seen from the distribution of <italic>δ</italic> angles (C2′/C3′-endo) and <italic>ε</italic>, which are related to BI/BII states. Here, we consider the same trajectory of the UUCG tetraloops described above and removed all the unfolded structures, i.e., structures with eRMSD from native larger than 1.5 (≈6000 out of 20,000), because we below compare to experiments under conditions where these are absent.</p>
      <fig id="RNA067678BOTF3" orientation="portrait" position="float">
        <label>FIGURE 3.</label>
        <caption>
          <p>(<italic>Left</italic> panels) Torsion angle distribution for <italic>β</italic>, <italic>γ</italic>, <italic>δ</italic>, and <italic>ε</italic> in residues U6, U7, and G9. <italic>Right</italic> panels show the experimental <sup>3</sup><italic>J</italic> couplings (crosses) and the calculated value from simulation (dots). The error bars indicate the standard error of the mean calculated over four blocks.</p>
        </caption>
        <graphic xlink:href="219f03"/>
      </fig>
      <p>In this example, we chose these specific torsion angles because their distribution is related to available <sup>3</sup><italic>J</italic> couplings experimental data from NMR spectroscopy. The magnitude of <sup>3</sup><italic>J</italic> coupling depends on the distance between atoms connected by three bonds, and thus on the corresponding dihedral angle distribution. The dependence between angle <italic>θ</italic> and coupling <sup>3</sup><italic>J</italic> can be calculated via Karplus equations:
<disp-formula><mml:math id="UM1"><mml:mmultiscripts><mml:mi>J</mml:mi><mml:mprescripts/><mml:none/><mml:mn>3</mml:mn></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mi>cos</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>A</italic>, <italic>B</italic>, <italic>C</italic> are empirical parameters. Couplings corresponding to different angles can be calculated with Barnaba. H1′-H2′, H2′-H3′, H3′-H4′ (sugar conformation), H5′-P, H5″-P, C4-P (<italic>β</italic>), H4′-H5′, H4′-H5″ (<italic>γ</italic>), H3-P(+1), C4-P(+1) (<italic>ε</italic>), H1′-C8/C6, and H1′-C4/C2 (<italic>χ</italic>). The complete list of Karplus parameters is reported in the Materials and Methods section, and may be changed within Barnaba.</p>
      <p><xref ref-type="fig" rid="RNA067678BOTF3">Figure 3</xref>, right panels, shows the back-calculated average <sup>3</sup><italic>J</italic> couplings and the corresponding experimental value reported in <xref rid="RNA067678BOTC37" ref-type="bibr">Nozinovic et al. (2010)</xref>. Note that in some cases, experiments and simulations do not agree: This is because the simulation was performed at different temperatures using a simulated tempering protocol, and therefore the comparison between simulations and experiments is here made for illustrative purposes only. Significant discrepancies could originate from errors introduced by the Karplus equations that can be as large as 2 Hz (<xref rid="RNA067678BOTC8" ref-type="bibr">Bottaro et al. 2018</xref>).</p>
    </sec>
    <sec id="s2d">
      <title>Cluster analysis</title>
      <p>The structures within a trajectory can be grouped into clusters of mutually similar conformations, to understand which different states are visited and how often. For clustering we use the DBSCAN (<xref rid="RNA067678BOTC14" ref-type="bibr">Ester et al. 1996</xref>) algorithm with <italic>ε</italic> = 0.12 and min samples = 70 (<xref rid="RNA067678BOTC4" ref-type="bibr">Bottaro and Lindorff-Larsen 2017</xref>). As in the previous example, structures with eRMSD &gt; 1.5 from native are discarded. <xref ref-type="fig" rid="RNA067678BOTF4">Figure 4</xref>A shows the trajectory projected onto the first two components of a principal component analysis done on the collection of <bold>G</bold>-vectors (<xref rid="RNA067678BOTC4" ref-type="bibr">Bottaro and Lindorff-Larsen 2017</xref>). Circles show the resulting nine clusters, whose radius is proportional to the square root of their size. The 5500 structures (40%) that were not assigned to any cluster are shown as gray dots. For each cluster, we identify its centroid, here defined as the structure with the lowest average distance from all other cluster members.</p>
      <fig id="RNA067678BOTF4" orientation="portrait" position="float">
        <label>FIGURE 4.</label>
        <caption>
          <p>Example of a cluster analysis on the UUCG stem–loop trajectory. (<italic>A</italic>) Principal component analysis on the collection of <bold>G</bold>-vectors (<xref rid="RNA067678BOTC4" ref-type="bibr">Bottaro and Lindorff-Larsen 2017</xref>). Each circle corresponds to a cluster; gray dots show unassigned structures. Circles are centered in the centroid positions, and the radii are proportional to the square root of the population. The percentage of explained variance of the first two components is indicated on the axes. (<italic>B</italic>) Box-plots reporting eRMSD (<italic>top</italic>) and RMSD (<italic>bottom</italic>) from cluster centroids. <italic>Lower/upper</italic> hinges correspond to the first and third quartiles, while whiskers indicate lowest/highest data within 1.5 interquartile range. Data beyond the end of the whiskers are shown individually. The percentages indicate the cluster population. (<italic>C</italic>) Dynamic secondary structure representation of the 20 native NMR conformers (PDB 2KOC) and of the first three clusters. The extended secondary structure annotation follows the Leontis–Westhof classification. The color scheme shows the fraction of frames within a cluster for which the interaction is formed.</p>
        </caption>
        <graphic xlink:href="219f04"/>
      </fig>
      <p>Ideally, clusters should be compact enough so that the centroid can be considered as a representative structure. This information is shown in the box-plot in <xref ref-type="fig" rid="RNA067678BOTF4">Figure 4</xref>B, which reports the distances (eRMSD and RMSD, as labeled) between centroids and cluster members. At the same time, structures within clusters are not all identical to one another. In order to visualize the intracluster variability, we have found it useful to introduce a “dynamic secondary structure” representation. In essence, we detect base-stacking/base-pair interactions in all structures within a cluster, and calculate the fraction of frames in which each interaction is present. The population of each interaction is shown by coloring the extended secondary structure representation (<xref ref-type="fig" rid="RNA067678BOTF4">Fig. 4</xref>C). This representation has some analogy with the “dot plot” representation used to display secondary structure ensembles obtained using nearest neighbor models that reports the predicted probability of individual base pairs (<xref rid="RNA067678BOTC20" ref-type="bibr">Jacobson and Zuker 1993</xref>). We can see that the first three clusters correspond to three different tetraloop structures. In cluster 1, the U6-G9 tSW base pair is present, together with the U6-C8 stacking typical of the native UUCG tetraloop structure. In cluster 2, no U6-G9 base pair is present, while in cluster 3 we observe stacking between U6-U7-C8-G9, as also described in the next section. In all clusters, the population of the terminal base pairs and stacking is lower than one, indicating the presence of base fraying.</p>
      <p>In our experience, cluster analysis is useful to understand and qualitatively visualize the different types of structures in a simulation. In many practical cases, however, the number of clusters and their population may differ depending on the employed clustering algorithm and associated parameters. Clustering may not even be meaningful when considering highly unstructured systems such as long single-stranded nucleic acids lacking secondary structures (<xref rid="RNA067678BOTC9" ref-type="bibr">Chen et al. 2012</xref>).</p>
    </sec>
    <sec id="s2e">
      <title>Motif search</title>
      <p>Barnaba can be used to search for structural motifs in a PDB file or trajectory using the eRMSD distance. In the following example, we illustrate this feature by taking the centroids of the first three clusters described above and search for similar structures within the PDB database. In order to focus on the loop structure, rather than on stem variability, we consider the tetraloop and the two closing base pairs for the search (residues 4–11 in <xref ref-type="fig" rid="RNA067678BOTF1">Fig. 1</xref>A). The search is performed against all RNA-containing structures in the PDB database (retrieved May 4, 2018, resolution 3.5 Å or better). The database considered here consists of 3067 X-ray, 652 NMR, and 177 cryo electron-microscopy (EM) structures. Note that the search is purely based on the geometrical arrangement of nucleobases, without restriction on the sequence, a particular feature that is also enabled by the use of eRMSD.</p>
      <p><xref ref-type="fig" rid="RNA067678BOTF5">Figure 5</xref> shows the cluster centroids (gray) and the closest motif match, i.e., the lowest eRMSD substructure in the PDB database (orange). The eRMSD between the cluster centroid and the best match are indicated, together with the associated PDB code. Centroid 1 corresponds to the canonical UUCG tetraloop structure, with the signature tSW interaction between U6-G9 and G9 in syn conformation. Note that the eRMSD between centroid and best match is small (0.25), indicating that simulated and experimental structures are highly similar. Cluster 2 corresponds to a structure in which the stem is formed, C8 is stacked on top of U6, and G9 is bulged out. Centroid 3 features four consecutive stackings between U6-U7-C8-G9-G10. Note that this latter structure is remarkably similar to the four-stack loop described in <xref rid="RNA067678BOTC4" ref-type="bibr">Bottaro and Lindorff-Larsen (2017)</xref>.</p>
      <fig id="RNA067678BOTF5" orientation="portrait" position="float">
        <label>FIGURE 5.</label>
        <caption>
          <p>Motif search in PDB database. (<italic>Top</italic> panels) Centroids of the first three clusters (in gray) superimposed on the closest structures from the PDB database (orange). eRMSD between centroid and the best match are indicated, together with the associated PDB code. (<italic>Bottom</italic> panels) eRMSD distribution between centroid and substructures from PDB database. Note that different distributions are obtained for different clusters, meaning that the eRMSD threshold varies depending on the motif. Distances larger than eRMSD = 1 are not reported. The eRMSD threshold at 0.7 (centroids 1, 2) and 0.9 (centroid 3) is indicated as a dashed line.</p>
        </caption>
        <graphic xlink:href="219f05"/>
      </fig>
      <p>As a rule of thumb, we consider as significant matches structures below 0.7 eRMSD, but there are cases in which it is worth considering structures in the 0.7–1.0 eRMSD range as well. More generally, it is useful to consider the histogram of all fragments with eRMSD below 1, as shown in <xref ref-type="fig" rid="RNA067678BOTF5">Figure 5</xref>, bottom panels. This type of analysis makes it possible to identify a good threshold value, in correspondence to minima in the probability distributions. For example, there are no structures in the PDB with eRMSD lower than 0.7 for centroid 3. In this case, a value of 0.9 should be used instead.</p>
      <p>In this example, we performed a simple search of a structure from simulation against experimentally derived structures in the PDB database. In Barnaba, any arbitrary motif can be used as a query by providing a coordinate file with at least the position of C2, C4, and C6 atoms for each nucleotide. Searches with more complex motifs composed by two strands (e.g., K-turns, sarcin-ricin motifs, etc.) are also possible (<ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 8</ext-link>). Additionally, Barnaba allows for inserted bases, thereby identifying structural motifs with one or more bulged-out bases.</p>
    </sec>
    <sec id="s2f">
      <title>Elastic network models</title>
      <p>Elastic network models (ENMs) are minimal computational models able to capture the dynamics of macromolecules at a small computational cost. They assume that the system can be represented as a set of beads connected by harmonic springs, each having rest length equal to the distance between the two beads it connects in a reference structure (usually, an experimental structure from the PDB). First introduced to analyze protein dynamics (<xref rid="RNA067678BOTC51" ref-type="bibr">Tirion 1996</xref>), ENMs are also applicable to structured RNA molecules (<xref rid="RNA067678BOTC3" ref-type="bibr">Bahar and Jernigan 1998</xref>; <xref rid="RNA067678BOTC47" ref-type="bibr">Setny and Zacharias 2013</xref>; <xref rid="RNA067678BOTC56" ref-type="bibr">Zimmermann and Jernigan 2014</xref>). Barnaba contains routines to construct ENM of nucleic acids and proteins, and, as a unique feature, makes it possible to calculate fluctuations between consecutive C2–C2 atoms. In a previous work (<xref rid="RNA067678BOTC39" ref-type="bibr">Pinamonti et al. 2015</xref>), we have shown this quantity to correlate with flexibility measurements performed with selective 2-hydroxyl acylation analyzed by primer extension (SHAPE) experiments (<xref rid="RNA067678BOTC34" ref-type="bibr">Merino et al. 2005</xref>). Here, we show an example of ENM analysis on two RNA molecules: the 174-nt sensing domain of the <italic>Thermotoga maritima</italic> lysine riboswitch (PDB ID: 3DIG), and the <italic>Escherichia coli</italic> 5S rRNA (PDB ID: 1C2X). We construct an all-atom ENM (AA-ENM), where each heavy atom is a bead, together with a cutoff radius of 7 Å. In <xref ref-type="fig" rid="RNA067678BOTF6">Figure 6</xref>, we show the flexibility of the RNA molecules as predicted by the ENM (black) that can be qualitatively compared with the measured SHAPE reactivity (<xref rid="RNA067678BOTC18" ref-type="bibr">Hajdin et al. 2013</xref>) (orange).</p>
      <fig id="RNA067678BOTF6" orientation="portrait" position="float">
        <label>FIGURE 6.</label>
        <caption>
          <p>C2–C2 fluctuations as predicted by the ENM of lysine riboswitch (<italic>bottom</italic> panel) and 5S rRNA (<italic>top</italic> panel). SHAPE reactivity data from <xref rid="RNA067678BOTC18" ref-type="bibr">Hajdin et al. (2013)</xref> are shown for comparison. Pearson's correlation coefficient <italic>r</italic> between SHAPE data and ENM-predicted fluctuations is also indicated.</p>
        </caption>
        <graphic xlink:href="219f06"/>
      </fig>
      <p>The implementation of the ENM in Barnaba uses the sparse matrix package available in Scipy, which allows for significant speed-ups compared to the dense-matrix implementation. <xref ref-type="fig" rid="RNA067678BOTF7">Figure 7</xref> shows the execution time for constructing ENMs of biomolecules with sizes ranging from a few tens to several hundreds of nucleotides. Calculations were performed running Barnaba on a personal computer. This, combined with the significant memory saving granted by sparse matrices representation, makes it possible to easily compute the vibrational modes and the local flexibility of large RNA systems such as ribosomal structures using a limited amount of computer resources.</p>
      <fig id="RNA067678BOTF7" orientation="portrait" position="float">
        <label>FIGURE 7.</label>
        <caption>
          <p>Execution time for the ENM calculation using sparse matrices (red) or dense matrices (yellow) on a 2.3 GHz Dual-Core Intel Core i5 processor, as a function of the number of residues in the RNA molecule. Results are shown both for sugar-base-phosphate (SBP) ENM (triangles) and all-atom-ENM (AA-ENM) (circles), as defined in <xref rid="RNA067678BOTC39" ref-type="bibr">Pinamonti et al. (2015)</xref>. <italic>Left</italic> panel shows the time for the interaction matrix diagonalization only; <italic>right</italic> panel shows the total time including the calculation of C2–C2 fluctuations.</p>
        </caption>
        <graphic xlink:href="219f07"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>DISCUSSION</title>
    <p>Many RNA molecules are highly dynamical entities that undergo conformational rearrangements during function. For this reason, it is becoming increasingly important to develop tools to analyze not only single structures, but also trajectories (ensembles) obtained from molecular simulations. In this paper we introduce software to facilitate the analysis of nucleic acids simulations. The program, called Barnaba, is available both as a Python library as well as a command-line tool. The output of the program is such that it can be easily used to calculate averages and probability distributions, or conveniently used as input to the many existing plotting and analysis libraries (e.g., Matplotlib, SKlearn) available in Python.</p>
    <p>Barnaba consists of a number of functions, and some of them implement standard calculations (RMSD, torsion angles, base-pairs, and base-stacking detection). A unique feature of Barnaba is the possibility to calculate the eRMSD. This metric has been successfully used in several contexts: for analyzing MD simulations (<xref rid="RNA067678BOTC22" ref-type="bibr">Kührová et al. 2016</xref>), as a biased collective variable in enhanced sampling simulations (<xref rid="RNA067678BOTC6" ref-type="bibr">Bottaro et al. 2016a</xref>; <xref rid="RNA067678BOTC54" ref-type="bibr">Yang et al. 2017</xref>; <xref rid="RNA067678BOTC41" ref-type="bibr">Poblete et al. 2018</xref>), to construct Markov state models (<xref rid="RNA067678BOTC40" ref-type="bibr">Pinamonti et al. 2017</xref>), and to cluster RNA tetraloop structures (<xref rid="RNA067678BOTC4" ref-type="bibr">Bottaro and Lindorff-Larsen 2017</xref>). In this paper we show the usefulness of this metric to monitor simulations over time, to perform cluster analysis, and to search for structural motifs within trajectories/structures. This last feature can be extremely useful to experimental structural biologists, as it makes it possible to efficiently search for arbitrary query motifs within the entire PDB database. For analyzing simulations and clusters, we have found it useful to introduce a dynamic secondary structure representation that recapitulates the variability of base-pair and base-stacking interactions within an ensemble.</p>
    <p>Another important feature of Barnaba is the possibility to back-calculate <sup>3</sup><italic>J</italic> scalar couplings from structures. This calculation is per se extremely simple. However, it can be difficult to obtain from the literature the different sets of Karplus parameters, and the calculation of the corresponding dihedral angles is error-prone.</p>
    <p>Finally, Barnaba contains a routine to construct ENMs of nucleic acid and protein systems and complexes. This is a useful, fast, and computationally cheap tool to predict the local dynamical properties of biomolecules, as well as the chain flexibility of RNA molecules.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4a">
      <title>Implementation and availability</title>
      <p>Barnaba is a Python library and command-line tool. It requires Python 2.7 or &gt;3.3, Numpy, and Scipy libraries. Additionally, Barnaba requires MDTraj (<uri xlink:href="http://mdtraj.org/">http://mdtraj.org/</uri>) for manipulating structures and trajectories. Source code is freely available at <uri xlink:href="https://github.com/srnas/barnaba">https://github.com/srnas/barnaba</uri> under GNU GPLv3 license. The github repository contains documentation as well as a set of examples.</p>
    </sec>
    <sec id="s4b">
      <title>Relative position and orientation of nucleobases</title>
      <p>For each nucleotide, a local coordinate system is set up in the center of C2, C4, and C6 atoms (<xref ref-type="fig" rid="RNA067678BOTF8">Fig. 8</xref>). The <italic>x</italic>-axis points toward the C2 atom, and the <italic>y</italic>-axis in the direction of C4 (C/U) or C6 (A/G). The origin of the coordinates of nucleobase <italic>j</italic> in the reference system constructed on base <italic>i</italic> is the vector <bold>R</bold><sub><bold>ij</bold></sub> = {<italic>x</italic><sub><italic>ij</italic></sub>, <italic>y</italic><sub><italic>ij</italic></sub>, <italic>z</italic><sub><italic>ij</italic></sub>}. Note that |<bold>R</bold><sub><bold>ij</bold></sub>| <bold>=</bold>|<bold>R</bold><sub><bold>ji</bold></sub>| but <bold>R</bold><sub><bold>ij</bold></sub>
<bold>≠R</bold><sub><bold>ji</bold></sub>. The <bold>R</bold><sub><bold>ij</bold></sub> is central in the definition of the eRMSD metric and of the annotation strategy described below.</p>
      <fig id="RNA067678BOTF8" orientation="portrait" position="float">
        <label>FIGURE 8.</label>
        <caption>
          <p>Definition of the local coordinate systems and of the vector <bold>R</bold> for purines and pyrimidines.</p>
        </caption>
        <graphic xlink:href="219f08"/>
      </fig>
    </sec>
    <sec id="s4c">
      <title>eRMSD</title>
      <p>The eRMSD is a contact map-based distance, with the addition of a number of features that make it suitable for the comparison of nucleic acid structures. We briefly describe here the procedure, originally introduced in <xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. (2014)</xref>. Given a three-dimensional structure <italic>α</italic>, one calculates <bold>R</bold><sub><bold>ij</bold></sub><sup>α</sup> for all pairs of bases in a molecule. The position vectors are then rescaled as follows:
<disp-formula id="RNA067678BOTM1"><label>(1)</label><mml:math id="M1"><mml:msubsup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup></mml:mrow><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mstyle></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
with <italic>a</italic> = 5 Å and <italic>b</italic> = 3 Å. The rescaling effectively introduces an ellipsoidal anisotropy that is peculiar to base–base interactions. Given two structures, <italic>α</italic> and <italic>β</italic>, consisting of <italic>N</italic> residues, the eRMSD is calculated as
<disp-formula id="RNA067678BOTM2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">eRMSD</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mstyle></mml:msqrt><mml:mo>.</mml:mo></mml:math></disp-formula>
<bold>G</bold> is a nonlinear function of <inline-formula><mml:math id="il1"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> defined as
<disp-formula id="RNA067678BOTM3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mrow><mml:mspace width="0.056em"/></mml:mrow><mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>γ</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <inline-formula><mml:math id="il2"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> and Θ is the Heaviside step function. Note that the function <bold>G</bold> has the following desirable properties:
<list list-type="order"><list-item><p><inline-formula><mml:math id="il3"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>≈</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">if</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mo>≪</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="il4"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">if</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="il5"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> is a continuous function.</p></list-item></list>The default cutoff value is set to <inline-formula><mml:math id="il6"><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.4</mml:mn></mml:math></inline-formula> and can be changed within Barnaba.</p>
    </sec>
    <sec id="s4d">
      <title>Annotation</title>
      <p>A pair of bases <italic>i</italic> and <italic>j</italic> is considered for annotation only if <inline-formula><mml:math id="il7"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1.7</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="il8"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">r</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1.7</mml:mn></mml:math></inline-formula>.</p>
    </sec>
    <sec id="s4e">
      <title>Stacking</title>
      <p>The criteria for base stacking are the following:
<disp-formula id="RNA067678BOTM4"><label>(4)</label><mml:math id="M4"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mtext>Å</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">or</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>2.5</mml:mn><mml:mrow><mml:mtext>Å</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>40</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
Here, <inline-formula><mml:math id="il9"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:msqrt></mml:math></inline-formula> and <italic>θ</italic><sub><italic>ij</italic></sub> is the angle between the vectors normal to the planes of the two bases. Similarly to other annotation approaches (<xref rid="RNA067678BOTC16" ref-type="bibr">Gendron et al. 2001</xref>; <xref rid="RNA067678BOTC46" ref-type="bibr">Sarver et al. 2008</xref>; <xref rid="RNA067678BOTC53" ref-type="bibr">Waleń et al. 2014</xref>), we identify four different classes of stacking interactions according to the sign of the <italic>z</italic>-coordinates:
<list list-type="bullet"><list-item><p>upward: (≫ or 3′–5′) if <italic>z</italic><sub><italic>ij</italic></sub> &gt; 0 and <italic>z</italic><sub><italic>ji</italic></sub> &lt; 0</p></list-item><list-item><p>downward: (≪ or 5′–3′) if <italic>z</italic><sub><italic>ij</italic></sub> &lt; 0 and <italic>z</italic><sub><italic>ji</italic></sub> &gt; 0</p></list-item><list-item><p>outward: (&lt; &gt; or 5′–5′) if <italic>z</italic><sub><italic>ij</italic></sub> &lt; 0 and <italic>z</italic><sub><italic>ji</italic></sub> &lt; 0</p></list-item><list-item><p>inward: (&gt; &lt; or 3′–3′) if <italic>z</italic><sub><italic>ij</italic></sub> &gt; 0 and <italic>z</italic><sub><italic>ji</italic></sub> &gt; 0</p></list-item></list>We notice that, with this choice, consecutive base pairs with alternating purines and pyrimidines result in a cross-strand outward stacking (see, e.g., <xref ref-type="fig" rid="RNA067678BOTF1">Fig. 1</xref>A).</p>
    </sec>
    <sec id="s4f">
      <title>Base-pairing</title>
      <p>Base pairs are classified according to the Leontis–Westhof nomenclature (<xref rid="RNA067678BOTC27" ref-type="bibr">Leontis and Westhof 2001</xref>), based on the observation that hydrogen bonding between RNA bases involves three distinct edges: Watson–Crick (W), Hoogsteeen (H), and sugar (S). An additional distinction is made according to the orientation with respect to the glycosidic bonds, in <italic>cis</italic> (c) or <italic>trans</italic> (t) orientation.</p>
      <p>In Barnaba, all nonstacked bases are considered base-paired if |θ<sub><italic>ij</italic></sub>| &lt; 60° and there exists at least one hydrogen bond, calculated as the number of donor–acceptor pairs with distance &lt;3.3 Å. Edges are defined according to the value of the angle <inline-formula><mml:math id="il10"><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">arctan</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.
<list list-type="bullet"><list-item><p>Watson-Crick; edge (W): 0.16 &lt; ψ ≤ 2.0 rad</p></list-item><list-item><p>Hoogsteen edge (H): 2.0 &lt; ψ ≤ 4.0 rad</p></list-item><list-item><p>Sugar edge (S): ψ &gt; 4.0<italic>rad</italic>, ψ ≤ 0.16 rad</p></list-item></list></p>
      <p>These threshold values are obtained by considering the empirical distribution of base–base interactions shown in <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/lookup/suppl/doi:10.1261/rna.067678.118/-/DC1">Supplemental Material 3</ext-link> and discussed in <xref ref-type="fig" rid="RNA067678BOTF2">Figure 2</xref> of <xref rid="RNA067678BOTC5" ref-type="bibr">Bottaro et al. (2014)</xref>. <italic>Cis</italic>/<italic>trans</italic> orientation is calculated according to the value of the dihedral angle defined by <inline-formula><mml:math id="il11"><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mn>9</mml:mn><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mn>9</mml:mn><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:msubsup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <italic>N</italic>1/<italic>N</italic>9 is used for pyrimidines and purines, respectively.</p>
      <p>We note that the annotation provided by Barnaba might fail in detecting some interactions, and sometimes differs from other programs. This is due to the fact that for non-Watson–Crick and stacking interactions it is not trivial to define a set of criteria for a rigorous discrete classification (<xref rid="RNA067678BOTC53" ref-type="bibr">Waleń et al. 2014</xref>). Typically, these criteria are calibrated to work well for high-resolution structures, but they are not always suitable to describe nearly formed interactions often observed in molecular simulations.</p>
    </sec>
    <sec id="s4g">
      <title>Torsion angles and <sup>3</sup><italic>J</italic> scalar couplings</title>
      <p>We use the standard definition of backbone angles, glycosidic <italic>χ</italic> angle (O4′-C1′-N9-C4 atoms for A/G, O4′-C1′-N1-C2 for C/U), and sugar torsion angles (ν<sub>0</sub> · · · ν<sub>4</sub>) as shown in <xref ref-type="fig" rid="RNA067678BOTF9">Figures 9</xref> and <xref ref-type="fig" rid="RNA067678BOTF10">10</xref> (<xref rid="RNA067678BOTC45" ref-type="bibr">Saenger 2013</xref>).</p>
      <fig id="RNA067678BOTF9" orientation="portrait" position="float">
        <label>FIGURE 9.</label>
        <caption>
          <p>Definition of the backbone/glycosidic angles <italic>χ</italic> (<xref rid="RNA067678BOTC15" ref-type="bibr">Frellsen et al. 2009</xref>).</p>
        </caption>
        <graphic xlink:href="219f09"/>
      </fig>
      <fig id="RNA067678BOTF10" orientation="portrait" position="float">
        <label>FIGURE 10.</label>
        <caption>
          <p>Definition of pucker angles ν<sub>0</sub> · · · ν<sub>4</sub>.</p>
        </caption>
        <graphic xlink:href="219f10"/>
      </fig>
      <p>Pseudorotation sugar parameters amplitude <italic>tm</italic> and phase <italic>P</italic> are calculated as described in <xref rid="RNA067678BOTC42" ref-type="bibr">Rao et al. (1981)</xref>:
<disp-formula id="RNA067678BOTM5"><label>(5)</label><mml:math id="M5"><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="RNA067678BOTM6"><label>(6)</label><mml:math id="M6"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">arctan</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where
<disp-formula id="RNA067678BOTM7"><label>(7)</label><mml:math id="M7"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:munderover><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>cos</mml:mi><mml:mspace width="0.4em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>4</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>π</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
<disp-formula id="RNA067678BOTM8"><label>(8)</label><mml:math id="M8"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:munderover><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>sin</mml:mi><mml:mspace width="0.4em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>4</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>π</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>
Optionally, it is also possible to calculate pseudorotation parameters using the Altona–Sundaralingam treatment (<xref rid="RNA067678BOTC2" ref-type="bibr">Altona and Sundaralingam 1972</xref>):
<disp-formula id="RNA067678BOTM9"><label>(9)</label><mml:math id="M9"><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">arctan</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>3.0777</mml:mn><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="RNA067678BOTM10"><label>(10)</label><mml:math id="M10"><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="RNA067678BOTM11"><label>(11)</label><mml:math id="M11"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mn>180</mml:mn></mml:mrow><mml:mi>π</mml:mi></mml:mfrac></mml:mrow><mml:mi>P</mml:mi><mml:mn>0.</mml:mn></mml:mstyle></mml:math></disp-formula>
<sup>3</sup><italic>J</italic> Scalar couplings are calculated using the Karplus equations:
<disp-formula id="RNA067678BOTM12"><label>(12)</label><mml:math id="M12"><mml:mi>A</mml:mi><mml:msup><mml:mi>cos</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>cos</mml:mi><mml:mspace width="0.4em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula>
Karplus parameters <italic>relative</italic> to the different scalar couplings are reported in <xref rid="RNA067678BOTTB1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="RNA067678BOTTB1" orientation="portrait" position="float">
        <label>TABLE 1.</label>
        <caption>
          <p>Karplus parameters used in Barnaba</p>
        </caption>
        <graphic xlink:href="219tb01"/>
      </table-wrap>
    </sec>
    <sec id="s4h">
      <title>Elastic network model</title>
      <p>In ENMs, a set of <italic>N</italic> beads connected by pairwise harmonic springs penalize deviations of interbead distances from their reference values. Spring constants are set to a constant value <italic>k</italic> whenever the reference distance between the two beads is smaller than an interaction cutoff (<italic>R</italic><sub>c</sub>), and set to zero otherwise. Under these assumptions, the potential energy of the system can be approximated as
<disp-formula id="RNA067678BOTM13"><label>(13)</label><mml:math id="M13"><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>
where <bold><italic>M</italic></bold> is the symmetric 3 <italic>N</italic> × 3 <italic>N</italic> interaction matrix, and δ<bold>r</bold><sub><italic>i</italic></sub> is the deviation of bead <italic>i</italic> from its position in the reference structure.</p>
      <p>The user can select different atoms to be used as beads in the construction of the model. The optimal value of the parameter <italic>R</italic><sub><italic>c</italic></sub> depends on this choice, as described in <xref rid="RNA067678BOTC39" ref-type="bibr">Pinamonti et al. (2015)</xref>.</p>
      <p>The covariance matrix is computed as
<disp-formula id="RNA067678BOTM14"><label>(14)</label><mml:math id="M14"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mi>α</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <italic>λ</italic><sub><italic>α</italic></sub> and <bold>v</bold><sup>α</sup> are the eigenvalues and the eigenvectors of the interaction matrix <bold><italic>M</italic></bold>, respectively. The sum on <italic>α</italic> runs over all nonnull modes of the system.</p>
      <p>Mean square fluctuation (MSF) of residue <italic>i</italic> is calculated as
<disp-formula id="RNA067678BOTM15"><label>(15)</label><mml:math id="M15"><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula>
The variance of the distance between two beads can be directly obtained from the covariance matrix in the linear perturbation regime as
<disp-formula id="RNA067678BOTM16"><label>(16)</label><mml:math id="M16"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>ν</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <inline-formula><mml:math id="il12"><mml:msubsup><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msubsup></mml:math></inline-formula> is the <italic>µ</italic> Cartesian component of the reference distance between beads <italic>i</italic> and <italic>j</italic>.</p>
      <p>For most practical applications of ENMs, only the high-amplitude modes, i.e., those with the smallest eigenvalues, provide interesting dynamical information. The calculation of C2–C2 distance fluctuations using Equation <xref ref-type="disp-formula" rid="RNA067678BOTM16">16</xref> requires the knowledge of all eigenvectors. This can be performed by reducing the system to the “effective interaction matrix” <inline-formula><mml:math id="il13"><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> relative to the beads of interest (<xref rid="RNA067678BOTC55" ref-type="bibr">Zen et al. 2008</xref>).
<disp-formula id="RNA067678BOTM17"><label>(17)</label><mml:math id="M17"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mi>W</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">other</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>M</italic><sub>C2</sub>(<italic>M</italic><sub>other</sub>) is formed by the rows and columns of <italic>M</italic> relative to the (non) C2 beads, while <italic>W</italic> represent the interactions between C2 and non-C2 beads. The effective interaction matrix is defined as
<disp-formula id="RNA067678BOTM18"><label>(18)</label><mml:math id="M18"><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">other</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>
This can be computed efficiently using sparse matrix-vector multiplication algorithms. The resulting effective matrix <inline-formula><mml:math id="il14"><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> has reduced size: 1/3 for sugar-base-phosphate (SBP), ∼1/20 for all-atom (AA), making its pseudo-inversion considerably faster. Note that, in case one is interested in computing the C2–C2 fluctuations for a portion of the molecule only, the algorithm could be further optimized by directly computing the effective interactions matrix associated to the required C2–C2 pairs.</p>
    </sec>
  </sec>
  <sec sec-type="supplemental|material" id="s5">
    <title>SUPPLEMENTAL MATERIAL</title>
    <p>Supplemental material is available for this article.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_25_2_219__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_067678.118_Supplemental_Material_1-13.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_067678.118_Supplemental_Material_14.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>We thank D.E. Shaw Research for providing the simulation of the UUCG tetraloop. The research is funded by a grant from The Velux Foundations (S.B. and K.L.-L.), a Hallas-Møller Stipend from the Novo Nordisk Foundation (K.L.-L.), and the Lundbeck Foundation BRAINSTRUC initiative (K.L.-L.). G.B., S.R., S.B., and G.P. have received funding from the European Research Council (ERC) under the European Union's Seventh Framework Programme (FP/2007-2013)/ERC grant agreement no. 306662 (S-RNA-S). W.B. is funded by Villum Fonden (VKR023445) and the Danish Council for Independent Research (DFF-4181-00344).</p>
  </ack>
  <fn-group>
    <fn>
      <p>Article is online at <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/cgi/doi/10.1261/rna.067678.118">http://www.rnajournal.org/cgi/doi/10.1261/rna.067678.118</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="RNA067678BOTC1">
      <mixed-citation publication-type="journal"><string-name><surname>Abraham</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Murtola</surname><given-names>T</given-names></string-name>, <string-name><surname>Schulz</surname><given-names>R</given-names></string-name>, <string-name><surname>Páll</surname><given-names>S</given-names></string-name>, <string-name><surname>Smith</surname><given-names>JC</given-names></string-name>, <string-name><surname>Hess</surname><given-names>B</given-names></string-name>, <string-name><surname>Lindahl</surname><given-names>E</given-names></string-name>. <year>2015</year><article-title>GROMACS: high performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>. <source>SoftwareX</source><volume>1</volume>: <fpage>19</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC2">
      <mixed-citation publication-type="journal"><string-name><surname>Altona</surname><given-names>C</given-names></string-name>, <string-name><surname>Sundaralingam</surname><given-names>M</given-names></string-name>. <year>1972</year><article-title>Conformational analysis of the sugar ring in nucleosides and nucleotides. New description using the concept of pseudorotation</article-title>. <source>J Am Chem Soc</source><volume>94</volume>: <fpage>8205</fpage>–<lpage>8212</lpage>. <pub-id pub-id-type="doi">10.1021/ja00778a043</pub-id><pub-id pub-id-type="pmid">5079964</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC3">
      <mixed-citation publication-type="journal"><string-name><surname>Bahar</surname><given-names>I</given-names></string-name>, <string-name><surname>Jernigan</surname><given-names>RL</given-names></string-name>. <year>1998</year><article-title>Vibrational dynamics of transfer RNAs: comparison of the free and synthetase-bound forms</article-title>. <source>J Mol Biol</source><volume>281</volume>: <fpage>871</fpage>–<lpage>884</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1998.1978</pub-id><pub-id pub-id-type="pmid">9719641</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC4">
      <mixed-citation publication-type="journal"><string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Lindorff-Larsen</surname><given-names>K</given-names></string-name>. <year>2017</year><article-title>Mapping the universe of RNA tetraloop folds</article-title>. <source>Biophys J</source><volume>113</volume>: <fpage>257</fpage>–<lpage>267</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2017.06.011</pub-id><pub-id pub-id-type="pmid">28673616</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC5">
      <mixed-citation publication-type="journal"><string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Di Palma</surname><given-names>F</given-names></string-name>, <string-name><surname>Bussi G</surname></string-name>. <year>2014</year><article-title>The role of nucleobase interactions in RNA structure and dynamics</article-title>. <source>Nucleic Acids Res</source><volume>42</volume>: <fpage>13306</fpage>–<lpage>13314</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku972</pub-id><pub-id pub-id-type="pmid">25355509</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC6">
      <mixed-citation publication-type="journal"><string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Banáš</surname><given-names>P</given-names></string-name>, <string-name><surname>Šponer J</surname></string-name>, <string-name><surname>Bussi G</surname></string-name>. <year>2016a</year><article-title>Free energy landscape of GAGA and UUCG RNA tetraloops</article-title>. <source>J Phys Chem Lett</source><volume>7</volume>: <fpage>4032</fpage>–<lpage>4038</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jpclett.6b01905</pub-id><pub-id pub-id-type="pmid">27661094</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC7">
      <mixed-citation publication-type="journal"><string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Gil-Ley</surname><given-names>A</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>. <year>2016b</year><article-title>RNA folding pathways in stop-motion</article-title>. <source>Nucleic Acids Res</source><volume>44</volume>: <fpage>5883</fpage>–<lpage>5891</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw239</pub-id><pub-id pub-id-type="pmid">27091499</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC8">
      <mixed-citation publication-type="journal"><string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>SD</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH</given-names></string-name>, <string-name><surname>Lindorff-Larsen</surname><given-names>K</given-names></string-name>. <year>2018</year><article-title>Conformational ensembles of RNA oligonucleotides from integrating NMR and molecular simulations</article-title>. <source>Sci Adv</source><volume>4</volume>: <fpage>eaar8521</fpage><pub-id pub-id-type="doi">10.1126/sciadv.aar8521</pub-id><pub-id pub-id-type="pmid">29795785</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC9">
      <mixed-citation publication-type="journal"><string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Meisburger</surname><given-names>SP</given-names></string-name>, <string-name><surname>Pabit</surname><given-names>SA</given-names></string-name>, <string-name><surname>Sutton</surname><given-names>JL</given-names></string-name>, <string-name><surname>Webb</surname><given-names>WW</given-names></string-name>, <string-name><surname>Pollack</surname><given-names>L</given-names></string-name>. <year>2012</year><article-title>Ionic strength-dependent persistence lengths of single-stranded RNA and DNA</article-title>. <source>Proc Natl Acad Sci</source><volume>109</volume>: <fpage>799</fpage>–<lpage>804</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1119057109</pub-id><pub-id pub-id-type="pmid">22203973</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC10">
      <mixed-citation publication-type="journal"><string-name><surname>Condon</surname><given-names>DE</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>SD</given-names></string-name>, <string-name><surname>Mort</surname><given-names>BC</given-names></string-name>, <string-name><surname>Kierzek</surname><given-names>R</given-names></string-name>, <string-name><surname>Yildirim</surname><given-names>I</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH</given-names></string-name>. <year>2015</year><article-title>Stacking in RNA: NMR of four tetramers benchmark molecular dynamics</article-title>. <source>J Chem Theory Comput</source><volume>11</volume>: <fpage>2729</fpage>–<lpage>2742</lpage>. <pub-id pub-id-type="doi">10.1021/ct501025q</pub-id><pub-id pub-id-type="pmid">26082675</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC11">
      <mixed-citation publication-type="journal"><string-name><surname>Davies</surname><given-names>DB</given-names></string-name>. <year>1978</year><article-title>Conformations of nucleosides and nucleotides</article-title>. <source>Prog NMR Spectrosc</source><volume>12</volume>: <fpage>135</fpage>–<lpage>225</lpage>. <pub-id pub-id-type="doi">10.1016/0079-6565(78)80006-5</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC12">
      <mixed-citation publication-type="journal"><string-name><surname>Dawson</surname><given-names>WK</given-names></string-name>, <string-name><surname>Bujnicki</surname><given-names>JM</given-names></string-name>. <year>2016</year><article-title>Computational modeling of RNA 3D structures and interactions</article-title>. <source>Curr Opin Struct Biol</source><volume>37</volume>: <fpage>22</fpage>–<lpage>28</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2015.11.007</pub-id><pub-id pub-id-type="pmid">26689764</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC13">
      <mixed-citation publication-type="journal"><string-name><surname>Dickerson</surname><given-names>R</given-names></string-name>. <year>1989</year><article-title>Definitions and nomenclature of nucleic acid structure components</article-title>. <source>Nucleic Acids Res</source><volume>17</volume>: <fpage>1797</fpage>–<lpage>1803</lpage>. <pub-id pub-id-type="doi">10.1093/nar/17.5.1797</pub-id><pub-id pub-id-type="pmid">2928107</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC14">
      <mixed-citation publication-type="journal"><string-name><surname>Ester</surname><given-names>M</given-names></string-name>, <string-name><surname>Kriegel</surname><given-names>HP</given-names></string-name>, <string-name><surname>Sander</surname><given-names>J</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>. <year>1996</year><article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. <source>KDD</source><volume>96</volume>: <fpage>226</fpage>–<lpage>231</lpage>.</mixed-citation>
    </ref>
    <ref id="RNA067678BOTC15">
      <mixed-citation publication-type="journal"><string-name><surname>Frellsen</surname><given-names>J</given-names></string-name>, <string-name><surname>Moltke</surname><given-names>I</given-names></string-name>, <string-name><surname>Thiim</surname><given-names>M</given-names></string-name>, <string-name><surname>Mardia</surname><given-names>KV</given-names></string-name>, <string-name><surname>Ferkingho-Borg</surname><given-names>J</given-names></string-name>, <string-name><surname>Hamelryck</surname><given-names>T</given-names></string-name>. <year>2009</year><article-title>A probabilistic model of RNA conformational space</article-title>. <source>PLoS Comput Biol</source><volume>5</volume>: <fpage>e1000406</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000406</pub-id><pub-id pub-id-type="pmid">19543381</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC16">
      <mixed-citation publication-type="journal"><string-name><surname>Gendron</surname><given-names>P</given-names></string-name>, <string-name><surname>Lemieux</surname><given-names>S</given-names></string-name>, <string-name><surname>Major</surname><given-names>F</given-names></string-name>. <year>2001</year><article-title>Quantitative analysis of nucleic acid three-dimensional structures</article-title>. <source>J Mol Biol</source><volume>308</volume>: <fpage>919</fpage>–<lpage>936</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2001.4626</pub-id><pub-id pub-id-type="pmid">11352582</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC17">
      <mixed-citation publication-type="journal"><string-name><surname>Górska</surname><given-names>A</given-names></string-name>, <string-name><surname>Jasiński</surname><given-names>M</given-names></string-name>, <string-name><surname>Trylska</surname><given-names>J</given-names></string-name>. <year>2015</year><article-title>MINT: software to identify motifs and short-range interactions in trajectories of nucleic acids</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>e114</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv559</pub-id><pub-id pub-id-type="pmid">26024667</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC18">
      <mixed-citation publication-type="journal"><string-name><surname>Hajdin</surname><given-names>CE</given-names></string-name>, <string-name><surname>Bellaousov</surname><given-names>S</given-names></string-name>, <string-name><surname>Huggins</surname><given-names>W</given-names></string-name>, <string-name><surname>Leonard</surname><given-names>CW</given-names></string-name>, <string-name><surname>Mathews</surname><given-names>DH</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>KM</given-names></string-name>. <year>2013</year><article-title>Accurate SHAPE-directed RNA secondary structure modeling, including pseudoknots</article-title>. <source>Proc Natl Acad Sci</source><volume>110</volume>: <fpage>5498</fpage>–<lpage>5503</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1219988110</pub-id><pub-id pub-id-type="pmid">23503844</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC19">
      <mixed-citation publication-type="journal"><string-name><surname>Ippel</surname><given-names>J</given-names></string-name>, <string-name><surname>Wijmenga</surname><given-names>S</given-names></string-name>, <string-name><surname>De Jong</surname><given-names>R</given-names></string-name>, <string-name><surname>Heus</surname><given-names>H</given-names></string-name>, <string-name><surname>Hilbers</surname><given-names>C</given-names></string-name>, <string-name><surname>De Vroom</surname><given-names>E</given-names></string-name>, <string-name><surname>Van der Marel</surname><given-names>G</given-names></string-name>, <string-name><surname>Van Boom</surname><given-names>J</given-names></string-name>. <year>1996</year><article-title>Heteronuclear scalar couplings in the bases and sugar rings of nucleic acids: their determination and application in assignment and conformational analysis</article-title>. <source>Magn Reson Chem</source><volume>34</volume>: <fpage>S156</fpage>–<lpage>S176</lpage>. <pub-id pub-id-type="doi">10.1002/(SICI)1097-458X(199612)34:13&lt;S156::AID-OMR68&gt;3.0.CO;2-U</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC20">
      <mixed-citation publication-type="journal"><string-name><surname>Jacobson</surname><given-names>AB</given-names></string-name>, <string-name><surname>Zuker</surname><given-names>M</given-names></string-name>. <year>1993</year><article-title>Structural analysis by energy dot plot of a large mRNA</article-title>. <source>J Mol Biol</source><volume>233</volume>: <fpage>261</fpage>–<lpage>269</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1993.1504</pub-id><pub-id pub-id-type="pmid">8377202</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC21">
      <mixed-citation publication-type="journal"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>. <year>1976</year><article-title>A solution for the best rotation to relate two sets of vectors</article-title>. <source>Acta Crystallogr A</source><volume>32</volume>: <fpage>922</fpage>–<lpage>923</lpage>. <pub-id pub-id-type="doi">10.1107/S0567739476001873</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kührová</surname><given-names>P</given-names></string-name>, <string-name><surname>Best</surname><given-names>RB</given-names></string-name>, <string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>, <string-name><surname>Šponer</surname><given-names>J</given-names></string-name>, <string-name><surname>Otyepka</surname><given-names>M</given-names></string-name>, <string-name><surname>Banáš</surname><given-names>P</given-names></string-name>. <year>2016</year><article-title>Computer folding of RNA tetraloops: identification of key force field deficiencies</article-title>. <source>J Chem Theory Comput</source><volume>12</volume>: <fpage>4534</fpage>–<lpage>4548</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jctc.6b00300</pub-id><pub-id pub-id-type="pmid">27438572</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC23">
      <mixed-citation publication-type="journal"><string-name><surname>Kumar</surname><given-names>R</given-names></string-name>, <string-name><surname>Grubmüller</surname><given-names>H</given-names></string-name>. <year>2015</year><article-title>do_x3dna: a tool to analyze structural fluctuations of dsDNA or dsRNA from molecular dynamics simulations</article-title>. <source>Bioinformatics</source><volume>31</volume>: <fpage>2583</fpage>–<lpage>2585</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv190</pub-id><pub-id pub-id-type="pmid">25838463</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC24">
      <mixed-citation publication-type="journal"><string-name><surname>Lankhorst</surname><given-names>PP</given-names></string-name>, <string-name><surname>Haasnoot</surname><given-names>CA</given-names></string-name>, <string-name><surname>Erkelens</surname><given-names>C</given-names></string-name>, <string-name><surname>Altona</surname><given-names>C</given-names></string-name>. <year>1984</year><article-title>Carbon-13 NMR in conformational analysis of nucleic acid fragments. 2. A reparametrization of the Karplus equation for vicinal NMR coupling constants in CCOP and HCOP fragments</article-title>. <source>J Biomol Struct Dyn</source><volume>1</volume>: <fpage>1387</fpage>–<lpage>1405</lpage>. <pub-id pub-id-type="doi">10.1080/07391102.1984.10507527</pub-id><pub-id pub-id-type="pmid">6400827</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC25">
      <mixed-citation publication-type="journal"><string-name><surname>Lavery</surname><given-names>R</given-names></string-name>, <string-name><surname>Moakher</surname><given-names>M</given-names></string-name>, <string-name><surname>Maddocks</surname><given-names>JH</given-names></string-name>, <string-name><surname>Petkeviciute</surname><given-names>D</given-names></string-name>, <string-name><surname>Zakrzewska</surname><given-names>K</given-names></string-name>. <year>2009</year><article-title>Conformational analysis of nucleic acids revisited: Curves+</article-title>. <source>Nucleic Acids Res</source><volume>37</volume>: <fpage>5917</fpage>–<lpage>5929</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp608</pub-id><pub-id pub-id-type="pmid">19625494</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC26">
      <mixed-citation publication-type="journal"><string-name><surname>Lemieux</surname><given-names>S</given-names></string-name>, <string-name><surname>Major</surname><given-names>F</given-names></string-name>. <year>2002</year><article-title>RNA canonical and non-canonical base pairing types: a recognition method and complete repertoire</article-title>. <source>Nucleic Acids Res</source><volume>30</volume>: <fpage>4250</fpage>–<lpage>4263</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkf540</pub-id><pub-id pub-id-type="pmid">12364604</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC27">
      <mixed-citation publication-type="journal"><string-name><surname>Leontis</surname><given-names>NB</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name>. <year>2001</year><article-title>Geometric nomenclature and classification of RNA base pairs</article-title>. <source>RNA</source><volume>7</volume>: <fpage>499</fpage>–<lpage>512</lpage>. <pub-id pub-id-type="doi">10.1017/S1355838201002515</pub-id><pub-id pub-id-type="pmid">11345429</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC28">
      <mixed-citation publication-type="journal"><string-name><surname>Lindorff-Larsen</surname><given-names>K</given-names></string-name>, <string-name><surname>Piana</surname><given-names>S</given-names></string-name>, <string-name><surname>Dror</surname><given-names>RO</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>DE</given-names></string-name>. <year>2011</year><article-title>How fast-folding proteins fold</article-title>. <source>Science</source><volume>334</volume>: <fpage>517</fpage>–<lpage>520</lpage>. <pub-id pub-id-type="doi">10.1126/science.1208351</pub-id><pub-id pub-id-type="pmid">22034434</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC29">
      <mixed-citation publication-type="journal"><string-name><surname>Lu</surname><given-names>XJ</given-names></string-name>, <string-name><surname>Olson</surname><given-names>WK</given-names></string-name>. <year>2008</year><article-title>3DNA: a versatile, integrated software system for the analysis, rebuilding and visualization of three-dimensional nucleic-acid structures</article-title>. <source>Nat Protoc</source><volume>3</volume>: <fpage>1213</fpage>–<lpage>1227</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2008.104</pub-id><pub-id pub-id-type="pmid">18600227</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC30">
      <mixed-citation publication-type="journal"><string-name><surname>Lu</surname><given-names>XJ</given-names></string-name>, <string-name><surname>Bussemaker</surname><given-names>HJ</given-names></string-name>, <string-name><surname>Olson</surname><given-names>WK</given-names></string-name>. <year>2015</year><article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>e142</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv716</pub-id><pub-id pub-id-type="pmid">26184874</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC31">
      <mixed-citation publication-type="book"><string-name><surname>Magnus</surname><given-names>M</given-names></string-name>. <year>2016</year><source>rna-pdb-tools: a toolbox to analyze structures and simulations of RNA</source>. <comment><uri xlink:href="http://rna-pdb-tools.rtfd.io">http://rna-pdb-tools.rtfd.io</uri></comment></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC32">
      <mixed-citation publication-type="journal"><string-name><surname>Marino</surname><given-names>JP</given-names></string-name>, <string-name><surname>Schwalbe</surname><given-names>H</given-names></string-name>, <string-name><surname>Griesinger</surname><given-names>C</given-names></string-name>. <year>1999</year><article-title>J-coupling restraints in RNA structure determination</article-title>. <source>Acc Chem Res</source><volume>32</volume>: <fpage>614</fpage>–<lpage>623</lpage>. <pub-id pub-id-type="doi">10.1021/ar9600392</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC33">
      <mixed-citation publication-type="journal"><string-name><surname>McGibbon</surname><given-names>RT</given-names></string-name>, <string-name><surname>Beauchamp</surname><given-names>KA</given-names></string-name>, <string-name><surname>Harrigan</surname><given-names>MP</given-names></string-name>, <string-name><surname>Klein</surname><given-names>C</given-names></string-name>, <string-name><surname>Swails</surname><given-names>JM</given-names></string-name>, <string-name><surname>Hernández</surname><given-names>CX</given-names></string-name>, <string-name><surname>Schwantes</surname><given-names>CR</given-names></string-name>, <string-name><surname>Wang</surname><given-names>LP</given-names></string-name>, <string-name><surname>Lane</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Pande</surname><given-names>VS</given-names></string-name>. <year>2015</year><article-title>MDTraj: a modern open library for the analysis of molecular dynamics trajectories</article-title>. <source>Biophys J</source><volume>109</volume>: <fpage>1528</fpage>–<lpage>1532</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.08.015</pub-id><pub-id pub-id-type="pmid">26488642</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC34">
      <mixed-citation publication-type="journal"><string-name><surname>Merino</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Wilkinson</surname><given-names>KA</given-names></string-name>, <string-name><surname>Coughlan</surname><given-names>JL</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>KM</given-names></string-name>. <year>2005</year><article-title>RNA structure analysis at single nucleotide resolution by selective 2′-hydroxyl acylation and primer extension (SHAPE)</article-title>. <source>J Am Chem Soc</source><volume>127</volume>: <fpage>4223</fpage>–<lpage>4231</lpage>. <pub-id pub-id-type="doi">10.1021/ja043822v</pub-id><pub-id pub-id-type="pmid">15783204</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC35">
      <mixed-citation publication-type="journal"><string-name><surname>Miao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Adamiak</surname><given-names>RW</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name>, <string-name><surname>Batey</surname><given-names>RT</given-names></string-name>, <string-name><surname>Becka</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Biesiada</surname><given-names>M</given-names></string-name>, <string-name><surname>Boniecki</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Bujnicki</surname><given-names>JM</given-names></string-name>, <string-name><surname>Chen</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>CY</given-names></string-name>, <etal/><year>2017</year><article-title>RNA-Puzzles Round III: 3D RNA structure prediction of five riboswitches and one ribozyme</article-title>. <source>RNA</source><volume>23</volume>: <fpage>655</fpage>–<lpage>672</lpage>. <pub-id pub-id-type="doi">10.1261/rna.060368.116</pub-id><pub-id pub-id-type="pmid">28138060</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC36">
      <mixed-citation publication-type="journal"><string-name><surname>Michaud-Agrawal</surname><given-names>N</given-names></string-name>, <string-name><surname>Denning</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Woolf</surname><given-names>TB</given-names></string-name>, <string-name><surname>Beckstein</surname><given-names>O</given-names></string-name>. <year>2011</year><article-title>MDAnalysis: a toolkit for the analysis of molecular dynamics simulations</article-title>. <source>J Comput Chem</source><volume>32</volume>: <fpage>2319</fpage>–<lpage>2327</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.21787</pub-id><pub-id pub-id-type="pmid">21500218</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC37">
      <mixed-citation publication-type="journal"><string-name><surname>Nozinovic</surname><given-names>S</given-names></string-name>, <string-name><surname>Fürtig</surname><given-names>B</given-names></string-name>, <string-name><surname>Jonker</surname><given-names>HR</given-names></string-name>, <string-name><surname>Richter</surname><given-names>C</given-names></string-name>, <string-name><surname>Schwalbe</surname><given-names>H</given-names></string-name>. <year>2010</year><article-title>High-resolution NMR structure of an RNA model system: the 14-mer cUUCGg tetraloop hairpin RNA</article-title>. <source>Nucleic Acids Res</source><volume>38</volume>: <fpage>683</fpage>–<lpage>694</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp956</pub-id><pub-id pub-id-type="pmid">19906714</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC38">
      <mixed-citation publication-type="journal"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Cruz</surname><given-names>JA</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name>, <string-name><surname>Major</surname><given-names>F</given-names></string-name>. <year>2009</year><article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>. <source>RNA</source><volume>15</volume>: <fpage>1875</fpage>–<lpage>1885</lpage>. <pub-id pub-id-type="doi">10.1261/rna.1700409</pub-id><pub-id pub-id-type="pmid">19710185</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC39">
      <mixed-citation publication-type="journal"><string-name><surname>Pinamonti</surname><given-names>G</given-names></string-name>, <string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Micheletti</surname><given-names>C</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>. <year>2015</year><article-title>Elastic network models for RNA: a comparative assessment with molecular dynamics and SHAPE experiments</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>7260</fpage>–<lpage>7269</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv708</pub-id><pub-id pub-id-type="pmid">26187990</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC40">
      <mixed-citation publication-type="journal"><string-name><surname>Pinamonti</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>J</given-names></string-name>, <string-name><surname>Condon</surname><given-names>DE</given-names></string-name>, <string-name><surname>Paul</surname><given-names>F</given-names></string-name>, <string-name><surname>Noé</surname><given-names>F</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>. <year>2017</year><article-title>Predicting the kinetics of RNA oligonucleotides using Markov state models</article-title>. <source>J Chem Theory Comput</source><volume>13</volume>: <fpage>926</fpage>–<lpage>934</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jctc.6b00982</pub-id><pub-id pub-id-type="pmid">28001394</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC41">
      <mixed-citation publication-type="journal"><string-name><surname>Poblete</surname><given-names>S</given-names></string-name>, <string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>. <year>2018</year><article-title>A nucleobase-centered coarse-grained representation for structure prediction of RNA motifs</article-title>. <source>Nucleic Acids Res</source><volume>46</volume>: <fpage>1674</fpage>–<lpage>1683</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx1269</pub-id><pub-id pub-id-type="pmid">29272539</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC42">
      <mixed-citation publication-type="journal"><string-name><surname>Rao</surname><given-names>S</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name>, <string-name><surname>Sundaralingam</surname><given-names>M</given-names></string-name>. <year>1981</year><article-title>Exact method for the calculation of pseudorotation parameters P, <italic>τ</italic><sub>m</sub> and their errors. A comparison of the Altona–Sundaralingam and Cremer–Pople treatment of puckering of five-membered rings</article-title>. <source>Acta Crystallogr A</source><volume>37</volume>: <fpage>421</fpage>–<lpage>425</lpage>. <pub-id pub-id-type="doi">10.1107/S0567739481000892</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC43">
      <mixed-citation publication-type="journal"><string-name><surname>Richardson</surname><given-names>JS</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>B</given-names></string-name>, <string-name><surname>Murray</surname><given-names>LW</given-names></string-name>, <string-name><surname>Kapral</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Immormino</surname><given-names>RM</given-names></string-name>, <string-name><surname>Headd</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>DC</given-names></string-name>, <string-name><surname>Ham</surname><given-names>D</given-names></string-name>, <string-name><surname>Hershkovits</surname><given-names>E</given-names></string-name>, <string-name><surname>Williams</surname><given-names>LD</given-names></string-name>, <etal/><year>2008</year><article-title>RNA backbone: consensus all-angle conformers and modular string nomenclature (an RNA Ontology Consortium contribution)</article-title>. <source>RNA</source><volume>14</volume>: <fpage>465</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1261/rna.657708</pub-id><pub-id pub-id-type="pmid">18192612</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC44">
      <mixed-citation publication-type="journal"><string-name><surname>Roe</surname><given-names>DR</given-names></string-name>, <string-name><surname>Cheatham</surname><given-names>TE</given-names><suffix>III</suffix></string-name>. <year>2013</year><article-title>PTRAJ and CPPTRAJ: software for processing and analysis of molecular dynamics trajectory data</article-title>. <source>J Chem Theory Comput</source><volume>9</volume>: <fpage>3084</fpage>–<lpage>3095</lpage>. <pub-id pub-id-type="doi">10.1021/ct400341p</pub-id><pub-id pub-id-type="pmid">26583988</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC45">
      <mixed-citation publication-type="book"><string-name><surname>Saenger</surname><given-names>W</given-names></string-name>. <year>2013</year><source>Principles of nucleic acid structure</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="RNA067678BOTC46">
      <mixed-citation publication-type="journal"><string-name><surname>Sarver</surname><given-names>M</given-names></string-name>, <string-name><surname>Zirbel</surname><given-names>CL</given-names></string-name>, <string-name><surname>Stombaugh</surname><given-names>J</given-names></string-name>, <string-name><surname>Mokdad</surname><given-names>A</given-names></string-name>, <string-name><surname>Leontis</surname><given-names>NB</given-names></string-name>. <year>2008</year><article-title>FR3D: finding local and composite recurrent structural motifs in RNA 3D structures</article-title>. <source>J Math Biol</source><volume>56</volume>: <fpage>215</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1007/s00285-007-0110-x</pub-id><pub-id pub-id-type="pmid">17694311</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC47">
      <mixed-citation publication-type="journal"><string-name><surname>Setny</surname><given-names>P</given-names></string-name>, <string-name><surname>Zacharias</surname><given-names>M</given-names></string-name>. <year>2013</year><article-title>Elastic network models of nucleic acids flexibility</article-title>. <source>J Chem Theory Comput</source><volume>9</volume>: <fpage>5460</fpage>–<lpage>5470</lpage>. <pub-id pub-id-type="doi">10.1021/ct400814n</pub-id><pub-id pub-id-type="pmid">26592282</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC48">
      <mixed-citation publication-type="journal"><string-name><surname>Šponer</surname><given-names>J</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>, <string-name><surname>Krepl</surname><given-names>M</given-names></string-name>, <string-name><surname>Banáš</surname><given-names>P</given-names></string-name>, <string-name><surname>Bottaro</surname><given-names>S</given-names></string-name>, <string-name><surname>Cunha</surname><given-names>RA</given-names></string-name>, <string-name><surname>Gil-Ley</surname><given-names>A</given-names></string-name>, <string-name><surname>Pinamonti</surname><given-names>G</given-names></string-name>, <string-name><surname>Poblete</surname><given-names>S</given-names></string-name>, <string-name><surname>Jurečka</surname><given-names>P</given-names></string-name>, <etal/><year>2018</year><article-title>RNA structural dynamics as captured by molecular simulations: a comprehensive overview</article-title>. <source>Chem Rev</source><volume>118</volume>: <fpage>4177</fpage>–<lpage>4338</lpage>. <pub-id pub-id-type="doi">10.1021/acs.chemrev.7b00427</pub-id><pub-id pub-id-type="pmid">29297679</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC49">
      <mixed-citation publication-type="journal"><string-name><surname>Tan</surname><given-names>D</given-names></string-name>, <string-name><surname>Piana</surname><given-names>S</given-names></string-name>, <string-name><surname>Dirks</surname><given-names>RM</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>DE</given-names></string-name>. <year>2018</year><article-title>RNA force field with accuracy comparable to state-of-the-art protein force fields</article-title>. <source>Proc Natl Acad Sci</source><volume>115</volume>: <fpage>E1346</fpage>–<lpage>E1355</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1713027115</pub-id><pub-id pub-id-type="pmid">29378935</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC50">
      <mixed-citation publication-type="journal"><string-name><surname>Tiberti</surname><given-names>M</given-names></string-name>, <string-name><surname>Papaleo</surname><given-names>E</given-names></string-name>, <string-name><surname>Bengtsen</surname><given-names>T</given-names></string-name>, <string-name><surname>Boomsma</surname><given-names>W</given-names></string-name>, <string-name><surname>Lindorff-Larsen</surname><given-names>K</given-names></string-name>. <year>2015</year><article-title>ENCORE: software for quantitative ensemble comparison</article-title>. <source>PLoS Comput Biol</source><volume>11</volume>: <fpage>e1004415</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004415</pub-id><pub-id pub-id-type="pmid">26505632</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC51">
      <mixed-citation publication-type="journal"><string-name><surname>Tirion</surname><given-names>MM</given-names></string-name>. <year>1996</year><article-title>Large amplitude elastic motions in proteins from a single-parameter, atomic analysis</article-title>. <source>Phys Rev Lett</source><volume>77</volume>: <fpage>1905</fpage>–<lpage>1908</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.77.1905</pub-id><pub-id pub-id-type="pmid">10063201</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC52">
      <mixed-citation publication-type="journal"><string-name><surname>Tribello</surname><given-names>GA</given-names></string-name>, <string-name><surname>Bonomi</surname><given-names>M</given-names></string-name>, <string-name><surname>Branduardi</surname><given-names>D</given-names></string-name>, <string-name><surname>Camilloni</surname><given-names>C</given-names></string-name>, <string-name><surname>Bussi</surname><given-names>G</given-names></string-name>. <year>2014</year><article-title>PLUMED 2: new feathers for an old bird</article-title>. <source>Comp Phys Commun</source><volume>185</volume>: <fpage>604</fpage>–<lpage>613</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2013.09.018</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC53">
      <mixed-citation publication-type="journal"><string-name><surname>Waleń</surname><given-names>T</given-names></string-name>, <string-name><surname>Chojnowski</surname><given-names>G</given-names></string-name>, <string-name><surname>Gierski</surname><given-names>P</given-names></string-name>, <string-name><surname>Bujnicki</surname><given-names>JM</given-names></string-name>. <year>2014</year><article-title>ClaRNA: a classifier of contacts in RNA 3D structures based on a comparative analysis of various classification schemes</article-title>. <source>Nucleic Acids Res</source><volume>42</volume>: <fpage>e151</fpage><pub-id pub-id-type="doi">10.1093/nar/gku765</pub-id><pub-id pub-id-type="pmid">25159614</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC54">
      <mixed-citation publication-type="journal"><string-name><surname>Yang</surname><given-names>C</given-names></string-name>, <string-name><surname>Lim</surname><given-names>M</given-names></string-name>, <string-name><surname>Kim</surname><given-names>E</given-names></string-name>, <string-name><surname>Pak</surname><given-names>Y</given-names></string-name>. <year>2017</year><article-title>Predicting RNA structures via a simple van der Waals correction to an all-atom force field</article-title>. <source>J Chem Theory Comput</source><volume>13</volume>: <fpage>395</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jctc.6b00808</pub-id><pub-id pub-id-type="pmid">28033005</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC55">
      <mixed-citation publication-type="journal"><string-name><surname>Zen</surname><given-names>A</given-names></string-name>, <string-name><surname>Carnevale</surname><given-names>V</given-names></string-name>, <string-name><surname>Lesk</surname><given-names>AM</given-names></string-name>, <string-name><surname>Micheletti</surname><given-names>C</given-names></string-name>. <year>2008</year><article-title>Correspondences between low-energy modes in enzymes: dynamics-based alignment of enzymatic functional families</article-title>. <source>Protein Sci</source><volume>17</volume>: <fpage>918</fpage>–<lpage>929</lpage>. <pub-id pub-id-type="doi">10.1110/ps.073390208</pub-id><pub-id pub-id-type="pmid">18369194</pub-id></mixed-citation>
    </ref>
    <ref id="RNA067678BOTC56">
      <mixed-citation publication-type="journal"><string-name><surname>Zimmermann</surname><given-names>MT</given-names></string-name>, <string-name><surname>Jernigan</surname><given-names>RL</given-names></string-name>. <year>2014</year><article-title>Elastic network models capture the motions apparent within ensembles of RNA structures</article-title>. <source>RNA</source><volume>20</volume>: <fpage>792</fpage>–<lpage>804</lpage>. <pub-id pub-id-type="doi">10.1261/rna.041269.113</pub-id><pub-id pub-id-type="pmid">24759093</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
