<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Microbiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Microbiol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Microbiol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Microbiology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-302X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7876079</article-id>
    <article-id pub-id-type="doi">10.3389/fmicb.2021.609048</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Microbiology</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>kernInt</italic>: A Kernel Framework for Integrating Supervised and Unsupervised Analyses in Spatio-Temporal Metagenomic Datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ramon</surname>
          <given-names>Elies</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1068340/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belanche-Muñoz</surname>
          <given-names>Lluís</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Molist</surname>
          <given-names>Francesc</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quintanilla</surname>
          <given-names>Raquel</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/534791/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perez-Enciso</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/456329/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ramayo-Caldas</surname>
          <given-names>Yuliaxis</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1146948/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Plant and Animal Genomics, Statistical and Population Genomics Group, CSIC-IRTA-UAB-UB Consortium, Centre for Research in Agricultural Genomics (CRAG)</institution>, <addr-line>Bellaterra</addr-line>, <country>Spain</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Computer Science, Polytechnic University of Catalonia</institution>, <addr-line>Barcelona</addr-line>, <country>Spain</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Schothorst Feed Research B.V.</institution>, <addr-line>Lelystad</addr-line>, <country>Netherlands</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Animal Breeding and Genetics Program, IRTA</institution>, <addr-line>Caldes de Montbui</addr-line>, <country>Spain</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Catalan Institution for Research and Advanced Studies (ICREA)</institution>, <addr-line>Barcelona</addr-line>, <country>Spain</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Isabel Moreno Indias, University of Málaga, Spain</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Xiaoquan Su, Qingdao University, China; Jun Chen, Mayo Clinic, United States; Yang Dai, University of Illinois at Chicago, United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Elies Ramon, <email>eramongurrea@gmail.com</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Evolutionary and Genomic Microbiology, a section of the journal Frontiers in Microbiology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>609048</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Ramon, Belanche-Muñoz, Molist, Quintanilla, Perez-Enciso and Ramayo-Caldas.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Ramon, Belanche-Muñoz, Molist, Quintanilla, Perez-Enciso and Ramayo-Caldas</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The advent of next-generation sequencing technologies allowed relative quantification of microbiome communities and their spatial and temporal variation. In recent years, supervised learning (i.e., prediction of a phenotype of interest) from taxonomic abundances has become increasingly common in the microbiome field. However, a gap exists between supervised and classical unsupervised analyses, based on computing ecological dissimilarities for visualization or clustering. Despite this, both approaches face common challenges, like the compositional nature of next-generation sequencing data or the integration of the spatial and temporal dimensions. Here we propose a kernel framework to place on a common ground the unsupervised and supervised microbiome analyses, including the retrieval of microbial signatures (taxa importances). We define two compositional kernels (Aitchison-RBF and compositional linear) and discuss how to transform non-compositional beta-dissimilarity measures into kernels. Spatial data is integrated with multiple kernel learning, while longitudinal data is evaluated by specific kernels. We illustrate our framework through a single point soil dataset, a human dataset with a spatial component, and a previously unpublished longitudinal dataset concerning pig production. The proposed framework and the case studies are freely available in the <italic>kernInt</italic> package at <ext-link ext-link-type="uri" xlink:href="https://github.com/elies-ramon/kernInt">https://github.com/elies-ramon/kernInt</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>microbiome</kwd>
      <kwd>metagenomics</kwd>
      <kwd>kernel</kwd>
      <kwd>supervised</kwd>
      <kwd>unsupervised</kwd>
      <kwd>spatio-temporal</kwd>
      <kwd>SVM</kwd>
      <kwd>kPCA</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Ministerio de Economía, Industria y Competitividad, Gobierno de España<named-content content-type="fundref-id">10.13039/501100010198</named-content></funding-source>
        <award-id rid="cn001">AGL2016–78709-R</award-id>
        <award-id rid="cn001">AGL2017–88849-R</award-id>
        <award-id rid="cn001">SEV-2015-0533</award-id>
        <award-id rid="cn001">BFU2016–77236-P</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <equation-count count="11"/>
      <ref-count count="47"/>
      <page-count count="14"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>The microbiome is defined as the ensemble of microorganisms and their genomes in a given environment. Microorganisms are present in ecological niches as diverse as soil, oceans, freshwater, plants, and animals, but a large fraction of these taxa cannot be cultivated with culture-dependent methods. The advent of next-generation sequencing (NGS) revolutionized this field by allowing the massive sequencing and quantification of microbial habitats.</p>
    <p>Proper analysis of microbiome data is challenging for a variety of reasons. Abundance data obtained with NGS is multivariate, sparse and compositional in nature (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>). Also, microbial communities are very dynamic biological systems, thus justifying spatial or time-course studies (<xref rid="B4" ref-type="bibr">Bodein et al., 2019</xref>; <xref rid="B3" ref-type="bibr">Berg et al., 2020</xref>). The first approach on the field used statistical tools from standard ecological studies (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>). For example, one of the first steps in nearly all microbiome studies consists in computing alpha and beta-diversities. Beta-diversity measures, e.g., Bray-Curtis or Unifrac, quantify the difference in diversity between samples from different habitats. They are used for clustering analysis or, more commonly, for visualization techniques like principal coordinates analysis (PCoA) or multidimensional scaling (MDS). However, this approach has been challenged, as the abundance data obtained by NGS has a particular nature. The total number of reads delivered is bounded by an uninformative sum: the library size (i.e., the number of total reads per sample). Library size is uninformative because it does not contain information about the population. Instead, it is arbitrarily fixed by the sequencing process and may vary by orders of magnitude across samples (<xref rid="B26" ref-type="bibr">McMurdie and Holmes, 2014</xref>). This kind of data is called compositional and deserves a specific mathematical treatment (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>). In the case of metagenomics, extensive research is being done to translate current statistical techniques to this paradigm (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>; <xref rid="B37" ref-type="bibr">Silverman et al., 2017</xref>; <xref rid="B32" ref-type="bibr">Rivera-Pinto et al., 2018</xref>). One example is the proposal of using the compositional Aitchison distance instead of the classic beta-diversity measures (<xref rid="B31" ref-type="bibr">Quinn et al., 2018</xref>).</p>
    <p>In machine learning, the aforementioned clustering, ordination and visualization techniques belong to the so-called unsupervised learning. Supervised learning, which is focused on prediction, is not so widespread in microbiome analysis yet, but the number of studies using this kind of approach is rapidly growing in the last years (<xref rid="B46" ref-type="bibr">Zhou and Gallins, 2019</xref>). Due to this rise in popularity, widely used libraries for microbiome analysis like QIIME2 (<xref rid="B5" ref-type="bibr">Bolyen et al., 2019</xref>) now include plugins for supervised learning in their toolbox. Typical available methods include random forests (RF), artificial neural networks (ANN), support vector machines (SVM), and ridge regression (<xref rid="B30" ref-type="bibr">Qu et al., 2019</xref>; <xref rid="B46" ref-type="bibr">Zhou and Gallins, 2019</xref>; <xref rid="B28" ref-type="bibr">Namkung, 2020</xref>). Among the aforementioned, RF are popular in the microbiome context and tend to outperform other methods (<xref rid="B46" ref-type="bibr">Zhou and Gallins, 2019</xref>; <xref rid="B28" ref-type="bibr">Namkung, 2020</xref>). ANN have shown excellent performance in some cases but are susceptible to overfitting, especially if sample size is greatly exceeded by the number of taxa, as is often the case in metagenomics and metataxonomics. A desirable feature for supervised methods is the identification of microbial signatures (i.e., taxa that are predictive of a certain phenotype), which may enable a biological interpretation of the results. RF are endowed with variable importance measures that can be used to this effect, while there is not such straightforward heuristic for ANN, although several possible strategies exist (<xref rid="B18" ref-type="bibr">Ibrahim, 2013</xref>). Another supervised method, <italic>selbal</italic> (<xref rid="B32" ref-type="bibr">Rivera-Pinto et al., 2018</xref>), is focused on the identification of microbial signatures based on balances (i.e., the geometric means of data from two groups of taxa), and has the particularity of being purely compositional.</p>
    <p>As microbial communities are highly dynamic systems, it is important to address their spatial and/or temporal variation (<xref rid="B3" ref-type="bibr">Berg et al., 2020</xref>). In spatial-structured studies, repeated samples of different sites (e.g., body sites, depth layers) are obtained from the same individuals or entities, thus raising the question of how to integrate them. A more general challenge is the integration of datasets coming from different sources (e.g., “omics”), which may have different data types. Several statistical methods have been proposed to solve this question in the microbiome field. Some examples are <italic>Link-HD</italic> (<xref rid="B47" ref-type="bibr">Zingaretti et al., 2020</xref>), <italic>mixKernel</italic> (<xref rid="B24" ref-type="bibr">Mariette et al., 2018</xref>), and <italic>MOFA</italic> (<xref rid="B1" ref-type="bibr">Argelaguet et al., 2018</xref>), all focused in the unsupervised learning setting. In most supervised methods, this integration is usually performed at the input data level (early integration), for example by concatenating the datasets; or after the model is built (late integration), combining their scores as in ensemble methods. However, early integration may be not possible if data nature differs across sources (<xref rid="B34" ref-type="bibr">Schölkopf et al., 2004</xref>). The case of the longitudinal studies (which follow the evolution over time of microbial communities) is more complex. Typically, longitudinal data is modeled by fitting a function (e.g., polynomial interpolation, splines) to the data points over time. To date, there exist few analytical tools for this kind of data in the microbiome field. Two examples can be found at <xref rid="B4" ref-type="bibr">Bodein et al. (2019)</xref> and <xref rid="B11" ref-type="bibr">Coenen et al. (2020)</xref>, but they are restricted to unsupervised analysis.</p>
    <p>Difficulties like the compositionality of data or how to accommodate the spatial and temporal dimensions affect supervised and unsupervised methods alike. However, there is a gap between the most widely used supervised learning methods and the unsupervised analyses typical of the microbiome field (<xref ref-type="fig" rid="F1">Figure 1A</xref>). Libraries like QIIME2 juxtapose traditional analyses (e.g., PCoA) with many different and powerful prediction algorithms, but both branches remain independent from a mathematical point of view. It is true that some beta-diversity dissimilarity-based engines can be used as classifiers (<xref rid="B40" ref-type="bibr">Su et al., 2020</xref>; <xref rid="B36" ref-type="bibr">Shenhav et al., 2019</xref>). However, as these tools are strongly focused on distinguishing among a limited number of bacteria-related conditions, they are not aimed at regression problems, nor do they give any information about the microbial signatures. We consider that carrying out all aforementioned analyses in a common mathematical framework would provide a new, holistic view to microbiome studies. With all this in mind we propose a generic and flexible kernel framework (<xref ref-type="fig" rid="F1">Figure 1B</xref>) as a way to handle unsupervised and supervised microbiome analyses (including the retrieval of microbial signatures), while paying special attention to data compositionality and spatial and temporal integration. Kernel methods are a family within machine learning methods that share the use of kernel functions or, simply, kernels. Some of these methods have been already applied to some specific problems or areas within microbiome analysis (<xref rid="B45" ref-type="bibr">Zhan et al., 2017</xref>; <xref rid="B24" ref-type="bibr">Mariette et al., 2018</xref>; <xref rid="B46" ref-type="bibr">Zhou and Gallins, 2019</xref>) but their potential has not been fully exploited. In this work, we propose two new compositional kernels and discuss how to translate non-compositional, but nonetheless widespread, beta-diversity matrices to the kernel framework. We perform supervised and unsupervised analyses from the same kernel matrix, and show how to extract microbial signatures. Spatial and longitudinal data are also treated with specific kernel tools. This kernel framework is illustrated with three case studies: a single point soil metagenomic dataset, a human dataset with a spatial component, and a previously unpublished longitudinal dataset concerning pig gut microbiota. An R package implementing the proposed methods, along with the analyzed datasets, is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/elies-ramon/kernInt">https://github.com/elies-ramon/kernInt</ext-link>.</p>
    <fig id="F1" position="float">
      <label>FIGURE 1</label>
      <caption>
        <p>Metagenomic analysis workflow. <bold>(A)</bold> Current state-of-the art: supervised and unsupervised learning are completely independent. <bold>(B)</bold> Kernel framework: the pivotal position of the kernel matrix is clearly observed. In gray, several tasks not performed during the present work but that merit future research.</p>
      </caption>
      <graphic xlink:href="fmicb-12-609048-g001"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="S2">
    <title>Materials and Methods</title>
    <sec id="S2.SS1">
      <title>Kernels for Microbiome Data</title>
      <p>A real symmetric two-place function is a kernel iff, for every finite set of objects <italic>x</italic><sub>1</sub>,…,<italic>x</italic><sub><italic>N</italic></sub>, it generates a positive semi-definite matrix of dimension <italic>N</italic>×<italic>N</italic>: the kernel matrix (<xref rid="B34" ref-type="bibr">Schölkopf et al., 2004</xref>; <xref rid="B35" ref-type="bibr">Shawe-Taylor and Cristianini, 2004</xref>). Probably the most widely known and used kernel functions are the linear and radial basis function (RBF) kernels, both defined for real vectors.</p>
      <p>Intuitively, a kernel can be understood as a measure of the similarity between <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub>. As objects <italic>x</italic><sub>1</sub>,…,<italic>x</italic><sub><italic>N</italic></sub> are never represented explicitly, kernels can be designed for non-standard data types if a notion of what is considered “similar” in that given context exists (<xref rid="B34" ref-type="bibr">Schölkopf et al., 2004</xref>). Each kernel provides a different grasp of the dataset. Furthermore, as similarity measures, kernels are related (but opposite) to the beta-diversities widely used in microbiome analyses. However, although every beta-diversity distance or dissimilarity is paired with a similarity counterpart, not all of them fulfill the aforementioned conditions and are, therefore, kernels.</p>
      <p>We now present two compositional and two non-compositional kernels, all of them available in <italic>kernInt</italic>. In addition, users have the option of entering any kernel matrix, pre-computed with a kernel of their choice. In this work we are restricted only to kernels that can be obtained from taxonomic abundance tables, but further insights can be found in the Discussion.</p>
      <sec id="S2.SS1.SSS1">
        <title>Compositional Kernels</title>
        <p>Here we define two kernels analogous to the linear and RBF kernels, but specific for compositional data. We introduce the Aitchison-RBF kernel as:</p>
        <disp-formula id="S2.Ex1">
          <label>(1)</label>
          <mml:math id="M1">
            <mml:mrow>
              <mml:mi>c</mml:mi>
              <mml:mi>R</mml:mi>
              <mml:mi>B</mml:mi>
              <mml:mi>F</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>x</mml:mi>
                </mml:mstyle>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>i</mml:mi>
                </mml:mstyle>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>x</mml:mi>
                </mml:mstyle>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>j</mml:mi>
                </mml:mstyle>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo> </mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mi>x</mml:mi>
              <mml:mi>p</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:mi>γ</mml:mi>
              <mml:msubsup>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>D</mml:mi>
              </mml:msubsup>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>g</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>G</mml:mi>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mtext>x</mml:mtext>
                                    <mml:mtext>i</mml:mtext>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>l</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>g</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>G</mml:mi>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mtext>x</mml:mtext>
                                    <mml:mtext>j</mml:mtext>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msup>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> represent the taxonomic abundances in two different individuals, <italic>D</italic> is the number of different taxa, <italic>G(.)</italic> is the geometric mean, and γ &gt; 0 is a hyperparameter that has to be tuned. This non-linear kernel derives from the Aitchison distance, which is Euclidean and therefore (Eq. 1) is a valid kernel. The logarithm term can be identified as the compositional clr-transformation (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>) over the original data.</p>
        <p>Analogously, we define the compositional linear kernel as:</p>
        <disp-formula id="S2.E2">
          <label>(2)</label>
          <mml:math id="M2">
            <mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>L</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mpadded width="+2.8pt">
                  <mml:mi>n</mml:mi>
                </mml:mpadded>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi mathvariant="bold">i</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi mathvariant="bold">j</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.3pt" stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo movablelimits="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:munderover>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>o</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                        <mml:mo>⁢</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mtext>x</mml:mtext>
                            <mml:mrow>
                              <mml:mtext>i</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo rspace="8.1pt">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>l</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>o</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                        <mml:mo>⁢</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mtext>x</mml:mtext>
                            <mml:mrow>
                              <mml:mtext>j</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Although cRBF is related to Aitchison distance and has the advantage of non-linearity, cLin is easier to interpret and allows the retrieval of the microbial signatures.</p>
      </sec>
      <sec id="S2.SS1.SSS2">
        <title>Non-compositional Kernels</title>
        <p>The most widely beta-diversity measures are Bray-Curtis, Unifrac and Jensen-Shannon (<xref rid="B14" ref-type="bibr">Gloor et al., 2017</xref>). Bray-Curtis and Jensen-Shannon are computed from taxonomic tables, while Unifrac additionally needs a phylogenetic tree. The Jensen-Shannon is metric and has a kernel counterpart that is already described in <xref rid="B2" ref-type="bibr">Bai and Hancock (2011)</xref> as the Jensen-Shannon Kernel (JSK):</p>
        <disp-formula id="S2.Ex2">
          <label>(3)</label>
          <mml:math id="M3">
            <mml:mrow>
              <mml:mi>J</mml:mi>
              <mml:mi>S</mml:mi>
              <mml:mi>K</mml:mi>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mtext mathvariant="bold">x</mml:mtext>
                  <mml:mi mathvariant="bold">i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mtext mathvariant="bold">x</mml:mtext>
                  <mml:mi mathvariant="bold">j</mml:mi>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>-</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mn>2</mml:mn>
              </mml:mfrac>
              <mml:mrow>
                <mml:mo maxsize="210%" minsize="210%">[</mml:mo>
                <mml:msubsup>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:msubsup>
                <mml:mpadded width="+2.8pt">
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>⁢</mml:mo>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mpadded>
                <mml:mi>ln</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mpadded width="+2.8pt">
                        <mml:mn>2</mml:mn>
                      </mml:mpadded>
                      <mml:mo>⁢</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mpadded width="+2.8pt">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>⁢</mml:mo>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mpadded>
                      <mml:mo rspace="5.3pt">+</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:msubsup>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>D</mml:mi>
              </mml:msubsup>
              <mml:mpadded width="+2.8pt">
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mpadded>
              <mml:mi>l</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mpadded width="+2.8pt">
                      <mml:mn>2</mml:mn>
                    </mml:mpadded>
                    <mml:mo>⁢</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>⁢</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mpadded width="+2.8pt">
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mpadded>
                    <mml:mo rspace="5.3pt">+</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>⁢</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo maxsize="210%" minsize="210%">]</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>provided that <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> contain relative frequencies. The Bray-Curtis dissimilarity is semimetric, and so we propose using Jaccard, a similar distance (<xref rid="B13" ref-type="bibr">Gardener, 2014</xref>), instead. The Jaccard distance is paired with a well-known kernel (<xref rid="B6" ref-type="bibr">Bouchard et al., 2013</xref>) and has a variant suitable for quantitative data. The quantitative Jaccard (also known as Ružička) kernel is defined in <xref rid="B13" ref-type="bibr">Gardener (2014)</xref> as:</p>
        <disp-formula id="S2.E4">
          <label>(4)</label>
          <mml:math id="M4">
            <mml:mrow>
              <mml:mrow>
                <mml:mi>q</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>J</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi mathvariant="bold">i</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi mathvariant="bold">j</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.3pt" stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:msubsup>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mpadded width="+2.8pt">
                      <mml:mi>n</mml:mi>
                    </mml:mpadded>
                    <mml:mo>⁢</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mi>a</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mpadded width="+2.8pt">
                      <mml:mi>x</mml:mi>
                    </mml:mpadded>
                    <mml:mo>⁢</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>⁢</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>All aforementioned kernels have an asymptotic computational complexity of <italic>O</italic>(<italic>N</italic><sup>2</sup><italic>D</italic>).</p>
      </sec>
      <sec id="S2.SS1.SSS3">
        <title>Kernel Methods and Framework</title>
        <p>Kernel methods share the use of symmetric and positive semi-definite matrices (i.e., kernel matrices), and not the original data, as input. That limits the potential similarity measures that one can use to only valid kernels, but also guarantees that every matrix generated can be processed by the kernel method. Furthermore, using kernels places all different analyses in a common mathematical ground (see <xref ref-type="fig" rid="F1">Figure 1B</xref>), which we refer as the kernel framework. For phenotype prediction, we use SVM, a classical method that can perform regression and classification (both binary and multi-class). For the unsupervised analyses we use kernel principal components analysis (kPCA), a kernelized version of the standard algorithm. In both cases, <italic>kernInt</italic> allows the user to choose the values of the hyperparameters and (in the case of SVM) to perform a complete cross-validation and performance evaluation using an independent test set.</p>
      </sec>
    </sec>
    <sec id="S2.SS2">
      <title>Spatial Data</title>
      <p>The kernel framework is particularly well suited for the integration of spatial or heterogeneous data types (<xref rid="B34" ref-type="bibr">Schölkopf et al., 2004</xref>; <xref rid="B24" ref-type="bibr">Mariette et al., 2018</xref>). This is because the integration can be done directly at the kernel matrices level. Let <sub><bold>K1</bold></sub>,…,<sub><bold>KM</bold></sub> be the kernel matrices computed from <italic>M</italic> different sources of data coming from the same individuals. Then, we can obtain a consensus kernel matrix <sup><bold>K</bold>*</sup>:</p>
      <disp-formula id="S2.E5">
        <label>(5)</label>
        <mml:math id="M5">
          <mml:mrow>
            <mml:msup>
              <mml:mtext mathvariant="bold">K</mml:mtext>
              <mml:mo>*</mml:mo>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:munderover>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>z</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>M</mml:mi>
              </mml:munderover>
              <mml:mrow>
                <mml:mpadded width="+2.8pt">
                  <mml:msub>
                    <mml:mi>β</mml:mi>
                    <mml:mi>z</mml:mi>
                  </mml:msub>
                </mml:mpadded>
                <mml:mo>⁢</mml:mo>
                <mml:msub>
                  <mml:mtext mathvariant="bold">K</mml:mtext>
                  <mml:mrow>
                    <mml:mtext>z</mml:mtext>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with the restriction β<sub><italic>z</italic></sub>≥0. The optimal β<sub><italic>z</italic></sub> values can be obtained through an optimization process, which is known as multiple kernel learning (MKL) (<xref rid="B34" ref-type="bibr">Schölkopf et al., 2004</xref>). In unsupervised scenarios, a consensus matrix <sup><bold>K</bold>*</sup> can be obtained by choosing the β coefficients that maximize average similarity of <sup><bold>K</bold>*</sup> with all <sub><bold>Kz</bold></sub> matrices (<xref rid="B24" ref-type="bibr">Mariette et al., 2018</xref>).</p>
    </sec>
    <sec id="S2.SS3">
      <title>Temporal Data</title>
      <p>A time series is an ordered set of repeated samples indexed by time, in the form {<italic>x</italic><sub><italic>i</italic></sub>,<italic>t</italic><sub><italic>i</italic></sub>}. The natural way to summarize this type of data is through a function, which can be obtained using polynomial interpolation or splines. When data contains the time series of several individuals, it is commonly referred as longitudinal data.</p>
      <p>The functional RBF kernel (<xref rid="B10" ref-type="bibr">Chen et al., 2013</xref>) translates the RBF kernel to accept real functions as input. Therefore, evolution over time among individuals is compared and used afterward for phenotype prediction or unsupervised tasks. Let <italic>f</italic>(<italic>t</italic>) and <italic>g</italic>(<italic>t</italic>) be univariate functions, so that they represent the variation of a single feature in two different individuals between the time interval [<italic>t</italic><sub><italic>a</italic></sub>, <italic>t</italic><sub><italic>b</italic></sub>]. Then, the kernel definition is:</p>
      <disp-formula id="S2.E6">
        <label>(6)</label>
        <mml:math id="M6">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>R</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>B</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mpadded width="+2.8pt">
                <mml:mi>F</mml:mi>
              </mml:mpadded>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mi>e</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>p</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mo>-</mml:mo>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">γ</mml:mi>
                    <mml:mo>⁢</mml:mo>
                    <mml:mrow>
                      <mml:mpadded width="+2.8pt">
                        <mml:munderover>
                          <mml:mo movablelimits="false">∫</mml:mo>
                          <mml:msub>
                            <mml:mpadded lspace="2.8pt" width="+2.8pt">
                              <mml:mi>t</mml:mi>
                            </mml:mpadded>
                            <mml:mi>a</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>b</mml:mi>
                          </mml:msub>
                        </mml:munderover>
                      </mml:mpadded>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                                <mml:mo>⁢</mml:mo>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mrow>
                                <mml:mi>g</mml:mi>
                                <mml:mo>⁢</mml:mo>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>|</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>⁢</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo>⁢</mml:mo>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>In an analogous way, the functional linear kernel is defined as:</p>
      <disp-formula id="S2.E7">
        <label>(7)</label>
        <mml:math id="M7">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>L</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mpadded width="+2.8pt">
                <mml:mi>n</mml:mi>
              </mml:mpadded>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo rspace="5.3pt" stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo rspace="5.3pt">=</mml:mo>
            <mml:mrow>
              <mml:munderover>
                <mml:mo movablelimits="false">∫</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>a</mml:mi>
                  </mml:msub>
                  <mml:mo>⁢</mml:mo>
                  <mml:mrow/>
                </mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>b</mml:mi>
                </mml:msub>
              </mml:munderover>
              <mml:mrow>
                <mml:mi>f</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo rspace="5.3pt">)</mml:mo>
                </mml:mrow>
                <mml:mo>⁢</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo rspace="5.3pt">)</mml:mo>
                </mml:mrow>
                <mml:mo>⁢</mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>These kernels allow irregular sampling intervals and missing time points, but suffer of the cost of computing numerically the integral (e.g., if an algebraic solution is not possible). Computations can be simplified if fLin and fRBF are defined for discrete functions, so the modeling of time series as continuous functions is skipped. In this case, <italic>f</italic>(<italic>t</italic>) and <italic>g</italic>(<italic>t</italic>) may directly denote the original objects {<italic>x</italic><sub><italic>i</italic></sub>,<italic>t</italic><sub><italic>i</italic></sub>}, so each time value directly maps to a certain value of the feature variable <italic>x</italic>. If <italic>T</italic> is the total number of time points and Δ<italic>t</italic> the time increment, then:</p>
      <disp-formula id="S2.E8">
        <label>(8)</label>
        <mml:math id="M8">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>R</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>B</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mpadded width="+2.8pt">
                <mml:mi>F</mml:mi>
              </mml:mpadded>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo rspace="5.3pt">=</mml:mo>
            <mml:mrow>
              <mml:mi>e</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>p</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mo>-</mml:mo>
                  <mml:mrow>
                    <mml:mpadded width="+2.8pt">
                      <mml:mi mathvariant="normal">γ</mml:mi>
                    </mml:mpadded>
                    <mml:mo>⁢</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo movablelimits="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:munderover>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi>f</mml:mi>
                              <mml:mo>⁢</mml:mo>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>t</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                              <mml:mo>⁢</mml:mo>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>t</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="S2.E9">
        <label>(9)</label>
        <mml:math id="M9">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>L</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mpadded width="+2.8pt">
                <mml:mi>n</mml:mi>
              </mml:mpadded>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo rspace="5.3pt" stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo rspace="5.3pt">=</mml:mo>
            <mml:mrow>
              <mml:mtext>Δ</mml:mtext>
              <mml:mo>⁢</mml:mo>
              <mml:mi>t</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo movablelimits="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:munderover>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo rspace="5.3pt">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⁢</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo>⁢</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The discrete approach is sound in cases with few data points, when the modeling is less reliable. However, contrarily to (Eqs 6, 7), these expressions cannot deal with irregular sampling times or missing data.</p>
      <p>In multivariate scenarios, for instance microbiome data, many features are simultaneously sampled over time. Let <italic>f</italic><sub><italic>k</italic></sub> and <italic>g</italic><sub><italic>k</italic></sub> model taxon <italic>k</italic> in two individuals, being <italic>D</italic> the total number of taxa. The aforementioned kernels can be combined as in:</p>
      <disp-formula id="S2.E10">
        <label>(10)</label>
        <mml:math id="M10">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>R</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>B</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:msup>
                <mml:mi>F</mml:mi>
                <mml:mo>′</mml:mo>
              </mml:msup>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:munderover>
                <mml:mo movablelimits="false">∏</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>D</mml:mi>
              </mml:munderover>
              <mml:mrow>
                <mml:mi>f</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>R</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>B</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>F</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>f</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.3pt">,</mml:mo>
                  <mml:msub>
                    <mml:mi>g</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="S2.E11">
        <label>(11)</label>
        <mml:math id="M11">
          <mml:mrow>
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>L</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo>⁢</mml:mo>
              <mml:msup>
                <mml:mi>n</mml:mi>
                <mml:mo>′</mml:mo>
              </mml:msup>
              <mml:mo>⁢</mml:mo>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:munderover>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>D</mml:mi>
              </mml:munderover>
              <mml:mrow>
                <mml:mi>f</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>L</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>⁢</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>f</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.3pt">,</mml:mo>
                  <mml:msub>
                    <mml:mi>g</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>With a computational complexity of <italic>O</italic>(<italic>N</italic><sup>2</sup><italic>T</italic><italic>D</italic>) if (Eqs 8, 9) are used.</p>
      <p>It should be noted that the kernel approach allows the integration of data that is both spatial and temporal-structured. <italic>kernInt</italic> first handles the temporal dimension using a kernel for longitudinal data (fLin or fRBF) over each space point, and then integrates the spatial dimension by performing MKL over the fLin or fRBF kernel matrices coming from the same individual.</p>
    </sec>
    <sec id="S2.SS4">
      <title>Microbial Signature</title>
      <p>In a broad sense, the “microbial signature” is the collection of taxa associated with a trait of interest that has a high predictive value in the context of a given model (<xref rid="B32" ref-type="bibr">Rivera-Pinto et al., 2018</xref>). It can be retrieved from a linear SVM using the orientation of the separating hyperplane (<xref rid="B15" ref-type="bibr">Guyon et al., 2002</xref>): if the plane is orthogonal to a particular feature dimension, then that feature is maximally informative. This method takes into account the correlation between taxa. As cLin is a translation of the linear kernel for compositional data, using (Eq. 2) we can retrieve the microbial signatures, which should be understood as the taxa importances after the clr-transformation. The same occurs when assessing the variable influence on the principal components in kPCA. A general permutation technique is proposed in <xref rid="B24" ref-type="bibr">Mariette et al. (2018)</xref>, but using cLin permits obtaining the taxa influence in the same straightforward way than standard principal components analysis (PCA).</p>
      <p>The linearity also permits extending the microbial signature retrieval, when using SVM, to the longitudinal and spatial cases. When performing MKL, as long as the cLin kernel is strictly applied to all sampled sites, the global importance of a given taxon among all sites can be computed as the weighted sum (using the optimal β coefficients) of its partial importance in each site. In the longitudinal case, the global importance of each taxon <italic>k</italic> can be obtained from (Eq. 9) by addition of the partial importances over all <italic>T</italic> time points.</p>
    </sec>
    <sec id="S2.SS5">
      <title>Case Studies and Data Pre-processing</title>
      <p>We illustrate our framework with three case studies: a single point dataset, a dataset with a spatial component, and a longitudinal dataset. The latter is previously unpublished while the rest of the data is public.</p>
      <sec id="S2.SS5.SSS1">
        <title>Soil Dataset</title>
        <p>Bacterial composition of soil varies significantly at a biogeographical scale, and is related to chemical and environmental factors. Here we reanalyzed a single point dataset by <xref rid="B20" ref-type="bibr">Lauber et al. (2009)</xref>, who used 16S small-subunit ribosomal (16S rRNA) gene pyrosequencing to profile the bacterial communities of different soils across North and South America. Authors reported that soil pH was significantly correlated with beta-diversity distances between samples. They also found correlation with alpha diversity, which was highest in soils with near-neutral pHs. To perform our analysis, we retrieved the taxonomic abundances as well as the associated metadata from Qiita <ext-link ext-link-type="uri" xlink:href="https://qiita.ucsd.edu/">https://qiita.ucsd.edu/</ext-link> (ID: 103). The number of operational taxonomic unit (OTUs) was 7,396, while the number of soil samples was 89. As a part of the pre-processing, we excluded sample number 89, with only 1 read, which was also not included in the original paper.</p>
      </sec>
      <sec id="S2.SS5.SSS2">
        <title>Smokers Dataset</title>
        <p><xref rid="B8" ref-type="bibr">Charlson et al. (2010)</xref> analyzed the impact of cigarette smoking on the global airway microbial population. Bacterial communities were profiled using 454 pyrosequencing of the 16S rRNA gene in four airway sites: the left and right sides of nasopharynx and oropharynx. Authors reported that composition was primarily determined by airway site, with individuals exhibiting minimal lateral or temporal variation. They used RF to predict the smoking status from the taxonomic abundances. We retrieved the dataset (metadata and taxonomic abundances) from Qiita (ID: 524) to perform our analysis. Of the original 70 individuals, we discarded those that reported airway illness or antibiotic usage in the 3 months prior to sampling. Thus, we analyzed the same 62 individuals of the original work (29 smokers and 33 non-smokers). Number of different OTUs was 2,817.</p>
      </sec>
      <sec id="S2.SS5.SSS3">
        <title>Pig Dataset</title>
        <p>Here we present a previously unpublished dataset, which evaluates the relationship of pre-weaning diarrhea with the early gut microbiota colonization in piglets. Gut microbiota was profiled in 153 piglets during their first week of life. Between days 8 and 21 (weaning day), 79 out of the 153 piglets had diarrhea and were treated with antibiotics. Swab sampling was done within 5 min after farrowing (day 0) and at days 3 and 7 post-farrowing. DNA was extracted from fecal samples and profiled using Illumina sequencing of 16S rRNA gene in each of the three time points. The cleaned sequences were processed into amplicon sequence variants (ASVs). Further details are described in <xref ref-type="supplementary-material" rid="DS1">Supplementary Method 0</xref>. Analyses were carried out at the ASV (3,577 ASVs were obtained) and at the Genera taxonomic levels.</p>
      </sec>
    </sec>
    <sec id="S2.SS6">
      <title>Experimental Set-Up</title>
      <p>Analyses across the three datasets included a comparison with the original reports (for Soil and Smokers datasets), as well as contrast with results from RF. The cLin and cRBF kernels were applied directly to the raw counts, as they handle data in an inherently compositional manner. Before computing both kernels, a number under the detection limit was added to all dataset entries to handle zeroes (<xref rid="B31" ref-type="bibr">Quinn et al., 2018</xref>). An alternative normalization of data, the cumulative sum scaling (<xref rid="B29" ref-type="bibr">Paulson et al., 2013</xref>) was performed prior to applying the non-compositional Jensen-Shannon and Jaccard kernels. That way the compositional and non-compositional kernels could be compared. In the rest of cases (RF and longitudinal) we used the compositional clr-transform over data. RF were obtained with the R package <italic>randomForest</italic> (<xref rid="B22" ref-type="bibr">Liaw and Wiener, 2002</xref>), while the kernel approach was carried out using <italic>kernInt</italic> (which relies on the <italic>kernlab</italic> package for computing kPCA and SVM). A step-by-step guide with examples can be found at the <italic>kernInt</italic> package vignette: <ext-link ext-link-type="uri" xlink:href="https://elies-ramon.github.io/kernInt/">https://elies-ramon.github.io/kernInt/</ext-link>.</p>
      <p>Unsupervised analyses were carried out using the whole datasets. Instead, for the supervised analyses, each dataset was split at random into the training set (80% of data) and the test set (20%). Optimal hyperparameters’ values (number of trees in RF, cost in SVM, and γ for RBF-like kernels) and β coefficients for MKL were obtained by 5 × 5 cross-validation on the training set. Hyperparameters’ ranges are in <xref ref-type="supplementary-material" rid="DS1">Supplementary Table 1</xref>. Once the best values were found, the final model was built using the whole training set. We repeated the whole process 40 times, each time with different 80/20 randomly split training/test partitions, to obtain an error distribution. Performance over the test set was computed using normalized mean squared error (NMSE) for regression and Accuracy for classification. We measured with the <italic>microbenchmark</italic> package the running time of computing the SVM models on a 64-bit Ubuntu 20.04 LTS workstation with Intel(R) Core(TM) i5-6300U CPU at 2.40 GHz and 12 GiB of RAM (see <xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 1</xref>). For the sake of comparison, the running time of several RF implementations (including the <italic>randomForest</italic> package) can be found at <xref rid="B43" ref-type="bibr">Wright and Ziegler (2017)</xref>.</p>
      <p>For the Smokers and Pig case studies, additional considerations had to be taken into account. In the Smokers dataset, in addition to the kPCA analysis, we computed the similarity among kernel matrices of different body sites with the <italic>mixKernel</italic> package (<xref rid="B24" ref-type="bibr">Mariette et al., 2018</xref>). We compared the performance of data integration via MKL (the kernel approach) with that of RF when using early and late integration approaches. In the former case, the input of the RF was the concatenated data of the four sites. Instead, in the latter case we used the forests created for each site separately to vote for the final decision (<xref rid="B21" ref-type="bibr">Li et al., 2018</xref>).</p>
      <p>In the Pig dataset, to make sure that the training and test sets were completely independent, piglets from the same litter (full sibs) were always placed either in one or other set. Performance of fLin and fRBF was contrasted to those of RF and their analogous non-longitudinal kernels (cLin and cRBF) using all available days at once. For the non-longitudinal methods, 80% of the piglets were used to train the model, using their three time points data in separate rows, with time included as an additional variable. The remaining piglets were reserved to test the model, but using only one of their time points (either day 0, 3, or 7) chosen at random and discarding the rest. This way, both longitudinal and non-longitudinal approaches had the same test set size. Longitudinal kernels fLin and fRBF were computed using (Eq. 9) and (Eq. 8), as only three time points were available and we preferred not to interpolate the day’s in-between. Also, using the expression for discrete functions we could obtain the microbial signatures. The information of all taxa was combined as in (Eqs 11, 10) and the training/test partitions were carried out as in the normal case. In a second step, the dataset was decomposed by sampling times and the analysis was carried out for days 0, 3, and 7 separately using RF, cLin and cRBF in the usual way.</p>
      <p>Microbial signatures from SVMs were obtained from the hyperplane normal vector <italic>w</italic>. The importance of taxon <italic>k</italic> is computed by <italic>kernInt</italic> as <sup>(<italic>w</italic><italic>k</italic>)2</sup> (<xref rid="B15" ref-type="bibr">Guyon et al., 2002</xref>). When using RF, we used the mean decrease in node impurity (for regression tasks) and mean decrease in Gini index (for classification). Both RF and SVM give absolute values of taxa importance, so they were converted to relative values. We used the R package <italic>MiRKAT</italic> (<xref rid="B45" ref-type="bibr">Zhan et al., 2017</xref>) to test if the association of the target phenotype with the signatures we obtained was statistically significant.</p>
    </sec>
  </sec>
  <sec id="S3">
    <title>Results</title>
    <sec id="S3.SS1">
      <title>Soil Data</title>
      <p>The cLin kPCA over the bacterial abundances is shown in <xref ref-type="fig" rid="F2">Figure 2A</xref>. The remaining kPCAs, which gave a similar profile, can be found at <xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 2</xref>. Soil samples are clearly separated by their pH, in agreement with the original results. The U-shaped projection is typical of data structured by a gradual transition with few overlapping OTUs at the endpoints (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 3</xref>). The peak diversity in near-neutral soils in contrast with extreme pHs may also have some effect (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 4</xref>). In addition, we used SVMs with the four kernels described above to predict the pH of each soil site from the bacterial abundances. This was not done in the original work and so we used RF, a non-kernel, alternative method, as benchmark. Results are shown in <xref ref-type="fig" rid="F2">Figure 2B</xref>. The best compositional kernel was cLin, having a median error of ∼0.09; and the best non-compositional one was JSK, with a median error of ∼0.10. In comparison, RF had a higher median error, almost the double of cLin, around 0.17.</p>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p><bold>(A)</bold> Compositional linear kPCA over the 88 soils. Color represents pH, while point size stands for the number of different observed taxa. <bold>(B)</bold> pH prediction error distribution over the 40 replicates. <bold>(C,D)</bold> Top relevant taxa for pH prediction according to RF and cLin-SVM. Standard error across the 40 replicates is marked with error bars.</p>
        </caption>
        <graphic xlink:href="fmicb-12-609048-g002"/>
      </fig>
      <p>To go further in the interpretation of the results, we analyzed the microbial signature retrieved from RF and cLin-SVM. The distribution of the importances was highly skewed. For subsequent analyses we kept only 5% of the taxa, which accounted for around the 90% (RF) and 95% (SVM) of total importance, with the two methods having 42% of OTUs in common. Top ten relevant taxa are shown in <xref ref-type="fig" rid="F2">Figure 2C</xref> (RF) and <xref ref-type="fig" rid="F2">Figure 2D</xref> (SVM). In agreement with the kPCA results, prediction is primarily driven by few OTUs of extreme pH ecosystems (e.g., genera <italic>Rubrobacter</italic> and <italic>Balneimonas</italic> on the basic side, orders <italic>Solibacterales</italic> and <italic>RB41</italic> on the acid side). We used <italic>MiRKAT</italic> to test the significance of the association of the pH with both the top ten and 5% most important taxa, according to the cLin kernel. In both cases, we obtained very low <italic>p</italic>-values (&lt;10<sup>–8</sup>).</p>
    </sec>
    <sec id="S3.SS2">
      <title>Smokers Data</title>
      <p>We predicted smoking status from the taxonomic abundances. At first models were built using the four sites separately, as in the original study. Authors used RF and reported a median accuracy of 64% on the right and 65% on the left oropharynx (i.e., throat), and 71% on the right and 68% on the left nasopharynx. We re-computed the RF accuracies with our data pre-processing, and obtained very similar results (<xref ref-type="fig" rid="F3">Figure 3A</xref>), with the only exception of the right nasopharynx (new median accuracy: 66%). Regarding the kernels, the worst one was cLin (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 5</xref>), which nonetheless gave similar accuracies to RF. The best kernel was the Jaccard kernel (<xref ref-type="fig" rid="F3">Figure 3A</xref>), which improved substantially the RF accuracies, especially in the throat. Then, we combined the spatial-structured samples of the same individuals to test if accuracy increased when using an integrative approach (<xref ref-type="fig" rid="F3">Figure 3A</xref>). For the kernels, we first used MKL to combine the kernel matrices at the airway level (nasopharynx on one hand and oropharynx on the other) and, finally, we integrated all sites. This decreased the error substantially and delivered the best classification result, with a median accuracy of 92%. As for the RF, we tested both the early integration approach and the late integration approach, and found that the latter granted better predictions. At best, integration of the four sites delivered a median accuracy of 83%. The results for the rest of kernels can be found in <xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 5</xref>. In all cases, integration of the four datasets using our MKL proposal increased the accuracy in comparison to the individual models, and doing so gave better or equivalent results that those of RF integration approaches. The only exceptions to this trend were the nasopharynx and oropharynx models delivered by cLin (but not the model with the four sites combined).</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p><bold>(A)</bold> Non-smoker/smoker accuracies from taxonomic data: RF (green) vs. the quantitative Jaccard kernel (red). NoseL, NoseR, OroL, and OroR models are obtained from single datasets, the Nasopharynx and Oropharynx panels contain the information from the right and left sides, and All the combination of the four datasets. Early and Late refer to the early integration and late integration approaches for RF. <bold>(B)</bold> Top ten global cLin-SVM importances across all body sites. <bold>(C)</bold> Similarity across the Jaccard kernel matrices of the four sites (Nasopharynx Right and Left and Oropharynx Right and Left). <bold>(D)</bold> Jaccard kPCA of the taxonomic abundances. Color code represent airway site, whereas shape indicates the laterality of the samples.</p>
        </caption>
        <graphic xlink:href="fmicb-12-609048-g003"/>
      </fig>
      <p>Next, we recovered the overall microbial signature (i.e., across the four sampling sites). The importance distribution is not as skewed as in the Soil dataset: here the top 5% taxa accounted for the 62% of overall importance. The association of this subset of taxa with the target phenotype was highly significant (<italic>p</italic>-value &lt; 10<sup>–8</sup>). Top ten taxa are shown in <xref ref-type="fig" rid="F3">Figure 3B</xref>. <italic>Neisseria</italic> sp. large impact in discriminating smokers from non-smokers was already reported in the original work, especially in oropharynx models. The rest of highlighted taxa in <xref ref-type="fig" rid="F3">Figure 3B</xref> were also noted to have a role, either in models from nasopharynx alone or from both airways sites (<xref rid="B8" ref-type="bibr">Charlson et al., 2010</xref>). This mostly agrees with our results when the sampling sites are analyzed separately (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 6</xref>).</p>
      <p>Following the original work, differences in bacterial communities among the body sites were also analyzed. We present results for the Jaccard kernel in <xref ref-type="fig" rid="F3">Figures 3C,D</xref>, while the rest are in <xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 7</xref>. <xref ref-type="fig" rid="F3">Figure 3C</xref> shows the similarity across kernel matrices derived from left and right nasopharynx and oropharynx. The highest similarity was achieved within matrices of the same airway site but different laterality. As in the original paper (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 8</xref>), using a kPCA (<xref ref-type="fig" rid="F3">Figure 3D</xref>) we could discriminate between nasopharynx and oropharynx sites (first PC) but not between left and right.</p>
    </sec>
    <sec id="S3.SS3">
      <title>Pig Data</title>
      <p>Evolution of gut microbiota from 153 healthy piglets over their first week of life was used to predict the occurrence of pre-weaning diarrhea. In <xref ref-type="fig" rid="F4">Figure 4A</xref> we compared the performance of the longitudinal kernels (fLin and fRBF) vs. their analogous non-longitudinal kernels (cLin and cRBF) plus RF when using all available days at once. The longitudinal approach clearly outperformed the non-longitudinal approach at both Genera and ASVs levels. fRBF had a better performance than fLin, and worked best at the ASV level (with a median accuracy around 76%) than in Genera data (median accuracy ∼70%). Although aggregating taxa to the genus level is a relatively common practice –see e.g., <xref rid="B32" ref-type="bibr">Rivera-Pinto et al. (2018)</xref>–, in our case using a coarser taxonomic resolution decreased the accuracy. Within the non-longitudinal approach, we obtained similar accuracies using RF and kernels, and both were close to the median accuracy of the random model (50.1%). To further understand the results, the analysis was carried out in days 0, 3, and 7 separately using RF, cLin and cRBF kernels. <xref ref-type="fig" rid="F4">Figure 4B</xref> reveals that all models from days 0 and 3 had no predictive power. Accuracy increased dramatically after day 7 to a maximum of 73% for cRBF (ASV level), only slightly worse than its analogous longitudinal kernel fRBF. We used the kernel machine test of <italic>MiRKAT</italic> to further confirm that days 0 and 3 were not significantly associated with phenotype, while day 7 was. As expected, only the kernel matrices of day 7 delivered significant <italic>p</italic>-values (Genera: cLin <italic>p</italic>-value &lt; 10<sup>–6</sup>, RBF <italic>p</italic>-value &lt; 10<sup>–7</sup>; ASV: cLin and cRBF <italic>p</italic>-values &lt; 10<sup>–8</sup>) after Bonferroni correction.</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p><bold>(A)</bold> Accuracy for RF, non-longitudinal kernels (cRBF, cLin) and Longitudinal kernels (fLin, fRBF) in the prediction of neonatal diarrhea from all available days. <bold>(B)</bold> Accuracy for RF and non-longitudinal cLin and cRBF kernels from metagenomic data of days 0, 3, and 7 post-birth separately. In both panels, the red dashed line marks the accuracy of the random model.</p>
        </caption>
        <graphic xlink:href="fmicb-12-609048-g004"/>
      </fig>
      <p>In a second step we analyzed the kPCA and microbial signatures, after discarding all models without predictive power. <xref ref-type="fig" rid="F5">Figures 5A,B</xref> show the fLin and cLin (day 7) kPCA, while fRBF and cRBF are in <xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 9</xref>. In all cases a partial separation between healthy and sick piglets, with a large area of overlap, is observed. Genera relevance on prediction of pre-weaning diarrhea is shown in <xref ref-type="fig" rid="F5">Figures 5C–E</xref>. We discuss the microbial signature at the Genera level, as around 2/3 of the ASVs lack species assignation (<xref ref-type="supplementary-material" rid="DS1">Supplementary Figure 10</xref>). According to fLin, beneficial genera like <italic>Lactobacillus</italic> and <italic>Bacteroides</italic> had the higher overall importance during the first week. In day 7, it was striking the great importance given by cLin to <italic>Desulfovibrio</italic>, and secondarily to <italic>Streptococcus</italic>. RF also highlighted the butyrate-producing genus <italic>Dorea</italic>. Distribution of the microbial signature at the ASV level was skewed, but again, much less than in the Soil case study. The top 5% ASVs accounted for a 46% (fLin) and 58% (cLin) of the total importance, with an overlap between RF and cLin in day 7 of 2/3 of the ASVs. The association of the 5% most important taxa (global and day 7) with the phenotype was statistically significant according to MiRKAT (<italic>p</italic>-values &lt; 10<sup>–8</sup>).</p>
      <fig id="F5" position="float">
        <label>FIGURE 5</label>
        <caption>
          <p>Above: kPCA of fLin in panel <bold>(A)</bold> and of cLin (day 7) in panel <bold>(B)</bold>. Below: Microbial signatures at the Genera level. Global importance for the first week is in panel <bold>(C)</bold>. Importances for the day 7 according to the cLin kernel and RF are in panels <bold>(D,E)</bold>. Standard error across the 40 replicates is marked with error bars.</p>
        </caption>
        <graphic xlink:href="fmicb-12-609048-g005"/>
      </fig>
    </sec>
  </sec>
  <sec id="S4">
    <title>Discussion</title>
    <p>The kernel framework allows performing a great diversity of analyses in a common ground, while allowing a great flexibility on how data is approached. However, within the microbiome field, previous application of kernel methods has been mostly restricted to specific areas. <xref rid="B45" ref-type="bibr">Zhan et al. (2017)</xref> proposed a kernel-based semi-parametric regression method for testing the association of the human microbiota communities with multiple phenotypes. Their method was implemented in the R package <italic>MiRKAT</italic>. In turn, <xref rid="B24" ref-type="bibr">Mariette et al. (2018)</xref> combined metagenomic data and environmental measures of the TARA ocean expedition using unsupervised MKL with the <italic>mixKernel</italic> package. In some reports that compare the performance of different supervised methods in microbiome data, SVM often appear along RF or ANN (<xref rid="B30" ref-type="bibr">Qu et al., 2019</xref>; <xref rid="B46" ref-type="bibr">Zhou and Gallins, 2019</xref>; <xref rid="B28" ref-type="bibr">Namkung, 2020</xref>). Thus, kernel methods were mostly used in an isolated way, without exploiting the kernel framework ability to integrate a great range of analyses while giving a unitary view. Another advantage of this framework is that it can handle virtually any data type. However, to our best knowledge, it has not been previously applied to longitudinal microbiome studies. Finally, in previous works there was a lack of kernels that took into account the compositional nature of metagenomic datasets. Here we addressed all these questions, while also providing some examples of how previous kernel-based tools like <italic>MiRKAT</italic> and <italic>mixKernel</italic> can fit into our framework.</p>
    <p>When comparing <italic>kernInt</italic> to a popular package for microbiome analysis like QIIME2, it becomes apparent that the former is more specific in its scope. <italic>kernInt</italic> is not concerned with sequence alignment, taxonomic assignation and quality control as QIIME2 is, but with the analysis once the abundance table is obtained. Both packages are aimed at community ecology analysis (in QIIME2: alpha and beta diversities, PCoA, etc.) and supervised learning areas. While <italic>kernInt</italic> does not have the great range of methods available in QIIME2, it improves the current state-of-the-art in the following points: (i) Proposal and implementation of specific kernels for microbiota, while QIIME2 currently provides default kernels for real vectors (the linear, RBF, polynomial and sigmoid kernels). (ii) As far as we know, SVM is available in QIIME2 but kPCA is not; therefore, it is not possible performing both supervised and unsupervised analysis under the same mathematical point of view (<xref ref-type="fig" rid="F1">Figure 1</xref>). (iii) Integration of spatial and temporal samples: QIIME2 does not have a specific handling of spatial (and, potentially, multi-omic) data, while <italic>kernInt</italic> allows performing unsupervised, supervised and retrieval of microbial signatures in this kind of datasets. On the other hand, the QIIME2 “longitudinal” plugin implements several tools for longitudinal data, but the option of performing supervised learning from the variation of microbiota over time is absent.</p>
    <p>Throughout this work, we summarized the microbiome analyses in three branches: unsupervised learning (represented by kPCA), supervised learning (SVM) and identification of phenotype-associated microbial signatures. The Soil case study clearly illustrated how all three types are intertwined and complementary. In agreement with the original publication, both SVM and kPCA results showed that taxonomic abundances and pH are strongly related. This granted a quite low prediction error (up to a median NMSE of 0.09) but, by itself, does not explain the underlying mechanism connecting microbial abundance and pH. Microbial signature revealed that the SVM learning is driven by few taxa of opposite pH ecosystems. For instance, <italic>RB41</italic> belong to the phylum <italic>Acidobacteria</italic>. The <italic>Rubrobacter</italic> genus contains well known extremophiles and, like the <italic>Balneimonas</italic> (renamed <italic>Microvirga</italic>) genus, has preference for clearly alkaline soils (<xref rid="B12" ref-type="bibr">Dahal and Kim, 2017</xref>; <xref rid="B9" ref-type="bibr">Chen et al., 2018</xref>). Furthermore, the arch in the kPCA projection indicated that communities from acid and basic habitats did not overlap (<xref rid="B27" ref-type="bibr">Morton et al., 2017</xref>). Taken together, these complementary views point that soil microbial structure is shaped by a gradual niche differentiation strongly modulated by the pH. This agrees with previous findings on this dataset (<xref rid="B20" ref-type="bibr">Lauber et al., 2009</xref>; <xref rid="B27" ref-type="bibr">Morton et al., 2017</xref>) but appears in a more concise and unified way using the kernel framework.</p>
    <p>In comparison to other methods, the kernel framework did not only allow a holistic view of data, but also gave good results in each learning area. Concerning supervised learning, in general, the kernel methods tend to have an advantage over variable-oriented methods (e.g., in supervised learning: ridge regression, decision trees, RF, etc.) and over ANN (for the reasons stated in the “Introduction” section) when faced with <italic>N</italic> &lt; &lt; &lt; <italic>D</italic> data. This is a common scenario in metagenomics when working at the OTU or ASV level, but not necessarily in coarser taxonomic resolutions. This is illustrated with the different behavior of kernels with respect to RF in <xref ref-type="fig" rid="F4">Figure 4B</xref> (see ASV vs. Genera results). In the other cases, SVM were consistently better (or at least equivalent) to RF in all the case studies that we analyzed. This disagrees with some previous reports in the microbiome area, e.g., <xref rid="B46" ref-type="bibr">Zhou and Gallins (2019)</xref>. However, it should be noted that SVM performance depends on the kernel used, and these reports used generic linear and RBF kernels. Even when using kernels specific for metagenomic data, we observed differences among their mean NMSE or accuracies as large as fifteen percentage points. At the same time, our results suggest that there is not a single kernel that systematically achieves the best performance in every problem. We found that cLin was the best one in the first case study, quantitative Jaccard in the second and fRBF in the third. In this scenario, we consider that the linear-like kernels like cLin are a safe starting point. They allow for the retrieval of the microbial signatures, are faster to compute and easier to interpret than non-linear kernels, and with high-dimensional data (&gt;10<sup>3</sup>–10<sup>4</sup> taxa) they tend to match the RBF kernel (usually considered the gold standard) in performance (<xref rid="B17" ref-type="bibr">Hsu et al., 2003</xref>; <xref rid="B19" ref-type="bibr">Keerthi and Lin, 2003</xref>). RBF may be useful if the number of different taxa is low, or when a strong non-linear relationship is suspected. The weakness of the compositional kernels that we proposed is that they cannot handle zeroes without pre-processing; instead, zeroes pose no problems to the quantitative Jaccard kernel. How to deal with zeroes is, currently, an open topic of research in compositional analysis (<xref rid="B41" ref-type="bibr">Weiss et al., 2017</xref>; <xref rid="B31" ref-type="bibr">Quinn et al., 2018</xref>). If there is not enough <italic>a priori</italic> information that permits selecting the kernel beforehand, visual assessment of the candidate kernel matrices via kPCA could be of some help. A more rigorous approach is to perform nested cross-validation (<xref rid="B7" ref-type="bibr">Cawley and Talbot, 2010</xref>) to avoid overfitting when selecting both the candidate hyperparameters’ values and the best kernel for a given problem. Finally, phylogenetic kernels were beyond the scope of this work, nor the available datasets had the phylogenetic trees needed to compute them. However, they may be derived from (Eqs 1, 2) by replacing the clr term with other transformations, e.g., the PhILR transformation (<xref rid="B37" ref-type="bibr">Silverman et al., 2017</xref>). A phylogeny-based kernel was also proposed in <xref rid="B44" ref-type="bibr">Xiao and Chen (2017)</xref>.</p>
    <p>Concerning our unsupervised analyses, we observed that the main structure revealed by the original MDS/PCoA (ordination by pH in the Soil dataset, and by body site in the Smoker dataset) was conserved in our kPCAs. On the other hand, microbial signatures obtained with SVM had a biological interpretation. In general, the most important taxa retrieved from SVM coincided with those of RF (40–65% of overlap depending on the dataset), and could be recovered too when dealing with spatial and temporal-structured datasets. However, we acknowledge that a drawback of these signatures (though they handle well the cases of multicollinearity) is that they are based on linear kernels. In turn, RF can take into account both non-linearity and complex interactions among taxa. In any case, the informativeness of a microbial signature can be assessed by the prediction performance of the SVM model that generated it.</p>
    <p>Apart of the aforementioned advantages of the kernel framework, we also showed how it can accommodate datasets with spatial and/or temporal components. We illustrated the integration of spatial-structured samples with the Smokers dataset. The analysis in the original work was carried out in each sampling site independently, with a maximum median accuracy of 71%. Here we showed how combining the body sites using MKL increased the median accuracy to 92%. Therefore, our results remark the relevance of using an integrative approach to improve the accuracy of phenotype prediction when spatial-structured samples of the same individuals are available.</p>
    <p>In addition to the package and framework proposal, we analyzed a previously unpublished dataset profiling the microbiota evolution and pre-weaning diarrhea incidence in 153 piglets. Through this dataset we illustrated the kernel framework application to time-structured samples. Pre-weaning diarrhea is an important issue in pig production, as the antibiotic treatment increases both the emergence of resistances and the economic costs. It is already known that gut colonization starts immediately after birth, and it evolves from a highly variable to a more stable and homogeneous ecosystem over the first weeks. However, most of the current studies in pig production ignore early dynamics in gut microbiota (<xref rid="B23" ref-type="bibr">Mach et al., 2015</xref>; <xref rid="B16" ref-type="bibr">Han et al., 2018</xref>; <xref rid="B25" ref-type="bibr">Massacci et al., 2020</xref>). We wanted to test if pre-weaning diarrhea could be anticipated as soon as the first week of life. In this sense, our results suggest that the first stages of intestinal microbiota convey some valuable information indeed. kPCAs showed a partial separation between piglets affected of diarrhea vs. healthy piglets, and by using longitudinal kernels we achieved a moderate accuracy of 76%. However, it was unclear if this accuracy was to be attributed to a different taxa evolution in the two groups over the first week, or to a single time point with a great predictive value. The day-by-day prediction clarified this issue, and showed that day 7 achieved a median accuracy of 73% while the rest of points lacked predictive power. Even so, longitudinal kernels were able to slightly improve prediction (76% vs. 73% at the ASV level, and 69% vs. 64% using Genera), so global taxa evolution may also have a small role.</p>
    <p>This is also seen in the underlying microbial signatures of the global first week (fLin) vs. day 7 (cLin). To be noted, in day 7 the most important genus was sulfate-reducing bacteria <italic>Desulfovibrio</italic>, which is known to have a relevant role during pig gut colonization (<xref rid="B23" ref-type="bibr">Mach et al., 2015</xref>). Instead, the global (longitudinal) model was mainly led by <italic>Lactobacillus</italic> and <italic>Bacteroides</italic>. Relationship of both genera to pre-weaning diarrhea is well sustained in literature. <italic>Lactobacillus</italic> spp. are well known probiotic bacteria, while members of <italic>Bacteroides</italic> genus are associated with increased infants gut microbial diversity (<xref rid="B39" ref-type="bibr">Stewart et al., 2018</xref>). Furthermore, both play an important role on mammals’ gut microbial colonization (<xref rid="B33" ref-type="bibr">Sawicki et al., 2017</xref>; <xref rid="B42" ref-type="bibr">Wexler and Goodman, 2017</xref>) and are dominant in healthy pigs compared with diarrhea-affected piglets (<xref rid="B38" ref-type="bibr">Song et al., 2017</xref>), which gives confidence in the reliability of our findings.</p>
    <p>In summary, our kernel framework successfully places the most important analyses in the microbiome field on a common ground, takes into account the compositionality of data, and is flexible enough to integrate spatial and temporal dimensions of the datasets.</p>
  </sec>
  <sec sec-type="data-availability" id="S5">
    <title>Data Availability Statement</title>
    <p>The data analyzed in this study is subject to the following licenses/restrictions: This manuscript utilizes proprietary data. Requests to access these datasets should be directed to YR-C/IRTA/yuliaxis.ramayo@irta.cat.</p>
  </sec>
  <sec id="S6">
    <title>Ethics Statement</title>
    <p>The animal study was reviewed and approved by the Central Authority for Scientific Procedures on Animals of Netherlands–Centrale Commissie Dierproeven (CCD).</p>
  </sec>
  <sec id="S7">
    <title>Author Contributions</title>
    <p>YR-C, MP-E, RQ, and ER contributed to conception and design of the study. FM was in charge of the pig data sampling. YR-C and MP-E supervised the overall research, while LB-M supervised the machine learning part. ER performed the all analysis and wrote the first draft of the manuscript. YR-C, MP-E, and LB-M revised and wrote sections of the manuscript. All authors contributed to manuscript revision, read, and approved the submitted version.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was funded by projects PID2019-108829RB-I00, AGL2016–78709-R, and AGL2017–88849-R awarded by the Spanish Ministry of Economy and Competitiveness. ER has funding from a FI-AGAUR Ph.D. studentship grant, with the support of the Secretaria d’Universitats i Recerca de la Generalitat de Catalunya and the European Social Fund. YR-C is recipient of a Ramon y Cajal post-doctoral fellowship (RYC2019-027244-I) from the Spanish Ministry of Science and Innovation. We acknowledge further financial support from the Spanish Ministry of Economy and Competitiveness through the “Severo Ochoa Programme for Centres of Excellence in R&amp;D” 2016–2019 (SEV-2015-0533),” and from the EU through the BFU2016–77236-P (MINECO/AEI/FEDER, EU).</p>
    </fn>
  </fn-group>
  <ack>
    <p>The authors warmly thank all technical staff from Schothorst Feed Research.</p>
  </ack>
  <sec id="S10" sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fmicb.2021.609048/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fmicb.2021.609048/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="DS1">
      <media xlink:href="Data_Sheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Argelaguet</surname><given-names>R.</given-names></name><name><surname>Velten</surname><given-names>B.</given-names></name><name><surname>Arnol</surname><given-names>D.</given-names></name><name><surname>Dietrich</surname><given-names>S.</given-names></name><name><surname>Zenz</surname><given-names>T.</given-names></name><name><surname>Marioni</surname><given-names>J. C.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Multi-Omics Factor Analysis–a framework for unsupervised integration of multi-omics data sets.</article-title>
<source><italic>Mole. Syst. Biol.</italic></source>
<volume>14</volume>:<issue>e8124</issue>.</mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>L.</given-names></name><name><surname>Hancock</surname><given-names>E. R.</given-names></name></person-group> (<year>2011</year>). <source><italic>Graph clustering using the jensen-shannon kernel. In International Conference on Computer Analysis of Images and Patterns</italic></source>, <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>, <volume>2011</volume>
<fpage>394</fpage>–<lpage>401</lpage>.</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>G.</given-names></name><name><surname>Rybakova</surname><given-names>D.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Cernava</surname><given-names>T.</given-names></name><name><surname>Vergčs</surname><given-names>M. C. C.</given-names></name><name><surname>Charles</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Microbiome definition re-visited: old concepts and new challenges.</article-title>
<source><italic>Microbiome</italic></source>
<volume>8</volume>
<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">31901242</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bodein</surname><given-names>A.</given-names></name><name><surname>Chapleur</surname><given-names>O.</given-names></name><name><surname>Droit</surname><given-names>A.</given-names></name><name><surname>Lê Cao</surname><given-names>K. A.</given-names></name></person-group> (<year>2019</year>). <article-title>A generic multivariate framework for the integration of microbiome longitudinal studies with other data types.</article-title>
<source><italic>Front. Genet.</italic></source>
<volume>10</volume>:<issue>963</issue>. <pub-id pub-id-type="doi">10.3389/fgene.2019.00963</pub-id>
<?supplied-pmid 31803221?><pub-id pub-id-type="pmid">31803221</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolyen</surname><given-names>E.</given-names></name><name><surname>Rideout</surname><given-names>J. R.</given-names></name><name><surname>Dillon</surname><given-names>M. R.</given-names></name><name><surname>Bokulich</surname><given-names>N. A.</given-names></name><name><surname>Abnet</surname><given-names>C. C.</given-names></name><name><surname>Al-Ghalith</surname></name><etal/></person-group> (<year>2019</year>). <article-title>Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2.</article-title>
<source><italic>Nat. Biotechnol.</italic></source>
<volume>37</volume>
<fpage>852</fpage>–<lpage>857</lpage>.<pub-id pub-id-type="pmid">31341288</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouchard</surname><given-names>M.</given-names></name><name><surname>Jousselme</surname><given-names>A. L.</given-names></name><name><surname>Doré</surname><given-names>P. E.</given-names></name></person-group> (<year>2013</year>). <article-title>A proof for the positive definiteness of the Jaccard index matrix.</article-title>
<source><italic>Int. J. Approx. Reas.</italic></source>
<volume>54</volume>
<fpage>615</fpage>–<lpage>626</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijar.2013.01.006</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cawley</surname><given-names>G. C.</given-names></name><name><surname>Talbot</surname><given-names>N. L.</given-names></name></person-group> (<year>2010</year>). <article-title>On over-fitting in model selection and subsequent selection bias in performance evaluation.</article-title>
<source><italic>J. Mach. Learn. Res.</italic></source>
<volume>11</volume>
<fpage>2079</fpage>–<lpage>2107</lpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlson</surname><given-names>E. S.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Custers-Allen</surname><given-names>R.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Sinha</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Disordered microbial communities in the upper respiratory tract of cigarette smokers.</article-title>
<source><italic>PLoS one</italic></source>
<volume>5</volume>:<issue>e15216</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0015216</pub-id>
<?supplied-pmid 21188149?><pub-id pub-id-type="pmid">21188149</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>R. W.</given-names></name><name><surname>Wang</surname><given-names>K. X.</given-names></name><name><surname>Wang</surname><given-names>F. Z.</given-names></name><name><surname>He</surname><given-names>Y. Q.</given-names></name><name><surname>Long</surname><given-names>L. J.</given-names></name><name><surname>Tian</surname><given-names>X. P.</given-names></name></person-group> (<year>2018</year>). <article-title>Rubrobacter indicoceani sp. nov., a new marine actinobacterium isolated from Indian Ocean sediment.</article-title>
<source><italic>Int. J. Systemat. Evolut. Microbiol.</italic></source>
<volume>68</volume>
<fpage>3487</fpage>–<lpage>3493</lpage>. <pub-id pub-id-type="doi">10.1099/ijsem.0.003018</pub-id>
<?supplied-pmid 30300120?><pub-id pub-id-type="pmid">30300120</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H.</given-names></name><name><surname>Tang</surname><given-names>F.</given-names></name><name><surname>Tino</surname><given-names>P.</given-names></name><name><surname>Yao</surname><given-names>X.</given-names></name></person-group> (<year>2013</year>). “<article-title>Model-based kernel for efficient time series analysis</article-title>,” in <source><italic>Proceedings of the 19th ACM SIGKDD international conference on Knowledge discovery and data mining</italic></source>, <role>eds</role>
<person-group person-group-type="editor"><name><surname>He</surname><given-names>J.</given-names></name><name><surname>Koren</surname><given-names>Y.</given-names></name><name><surname>Ghani</surname><given-names>R.</given-names></name><name><surname>Parekh</surname><given-names>R.</given-names></name><name><surname>Dhillon</surname><given-names>I.</given-names></name><name><surname>Senator</surname><given-names>T. E.</given-names></name></person-group> (<publisher-loc>United States</publisher-loc>: <publisher-name>Association for Computing Machinery</publisher-name>), <fpage>392</fpage>–<lpage>400</lpage>.</mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coenen</surname><given-names>A. R.</given-names></name><name><surname>Hu</surname><given-names>S. K.</given-names></name><name><surname>Luo</surname><given-names>E.</given-names></name><name><surname>Muratore</surname><given-names>D.</given-names></name><name><surname>Weitz</surname><given-names>J. S.</given-names></name></person-group> (<year>2020</year>). <article-title>A Primer for Microbiome Time-Series Analysis.</article-title>
<source><italic>Front. Genet.</italic></source>
<volume>11</volume>:<issue>310</issue>. <pub-id pub-id-type="doi">10.3389/fgene.2020.00310</pub-id>
<?supplied-pmid 32373155?><pub-id pub-id-type="pmid">32373155</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dahal</surname><given-names>R. H.</given-names></name><name><surname>Kim</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <article-title>Microvirga soli sp. nov., an alphaproteobacterium isolated from soil.</article-title>
<source><italic>Int. J. Syst. Evolut. Microbiol.</italic></source>
<volume>67</volume>
<fpage>127</fpage>–<lpage>133</lpage>. <pub-id pub-id-type="doi">10.1099/ijsem.0.001582</pub-id>
<?supplied-pmid 27902203?><pub-id pub-id-type="pmid">27902203</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gardener</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>). <source><italic>Community ecology: analytical methods using R and Excel.</italic></source>
<publisher-loc>United Kingdom</publisher-loc>: <publisher-name>Pelagic Publishing Ltd</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gloor</surname><given-names>G. B.</given-names></name><name><surname>Macklaim</surname><given-names>J. M.</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V.</given-names></name><name><surname>Egozcue</surname><given-names>J. J.</given-names></name></person-group> (<year>2017</year>). <article-title>Microbiome Datasets Are Compositional: And This Is Not Optional.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>8</volume>:<issue>2224</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
<?supplied-pmid 29187837?><pub-id pub-id-type="pmid">29187837</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guyon</surname><given-names>I.</given-names></name><name><surname>Weston</surname><given-names>J.</given-names></name><name><surname>Barnhill</surname><given-names>S.</given-names></name><name><surname>Vapnik</surname><given-names>V.</given-names></name></person-group> (<year>2002</year>). <article-title>Gene selection for cancer classification using support vector machines.</article-title>
<source><italic>Mach. Learn.</italic></source>
<volume>46</volume>
<fpage>389</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>G. G.</given-names></name><name><surname>Lee</surname><given-names>J. Y.</given-names></name><name><surname>Jin</surname><given-names>G. D.</given-names></name><name><surname>Park</surname><given-names>J.</given-names></name><name><surname>Choi</surname><given-names>Y. H.</given-names></name><name><surname>Kang</surname><given-names>S. K.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Tracing of the fecal microbiota of commercial pigs at five growth stages from birth to shipment.</article-title>
<source><italic>Scient. Rep.</italic></source>
<volume>8</volume>
<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsu</surname><given-names>C. W.</given-names></name><name><surname>Chang</surname><given-names>C. C.</given-names></name><name><surname>Lin</surname><given-names>C. J.</given-names></name></person-group> (<year>2003</year>). <source><italic>A practical guide to support vector classification.</italic></source> Available online at: <ext-link ext-link-type="uri" xlink:href="https://www.csie.ntu.edu.tw/~cjlin/papers/guide/guide.pdf">https://www.csie.ntu.edu.tw/~cjlin/papers/guide/guide.pdf</ext-link> [accessed on June 12, 2020]</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ibrahim</surname><given-names>O. M.</given-names></name></person-group> (<year>2013</year>). <article-title>A comparison of methods for assessing the relative importance of input variables in artificial neural networks.</article-title>
<source><italic>J. Appl. Sci. Res.</italic></source>
<volume>9</volume>
<fpage>5692</fpage>–<lpage>5700</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keerthi</surname><given-names>S. S.</given-names></name><name><surname>Lin</surname><given-names>C. J.</given-names></name></person-group> (<year>2003</year>). <article-title>Asymptotic behaviors of support vector machines with Gaussian kernel.</article-title>
<source><italic>Neural. Comput.</italic></source>
<volume>15</volume>
<fpage>1667</fpage>–<lpage>1689</lpage>. <pub-id pub-id-type="doi">10.1162/089976603321891855</pub-id>
<?supplied-pmid 12816571?><pub-id pub-id-type="pmid">12816571</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lauber</surname><given-names>C. L.</given-names></name><name><surname>Hamady</surname><given-names>M.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name><name><surname>Fierer</surname><given-names>N.</given-names></name></person-group> (<year>2009</year>). <article-title>Pyrosequencing-based assessment of soil pH as a predictor of soil bacterial community structure at the continental scale.</article-title>
<source><italic>Appl. Environ. Microbiol.</italic></source>
<volume>75</volume>
<fpage>5111</fpage>–<lpage>5120</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.00335-09</pub-id>
<?supplied-pmid 19502440?><pub-id pub-id-type="pmid">19502440</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>F. X.</given-names></name><name><surname>Ngom</surname><given-names>A.</given-names></name></person-group> (<year>2018</year>). <article-title>A review on machine learning principles for multi-view biological data integration.</article-title>
<source><italic>Brief. Bioinform.</italic></source>
<volume>19</volume>
<fpage>325</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">28011753</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liaw</surname><given-names>A.</given-names></name><name><surname>Wiener</surname><given-names>M.</given-names></name></person-group> (<year>2002</year>). <article-title>randomForest: Breiman and Cutler’s random forests for classification and regression.</article-title>
<source><italic>R Package Vers.</italic></source>
<volume>4</volume>
<fpage>6</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mach</surname><given-names>N.</given-names></name><name><surname>Berri</surname><given-names>M.</given-names></name><name><surname>Estellé</surname><given-names>J.</given-names></name><name><surname>Levenez</surname><given-names>F.</given-names></name><name><surname>Lemonnier</surname><given-names>G.</given-names></name><name><surname>Denis</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Early-life establishment of the swine gut microbiome and impact on host phenotypes.</article-title>
<source><italic>Environ. Microbiol. Rep.</italic></source>
<volume>7</volume>
<fpage>554</fpage>–<lpage>569</lpage>. <pub-id pub-id-type="doi">10.1111/1758-2229.12285</pub-id>
<?supplied-pmid 25727666?><pub-id pub-id-type="pmid">25727666</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mariette</surname><given-names>J.</given-names></name><name><surname>Villa-Vialaneix</surname><given-names>N.</given-names></name></person-group> (<year>2018</year>). <article-title>Unsupervised multiple kernel learning for heterogeneous data integration.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>34</volume>
<fpage>1009</fpage>–<lpage>1015</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx682</pub-id>
<?supplied-pmid 29077792?><pub-id pub-id-type="pmid">29077792</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Massacci</surname><given-names>F. R.</given-names></name><name><surname>Berri</surname><given-names>M.</given-names></name><name><surname>Lemonnier</surname><given-names>G.</given-names></name><name><surname>Guettier</surname><given-names>E.</given-names></name><name><surname>Blanc</surname><given-names>F.</given-names></name><name><surname>Jardet</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Late weaning is associated with increased microbial diversity and Faecalibacterium prausnitzii abundance in the fecal microbiota of piglets.</article-title>
<source><italic>Anim. Microb.</italic></source>
<volume>2</volume>
<fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>P. J.</given-names></name><name><surname>Holmes</surname><given-names>S.</given-names></name></person-group> (<year>2014</year>). <article-title>Waste not, want not: why rarefying microbiome data is inadmissible.</article-title>
<source><italic>PLoS Comput. Biol.</italic></source>
<volume>10</volume>:<issue>e1003531</issue>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
<?supplied-pmid 24699258?><pub-id pub-id-type="pmid">24699258</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morton</surname><given-names>J. T.</given-names></name><name><surname>Toran</surname><given-names>L.</given-names></name><name><surname>Edlund</surname><given-names>A.</given-names></name><name><surname>Metcalf</surname><given-names>J. L.</given-names></name><name><surname>Lauber</surname><given-names>C.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name></person-group> (<year>2017</year>). <article-title>Uncovering the horseshoe effect in microbial analyses.</article-title>
<source><italic>Msystems</italic></source>
<volume>2</volume>
<fpage>166</fpage>–<lpage>e116</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namkung</surname><given-names>J.</given-names></name></person-group> (<year>2020</year>). <article-title>Machine learning methods for microbiome studies.</article-title>
<source><italic>J. Microbiol.</italic></source>
<volume>58</volume>
<fpage>206</fpage>–<lpage>216</lpage>. <pub-id pub-id-type="doi">10.1007/s12275-020-0066-8</pub-id>
<?supplied-pmid 32108316?><pub-id pub-id-type="pmid">32108316</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paulson</surname><given-names>J. N.</given-names></name><name><surname>Stine</surname><given-names>O. C.</given-names></name><name><surname>Bravo</surname><given-names>H. C.</given-names></name><name><surname>Pop</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>Differential abundance analysis for microbial marker-gene surveys.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>10</volume>
<fpage>1200</fpage>–<lpage>1203</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id>
<?supplied-pmid 24076764?><pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qu</surname><given-names>K.</given-names></name><name><surname>Guo</surname><given-names>F.</given-names></name><name><surname>Liu</surname><given-names>X.</given-names></name><name><surname>Lin</surname><given-names>Y.</given-names></name><name><surname>Zou</surname><given-names>Q.</given-names></name></person-group> (<year>2019</year>). <article-title>Application of machine learning in microbiology.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>10</volume>:<issue>827</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2019.00827</pub-id>
<?supplied-pmid 31057526?><pub-id pub-id-type="pmid">31057526</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>T. P.</given-names></name><name><surname>Erb</surname><given-names>I.</given-names></name><name><surname>Richardson</surname><given-names>M. F.</given-names></name><name><surname>Crowley</surname><given-names>T. M.</given-names></name></person-group> (<year>2018</year>). <article-title>Understanding sequencing data as compositions: an outlook and review.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>34</volume>
<fpage>2870</fpage>–<lpage>2878</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty175</pub-id>
<?supplied-pmid 29608657?><pub-id pub-id-type="pmid">29608657</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivera-Pinto</surname><given-names>J.</given-names></name><name><surname>Egozcue</surname><given-names>J. J.</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V.</given-names></name><name><surname>Paredes</surname><given-names>R.</given-names></name><name><surname>Noguera-Julian</surname><given-names>M.</given-names></name><name><surname>Calle</surname><given-names>M. L.</given-names></name></person-group> (<year>2018</year>). <article-title>Balances: a New Perspective for Microbiome Analysis.</article-title>
<source><italic>mSystems</italic></source>
<volume>3</volume>
<fpage>53</fpage>–<lpage>e18</lpage>.</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sawicki</surname><given-names>C. M.</given-names></name><name><surname>Livingston</surname><given-names>K. A.</given-names></name><name><surname>Obin</surname><given-names>M.</given-names></name><name><surname>Roberts</surname><given-names>S. B.</given-names></name><name><surname>Chung</surname><given-names>M.</given-names></name><name><surname>McKeown</surname><given-names>N. M.</given-names></name></person-group> (<year>2017</year>). <article-title>Dietary fiber and the human gut microbiota: application of evidence mapping methodology.</article-title>
<source><italic>Nutrients</italic></source>
<volume>9</volume>:<issue>125</issue>. <pub-id pub-id-type="doi">10.3390/nu9020125</pub-id>
<?supplied-pmid 28208609?><pub-id pub-id-type="pmid">28208609</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schölkopf</surname><given-names>B.</given-names></name><name><surname>Tsuda</surname><given-names>K.</given-names></name><name><surname>Vert</surname><given-names>J. P.</given-names></name></person-group> (<year>2004</year>). <source><italic>Kernel methods in computational biology.</italic></source>
<publisher-loc>New York</publisher-loc>: <publisher-name>MIT press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Shawe-Taylor</surname><given-names>J.</given-names></name><name><surname>Cristianini</surname><given-names>N.</given-names></name></person-group> (<year>2004</year>). <source><italic>Kernel methods for pattern analysis.</italic></source>
<publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge university press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenhav</surname><given-names>L.</given-names></name><name><surname>Thompson</surname><given-names>M.</given-names></name><name><surname>Joseph</surname><given-names>T. A.</given-names></name><name><surname>Briscoe</surname><given-names>L.</given-names></name><name><surname>Furman</surname><given-names>O.</given-names></name><name><surname>Bogumil</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>FEAST: fast expectation-maximization for microbial source tracking.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>16</volume>:<issue>627</issue>. <pub-id pub-id-type="doi">10.1038/s41592-019-0431-x</pub-id>
<?supplied-pmid 31182859?><pub-id pub-id-type="pmid">31182859</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silverman</surname><given-names>J. D.</given-names></name><name><surname>Washburne</surname><given-names>A. D.</given-names></name><name><surname>Mukherjee</surname><given-names>S.</given-names></name><name><surname>David</surname><given-names>L. A.</given-names></name></person-group> (<year>2017</year>). <article-title>A phylogenetic transform enhances analysis of compositional microbiota data.</article-title>
<source><italic>Elife</italic></source>
<volume>6</volume>:<issue>e21887</issue>.</mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>D.</given-names></name><name><surname>Peng</surname><given-names>Q.</given-names></name><name><surname>Chen</surname><given-names>Y.</given-names></name><name><surname>Zhou</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>F.</given-names></name><name><surname>Li</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Altered gut microbiota profiles in sows and neonatal piglets associated with porcine epidemic diarrhea virus infection.</article-title>
<source><italic>Scient. Rep.</italic></source>
<volume>7</volume>
<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>C. J.</given-names></name><name><surname>Ajami</surname><given-names>N. J.</given-names></name><name><surname>O’Brien</surname><given-names>J. L.</given-names></name><name><surname>Hutchinson</surname><given-names>D. S.</given-names></name><name><surname>Smith</surname><given-names>D. P.</given-names></name><name><surname>Wong</surname><given-names>M. C.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Temporal development of the gut microbiome in early childhood from the TEDDY study.</article-title>
<source><italic>Nature</italic></source>
<volume>562</volume>
<fpage>583</fpage>–<lpage>588</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-018-0617-x</pub-id>
<?supplied-pmid 30356187?><pub-id pub-id-type="pmid">30356187</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>X.</given-names></name><name><surname>Jing</surname><given-names>G.</given-names></name><name><surname>Sun</surname><given-names>Z.</given-names></name><name><surname>Liu</surname><given-names>L.</given-names></name><name><surname>Xu</surname><given-names>Z.</given-names></name><name><surname>McDonald</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Multiple-Disease Detection and Classification across Cohorts via Microbiome Search.</article-title>
<source><italic>Msystems</italic></source>
<volume>5</volume>
<fpage>150</fpage>–<lpage>e120</lpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>S.</given-names></name><name><surname>Xu</surname><given-names>Z. Z.</given-names></name><name><surname>Peddada</surname><given-names>S.</given-names></name><name><surname>Amir</surname><given-names>A.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Gonzalez</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics.</article-title>
<source><italic>Microbiome</italic></source>
<volume>5</volume>:<issue>27</issue>.</mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wexler</surname><given-names>A. G.</given-names></name><name><surname>Goodman</surname><given-names>A. L.</given-names></name></person-group> (<year>2017</year>). <article-title>An insider’s perspective: <italic>Bacteroides</italic> as a window into the microbiome.</article-title>
<source><italic>Nat. Microbiol.</italic></source>
<volume>2</volume>
<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>M. N.</given-names></name><name><surname>Ziegler</surname><given-names>A.</given-names></name></person-group> (<year>2017</year>). <article-title>ranger: A Fast Implementation of Random Forests for High Dimensional Data in C++ and R.</article-title>
<source><italic>J. Statist. Softw.</italic></source>
<volume>77</volume>
<fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>J.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <source><italic>Phylogeny-based kernels with application to microbiome association studies. In New Advances in Statistics and Data Science.</italic></source>
<publisher-loc>Cham</publisher-loc>: <publisher-name>Springer</publisher-name>, <fpage>217</fpage>–<lpage>237</lpage>.</mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Tong</surname><given-names>X.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Maity</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <article-title>A small-sample multivariate kernel machine test for microbiome association studies.</article-title>
<source><italic>Genet. Epidemiol.</italic></source>
<volume>41</volume>
<fpage>210</fpage>–<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22030</pub-id>
<?supplied-pmid 28019040?><pub-id pub-id-type="pmid">28019040</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Y. H.</given-names></name><name><surname>Gallins</surname><given-names>P.</given-names></name></person-group> (<year>2019</year>). <article-title>A review and tutorial of machine learning methods for microbiome host trait prediction.</article-title>
<source><italic>Front. Genet</italic></source>
<volume>10</volume>:<issue>579</issue>. <pub-id pub-id-type="doi">10.3389/fgene.2019.00579</pub-id>
<?supplied-pmid 31293616?><pub-id pub-id-type="pmid">31293616</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zingaretti</surname><given-names>L. M.</given-names></name><name><surname>Renand</surname><given-names>G.</given-names></name><name><surname>Morgavi</surname><given-names>D. P.</given-names></name><name><surname>Ramayo-Caldas</surname><given-names>Y.</given-names></name></person-group> (<year>2020</year>). <article-title>Link-HD: a versatile framework to explore and integrate heterogeneous microbial communities.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>36</volume>
<fpage>2298</fpage>–<lpage>2299</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz862</pub-id>
<?supplied-pmid 31738392?><pub-id pub-id-type="pmid">31738392</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <glossary>
    <title>Abbreviations</title>
    <def-list id="DL1">
      <def-item>
        <term>ANN</term>
        <def>
          <p>artificial neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>ASV</term>
        <def>
          <p>amplicon sequence variant</p>
        </def>
      </def-item>
      <def-item>
        <term>JSK</term>
        <def>
          <p>Jensen-Shannon Kernel</p>
        </def>
      </def-item>
      <def-item>
        <term>kPCA</term>
        <def>
          <p>kernel principal components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>MDS</term>
        <def>
          <p>multidimensional scaling</p>
        </def>
      </def-item>
      <def-item>
        <term>MKL</term>
        <def>
          <p>multiple kernel learning</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>NMSE</term>
        <def>
          <p>normalized mean squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>principal components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PCoA</term>
        <def>
          <p>principal coordinates analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>RBF</term>
        <def>
          <p>radial basis function</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p>random forests</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p>support vector machines</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
</back>
