<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pgen.1010683.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10079220</article-id>
    <article-id pub-id-type="pmid">36972309</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1010683</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-22-00986</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA recombination</subject>
              <subj-group>
                <subject>Transformation Associated Recombination</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA recombination</subject>
                <subj-group>
                  <subject>Transformation Associated Recombination</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacteriology</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Microbial Genetics</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Bacterial Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA recombination</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA recombination</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Rhometa: Population recombination rate estimation from metagenomic read datasets</article-title>
      <alt-title alt-title-type="running-head">Rhometa: Metagenomic population recombination rate estimator</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0568-4064</contrib-id>
        <name>
          <surname>Krishnan</surname>
          <given-names>Sidaswar</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7601-5108</contrib-id>
        <name>
          <surname>DeMaere</surname>
          <given-names>Matthew Z.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beck</surname>
          <given-names>Dominik</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ostrowski</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Seymour</surname>
          <given-names>Justin R.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2397-7925</contrib-id>
        <name>
          <surname>Darling</surname>
          <given-names>Aaron E.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Climate Change Cluster, Faculty of Science, University of Technology Sydney, Sydney, NSW, Australia</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Australian Institute for Microbiology &amp; Infection, University of Technology Sydney, Sydney, NSW, Australia</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Centre for Health Technologies and the School of Biomedical Engineering, University of Technology Sydney, Sydney, NSW, Australia</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Illumina Australia Pty Ltd, Ultimo, NSW, Australia</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Didelot</surname>
          <given-names>Xavier</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Warwick, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>I have read the journal’s policy and the authors of this manuscript have the following competing interests: A. E. Darling holds equity in Illumina Inc and is employed by its subsidiary Illumina Australia Pty Ltd, a company that develops and sells DNA sequencing technology. All other authors declare no competing financial interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Matthew.DeMaere@uts.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>3</issue>
    <elocation-id>e1010683</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Krishnan et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Krishnan et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1010683.pdf"/>
    <abstract>
      <p>Prokaryotic evolution is influenced by the exchange of genetic information between species through a process referred to as recombination. The rate of recombination is a useful measure for the adaptive capacity of a prokaryotic population. We introduce Rhometa (<ext-link xlink:href="https://github.com/sid-krish/Rhometa" ext-link-type="uri">https://github.com/sid-krish/Rhometa</ext-link>), a new software package to determine recombination rates from shotgun sequencing reads of metagenomes. It extends the composite likelihood approach for population recombination rate estimation and enables the analysis of modern short-read datasets. We evaluated Rhometa over a broad range of sequencing depths and complexities, using simulated and real experimental short-read data aligned to external reference genomes. Rhometa offers a comprehensive solution for determining population recombination rates from contemporary metagenomic read datasets. Rhometa extends the capabilities of conventional sequence-based composite likelihood population recombination rate estimators to include modern aligned metagenomic read datasets with diverse sequencing depths, thereby enabling the effective application of these techniques and their high accuracy rates to the field of metagenomics. Using simulated datasets, we show that our method performs well, with its accuracy improving with increasing numbers of genomes. Rhometa was validated on a real <italic toggle="yes">S</italic>. <italic toggle="yes">pneumoniae</italic> transformation experiment, where we show that it obtains plausible estimates of the rate of recombination. Finally, the program was also run on ocean surface water metagenomic datasets, through which we demonstrate that the program works on uncultured metagenomic datasets.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Microbes, specifically prokaryotes, are able to exchange DNA between them through a process called recombination that takes the form of gene-conversion. Recombination plays a fundamentally important role in microbial speciation and evolution. Metagenomics allows us to study microbes in their natural environment as they are via direct sequencing and analysis of environmental DNA. Indeed, most microbes cannot be cultured and can only be studied in this manner. Metagenomic datasets represent an excellent resource for measuring prokaryotic recombination. Rhometa is a new software program that we have designed to be used to interrogate modern metagenomic shotgun sequencing read datasets to estimate the population recombination rates. It extends the composite likelihood approach for population recombination rate estimation, and makes it applicable to modern aligned metagenomic datasets of various depths. The input for the program requires little pre-processing and only an aligned BAM and reference FASTA in the form of a complete sequence or MAG are needed. The program performs well on large BAM files and the included subsampling functionality ensures that files of arbitrarily large size are subsampled and analysed. The program has been validated on simulated datasets and further on experimental and environmental datasets where the amount of recombination is quantified. Through the validation we show that the program is able to reliably estimate the recombination rates in simulated and experimental datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Australian Government Research Training Program Scholarship</institution>
        </funding-source>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000923</institution-id>
            <institution>Australian Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DP180101506</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2397-7925</contrib-id>
          <name>
            <surname>Darling</surname>
            <given-names>Aaron E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by an Australian Government Research Training Program Scholarship. This research was supported by the Australian Government through the Australian Research Council Discovery Projects funding scheme under the project DP180101506, <ext-link xlink:href="http://purl.org/au-research/grants/arc/DP180101506" ext-link-type="uri">http://purl.org/au-research/grants/arc/DP180101506</ext-link> (to AED). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="3"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-04-06</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All supporting information can be accessed here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7634208" ext-link-type="uri">https://doi.org/10.5281/zenodo.7634208</ext-link>. The Rhometa software package is available at <ext-link xlink:href="https://github.com/sid-krish/Rhometa" ext-link-type="uri">https://github.com/sid-krish/Rhometa</ext-link>. The metagenomic dataset simulation pipeline is available at <ext-link xlink:href="https://github.com/sid-krish/rhometa_sim" ext-link-type="uri">https://github.com/sid-krish/rhometa_sim</ext-link>, the LDhat Nextflow Pipeline is available at: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat</ext-link>, the full genome version of Rhometa, developed for testing purposes, is available at <ext-link xlink:href="https://github.com/sid-krish/Rhometa_Full_Genome" ext-link-type="uri">https://github.com/sid-krish/Rhometa_Full_Genome</ext-link> and the Nextflow_LDhat_sim simulation pipeline (used for simulating full sequences for both Rhometa Full Genome and LDhat Nextflow Pipeline) is available at: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat_Sim" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat_Sim</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All supporting information can be accessed here: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7634208" ext-link-type="uri">https://doi.org/10.5281/zenodo.7634208</ext-link>. The Rhometa software package is available at <ext-link xlink:href="https://github.com/sid-krish/Rhometa" ext-link-type="uri">https://github.com/sid-krish/Rhometa</ext-link>. The metagenomic dataset simulation pipeline is available at <ext-link xlink:href="https://github.com/sid-krish/rhometa_sim" ext-link-type="uri">https://github.com/sid-krish/rhometa_sim</ext-link>, the LDhat Nextflow Pipeline is available at: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat</ext-link>, the full genome version of Rhometa, developed for testing purposes, is available at <ext-link xlink:href="https://github.com/sid-krish/Rhometa_Full_Genome" ext-link-type="uri">https://github.com/sid-krish/Rhometa_Full_Genome</ext-link> and the Nextflow_LDhat_sim simulation pipeline (used for simulating full sequences for both Rhometa Full Genome and LDhat Nextflow Pipeline) is available at: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat_Sim" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat_Sim</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A primary question in the field of microbial ecology is to understand the rate at which prokaryotes evolve and form species in nature. A major driving factor of prokaryotic evolution is recombination [<xref rid="pgen.1010683.ref001" ref-type="bibr">1</xref>]. Within prokaryotes, recombination often takes the form of gene-conversion where homologous sequences of DNA are non-reciprocally transferred and replaced with another [<xref rid="pgen.1010683.ref002" ref-type="bibr">2</xref>,<xref rid="pgen.1010683.ref003" ref-type="bibr">3</xref>]. This process can occur between repeated sequences within the same chromosome and between homologous chromosomal sequences [<xref rid="pgen.1010683.ref003" ref-type="bibr">3</xref>]. Recombination often plays a greater role than <italic toggle="yes">de novo</italic> mutation for evolution in prokaryotes [<xref rid="pgen.1010683.ref004" ref-type="bibr">4</xref>]. Furthermore, it is thought that recombination plays an important role in counteracting the effects of Muller’s ratchet, the theorised process where deleterious mutations inevitably accumulate over time leading to the irrevocable loss of most mutation free genotypes in a population [<xref rid="pgen.1010683.ref005" ref-type="bibr">5</xref>,<xref rid="pgen.1010683.ref006" ref-type="bibr">6</xref>]. Therefore, understanding the rate at which recombination occurs within prokaryotic populations can provide us insight into a crucial biological process that is necessary for their adaptation and survival.</p>
    <p>Currently the most viable way to study microbial populations is via metagenomics, which allows us to study microbes in their natural environment via direct sequencing and analysis of environmental DNA [<xref rid="pgen.1010683.ref007" ref-type="bibr">7</xref>,<xref rid="pgen.1010683.ref008" ref-type="bibr">8</xref>]. Shotgun metagenomic sequencing yields fragments of DNA sequences, referred to as reads, which taken together represent a random sampling of genome fragments from all the microbes in the environmental sample [<xref rid="pgen.1010683.ref009" ref-type="bibr">9</xref>]. These reads can then be used to estimate the rates of recombination.</p>
    <p>The rate of recombination within a population can be inferred using population genetic models for evolution. The Wright-Fisher model provides an analytical framework that quantifies various forces that can impact the evolution of a population such as random genetic drift and mutation [<xref rid="pgen.1010683.ref010" ref-type="bibr">10</xref>]. Coalescent theory, building on the Wright-Fisher population model, provides an analytical framework for DNA polymorphism data and can be used to obtain quantitative estimates for recombination and mutation rates [<xref rid="pgen.1010683.ref011" ref-type="bibr">11</xref>,<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>].</p>
    <p>Coalescent theory provides the population scaled recombination rate for the gene-conversion model of recombination. It is formulated as ρ = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">r</italic>, or <italic toggle="yes">2 × “effective population size” × “per individual” “per generation” “recombination rate”</italic>, respectively [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>] as well as the haploid population scaled mutation rate equation <italic toggle="yes">θ</italic> = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">u</italic>, or <italic toggle="yes">2 × “effective population size” × “per individual” “per generation” “mutation rate”</italic>, respectively [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>]. It is difficult to estimate <italic toggle="yes">r</italic> or <italic toggle="yes">u</italic> directly without additional prior information, so recombination and mutation rates are typically computed as the population scaled statistics ρ and <italic toggle="yes">θ</italic> or simultaneously as the ratio <italic toggle="yes">r</italic>/<italic toggle="yes">u</italic> also denoted as r/m (per site recombination to per site mutation rate) [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref013" ref-type="bibr">13</xref>]. An important point of note is that <italic toggle="yes">r</italic> and <italic toggle="yes">u</italic> are per site rates. ρ applies to the entire genome, <italic toggle="yes">θ</italic> on the other hand is also per site.</p>
    <p>Several approaches have been used to estimate the recombination rate ρ. These include moment estimators, full-likelihood estimators and composite likelihood estimators. Moment estimators use summary statistics to estimate ρ, but their accuracy is limited by the fact that they cannot use all the genetic information available [<xref rid="pgen.1010683.ref014" ref-type="bibr">14</xref>–<xref rid="pgen.1010683.ref016" ref-type="bibr">16</xref>]. Full likelihood estimators are able to utilise all the genetic information available to them, but are so computationally intensive that their usage is impractical. To mitigate these issues and to make the approach more computationally tractable, composite likelihood estimators were developed [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref016" ref-type="bibr">16</xref>,<xref rid="pgen.1010683.ref017" ref-type="bibr">17</xref>]. With composite likelihood estimators, the scope of data that is analysed is reduced e.g. to only consider pairs of alleles, this approach is less computationally intensive with only a slight loss in accuracy compared to the full-likelihood approach [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref016" ref-type="bibr">16</xref>–<xref rid="pgen.1010683.ref018" ref-type="bibr">18</xref>].</p>
    <p>There are several programs available that implement the composite likelihood approach for estimating the recombination rate, including LDhat [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref019" ref-type="bibr">19</xref>], LDhelmet [<xref rid="pgen.1010683.ref020" ref-type="bibr">20</xref>], LDhot [<xref rid="pgen.1010683.ref021" ref-type="bibr">21</xref>], PIIM [<xref rid="pgen.1010683.ref022" ref-type="bibr">22</xref>] and pyrho [<xref rid="pgen.1010683.ref023" ref-type="bibr">23</xref>]. Each are excellent for their respective use cases, but have limitations that make them unsuitable for modern read-based metagenomic datasets.</p>
    <p>More specifically, LDhat [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref019" ref-type="bibr">19</xref>], LDhelmet [<xref rid="pgen.1010683.ref020" ref-type="bibr">20</xref>] and LDhot [<xref rid="pgen.1010683.ref021" ref-type="bibr">21</xref>] were designed for genome sequence analysis, not metagenomes. PIIM [<xref rid="pgen.1010683.ref022" ref-type="bibr">22</xref>] was a pioneering attempt at a metagenomic read-based population recombination rate estimator which deals with the complexities of such datasets such as varying depths across loci. While innovative at the time its application is impractical today. PIIM’s approach included computationally expensive techniques to integrate out uncertainty in low quality base-calls so as to retain as much information as possible from the scarce data available at the time. Today, deep sequencing is affordable and highly accurate, such that it’s often more practical to simply discard low quality sequence data rather than account for it computationally using complex algorithms. As such PIIM’s approach is impractical for the ever-larger datasets that are generated via modern sequencing techniques. Furthermore, it lacks support for modern sequence data formats (e.g., BAM), being limited to the obsolete ACE assembly format that is rarely used today.</p>
    <p>pyrho [<xref rid="pgen.1010683.ref023" ref-type="bibr">23</xref>] is a recent composite likelihood estimator supporting read based data, however it is limited to the analysis of diploid genomes, making it unsuitable for the analysis of haploid genomes (prokaryotes) which commonly dominate metagenomic datasets. Still other programs exist that calculate the population recombination rate through different approaches such as LDjump [<xref rid="pgen.1010683.ref018" ref-type="bibr">18</xref>] and CodABC [<xref rid="pgen.1010683.ref024" ref-type="bibr">24</xref>] which utilise summary statistics [<xref rid="pgen.1010683.ref018" ref-type="bibr">18</xref>], and programs such as ClonalFrameML [<xref rid="pgen.1010683.ref025" ref-type="bibr">25</xref>,<xref rid="pgen.1010683.ref026" ref-type="bibr">26</xref>] which can provide an estimate of recombination rate relative to the mutation rate, but is designed around bacterial isolate genomes.</p>
    <p>mcorr [<xref rid="pgen.1010683.ref027" ref-type="bibr">27</xref>] is a program that can work with metagenomic reads and estimate the relative rate of recombination to mutation as well as the recombinational divergence. mcorr uses an alternative mathematical formulation to parameterise the recombination process, with <italic toggle="yes">ϕ</italic><sub>pool</sub>≡2<underline><italic toggle="yes">T</italic></underline><italic toggle="yes">γ</italic>, where <underline><italic toggle="yes">T</italic></underline> “is the mean pairwise coalescence time across all loci in the bulk pool” and <italic toggle="yes">γ</italic> the per base pair (bp) per generation recombination rate, equivalent to <italic toggle="yes">r</italic> in ρ = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">r</italic>. Furthermore, the program is limited to coding regions and requires a gene annotation file. It is our aim to build on methods established in previous composite likelihood estimators for population recombination rate estimation to create a tailored solution that is applicable to modern aligned read-based metagenomic datasets.</p>
    <p>Here, we present Rhometa, a software implementation of the composite likelihood based population recombination rate (ρ = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">r</italic>) estimation method, which builds upon the methods introduced in the LDhat pairwise program [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>] and can be applied directly to modern aligned shotgun metagenomic read datasets for prokaryotes. Details of its implementation are presented in the methods, while an evaluation of its accuracy on simulated and real data and comparison to existing tools are presented in the results.</p>
  </sec>
  <sec id="sec002">
    <title>Description of the method</title>
    <p>Our approach focuses on advancing the composite likelihood recombination rate estimator for use with aligned metagenomic read datasets. We have built our metagenomic population recombination rate estimator program upon the approach introduced in the LDhat program, specifically the LDhat pairwise module [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>]. LDhat is a well-known and used program with support for microbial datasets, specifically for the gene-conversion type recombination which occurs in microbes, however, it is limited to aligned genome sequences. We have designed the program to work with aligned read based metagenomic datasets, where the complication of varying depths and short reads needs to be addressed. For our implementation, we have also subsumed features from pyrho [<xref rid="pgen.1010683.ref023" ref-type="bibr">23</xref>]. pyrho, while lacking support for microbial (haploid) datasets, is a modern composite likelihood estimator implemented in python. Like pyrho, our program is also implemented in python and aims to make use of modern libraries and their features. As a result of this shared implementation approach, we were able to call applicable functionalities from pyrho, helping avoid unnecessary code rewrites.</p>
    <sec id="sec003">
      <title>User Input</title>
      <p>We have endeavoured to make the process of preparing a metagenomic dataset for analysis with Rhometa straight forward with few pre-processing steps. Short reads can be aligned to existing reference genomes representing the metagenomic dataset, to reference MAGs (Metagenome-Assembled Genome) or pangenomes representative of the microbial community. Multi sequence references are also supported. The reference genomes provide a scaffold to align the reads, from which the rates of recombination and mutation are determined. For input files, the Rhometa pipeline requires a FASTA format reference sequence and a BAM file of metagenomic reads of interest aligned to the reference. For our pipeline evaluation, we have used BWA MEM (default parameters) to produce the input BAM file [<xref rid="pgen.1010683.ref028" ref-type="bibr">28</xref>] where necessary.</p>
    </sec>
    <sec id="sec004">
      <title>Variant site pairs</title>
      <p>The first step of the pipeline involves identifying variant sites (also known as segregating sites). Our program first filters the user supplied BAM for mapping quality and relative alignment score and subsequently performs variant calling against the user supplied reference FASTA using the program freebayes (default parameters with -p (ploidy) = 1) [<xref rid="pgen.1010683.ref029" ref-type="bibr">29</xref>]. The resulting VCF file, containing information on all predicted variant sites, is reduced to only single nucleotide polymorphisms (SNPs) using bcftools [<xref rid="pgen.1010683.ref030" ref-type="bibr">30</xref>].</p>
      <p>Rather than individual variant sites, the composite likelihood estimator as implemented in LDhat considers variant site pairs, tracking count and position within the reference genome’s coordinate space to estimate the recombination rate. For instance, if variant sites are found at reference positions 1, 3, and 5 the set of variant site pairs would then be (1, 3), (1, 5), and (3, 5).</p>
    </sec>
    <sec id="sec005">
      <title>Pairwise table</title>
      <p>The LDhat pairwise module was designed for genome sequences and considers all possible variant site pair combinations across the sequences being analysed. Rhometa restricts its consideration to the set of variant site pairs linked by individual reads or read-pairs. For single-end reads, both sites within a variant pair must fall within the extent of an individual read, while for paired-end reads variants can fall within the insert length. A separation limit of 1000 bp is imposed on paired end variant site pairs reflecting a practical upper limit on insert size for current Illumina short-read sequencing technology [<xref rid="pgen.1010683.ref031" ref-type="bibr">31</xref>]. Rhometa performs well with both single and pair-end reads, with very little difference in the results between the two (<xref rid="pgen.1010683.s002" ref-type="supplementary-material">S2 Fig</xref>).</p>
      <p>For all accepted variant site pairs, we construct a pairwise table of observational frequency (<xref rid="pgen.1010683.t001" ref-type="table">Table 1</xref>). The pairwise table allows for the possibility of all 16 combinations for any variant site pair. The table also captures the fact that multiple reads can align at a position. Instances where variant site pairs contain an ambiguous base (eg. N) are ignored.</p>
      <table-wrap position="float" id="pgen.1010683.t001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Pairwise table example.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1010683.t001" id="pgen.1010683.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">AA</th>
                <th align="center" rowspan="1" colspan="1">AC</th>
                <th align="center" rowspan="1" colspan="1">AG</th>
                <th align="center" rowspan="1" colspan="1">AT</th>
                <th align="center" rowspan="1" colspan="1">CA</th>
                <th align="center" rowspan="1" colspan="1">CC</th>
                <th align="center" rowspan="1" colspan="1">CG</th>
                <th align="center" rowspan="1" colspan="1">CT</th>
                <th align="center" rowspan="1" colspan="1">GA</th>
                <th align="center" rowspan="1" colspan="1">GC</th>
                <th align="center" rowspan="1" colspan="1">GG</th>
                <th align="center" rowspan="1" colspan="1">GT</th>
                <th align="center" rowspan="1" colspan="1">TA</th>
                <th align="center" rowspan="1" colspan="1">TC</th>
                <th align="center" rowspan="1" colspan="1">TG</th>
                <th align="center" rowspan="1" colspan="1">TT</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">(130, 136)</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(130, 143)</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(130, 169)</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">29</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(130, 311)</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">26</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">(130, 358)</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">19</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec006">
      <title>Splitting the pairwise table by depth</title>
      <p>In the pairwise table, variant site pair total alignment depth is calculated by row summation (e.g., For the pair (130, 136) from (<xref rid="pgen.1010683.t001" ref-type="table">Table 1</xref>), total depth is 13 + 21 + 10 = 44. For the whole genome approach of LDhat, this marginal value is a constant, while for metagenomic data depth of coverage can vary greatly across sites. As such it is necessary to split the pairwise table into constant depth subtables so that the depth can be taken into account and handled in downstream processing.</p>
    </sec>
    <sec id="sec007">
      <title>Bi-allelic pairwise table</title>
      <p>For each constant depth subtable, sites that do not contain two alleles are excluded (only biallelic sites should be in the pairwise table).</p>
    </sec>
    <sec id="sec008">
      <title>Lookup tables</title>
      <p>Lookup tables improve the computational efficiency of the composite likelihood approach by precomputing the likelihoods for different configurations of sets of allele pairs. Lookup tables are generated under a fixed population mutation rate and a range of population recombination rates, typically between 0–100 [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>,<xref rid="pgen.1010683.ref019" ref-type="bibr">19</xref>]. We use the program LDpop [<xref rid="pgen.1010683.ref032" ref-type="bibr">32</xref>] for generating lookup tables as it is the most feature rich and most efficient program of its kind currently. Details on how the lookup tables are used can be found in <xref rid="pgen.1010683.s011" ref-type="supplementary-material">S1 Appendix</xref>. It is a standard process for which we have made use of some functions from pyrho to avoid reimplementation. Generation of lookup tables with LDpop are parameterised by the number of genomes, range of population recombination rates, and <italic toggle="yes">θ</italic> per site. Further, the “approx” option is used which is significantly faster but still quite accurate when compared to the ldpop’s exact algorithm. This also makes generation of large lookup tables, as is necessary with Rhometa, more tractable. Generally, the generation of large lookup tables is a computationally intensive process, more information on which can be found in the paper associated with LDpop [<xref rid="pgen.1010683.ref032" ref-type="bibr">32</xref>].</p>
    </sec>
    <sec id="sec009">
      <title>Watterson’s theta estimate</title>
      <p>A subprogram is provided to estimate the population mutation rate (<italic toggle="yes">θ</italic> = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">u</italic>), per site. The formulation is directly based on Watterson’s theta estimate as implemented in LDhat [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>], with some changes on the information used for the input parameter. The program requires the aligned BAM file and the reference FASTA file and makes use of freebayes to identify variant sites which is required for the Watterson estimate. <italic toggle="yes">θ</italic> is a required parameter for lookup table generation adjusted for read based datasets, the <italic toggle="yes">θ</italic> estimate is calculated based on dataset depth–specifically mean and median depth–in place of the number of genomes, as in the original formation (<xref rid="pgen.1010683.s004" ref-type="supplementary-material">S4 Fig</xref>). For metagenomic samples where the exact number of genomes is unknown, the true number of different genomes in a metagenomic sample is likely to be a large value, as such using the depth value is reasonable and in many cases is likely to be a conservative estimate for the number of genomes.</p>
    </sec>
    <sec id="sec010">
      <title>Lookup table and depth</title>
      <p>The size of each constant depth pairwise sub-table determines the lookup table to match against for precomputed negative log-likelihoods. In the context of Rhometa and aligned reads, the number of genomes parameter used to generate lookup tables is instead taken as depth. Where the bam file is of a high depth, this can result in pairwise sub-tables of high depth. In such cases, available lookup tables may not be of high enough depth to cover them. A subsampling feature is included that is able to automatically downsample the BAM to a given depth. This ensures that positions with a depth exceeding that of the highest generated lookup table are still evaluated and are not omitted from consideration. BAM subsampling uses a random sampling process and permits a list of seed values for testing and identifying any variance that can stem from the subsampling. In general, if the depth of the largest available lookup table is small, an increased need for downsampling could result in a decrease in estimation accuracy.</p>
    </sec>
    <sec id="sec011">
      <title>Calculating <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub></title>
      <p>The next step is to calculate recombination rate values for each variant site pairs, these values are denoted by <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub>, with <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> referring to the variant sites. The method used for calculation differs for crossing-over and gene-conversion modes of recombination. prokaryotes undergo recombination via gene-conversion and the equation used to calculate <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub> is as follows [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>]:
<disp-formula id="pgen.1010683.e001"><alternatives><graphic xlink:href="pgen.1010683.e001.jpg" id="pgen.1010683.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>For <xref rid="pgen.1010683.e001" ref-type="disp-formula">Eq 1</xref>, <italic toggle="yes">c</italic> represents the per base recombination rate, <italic toggle="yes">t</italic> the mean gene conversion tract length and <italic toggle="yes">d</italic><sub><italic toggle="yes">ij</italic></sub> the distance between a variant site pair. <italic toggle="yes">ct</italic> is taken together and represents the range of population recombination rates being evaluated, this is typically between 0–100 and is the same as the range of ρ values used when generating the lookup tables. The process essentially involves computing <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub> for each variant site pair for the range of population recombination rate values.</p>
    </sec>
    <sec id="sec012">
      <title>Final pairwise likelihoods</title>
      <p>Next, we bring together the information we have generated thus far: the output of the lookup table and depth step and calculating <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub> step. For each variant site pair, we use the corresponding negative log-likelihood values from the lookup table and depth step, and on these apply linear interpolation to determine the negative log-likelihood values for <italic toggle="yes">r</italic><sub><italic toggle="yes">ij</italic></sub> value for that variant pair configuration. The interpolation is performed against the range of population recombination rates used to generate the lookup tables. This process is done for all the variant site pairs and the results are the final negative log-likelihoods for a given range of population recombination rates being evaluated, which again is typically between 0–100.</p>
    </sec>
    <sec id="sec013">
      <title>Population recombination rate</title>
      <p>Prior to computing the final log-likelihood sums we weight adjust the negative log-likelihoods. As the number of observations provided at a given depth represents the degree of evidential support towards the final ρ estimate, we introduce a novel weighting algorithm that accounts for the additional information in high depth, high observation count site pairs relative to low depth / low count site pairs. The weighting algorithm is a simple solution to reliably add more weight to higher depth regions and the number of observations at that depth (there can be many regions of same depth). The weighting and final negative log-likelihood summation algorithms are as follows:
<disp-formula id="pgen.1010683.e002"><alternatives><graphic xlink:href="pgen.1010683.e002.jpg" id="pgen.1010683.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pgen.1010683.e003"><alternatives><graphic xlink:href="pgen.1010683.e003.jpg" id="pgen.1010683.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Here, <italic toggle="yes">d</italic> represents depths observed in the dataset. Weighting is performed on each per-depth table denoted by <italic toggle="yes">w</italic><sub><italic toggle="yes">d</italic></sub>(<italic toggle="yes">ρ</italic>) (<xref rid="pgen.1010683.e002" ref-type="disp-formula">Eq 2</xref>). In the right side of the <xref rid="pgen.1010683.e002" ref-type="disp-formula">Eq 2</xref>, <italic toggle="yes">T</italic><sub><italic toggle="yes">d</italic></sub> is the unweighted per-depth table and <italic toggle="yes">n</italic><sub><italic toggle="yes">d</italic></sub> the number of unique variant site pairs. The reweighted negative log-likelihoods <italic toggle="yes">w</italic><sub><italic toggle="yes">d</italic></sub>(<italic toggle="yes">ρ</italic>) are collected across depths and summed with respect to the range of population recombination rates being evaluated. The maximum negative log-likelihood value (closest to 0) then corresponds to the final population recombination rate <italic toggle="yes">ρ</italic><sub><italic toggle="yes">max</italic></sub> (<xref rid="pgen.1010683.e003" ref-type="disp-formula">Eq 3</xref>) estimate.</p>
    </sec>
    <sec id="sec014">
      <title>Program structure</title>
      <p>The program is organised into 4 pipelines, each dedicated to a specific task. These pipelines are written using nextflow, a framework for pipeline management [<xref rid="pgen.1010683.ref033" ref-type="bibr">33</xref>]. All the scripts used in the individual pipeline steps were written using the python programming language and various python libraries. Some python scripts were adapted or used as is from the programs LDpop [<xref rid="pgen.1010683.ref032" ref-type="bibr">32</xref>] and pyrho [<xref rid="pgen.1010683.ref023" ref-type="bibr">23</xref>]. Additional programs used in the pipelines include msprime [<xref rid="pgen.1010683.ref034" ref-type="bibr">34</xref>], ART [<xref rid="pgen.1010683.ref035" ref-type="bibr">35</xref>], BWA MEM [<xref rid="pgen.1010683.ref028" ref-type="bibr">28</xref>], seaborn [<xref rid="pgen.1010683.ref036" ref-type="bibr">36</xref>] and samtools [<xref rid="pgen.1010683.ref030" ref-type="bibr">30</xref>].</p>
      <p>The four pipelines, sim_gen, theta_est, lookup_table_gen and rho_est (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1</xref>), correspond to the nextflow pipeline names, e.g. sim_gen.nf within Rhometa, and perform the functions defined in the following paragraphs.</p>
      <fig position="float" id="pgen.1010683.g001">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The pipelines that together make up Rhometa.</title>
          <p>(<bold>A</bold>) Pipeline for generating simulated metagenomic read datasets. (<bold>B</bold>) Pipeline for estimating the population mutation rate (<bold>C</bold>) Pipeline for generating the lookup tables required for the recombination rate estimator (<bold>D</bold>) Pipeline for estimating the population recombination rate.</p>
        </caption>
        <graphic xlink:href="pgen.1010683.g001" position="float"/>
      </fig>
      <p>Sim_gen (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1A</xref>) is used to generate BAM files and FASTA reference files with simulated reads from bacterial genomes with recombination. The bacterial genomes are simulated using msprime. This pipeline is primarily included so that the simulated datasets used for this paper can be reproduced, but is not required to analyse real datasets. It is in a separate repository and can be accessed at: <ext-link xlink:href="https://github.com/sid-krish/Rhometa_sim" ext-link-type="uri">https://github.com/sid-krish/Rhometa_sim</ext-link></p>
      <p>Theta_est (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1B</xref>) is used to determine the population mutation rate per site (<italic toggle="yes">θ</italic>) based on the Watterson estimate as implemented in LDhat, details in methods. This pipeline estimates <italic toggle="yes">θ</italic> on the dataset of interest, furthermore, <italic toggle="yes">θ</italic> per site is one of the required parameters for generating lookup tables. The user has the option to use the estimated <italic toggle="yes">θ</italic> or a different value when generating lookup tables.</p>
      <p>The Lookup_table_gen (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1C</xref>) component of the pipeline makes use of LDpop and pyrho to generate the lookup tables required for the recombination rate estimator and can be launched in one of 2 ways. It can either use a pre-generated lookup table for high depth, which then will be downsampled for each depth from 3 to the depth of the lookup table or the pipeline can generate a high depth lookup table from scratch and then perform the downsampling step. The downsampling algorithm is a part of pyrho, it is significantly faster to generate the required smaller lookup tables from a larger table via downsampling and the results are essentially identical.</p>
      <p>The rho_est pipeline (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1D</xref>) is used to estimate the population recombination rate of metagenomic read based datasets provided in the form of BAM and reference FASTA files. It makes use of the lookup tables generated by the lookup_table_gen pipeline.</p>
      <p>Rhometa is available at: <ext-link xlink:href="https://github.com/sid-krish/Rhometa" ext-link-type="uri">https://github.com/sid-krish/Rhometa</ext-link></p>
      <p>Our pipelines for evaluating LDHat, the Rhometa_full_genome pipeline and the simulated dataset generator for these pipelines can be accessed here:</p>
      <list list-type="bullet">
        <list-item>
          <p>LDhat Nextflow Pipeline: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat</ext-link></p>
        </list-item>
        <list-item>
          <p>Rhometa Full Genome Pipeline: <ext-link xlink:href="https://github.com/sid-krish/Rhometa_Full_Genome" ext-link-type="uri">https://github.com/sid-krish/Rhometa_Full_Genome</ext-link></p>
        </list-item>
        <list-item>
          <p>Nextflow_LDhat_sim (used for both Rhometa Full Genome and LDhat Nextflow Pipeline): <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat_Sim" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat_Sim</ext-link></p>
        </list-item>
      </list>
    </sec>
    <sec id="sec015">
      <title>Simulated datasets</title>
      <p>The development of our program was performed in two major phases, for the first phase we endeavoured to create a full genome recombination rate estimation pipeline for bacterial sequences based on the LDhat methodology (Rhometa_full_genome), once we were certain that we were able to replicate LDhat’s results exactly we then carefully adapted the program to work with read based datasets (Rhometa).</p>
      <p>To evaluate LDhat and Rhometa_full_genome, we utilised msprime [<xref rid="pgen.1010683.ref034" ref-type="bibr">34</xref>] to simulate bacterial sequences with recombination. Our simulations included multiple genomes (5–100 genomes) of size 25KB, under population recombination rates [5, 12.5, 25, 37.5, 50], mean recombination tract length 500bp, with 10 replicates (seed values 1–10) and population mutation rate 0.01. Lookup tables for population mutation rate 0.01 and population recombination rates 0–100 (101 steps) were used.</p>
      <p>The LDhat pipeline configured for gene-conversion is available at: <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat</ext-link>. Rhometa_full_genome pipeline is available at: <ext-link xlink:href="https://github.com/sid-krish/Rhometa_Full_Genome" ext-link-type="uri">https://github.com/sid-krish/Rhometa_Full_Genome</ext-link>. The full genome simulation pipeline is available at <ext-link xlink:href="https://github.com/sid-krish/Nextflow_LDhat_Sim" ext-link-type="uri">https://github.com/sid-krish/Nextflow_LDhat_Sim</ext-link>. A point of note is that the <italic toggle="yes">θ</italic> estimator is implemented separately by us as per [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>, Eq 1] in both our LDhat pipeline and Rhometa_full_genome pipeline. Additionally, all variant sites are used for <italic toggle="yes">θ</italic> estimation, not just bi-allelic ones.</p>
      <p>When simulating the population recombination rate with msprime, the number of samples (genomes), sequence length, recombination rate (<italic toggle="yes">r</italic>), mean gene conversion tract length (<italic toggle="yes">t</italic>), seed value and mutation rate (<italic toggle="yes">u</italic>) are provided, the effective population size (<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>) was 1 (default) and the ploidy (<italic toggle="yes">i</italic>) was fixed to 1. Default options are used in all other cases. Within msprime, the population recombination rate ρ is calculated as such: 2 * <italic toggle="yes">i</italic> * <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub> * <italic toggle="yes">r</italic> * <italic toggle="yes">t</italic>. The per site population mutation rate <italic toggle="yes">θ</italic> was calculated as such: 2 * <italic toggle="yes">i</italic> * <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub> * <italic toggle="yes">u</italic>.</p>
      <p>Initially the number of genomes was fixed and we varied the length of the genomes, but this analysis revealed that varying the genome length does not have a significant impact on the final population recombination rate estimations (<xref rid="pgen.1010683.s001" ref-type="supplementary-material">S1 Fig</xref>). We therefore fixed the genome length and varied the number of genomes and in doing so we found that as the number of genomes increased the accuracy and variance of the final estimations also improved (<xref rid="pgen.1010683.g002" ref-type="fig">Fig 2</xref>).</p>
      <fig position="float" id="pgen.1010683.g002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparison of LDhat and Rhometa_full_genome when running on simulated full genomes.</title>
          <p>(<bold>A</bold>) LDhat. Simulated vs Estimated population recombination rate (ρ) for varying number of simulated full bacterial genome sequences. (<bold>B</bold>) Rhometa_full_genome. Simulated vs Estimated population recombination rate (ρ) for varying number of simulated full bacterial genome sequences.</p>
        </caption>
        <graphic xlink:href="pgen.1010683.g002" position="float"/>
      </fig>
      <p>We took a similar approach to evaluating the read based pipeline Rhometa to that used with LDhat and Rhometa_full_genome. For the read-based pipeline, the simulated full bacterial sequences, simulated via msprime, are further processed to be in the form of reads using the read simulator ART [<xref rid="pgen.1010683.ref035" ref-type="bibr">35</xref>], which simulates sequencing reads by mimicking real sequencing processes with empirical error models. The reads were simulated based on the Illumina HiSeqX TruSeq system. These reads are then aligned to one of the bacterial sequences which represents the reference FASTA file, the first of the simulated sequences is used for this (<xref rid="pgen.1010683.g001" ref-type="fig">Fig 1A</xref>). The aligned BAM and reference FASTA are then used for recombination rate estimation.</p>
      <p>The simulation parameters were as follows: the effective population size was 1 (default) and the ploidy was set to 1, number of genomes 20–200, genome length 100KB, population recombination rates [10.0, 20.0, 30.0, 40.0, 50.0], mean recombination tract length 1000bp, with 20 replicates (seed values 1–20) and population mutation rate of 0.01. Each seed value used applies to all aspects of the pipeline where a seed is required. The reads were paired-end of length 150bp, insert length 300bp, standard deviation of 25bp, with window size set to 1000 during analysis and the fold coverage values were [<xref rid="pgen.1010683.ref001" ref-type="bibr">1</xref>, <xref rid="pgen.1010683.ref004" ref-type="bibr">4</xref>, <xref rid="pgen.1010683.ref008" ref-type="bibr">8</xref>, <xref rid="pgen.1010683.ref016" ref-type="bibr">16</xref>]. The lookup tables were generated and used for 3–250 (genomes), generated under population mutation rate 0.01 for population recombination rates 0–100 (0–1 in 101 steps plus 1–100 in 100 steps). Bam subsampling was also automatically applied by Rhometa during analysis if needed.</p>
      <p>Additionally for the read-based pipeline, we evaluated the deviation of the estimated results from the simulated values. The formula used to calculate the deviation is (Estimated ρ (mean)—Simulated ρ) / Simulated ρ. This makes it easier to gauge the magnitude of deviation from the expected.</p>
    </sec>
    <sec id="sec016">
      <title>Real Datasets—Transformation experiment</title>
      <p>To further evaluate Rhometa we applied our pipeline on the data derived from a previously published laboratory transformation experiment, where the extent and distribution of recombination events were quantified. In the experiment [<xref rid="pgen.1010683.ref037" ref-type="bibr">37</xref>], in vitro recombination through transformation was performed on a S. pneumoniae strain. Transformed isolates were then sequenced and recombination events were identified. This dataset was also used to evaluate the mcorr method by its authors and as such it provides us with the opportunity to compare the results of our pipeline against those published in the mcorr paper.</p>
      <p>The transformation experiments were performed with different concentrations of donor DNA, 5 ng mL-1 and 500 ng mL-1, 5 ng mL-1 and 500 ng mL-1 experiments (<xref rid="pgen.1010683.s009" ref-type="supplementary-material">S2 Table</xref>) had a similar number of recombination events, with the 5 ng mL-1 having a slightly larger number of events, the authors state that this indicates a single piece of DNA can act as the origin for multiple recombination events. The dataset is available in the form of reads, which Rhometa was designed to analyse. Each 5 ng mL-1 sample from experiment 1 was aligned to S. pneumoniae reference sequence ATCC 700669, NCBI accession NC_011900.1 the resulting BAM files were then merged and analysed with Rhometa.</p>
      <p>To analyse the datasets, we first estimated the <italic toggle="yes">θ</italic> for median depth using the <italic toggle="yes">θ</italic> estimation pipeline, from which we obtained <italic toggle="yes">θ</italic>, that is per site by default. We then generated lookup tables, based on the <italic toggle="yes">θ</italic>, for population recombination rates 0–20 in 201 steps for 3–200 genomes and used the lookup tables for the recombination rate estimation pipeline. Subsampling was enabled, with a window size of 1000 for paired end reads. As given in the Croucher et al paper [<xref rid="pgen.1010683.ref037" ref-type="bibr">37</xref>], we used the value of <italic toggle="yes">t</italic> = 2300 bp as the mean tract length for analysis. Additionally, we used 5 different seed values [0, 1, 2, 3, 4] for the subsampling step to account for any variance and then took the average of the values for recombination rate estimations.</p>
      <p>Using the ρ and <italic toggle="yes">θ</italic> estimates along with information from the experiment we also calculated the ρ per site and r/m values. The default ρ estimate, by Rhometa, is a whole-genome estimate. To obtain ρ per site, the estimated ρ value was divided by the mean tract length of 2300 bp. To get the r/m value, we used the conversion formula [<xref rid="pgen.1010683.ref026" ref-type="bibr">26</xref>]: ρ (per site)/<italic toggle="yes">θ</italic> (per site) * tract length * substitution probability. We estimated the substitution probability between the donor and recipient and found it to be <inline-formula id="pgen.1010683.e004"><alternatives><graphic xlink:href="pgen.1010683.e004.jpg" id="pgen.1010683.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>17534</mml:mn><mml:mo>−</mml:mo><mml:mn>385</mml:mn></mml:mrow><mml:mrow><mml:mn>2221315</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.00772</mml:mn></mml:math></alternatives></inline-formula>, where 2221315 is the recipient genome length and based on the information provided by Croucher et. al (2012) “… the donor DNA identified 17,534 SNPs when aligned to the recipient sequence, of which 385 appeared to be false positives … These positions were excluded from subsequent analyses.” [<xref rid="pgen.1010683.ref037" ref-type="bibr">37</xref>].</p>
      <p>We repeated the process above for each 500 ng mL-1 sample from experiment 1 and the final merged BAM was analysed with Rhometa. Furthermore, the 5 ng mL-1 samples and 500 ng mL-1 samples in experiment 1 were analysed together, corresponding to 84 sequences. We prepared this dataset by merging the final 5 ng and 500 ng BAMs. We performed this analysis, to enable comparison with mcorr’s published results. The analysis was performed using the same process as with the 5 ng mL-1 samples and 500 ng mL-1 samples.</p>
    </sec>
    <sec id="sec017">
      <title>Real datasets—Ocean metagenomic dataset</title>
      <p>To evaluate our pipeline on typical metagenomic data we selected 15 publicly available short-read metagenomic reads-sets (<xref rid="pgen.1010683.s010" ref-type="supplementary-material">S3 Table</xref>) sampled from waters at the Australian Integrated Marine Observing System (IMOS) Port Hacking National Reference Station (NRS) [<xref rid="pgen.1010683.ref038" ref-type="bibr">38</xref>] (<xref rid="pgen.1010683.s010" ref-type="supplementary-material">S3 Table</xref>). These 15 datasets represent 15 consecutive monthly time points (July 2012—September 2013). Next, we assembled a long-read metagenomic read-set (accession: SRR13002033) collected in March 2018 from the location using metaFlye (v2.8.3-b1705) (default options) [<xref rid="pgen.1010683.ref039" ref-type="bibr">39</xref>], Three long contigs (lengths: 0.8–1.0 Mbp) were selected from the assembly to be used as references for read-mapping (<xref rid="pgen.1010683.t003" ref-type="table">Table 3</xref>). Confident taxonomic assignments were determined for each contig using MMseqs2 (v14.7e284) (default easy-taxonomy options) [<xref rid="pgen.1010683.ref040" ref-type="bibr">40</xref>] against the latest GTDB taxonomic database (release: R07-RS207) [<xref rid="pgen.1010683.ref041" ref-type="bibr">41</xref>]. The 15 read-sets were mapped to each reference contig using BWA MEM (v0.7.17-r1188) (default options) [<xref rid="pgen.1010683.ref028" ref-type="bibr">28</xref>] and the resulting BAMs merged respectively with samtools (v1.16.1) [<xref rid="pgen.1010683.ref030" ref-type="bibr">30</xref>]. CoverM (v.0.6.1) [<xref rid="pgen.1010683.ref042" ref-type="bibr">42</xref>] was then used with the metabat method to determine the coverage for the aligned bams. Lookup tables for 3–250 (genomes), generated under population mutation rate 0.01 for population recombination rates 0–100 (0–1 in 101 steps plus 1–100 in 100 steps) were used. The tract was fixed at 1000bp as was the window size. As with the transformation experiment analysis we used 5 different seed values [0, 1, 2, 3, 4] for the subsampling step to account for variance and then took the average of the values for ρ estimations.</p>
    </sec>
  </sec>
  <sec id="sec018">
    <title>Verification and comparison</title>
    <sec id="sec019">
      <title>Evaluation on simulated datasets</title>
      <p>We first validated the full genome version of Rhometa (Rhometa_full_genome), which reimplements the core LDhat pairwise method to estimate ρ. This was done to ensure accuracy in reimplantation of core LDhat algorithms which forms the basis for the read based (Rhometa) implementation. Comparison of estimated population recombination rate (ρ) between LDhat and our reimplementation (Rhometa_full_genome), using our sweep of simulated genomes, shows identical results between LDhat (<xref rid="pgen.1010683.g002" ref-type="fig">Fig 2A</xref>) and our reimplementation (<xref rid="pgen.1010683.g002" ref-type="fig">Fig 2B</xref>), thus ensuring that we have captured LDhat’s algorithms accurately. With LDhat and our reimplementation, the number of genomes simulated has a large impact on the accuracy of the estimates, with results improving with higher numbers of genomes, especially at higher recombination rates.</p>
      <p>We next evaluated Rhometa’s performance using our sweep of simulated read-sets. The number of simulated genomes had a large bearing on estimation accuracy (<xref rid="pgen.1010683.g003" ref-type="fig">Fig 3</xref>), as also observed with LDhat, accuracy improved as the number of genomes increased and inter-replicate variance decreased as the coverage (fold_coverage) improved. This is especially evident for higher recombination rates. Larger population recombination rate values appear to require a relatively higher number of genomes for accurate estimation. For very low recombination rates between 0–1 (<xref rid="pgen.1010683.s003" ref-type="supplementary-material">S3 Fig</xref>), the improvement in accuracy was not seen and a tendency to overestimate was observed.</p>
      <fig position="float" id="pgen.1010683.g003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Simulated vs Estimated population recombination rate (ρ) results for Rhometa.</title>
          <p>Results for varying numbers of simulated genomes and fold coverage values for population recombination rates 10.0, 20.0, 30.0, 40.0, 50.0.</p>
        </caption>
        <graphic xlink:href="pgen.1010683.g003" position="float"/>
      </fig>
      <p>To get a clearer picture of the deviation of the estimated population recombination rate from the expected result, we calculated the deviation for the read based results (<xref rid="pgen.1010683.g004" ref-type="fig">Fig 4</xref>). Here values closer to 0 indicated better performance, while values above 0 are overestimations, and values below 0 are underestimations (i.e. a deviation value of +/- 0.1 would indicate that the final result is off by 10%). As the number of simulated genomes increased, the deviation of estimated to expected tended to decrease, achieving a deviation of less than 5–10% in most cases for a simulated ρ of 50 with 200 genomes and 16x coverage. Such improvement is consistent with the patterns observed in LDhat. For simulated population recombination rates between 10–50, having greater than 80 genomes produced the least amount of deviation (generally within 20–30%), with the results significantly improving when more genomes are present. Our pipeline appears to be robust to variance in fold coverage. The differences between 16x coverage and 1x coverage being minor (<xref rid="pgen.1010683.g003" ref-type="fig">Fig 3</xref>).</p>
      <fig position="float" id="pgen.1010683.g004">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Deviation plot for results in <xref rid="pgen.1010683.g003" ref-type="fig">Fig 3</xref>.</title>
          <p><bold>Deviation is calculated as (Estimated ρ (median)—Simulated ρ) / Simulated ρ.</bold> Deviation results corresponding to <xref rid="pgen.1010683.g003" ref-type="fig">Fig 3</xref> for population recombination rates 10.0, 20.0, 30.0, 40.0, 50.0.</p>
        </caption>
        <graphic xlink:href="pgen.1010683.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Evaluation on Real Datasets—Transformation Experiment</title>
      <p>After establishing the performance of Rhometa on simulated datasets, we interrogated its performance on real short-read sequence data from a lab-based experiment designed to track and study recombination in <italic toggle="yes">S</italic>. <italic toggle="yes">pneumoniae</italic> (<xref rid="pgen.1010683.t002" ref-type="table">Table 2</xref>), seed averaged values were taken for the final results, refer to <xref rid="pgen.1010683.s008" ref-type="supplementary-material">S1 Table</xref> for individual seed results.</p>
      <table-wrap position="float" id="pgen.1010683.t002">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title><italic toggle="yes">S</italic>. <italic toggle="yes">pneumoniae</italic> transformation experiment analysis.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1010683.t002" id="pgen.1010683.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">ρ</th>
                <th align="left" rowspan="1" colspan="1">ρ<break/>(per site)</th>
                <th align="left" rowspan="1" colspan="1"><italic toggle="yes">θ</italic><break/>(per site)</th>
                <th align="left" rowspan="1" colspan="1">ρ/<italic toggle="yes">θ</italic><break/>(per site)</th>
                <th align="left" rowspan="1" colspan="1">r/m</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">5 ng mL<sup>-1</sup></td>
                <td align="left" rowspan="1" colspan="1">5.56</td>
                <td align="left" rowspan="1" colspan="1">0.00242</td>
                <td align="left" rowspan="1" colspan="1">1.8e-5</td>
                <td align="left" rowspan="1" colspan="1">134.4</td>
                <td align="left" rowspan="1" colspan="1">2386.4</td>
              </tr>
              <tr>
                <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">500 ng mL<sup>-1</sup></td>
                <td align="left" rowspan="1" colspan="1">5.22</td>
                <td align="left" rowspan="1" colspan="1">0.00227</td>
                <td align="left" rowspan="1" colspan="1">2e-5</td>
                <td align="left" rowspan="1" colspan="1">113.5</td>
                <td align="left" rowspan="1" colspan="1">2015.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">84 sequences</td>
                <td align="left" rowspan="1" colspan="1">4.48</td>
                <td align="left" rowspan="1" colspan="1">0.00195</td>
                <td align="left" rowspan="1" colspan="1">1.8e-5</td>
                <td align="left" rowspan="1" colspan="1">108.3</td>
                <td align="left" rowspan="1" colspan="1">1922.97</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>To compare the results for the same transformation experiment with those of mcorr, the estimated r/m values were used. The authors of mcorr provide <bold>γ/μ</bold> (similar to r/m) for the evolved strain (reads) representing combined 5 ng mL<sup>-1</sup> samples and 500 ng mL<sup>-1</sup> samples in experiment 1 (84 sequences) where they estimate a <bold>γ/μ</bold> value of 0.93. Due to the nature of the experiment, it was expected that the rate of recombination would be far higher than the rate of mutation. As an experiment designed to induce transformation over short timescales, this should lead to a large excess of substitutions derived from recombination events, relative to <italic toggle="yes">de novo</italic> mutation. As such, mcorr potentially significantly underestimated the true value and Rhometa better reflects our <italic toggle="yes">a priori</italic> expectation for the 84 sequence dataset with an estimated r/m ratio of 1922.97.</p>
      <p>The 84 sequence dataset was also used to benchmark Rhometa. The bam file for this dataset is 11.42 GB in size. On a system with 4 CPUs and 32 GB RAM the rho_est pipeline took 1h 45m to complete and the theta_est pipeline took 2h 45m to complete.</p>
      <p>We can calculate the expected average r/m for a genome, as follows. In the Croucher et al paper [<xref rid="pgen.1010683.ref037" ref-type="bibr">37</xref>], they state that the mean proportion in the recipient genome changed due to recombination was 1.4% using which we can estimate the average number of bases changed by recombination in a single genome as: 2221315 (recipient genome length) * 0.014 * 0.00772 (substitution probability as calculated in methods above) = 240.08. Also, in the paper it is stated that there were 2,312 polymorphic sites, 59 of which not coming from the donor, 6 of these sites were false positives, with the others likely being de novo point mutations or intragenomic recombinations. So we can take the upper bound for de novo mutations to be 53, then to get the average number of de novo mutations per genome we can divide by 84, which is the total number of sequences in the combined 5 and 500 ng dataset, 53/84 = 0.631.</p>
      <p>Using this information derived for the average number of bases changed by recombination and mutation in a single genome, we can calculate the expected average r/m for a genome as 240/0.631 = 380.3, for the combined 84 sequence dataset. The actual value should be higher due to the fact that a region can experience multiple recombination events, so this would be a lower bound estimate. With Rhometa we do observe a value greater than 380.3 of 1922.97 for the 84 sequence dataset.</p>
    </sec>
    <sec id="sec021">
      <title>Evaluation on Real Datasets—Ocean Metagenomic Dataset</title>
      <p>Rhometa was further tested on real datasets, using samples from Port Hacking, Sydney. We produced estimates using reads mapped to 3 different assembly contigs (<xref rid="pgen.1010683.t003" ref-type="table">Table 3</xref>). A point of note is that within the family <italic toggle="yes">Cyanobiaceae</italic>, there is a difference in rates of recombination. It is in such comparisons that Rhometa could prove to be of great value.</p>
      <table-wrap position="float" id="pgen.1010683.t003">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1010683.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Port Hacking analysis.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pgen.1010683.t003" id="pgen.1010683.t003g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Contig_ID</th>
                <th align="left" rowspan="1" colspan="1">edge_21626</th>
                <th align="left" rowspan="1" colspan="1">edge_14330</th>
                <th align="left" rowspan="1" colspan="1">edge_29441</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">Lineage</th>
                <th align="left" rowspan="1" colspan="1">Cyanobacteria,<break/>Cyanobacteria,<break/>PCC-6307,<break/>Cyanobiaceae (A)</th>
                <th align="left" rowspan="1" colspan="1">Cyanobacteria,<break/>Cyanobacteria,<break/>PCC-6307,<break/>Cyanobiaceae (B)</th>
                <th align="left" rowspan="1" colspan="1">Actinobacteriota,<break/>Acidimicrobiia,<break/>Actinomarinales,<break/>Actinomarinaceae</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Coverage depth</td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">729</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Contig length</td>
                <td align="left" rowspan="1" colspan="1">1029283 bp</td>
                <td align="left" rowspan="1" colspan="1">926756 bp</td>
                <td align="left" rowspan="1" colspan="1">797490 bp</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ρ (Seed 0)</td>
                <td align="left" rowspan="1" colspan="1">2.00</td>
                <td align="left" rowspan="1" colspan="1">0.38</td>
                <td align="left" rowspan="1" colspan="1">0.18</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ρ (Seed 1)</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.21</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ρ (Seed 2)</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.41</td>
                <td align="left" rowspan="1" colspan="1">0.22</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ρ (Seed 3)</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.28</td>
                <td align="left" rowspan="1" colspan="1">0.17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ρ (Seed 4)</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.69</td>
                <td align="left" rowspan="1" colspan="1">0.13</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Mean</td>
                <td align="left" rowspan="1" colspan="1">1.16</td>
                <td align="left" rowspan="1" colspan="1">0.55</td>
                <td align="left" rowspan="1" colspan="1">0.18</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Stddev</td>
                <td align="left" rowspan="1" colspan="1">0.47</td>
                <td align="left" rowspan="1" colspan="1">0.29</td>
                <td align="left" rowspan="1" colspan="1">0.04</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec022">
    <title>Discussion</title>
    <p>Recombination plays a crucial role in microbial evolution and speciation [<xref rid="pgen.1010683.ref043" ref-type="bibr">43</xref>–<xref rid="pgen.1010683.ref045" ref-type="bibr">45</xref>]. Understanding the rate at which recombination occurs provides us an insight into the impact of this process. Metagenomics is the only method that allows us to study recombination in real-world natural microbial communities without culture bias [<xref rid="pgen.1010683.ref046" ref-type="bibr">46</xref>]. However, there are currently no software tools to accurately estimate population recombination rates on large metagenomic datasets. To fill this gap, we have developed Rhometa, a software implementation that builds on the composite likelihood estimator for population recombination rate estimation method and enables interrogation of next generation sequencing reads from shotgun metagenomic experiments. It is adjusted for gene-conversion type recombination as experienced by prokaryotic populations.</p>
    <p>Composite likelihood population recombination rate estimators are among the most accurate methods known, and our implementation makes these methods available to the wider metagenomics community. This is significant as most microbes cannot readily be cultured, by some estimates only 1–15% are readily cultivable in laboratories [<xref rid="pgen.1010683.ref047" ref-type="bibr">47</xref>].</p>
    <p>Shotgun metagenomics yields reads from microbes taken directly from the natural environment and mitigates issues related to culture dependent studies. However, there has, until now, not been a viable approach for quantifying the population recombination rate from these reads. PIIM [<xref rid="pgen.1010683.ref022" ref-type="bibr">22</xref>] and mcorr [<xref rid="pgen.1010683.ref027" ref-type="bibr">27</xref>] come closest to being applicable to shotgun metagenomic datasets, being designed for this use case. However, in the case of PIIM its statistical model uses a very compute intensive approach to account for low quality data, and missing data, including missing coverage, making the compute requirements impractical for large modern datasets.</p>
    <p>Meanwhile, with mcorr, the mathematical formulation is distinct from the well-known population recombination rate (ρ = 2<italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub><italic toggle="yes">r</italic>), which may represent challenges for interpretation. On an experimental dataset where transformation was used to produce a population of recombinants for sequencing, the approach implemented in mcorr appears to significantly underestimate the recombination rate. Furthermore, mcorr was evaluated on simulated datasets used to test for Rhometa (<xref rid="pgen.1010683.s007" ref-type="supplementary-material">S7 Fig</xref>) where we expected to see an increase in the <italic toggle="yes">ϕ</italic><sub>pool</sub> estimated as the simulated ρ increases. However, the results showed no correlation between the recombination rate inferred by mcorr and the true simulated rate. Additionally, <italic toggle="yes">ϕ</italic><sub>pool</sub>, the value for recombination estimated by mcorr complicates interpretability by not using the standard parameter for population recombination (ρ). mcorr’s limitation of looking at coding regions provided in a gene annotation file again complicates analysis as this information is not always available. Rhometa builds on established methods and theoretical foundations, without the need for gene annotation files and based on our testing, produces accurate results.</p>
    <p>To build our program, our approach was to first reimplement the LDhat pairwise program for gene conversion. Doing so we were able verify that we accurately captured the core algorithms of LDhat while having a modern and adaptable implementation around it. The simulation results for LDhat and the Rhometa_full_genome (<xref rid="pgen.1010683.g002" ref-type="fig">Fig 2A and 2B</xref>) show that we were able to reproduce the LDhat results 1:1. Having validated the reimplementation we then adapted it for read based datasets. LDhat is effective at detecting changes in the magnitude of the simulated population recombination rates, and produces accurate estimates for cases with large numbers of genomes (<xref rid="pgen.1010683.g002" ref-type="fig">Fig 2A</xref>). Our analysis showed a trend where the accuracy and variance of the estimates improved as the number of genomes increased.</p>
    <p>We then evaluated the performance of Rhometa on simulated datasets and the results (Figs <xref rid="pgen.1010683.g003" ref-type="fig">3</xref> and <xref rid="pgen.1010683.g004" ref-type="fig">4</xref>) demonstrated that the read-based pipeline performs well and consequently represents a successful implementation of the composite likelihood population recombination rate estimator for metagenomic read-based datasets. As with LDhat and Rhometa_full_genome, the performance of the read based pipeline improves with the number of genomes present, having 80 genomes or more produces the best results. However, it should be noted regardless of the number of genomes there is a bias towards underestimation of ρ, though this is small when there are many genomes present (<xref rid="pgen.1010683.g004" ref-type="fig">Fig 4</xref>). Very small ρ values, those between 0–1 (<xref rid="pgen.1010683.s003" ref-type="supplementary-material">S3 Fig</xref>), are an exception as the implementation has a tendency towards over estimation.</p>
    <p>Rhometa was further applied to a <italic toggle="yes">S</italic>.<italic toggle="yes">pneumoniae</italic> transformation experiment [<xref rid="pgen.1010683.ref037" ref-type="bibr">37</xref>], where the extent of recombination could be directly quantified. This dataset was also analysed by the authors of mcorr for their paper, enabling a cross comparison between the two programs. Preparing and analysing the dataset (<xref rid="pgen.1010683.t002" ref-type="table">Table 2</xref>, 84 sequences) in a manner performed by mcorr, it was found thatRhometa was able to accurately detect the higher rate of recombination relative to mutation as was expected for the dataset. From direct evidence, based on the information provided in the transformation experiment paper, we calculate a conservative lower bound for the ratio of recombination to mutation as r/m &gt; 380.3. Rhometa was able to meet this condition by estimating a r/m value of 1922.97, while mcorr estimated a r/m value of 0.93, which suggests that change due to mutation was greater than recombination, which is extremely unlikely.</p>
    <p>Evaluation on real environmental metagenomic samples (<xref rid="pgen.1010683.t003" ref-type="table">Table 3</xref>) showed that the program works on real datasets. While the analysis performed here was purely to test the applicability of the pipeline, it demonstrates potential for many comprehensive studies. Such as looking at the rate of recombination of a given species over time or across locations.</p>
    <p>Rhometa is well positioned to exploit the abundance of preexisting metagenomic datasets to enable a thorough first-pass study of recombination rates in microbial communities.</p>
    <p>The main difference between the LDhat approach and the read based approach is as follows. In LDhat the final population recombination rate estimate “is obtained by combining the likelihoods from all pairwise comparisons” [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>], the likelihoods (negative log-likelihoods) come from the pregenerated lookup tables as mentioned in methods. For genome sequence datasets this means we can use a likelihood table generated for the exact number of genomes/depth in a dataset, the number of genomes represents the depth which is fixed and all pairs of sites we look at will have this depth. Additionally, LDhat considers all possible variant site pair combinations across the sequences being analysed.</p>
    <p>A complication associated with read-based datasets is that the depth can vary greatly from site to site. We addressed this issue by using an appropriate depth lookup table for the variant site pairs being considered, the rationale for which is that the negative log-likelihoods for the variant site pairs considered is obtained individually and then combined for a final composite negative log-likelihood. Taking into account that the negative log-likelihoods are obtained individually for each pair of variant sites, the variant pair combinations considered are limited to the extent of a read for single-end reads, for the insert length in the case of pair-end reads.</p>
    <p>This provides a way for us to group the variant sites by depth, following which we use the appropriate depth negative log-likelihood table to obtain the negative log-likelihoods for each pair and then finally combine the negative log-likelihoods to get a result for the entire dataset. Additionally, we have introduced a novel weighted sum when calculating the composite negative log-likelihood across coverage depth (<xref rid="pgen.1010683.e002" ref-type="disp-formula">Eq 2</xref>). Rhometa thus enables the application of the composite likelihood estimator approach for current shotgun metagenomic datasets.</p>
    <p>An important advantage of Rhometa and its use of raw reads over a consensus assembly from each sample, is that the potential microdiversity within each dataset is preserved for analysis.</p>
    <p>As discussed, Rhometa performs better the more genomes there are, it is possible to get a minimum count for the number of genomes present when simulated under the coalescent model with recombination. In real metagenomic samples, any single sample may have millions of genomes of the same species, and across samples there may be significant population structure that is not captured by the standard coalescent model with recombination. The relationship between the number of metagenomic samples, the depth of sequencing of each sample, and the genome count in our simulation study is therefore not straightforward.</p>
    <sec id="sec023">
      <title>Limitations and future directions</title>
      <p>While we have endeavoured to make a complete package with Rhometa that addresses all aspects of population recombination rate, there are a few limitations. One such limitation is the automatic inference of the tract length, which is also not possible with LDhat [<xref rid="pgen.1010683.ref012" ref-type="bibr">12</xref>] or PIIM [<xref rid="pgen.1010683.ref022" ref-type="bibr">22</xref>]. In the context of the composite likelihood approach, the authors of both LDhat and PIIM suggest that while it may be theoretically possible to co-estimate the population recombination rate and tract length, in practice it is challenging. Instead, following the examples of LDhat and PIIM, Rhometa fixes the mean tract length for population recombination rate estimation. As observed by the authors of PIIM, tract length tends to rescale the population recombination rate estimate and large misspecifications can cause further deviations [<xref rid="pgen.1010683.ref022" ref-type="bibr">22</xref>]. In our tests with simulated datasets where the tract length was varied, it was found that misspecifying the tract length tends to linearly scale the final estimates in a predictable manner (<xref rid="pgen.1010683.s006" ref-type="supplementary-material">S6 Fig</xref>). If a fixed value of tract length is given by the user for all analyses (i.e. an accurate sample-specific tract length is not provided by the user), then differences in inferred rho among samples could be due to either a change in the recombination rate or a change in tract length. The user will need to take this into account when interpreting the results. For instance, if performing same species comparisons across time and location, the tract length can be fixed to determine relative changes in the magnitude of recombination.</p>
      <p>Furthermore, the nature of our method is not sensitive to very low rates of recombination as observed when attempting to evaluate rates between 0–1 and we suggest exercising caution for such fine scale analysis.</p>
      <p>Another point of note concerns the generation of the lookup tables for the program. While it is relatively fast to generate lookup tables due to the incorporation of LDpop, it can still require substantial time and resources for a high-resolution table with a large number of genomes. Generation of lookup tables require specification of, in our tests we have found that Rhometa is fairly robust to misspecifications of <italic toggle="yes">θ</italic>. It is only extreme misspecifications, such as misspecifications by a factor of 10, that seem to have a large impact (<xref rid="pgen.1010683.s005" ref-type="supplementary-material">S5 Fig</xref>).</p>
      <p>We believe the availability of a tool such as Rhometa, which can be easily applied to current metagenomic datasets is timely and significantly expands the range of habitats and therefore microbial communities that can be studied for recombination, giving us an insight into the extent to which they can adapt and speciate. How ρ varies within environments and between taxa is unknown, Rhometa can help investigate many such fundamental questions related to the evolution and survival capacity of microbes. With the aid of data analysis techniques, metagenomic datasets can be further combined with environmental and sequencing metadata to help study the intricacies of recombination. Many ecological factors can modulate and effect recombination [<xref rid="pgen.1010683.ref048" ref-type="bibr">48</xref>]. Synthesis of other data types with the results of our program may yield a clearer understanding of such relationships. We have built our approach in a modular and easy to adapt manner making this and similar applications easy to explore in the future.</p>
    </sec>
  </sec>
  <sec id="sec024" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pgen.1010683.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Results of varying simulated genome lengths for testing LDhat (number of genomes fixed at 10, tract length 500).</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Comparing simulated single end and paired end read datasets in Rhometa.</title>
        <p>(<bold>A</bold>) Single end results. (<bold>B</bold>) Paired end results.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Simulated vs Estimated population recombination rate (ρ) results for Rhometa.</title>
        <p>Results for varying numbers of simulated genomes and fold coverage values for population recombination rates 0.0, 0.1, 0.2, 0.3, 0.4, 0.5. The simulation parameters used are the same as for population recombination rates [10.0, 20.0, 30.0, 40.0, 50.0], except lookup tables for population recombination rates 0–2 were used (0–2 in 201 steps) for depths of 3–200.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Simulated vs Estimated theta per site (θ) results for LDhat and Rhometa.</title>
        <p>(<bold>A</bold>) LDhat. Simulated vs Estimated theta per site (θ) for varying number of simulated bacterial genomes. (<bold>B</bold>) Rhometa. Simulated vs Estimated theta per site (θ) for varying number of simulated bacterial genomes.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <p>Results of analyzing simulated datasets with lookup tables generated under misspecified θ (genome length fixed at 100,000) (<bold>A</bold>) Simulated datasets analyzed with true θ (0.01) lookup tables (<bold>B</bold>) Simulated datasets analyzed with misspecified θ (0.005) lookup tables (<bold>C</bold>) Simulated datasets analyzed with misspecified θ (0.02) lookup tables (<bold>D</bold>) Simulated datasets analyzed with misspecified θ (0.1) lookup tables.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Results of analyzing simulated datasets with misspecified tract lengths (genome length fixed at 100,000.</title>
        <p>θ 0.01 lookup tables used<bold>)</bold> (<bold>A</bold>) Simulated datasets analyzed with true tract length 1000 bp (<bold>B</bold>) Simulated datasets analyzed with misspecified tract length 500 bp (<bold>C</bold>) Simulated datasets analyzed with misspecified tract length 2000 bp.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Mcorr tested using the simulated datasets used for rhometa (Figs <xref rid="pgen.1010683.g003" ref-type="fig">3</xref> and <xref rid="pgen.1010683.g004" ref-type="fig">4</xref>).</title>
        <p>Mcorr uses bam (aligned reads) and gff (gene annotations) files as inputs. For the gene annotations, coding regions need to be provided for mcorr. With the simulated data every 1000 bp was defined as a coding region (CDS). Out of 4000 simulations, some could not be completed and many extremely large unrealistic realistic values. A filter was used where such instances were discarded and only phi_pool values &lt; 100 were kept. After filtering there were only 2386/4000 values.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1010683.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s008" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Analysis results of s_pnemoniae transformation.</title>
        <p>Results for all seed values.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1010683.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s009" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title><italic toggle="yes">S</italic>.<italic toggle="yes">pneumoniae</italic> experiment accession codes.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1010683.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s010" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Accession codes for Port Hacking, Sydney datasets (from SRA run table).</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1010683.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pgen.1010683.s011" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Lookup configuration.</title>
        <p>Matching against the lookup table.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1010683.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>I would like to acknowledge Dr. Michael Lake of UTS eResearch for helping me with HPC related tasks using which all the analysis in this paper was performed. I would also like to thank Fredrick Jaya, PhD Student at ANU for helping with the help message function in the nextflow pipelines.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1010683.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Iranzo</surname><given-names>J</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Sela</surname><given-names>I</given-names></name>. <article-title>Gene gain and loss push prokaryotes beyond the homologous recombination barrier and accelerate genome sequence divergence</article-title>. <source>Nat Commun</source>. <year>2019</year>;<volume>10</volume>: <fpage>5376</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-13429-2</pub-id><?supplied-pmid 31772262?><pub-id pub-id-type="pmid">31772262</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Bobay</surname><given-names>L-M</given-names></name>. <article-title>CoreSimul: a forward-in-time simulator of genome evolution for prokaryotes modeling homologous recombination</article-title>. <source>BMC Bioinformatics</source>. <year>2020</year>;<volume>21</volume>: <fpage>264</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-020-03619-x</pub-id><?supplied-pmid 32580695?><pub-id pub-id-type="pmid">32580695</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Paulsson</surname><given-names>J</given-names></name>, <name><surname>El Karoui</surname><given-names>M</given-names></name>, <name><surname>Lindell</surname><given-names>M</given-names></name>, <name><surname>Hughes</surname><given-names>D</given-names></name>. <article-title>The processive kinetics of gene conversion in bacteria</article-title>. <source>Mol Microbiol</source>. <year>2017</year>;<volume>104</volume>: <fpage>752</fpage>–<lpage>760</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/mmi.13661</pub-id><?supplied-pmid 28256783?><pub-id pub-id-type="pmid">28256783</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Vos</surname><given-names>M</given-names></name>, <name><surname>Didelot</surname><given-names>X</given-names></name>. <article-title>A comparison of homologous recombination rates in bacteria and archaea</article-title>. <source>The ISME Journal</source>. <year>2009</year>;<volume>3</volume>: <fpage>199</fpage>–<lpage>208</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2008.93</pub-id><?supplied-pmid 18830278?><pub-id pub-id-type="pmid">18830278</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Andersson</surname><given-names>DI</given-names></name>, <name><surname>Hughes</surname><given-names>D</given-names></name>. <article-title>Muller’s ratchet decreases fitness of a DNA-based microbe</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1996</year>;<volume>93</volume>: <fpage>906</fpage>–<lpage>907</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.93.2.906</pub-id><?supplied-pmid 8570657?><pub-id pub-id-type="pmid">8570657</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Muller</surname><given-names>HJ</given-names></name>. <article-title>The relation of recombination to mutational advance</article-title>. <source>Mutation Research/Fundamental and Molecular Mechanisms of Mutagenesis</source>. <year>1964</year>;<volume>1</volume>: <fpage>2</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0027-5107(64)90047-8</pub-id><?supplied-pmid 14195748?><pub-id pub-id-type="pmid">14195748</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>T</given-names></name>, <name><surname>Gilbert</surname><given-names>J</given-names></name>, <name><surname>Meyer</surname><given-names>F</given-names></name>. <article-title>Metagenomics—a guide from sampling to data analysis</article-title>. <source>Microb Inform Exp.</source> 2012/05/17 ed. <year>2012</year>;<volume>2</volume>: <fpage>3</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/2042-5783-2-3</pub-id>
<?supplied-pmid 22587947?><pub-id pub-id-type="pmid">22587947</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Escobar-Zepeda</surname><given-names>A</given-names></name>, <name><surname>Vera-Ponce de León</surname><given-names>A</given-names></name>, <name><surname>Sanchez-Flores</surname><given-names>A</given-names></name>. <article-title>The Road to Metagenomics: From Microbiology to DNA Sequencing Technologies and Bioinformatics.</article-title><source>Front Genet</source>. <year>2015</year>;<volume>6</volume>: <fpage>348</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fgene.2015.00348</pub-id><?supplied-pmid 26734060?><pub-id pub-id-type="pmid">26734060</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Sharpton</surname><given-names>TJ</given-names></name>. <article-title>An introduction to the analysis of shotgun metagenomic data</article-title>. <source>Frontiers in Plant Science</source>. <year>2014</year>;<volume>5</volume>: <fpage>209</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fpls.2014.00209</pub-id><?supplied-pmid 24982662?><pub-id pub-id-type="pmid">24982662</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Tataru</surname><given-names>P</given-names></name>, <name><surname>Simonsen</surname><given-names>M</given-names></name>, <name><surname>Bataillon</surname><given-names>T</given-names></name>, <name><surname>Hobolth</surname><given-names>A</given-names></name>. <article-title>Statistical Inference in the Wright–Fisher Model Using Allele Frequency Data</article-title>. <source>Syst Biol</source>. <year>2017</year>;<volume>66</volume>: <fpage>e30</fpage>–<lpage>e46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syw056</pub-id><?supplied-pmid 28173553?><pub-id pub-id-type="pmid">28173553</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>Y-X</given-names></name>, <name><surname>Li</surname><given-names>W-H</given-names></name>. <article-title>Coalescing into the 21st Century: An Overview and Prospects of Coalescent Theory</article-title>. <source>Theoretical Population Biology</source>. <year>1999</year>;<volume>56</volume>: <fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/tpbi.1999.1421</pub-id><?supplied-pmid 10438665?><pub-id pub-id-type="pmid">10438665</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>McVean</surname><given-names>G</given-names></name>, <name><surname>Awadalla</surname><given-names>P</given-names></name>, <name><surname>Fearnhead</surname><given-names>P</given-names></name>. <article-title>A Coalescent-Based Method for Detecting and Estimating Recombination From Gene Sequences</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>160</volume>: <fpage>1231</fpage>–<lpage>1241</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/160.3.1231</pub-id><?supplied-pmid 11901136?><pub-id pub-id-type="pmid">11901136</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Melendrez</surname><given-names>MC</given-names></name>, <name><surname>Becraft</surname><given-names>ED</given-names></name>, <name><surname>Wood</surname><given-names>JM</given-names></name>, <name><surname>Olsen</surname><given-names>MT</given-names></name>, <name><surname>Bryant</surname><given-names>DA</given-names></name>, <name><surname>Heidelberg</surname><given-names>JF</given-names></name>, <etal>et al</etal>. <article-title>Recombination Does Not Hinder Formation or Detection of Ecological Species of Synechococcus Inhabiting a Hot Spring Cyanobacterial Mat.</article-title><source>Frontiers in Microbiology</source>. <year>2016</year>;<fpage>6</fpage>. Available: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fmicb.2015.01540" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fmicb.2015.01540</ext-link><pub-id pub-id-type="pmid">26858695</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Fearnhead</surname><given-names>P</given-names></name>, <name><surname>Donnelly</surname><given-names>P</given-names></name>. <article-title>Estimating recombination rates from population genetic data</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>159</volume>: <fpage>1299</fpage>–<lpage>1318</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/159.3.1299</pub-id><?supplied-pmid 11729171?><pub-id pub-id-type="pmid">11729171</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Fearnhead</surname><given-names>P</given-names></name>, <name><surname>Donnelly</surname><given-names>P</given-names></name>. <article-title>Approximate likelihood methods for estimating local recombination rates</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology).</source><year>2002</year>;<volume>64</volume>: <fpage>657</fpage>–<lpage>680</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1467-9868.00355</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Stumpf</surname><given-names>MPH</given-names></name>, <name><surname>McVean</surname><given-names>GAT</given-names></name>. <article-title>Estimating recombination rates from population-genetic data</article-title>. <source>Nature Reviews Genetics</source>. <year>2003</year>;<volume>4</volume>: <fpage>959</fpage>–<lpage>968</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg1227</pub-id><?supplied-pmid 14631356?><pub-id pub-id-type="pmid">14631356</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Hudson</surname><given-names>RR</given-names></name>. <article-title>Two-Locus Sampling Distributions and Their Application</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>159</volume>: <fpage>1805</fpage>–<lpage>1817</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/159.4.1805</pub-id><?supplied-pmid 11779816?><pub-id pub-id-type="pmid">11779816</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Hermann</surname><given-names>P</given-names></name>, <name><surname>Heissl</surname><given-names>A</given-names></name>, <name><surname>Tiemann-Boege</surname><given-names>I</given-names></name>, <name><surname>Futschik</surname><given-names>A</given-names></name>. <article-title>LDJump: Estimating variable recombination rates from population genetic data</article-title>. <source>Molecular Ecology Resources</source>. <year>2019</year>;<volume>19</volume>: <fpage>623</fpage>–<lpage>638</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1755-0998.12994</pub-id><?supplied-pmid 30666785?><pub-id pub-id-type="pmid">30666785</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>. <article-title>Recombination rate estimation in the presence of hotspots</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>: <fpage>1219</fpage>–<lpage>1227</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.6386707</pub-id><?supplied-pmid 17623807?><pub-id pub-id-type="pmid">17623807</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Chan</surname><given-names>AH</given-names></name>, <name><surname>Jenkins</surname><given-names>PA</given-names></name>, <name><surname>Song</surname><given-names>YS</given-names></name>. <article-title>Genome-Wide Fine-Scale Recombination Rate Variation in Drosophila melanogaster</article-title>. <source>PLOS Genetics</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1003090</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1003090</pub-id><?supplied-pmid 23284288?><pub-id pub-id-type="pmid">23284288</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>Myers</surname><given-names>S</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>. <source>Identifying recombination hotspots using population genetic data</source>. arXiv:14034264 [q-bio]. <year>2014</year> [cited 27 Sep 2021]. Available: <ext-link xlink:href="http://arxiv.org/abs/1403.4264" ext-link-type="uri">http://arxiv.org/abs/1403.4264</ext-link></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>PL</given-names></name>, <name><surname>Slatkin</surname><given-names>M</given-names></name>. <article-title>Inference of microbial recombination rates from metagenomic data</article-title>. <source>PLoS genetics</source>. <year>2009</year>;<volume>5</volume>: <fpage>e1000674</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1000674</pub-id><?supplied-pmid 19798447?><pub-id pub-id-type="pmid">19798447</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Spence</surname><given-names>JP</given-names></name>, <name><surname>Song</surname><given-names>YS</given-names></name>. <article-title>Inference and analysis of population-specific fine-scale recombination maps across 26 diverse human populations</article-title>. <source>Science Advances</source>. <year>2019</year>;<fpage>5</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.aaw9206</pub-id><?supplied-pmid 31681842?><pub-id pub-id-type="pmid">31681842</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Arenas</surname><given-names>M</given-names></name>, <name><surname>Lopes</surname><given-names>JS</given-names></name>, <name><surname>Beaumont</surname><given-names>MA</given-names></name>, <name><surname>Posada</surname><given-names>D</given-names></name>. <article-title>CodABC: A Computational Framework to Coestimate Recombination, Substitution, and Molecular Adaptation Rates by Approximate Bayesian Computation</article-title>. <source>Mol Biol Evol</source>. <year>2015</year>;<volume>32</volume>: <fpage>1109</fpage>–<lpage>1112</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msu411</pub-id><?supplied-pmid 25577191?><pub-id pub-id-type="pmid">25577191</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Falush</surname><given-names>D</given-names></name>. <article-title>Inference of Bacterial Microevolution Using Multilocus Sequence Data</article-title>. <source>Genetics</source>. <year>2007</year>;<volume>175</volume>: <fpage>1251</fpage>–<lpage>1266</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/genetics.106.063305</pub-id><?supplied-pmid 17151252?><pub-id pub-id-type="pmid">17151252</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Wilson</surname><given-names>DJ</given-names></name>. <article-title>ClonalFrameML: Efficient Inference of Recombination in Whole Bacterial Genomes.</article-title><source>PLOS Computational Biology</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004041</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004041</pub-id><?supplied-pmid 25675341?><pub-id pub-id-type="pmid">25675341</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>M</given-names></name>, <name><surname>Kussell</surname><given-names>E</given-names></name>. <article-title>Inferring bacterial recombination rates from large-scale sequencing datasets</article-title>. <source>Nat Methods</source>. <year>2019</year>;<volume>16</volume>: <fpage>199</fpage>–<lpage>204</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-018-0293-7</pub-id><?supplied-pmid 30664775?><pub-id pub-id-type="pmid">30664775</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <year>2013</year> [cited 17 Sep 2021]. Available: <ext-link xlink:href="https://arxiv.org/abs/1303.3997v2" ext-link-type="uri">https://arxiv.org/abs/1303.3997v2</ext-link></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Garrison</surname><given-names>E</given-names></name>, <name><surname>Marth</surname><given-names>G</given-names></name>. <source>Haplotype-based variant detection from short-read sequencing</source>. arXiv:12073907 [q-bio]. <year>2012</year> [cited 8 Mar 2022]. Available: <ext-link xlink:href="http://arxiv.org/abs/1207.3907" ext-link-type="uri">http://arxiv.org/abs/1207.3907</ext-link></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Danecek</surname><given-names>P</given-names></name>, <name><surname>Bonfield</surname><given-names>JK</given-names></name>, <name><surname>Liddle</surname><given-names>J</given-names></name>, <name><surname>Marshall</surname><given-names>J</given-names></name>, <name><surname>Ohan</surname><given-names>V</given-names></name>, <name><surname>Pollard</surname><given-names>MO</given-names></name>, <etal>et al</etal>. <article-title>Twelve years of SAMtools and BCFtools</article-title>. <source>Gigascience</source>. <year>2021</year>;<volume>10</volume>: <fpage>giab008</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id><?supplied-pmid 33590861?><pub-id pub-id-type="pmid">33590861</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>G</given-names></name>, <name><surname>Opitz</surname><given-names>L</given-names></name>, <name><surname>Schlapbach</surname><given-names>R</given-names></name>, <name><surname>Rehrauer</surname><given-names>H</given-names></name>. <article-title>Long fragments achieve lower base quality in Illumina paired-end sequencing</article-title>. <source>Sci Rep</source>. <year>2019</year>;<volume>9</volume>: <fpage>2856</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-019-39076-7</pub-id><?supplied-pmid 30814542?><pub-id pub-id-type="pmid">30814542</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kamm</surname><given-names>JA</given-names></name>, <name><surname>Spence</surname><given-names>JP</given-names></name>, <name><surname>Chan</surname><given-names>J</given-names></name>, <name><surname>Song</surname><given-names>YS</given-names></name>. <article-title>Two-Locus Likelihoods Under Variable Population Size and Fine-Scale Recombination Rate Estimation</article-title>. <source>Genetics</source>. <year>2016</year>;<volume>203</volume>: <fpage>1381</fpage>–<lpage>1399</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/genetics.115.184820</pub-id><?supplied-pmid 27182948?><pub-id pub-id-type="pmid">27182948</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Di Tommaso</surname><given-names>P</given-names></name>, <name><surname>Chatzou</surname><given-names>M</given-names></name>, <name><surname>Floden</surname><given-names>EW</given-names></name>, <name><surname>Barja</surname><given-names>PP</given-names></name>, <name><surname>Palumbo</surname><given-names>E</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>: <fpage>316</fpage>–<lpage>319</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id><?supplied-pmid 28398311?><pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Kelleher</surname><given-names>J</given-names></name>, <name><surname>Etheridge</surname><given-names>AM</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>. <article-title>Efficient Coalescent Simulation and Genealogical Analysis for Large Sample Sizes.</article-title><source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>: <fpage>e1004842</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004842</pub-id><?supplied-pmid 27145223?><pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>593</fpage>–<lpage>594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id><?supplied-pmid 22199392?><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Waskom</surname><given-names>ML</given-names></name>. <article-title>seaborn: statistical data visualization</article-title>. <source>Journal of Open Source Software</source>. <year>2021</year>;<volume>6</volume>: <fpage>3021</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.21105/joss.03021</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Croucher</surname><given-names>NJ</given-names></name>, <name><surname>Harris</surname><given-names>SR</given-names></name>, <name><surname>Barquist</surname><given-names>L</given-names></name>, <name><surname>Parkhill</surname><given-names>J</given-names></name>, <name><surname>Bentley</surname><given-names>SD</given-names></name>. <article-title>A High-Resolution View of Genome-Wide Pneumococcal Transformation</article-title>. <source>PLOS Pathogens</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002745</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.ppat.1002745</pub-id><?supplied-pmid 22719250?><pub-id pub-id-type="pmid">22719250</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Rubino</surname><given-names>F</given-names></name>, <name><surname>Messer</surname><given-names>LF</given-names></name>, <name><surname>Youssef</surname><given-names>N</given-names></name>, <name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>A phylogenomic and ecological analysis of the globally abundant Marine Group II archaea (Ca. Poseidoniales ord. nov.).</article-title><source>ISME J</source>. <year>2019</year>;<volume>13</volume>: <fpage>663</fpage>–<lpage>675</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41396-018-0282-y</pub-id><?supplied-pmid 30323263?><pub-id pub-id-type="pmid">30323263</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Kolmogorov</surname><given-names>M</given-names></name>, <name><surname>Bickhart</surname><given-names>DM</given-names></name>, <name><surname>Behsaz</surname><given-names>B</given-names></name>, <name><surname>Gurevich</surname><given-names>A</given-names></name>, <name><surname>Rayko</surname><given-names>M</given-names></name>, <name><surname>Shin</surname><given-names>SB</given-names></name>, <etal>et al</etal>. <article-title>metaFlye: scalable long-read metagenome assembly using repeat graphs</article-title>. <source>Nat Methods</source>. <year>2020</year>;<volume>17</volume>: <fpage>1103</fpage>–<lpage>1110</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-020-00971-x</pub-id><?supplied-pmid 33020656?><pub-id pub-id-type="pmid">33020656</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Mirdita</surname><given-names>M</given-names></name>, <name><surname>Steinegger</surname><given-names>M</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>MMseqs2 desktop and local web server app for fast, interactive sequence searches</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>2856</fpage>–<lpage>2858</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty1057</pub-id><?supplied-pmid 30615063?><pub-id pub-id-type="pmid">30615063</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Parks</surname><given-names>DH</given-names></name>, <name><surname>Chuvochina</surname><given-names>M</given-names></name>, <name><surname>Rinke</surname><given-names>C</given-names></name>, <name><surname>Mussig</surname><given-names>AJ</given-names></name>, <name><surname>Chaumeil</surname><given-names>P-A</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>. <article-title>GTDB: an ongoing census of bacterial and archaeal diversity through a phylogenetically consistent, rank normalized and complete genome-based taxonomy</article-title>. <source>Nucleic Acids Research</source>. <year>2022</year>;<volume>50</volume>: <fpage>D785</fpage>–<lpage>D794</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab776</pub-id><?supplied-pmid 34520557?><pub-id pub-id-type="pmid">34520557</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Woodcroft</surname><given-names>BJ</given-names></name>. <article-title>CoverM</article-title>. <year>2023</year>. Available: <ext-link xlink:href="https://github.com/wwood/CoverM" ext-link-type="uri">https://github.com/wwood/CoverM</ext-link></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Levin</surname><given-names>BR</given-names></name>, <name><surname>Cornejo</surname><given-names>OE</given-names></name>. <article-title>The Population and Evolutionary Dynamics of Homologous Gene Recombination in Bacteria.</article-title><source>PLOS Genetics</source>. <year>2009</year>;<volume>5</volume>: <fpage>e1000601</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1000601</pub-id><?supplied-pmid 19680442?><pub-id pub-id-type="pmid">19680442</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Maiden</surname><given-names>MC</given-names></name>. <article-title>Impact of recombination on bacterial evolution</article-title>. <source>Trends Microbiol</source>. 2010/05/11 ed. <year>2010</year>;<volume>18</volume>: <fpage>315</fpage>–<lpage>22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tim.2010.04.002</pub-id><?supplied-pmid 20452218?><pub-id pub-id-type="pmid">20452218</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Schmutzer</surname><given-names>M</given-names></name>, <name><surname>Barraclough</surname><given-names>TG</given-names></name>. <article-title>The role of recombination, niche-specific gene pools and flexible genomes in the ecological speciation of bacteria</article-title>. <source>Ecol Evol</source>. 2019/04/30 ed. <year>2019</year>;<volume>9</volume>: <fpage>4544</fpage>–<lpage>4556</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ece3.5052</pub-id><?supplied-pmid 31031926?><pub-id pub-id-type="pmid">31031926</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Wooley</surname><given-names>JC</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>, <name><surname>Friedberg</surname><given-names>I</given-names></name>. <article-title>A primer on metagenomics.</article-title><source>PLoS Comput Biol.</source> 2010/03/03 ed. <year>2010</year>;<volume>6</volume>: <fpage>e1000667</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000667</pub-id>
<?supplied-pmid 20195499?><pub-id pub-id-type="pmid">20195499</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Singh</surname><given-names>J</given-names></name>, <name><surname>Behal</surname><given-names>A</given-names></name>, <name><surname>Singla</surname><given-names>N</given-names></name>, <name><surname>Joshi</surname><given-names>A</given-names></name>, <name><surname>Birbian</surname><given-names>N</given-names></name>, <name><surname>Singh</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Metagenomics: Concept, methodology, ecological inference and recent advances</article-title>. <source>Biotechnol J</source>. <year>2009</year>;<volume>4</volume>: <fpage>480</fpage>–<lpage>494</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/biot.200800201</pub-id><?supplied-pmid 19288513?><pub-id pub-id-type="pmid">19288513</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1010683.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>González-Torres</surname><given-names>P</given-names></name>, <name><surname>Rodríguez-Mateos</surname><given-names>F</given-names></name>, <name><surname>Antón</surname><given-names>J</given-names></name>, <name><surname>Gabaldón</surname><given-names>T</given-names></name>. <article-title>Impact of Homologous Recombination on the Evolution of Prokaryotic Core Genomes.</article-title><source>mBio</source>. <year>2019</year>;<fpage>10</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mBio.02494-18</pub-id><?supplied-pmid 30670614?><pub-id pub-id-type="pmid">30670614</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pgen.1010683.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1010683.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Didelot</surname>
          <given-names>Xavier</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Zhu, Didelot</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Zhu, Didelot</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1010683" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Oct 2022</named-content>
    </p>
    <p>Dear Dr DeMaere,</p>
    <p>Thank you very much for submitting your Methods entitled 'Rhometa: Population recombination rate estimation from metagenomic read datasets' to PLOS Genetics.</p>
    <p>The manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the current manuscript. Based on the reviews, we will not be able to accept this version of the manuscript, but we would be willing to review a much-revised version. We cannot, of course, promise publication at that time.</p>
    <p>Should you decide to revise the manuscript for further consideration here, your revisions should address the specific points made by each reviewer. We will also require a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>If you decide to revise the manuscript for further consideration at PLOS Genetics, please aim to resubmit within the next 60 days, unless it will take extra time to address the concerns of the reviewers, in which case we would appreciate an expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments are included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist" ext-link-type="uri">Submission Checklist</ext-link>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>Please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link xlink:href="http://pace.apexcovantage.com/" ext-link-type="uri">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool.  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>PLOS has incorporated <ext-link xlink:href="http://www.crossref.org/crosscheck.html" ext-link-type="uri">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, use the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage. Please do not hesitate to contact us if you have any concerns or questions.</p>
    <p>Yours sincerely,</p>
    <p>Xavier Didelot</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: In this article, the authors have introduced a method to infer the population recombination rate in prokaryotic populations, which is novel and can be very useful in a bunch of analysis. The authors built up a pipeline of going from metagenomic data of reads to vcf files to plug into the framework of LDpop, with a gene-conversion based recombination model. In brief, I think the method and analysis in this article is really solid and the software can be really promising in a lot of studies. Here are some of my minor comments to this manuscript:</p>
    <p>1. In line 123 you said that Pyrho is a method supporting read-based data but is only workable for diploid genomes. However, as far as I understand, the basic methodology of Pyrho is not that different from LDhat or LDpop except that Pyrho can handle a population size history and I believe the input format needs to be a vcf file instead of reads data directly. I recommend correcting the mention of Pyrho here (if what I recall is correct), and really mention the contribution of your work on handling the bioinformatics of read data and the modules in the pipeline.</p>
    <p>2. I might have missed this but you mentioned using the approx option while generating the lookup table from LDpop, did you benchmark the performance of inference when generating the table using approx, especially for larger sample size? It would be nice to see some simulation-based benchmarking results while having a large sample size and using approx option to give people a sense of how much accuracy is lost by doing this.</p>
    <p>3. Did you investigate sequencing errors while simulating reads? Sequencing errors can give false signals to recombinations and thus confound the analysis. I would suggest investigating the robustness of the method under different error rates (close to real world sequencing technology parameters).</p>
    <p>Overall I think this work is really solid and the authors have made good points in the use of the method. I hope this could contribute to the field and facilitate a lot of studies!</p>
    <p>Reviewer #2: Review of "Rhometa: Population recombination rate estimation from metagenomic read datasets"</p>
    <p>This paper introduces a new computational pipeline for estimating recombination rates in metagenomic datasets. The overall goal is very important - as the authors emphasise, the majority of microorganisms cannot be cultured and hence we only observe them in in their natural, complex, environments via metagenomics. The software pipeline has been well explained and care has been taken to ensure that it is appropriate and can run at scale.</p>
    <p>Unfortunately I have concerns with the paper as it stands:</p>
    <p>Firstly, the writing is far from the expected standards. I've described many specifics below but overall it needs a complete and thorough overhaul from an experienced scientific writer. In places this gets in the way of review as I could not quite follow the details. Except in the limitations section (which seemed strong), there was little in the way of reflection or consideration about the details, and the text needs to provide more insight and less technical repetition.</p>
    <p>To give an example from the abstract: "the deviation from the expected value decreased as the number of genomes increased" is about all that is claimed, but this is just one minor pre-requisite for all publishable methods... What can we say that is meaningful about its performance? How does it compare to the state of the art? Does it do something that is currently impossible otherwise? The same writing problem exists throughout.</p>
    <p>On Line 621 it is explained that the essence of this paper is that "for aligned read based datasets the main complication is that the depth can vary greatly from site to site." This is conceptually very straight forward, and just requires (a lot of!) careful technical work to implement (for great value, I agree). That intuition should come through more cleanly thoughout (starting in the abstract).</p>
    <p>Secondly, I did not find the analysis of the data to be completely compelling. Results are only given for "rho", the population recombination rate, in one simulation scenario (varying true rho and data quantity). I would have expected some sensitivity analysis around critical parameters - the average tract length, but also population demography, variation of rho along the genome, presence of related strains, etc.</p>
    <p>I'd like head to head comparisons where this is possible. However, since this is arguably the first method to do what it does, it doesn't matter if some of the experiments fail - but this information is critical to users for interpretation. (the slight bias in the inference for high rho is a case in point.)</p>
    <p>I did not find the real data analysis convincing to the central claim that the method was better than its rivals, but that may be because I could not follow the exposition around it. Details are below.</p>
    <p>This is not a criticism, but I am unsure what to say about the novelty of this work. What novelty there is here is in putting together work into a well functioning pipeline to solve a particular scientific need. I would like to support the paper against such a criticism because I do think there is huge value in making these tools well from a software engineering perspective, and having venues for them to be published.</p>
    <p>Finally I'd like to see something about computational requirements, for users to get a scale for when this is practical.</p>
    <p>Details and minor points:</p>
    <p>Abstract "In simulated datasets, the deviation from the expected value decreased</p>
    <p>as the number of genomes increased " is hardly a headline result. I suggest replacing with something more specific.</p>
    <p>Summary /Abstract: say something about the scale of data your method is suitable for.</p>
    <p>Line 87,89: I found the final units unclear “rate of initiation of gene conversion” and “mutation rate”. Indeed the line below confuses the matter as we then divide by the mutation rate.</p>
    <p>I did not find the separation of the Mcorr method convincing. The description is confuised and doesn't make it clear exactly what Mcorr is estimating and why we would prefer what Rhometa does.</p>
    <p>Line 153: "We have carefully adapted the program to work with modern read based metagenomic datasets." Elsewhere it is implied that this is new software, and I think it probably is? Be very clear about where the code is coming from. (It is natural that the ideas behind LDhat would be incorporated, and this is and should be acknowledged.)</p>
    <p>Wattersons Theta estimate will be biased after accounting for alignment and recombination, compared to the estimate of theta that would be obtained by a likelihood-based approach (which could be the "true parameter value" from some model). Typically this would be handled by an iterative algorithm and usually does not take many iterations? At least the bias needs discussing.</p>
    <p>The section "Lookup table and depth" is very fuzzy. What specifically do you do? It sounds like there is a threshold (minimum depth?) to which you subsample down to? Or is this entirely optional?</p>
    <p>Equation 1 is unclear. I think your \\underline{t} notation is misleading? (Its described as a mean distance so I think so?) Underline would normally indicate a vector, overline for mean but since it is a parameter I don't think that is appropriate either.</p>
    <p>Line 261 "we use the matched likelihood values for recombination rates" what does this specifically mean? Generally this paragraph is hard to parse.</p>
    <p>Line 269 "we introduce a novel weighting algorithm" you haven't motivated this specific form for the weighting. Does it approximate some sensible procedure, like a likelihood interpretation, or the standard deviation of the estimate for the corresponding normal normal distribution approximation? Does it appear elsewhere? Why this form?</p>
    <p>"maximum log likelihood value (closest to 0) corresponds to the most likely final estimated population recombination rate" Firstly, can we get it clear whether this is a likelihood or not (perhaps a negative log-likelihood?) Secondly, "most likely final estimated" is very unclear.</p>
    <p>(Line 278 what happened to line numbers here? )</p>
    <p>Minor typography note: Throughout we've labelled "Equation X" but referred to them in text as "equation"</p>
    <p>Figure 1: I'm not quite sure how to map the content to the text. For example, "Estimate theta (Python)" does not tell me whether this is the Wattersons Theta estimate. I think it is the (new?) Python components that need clarification, but you might introduce labels for all components. (I found that in the description L309, but the criticism still stands in trms of clarity.)</p>
    <p>Line 362: "population_size was 1" what scaling is this? Does it mean something?</p>
    <p>Line 366: "The recombination events were simulated first then mutation events were simulated on top" - I assume this is referring to the method that msprime uses for neutral mutations. Either explain properly, or omit as it is standard.</p>
    <p>Line 367 Notation: "calculated as such"</p>
    <p>Line 373 very verbose and not particularly clear or precise.</p>
    <p>Line 384: Can we have a simple version here, and relegate the details to the methods?</p>
    <p>Para at Line 364: Typeset the equations.</p>
    <p>The text contains the text "rho" and "theta" instead of the symbols throughout.</p>
    <p>L437 "385 is the number that is thought to be false positives" how was this determined? If this number comes from elsewhere, just give the equation as Expected true variants/Total genome length.</p>
    <p>Another way of putting the simulated Rhometa results is that reegardless of the number of genomes, \\rho is biased. This can be ok, but be up front with it.</p>
    <p>Line 506-514 Don't just tell us the numbers in the table. Either leave them in the table, or interpret them.</p>
    <p>Line 518-525: Do you really mean that your estimate differs from mcorr by a factor of 2000? Or is there some scaling going on? I don't understand wher the r/m=380 estimate in the next paragraph comes from, is this not their estimate?</p>
    <p>Line 527 You've given a very long paragraph containing many estimates and I don't understand the sources of the data for any of them properly.</p>
    <p>Line 606(and much of this paragraph) is far too technical for a discussion. The purpose of this paragraph does not come through; its just more results without context.</p>
    <p>Reviewer #3: The paper is very well written and contains some interesting ideas for estimating recombination rates in microbial populations, however, I have a few concerns regardging the approach and validation.</p>
    <p>1. The authors have claimed that: "The best way to study recombination in a microbial population is via metagenomics, which allows us to study microbes in their natural environment via direct sequencing and analysis of environmental DNA [7,8]"</p>
    <p>The phrasing of this sentence is misleading to a reader because both [7,8] do not discuss microbial recombination. This also leads me to question the general claim: 'microbial recombination is best studied using metagenomics'; is it (currently) well supported by the literature?</p>
    <p>Additionally, I am (personally) a bit skeptical about this idea in general. Apart from the obvious complexities associated with shotgun metagenomic data such as the mixing of data from multiple sources, based on the literature, metagenome assembled genomes (MAGs) and metagenomic data in general can also suffer from serious data quality issues (for example, see <ext-link xlink:href="https://doi.org/10.1093/bib/bbac413" ext-link-type="uri">https://doi.org/10.1093/bib/bbac413</ext-link> and <ext-link xlink:href="https://doi.org/10.1093/gbe/evaa238" ext-link-type="uri">https://doi.org/10.1093/gbe/evaa238</ext-link>). While overcoming such data quality issues is not the scope of this paper, how would rhometa behave in the face of these concerns? How reliable will the recombination estimates be? In particular, given the fact that a metagenomic dataset will most likely contain a mixture of data from sources undergoing different evolutionary processes governing recombination, what exactly would a point estimate for recombination represent? Wouldn't a method that uses processed, carefully curated and filtered data be better suited for estimating microbial recombination?</p>
    <p>The authors should clearly address this point.</p>
    <p>2. Although rhometa is designed to be used with metagenomic data, the S. pneumo dataset used for its validation is not a metagenomic dataset and the reference ATCC700669 (NC_011900.1) is not a MAG. The authors must have used this dataset for direct comparison with mcorr. However, I feel that rhometa should be validated using real metagenomic data. I will be very interested to see how rhometa behaves when faced with real-world complexities and potential data quality issues that I mentioned in my previous comment.</p>
    <p>Since there is limited availability of such experimentally estimated recombination rates for published metagenomic datasets, I think the authors can instead follow a cross-validation process to benchmark rhometa. Although we will have no means to judge the prediction accuracy, assuming rhometa works well in the presence of aforementioned challenges, the repeated estimates should have high precision.</p>
    <p>3. Additionally, the simulated data used to validate RhoMeta are also completely 'noise-free' and not technically 'metagenomic'. In fact, the entire simulated data validation pipeline seems far too simplistic for a tool designed for metagenomic data. Additionally, I am not sure if msprime is the best tool to simulate data for this purpose at all, for example, see section 2.2. of <ext-link xlink:href="https://doi.org/10.1093/bioinformatics/bty630" ext-link-type="uri">https://doi.org/10.1093/bioinformatics/bty630</ext-link> for a list of tools that might be better suited for this purpose. In addition, the authors should also properly benchmark and report performance metrics (CPU, RAM requirements, etc.), including its limitations in terms of maximum genome size, maximum number of sequences, etc. (as applicable).</p>
    <p>4. Finally, the inability to infer the recombination tract length could be a potentially major pitfall. Firstly, the recombination estimate seems to depend on this value, and secondly, since rhometa is intended to be used with metagenomic data, a potential user will find it nearly impossible to rely on the previous literature to find a 'guess' for this parameter. Therefore, the authors should clearly outline a process to estimate or guess this value.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Genetics</italic>
<ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Yun Deng</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pgen.1010683.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1010683.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1010683" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">19 Feb 2023</named-content>
    </p>
    <supplementary-material id="pgen.1010683.s012" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Reviewer Feedback Response .pdf</named-content></p>
      </caption>
      <media xlink:href="pgen.1010683.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pgen.1010683.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1010683.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Didelot</surname>
          <given-names>Xavier</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Zhu, Didelot</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Zhu, Didelot</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1010683" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">27 Feb 2023</named-content>
    </p>
    <p>Dear Dr DeMaere,</p>
    <p>We are pleased to inform you that your manuscript entitled "Rhometa: Population recombination rate estimation from metagenomic read datasets" has been editorially accepted for publication in PLOS Genetics. Congratulations!</p>
    <p>Before your submission can be formally accepted and sent to production you will need to complete our formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Please note: the accept date on your published article will reflect the date of this provisional acceptance, but your manuscript will not be scheduled for publication until the required changes have been made.</p>
    <p>Once your paper is formally accepted, an uncorrected proof of your manuscript will be published online ahead of the final version, unless you’ve already opted out via the online submission form. If, for any reason, you do not want an earlier version of your manuscript published online or are unsure if you have already indicated as such, please let the journal staff know immediately at <email>plosgenetics@plos.org</email>.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pgenetics/" ext-link-type="uri">https://www.editorialmanager.com/pgenetics/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process. Note that PLOS requires an ORCID iD for all corresponding authors. Therefore, please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to ‘Update my Information’ (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field.  This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p>
    <p>If you have a press-related query, or would like to know about making your underlying data available (as you will be aware, this is required for publication), please see the end of this email. If your institution or institutions have a press office, please notify them about your upcoming article at this point, to enable them to help maximise its impact. Inform journal staff as soon as possible if you are preparing a press release for your article and need a publication date.</p>
    <p>Thank you again for supporting open-access publishing; we are looking forward to publishing your work in PLOS Genetics!</p>
    <p>Yours sincerely,</p>
    <p>Xavier Didelot</p>
    <p>Academic Editor</p>
    <p>PLOS Genetics</p>
    <p>Xiaofeng Zhu</p>
    <p>Section Editor</p>
    <p>PLOS Genetics</p>
    <p>
      <ext-link xlink:href="http://www.plosgenetics.org" ext-link-type="uri">www.plosgenetics.org</ext-link>
    </p>
    <p>Twitter: @PLOSGenetics</p>
    <p>----------------------------------------------------</p>
    <p>Comments from the reviewers (if applicable):</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Data Deposition</bold>
    </p>
    <p>If you have submitted a Research Article or Front Matter that has associated data that are not suitable for deposition in a subject-specific public repository (such as GenBank or ArrayExpress), one way to make that data available is to deposit it in the <ext-link xlink:href="http://www.datadryad.org/" ext-link-type="uri">Dryad Digital Repository</ext-link>. As you may recall, we ask all authors to agree to make data available; this is one way to achieve that. A full list of recommended repositories can be found on our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability#loc-recommended-repositories" ext-link-type="uri">website</ext-link>.</p>
    <p>The following link will take you to the Dryad record for your article, so you won't have to re‐enter its bibliographic information, and can upload your files directly: </p>
    <p>
      <ext-link xlink:href="http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-22-00986R1" ext-link-type="uri">http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-22-00986R1</ext-link>
    </p>
    <p>More information about depositing data in Dryad is available at <ext-link xlink:href="http://www.datadryad.org/depositing" ext-link-type="uri">http://www.datadryad.org/depositing</ext-link>. If you experience any difficulties in submitting your data, please contact <email>help@datadryad.org</email> for support.</p>
    <p>Additionally, please be aware that our <ext-link xlink:href="http://journals.plos.org/plosgenetics/s/data-availability" ext-link-type="uri">data availability policy</ext-link> requires that all numerical data underlying display items are included with the submission, and you will need to provide this before we can formally accept your manuscript, if not already present.</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Press Queries</bold>
    </p>
    <p>If you or your institution will be preparing press materials for this manuscript, or if you need to know your paper's publication date for media purposes, please inform the journal staff as soon as possible so that your submission can be scheduled accordingly. Your manuscript will remain under a strict press embargo until the publication date and time. This means an early version of your manuscript will not be published ahead of your final version. PLOS Genetics may also choose to issue a press release for your article. If there's anything the journal should know or you'd like more information, please get in touch via <email>plosgenetics@plos.org</email>.</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pgen.1010683.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1010683.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Didelot</surname>
          <given-names>Xavier</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Zhu, Didelot</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Zhu, Didelot</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pgen.1010683" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Mar 2023</named-content>
    </p>
    <p>PGENETICS-D-22-00986R1 </p>
    <p>Rhometa: Population recombination rate estimation from metagenomic read datasets </p>
    <p>Dear Dr DeMaere, </p>
    <p>We are pleased to inform you that your manuscript entitled "Rhometa: Population recombination rate estimation from metagenomic read datasets" has been formally accepted for publication in PLOS Genetics! Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out or your manuscript is a front-matter piece, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Genetics and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Genetics</p>
    <p>On behalf of:</p>
    <p>The PLOS Genetics Team</p>
    <p>Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom</p>
    <p><email>plosgenetics@plos.org</email> | +44 (0) 1223-442823</p>
    <p><ext-link xlink:href="http://plosgenetics.org" ext-link-type="uri">plosgenetics.org</ext-link> | Twitter: @PLOSGenetics</p>
  </body>
</sub-article>
