<?properties open_access?>
<?subarticle report18253?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5200948</article-id>
    <article-id pub-id-type="pmid">28105305</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.8900.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
        </subj-group>
        <subj-group>
          <subject>Protein Chemistry &amp; Proteomics</subject>
        </subj-group>
        <subj-group>
          <subject>Theory &amp; Simulation</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DRIMSeq: a Dirichlet-multinomial framework for multivariate count outcomes in genomics</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; referees: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nowicka</surname>
          <given-names>Malgorzata</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Mark D.</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label>Institute for Molecular Life Sciences, University of Zurich, Zurich, 8057, Switzerland</aff>
      <aff id="a2"><label>2</label>SIB Swiss Institute of Bioinformatics, University of Zurich, Zurich, 8057, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:mark.robinson@imls.uzh.ch">mark.robinson@imls.uzh.ch</email>
      </corresp>
      <fn fn-type="con">
        <p>MN drafted the manuscript, designed the analyses, analyzed the data and implemented the
<italic>DRIMSeq</italic> R package. MDR drafted the manuscript and designed the overall study. All authors read and approved the final manuscript and have agreed to the content.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>1356</elocation-id>
    <history>
      <date date-type="accepted">
        <day>1</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2016 Nowicka M and Robinson MD</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-5-11139.pdf"/>
    <abstract>
      <p>There are many instances in genomics data analyses where measurements are made on a multivariate response. For example, alternative splicing can lead to multiple expressed isoforms from the same primary transcript. There are situations where differences (e.g. between normal and disease state) in the relative ratio of expressed isoforms may have significant phenotypic consequences or lead to prognostic capabilities. Similarly, knowledge of single nucleotide polymorphisms (SNPs) that affect splicing, so-called splicing quantitative trait loci (sQTL) will help to characterize the effects of genetic variation on gene expression. RNA sequencing (RNA-seq) has provided an attractive toolbox to carefully unravel alternative splicing outcomes and recently, fast and accurate methods for transcript quantification have become available. We propose a statistical framework based on the Dirichlet-multinomial distribution that can discover changes in isoform usage between conditions and SNPs that affect relative expression of transcripts using these quantifications. The Dirichlet-multinomial model naturally accounts for the differential gene expression without losing information about overall gene abundance and by joint modeling of isoform expression, it has the capability to account for their correlated nature. The main challenge in this approach is to get robust estimates of model parameters with limited numbers of replicates. We approach this by sharing information and show that our method improves on existing approaches in terms of standard statistical performance metrics. The framework is applicable to other multivariate scenarios, such as Poly-A-seq or where beta-binomial models have been applied (e.g., differential DNA methylation). Our method is available as a Bioconductor R package called DRIMSeq.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>DRIMSeq</kwd>
      <kwd>genomics</kwd>
      <kwd>single nucleotide polymorphism</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>splicing</kwd>
      <kwd>statistical framework</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Swiss National Science Foundation</funding-source>
        <award-id>143883</award-id>
      </award-group>
      <funding-statement>MN acknowledges the funding from a Swiss Institute of Bioinformatics (SIB) Fellowship. MDR would like to acknowledge funding from an Swiss National Science Foundation (SNSF) Project Grant (143883).</funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>In version 2 of the manuscript, we have reworded sections in the Introduction to clarify the scope of existing methods, with respect to the term 'differential splicing'. We have added additional analyses for differential splicing analyses, to better understand how the null P-value distributions compare across different simulation scenarios and dispersion estimators. For the detected tuQTLs, we added an analysis with respect to enrichment of splicing-related features.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>With the development of digital high-throughput sequencing technologies, the analysis of count data in genomics has become an important theme motivating the investigation of new, more powerful and robust approaches that handle complex overdispersion patterns while accommodating the typical small numbers of experimental units.</p>
    <p>The basic distribution for modeling univariate count responses is the Poisson distribution, which also approximates the binomial distribution. One important limitation of the Poisson distribution is that the mean is equal to the variance, which is not sufficient for modeling, for example, gene expression from RNA sequencing (RNA-seq) data where the variance is higher than the mean due to technical sources and biological variability
<sup><xref rid="ref-1" ref-type="bibr">1</xref>–
<xref rid="ref-5" ref-type="bibr">5</xref></sup>. A natural extension of the Poisson distribution that accounts for overdispersion is the negative-binomial distribution, which has been extensively studied in the small-sample situation and has become an essential tool in genomics applications
<sup><xref rid="ref-1" ref-type="bibr">1</xref>–
<xref rid="ref-3" ref-type="bibr">3</xref></sup>.</p>
    <p>Analogously, the fundamental distribution for modeling multivariate count data is the multinomial distribution, which models proportions across multiple features. To account for overdispersion, the multinomial can be extended to the Dirichlet-multinomial (DM) distribution
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>. Because of its flexibility, the DM distribution has found applications in forensic genetics
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>, microbiome data analysis
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup>, the analysis of single-cell data
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup> and for identifying nucleosome positions
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>. Another extension of the multinomial is the Dirichlet negative multinomial distribution
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>, which allows modeling of correlated count data and was applied in the analysis of clinical trial recruitment
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>. Notably, the beta-binomial distribution, such as those used in differential methylation from bisulphite sequencing data
<sup><xref rid="ref-13" ref-type="bibr">13</xref>–
<xref rid="ref-15" ref-type="bibr">15</xref></sup>, represent a special case of the DM.</p>
    <p>Genes may express diverse transcript isoforms (mRNA variants) as a consequence of alternative splicing or due to the differences in transcription start sites and polyadenylation sites
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>. Hence, gene expression can be viewed as a multivariate expression of transcripts or exons and such a representation allows the study of not only the overall gene expression, but also the expressed variant composition. Differences in the relative expression of isoforms can have significant phenotypic consequences and aberrations are associated with disease
<sup><xref rid="ref-17" ref-type="bibr">17</xref>,
<xref rid="ref-18" ref-type="bibr">18</xref></sup>. Thus, biologists are interested in using RNA-seq data to discover differences in transcript usage between conditions or to study the specific molecular mechanisms that mediate these changes, for example, alternative splice site usage. In general terms, we collect all these together under the term “differential splicing” (DS)
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>.</p>
    <p>Alternative splicing is a process regulated by complex protein-RNA interactions that can be altered by genetic variation. Knowledge of single nucleotide polymorphisms (SNPs) that affect splicing, known as splicing quantitative trait loci (sQTL), can help to characterize this layer of regulation.</p>
    <p>In this article, we propose the DM distribution to model relative usage of isoforms. The DM model treats transcript expression as a multivariate response and allows for flexible small-sample estimation of overdispersion. We address the challenge of obtaining robust estimates of the model parameters, especially dispersion, when only a small number of replicates is available by applying an empirical Bayes approach to share information, similar to those proven successful in negative-binomial frameworks
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-20" ref-type="bibr">20</xref></sup>. In particular, weighted likelihood is used to moderate the gene-wise dispersion toward a common or trended value.</p>
    <p>The Dirichlet-multinomial framework, implemented as a
<italic>Bioconductor</italic> R package called
<italic>DRIMSeq</italic>, is applicable to both differential transcript usage (DTU) analysis between conditions and transcript usage quantitative trait loci (tuQTL) analysis. It has been evaluated and compared to the current best methods in extensive simulations and in real RNA-seq data analysis using transcript and exon counts, highlighting that
<italic>DRIMSeq</italic> performs best with transcript counts. Furthermore, the framework can be applied to other types of emerging multivariate genomic data, such as PolyA-seq where the collection of polyadenylated sites for a given gene are measured
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup> and to settings where the beta-binomial is already applied (e.g., differential methylation, allele-specific differential gene expression).</p>
  </sec>
  <sec>
    <title>Approaches to DS and sQTL analyses</title>
    <p>RNA-seq has provided an attractive toolbox to unravel alternative splicing outcomes. There are various methods designed explicitly to detect DS based on samples from different experimental conditions
<sup><xref rid="ref-19" ref-type="bibr">19</xref>,
<xref rid="ref-22" ref-type="bibr">22</xref>,
<xref rid="ref-23" ref-type="bibr">23</xref></sup>. Independently, a set of methods was developed for detecting genetic variation associated with changes in splicing (sQTLs). While sQTL detection represents a different application, it is essentially DS between groups defined by genotypes. In the following overview, we do not distinguish between applications but rather between the general concepts used to detect differences in splicing.</p>
    <p>DS can be studied in three main ways: as differential transcript usage (DTU) or, in a more local context, as differential exon or exon junction usage (DEU) or as specific splicing events (e.g., exon skipping), and all have their advantages and disadvantages. A survey of the main methods can be found in
<xref ref-type="other" rid="SM1">Table S1</xref> (
<xref ref-type="other" rid="SM1">Supplementary File</xref>). From the quantification perspective, exon-level abundance estimation is straightforward since it is based on counting read-region overlaps (e.g.,
<italic>featureCounts</italic>
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>). Exons from different isoforms may have different boundaries, thus the authors of
<italic>DEXSeq</italic>
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup> quantify with
<italic>HTSeq</italic>
<sup><xref rid="ref-26" ref-type="bibr">26</xref></sup> non-overlapping windows defined by projecting all exons to the linear genome. However, this strategy does not utilize the full information from junction reads. Such reads are counted multiple times (in all exons that they overlap with), artificially increasing the total number of counts per gene and ignoring that junction reads support the isoforms that explicitly contain the combinations of exons spanned by these reads. This issue is captured in
<italic>Altrans</italic>
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>, which quantifies exon-links (exon junctions) or in
<italic>MISO</italic>
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup>,
<italic>rMATS</italic>
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>,
<italic>SUPPA</italic>
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup> and
<italic>SGSeq</italic>
<sup><xref rid="ref-31" ref-type="bibr">31</xref></sup>, all of which calculate splicing event inclusion levels expressed as percentage spliced in (PSI). Such events capture not only cassette exons but also alternative 3’ and 5’ splice sites, mutually exclusive exons or intron retention.
<italic>GLiMMPS</italic>
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup> and Jia
<italic>et al.</italic>
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>, with quantification from
<italic>PennSeq</italic>
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>, use event inclusion levels for detecting SNPs that are associated with differential splicing. However, there are (hypothetical) instances where changes in splicing pattern may not be captured by exon-level quantifications (Figure 1A in the paper by Monlog
<italic>et al.</italic>
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup>). Furthermore, detection of more complex transcript variations remains a challenge for exon junction or PSI methods (see Figure S5 in the paper by Ongen
<italic>et al.</italic>
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>). Soneson
<italic>et al.</italic>
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup> considered counting which accommodates various types of local splicing events, such as exon paths traced out by paired reads, junction counts or events that correspond to combinations of isoforms; in general, the default exon-based counting resulted in strongest performance for DS gene detection.</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="float">
      <label>Figure 1. </label>
      <caption>
        <title>Results of two-group (3 versus 3 samples) DS analyses on data simulated from the DM null model.</title>
        <p>In the first scenario, all genes have the same (common) dispersion, and in the second one, each gene has a different (genewise) dispersion. All genes have expression equal to 1000 and 3 or 10 features with the same proportions estimated from
<italic>kallisto</italic> counts from Kim
<italic>et al</italic>. data set. For each of the scenarios, common, genewise, with and without moderation to common dispersion is estimated with maximum likelihood using the
<italic>dirmult</italic> R package, the raw profile likelihood and the Cox-Reid APL.
<bold>A</bold>: Absolute error of concentration γ
<sub>+</sub> estimates.
<bold>B</bold>: False positive (FP) rate for the p-value threshold of 0.05 of the null two-group comparisons based on the likelihood ratio statistics. Dashed line indicates the 0.05 level.
<bold>C</bold>: Median raw error of γ
<sub>+</sub> estimates.
<bold>D</bold>: Distributions of p-values of the null two-group comparisons based on the likelihood ratio statistics. Additionally, results when true concentration estimates are used are indicated with the gray color.</p>
      </caption>
      <graphic xlink:href="f1000research-5-11139-g0000"/>
    </fig>
    <p>The above methods allow for detection of differential usage of local splicing features, which can serve as an indicator of differential transcript usage but often without knowing specifically which isoforms are differentially regulated. This can be a disadvantage in cases where knowing the isoform ratio changes is important, since isoforms are the ultimate determinants of proteins. Moreover, exons are not independent transcriptional units but building blocks of transcripts. Thus, the main alternative is to make a calculation of DS using isoform-level quantitations. A vast number of methods is available for gene isoform quantification, such as
<italic>MISO</italic>
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup>,
<italic>BitSeq</italic>
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup>,
<italic>casper</italic>
<sup><xref rid="ref-37" ref-type="bibr">37</xref></sup>,
<italic>Cufflinks</italic>
<sup><xref rid="ref-38" ref-type="bibr">38</xref></sup>,
<italic>RSEM</italic>
<sup><xref rid="ref-39" ref-type="bibr">39</xref></sup>,
<italic>FlipFlop</italic>
<sup><xref rid="ref-40" ref-type="bibr">40</xref></sup> and more recent, extremely fast pseudoalignment-based methods, such as
<italic>Sailfish</italic>
<sup><xref rid="ref-41" ref-type="bibr">41</xref></sup>,
<italic>kallisto</italic>
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup> and
<italic>Salmon</italic>
<sup><xref rid="ref-43" ref-type="bibr">43</xref></sup>. Additionally,
<italic>Cufflinks</italic>,
<italic>casper</italic> and
<italic>FlipFlop</italic> allow for
<italic>de novo</italic> transcriptome assembly. Recently, performance of various methods was extensively studied
<sup><xref rid="ref-44" ref-type="bibr">44</xref>,
<xref rid="ref-45" ref-type="bibr">45</xref></sup>, including a webtool
<sup><xref rid="ref-44" ref-type="bibr">45</xref></sup> to allow further comparisons. Regardless of this progress, it remains a complex undertaking to quantify isoform expression from short cDNA fragments since there is a high degree of overlap between transcripts in complex genes; this is a limitation of the technology, not the algorithms. In the case of incomplete transcript annotation, local approaches may be more robust and can detect differential changes due to transcripts that are not in the catalog
<sup><xref rid="ref-23" ref-type="bibr">23</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref></sup>. Nevertheless, DS at the resolution of isoforms is the ultimate goal within the
<italic>DRIMSeq</italic> framework, and with the emergence of longer reads (fragments), transcript quantifications will become more accurate and methods for multivariate transcript abundances will be needed.</p>
    <p>Whether the differential analysis is done at the transcript or local level, modeling and testing independently each transcript
<sup><xref rid="ref-46" ref-type="bibr">46</xref>,
<xref rid="ref-47" ref-type="bibr">47</xref></sup> or exon ratio
<sup><xref rid="ref-48" ref-type="bibr">48</xref></sup> ignores the correlated structure of these quantities (e.g., proportions must sum to 1). Similarly, separate modeling and testing of exon junctions (
<italic>Altrans</italic>
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>) or splicing events (
<italic>rMATS</italic>
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>,
<italic>GLiMMPS</italic>
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup>, Jia
<italic>et al.</italic>
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>, Montgomery
<italic>et al.</italic>
<sup><xref rid="ref-49" ref-type="bibr">49</xref></sup>) of a gene leads to non-independent statistical tests, although the full effect of this on calibration (e.g., controlling the rate of false discoveries) is not known. Nevertheless, with the larger number of tests, the multiple testing correction becomes more extreme. In sQTL analyses, this burden is even larger since there are many SNPs tested for each gene. There, the issue of multiple comparisons is usually accounted for by applying a permutation scheme in combination with the false discovery rate (FDR) estimation
<sup><xref rid="ref-27" ref-type="bibr">27</xref>,
<xref rid="ref-32" ref-type="bibr">32</xref>,
<xref rid="ref-35" ref-type="bibr">35</xref>,
<xref rid="ref-46" ref-type="bibr">46</xref>,
<xref rid="ref-48" ref-type="bibr">48</xref>–
<xref rid="ref-50" ref-type="bibr">50</xref></sup>.</p>
    <p><italic>DEXSeq</italic> and
<italic>voom-diffSplice</italic>
<sup><xref rid="ref-4" ref-type="bibr">4</xref>,
<xref rid="ref-5" ref-type="bibr">5</xref></sup> undertake another approach, where the modeling is done per gene.
<italic>DEXSeq</italic> fits a generalized linear model (GLM), assuming that (exonic) read counts follow the negative-binomial distribution. A bin is deemed differentially used when its corresponding group-bin interaction is significantly different. The exact details of
<italic>voom-diffSplice</italic> are not published. Nevertheless, exons are again treated as independent in the gene-level model.</p>
    <p>In contrast,
<italic>MISO</italic>
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup>,
<italic>Cuffdiff</italic>
<sup><xref rid="ref-38" ref-type="bibr">38</xref>,
<xref rid="ref-51" ref-type="bibr">51</xref></sup> and
<italic>sQTLseekeR</italic>
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup> model alternative splicing as a multivariate response.
<italic>MISO</italic> is designed for DS analyses only between two samples and does not handle replicates. Variability among replicates is captured within
<italic>Cuffdiff</italic> via the Jensen-Shannon divergence metric on probability distributions of isoform proportions as a measure of changes in isoform relative abundances between samples.
<italic>sQTLseekeR</italic> tests for the association between genotype and transcript composition, using an approach similar to a multivariate analysis of variance (MANOVA) without assuming any probabilistic distribution and Hellinger distance as a dissimilarity measure between transcript ratios. Very recently,
<italic>LeafCutter</italic>
<sup><xref rid="ref-52" ref-type="bibr">52</xref></sup> gives intron usage quantifications that can be used for both DS analyses (also using the DM model) and sQTL analyses via a correlation-based approach with
<italic>FastQTL</italic>
<sup><xref rid="ref-50" ref-type="bibr">50</xref></sup>.</p>
    <p><italic>sQTLseekeR</italic>,
<italic>Altrans</italic>,
<italic>LeafCutter</italic> and other earlier methods for the sQTL analysis
<sup><xref rid="ref-35" ref-type="bibr">35</xref>,
<xref rid="ref-46" ref-type="bibr">46</xref>–
<xref rid="ref-48" ref-type="bibr">48</xref></sup> employ feature ratios to account for the overall gene expression. A potential drawback of this approach is that feature ratios do not take into account whether they are based on high or low expression, while the latter have more uncertainty in them.
<italic>DRIMSeq</italic> naturally builds this in
<italic>via</italic> the multinomial model.</p>
  </sec>
  <sec>
    <title>Dirichlet-multinomial model for relative transcript usage</title>
    <p>In the application of the DM model to DS, we refer to
<italic>features</italic> of a gene. These features can be transcripts, exons, exonic bins or other multivariate measurable units, which for DS, contain information about isoform usage and can be quantified with (estimated) counts.</p>
    <p>Assume that a gene has
<italic>q</italic> features with relative expression defined by a vector of proportions
<bold><italic>π</italic></bold> = (
<italic>π</italic>
<sub>1</sub>,…,
<italic>π
<sub>q</sub></italic>), and the feature counts
<bold><italic>Y</italic></bold> = (
<italic>Y</italic>
<sub>1</sub>, …,
<italic>Y
<sub>q</sub></italic>) are random variables. Let
<bold><italic>y</italic></bold> = (
<italic>y</italic>
<sub>1</sub>, …,
<italic>y
<sub>q</sub></italic>) be the observed counts and
<mml:math id="math1"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math> Here,
<italic>m</italic> is treated as an ancillary statistic since it depends on the sequencing depth and gene expression, but not on the model parameters. The simplest way to model feature counts is with the multinomial distribution with probability function defined as:
<disp-formula id="e1"><mml:math id="math2"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext mathvariant="bold-italic">y</mml:mtext><mml:mi>
</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>π</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> where the mean and the covariance matrix of
<bold><italic>Y</italic></bold> are (
<bold><italic>Y</italic></bold>) =
<italic>m</italic>
<bold><italic>π</italic></bold> and (
<bold><italic>Y</italic></bold>) = diag(
<bold><italic>π</italic></bold>) –
<italic><bold>ππ</bold><sup>T</sup></italic>, respectively.</p>
    <p>To account for overdispersion due to true biological variation between experimental units as well as technical variation, such as library preparation and errors in transcript quantification, we assume the feature proportions,
<bold>Π</bold>, follow the (conjugate) Dirichlet distribution, with density function:
<disp-formula id="e2"><mml:math id="math3"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>π</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>–</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> where
<italic>γ
<sub>j</sub></italic>,
<italic>j</italic> = 1, …,
<italic>q</italic> are the Dirichlet parameters and
<mml:math id="math4"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math> The mean and covariance matrix of random proportions
<bold>Π</bold> are (
<bold>Π</bold>) =
<bold><italic>γ</italic></bold>/
<italic>γ</italic>
<sub>+</sub> =
<bold><italic>π</italic></bold> and
<mml:math id="math5"><mml:mrow><mml:mo/><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">∏</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">γ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="bold">γ</mml:mi><mml:msup><mml:mi mathvariant="bold">γ</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>}</mml:mo><mml:mo>/</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> respectively. We can see that proportions
<bold>Π</bold> are proportional to
<bold><italic>γ</italic></bold> and their variance is inversely proportional to
<italic>γ</italic>
<sub>+</sub>, which is called the concentration or precision parameter. As
<italic>γ</italic>
<sub>+</sub> gets larger, the proportions are more concentrated around their means.</p>
    <p>We can derive the marginal distribution of
<bold><italic>Y</italic></bold> by multiplying densities (
<xref ref-type="other" rid="math2">1</xref>) and (
<xref ref-type="other" rid="math3">2</xref>) and integrating over
<bold><italic>π</italic></bold>. Then, feature counts
<bold><italic>Y</italic></bold> follow the DM distribution
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> with probability function defined as:
<disp-formula id="e3"><mml:math id="math6"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>π</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:mstyle><mml:msub><mml:mi>f</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>d</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
</p>
    <p>The mean of
<bold><italic>Y</italic></bold> is unchanged at (
<bold><italic>Y</italic></bold>) = {(
<bold><italic>Y</italic></bold>|
<bold>Π</bold>)} = (
<italic>m</italic>
<bold>Π</bold>) =
<italic>m
<bold>γ</bold></italic>/
<italic>γ</italic>
<sub>+</sub> =
<italic>m
<bold>π</bold></italic>, while the covariance matrix of
<bold><italic>Y</italic></bold> is given by (
<bold><italic>Y</italic></bold>) =
<italic>cm</italic>{diag(
<bold><italic>π</italic></bold>) −
<bold><italic>ππ</italic></bold>
<sup><italic>T</italic></sup>}, where
<italic>c</italic> = (
<italic>m</italic>+
<italic>γ</italic>
<sub>+</sub>)/(1+
<italic>γ</italic>
<sub>+</sub>) is an additional factor when representing the Dirichlet-multinomial covariance to the ordinary multinomial covariance.
<italic>c</italic> depends on concentration parameter
<italic>γ</italic>
<sub>+</sub> which controls the degree of overdispersion and is inversely proportional to variance of
<bold><italic>Y</italic></bold>.</p>
    <p>We can represent the DM distribution using an alternative parameterization:
<bold><italic>π</italic></bold> =
<bold><italic>γ</italic></bold>/
<italic>γ</italic>
<sub>+</sub> and
<italic>θ</italic> = 1/(1 +
<italic>γ</italic>
<sub>+</sub>); then, the covariance of
<bold><italic>Y</italic></bold> can be represented as (
<bold><italic>Y</italic></bold>) =
<italic>n</italic>{diag(
<bold><italic>π</italic></bold>) −
<bold><italic>ππ</italic></bold>
<sup><italic>T</italic></sup>} {1 +
<italic>θ</italic>(
<italic>n</italic> − 1)}, where
<italic>θ</italic> can be interpreted as a dispersion parameter. When
<italic>θ</italic> grows (
<italic>γ</italic>
<sub>+</sub> gets smaller), the variance becomes larger. From the knowledge of the gamma function,
<italic>x</italic>Γ(
<italic>x</italic>) = Γ(
<italic>x</italic> + 1), we can write
<mml:math id="math7"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>–</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math> Hence, the DM density function becomes:
<disp-formula id="e4"><mml:math id="math8"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> such that for
<italic>θ</italic> = 0, DM reduces to multinomial.</p>
  </sec>
  <sec>
    <title>Detecting DTU and tuQTLs with the Dirichlet-multinomial model</title>
    <p>Within
<italic>DRIMSeq</italic>, the DM method can be used to detect the differential usage of gene features between two or more conditions. For simplicity, suppose that features of a gene are transcripts and the comparison is done between two groups. The aim is to determine whether transcript ratios of a gene are different in these two conditions. Formally, we want to test the hypothesis
<italic>H</italic>
<sub>0</sub> :
<bold><italic>π</italic></bold>
<sub>1</sub> =
<bold><italic>π</italic></bold>
<sub>2</sub> against the alternative
<italic>H</italic>
<sub>1</sub> :
<bold><italic>π</italic></bold>
<sub>1</sub> ≠
<bold><italic>π</italic></bold>
<sub>2</sub>. For the convenience of parameter estimation, we decide to use the DM parameterization with precision parameter
<italic>γ</italic>
<sub>+</sub>, which can take any non-negative value, instead of dispersion parameter
<italic>θ</italic>, which is bounded to values between 0 and 1. Because our goal is to compare the proportions from two groups,
<italic>γ</italic>
<sub>+</sub> is a nuisance parameter that gets estimated in the first step (see the following Section). Let
<italic>l</italic>(
<bold><italic>π</italic><sub>1</sub></bold>,
<bold><italic>π</italic><sub>2</sub></bold>,
<italic>γ</italic>
<sub>+</sub>) be the joint log-likelihood function. Assuming
<mml:math id="math9"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math> the maximum likelihood (ML) estimates of
<bold><italic>π</italic><sub>1</sub></bold>,
<bold><italic>π</italic><sub>2</sub></bold> are the solution of
<mml:math id="math10"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math> Under the hypothesis
<italic>H</italic>
<sub>1</sub> :
<bold><italic>π</italic><sub>1</sub></bold> =
<bold><italic>π</italic><sub>2</sub></bold> =
<bold><italic>π</italic></bold>, the ML estimate of
<bold><italic>π</italic></bold> is the solution of
<mml:math id="math11"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math> We test the null hypothesis using a likelihood ratio statistic of the form
<disp-formula id="e5"><mml:math id="math12"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>2</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo mathvariant="bold">1</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mo mathvariant="bold">1</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo mathvariant="bold">2</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover><mml:mo mathvariant="bold">2</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="9em"/><mml:mo>–</mml:mo><mml:mo>2</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo mathvariant="bold">1</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo mathvariant="bold">2</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mo mathvariant="bold-italic">π</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> which asymptotically follows the chi-squared distribution
<mml:math id="math13"><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>–</mml:mo><mml:mo>1</mml:mo></mml:mrow><mml:mo>2</mml:mo></mml:msubsup></mml:mrow></mml:math> with q − 1 degrees of freedom. In comparisons across
<italic>c</italic> groups, the number of degrees of freedom is (
<italic>c</italic> − 1) × (
<italic>q</italic> − 1). After all genes are tested, p-values can be adjusted for multiple comparisons with the Benjamini-Hochberg method.</p>
    <p>In a DTU analysis, groups are defined by the design of an experiment and are the same for each gene. In tuQTL analyses, the aim is to find nearby (bi-allelic) SNPs associated
with transcript usage of a gene. Model fitting and testing is performed for each gene-SNP pair, and grouping of samples is defined by the genotype, typically translated into the number of minor alleles (0, 1 or 2). Thus, tuQTL analyses are similar to DTU analyses with the difference that multiple models are fitted and tested for each gene. Additional challenges to be handled in tuQTL analyses include a large number of tests per gene with highly variable allele frequencies (models) and linkage disequilibrium, which can be accounted for in the multiple testing corrections. As in other sQTL studies
<sup><xref rid="ref-35" ref-type="bibr">35</xref>,
<xref rid="ref-49" ref-type="bibr">49</xref>,
<xref rid="ref-50" ref-type="bibr">50</xref></sup>, we apply a permutation approach to empirically assess the null distribution of associations and use it for the adjustment of nominal p-values (see Supplementary Note 2 in
<xref ref-type="other" rid="SM1">Supplementary File</xref>). For computational efficiency, SNPs within a given gene that exhibit the same genotypes are grouped into blocks. In this way, blocks define unique models to be fit, reducing computation and the degree of multiple testing correction.</p>
  </sec>
  <sec>
    <title>Dispersion estimation with adjusted profile likelihood and moderation</title>
    <p>Accurate parameter estimation is a challenge when only a small number of replicates is available. Following the
<italic>edgeR</italic> strategy
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-2" ref-type="bibr">2</xref>,
<xref rid="ref-53" ref-type="bibr">53</xref></sup>, we propose multiple approaches for dispersion estimation, all based on the maximization and adjustment of the profile likelihood, since standard maximum likelihood (ML) is known to produce biased estimates as it tends to underestimate variance parameters by not allowing for the fact that other unknown parameters are estimated from the same data
<sup><xref rid="ref-54" ref-type="bibr">54</xref>,
<xref rid="ref-55" ref-type="bibr">55</xref></sup>.</p>
    <p>In the DM model parameterization of our choice, we are interested in estimating the precision (concentration) parameter,
<italic>γ</italic>
<sub>+</sub> (inverse proportional to dispersion
<italic>θ</italic>). Hence, at this stage, proportions
<bold><italic>π</italic><sub>1</sub></bold> and
<bold><italic>π</italic><sub>2</sub></bold> can be considered nuisance parameters and the profile log-likelihood (
<italic>PL</italic>) for
<italic>γ</italic>
<sub>+</sub> can be constructed by maximizing the log-likelihood function with respect to proportions
<bold><italic>π</italic><sub>1</sub></bold> and
<bold><italic>π</italic><sub>2</sub></bold> for fixed
<italic>γ</italic>
<sub>+</sub>:
<disp-formula id="e6"><mml:math id="math14"><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo mathvariant="bold">^</mml:mo></mml:mover><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo mathvariant="bold">^</mml:mo></mml:mover><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
    <p>The profile likelihood is then treated as an ordinary likelihood function for estimation and inference about parameters of interest. Unfortunately, with large numbers of nuisance parameters, this approach can produce inefficient or even inconsistent estimates
<sup><xref rid="ref-54" ref-type="bibr">54</xref>,
<xref rid="ref-55" ref-type="bibr">55</xref></sup>. To correct for that, one can apply an adjustment proposed by Cox and Reid
<sup><xref rid="ref-56" ref-type="bibr">56</xref></sup> and obtain an adjusted profile likelihood (
<italic>APL</italic>):
<disp-formula><mml:math id="math15"><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo mathvariant="bold">1</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo mathvariant="bold">2</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo mathvariant="bold">1</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo mathvariant="bold">2</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>–</mml:mo><mml:mfrac><mml:mo>1</mml:mo><mml:mo>2</mml:mo></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>det</mml:mi><mml:mo>⁡</mml:mo><mml:mi>m</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> where
<italic>det</italic> denotes determinant and
<italic>I</italic> is the observed information matrix for
<bold>π
<sub>1</sub></bold> and
<bold>π
<sub>2</sub></bold>. The interpretation of the correction term in
<italic>APL</italic> is that it penalizes values of
<italic>γ</italic>
<sub>+</sub> for which the information about
<bold>π
<sub>1</sub></bold> and
<bold>π
<sub>2</sub></bold> is relatively large. When data consists of many samples, one can use gene-wise dispersion estimates, i.e., the dispersion is estimated for each gene
<italic>g</italic> = 1,…,
<italic>G</italic> separately:</p>
    <p>
      <disp-formula>
        <mml:math id="math16">
          <mml:mrow>
            <mml:mtext>arg</mml:mtext>
            <mml:mspace width="0.2em"/>
            <mml:mtext>max</mml:mtext>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mi>A</mml:mi>
                <mml:mi>P</mml:mi>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mi>g</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>γ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>}</mml:mo>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mtext>arg</mml:mtext>
            <mml:mspace width="0.2em"/>
            <mml:mtext>max</mml:mtext>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mi>A</mml:mi>
                <mml:mi>P</mml:mi>
                <mml:mi> L</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>γ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msubsup>
                    <mml:mo>;</mml:mo>
                    <mml:msubsup>
                      <mml:mover accent="true">
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mo mathvariant="bold">1</mml:mo>
                      <mml:mi mathvariant="bold-italic">g</mml:mi>
                    </mml:msubsup>
                    <mml:mo>,</mml:mo>
                    <mml:msubsup>
                      <mml:mover accent="true">
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mo mathvariant="bold">2</mml:mo>
                      <mml:mi mathvariant="bold-italic">g</mml:mi>
                    </mml:msubsup>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi mathvariant="bold-italic">y</mml:mi>
                      <mml:mi mathvariant="bold-italic">g</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>}</mml:mo>
            </mml:mrow>
            <mml:mo>.</mml:mo>
            <mml:mspace width="5em"/>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mn>8</mml:mn>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>These estimates become more unstable as the sample size decreases. At the other extreme, one can assume a common dispersion for all genes and use all genes to estimate it:</p>
    <p>
      <disp-formula>
        <mml:math id="math17">
          <mml:mrow>
            <mml:mtext>arg</mml:mtext>
            <mml:mspace width="0.2em"/>
            <mml:mtext>max</mml:mtext>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mo>1</mml:mo>
                  <mml:mi>G</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mo>1</mml:mo>
                    </mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                    <mml:mi>P</mml:mi>
                    <mml:msub>
                      <mml:mi> L</mml:mi>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>γ</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>g</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:mo>}</mml:mo>
            </mml:mrow>
            <mml:mo>.</mml:mo>
            <mml:mspace width="5em"/>
            <mml:mo>(9)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>Common dispersion estimates are more stable but the assumption of a single dispersion for all genes is rather strong, given that some genes are under tighter regulation than others
<sup><xref rid="ref-57" ref-type="bibr">57</xref>,
<xref rid="ref-58" ref-type="bibr">58</xref></sup>. Thus, moderated dispersion is a trade-off between gene-wise and common dispersion and estimates are calculated with an empirical Bayes approach, which uses a weighted combination of the common and individual likelihood:</p>
    <p>
      <disp-formula>
        <mml:math id="math18">
          <mml:mrow>
            <mml:mtext>arg</mml:mtext>
            <mml:mspace width="0.2em"/>
            <mml:mtext>max</mml:mtext>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mi>A</mml:mi>
                <mml:mi>P</mml:mi>
                <mml:msub>
                  <mml:mi> L</mml:mi>
                  <mml:mi>g</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>γ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mi>W</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfrac>
                  <mml:mo>1</mml:mo>
                  <mml:mi>G</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mo>1</mml:mo>
                    </mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                    <mml:mi>P</mml:mi>
                    <mml:msub>
                      <mml:mi>L</mml:mi>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>γ</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>g</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:mo>}</mml:mo>
            </mml:mrow>
            <mml:mo>.</mml:mo>
            <mml:mspace width="5em"/>
            <mml:mo>(10)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>If a dispersion-mean trend is present (see
<xref ref-type="other" rid="SM1">Figure S16</xref>,
<xref ref-type="other" rid="SM1">Figure S17</xref>,
<xref ref-type="other" rid="SM1">Figure S28</xref> and
<xref ref-type="other" rid="SM1">Figure S29</xref> in
<xref ref-type="other" rid="SM1">Supplementary File</xref>), as commonly observed in gene-level differential expression analyses
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-3" ref-type="bibr">3</xref></sup>, one can apply shrinkage towards this trend instead of to the common dispersion:</p>
    <p>
      <disp-formula>
        <mml:math id="math19">
          <mml:mrow>
            <mml:mtext>arg</mml:mtext>
            <mml:mspace width="0.2em"/>
            <mml:mtext>max</mml:mtext>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mi>A</mml:mi>
                <mml:mi>P</mml:mi>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mi>g</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>γ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mi>W</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfrac>
                  <mml:mo>1</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:mi>C</mml:mi>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow/>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                    <mml:mi>P</mml:mi>
                    <mml:msub>
                      <mml:mi>L</mml:mi>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>γ</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>g</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:mo>}</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mspace width="5em"/>
            <mml:mo>(11)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>where
<italic>C</italic> is a set of genes that have similar gene expression as gene
<italic>g</italic> and
<italic>W</italic> is a weight defining the strength of moderation (see
<xref ref-type="other" rid="SM1">Supplementary Note 1</xref> for further details).</p>
  </sec>
  <sec>
    <title>Estimation and inference: simulations from the Dirichlet-multinomial model</title>
    <p>We first investigated the performance of the DM model and the approach for parameter estimation and inference in the case where only few replicates are available. We performed simulations that correspond to a two-group comparison with no DTU (i.e. null model) where feature counts were generated from the DM distribution with identical parameters in both groups. Simulations were repeated 50 times for 1000 genes. In these simulations, we can vary the overall expression (m), number of features (q), proportions (prop) and sample size in one condition (n). Proportions follow a uniform or decaying distribution or are estimated based on
<italic>kallisto</italic> transcripts or
<italic>HTSeq</italic> exon counts from Kim
<italic>et al</italic>. and Brooks
<italic>et al</italic>. data (more details on these datasets below). In the first case, all genes have the same (common) dispersion, and in the second one, each gene has different (genewise) dispersion. Simulations for evaluating the dispersion moderation are intended to better resemble a real dataset. For these instances (repeated 25 times for 5000 genes), genes have expression, dispersion and proportions that were estimated from the real data. See
<xref ref-type="other" rid="SM1">Supplementary Note 3</xref> for the additional details.</p>
    <p><xref ref-type="fig" rid="f1">Figure 1A</xref> and
<xref ref-type="other" rid="SM1">Figure S1</xref> confirm that using the Cox-Reid adjustment (CR) improves the estimation (in terms of median absolute error and extreme error values) of the concentration parameter
<italic>γ</italic>
<sub>+</sub> in comparison to raw profile likelihood (PL) estimates. Additionally, the median error of concentration estimates for Cox-Reid APL is always lower than for PL or maximum likelihood (ML) used in the
<italic>dirmult</italic> package
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> (
<xref ref-type="fig" rid="f1">Figure 1C</xref>,
<xref ref-type="other" rid="SM1">Figure S2</xref>). This translates directly into the inference performance where the CR approach leads to lower false positive (FP) rate than other approaches (
<xref ref-type="fig" rid="f1">Figure 1B</xref>,
<xref ref-type="other" rid="SM1">Figure S3</xref>).</p>
    <p>Accurate estimates of dispersion do not always lead to expected control of FP rate. Notably, using the true concentration parameters in genes with many features (with decaying proportions) results in higher than expected nominal FP rates (
<xref ref-type="fig" rid="f1">Figure 1B</xref>,
<xref ref-type="other" rid="SM1">Figure S3</xref> and
<xref ref-type="other" rid="SM1">Figure S6A</xref>). Meanwhile, for genes with uniform proportions, even with many features, the FP rate for true dispersion is controlled (
<xref ref-type="other" rid="SM1">Figure S3</xref> and
<xref ref-type="other" rid="SM1">Figure S6B</xref>). Also, the Cox-Reid adjustment tends to underestimate the concentration (overestimate dispersion) for genes with many features and decaying proportions, especially for very small sample size (
<xref ref-type="fig" rid="f1">Figure 1C</xref>,
<xref ref-type="other" rid="SM1">Figure S2</xref>,
<xref ref-type="other" rid="SM1">Figure S5A</xref>,
<xref ref-type="other" rid="SM1">Figure S5E</xref>), which leads to accurate FP rate control not achieved even with the true dispersion (
<xref ref-type="other" rid="SM1">Figure S6A</xref>).</p>
    <p>As expected, common dispersion estimation is effective when all genes indeed have the same dispersion, though this cannot be generally assumed in most real RNA-seq datasets (see results of simulations in the following section). In contrast, pure gene-wise estimates of dispersion lead to relatively high estimation error in small sample sizes (
<xref ref-type="fig" rid="f1">Figure 1A</xref>,
<xref ref-type="other" rid="SM1">Figure S1</xref> and
<xref ref-type="other" rid="SM1">Figure S8</xref>). Thus, sharing information about concentration (dispersion) between genes by moderating the gene-wise APL is applied. This improves concentration estimation in terms of median error (
<xref ref-type="fig" rid="f1">Figure 1C</xref> and
<xref ref-type="other" rid="SM1">Figure S8</xref>) and by shrinking extremely large values (on the boundary of the parameter space, see
<xref ref-type="other" rid="SM1">Figure S7</xref>) toward common or trended concentration. Therefore, moderated gene-wise estimates lead to better control of the nominal FP rate (
<xref ref-type="fig" rid="f1">Figure 1B</xref> and
<xref ref-type="other" rid="SM1">Figure S10</xref>).</p>
    <p>In these simulations, the overall best performance of the DM model is achieved when dispersion parameters are estimated with the Cox-Reid APL and the dispersion moderation is applied. This strategy leads to p-value distributions that in most of the cases are closer to the uniform distribution (
<xref ref-type="fig" rid="f1">Figure 1D</xref>,
<xref ref-type="other" rid="SM1">Figure S4</xref> and
<xref ref-type="other" rid="SM1">Figure S11</xref>).</p>
  </sec>
  <sec>
    <title>Comparison on simulations that mimic real RNA-seq data</title>
    <p>Next, we use the simulated data from Soneson
<italic>et al</italic>.
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>, where RNA-seq reads were generated such that 1000 genes had isoform switches between two conditions of the two most abundant transcripts. For each condition three replicates were simulated resulting in 3 versus 3 comparisons. Altogether, we summarize results for three scenarios: i) Drosophila melanogaster with no differential gene expression; ii) Homo sapiens without differential gene expression; iii) Homo sapiens with differential gene expression.</p>
    <p>The aim of these analyses is to compare the performance of
<italic>DRIMSeq</italic> against
<italic>DEXSeq</italic>, which emerged among the top performing methods for detection of DTU from RNA-seq data
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>. For
<italic>DRIMSeq</italic>, we consider different dispersion estimates: common, gene-wise with no moderation and with moderation-to-common and to-trended dispersion. We use the exonic bin counts provided by
<italic>HTSeq</italic> (same input to the
<italic>DEXSeq</italic> pipeline), and transcript counts obtained with
<italic>kallisto</italic>. Additionally, we use
<italic>HTSeq</italic> and
<italic>kallisto</italic> counts that are re-estimated after the removal of lowly expressed transcripts (less than 5% in all samples) from the gene annotation (pre-filtering) as proposed by Soneson
<italic>et al</italic>.
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup> and
<italic>kallisto</italic> filtered counts that exclude the lowly expressed transcripts (also less than 5% in all samples).
<italic>DRIMSeq</italic> returns a p-value per gene. To make results comparable, we used the module within
<italic>DEXSeq</italic> that summarizes exon-level p-values to a gene-level adjusted p-value.</p>
    <p>As expected, common dispersion estimates lead to worse performance (lower power and higher FDR) compared to gene-wise dispersions.
<italic>DRIMSeq</italic> achieves the best performance with moderated gene-wise dispersion estimates, while the difference in performance between moderating to common or to trended dispersion is quite small, with moderated-to-trend dispersion estimates being slightly more conservative (
<xref ref-type="fig" rid="f2">Figure 2</xref> and
<xref ref-type="other" rid="SM1">Figure S15</xref>).</p>
    <fig fig-type="figure" id="f2" orientation="portrait" position="float">
      <label>Figure 2. </label>
      <caption>
        <title>True positive rate (TPR) versus achieved false discovery rate (FDR) for three FDR thresholds (0.01, 0.05 and 0.1) obtained by
<italic>DEXSeq</italic> and
<italic>DRIMSeq</italic>.</title>
        <p><italic>DRIMSeq</italic> was run with different dispersion estimation strategies: common dispersion and genewise dispersion with no moderation (genewise_grid_none), moderation to common dispersion (genewise_grid_common) and moderation to trended dispersion (genewise_grid_trended). Results presented for Drosophila melanogaster and Homo sapiens simulations with DTU (nonull) and no differential gene expression (node) using transcript counts from
<italic>kallisto</italic> and exonic counts from
<italic>HTSeq</italic>. Additionally, filtered counts (kallistofiltered5, htseqprefiltered5) are used. When the achieved FDR is smaller than the threshold, circles are filled with the corresponding color, otherwise, they are white.</p>
      </caption>
      <graphic xlink:href="f1000research-5-11139-g0001"/>
    </fig>
    <p>As noted by Soneson
<italic>et al</italic>.
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>, detecting DTU in human is harder than in fruit fly due to the more complex transcriptome of the first one; all methods have much smaller false discovery rate (FDR). Nevertheless, none of the methods manages to control the FDR at a given threshold in either of the simulations.</p>
    <p>Annotation pre-filtering, suggested as a solution to mitigate high FDRs
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>, affects
<italic>DEXSeq</italic> and
<italic>DRIMSeq</italic> in a different way. For
<italic>DEXSeq</italic>, it strongly reduces the FDR. For
<italic>DRIMSeq</italic>, it increases power without a strong reduction of FDR. Moreover, the results for
<italic>kallisto</italic> filtered and pre-filtered are almost identical (
<xref ref-type="other" rid="SM1">Figure S15</xref> and
<xref ref-type="other" rid="SM1">Figure S24</xref>), which means that the re-estimation step based on the reduced annotation is not necessary for
<italic>kallisto</italic> when used with
<italic>DRIMSeq</italic> or
<italic>DEXSeq</italic>. Additionally, we have considered how other filtering approaches affect DTU detection.</p>
    <p>From
<xref ref-type="other" rid="SM1">Figure S24</xref>, we can see that DS analysis based on transcript counts are more robust to different variations of filtering and indeed some filtering improves the inference. For exonic counts, filtering should be less stringent and the pre-filtering approach is the best performing strategy.</p>
    <p><italic>DRIMSeq</italic> performs well when coupled with transcript counts from
<italic>kallisto</italic>. In the case when no filtering is applied to the data, it outperforms
<italic>DEXSeq</italic>. When transcript counts are pre-filtered, both methods have very similar performance (
<xref ref-type="other" rid="SM1">Figure S15</xref>). For both differential engines, the performance decreases substantially with increasing number of transcripts per gene, with
<italic>DRIMSeq</italic> having slightly more power when genes have only a few transcripts (
<xref ref-type="other" rid="SM1">Figure S17</xref>).
<italic>DRIMSeq</italic> has poor performance for the exonic counts in the human simulation, where achieved FDRs of more than 50% are observed for an expected 5%; consequently, we recommend the use of
<italic>DRIMSeq</italic> on transcript counts only. On the other hand, the concordance of
<italic>DRIMSeq</italic> and
<italic>DEXSeq</italic> top-ranked genes is quite high and similar even for exonic counts (
<xref ref-type="other" rid="SM1">Figure S16</xref>).</p>
    <p>The p-value distributions highlight a better fit of the DM model to transcript counts compared to exonic counts (it is more uniform with a sharp peak close to zero). Similarly, dispersion estimation gives better results for transcript counts (
<xref ref-type="other" rid="SM1">Figure S19</xref> and
<xref ref-type="other" rid="SM1">Figure S20</xref>). In particular, for exonic counts, a large number of genes have concentration parameter estimates at the boundary of the parameter space, unlike the situation for transcript counts (
<xref ref-type="other" rid="SM1">Figure S19</xref> and
<xref ref-type="other" rid="SM1">Figure S20</xref>).</p>
  </sec>
  <sec>
    <title>DS analyses on real datasets</title>
    <p>To compare the methods further, we consider two public RNA-seq data sets. The first is the pasilla dataset
<sup><xref rid="ref-59" ref-type="bibr">59</xref></sup> (Brooks
<italic>et al.</italic>). The aim was to identify genes regulated by
<italic>pasilla</italic>, the Drosophila ortholog of mammalian splicing factors
<italic>NOVA1</italic> and
<italic>NOVA2</italic>. In this experiment, libraries were prepared from seven biologically independent samples: four control samples and three samples in which
<italic>pasilla</italic> was knocked down. Libraries were sequenced using a mixture of single-end and paired-end reads as well as different read lengths. The second data set is from matched human lung normal and adenocarcinoma samples from six Korean female nonsmoking patients
<sup><xref rid="ref-60" ref-type="bibr">60</xref></sup>, using paired-end reads (Kim
<italic>et al.</italic>).</p>
    <p>Both datasets have a more complex design than those used in the simulations; in addition to the grouping variable of interest, there are additional covariates to adjust for (e.g., library layout for the fruit fly data, patient identifier for the paired human study). In order to account for such effects, one should rather use a regression approach, which currently is not supported by
<italic>DRIMSeq</italic>, but can be applied within
<italic>DEXSeq</italic>’s GLM framework. To make the comparison fair, we fit multiple models. For the pasilla dataset, we compare four control samples versus three pasilla knock-down samples without taking into account the library layout (model full) as well as compare only the paired-end samples, which removes the covariate. To not diminish
<italic>DEXSeq</italic> for its ability to fit more complex models, we run it using a model that does the four control versus three knock-down comparison with library layout as an additional covariate (model full 2). For the adenocarcinoma data, we do a two-group comparison of six normal versus six cancer samples (model full) and for
<italic>DEXSeq</italic>, we fit an extra model that takes into account patient effects (model full 2). Additionally, we do so-called "mock" analyses where samples from the same condition are compared (model null), and the expectation is to detect no DS since it is a within-condition comparison (see
<xref ref-type="other" rid="SM1">Supplementary Note 5</xref> for the exact definition of these null models).</p>
    <p>In the full comparisons with transcript counts,
<italic>DRIMSeq</italic> calls similar or fewer DS genes than
<italic>DEXSeq</italic>, and a majority of them are contained within the
<italic>DEXSeq</italic> calls (
<xref ref-type="other" rid="SM1">Figure S26</xref>,
<xref ref-type="other" rid="SM1">Figure S27</xref>) showing high concordance between
<italic>DRIMSeq</italic> and
<italic>DEXSeq</italic> and slightly more conservative nature of
<italic>DRIMSeq</italic>. Accounting for covariates in
<italic>DEXSeq</italic> (model full 2) or performing the analysis on a subgroup without covariates (model full paired) results in more DS genes detected (
<xref ref-type="other" rid="SM1">Figure S28</xref>,
<xref ref-type="other" rid="SM1">Figure S29</xref> and
<xref ref-type="other" rid="SM1">Figure S30</xref>).</p>
    <p>In the "mock" analyses, as expected, both methods detect considerably fewer DS genes, except in two cases. First, for the pasilla data (model null 3), where the two
<italic>versus</italic> two control samples were from single-end library in one group and from paired-end library in the second group, leading to a comparison between batches in which both of the methods found more DS genes than in the comparison of control versus knock-down showing that the "batch" effect is very strong. Second, in the adenocarcinoma data (model null normal 1), where the two groups of individuals (each consisting of three women) happened to be very distinct (
<xref ref-type="other" rid="SM1">Figure S25</xref>). Therefore, we do not include these two cases when referring to the null models.</p>
    <p>Overall, in the full comparisons, there are more DS genes detected based on differential transcript usage than differential exon usage (
<xref ref-type="other" rid="SM1">Figure S26</xref>). For
<italic>DEXSeq</italic>, this is also the case in the null comparisons, which shows that
<italic>DEXSeq</italic> works better with exonic counts than with transcript counts.
<italic>DRIMSeq</italic>, on the other hand, has better performance on transcript counts, for which it calls less DS genes in the null analysis than with exon counts. In particular, the p-value distributions under the null indicate that DM fits better to transcript counts than exon counts (
<xref ref-type="other" rid="SM1">Figure S14</xref>,
<xref ref-type="other" rid="SM1">Figure S31</xref> and
<xref ref-type="other" rid="SM1">Figure S32</xref>).</p>
    <p>Method comparisons based on real data are very challenging as the truth is simply not known. In this sense the pasilla data is very precious, as the authors of this study have validated alternative usage of exons in 16 genes using RT-PCR. Of course, these validations represent an incomplete truth, and ideally, large-scale independent validation would be needed to comprehensively compare the DTU detection methods. In
<xref ref-type="fig" rid="f3">Figure 3</xref>,
<xref ref-type="other" rid="SM1">Figure S33</xref>,
<xref ref-type="other" rid="SM1">Figure S34</xref> and
<xref ref-type="other" rid="SM1">Figure S35</xref> again it is shown that
<italic>DRIMSeq</italic> is slightly more conservative than
<italic>DEXSeq</italic>.
<italic>DRIMSeq</italic> performs poorly on exon-level but returns strong performance on transcript-level quantification (e.g.,
<italic>kallisto</italic>) and even outperforms
<italic>DEXSeq</italic> when the sample size is very small (model full paired).</p>
    <fig fig-type="figure" id="f3" orientation="portrait" position="float">
      <label>Figure 3. </label>
      <caption>
        <title>Results of DS analysis on the pasilla dataset showing how many of the 16 validated genes are called by
<italic>DRIMSeq</italic> and
<italic>DEXSeq</italic> using different counting strategies and different models.</title>
        <p>On each curve, "X" indicates the number of DS genes detected for the FDR of 0.05. Model full - comparison of 4 control samples versus 3 knock-down. Model full paired - comparison of 2 versus 2 paired-end samples. Model full 2 - as model full but including the information about library layout (no results for
<italic>DRIMSeq</italic> because currently, it is not able to fit models with multiple covariates).</p>
      </caption>
      <graphic xlink:href="f1000research-5-11139-g0002"/>
    </fig>
  </sec>
  <sec>
    <title>tuQTL analyses</title>
    <p>To demonstrate the application of
<italic>DRIMSeq</italic> to tuQTL analysis, we use the data from the GEUVADIS project
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup> where 465 RNA-seq samples from lymphoblastoid cell lines were sequenced, 422 of which were sequenced in the 1000 Genomes Project Phase 1. Here, we present the analysis of 91 samples corresponding to the CEU population and 89 samples from the YRI population. Expected transcript counts (obtained with Flux Capacitor) and genotype data were downloaded from the GEUVADIS project website. We choose to compare the performance of
<italic>DRIMSeq</italic> with
<italic>sQTLseekeR</italic>, because it is a very recent tool that performs well
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup>, can be directly applied to transcript count data and models transcript usage as a multivariate outcome.</p>
    <p>For both of the methods, we investigate only the bi-allelic SNPs with a minor allele present in at least five samples (minor allele frequency approximately equal to 5%) and at least two alleles present in a population. Given a gene, we keep the SNPs that are located within 5 Kb upstream or downstream of the gene. We use the same pre-filtered counts in
<italic>DRIMSeq</italic> and
<italic>sQTLseekeR</italic> to have the same baseline for the comparison of the statistical engines offered by these packages. We keep the protein coding genes that have at least 10 counts in 70 or more samples and at least two transcripts left after the transcript filtering, which keeps the one that has at least 10 counts and proportion of at least 5% in 5 or more samples. The numbers of tested and associated genes and tuQTLs are indicated in
<xref ref-type="fig" rid="f4">Figure 4</xref>,
<xref ref-type="other" rid="SM1">Figure S38</xref> and
<xref ref-type="other" rid="SM1">Figure S39</xref>.</p>
    <fig fig-type="figure" id="f4" orientation="portrait" position="float">
      <label>Figure 4. </label>
      <caption>
        <title>Results of the tuQTL analysis on the CEU population from the GEUVADIS data.</title>
        <p><bold>A</bold>: Concordance between
<italic>sQTLseekeR</italic> and
<italic>DRIMSeq</italic>. "X" indicates number of tuQTLs for FDR = 0.05. Panel
<bold>B</bold>,
<bold>C</bold> and
<bold>D</bold> show characteristics of tuQTLs and genes detected by
<italic>sQTLseekeR</italic> or
<italic>DRIMSeq</italic> for FDR = 0.05. Values in brackets indicate numbers of tuQTLs or genes in a given set. Dark gray line corresponds to tuQTLs or genes that were identified by both of the methods (overlap).
<bold>B</bold>: Distance to the closest exon of intronic tuQTLs. The light gray line (non_sqtl) corresponds to intronic tuQTLs that were not called by any of the methods.
<bold>C</bold>: Distribution of mean gene expression for genes that are associated with tuQTLs.
<bold>D</bold>: Distribution of the number of expressed transcripts for genes that are associated with tuQTLs. The light gray lines (all_genes) represent corresponding features for all the analyzed
genes.</p>
      </caption>
      <graphic xlink:href="f1000research-5-11139-g0003"/>
    </fig>
    <p>In
<xref ref-type="fig" rid="f4">Figure 4A</xref> and
<xref ref-type="other" rid="SM1">Figure S40</xref> we can see that the concordance between
<italic>DRIMSeq</italic> and
<italic>sQTLseekeR</italic> is quite high and reaches 75%. Nevertheless, there is considerable difference between the number and type of genes that are uniquely identified by each method.
<italic>sQTLseekeR</italic> finds more genes with alternative splicing associated to genetic variation (
<xref ref-type="other" rid="SM1">Figure S38</xref> and
<xref ref-type="other" rid="SM1">Figure S39</xref>), but these genes have fewer transcripts
expressed and lower overall expression in comparison to genes detected by
<italic>DRIMSeq</italic> (
<xref ref-type="fig" rid="f4">Figure 4C</xref>,
<xref ref-type="fig" rid="f4">Figure 4D</xref>,
<xref ref-type="other" rid="SM1">Figure S40C</xref> and
<xref ref-type="other" rid="SM1">Figure S40D</xref>). To further investigate characteristics of detected tuQTLs, we measured enrichment of splicing-related features as used in a previous comparison
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup>. This includes the location of tuQTLs within exons, within splice sites, in the surrounding of GWAS SNPs and distance to the closest exon. tuQTLs detected by
<italic>DRIMSeq</italic> show higher enrichment for all splicing related features (
<xref ref-type="table" rid="T1">Table 1</xref> and
<xref ref-type="fig" rid="f4">Figure 4B</xref>), than
<italic>sQTLseekeR</italic> tuQTLs, suggesting that by accounting for the overall gene expression, one can detect more meaningful associations.</p>
    <table-wrap id="T1" orientation="portrait" position="anchor">
      <label>Table 1. </label>
      <caption>
        <title>Enrichment in splicing related features for tuQTLs detected by
<italic>DRIMSeq</italic> and
<italic>sQTLseekeR</italic> in CEU and YRI populations for FDR = 0.05.</title>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="center" rowspan="1" colspan="1"/>
            <th align="center" colspan="2" rowspan="1">% within
<break/>exons</th>
            <th align="center" colspan="2" rowspan="1">% within
<break/>splice sites</th>
            <th align="center" colspan="2" rowspan="1">% within 1Kb
<break/>of a GWAS</th>
          </tr>
          <tr>
            <th align="center" rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">CEU</th>
            <th align="center" rowspan="1" colspan="1">YRI</th>
            <th align="center" rowspan="1" colspan="1">CEU</th>
            <th align="center" rowspan="1" colspan="1">YRI</th>
            <th align="center" rowspan="1" colspan="1">CEU</th>
            <th align="center" rowspan="1" colspan="1">YRI</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">DRIMSeq</td>
            <td align="center" rowspan="1" colspan="1">26.09</td>
            <td align="center" rowspan="1" colspan="1">35.89</td>
            <td align="center" rowspan="1" colspan="1">19.76</td>
            <td align="center" rowspan="1" colspan="1">21.42</td>
            <td align="center" rowspan="1" colspan="1">12.75</td>
            <td align="center" rowspan="1" colspan="1">15.43</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">sQTLseekeR</td>
            <td align="center" rowspan="1" colspan="1">20.95</td>
            <td align="center" rowspan="1" colspan="1">25.43</td>
            <td align="center" rowspan="1" colspan="1">13.52</td>
            <td align="center" rowspan="1" colspan="1">17.4</td>
            <td align="center" rowspan="1" colspan="1">10.22</td>
            <td align="center" rowspan="1" colspan="1">10.09</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Overlap</td>
            <td align="center" rowspan="1" colspan="1">26.85</td>
            <td align="center" rowspan="1" colspan="1">40.58</td>
            <td align="center" rowspan="1" colspan="1">16.17</td>
            <td align="center" rowspan="1" colspan="1">25.36</td>
            <td align="center" rowspan="1" colspan="1">13.42</td>
            <td align="center" rowspan="1" colspan="1">18.14</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Non tuQTLs</td>
            <td align="center" rowspan="1" colspan="1">5.25</td>
            <td align="center" rowspan="1" colspan="1">5.24</td>
            <td align="center" rowspan="1" colspan="1">1.75</td>
            <td align="center" rowspan="1" colspan="1">1.53</td>
            <td align="center" rowspan="1" colspan="1">1.15</td>
            <td align="center" rowspan="1" colspan="1">0.97</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We have created a statistical framework called
<italic>DRIMSeq</italic> based on the Dirichlet-multinomial distribution to model alternative usage of transcript isoforms from RNA-seq data. We have shown that this framework can be used for detecting differential isoform usage between experimental conditions as well as for identifying tuQTLs. In principle, the framework is suitable for differential analysis of any type of multinomial-like responses. From our simulations and real data analyses towards DS and sQTL analyses,
<italic>DRIMSeq</italic> seems better suited to model transcript counts rather than exonic counts.</p>
    <p>Overall, there are many tradeoffs to be made in DS analyses. For example, deriving transcript abundances from RNA-seq data is more difficult (e.g., complicated overlapping genes at medium to low expression levels) than directly counting exon inclusion levels of specific events. On the other hand, local splicing events may be not able to capture biologically interesting splice changes (e.g., switching between two different transcripts) but have ultimately more ability to detect DS in case when the transcript catalog is incomplete. Despite these tradeoffs and given the results observed here,
<italic>DRIMSeq</italic> finds its place as a method to make downstream calculations on transcript quantifications. With emerging technologies that sequence longer DNA fragments (either truly or synthetically), we may see in the near future more direct counting of full-length transcripts, making transcript-level quantification more robust and accurate. Even with current standard RNA-seq data, ultrafast and lightweight methods make transcript counting more accessible and users will want to make comparative analyses directly from these estimates.</p>
    <p>In principle, existing DS methods that allow multiple group comparisons could be adapted to the sQTL framework and
<italic>vice versa</italic>;
<italic>DRIMSeq</italic> is one of few tools that bridge these two applications. In particular, parameter estimation with
<italic>DRIMSeq</italic> is suited for a situation where only a few replicates are available per group (common in DS analysis) as well as analyses over larger samples sizes (typical in sQTL analysis). For small sample sizes, accurate dispersion estimation is especially challenging. Thus, we incorporate estimation techniques analogous to those used in negative binomial frameworks, such as Cox-Reid APL; perhaps not surprisingly, raw profile likelihood or standard maximum likelihood approaches do not perform as well in our tests of estimation performance. In addition, as with many successful genomics modeling frameworks, sharing information across genes leads to more stable and accurate estimation and therefore better inference (e.g., better control of nominal FP rates).</p>
    <p>In comparison to other available methods,
<italic>DRIMSeq</italic> seems to be more conservative than both
<italic>DEXSeq</italic> (using transcript counts) and
<italic>sQTLseekeR</italic>, identifying fewer DTU genes and tuQTLs, respectively. On the other hand,
<italic>DEXSeq</italic> is known to be somewhat liberal
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>. Moreover, the sQTL associations detected by
<italic>DRIMSeq</italic> have more enrichment in splicing-related features than
<italic>sQTLseekeR</italic> tuQTLs, which could be due to the fact that
<italic>DRIMSeq</italic> accounts for the higher uncertainty of lowly expressed genes by using transcript counts instead of transcript ratios.</p>
    <p>Our developed DM framework is general enough that it can be applied to other genomic data with multivariate count outcomes. For example, PolyA-seq data quantifies the usage of multiple RNA polyadenylation sites. During polyadenylation, poly(A) tails can be added to different sites and thus more than one transcript can be produced from a single gene (alternative polyadenylation); comparisons between groups of replicates can be conducted with
<italic>DRIMSeq</italic>. As mentioned, the DM distribution is a multivariate generalization of the beta-binomial distribution, as the binomial and beta distributions are univariate versions of the multinomial and Dirichlet distributions, respectively. Although untested here, the
<italic>DRIMSeq</italic> framework could be applied to analyses where the beta-binomial distribution are used with the advantage of naturally accommodating small-sample datasets. Interesting beta-binomial-based analyses include differential methylation using bisulphite sequencing data, where counts of methylated and unmethylated cytosines (a bivariate outcome) at specific genomic loci are compared, or allele-specific gene expression, where the expression of two alleles (again, a bivariate outcome) are compared across experimental groups.</p>
    <p>One particularly important future enhancement is a regression framework, which would allow direct analysis of more complex experimental designs. For example, covariates such as batch, sample pairing or other factors could be adjusted for in the model. In the tuQTL analysis, it would allow studying samples from the pooled populations, with the subpopulation as a covariate, allowing larger sample sizes and increased power to detect interesting changes. Another potential limitation is that
<italic>DRIMSeq</italic> treats transcript estimates as fixed, even though they have different uncertainty, depending on the read coverage and complexity of the set of transcripts within a gene. Although untested here, propagation of this uncertainty could be achieved by incorporating observational weights that are inversely proportional to estimated uncertainties or, in case of fast quantification methods like
<italic>kallisto</italic>, by making effective use of bootstrap samples. At this stage, there is no consensus on how these approaches will perform and ultimately may require considerable additional computation.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>The Dirichlet-multinomial framework described in this paper is implemented within an R package called DRIMSeq. In addition to the user friendly workflow for the DTU and tuQTL analyses, it provides plotting functions that generate diagnostic figures such as the dispersion versus mean gene expression figures and histograms of p-values. User can also generate figures of the observed proportions and the DM estimated ratios for the genes of interest to visually investigate their individual splicing patterns.</p>
    <p>The release version of
<italic>DRIMSeq</italic> is available on Bioconductor
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/DRIMSeq">http://bioconductor.org/packages/DRIMSeq</ext-link>, and the latest development version can be found on GitHub
<ext-link ext-link-type="uri" xlink:href="https://github.com/markrobinsonuzh/DRIMSeq">https://github.com/markrobinsonuzh/DRIMSeq</ext-link>.</p>
  </sec>
  <sec>
    <title>Data availability</title>
    <p>The data referenced by this article are under copyright with the following copyright statement: Copyright: © 2016 Nowicka M and Robinson MD</p>
    <p>Data for simulations that mimic real RNA-seq was obtained from Soneson
<italic>et al.</italic>
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>, where all the details on data generation and accessibility are available.</p>
    <p>Differential splicing analyses were performed on the publicly available pasilla dataset, which was downloaded from the NCBI’s Gene Expression Omnibus (GEO) under the accession number GSE18508, and adenocarcinoma dataset under the accession number GSE37764.</p>
    <p>Data for the tuQTL analyses was downloaded from the GEUVADIS project website.</p>
    <p>All the details about data availability and preprocessing are described in the
<xref ref-type="other" rid="SM1">Supplementary Materials</xref>.</p>
    <sec>
      <title>Archived source code as at the time of publication</title>
      <p><italic>DRIMSeq</italic> analyses for this paper were done with version 0.3.3 available on Zenodo
<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/53084">https://zenodo.org/record/53084</ext-link>
<sup><xref rid="ref-61" ref-type="bibr">61</xref></sup> and Bioconductor release 3.2. Source code used for the analyses in this paper is available on Zenodo
<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/167305">https://zenodo.org/record/167305</ext-link>
<sup><xref rid="ref-62" ref-type="bibr">62</xref></sup>.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors wish to thank Magnus Rattray, Torsten Hothorn and members of the Robinson lab for helpful discussions with special acknowledgment for Charlotte Soneson and Lukas Weber for careful reading of the manuscript.</p>
  </ack>
  <sec id="SM1" sec-type="supplementary-material">
    <title>Supplementary material</title>
    <p><bold>Supplementary File 1.</bold> Contains supplementary figures and tables referred to in the text. It also contains descriptions of dispersion moderation and p-value adjustment in tuQTL analysis and details about the simulations and real data analyses.</p>
    <p>
      <supplementary-material content-type="local-data" id="S0">
        <media xlink:href="f1000research-5-11139-s0000.tgz">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>:
<article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2012</year>;<volume>40</volume>(<issue>10</issue>):<fpage>4288</fpage>–<lpage>4297</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id><!--<pub-id pub-id-type="pmcid">3378882</pub-id>--><?supplied-pmid 22287627?><pub-id pub-id-type="pmid">22287627</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>:
<article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data.</article-title><source><italic>Biostatistics.</italic></source><year>2008</year>;<volume>9</volume>(<issue>2</issue>):<fpage>321</fpage>–<lpage>332</lpage>.
<pub-id pub-id-type="doi">10.1093/biostatistics/kxm030</pub-id><?supplied-pmid 17728317?><pub-id pub-id-type="pmid">17728317</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>Differential expression analysis for sequence count data.</article-title><source><italic>Genome Biol.</italic></source><year>2010</year>;<volume>11</volume>(<issue>10</issue>):<fpage>R106</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><!--<pub-id pub-id-type="pmcid">3218662</pub-id>--><?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><etal/></person-group>:
<article-title><italic>Limma</italic> powers differential expression analyses for RNA-sequencing and microarray studies.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><!--<pub-id pub-id-type="pmcid">4402510</pub-id>--><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><etal/></person-group>:
<article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts.</article-title><source><italic>Genome Biol.</italic></source><year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R29</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id><!--<pub-id pub-id-type="pmcid">4053721</pub-id>--><?supplied-pmid 24485249?><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosimann</surname><given-names>JE</given-names></name></person-group>:
<article-title>On the compound multinomial distribution, the multivariate β-distribution, and correlations among proportions.</article-title><source><italic>Biometrika.</italic></source><year>1962</year>;<volume>49</volume>(<issue>1–2</issue>):<fpage>65</fpage>–<lpage>82</lpage>.
<pub-id pub-id-type="doi">10.2307/2333468</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tvedebrink</surname><given-names>T</given-names></name></person-group>:
<article-title>Overdispersion in allelic counts and
<bold>θ</bold>-correction in forensic genetics.</article-title><source><italic>Theor Popul Biol.</italic></source><year>2010</year>;<volume>78</volume>(<issue>3</issue>):<fpage>200</fpage>–<lpage>210</lpage>.
<pub-id pub-id-type="doi">10.1016/j.tpb.2010.07.002</pub-id><?supplied-pmid 20633572?><pub-id pub-id-type="pmid">20633572</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group>:
<article-title>Variable Selection for Sparse Dirichlet-Multinomial Regression With an Application To Microbiome Data Analysis.</article-title><source><italic>Ann Appl Stat.</italic></source><year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>418</fpage>–<lpage>442</lpage>.
<pub-id pub-id-type="doi">10.1214/12-AOAS592</pub-id><!--<pub-id pub-id-type="pmcid">3846354</pub-id>--><?supplied-pmid 24312162?><pub-id pub-id-type="pmid">24312162</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>McDavid</surname><given-names>A</given-names></name><name><surname>Chattopadhyay</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Mixture models for single-cell assays with applications to vaccine studies.</article-title><source><italic>Biostatistics.</italic></source><year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>101</lpage>.
<pub-id pub-id-type="doi">10.1093/biostatistics/kxt024</pub-id><!--<pub-id pub-id-type="pmcid">3862207</pub-id>--><?supplied-pmid 23887981?><pub-id pub-id-type="pmid">23887981</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samb</surname><given-names>R</given-names></name><name><surname>Khadraoui</surname><given-names>K</given-names></name><name><surname>Belleau</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Using informative Multinomial-Dirichlet prior in a t-mixture with reversible jump estimation of nucleosome positions for genome-wide profiling.</article-title><source><italic>Stat Appl Genet Mol Biol.</italic></source><year>2015</year>;<volume>14</volume>(<issue>6</issue>):<fpage>517</fpage>–<lpage>532</lpage>.
<pub-id pub-id-type="doi">10.1515/sagmb-2014-0098</pub-id><?supplied-pmid 26656614?><pub-id pub-id-type="pmid">26656614</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosimann</surname><given-names>JE</given-names></name></person-group>:
<article-title>On the Compound Negative Multinomial Distribution and Correlations Among Inversely Sampled Pollen Counts.</article-title><source><italic>Biometrika.</italic></source><year>1963</year>;<volume>50</volume>(<issue>1–2</issue>):<fpage>47</fpage>–<lpage>54</lpage>.
<pub-id pub-id-type="doi">10.1093/biomet/50.1-2.47</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farewell</surname><given-names>DM</given-names></name><name><surname>Farewell</surname><given-names>VT</given-names></name></person-group>:
<article-title>Dirichlet negative multinomial regression for overdispersed correlated count data.</article-title><source><italic>Biostatistics.</italic></source><year>2013</year>;<volume>14</volume>(<issue>2</issue>):<fpage>395</fpage>–<lpage>404</lpage>.
<pub-id pub-id-type="doi">10.1093/biostatistics/kxs050</pub-id><!--<pub-id pub-id-type="pmcid">3590929</pub-id>--><?supplied-pmid 23221819?><pub-id pub-id-type="pmid">23221819</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>D</given-names></name><name><surname>Xi</surname><given-names>Y</given-names></name><name><surname>Rodriguez</surname><given-names>B</given-names></name><etal/></person-group>:
<article-title>MOABS: model based analysis of bisulfite sequencing data.</article-title><source><italic>Genome Biol.</italic></source><year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R38</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r38</pub-id><!--<pub-id pub-id-type="pmcid">4054608</pub-id>--><?supplied-pmid 24565500?><pub-id pub-id-type="pmid">24565500</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>Y</given-names></name><name><surname>Figueroa</surname><given-names>ME</given-names></name><name><surname>Rozek</surname><given-names>LS</given-names></name><etal/></person-group>:
<article-title>MethylSig: a whole genome DNA methylation analysis pipeline.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>17</issue>):<fpage>2414</fpage>–<lpage>22</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu339</pub-id><!--<pub-id pub-id-type="pmcid">4147891</pub-id>--><?supplied-pmid 24836530?><pub-id pub-id-type="pmid">24836530</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>H</given-names></name><name><surname>Conneely</surname><given-names>KN</given-names></name><name><surname>Wu</surname><given-names>H</given-names></name></person-group>:
<article-title>A Bayesian hierarchical model to detect differentially methylated loci from single nucleotide resolution sequencing data.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2014</year>;<volume>42</volume>(<issue>8</issue>):<fpage>e69</fpage>.
<pub-id pub-id-type="doi">10.1093/nar/gku154</pub-id><!--<pub-id pub-id-type="pmcid">4005660</pub-id>--><?supplied-pmid 24561809?><pub-id pub-id-type="pmid">24561809</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>ET</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Alternative isoform regulation in human tissue transcriptomes.</article-title><source><italic>Nature.</italic></source><year>2008</year>;<volume>456</volume>(<issue>7221</issue>):<fpage>470</fpage>–<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1038/nature07509</pub-id><!--<pub-id pub-id-type="pmcid">2593745</pub-id>--><?supplied-pmid 18978772?><pub-id pub-id-type="pmid">18978772</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>GS</given-names></name><name><surname>Cooper</surname><given-names>TA</given-names></name></person-group>:
<article-title>Splicing in disease: disruption of the splicing code and the decoding machinery.</article-title><source><italic>Nat Rev Genet.</italic></source><year>2007</year>;<volume>8</volume>(<issue>10</issue>):<fpage>749</fpage>–<lpage>61</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2164</pub-id><?supplied-pmid 17726481?><pub-id pub-id-type="pmid">17726481</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tazi</surname><given-names>J</given-names></name><name><surname>Bakkour</surname><given-names>N</given-names></name><name><surname>Stamm</surname><given-names>S</given-names></name></person-group>:
<article-title>Alternative splicing and disease.</article-title><source><italic>Biochim Biophys Acta.</italic></source><year>2009</year>;<volume>1792</volume>(<issue>1</issue>):<fpage>14</fpage>–<lpage>26</lpage>.
<pub-id pub-id-type="doi">10.1016/j.bbadis.2008.09.017</pub-id><?supplied-pmid 18992329?><pub-id pub-id-type="pmid">18992329</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hooper</surname><given-names>JE</given-names></name></person-group>:
<article-title>A survey of software for genome-wide discovery of differential splicing in RNA-Seq data.</article-title><source><italic>Hum Genomics.</italic></source><year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>3</fpage>.
<pub-id pub-id-type="doi">10.1186/1479-7364-8-3</pub-id><!--<pub-id pub-id-type="pmcid">3903050</pub-id>--><?supplied-pmid 24447644?><pub-id pub-id-type="pmid">24447644</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>:
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.</article-title><source><italic>Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>140</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><!--<pub-id pub-id-type="pmcid">2796818</pub-id>--><?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derti</surname><given-names>A</given-names></name><name><surname>Garrett-Engele</surname><given-names>P</given-names></name><name><surname>Macisaac</surname><given-names>KD</given-names></name><etal/></person-group>:
<article-title>A quantitative atlas of polyadenylation in five mammals.</article-title><source><italic>Genome Res.</italic></source><year>2012</year>;<volume>22</volume>(<issue>6</issue>):<fpage>1173</fpage>–<lpage>1183</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.132563.111</pub-id><!--<pub-id pub-id-type="pmcid">3371698</pub-id>--><?supplied-pmid 22454233?><pub-id pub-id-type="pmid">22454233</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alamancos</surname><given-names>GP</given-names></name><name><surname>Agirre</surname><given-names>E</given-names></name><name><surname>Eyras</surname><given-names>E</given-names></name></person-group>:
<article-title>Methods to study splicing from high-throughput RNA sequencing data.</article-title><source><italic>Methods Mol Biol.</italic></source><year>2014</year>;<volume>1126</volume>:<fpage>357</fpage>–<lpage>397</lpage>.
<pub-id pub-id-type="doi">10.1007/978-1-62703-980-2_26</pub-id><?supplied-pmid 24549677?><pub-id pub-id-type="pmid">24549677</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Matthes</surname><given-names>KL</given-names></name><name><surname>Nowicka</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage.</article-title><source><italic>Genome Biol.</italic></source><year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>12</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-015-0862-3</pub-id><!--<pub-id pub-id-type="pmcid">4729156</pub-id>--><?supplied-pmid 26813113?><pub-id pub-id-type="pmid">26813113</pub-id></mixed-citation>
    </ref>
    <ref id="ref-24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name></person-group>:
<article-title>FeatureCounts: an efficient general purpose program for assigning sequence reads to genomic features.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>923</fpage>–<lpage>930</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id><?supplied-pmid 24227677?><pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="ref-25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>A</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>Detecting differential usage of exons from RNA-seq data.</article-title><source><italic>Genome Res.</italic></source><year>2012</year>;<volume>22</volume>(<issue>10</issue>):<fpage>2008</fpage>–<lpage>2017</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id><!--<pub-id pub-id-type="pmcid">3460195</pub-id>--><?supplied-pmid 22722343?><pub-id pub-id-type="pmid">22722343</pub-id></mixed-citation>
    </ref>
    <ref id="ref-26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Pyl</surname><given-names>PT</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>HTSeq--a Python framework to work with high-throughput sequencing data.</article-title><source><italic>Bioinformatics.</italic></source><year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>166</fpage>–<lpage>169</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id><!--<pub-id pub-id-type="pmcid">4287950</pub-id>--><?supplied-pmid 25260700?><pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="ref-27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ongen</surname><given-names>H</given-names></name><name><surname>Dermitzakis</surname><given-names>ET</given-names></name></person-group>:
<article-title>Alternative Splicing QTLs in European and African Populations.</article-title><source><italic>Am J Hum Genet.</italic></source><year>2015</year>;<volume>97</volume>(<issue>4</issue>):<fpage>567</fpage>–<lpage>575</lpage>.
<pub-id pub-id-type="doi">10.1016/j.ajhg.2015.09.004</pub-id><!--<pub-id pub-id-type="pmcid">4596912</pub-id>--><?supplied-pmid 26430802?><pub-id pub-id-type="pmid">26430802</pub-id></mixed-citation>
    </ref>
    <ref id="ref-28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>ET</given-names></name><name><surname>Airoldi</surname><given-names>EM</given-names></name><etal/></person-group>:
<article-title>Analysis and design of RNA sequencing experiments for identifying isoform regulation.</article-title><source><italic>Nat Methods.</italic></source><year>2010</year>;<volume>7</volume>(<issue>12</issue>):<fpage>1009</fpage>–<lpage>1015</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.1528</pub-id><!--<pub-id pub-id-type="pmcid">3037023</pub-id>--><?supplied-pmid 21057496?><pub-id pub-id-type="pmid">21057496</pub-id></mixed-citation>
    </ref>
    <ref id="ref-29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>S</given-names></name><name><surname>Park</surname><given-names>JW</given-names></name><name><surname>Lu</surname><given-names>ZX</given-names></name><etal/></person-group>:
<article-title>rMATS: robust and flexible detection of differential alternative splicing from replicate RNA-Seq data.</article-title><source><italic>Proc Natl Acad Sci U S A.</italic></source><year>2014</year>;<volume>111</volume>(<issue>51</issue>):<fpage>E5593</fpage>–<lpage>601</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.1419161111</pub-id><!--<pub-id pub-id-type="pmcid">4280593</pub-id>--><?supplied-pmid 25480548?><pub-id pub-id-type="pmid">25480548</pub-id></mixed-citation>
    </ref>
    <ref id="ref-30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alamancos</surname><given-names>GP</given-names></name><name><surname>Pagès</surname><given-names>A</given-names></name><name><surname>Trincado</surname><given-names>JL</given-names></name><etal/></person-group>:
<article-title>Leveraging transcript quantification for fast computation of alternative splicing profiles.</article-title><source><italic>RNA.</italic></source><year>2015</year>;<volume>21</volume>(<issue>9</issue>):<fpage>1521</fpage>–<lpage>1531</lpage>.
<pub-id pub-id-type="doi">10.1261/rna.051557.115</pub-id><!--<pub-id pub-id-type="pmcid">4536314</pub-id>--><?supplied-pmid 26179515?><pub-id pub-id-type="pmid">26179515</pub-id></mixed-citation>
    </ref>
    <ref id="ref-31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>LD</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Pau</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>Prediction and Quantification of Splice Events from RNA-Seq Data.</article-title><source><italic>PLoS One.</italic></source><year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0156132</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0156132</pub-id><!--<pub-id pub-id-type="pmcid">4878813</pub-id>--><?supplied-pmid 27218464?><pub-id pub-id-type="pmid">27218464</pub-id></mixed-citation>
    </ref>
    <ref id="ref-32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>K</given-names></name><name><surname>Lu</surname><given-names>ZX</given-names></name><name><surname>Park</surname><given-names>JW</given-names></name><etal/></person-group>:
<article-title>GLiMMPS: Robust statistical model for regulatory variation of alternative splicing using RNA-seq data.</article-title><source><italic>Genome Biol.</italic></source><year>2013</year>;<volume>14</volume>(<issue>7</issue>):<fpage>R74</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2013-14-7-r74</pub-id><!--<pub-id pub-id-type="pmcid">4054007</pub-id>--><?supplied-pmid 23876401?><pub-id pub-id-type="pmid">23876401</pub-id></mixed-citation>
    </ref>
    <ref id="ref-33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>C</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group>:
<article-title>Mapping Splicing Quantitative Trait Loci in RNA-Seq.</article-title><source><italic>Cancer Inform.</italic></source><year>2014</year>;<volume>13</volume>(<issue>Suppl 4</issue>):<fpage>35</fpage>–<lpage>43</lpage>.
<pub-id pub-id-type="doi">10.4137/CIN.S13971</pub-id><!--<pub-id pub-id-type="pmcid">4218654</pub-id>--><?supplied-pmid 25452687?><pub-id pub-id-type="pmid">25452687</pub-id></mixed-citation>
    </ref>
    <ref id="ref-34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Mao</surname><given-names>X</given-names></name><etal/></person-group>:
<article-title>PennSeq: accurate isoform-specific gene expression quantification in RNA-Seq by modeling non-uniform read distribution.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2014</year>;<volume>42</volume>(<issue>3</issue>):<fpage>e20</fpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkt1304</pub-id><!--<pub-id pub-id-type="pmcid">3919567</pub-id>--><?supplied-pmid 24362841?><pub-id pub-id-type="pmid">24362841</pub-id></mixed-citation>
    </ref>
    <ref id="ref-35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monlong</surname><given-names>J</given-names></name><name><surname>Calvo</surname><given-names>M</given-names></name><name><surname>Ferreira</surname><given-names>PG</given-names></name><etal/></person-group>:
<article-title>Identification of genetic variants associated with alternative splicing using sQTLseekeR.</article-title><source><italic>Nat Commun.</italic></source><year>2014</year>;<volume>5</volume>: 4698.
<pub-id pub-id-type="doi">10.1038/ncomms5698</pub-id><!--<pub-id pub-id-type="pmcid">4143934</pub-id>--><?supplied-pmid 25140736?><pub-id pub-id-type="pmid">25140736</pub-id></mixed-citation>
    </ref>
    <ref id="ref-36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaus</surname><given-names>P</given-names></name><name><surname>Honkela</surname><given-names>A</given-names></name><name><surname>Rattray</surname><given-names>M</given-names></name></person-group>:
<article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation.</article-title><source><italic>Bioinformatics.</italic></source><year>2012</year>;<volume>28</volume>(<issue>13</issue>):<fpage>1721</fpage>–<lpage>1728</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id><!--<pub-id pub-id-type="pmcid">3381971</pub-id>--><?supplied-pmid 22563066?><pub-id pub-id-type="pmid">22563066</pub-id></mixed-citation>
    </ref>
    <ref id="ref-37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossell</surname><given-names>D</given-names></name><name><surname>Stephan-Otto Attolini</surname><given-names>C</given-names></name><name><surname>Kroiss</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Quantifying Alternative Splicing From Paired-End RNA-Sequencing Data.</article-title><source><italic>Ann Appl Stat.</italic></source><year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>309</fpage>–<lpage>330</lpage>.
<pub-id pub-id-type="doi">10.1214/13-AOAS687</pub-id><!--<pub-id pub-id-type="pmcid">4005600</pub-id>--><?supplied-pmid 24795787?><pub-id pub-id-type="pmid">24795787</pub-id></mixed-citation>
    </ref>
    <ref id="ref-38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>511</fpage>–<lpage>515</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id><!--<pub-id pub-id-type="pmcid">3146043</pub-id>--><?supplied-pmid 20436464?><pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="ref-39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Dewey</surname><given-names>CN</given-names></name></person-group>:
<article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2011</year>;<volume>12</volume>:<fpage>323</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><!--<pub-id pub-id-type="pmcid">3163565</pub-id>--><?supplied-pmid 21816040?><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="ref-40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernard</surname><given-names>E</given-names></name><name><surname>Jacob</surname><given-names>L</given-names></name><name><surname>Mairal</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Efficient RNA isoform identification and quantification from RNA-Seq data with network flows.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>17</issue>):<fpage>2447</fpage>–<lpage>2455</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu317</pub-id><!--<pub-id pub-id-type="pmcid">4147886</pub-id>--><?supplied-pmid 24813214?><pub-id pub-id-type="pmid">24813214</pub-id></mixed-citation>
    </ref>
    <ref id="ref-41">
      <label>41</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patro</surname><given-names>R</given-names></name><name><surname>Mount</surname><given-names>SM</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group>:
<article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2014</year>;<volume>32</volume>(<issue>5</issue>):<fpage>462</fpage>–<lpage>4</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.2862</pub-id><!--<pub-id pub-id-type="pmcid">4077321</pub-id>--><?supplied-pmid 24752080?><pub-id pub-id-type="pmid">24752080</pub-id></mixed-citation>
    </ref>
    <ref id="ref-42">
      <label>42</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Near-optimal probabilistic RNA-seq quantification.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2016</year>;<volume>34</volume>(<issue>5</issue>):<fpage>525</fpage>–<lpage>7</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id><?supplied-pmid 27043002?><pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="ref-43">
      <label>43</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patro</surname><given-names>R</given-names></name><name><surname>Duggal</surname><given-names>G</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group>:
<article-title>Salmon: Accurate, Versatile and Ultrafast Quantification from RNA-seq Data using Lightweight-Alignment.</article-title><source><italic>bioRxiv.</italic></source><year>2015</year>;<fpage>021592</fpage><pub-id pub-id-type="doi">10.1101/021592</pub-id></mixed-citation>
    </ref>
    <ref id="ref-44">
      <label>44</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanitz</surname><given-names>A</given-names></name><name><surname>Gypas</surname><given-names>F</given-names></name><name><surname>Gruber</surname><given-names>AJ</given-names></name><etal/></person-group>:
<article-title>Comparative assessment of methods for the computational inference of transcript isoform abundance from RNA-seq data.</article-title><source><italic>Genome Biol.</italic></source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>150</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-015-0702-5</pub-id><!--<pub-id pub-id-type="pmcid">4511015</pub-id>--><?supplied-pmid 26201343?><pub-id pub-id-type="pmid">26201343</pub-id></mixed-citation>
    </ref>
    <ref id="ref-45">
      <label>45</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teng</surname><given-names>M</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><etal/></person-group>:
<article-title>A benchmark for RNA-seq quantification pipelines.</article-title><source><italic>Genome Biol.</italic></source><year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>74</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-016-0940-1</pub-id><!--<pub-id pub-id-type="pmcid">4842274</pub-id>--><?supplied-pmid 27107712?><pub-id pub-id-type="pmid">27107712</pub-id></mixed-citation>
    </ref>
    <ref id="ref-46">
      <label>46</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lappalainen</surname><given-names>T</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Friedländer</surname><given-names>MR</given-names></name><etal/></person-group>:
<article-title>Transcriptome and genome sequencing uncovers functional variation in humans.</article-title><source><italic>Nature.</italic></source><year>2013</year>;<volume>501</volume>(<issue>7468</issue>):<fpage>506</fpage>–<lpage>11</lpage>.
<pub-id pub-id-type="doi">10.1038/nature12531</pub-id><!--<pub-id pub-id-type="pmcid">3918453</pub-id>--><?supplied-pmid 24037378?><pub-id pub-id-type="pmid">24037378</pub-id></mixed-citation>
    </ref>
    <ref id="ref-47">
      <label>47</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battle</surname><given-names>A</given-names></name><name><surname>Mostafavi</surname><given-names>S</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><etal/></person-group>:
<article-title>Characterizing the genetic basis of transcriptome diversity through RNA-sequencing of 922 individuals.</article-title><source><italic>Genome Res.</italic></source><year>2014</year>;<volume>24</volume>(<issue>1</issue>):<fpage>14</fpage>–<lpage>24</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.155192.113</pub-id><!--<pub-id pub-id-type="pmcid">3875855</pub-id>--><?supplied-pmid 24092820?><pub-id pub-id-type="pmid">24092820</pub-id></mixed-citation>
    </ref>
    <ref id="ref-48">
      <label>48</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pickrell</surname><given-names>JK</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Pai</surname><given-names>AA</given-names></name><etal/></person-group>:
<article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing.</article-title><source><italic>Nature.</italic></source><year>2010</year>;<volume>464</volume>(<issue>7289</issue>):<fpage>768</fpage>–<lpage>772</lpage>.
<pub-id pub-id-type="doi">10.1038/nature08872</pub-id><!--<pub-id pub-id-type="pmcid">3089435</pub-id>--><?supplied-pmid 20220758?><pub-id pub-id-type="pmid">20220758</pub-id></mixed-citation>
    </ref>
    <ref id="ref-49">
      <label>49</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montgomery</surname><given-names>SB</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Gutierrez-Arcelus</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Transcriptome genetics using second generation sequencing in a Caucasian population.</article-title><source><italic>Nature.</italic></source><year>2010</year>;<volume>464</volume>(<issue>7289</issue>):<fpage>773</fpage>–<lpage>777</lpage>.
<pub-id pub-id-type="doi">10.1038/nature08903</pub-id><!--<pub-id pub-id-type="pmcid">3836232</pub-id>--><?supplied-pmid 20220756?><pub-id pub-id-type="pmid">20220756</pub-id></mixed-citation>
    </ref>
    <ref id="ref-50">
      <label>50</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ongen</surname><given-names>H</given-names></name><name><surname>Buil</surname><given-names>A</given-names></name><name><surname>Brown</surname><given-names>AA</given-names></name><etal/></person-group>:
<article-title>Fast and efficient QTL mapper for thousands of molecular phenotypes.</article-title><source><italic>Bioinformatics.</italic></source><year>2016</year>;<volume>32</volume>(<issue>10</issue>):<fpage>1479</fpage>–<lpage>85</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btv722</pub-id><!--<pub-id pub-id-type="pmcid">4866519</pub-id>--><?supplied-pmid 26708335?><pub-id pub-id-type="pmid">26708335</pub-id></mixed-citation>
    </ref>
    <ref id="ref-51">
      <label>51</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Hendrickson</surname><given-names>DG</given-names></name><name><surname>Sauvageau</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2013</year>;<volume>31</volume>(<issue>1</issue>):<fpage>46</fpage>–<lpage>53</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id><!--<pub-id pub-id-type="pmcid">3869392</pub-id>--><?supplied-pmid 23222703?><pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="ref-52">
      <label>52</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>YI</given-names></name><name><surname>Knowles</surname><given-names>DA</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group>:
<article-title>LeafCutter: Annotation-free quantification of RNA splicing.</article-title><source><italic>bioRxiv.</italic></source><year>2016</year><pub-id pub-id-type="doi">10.1101/044107</pub-id></mixed-citation>
    </ref>
    <ref id="ref-53">
      <label>53</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>:
<article-title>Moderated statistical tests for assessing differences in tag abundance.</article-title><source><italic>Bioinformatics.</italic></source><year>2007</year>;<volume>23</volume>(<issue>21</issue>):<fpage>2881</fpage>–<lpage>2887</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id><?supplied-pmid 17881408?><pub-id pub-id-type="pmid">17881408</pub-id></mixed-citation>
    </ref>
    <ref id="ref-54">
      <label>54</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Reid</surname><given-names>N</given-names></name><name><surname>Fraser</surname><given-names>DAS</given-names></name></person-group>:
<article-title>Likelihood inference in the presence of nuisance parameters</article-title>.<year>2003</year>;<fpage>7</fpage><ext-link ext-link-type="uri" xlink:href="http://www.utstat.utoronto.ca/reid/research/slacpaper.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-55">
      <label>55</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCullagh</surname><given-names>P</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group>:
<article-title>A Simple Method for the Adjustment of Profile Likelihoods.</article-title><source><italic>J R Stat Soc Series B Stat Methodol.</italic></source><year>1990</year>;<volume>52</volume>(<issue>2</issue>):<fpage>325</fpage>–<lpage>344</lpage>.
<ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2345439?seq=1#page_scan_tab_contents">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-56">
      <label>56</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>DR</given-names></name><name><surname>Reid</surname><given-names>N</given-names></name></person-group>:
<article-title>Parameter orthogonality and approximate conditional inference.</article-title><source><italic>J R Stat Soc Series B Stat Methodol.</italic></source><year>1987</year>;<volume>49</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>39</lpage>.
<ext-link ext-link-type="uri" xlink:href="http://www.yaroslavvb.com/papers/cox-parameter.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-57">
      <label>57</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>JK</given-names></name><name><surname>Kim</surname><given-names>YJ</given-names></name></person-group>:
<article-title>Intrinsic variability of gene expression encoded in nucleosome positioning sequences.</article-title><source><italic>Nat Genet.</italic></source><year>2009</year>;<volume>41</volume>(<issue>4</issue>):<fpage>498</fpage>–<lpage>503</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.319</pub-id><?supplied-pmid 19252489?><pub-id pub-id-type="pmid">19252489</pub-id></mixed-citation>
    </ref>
    <ref id="ref-58">
      <label>58</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>A</given-names></name><name><surname>Soltani</surname><given-names>M</given-names></name></person-group>:
<article-title>Quantifying intrinsic and extrinsic variability in stochastic gene expression models.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e84301</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0084301</pub-id><!--<pub-id pub-id-type="pmcid">3877255</pub-id>--><?supplied-pmid 24391934?><pub-id pub-id-type="pmid">24391934</pub-id></mixed-citation>
    </ref>
    <ref id="ref-59">
      <label>59</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname><given-names>AN</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Duff</surname><given-names>MO</given-names></name><etal/></person-group>:
<article-title>Conservation of an RNA regulatory map between
<italic>Drosophila</italic> and mammals.</article-title><source><italic>Genome Res.</italic></source><year>2011</year>;<volume>21</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>202</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.108662.110</pub-id><!--<pub-id pub-id-type="pmcid">3032923</pub-id>--><?supplied-pmid 20921232?><pub-id pub-id-type="pmid">20921232</pub-id></mixed-citation>
    </ref>
    <ref id="ref-60">
      <label>60</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SC</given-names></name><name><surname>Jung</surname><given-names>Y</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>A high-dimensional, deep-sequencing study of lung adenocarcinoma in female never-smokers.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>2</issue>):<fpage>e55596</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0055596</pub-id><!--<pub-id pub-id-type="pmcid">3566005</pub-id>--><?supplied-pmid 23405175?><pub-id pub-id-type="pmid">23405175</pub-id></mixed-citation>
    </ref>
    <ref id="ref-61">
      <label>61</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Nowicka</surname><given-names>M</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Source code of the R package used for analyses in "DRIMSeq: a Dirichlet-multinomial framework for multivariate count outcomes in genomics" paper.</article-title><source><italic>Zenodo.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/53084">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-62">
      <label>62</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Nowicka</surname><given-names>M</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Source code of the analyses in the "DRIMSeq: a Dirichlet-multinomial framework for multivariate count outcomes in genomics” paper.</article-title><source><italic>Zenodo.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/167305">Data Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report18253" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.11139.r18253</article-id>
    <title-group>
      <article-title>Referee response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Castelo</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="r18253a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r18253a1"><label>1</label>Department of Experimental and Health Sciences, Pompeu Fabra University, Barcelona, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e6991" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.8900.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>I appreciate that the authors have made an effort to address my comments and I'm particularly happy to see that my suggestion to check the overlap of tuQTLs with splice site binding sites reveals an improved enrichment by DRIMSeq. I also understand now the decision you took about not using the 'SummarizedExperiment' class. For the future development of DRIMSeq you may want to consider using the MultiAssayExperiment class (
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/MultiAssayExperiment">http://bioconductor.org/packages/MultiAssayExperiment</ext-link>) that allows multiple assay types over multiple sample sets.</p>
    <p> The authors say that it is not worth made a comparison with Cufdiff because in the study by Soneson
<sup>1</sup>
<italic>et al.</italic> (2016), where both authors of DRIMSeq were involved, Cudiff was very conservative in detecting differential isoform/transcript usage (DTU). In that paper the authors assess DTU by switching the two most abundant isoforms and show that Cufdiff has a low true positive rate (TPR) at small magnitudes of the difference in relative abundance between the two most abundant isoforms per gene. However, in Supplementary Figure 10 of that paper, the authors show that at larger magnitudes of that difference, the TPR of Cufdiff improves substantially while correctly controlling the false discovery rate (FDR).</p>
    <p> In this paper the authors assess DTU following the same strategy of switching the two most abundant isoforms and I think it would be again very interesting to see how Cufdiff and DRIMSeq compare at different magnitudes of the change in isoform usage. The authors also argue that Frazee
<sup>2</sup>
<italic> et al.</italic> (2014) find that Cuffdiff is very conservative. However, as far as I understand that paper, Frazee and co-workers are not evaluating DTU but differential transcript expression (DTE), and therefore, in my view, the experiments conducted on that paper do not warrant the conclusion that Cufdiff is overly conservative for DTU.</p>
    <p> The authors decided not to perform an enrichment analysis of tuQTLs on ESEs and ESSs because Lalonde
<sup>3</sup>
<italic>et al.</italic> (2011) concluded that ESE predictions themselves are a poor indicator of the effect of SNPs on splicing patterns. However, Lalonde and co-workers scored ESE motifs with ESEfinder 3.0 (Cartegni
<sup>4</sup>
<italic>et al.</italic> 2003), a method based on SELEX experiments conducted about 10 years ago and I would expect some advance in this field in the last decade. A recent study that seems to successfully use more recent ESE and ESS data to assess their enrichment with respect to polymorphisms is Supek
<sup>4</sup>
<italic>et al.</italic> (2014).</p>
    <p> While these two aspects remain, in my opinion, open, I think the statistical model of DRIMSeq proposed for DTU makes a lot sense and people interested in addressing biological questions that involve DTU should give it try, and I'm happy to approve the paper.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-18253-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Matthes</surname><given-names>KL</given-names></name><name><surname>Nowicka</surname><given-names>M</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage.</article-title><source><italic>Genome Biol</italic></source>.<year>2016</year>;<volume>17</volume>:
<elocation-id>10.1186/s13059-015-0862-3</elocation-id><fpage>12</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0862-3</pub-id><?supplied-pmid 26813113?><pub-id pub-id-type="pmid">26813233</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-18253-2">
        <label>2</label>
        <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Frazee</surname><given-names>AC</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><name><surname>Leek</surname><given-names>JT</given-names></name></person-group>:
<article-title>Flexible isoform-level differential expression analysis with Ballgown</article-title>.
<source><italic>bioRxiv</italic></source>.<year>2014</year>;
<elocation-id>https://doi.org/10.1101/003665</elocation-id><fpage>003665</fpage><pub-id pub-id-type="doi">10.1101/003665</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-18253-3">
        <label>3</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lalonde</surname><given-names>E</given-names></name><name><surname>Ha</surname><given-names>KC</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Bemmo</surname><given-names>A</given-names></name><name><surname>Kleinman</surname><given-names>CL</given-names></name><name><surname>Kwan</surname><given-names>T</given-names></name><name><surname>Pastinen</surname><given-names>T</given-names></name><name><surname>Majewski</surname><given-names>J</given-names></name></person-group>:
<article-title>RNA sequencing reveals the role of splicing polymorphisms in regulating human gene expression.</article-title><source><italic>Genome Res</italic></source>.<year>2011</year>;<volume>21</volume>(<issue>4</issue>) :
<elocation-id>10.1101/gr.111211.110</elocation-id><fpage>545</fpage>-<lpage>54</lpage><pub-id pub-id-type="doi">10.1101/gr.111211.110</pub-id><?supplied-pmid 21173033?><pub-id pub-id-type="pmid">21173033</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-18253-4">
        <label>4</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Supek</surname><given-names>F</given-names></name><name><surname>Miñana</surname><given-names>B</given-names></name><name><surname>Valcárcel</surname><given-names>J</given-names></name><name><surname>Gabaldón</surname><given-names>T</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group>:
<article-title>Synonymous mutations frequently act as driver mutations in human cancers.</article-title><source><italic>Cell</italic></source>.<year>2014</year>;<volume>156</volume>(<issue>6</issue>) :
<elocation-id>10.1016/j.cell.2014.01.051</elocation-id><fpage>1324</fpage>-<lpage>35</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.01.051</pub-id><?supplied-pmid 24630730?><pub-id pub-id-type="pmid">24630730</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
</sub-article>
<sub-article id="report14580" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.9577.r14580</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Castelo</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="r14580a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r14580a1"><label>1</label>Department of Experimental and Health Sciences, Pompeu Fabra University, Barcelona, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e7352" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.8900.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This article introduces a new statistical method, called DRIMSeq and implemented in a R/Bioconductor
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/DRIMSeq">package</ext-link> of the same name, to detect isoform expression changes between two conditions from RNA-seq data. The same method can be used to search for significant associations between SNPs and isoform quantifications obtained also from RNA-seq data (sQTLs).  The main novelty of this method with respect to the existing literature on this problem, is the joint modelling of transcript quantification values derived from isoforms of the same gene, by using a Dirichlet-multinomial model. This allows the method to account of the intrinsic dependency between quantification values of these isoforms.</p>
    <p> The assessment of DRIMSeq on differential isoform usage provides a comparison of its performance with DEXSeq
<sup><xref rid="rep-ref-14580-1" ref-type="bibr">1</xref></sup>, a statistical method for differential exon inclusion from RNA-seq data, as function of two different "isoform" quantification strategies: exonic-bin (not really "isoform") count values calculated with HTSeq and transcript-quantification values calculated with kallisto
<sup><xref rid="rep-ref-14580-2" ref-type="bibr">2</xref></sup>.</p>
    <p> The experimental results make perfect sense, DRIMSeq works better than DEXSeq with transcript-quantification values and DEXSeq works better than DRIMSeq with exonic-bin count values. However, while both methods, and both types of "isoform" quantification input data, allow one to study the post-transcriptional processing of RNA transcripts, the kind of questions that can be addressed with each of them are different. Exonic-bin count values and DEXSeq can be used to investigate differential exon inclusion across conditions, which is a consequence of differential isoform usage, while transcript-quantification values and DRIMSeq can be used to directly investigate differential isoform usage.</p>
    <p> A potentially interesting outcome of this comparison in the paper could be some sort of guidelines about when is it more sensible to investigate differential exon inclusion or differential isoform usage, depending on factors such as the biological question at hand, sequencing depth or number of biological replicates. However, this is apparently beyond the scope of this paper and the experimental results are in principle geared towards convincing the reader that DRIMSeq improves on existing approaches to discover changes in isoform usage, as suggested in the abstract. In my view, the experimental results do not address this question and I would suggest the authors to compare DRIMSeq with methods that also work with transcript-quantification values and assess differential isoform usage such as, for instance, Cuffdiff
<sup><xref rid="rep-ref-14580-3" ref-type="bibr">3</xref></sup> or sleuth
<sup><xref rid="rep-ref-14580-4" ref-type="bibr">4</xref></sup>.</p>
    <p> The experimental results on searching for sQTLs compare favourably DRIMSeq with an existing tool for that purpose, sQTLseekR
<sup><xref rid="rep-ref-14580-5" ref-type="bibr">5</xref></sup>. Evaluating performance in this context is challenging and the idea of assessing enrichment with respect to splicing-related features is a good one. However, the (two) presented features in Table 1 could be made more precise. It is unclear that a SNP close to a GWAS hit should be necessarily related to splicing and it is also unclear why one should expect splicing-related enrichment more than a few hundred nucleotides away from the intervening exon. While it is technically interesting to see a method being used to address two completely different research questions, in my view, mixing both types of analyses makes the article less focused. I would argue that both questions deserve separate papers, and that would allow the authors to investigate in depth critical aspects of both types of analysis that are currently not addressed in the current article.</p>
    <p> In summary, this article provides an interesting new methodology for the analysis of differential isoform usage from RNA-seq data, it is well-written and the implemented software runs smoothly and is well documented. However, in my view, the current experimental results of the article are not that informative for the reader to learn what advantages DRIMSeq provides over other tools for differential isoform usage analysis, and to decide whether he/she should be doing a differential isoform usage, or a differential exon inclusion analysis, if this were a goal of the comparison with DEXSeq.</p>
    <p> Minor comments:
<list list-type="order"><list-item><p>I would replace the term "edgeR ideology" in page 5 by "edgeR strategy".</p></list-item><list-item><p>In page 9 it is described that the distributions of raw p-values shown in Supplementary Figures S28 and S29 fit "better" when derived from transcript quantification values than from exonic-bin count values, but in fact in both cases the distributions are non-uniform for p-values distributed under the null hypothesis. This can be easily shown with the data from vignette of the DRIMSeq package when skipping the step that reduces the transcript set to analyze to speed up the building time of the vignette. This is not openly discussed in the paper but I would argue that it is quite critical to know under what technical assumptions the proposed hypothesis test leads to uniform raw p-values under the null, as this has a direct consequence on the control of the probability of the type-I error.</p></list-item><list-item><p>The sQTL analysis described in pages 9, 10 and 11 uses transcript-quantification values from FluxCapacitor. If the entire first part of the paper shows the performance metrics of DRIMSeq using kallisto, in my view, it would make more sense to use kallisto for this analysis as well.</p></list-item><list-item><p>With regard to the implementation in the R/Bioconductor software package DRIMSeq, the authors have implemented a specialized S4 object class called 'dmDSdata' to act as a container for counts and information about samples.  Since the package forms part of the Bioconductor project, I think it would better for both, the end-user and the developer authors, that the package re-uses the 'SummarizedExperiment' class as container for counts and sample information. This would facilitate the integration of DRIMSeq into existing or new workflows for the analysis of RNA-seq data. As an example of the limitations derived from providing a completely new specialized object class, the dimensions of a 'dmDSdata' object in terms of number of features and number of samples cannot be figured out using the expected call to the 'dim()' accessor method. Of course the authors may add that method to the 'dmDSdata' object class but, in general, there are obvious advantages derived from enabling data interoperability through the use of common data structures across Bioconductor software packages
<sup><xref rid="rep-ref-14580-6" ref-type="bibr">6</xref></sup>.</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-14580-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>A</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>Detecting differential usage of exons from RNA-seq data.</article-title><source><italic>Genome Res</italic></source>.<year>2012</year>;<volume>22</volume>(<issue>10</issue>) :
<elocation-id>10.1101/gr.133744.111</elocation-id><fpage>2008</fpage>-<lpage>17</lpage><pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id><?supplied-pmid 22722343?><pub-id pub-id-type="pmid">22722343</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-14580-2">
        <label>2</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group>:
<article-title>Near-optimal probabilistic RNA-seq quantification.</article-title><source><italic>Nat Biotechnol</italic></source>.<year>2016</year>;<volume>34</volume>(<issue>5</issue>) :
<elocation-id>10.1038/nbt.3519</elocation-id><fpage>525</fpage>-<lpage>7</lpage><pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id><?supplied-pmid 27043002?><pub-id pub-id-type="pmid">26744963</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-14580-3">
        <label>3</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Hendrickson</surname><given-names>DG</given-names></name><name><surname>Sauvageau</surname><given-names>M</given-names></name><name><surname>Goff</surname><given-names>L</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group>:
<article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq.</article-title><source><italic>Nat Biotechnol</italic></source>.<year>2013</year>;<volume>31</volume>(<issue>1</issue>) :
<elocation-id>10.1038/nbt.2450</elocation-id><fpage>46</fpage>-<lpage>53</lpage><pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id><?supplied-pmid 23222703?><pub-id pub-id-type="pmid">23302918</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-14580-4">
        <label>4</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pimentel</surname><given-names>H</given-names></name></person-group>:
<article-title>Differential analysis of RNA-Seq incorporating quantification uncertainty</article-title>.
<source><italic>bioRxiv</italic></source>.<year>2016</year>;<volume>058164</volume>:
<elocation-id>10.1101/058164</elocation-id><pub-id pub-id-type="doi">10.1101/058164</pub-id><ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2016/06/10/058164">Reference source</ext-link></mixed-citation>
      </ref>
      <ref id="rep-ref-14580-5">
        <label>5</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monlong</surname><given-names>J</given-names></name><name><surname>Calvo</surname><given-names>M</given-names></name><name><surname>Ferreira</surname><given-names>PG</given-names></name><name><surname>Guigó</surname><given-names>R</given-names></name></person-group>:
<article-title>Identification of genetic variants associated with alternative splicing using sQTLseekeR.</article-title><source><italic>Nat Commun</italic></source>.<year>2014</year>;<volume>5</volume>:
<elocation-id>10.1038/ncomms5698</elocation-id><fpage>4698</fpage><pub-id pub-id-type="doi">10.1038/ncomms5698</pub-id><?supplied-pmid 25140736?><pub-id pub-id-type="pmid">25140736</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-14580-6">
        <label>6</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Carlson</surname><given-names>M</given-names></name><name><surname>Carvalho</surname><given-names>BS</given-names></name><name><surname>Bravo</surname><given-names>HC</given-names></name><name><surname>Davis</surname><given-names>S</given-names></name><name><surname>Gatto</surname><given-names>L</given-names></name><name><surname>Girke</surname><given-names>T</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name><name><surname>Hahne</surname><given-names>F</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>MacDonald</surname><given-names>J</given-names></name><name><surname>Obenchain</surname><given-names>V</given-names></name><name><surname>Oleś</surname><given-names>AK</given-names></name><name><surname>Pagès</surname><given-names>H</given-names></name><name><surname>Reyes</surname><given-names>A</given-names></name><name><surname>Shannon</surname><given-names>P</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Tenenbaum</surname><given-names>D</given-names></name><name><surname>Waldron</surname><given-names>L</given-names></name><name><surname>Morgan</surname><given-names>M</given-names></name></person-group>:
<article-title>Orchestrating high-throughput genomic analysis with Bioconductor.</article-title><source><italic>Nat Methods</italic></source>.<year>2015</year>;<volume>12</volume>(<issue>2</issue>) :
<elocation-id>10.1038/nmeth.3252</elocation-id><fpage>115</fpage>-<lpage>21</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id><?supplied-pmid 25633503?><pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment2320" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>Mark</given-names>
          </name>
          <aff>University of Zurich, Switzerland</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>25</day>
        <month>11</month>
        <year>2016</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for taking the time to read and review our paper.</p>
      <p><italic>DEXSeq</italic> is a package designed for the differential exon usage (DEU) and returns exon-level p-values, which can be also summarized to the gene level. In principle,
<italic>DEXSeq</italic>’s implementation could be used to address the question of differential isoform/transcript usage (DTU) as well, which was done, for example, in the simulation study by Soneson
<italic>et al.</italic> [1]. They use different counting strategies, among them transcript quantifications from
<italic>kallisto</italic> [2], coupled with
<italic>DEXSeq</italic>’s differential engine to detect differential transcript usage.
<italic>DRIMSeq</italic>, based on the Dirichlet-multinomial model, was developed to detect differential usage of any kind of multivariate genomic features at the gene-level. Thus potentially, both
<italic>DEXSeq</italic> and
<italic>DRIMSeq</italic> can be applied to exon counts and to transcript quantifications. However, from our comparisons, which were performed at the gene-level, the performance of
<italic>DEXSeq</italic> and
<italic>DRIMSeq</italic> is different on these different types of counts.
<italic>DEXSeq</italic> performs better on exon counts and
<italic>DRIMSeq</italic> on transcript counts.</p>
      <p> We have not used
<italic>Cuffdiff</italic> [3] in our comparisons here because in the study by Soneson
<italic>et al.</italic> [1], it performed poorly compared to
<italic>DEXSeq</italic>. In particular,
<italic>Cuffdiff</italic> was very conservative having low false discovery rate (FDR) at the cost of very low power for detecting DTU. The conservative nature of
<italic>Cuffdiff</italic> for differential transcript expression, was also pointed out by Frazee
<italic>et al.</italic> [4]. We decided to compare
<italic>DRIMSeq</italic> only to the top performing method,
<italic>DEXSeq</italic>. The other tool proposed by the Reviewer, sleuth [5], is meant for differential transcript expression analyses, not DTU.</p>
      <p> The scope of this paper was not to justify exon or transcript level analysis, for that one could refer to the comparison paper by Hooper [6], but to propose a methodologically-sound tool for differential isoform usage analysis or detect transcript usage QTLs based on transcript quantifications. We propose to use
<italic>DRIMSeq</italic> since it outperformed
<italic>DEXSeq</italic> in this type of analysis and there are no other tools for differential transcript usage that were intended for transcript level quantifications from the latest generation of fast quantification tools, such as
<italic> kallisto</italic> [2] or
<italic>Salmon</italic> [7].</p>
      <p> Importantly,
<italic>DEXSeq</italic> returns p-values per feature (exon or transcript), which can be also summarized to the gene level.
<italic>DRIMSeq</italic> performs gene-level tests and returns p-values per gene only. When the interest is in detecting specific exons or isoforms that change, one should use
<italic>DEXSeq</italic> because currently
<italic>DRIMSeq</italic> does not provide any post hoc analysis (although in many cases, the relevant information can be deduced from looking at the relative transcript expression from
<italic>DRIMSeq</italic>’s plots). We have not investigated the differences in performance due to sequencing depth or number of biological replicates, but we believe that the requirements would be basically the same in these terms for both of the methods. What matters is the completeness of annotation. Detecting DTU based on exon counts is generally more robust than that based on transcript quantifications when the annotation is incomplete, which was investigated in detail by Soneson
<italic>et al.</italic> [1].</p>
      <p> To compare the performance of
<italic>DRIMSeq</italic> and
<italic>sQTLseekeR</italic>, we use the splicing-related features that were also used in the
<italic>sQTLseekeR</italic> paper [8] to compare
<italic>sQTLseekeR</italic> against other methods. The Reviewer suggested to consider other splicing-related features, such as exonic splicing enhancers (ESEs), exonic splicing silencers (ESSs) and splice sites. We have added the frequency of tuQTL overlapping with the splice sites to Table 1. However, we have not performed analyses on ESEs and ESSs since Lalonde
<italic>et al.</italic> [9] concluded from their study that "ESE predictions themselves are a poor indicator of the effect of SNPs on splicing patterns".</p>
      <p> By addressing differential splicing and sQTLs in one paper, our aim was to show that methods used for these analyses are based on statistical approaches that in the end tackle ultimately the same question: differential splicing between conditions. Both analyses employ the same methods for gene feature quantification and potentially one main differential engine could be used with slight analysis- specific adjustments, such as information sharing between genes for small sample size data or using genotypes as grouping factor, which is done in
<italic>DRIMSeq</italic>. We believe we have addressed in sufficient depth aspects of both of these analyses providing comparisons on simulated and real data.</p>
      <p> Addressing the minor comments:
<list list-type="bullet"><list-item><p>We have replaced the term "edgeR ideology" in page 5 by "edgeR strategy".</p></list-item><list-item><p>As suggested, we have investigated in more depth, based on simulations from the DM model, the
<italic>DRIMSeq </italic>p-value distributions under the null hypothesis of no differential transcript usage (Figures 1, S4, S6, S11, S14). Overall, using the Cox-Reid adjusted profile likelihood and the dispersion moderation leads to p-value distributions that in most cases are closer to the uniform distribution (Figures 1D, S4 and S11). The better fit of the DM model to transcript counts in comparison to exon counts can be seen in Figure S14, where the p-value distributions are more uniform for simulations that mimic
<italic>kallisto</italic> counts than for simulations that mimic
<italic>HTseq</italic> counts.</p></list-item><list-item><p>Yes, using
<italic>kallisto</italic> counts would be more consistent with the rest of our manuscript. Nevertheless, we decided to to use the Flux Capacitor counts because they were already available on the GEUVADIS project website and have been used extensively in other projects, for example, in the sQTLseekeR paper. Moreover, we think that using other counts should not affect the comparison between DRIMSeq and sQTLseekeR.</p></list-item><list-item><p>We had already considered the SummarizedExperiment class while developing the DRIMSeq package. However, it does not provide features and functionality that we need for storing the count data and DRIMSeq results. In particular, the dimensions of Assays in SummarizedExperiment must be the same. That is not the case for us for two reasons. Firstly, each gene has multiple transcripts and, for example, the table with proportion estimates per transcript is larger than a table with dispersion estimates which are available per gene. Second, in the QTL analysis, table with transcript counts has different dimensions than table with genotypes. Additionally, we use matrices instead of data frames to store our data because the former occupies less space. Specifically, we have created a class called MatrixList, which is adjusted to store data where each gene has multiple features quantified and allows a quick access to these counts in per gene basis. We have not implemented the dim() method on dmDSdata or dmSQTLdata because we want to keep consistency between them and, for example, dmSQTLdata contains transcript counts and genotypes which have different dimensions. Thus we decided to make the dim() methods available for the counts and genotypes slots in these classes but not for the classes themselves.</p></list-item></list>
</p>
      <p> References</p>
      <p> [1]  Charlotte Soneson, Katarina L Matthes, Malgorzata Nowicka, Charity W Law, and Mark D Robinson. Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage. Genome Biology, 17(1):1–15, 2016.</p>
      <p> [2]  Nicolas L Bray, Harold Pimentel, Pall Melsted, and Lior Pachter. Near-optimal probabilistic RNA-seq quantification. Nat Biotech, advance on, Apr 2016.</p>
      <p> [3]  Cole Trapnell, David G Hendrickson, Martin Sauvageau, Loyal Goff, John L Rinn, and Lior Pachter. Differential analysis of gene regulation at transcript resolution with RNA-seq. Nature biotechnology, 31(1):46–53, 2013.</p>
      <p> [4]  A. C. Frazee, G. Pertea, a. E. Jaffe, B. Langmead, S. L. Salzberg, and J. T. Leek. Flexible isoform-level differential expression analysis with Ballgown. bioRxiv, pages 0–13, 2014.</p>
      <p> [5]  Harold J Pimentel, Nicolas Bray, Suzette Puente, Páll Melsted, and Lior Pachter. Differential analysis of RNA-Seq incorporating quantification uncertainty. bioRxiv, Jun 2016.</p>
      <p> [6]  Joan E Hooper. A survey of software for genome-wide discovery of differential splicing in RNA-Seq data. Human genomics, 8:3, 2014.</p>
      <p> [7]  Rob Patro, Geet Duggal, and Carl Kingsford. Salmon: Accurate, Versatile and Ultrafast Quantification from RNA-seq Data using Lightweight-Alignment. bioRxiv, page 021592, 2015.</p>
      <p> [8]  Jean Monlong, Miquel Calvo, Pedro G. Ferreira, and Roderic Guigó. Identification of genetic variants associated with alternative splicing using sQTLseekeR. Nature Communications, 5(May):4698, Aug 2014.</p>
      <p> [9]  Emilie Lalonde, Kevin C H Ha, Zibo Wang, Amandine Bemmo, Claudia L Kleinman, Tony Kwan, Tomi Pastinen, and Jacek Majewski. RNA sequencing reveals the role of splicing polymorphisms in regulating human gene expression. Genome Research, 21(4):545–554, Apr 2011.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report14338" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.9577.r14338</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Reyes</surname>
          <given-names>Alejandro</given-names>
        </name>
        <xref ref-type="aff" rid="r14338a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r14338a1"><label>1</label>Genome Biology Unit, European Molecular Biology Laboratory, Heidelberg, Germany</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e8128" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.8900.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Nowicka and Robinson propose a novel method, called DRIMSeq, to test for differential transcript usage between groups of samples using RNA-seq. The method is based on the Dirichlet-multinomial distribution.</p>
    <p> The authors evaluate different existing approaches to estimate the parameters of their model using simulated experiments with a small number of replicates, which is a common scenario of high-throughput sequencing experiments. Furthermore, Nowicka
<italic>et al</italic>. provide a proof of principle of their method by applying it to both simulated and real RNA-seq data. They also compare the performance of DRIMSeq with DEXSeq and sQTLseekeR in detecting differential transcript usage and splicing quantitative trait loci (sQTLs), respectively. DRIMSeq shows high concordance with DEXSeq. Furthermore, the authors demonstrate that DRIMSeq performs better than DEXSeq when using transcript-level counts. DRIMSeq and sQTLseekeR were also highly concordant. Nevertheless, sQTL genes detected by DRIMSeq were expressed higher than those detected by sQTLseekeR, and sQTLs detected by DRIMSeq were in closer proximity to exons compared to sQTLs detected by sQTLseeker. DRIMSeq is implemented as an R/Bioconductor package.</p>
    <p> Overall, the manuscript is well presented and is scientifically sound. The description of the method is clear, the comparisons are fair, and the conclusions are supported by data and analyses.</p>
    <p> Below some minor comments:</p>
    <p>  
<list list-type="order"><list-item><p>Transcription of multiple isoforms from a single gene can be the consequence of differences in the following molecular mechanisms: transcription start sites, splicing, and termination of transcription.  The terms “differential splicing” and “splicing QTLs”, which are used throughout the manuscript and the package vignette, focus only on splicing. Consider a hypothetical example of an isoform switch between conditions in which the two isoforms only diverge by the transcription start site of the first exon. DRIMSeq should also detect this difference, and this would not be due to differential splicing. Thus, the authors could use more generic terminology that describes all possible interpretations of the outcome of their test. Perhaps “differential transcript usage” or “transcript usage QTLs”?</p></list-item><list-item><p>In equations 6-11,
<italic>PL</italic> and
<italic>APL</italic> are understandable from the context but are not defined in the text. </p></list-item><list-item><p>It would be useful for the reader to include more information of the simulated data from Sonseson
<italic>et al</italic>. (2016) in the main text of this manuscript (for example, number of replicates per condition).</p></list-item><list-item><p>The authors describe how DEXSeq can account for additional covariates in complex experimental designs. This paragraph, as well as the figures and supplementary material associated to it, could be understood as if DEXSeq fits GLMs only for complex experimental designs. In reality, DEXSeq always fits GLMs, even for simple two-group comparisons.</p></list-item><list-item><p>There are some panels from the supplementary figures where data are missing. Specifically, Fig. S13 has 3 empty panels and Fig. S21 the left panels are missing the data for “dexseq.prefilter5” and “drimseq_genewise_grid_trended.filter5”.</p></list-item><list-item><p>The list of software for splicing event quantification is already very extensive, however a citation to the Bioconductor package SGSeq (Goldstein
<italic>et al.</italic>, 2016) could also be added.</p></list-item><list-item><p>As for the readability of the supplementary information, some abbreviations are not defined in each supplementary figure caption. For example, in Fig. S5, n, m, DM, FP and nr_features are not defined in its caption (some of them, however, are defined in previous captions).  Since many abbreviations repeat several times through the supplementary information, it would be useful to include a glossary of all abbreviations at the beginning of all supplementary figures. </p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-14338-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Matthes</surname><given-names>KL</given-names></name><name><surname>Nowicka</surname><given-names>M</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage.</article-title><source><italic>Genome Biol</italic></source>.<year>2016</year>;<volume>17</volume>:
<elocation-id>10.1186/s13059-015-0862-3</elocation-id><fpage>12</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0862-3</pub-id><?supplied-pmid 26813113?><pub-id pub-id-type="pmid">26813233</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-14338-2">
        <label>2</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>LD</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Pau</surname><given-names>G</given-names></name><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>TD</given-names></name><name><surname>Seshagiri</surname><given-names>S</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group>:
<article-title>Prediction and Quantification of Splice Events from RNA-Seq Data.</article-title><source><italic>PLoS One</italic></source>.<year>2016</year>;<volume>11</volume>(<issue>5</issue>) :
<elocation-id>10.1371/journal.pone.0156132</elocation-id><fpage>e0156132</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0156132</pub-id><?supplied-pmid 27218464?><pub-id pub-id-type="pmid">27218464</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment2319" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>Mark</given-names>
          </name>
          <aff>University of Zurich, Switzerland</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>25</day>
        <month>11</month>
        <year>2016</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for taking the time to read and review our paper.</p>
      <p> As per your suggestion, we have now stressed that DRIMSeq can be applied to differential transcript usage (DTU), which accounts for not only differential splicing but also the differences in transcription start sites and differential transcript termination. In the QTL analysis, as we test for associations between genotypes and transcript usage and not only splicing, following your suggestion, we have also changed the term from splicing QTLs (sQTLs) to transcript usage QTLs (tuQTLs).</p>
      <p> We have addressed all the other minor comments which include:
<list list-type="bullet"><list-item><p>defining the abbreviations of profile likelihood (PL) and adjusted profile likelihood (APL),</p></list-item><list-item><p>adding the sample size information about the simulations from Soneson
<italic>et al.</italic> [1],</p></list-item><list-item><p>in order to remove the misleading suggestion that DEXSeq fits GLMs only in the complex designs, we have changed the names of the models used in real data analysis from "model full glm" to "model full 2" and paraphrased the corresponding manuscript sections,</p></list-item><list-item><p>we have included results for the panels with missing data in the Supplementary Figures S15, S16 and S24,</p></list-item><list-item><p>we have included the citation to SGSeq [2] - the Bioconductor package for analyzing splice events from RNA-seq data,</p></list-item><list-item><p>in the Supplementary Materials, we have prepared a section explaining abbreviations used in the subsequent Supplementary Figures.</p></list-item></list> References</p>
      <p> [1]  Charlotte Soneson, Katarina L Matthes, Malgorzata Nowicka, Charity W Law, and Mark D Robinson. Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage. Genome Biology, 17(1):1–15, 2016.</p>
      <p> [2]  Leonard D Goldstein, Yi Cao, Gregoire Pau, Michael Lawrence, Thomas D Wu, Somasekar Seshagiri, and Robert Gentleman. Prediction and Quantification of Splice Events from RNA-Seq Data. PLoS ONE, 11(5):e0156132, may 2016.</p>
    </body>
  </sub-article>
</sub-article>
