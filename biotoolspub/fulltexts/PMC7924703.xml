<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="pmc">peerj-cs</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7924703</article-id>
    <article-id pub-id-type="publisher-id">cs-226</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.226</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Algorithms and Analysis of Algorithms</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Data Science</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Graphics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Visual Analytics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>R-DECO: an open-source Matlab based graphical user interface for the detection and correction of R-peaks</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Moeyersons</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <email>Jonathan.Moeyersons@esat.kuleuven.be</email>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Amoni</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Van Huffel</surname>
          <given-names>Sabine</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Willems</surname>
          <given-names>Rik</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-5" contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9581-0676</contrib-id>
        <name>
          <surname>Varon</surname>
          <given-names>Carolina</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>STADIUS Center for Dynamical Systems, Signal Processing and Data Analytics, Department of Electrical Engineering (ESAT), KU Leuven</institution>, <addr-line>Leuven</addr-line>, <country>Belgium</country></aff>
      <aff id="aff-2"><label>2</label><institution>Department of Cardiovascular Sciences, KU Leuven</institution>, <addr-line>Leuven</addr-line>, <country>Belgium</country></aff>
      <aff id="aff-3"><label>3</label><institution>Department of Cardiology, University Hospitals Leuven</institution>, <addr-line>Leuven</addr-line>, <country>Belgium</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Frank</surname>
          <given-names>Eibe</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2019-10-21">
      <day>21</day>
      <month>10</month>
      <year iso-8601-date="2019">2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>e226</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2019-05-13">
        <day>13</day>
        <month>5</month>
        <year iso-8601-date="2019">2019</year>
      </date>
      <date date-type="accepted" iso-8601-date="2019-09-11">
        <day>11</day>
        <month>9</month>
        <year iso-8601-date="2019">2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Moeyersons et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Moeyersons et al.</copyright-holder>
      <license xlink:href="https://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-226"/>
    <abstract>
      <p>Many of the existing electrocardiogram (ECG) toolboxes focus on the derivation of heart rate variability features from RR-intervals. By doing so, they assume correct detection of the QRS-complexes. However, it is highly likely that not all detections are correct. Therefore, it is recommended to visualize the actual R-peak positions in the ECG signal and allow manual adaptations. In this paper we present R-DECO, an easy-to-use graphical user interface (GUI) for the detection and correction of R-peaks. Within R-DECO, the R-peaks are detected by using a detection algorithm which uses an envelope-based procedure. This procedure flattens the ECG and enhances the QRS-complexes. The algorithm obtained an overall sensitivity of 99.60% and positive predictive value of 99.69% on the MIT/BIH arrhythmia database. Additionally, R-DECO includes support for several input data formats for ECG signals, three basic filters, the possibility to load other R-peak locations and intuitive methods to correct ectopic, wrong, or missed heartbeats. All functionalities can be accessed via the GUI and the analysis results can be exported as Matlab or Excel files. The software is publicly available. Through its easy-to-use GUI, R-DECO allows both clinicians and researchers to use all functionalities, without previous knowledge.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>R-peak detection</kwd>
      <kwd>R-peak correction</kwd>
      <kwd>User interface</kwd>
      <kwd>Analysis software</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Bijzonder Onderzoeksfonds KU Leuven (BOF)</funding-source>
        <award-id>C24/15/036, C24/18/097</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Agentschap Innoveren &amp; Ondernemen (VLAIO)</funding-source>
        <award-id>STW 150466 OSA+, O&amp;O HBC 2016 0184 eWatch</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Belgian Foreign Affairs-Development Cooperation</funding-source>
        <award-id>VLIR UOS programs (2013–2019)</award-id>
      </award-group>
      <award-group id="fund-4">
        <funding-source>EU</funding-source>
        <award-id>26077, 766456, 813120, 813483</award-id>
      </award-group>
      <funding-statement>This work was supported by the Bijzonder Onderzoeksfonds KU Leuven (BOF): C24/15/036, C24/18/097; Agentschap Innoveren &amp; Ondernemen (VLAIO): STW 150466 OSA+, O&amp;O HBC 2016 0184 eWatch; Belgian Foreign Affairs-Development Cooperation: VLIR UOS programs (2013-2019); EU: 26077, 766456, 813120, 813483. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The electrocardiogram (ECG) is one of the primary screening and diagnostic tools of the cardiologist. It records the electrical activity of the heart, which generates the myocardial contractions. A crucial step in the study of the ECG is the location of the QRS-complexes. As can be seen in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>, these complexes are the most prominent waveforms in the ECG. They contain an enormous amount of information about the state of the heart. This is why the detection of the QRS-complexes constitutes the basis for almost all automated ECG analysis algorithms (<xref rid="ref-10" ref-type="bibr">Kohler, Hennig &amp; Orglmeister, 2002</xref>). Once these have been identified, more elaborated analyses can be performed, such as heart rate variability (HRV).</p>
    <fig id="fig-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>A normal heartbeat as recorded by an ECG.</title>
        <p>The QRS-complex can be observed in the center. The detection of this complex is crucial for almost all ECG analysis algorithms.</p>
      </caption>
      <graphic xlink:href="peerj-cs-05-226-g001"/>
    </fig>
    <p>Four decades of automated QRS detection research has resulted in a variety of methods using different approaches. These methods can be stratified based on derivatives, digital filters, wavelet-transforms, classifiers, etc. (<xref rid="ref-14" ref-type="bibr">Pan &amp; Tompkins, 1985</xref>; <xref rid="ref-5" ref-type="bibr">Dohare, Kumar &amp; Kumar, 2014</xref>; <xref rid="ref-7" ref-type="bibr">Fujii et al., 2013</xref>; <xref rid="ref-17" ref-type="bibr">Sharma &amp; Sunkaria, 2016</xref>; <xref rid="ref-3" ref-type="bibr">Chen, Chen &amp; Chan, 2006</xref>). Despite the wide methodological variety, most of these QRS detectors have the same algorithmic structure. This can be divided in two steps: pre-processing and decision making (<xref rid="ref-10" ref-type="bibr">Kohler, Hennig &amp; Orglmeister, 2002</xref>).</p>
    <p>In the pre-processing step the QRS-complex is highlighted and the other signal components are suppressed to facilitate the detection. The resulting signal is then used to detect the occurrence of QRS-complexes in the decision making step. This is done by using either fixed or adaptive thresholds. Despite high detection rates, some QRS-complexes remain undetected. Reasons for this might be small amplitudes, wide complexes or contamination by noise (<xref rid="ref-1" ref-type="bibr">Arzeno, Deng &amp; Poon, 2008</xref>). Therefore, in many algorithms an extra post-processing step is added for the exact determination of the temporal location of the detected QRS-complex.</p>
    <p>One of the most established QRS detection algorithms is the Pan–Tompkins algorithm (<xref rid="ref-14" ref-type="bibr">Pan &amp; Tompkins, 1985</xref>). Although it was developed in the eighties, it achieves comparable performance to many more elaborate algorithms (<xref rid="ref-6" ref-type="bibr">Elgendi et al., 2014</xref>). In this paper, an envelope-based procedure that enhances the QRS-complexes and flattens the rest of the ECG is used in combination with an adapted version of the threshold-based approach of the Pan–Tompkins algorithm. This method, which was proposed by our group in <xref rid="ref-19" ref-type="bibr">Varon et al. (2015)</xref>, combines the simplicity of an envelope-based procedure, while maintaining the accuracy of many more elaborate methods.</p>
    <p>In a review paper, <xref rid="ref-6" ref-type="bibr">Elgendi et al. (2014)</xref> have compared the results of 22 beat detection algorithms on the MIT-BIH arrhythmia database. When comparing the results of the automated algorithms with expert annotations, they have shown that many algorithms obtained excellent accuracy. However, none of the algorithms reached perfection. This means that, no matter how good the QRS detection algorithm is, it is highly likely that not all annotations are correct. Therefore, it is recommended to visually inspect and review each signal before further analysis (<xref rid="ref-15" ref-type="bibr">Pichot et al., 2016</xref>).</p>
    <p>Many of the existing ECG toolboxes have focussed on the derivation of HRV-analysis parameters from RR-intervals, the time between subsequent R-peaks. This makes sense, since most of the available hardware include some kind of QRS-complex detection algorithm. However, this does not necessarily mean that the output of these devices are the raw RR-intervals. Many of these devices have a built-in post-processing algorithm, which compensates for false detections by averaging over a certain range of RR-intervals (<xref rid="ref-13" ref-type="bibr">Niskanen et al., 2004</xref>; <xref rid="ref-15" ref-type="bibr">Pichot et al., 2016</xref>; <xref rid="ref-20" ref-type="bibr">Vicente et al., 2013</xref>). However, for some analyses, such as ECG derived respiration (EDR) or beat-to-beat variability of repolarization (BVR), it is of utmost importance that the actual R-peak of the QRS-complex is detected. Therefore, it is necessary to visualize the actual R-peak positions in the ECG signal and allow the possibility to make manual adaptations.</p>
    <p>In this paper, we present R-DECO, a MATLAB-based, graphical user interface (GUI) for the detection and correction of R-peaks. This user interface includes the developed R-peak detection algorithm and provides the user with the possibility to correct possible false detections in a very straightforward way. R-DECO was developed by the biomedical data processing research team (BIOMED) at the Department of Electrical Engineering (ESAT) of KU Leuven. The software is freely available for Windows operating systems at <uri xlink:href="https://gitlab.esat.kuleuven.be/biomed-public/r-deco">https://gitlab.esat.kuleuven.be/biomed-public/r-deco</uri>.</p>
    <p>The objective of this paper is to provide a detailed description of R-DECO, including the proposed R-peak detection algorithm and an overview of the different possibilities of this new software.</p>
  </sec>
  <sec sec-type="computational|methods">
    <title>Computational Methods</title>
    <sec>
      <title>R-peak detection</title>
      <p>We developed an R-peak detection algorithm that is based on an enveloping procedure. It achieves a 99.60% sensitivity and 99.69% positive predictive value (PPV) on the MIT/BIH Arrhythmia Database (<xref rid="ref-11" ref-type="bibr">Moody &amp; Mark, 2001</xref>). The algorithm can be divided in three steps: pre-processing, decision and post-processing.</p>
      <sec>
        <title>Pre-processing</title>
        <p>The pre-processing consists of an enveloping procedure, which enhances the QRS-complexes and flattens the rest of the ECG (<xref rid="ref-19" ref-type="bibr">Varon et al., 2015</xref>). A visual explanation of the method is shown in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>.</p>
        <fig id="fig-2" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-2</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Enveloping procedure.</title>
            <p>The flattened ECG (F) is constructed by subtracting the lower envelope (L) from the upper envelope (U). This enhances the QRS-complex and flattens the rest of the ECG signal.</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g002"/>
        </fig>
        <p>First, the upper (<italic>U</italic>) and lower (<italic>L</italic>) envelopes are computed from the ECG signal by the secant method. This method selects the segment with the steepest positive and negative slope in a user-defined window with length <italic>t</italic>. Once <italic>U</italic> and <italic>L</italic> are obtained, they are used to derive a flattened version of the ECG signal (<italic>F</italic>): <italic>F</italic> = <italic>U</italic> − <italic>L</italic>. Since <italic>L</italic> is subtracted from <italic>U</italic>, the baseline is eliminated and only a positive signal, <italic>F</italic>, remains.</p>
      </sec>
      <sec>
        <title>Decision</title>
        <p>The locations of the QRS-complexes are found by detecting the peaks in the flattened ECG. These peaks are detected in three stages. First, all samples with an amplitude lower than the amplitude of the sample 80 ms further are selected. The 80 ms step size was experimentally defined. This results in the selection of the upward slopes. As a second step, only the upward slopes that are longer than the step size are selected in order to exclude small peaks. Finally, the maximum is selected in a window, with a length equal to the step size, that starts from the last selected sample of the upward slope. A graphical representation of this process is shown in <xref ref-type="fig" rid="fig-3">Fig. 3</xref>.</p>
        <fig id="fig-3" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-3</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Procedure to select R-peaks.</title>
            <p>The resulting flat ECG denoted F is indicated by the black line. The samples with an amplitude lower than the sample 80 ms further are indicated by the magenta circles, with the last sample indicated by the green circle. The search window is indicated by the green line. The selected R-peaks are indicated by the black circles. A.u. stands for arbitrary units.</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g003"/>
        </fig>
        <p>On this selection of peaks, the adaptive thresholding procedure of the Pan–Tompkins algorithm is applied to define the peaks that correspond to the QRS-complexes.</p>
      </sec>
      <sec>
        <title>Post-processing</title>
        <p>The thresholding procedure generally produces satisfactory results for the detection of the QRS-complexes. However, some of the automatically generated RR-intervals might be physiologically unreasonable and need to be removed for further analysis. A slightly modified version of the search-back procedure as proposed in <xref rid="ref-4" ref-type="bibr">De Chazal et al. (2003)</xref> was used for this purpose.</p>
        <p>Once the positions of the QRS-complexes are identified, the original ECG is used to find the exact location of the R-peaks. The search for an R-peak is performed up to 50 ms from the peak in the flattened signal. This extra search is necessary because the presence of large S-waves might shift the peak in the flattened signal toward the valley of the S-wave.</p>
      </sec>
      <sec>
        <title>Evaluation on the physionet MIT/BIH arrhythmia database</title>
        <p>We used the MIT/BIH arrhythmia database to evaluate the proposed algorithm (<xref rid="ref-11" ref-type="bibr">Moody &amp; Mark, 2001</xref>). This dataset consists of 48 half-hour ECG signals, which were recorded in the Boston’s Beth Israel Hospital between 1975 and 1979. All recordings were annotated by two independent cardiologists who also made a distinction between normal and abnormal beats. In total, 110,122 heartbeats were annotated, of which 89,133 were labeled as normal. Each recording contains two channel ECG signals with a sampling frequency of 360 Hz. In most records, one channel is lead II and the other channel is V1. However, we only used the first channel for the evaluation.</p>
        <p>As mentioned previously, the pre-processing consists of a flattening step of the ECG with a user-defined window width. To evaluate the sensitivity of the performance to the choice of the width we have tested multiple window widths. As can be observed from <xref ref-type="fig" rid="fig-4">Fig. 4</xref>, comparable results were obtained for window widths between 250 and 350 ms.</p>
        <fig id="fig-4" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-4</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Performance of the algorithm, compared to the choice of window width.</title>
            <p>(A) The positive predictive value and (B) the sensitivity of the algorithm. A window width between 250 and 350 ms results in the best performance.</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g004"/>
        </fig>
        <p>In <xref rid="table-1" ref-type="table">Table 1</xref> we list the R-peak detection results of the proposed algorithm with an envelope width of 300 ms and without post-processing. We obtained an overall sensitivity of 99.60% and PPV of 99.69%. When including the post-processing, we obtained an overall sensitivity of 99.09% and PPV of 99.80%. These results are comparable with those in literature, especially with the Pan–Tompkins algorithm, which reaches a sensitivity of 99.76% and a PPV of 99.56% (<xref rid="ref-6" ref-type="bibr">Elgendi et al., 2014</xref>).</p>
        <table-wrap id="table-1" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/table-1</object-id>
          <label>Table 1</label>
          <caption>
            <title>Performance of the R-peak detection algorithm on the Physionet MIT/BIH dataset.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-05-226-g013"/>
            <graphic xlink:href="peerj-cs-05-226-g014"/>
            <table frame="hsides" rules="groups" content-type="text">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Record</th>
                  <th rowspan="1" colspan="1">Total (beats)</th>
                  <th rowspan="1" colspan="1">TP (beats)</th>
                  <th rowspan="1" colspan="1">FP (beats)</th>
                  <th rowspan="1" colspan="1">FN (beats)</th>
                  <th rowspan="1" colspan="1">Se (%)</th>
                  <th rowspan="1" colspan="1">PPV (%)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">2,273</td>
                  <td rowspan="1" colspan="1">2,273</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">101</td>
                  <td rowspan="1" colspan="1">1,865</td>
                  <td rowspan="1" colspan="1">1,864</td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">99.95</td>
                  <td rowspan="1" colspan="1">99.79</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">102</td>
                  <td rowspan="1" colspan="1">2,187</td>
                  <td rowspan="1" colspan="1">2,187</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">103</td>
                  <td rowspan="1" colspan="1">2,084</td>
                  <td rowspan="1" colspan="1">2,084</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">104</td>
                  <td rowspan="1" colspan="1">2,229</td>
                  <td rowspan="1" colspan="1">2,227</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">99.91</td>
                  <td rowspan="1" colspan="1">99.87</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">105</td>
                  <td rowspan="1" colspan="1">2,572</td>
                  <td rowspan="1" colspan="1">2,542</td>
                  <td rowspan="1" colspan="1">41</td>
                  <td rowspan="1" colspan="1">30</td>
                  <td rowspan="1" colspan="1">98.83</td>
                  <td rowspan="1" colspan="1">98.41</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">106</td>
                  <td rowspan="1" colspan="1">2,027</td>
                  <td rowspan="1" colspan="1">2,023</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">99.80</td>
                  <td rowspan="1" colspan="1">99.90</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">107</td>
                  <td rowspan="1" colspan="1">2,137</td>
                  <td rowspan="1" colspan="1">2,130</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">7</td>
                  <td rowspan="1" colspan="1">99.67</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">108</td>
                  <td rowspan="1" colspan="1">1,763</td>
                  <td rowspan="1" colspan="1">1,739</td>
                  <td rowspan="1" colspan="1">80</td>
                  <td rowspan="1" colspan="1">24</td>
                  <td rowspan="1" colspan="1">98.64</td>
                  <td rowspan="1" colspan="1">95.60</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">109</td>
                  <td rowspan="1" colspan="1">2,532</td>
                  <td rowspan="1" colspan="1">2,532</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">111</td>
                  <td rowspan="1" colspan="1">2,124</td>
                  <td rowspan="1" colspan="1">2,123</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">99.95</td>
                  <td rowspan="1" colspan="1">99.91</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">112</td>
                  <td rowspan="1" colspan="1">2,539</td>
                  <td rowspan="1" colspan="1">2,539</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">113</td>
                  <td rowspan="1" colspan="1">1,795</td>
                  <td rowspan="1" colspan="1">1,795</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">114</td>
                  <td rowspan="1" colspan="1">1,879</td>
                  <td rowspan="1" colspan="1">1,877</td>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">99.89</td>
                  <td rowspan="1" colspan="1">99.68</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">115</td>
                  <td rowspan="1" colspan="1">1,953</td>
                  <td rowspan="1" colspan="1">1,953</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">116</td>
                  <td rowspan="1" colspan="1">2,412</td>
                  <td rowspan="1" colspan="1">2,388</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">24</td>
                  <td rowspan="1" colspan="1">99</td>
                  <td rowspan="1" colspan="1">99.92</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">117</td>
                  <td rowspan="1" colspan="1">1,535</td>
                  <td rowspan="1" colspan="1">1,535</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">118</td>
                  <td rowspan="1" colspan="1">2,278</td>
                  <td rowspan="1" colspan="1">2,278</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.96</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">119</td>
                  <td rowspan="1" colspan="1">1,987</td>
                  <td rowspan="1" colspan="1">1,987</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.90</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">121</td>
                  <td rowspan="1" colspan="1">1,863</td>
                  <td rowspan="1" colspan="1">1,861</td>
                  <td rowspan="1" colspan="1">12</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">99.89</td>
                  <td rowspan="1" colspan="1">99.36</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">122</td>
                  <td rowspan="1" colspan="1">2,476</td>
                  <td rowspan="1" colspan="1">2,476</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">123</td>
                  <td rowspan="1" colspan="1">1,518</td>
                  <td rowspan="1" colspan="1">1,518</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">124</td>
                  <td rowspan="1" colspan="1">1,619</td>
                  <td rowspan="1" colspan="1">1,619</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">200</td>
                  <td rowspan="1" colspan="1">2,601</td>
                  <td rowspan="1" colspan="1">2,595</td>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">99.77</td>
                  <td rowspan="1" colspan="1">99.69</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">201</td>
                  <td rowspan="1" colspan="1">1,963</td>
                  <td rowspan="1" colspan="1">1,958</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">99.75</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">202</td>
                  <td rowspan="1" colspan="1">2,136</td>
                  <td rowspan="1" colspan="1">2,120</td>
                  <td rowspan="1" colspan="1">14</td>
                  <td rowspan="1" colspan="1">16</td>
                  <td rowspan="1" colspan="1">99.25</td>
                  <td rowspan="1" colspan="1">99.34</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">203</td>
                  <td rowspan="1" colspan="1">2,980</td>
                  <td rowspan="1" colspan="1">2,749</td>
                  <td rowspan="1" colspan="1">20</td>
                  <td rowspan="1" colspan="1">231</td>
                  <td rowspan="1" colspan="1">92.25</td>
                  <td rowspan="1" colspan="1">99.28</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">205</td>
                  <td rowspan="1" colspan="1">2,656</td>
                  <td rowspan="1" colspan="1">2,641</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">15</td>
                  <td rowspan="1" colspan="1">99.44</td>
                  <td rowspan="1" colspan="1">99.92</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">207</td>
                  <td rowspan="1" colspan="1">1,860</td>
                  <td rowspan="1" colspan="1">1,855</td>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">99.73</td>
                  <td rowspan="1" colspan="1">99.58</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">208</td>
                  <td rowspan="1" colspan="1">2,955</td>
                  <td rowspan="1" colspan="1">2,941</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">14</td>
                  <td rowspan="1" colspan="1">99.53</td>
                  <td rowspan="1" colspan="1">99.93</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">209</td>
                  <td rowspan="1" colspan="1">3,005</td>
                  <td rowspan="1" colspan="1">3,005</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">210</td>
                  <td rowspan="1" colspan="1">2,650</td>
                  <td rowspan="1" colspan="1">2,582</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">68</td>
                  <td rowspan="1" colspan="1">97.43</td>
                  <td rowspan="1" colspan="1">99.88</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">212</td>
                  <td rowspan="1" colspan="1">2,748</td>
                  <td rowspan="1" colspan="1">2,748</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.96</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">213</td>
                  <td rowspan="1" colspan="1">3,251</td>
                  <td rowspan="1" colspan="1">3,250</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">99.97</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">214</td>
                  <td rowspan="1" colspan="1">2,262</td>
                  <td rowspan="1" colspan="1">2,259</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">99.87</td>
                  <td rowspan="1" colspan="1">99.87</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">215</td>
                  <td rowspan="1" colspan="1">3,363</td>
                  <td rowspan="1" colspan="1">3,354</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">99.73</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">217</td>
                  <td rowspan="1" colspan="1">2,208</td>
                  <td rowspan="1" colspan="1">2,202</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">99.73</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">219</td>
                  <td rowspan="1" colspan="1">2,154</td>
                  <td rowspan="1" colspan="1">2,154</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.95</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">220</td>
                  <td rowspan="1" colspan="1">2,048</td>
                  <td rowspan="1" colspan="1">2,047</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">99.95</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">221</td>
                  <td rowspan="1" colspan="1">2,427</td>
                  <td rowspan="1" colspan="1">2,425</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">99.92</td>
                  <td rowspan="1" colspan="1">99.92</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">222</td>
                  <td rowspan="1" colspan="1">2,483</td>
                  <td rowspan="1" colspan="1">2,475</td>
                  <td rowspan="1" colspan="1">21</td>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">99.68</td>
                  <td rowspan="1" colspan="1">99.16</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">223</td>
                  <td rowspan="1" colspan="1">2,605</td>
                  <td rowspan="1" colspan="1">2,605</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">228</td>
                  <td rowspan="1" colspan="1">2,053</td>
                  <td rowspan="1" colspan="1">2,044</td>
                  <td rowspan="1" colspan="1">59</td>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">99.56</td>
                  <td rowspan="1" colspan="1">97.19</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">230</td>
                  <td rowspan="1" colspan="1">2,256</td>
                  <td rowspan="1" colspan="1">2,256</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">231</td>
                  <td rowspan="1" colspan="1">1,571</td>
                  <td rowspan="1" colspan="1">1,571</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">232</td>
                  <td rowspan="1" colspan="1">1,780</td>
                  <td rowspan="1" colspan="1">1,780</td>
                  <td rowspan="1" colspan="1">17</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.05</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">233</td>
                  <td rowspan="1" colspan="1">3,079</td>
                  <td rowspan="1" colspan="1">3,070</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">99.71</td>
                  <td rowspan="1" colspan="1">100</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">234</td>
                  <td rowspan="1" colspan="1">2,753</td>
                  <td rowspan="1" colspan="1">2,753</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">100</td>
                  <td rowspan="1" colspan="1">99.96</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Total</td>
                  <td rowspan="1" colspan="1">109,494</td>
                  <td rowspan="1" colspan="1">108,989</td>
                  <td rowspan="1" colspan="1">317</td>
                  <td rowspan="1" colspan="1">505</td>
                  <td rowspan="1" colspan="1">99.60</td>
                  <td rowspan="1" colspan="1">99.69</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>While these results are very promising, we can also observe that for some recordings only moderate detection results are achieved. This decrease in performance is generally due to loss of signal, unusual morphology or stretches of extremely irregular rhythms. For instance, recording 116 and 208 contain stretches where the signal is lost in the first channel. However, the recordings with the highest amount of false detections are 108, 203 and 210. Correctly detecting the R-peaks in recording 108 has been proven difficult for many algorithms (<xref rid="ref-14" ref-type="bibr">Pan &amp; Tompkins, 1985</xref>). It contains a lot of baseline wander and additionally, very tall and sharp P-waves. These characteristics make it difficult to distinguish P-waves from R-peaks and thus result in a high false positive count. However, the highest amount of false positives is observed in recording 203 (92.25% sensitivity). This might be explained by the extremely high percentage of premature ventricular contractions (PVC) present in the recording, almost 15%. Since the envelope width was fixed during the detection process, one may assume that the performance could be improved if manual adjustments were permitted. This holds as well for other records with PVC’s, such as record 210.</p>
        <p>The noise tolerance of the algorithm was evaluated with the MIT-BIH Noise Stress Test Database (<xref rid="ref-12" ref-type="bibr">Moody, Muldrow &amp; Mark, 1984</xref>). We observed that both median PPV and sensitivity remained around 100% above a signal-to-noise-ratio of six dB. From this threshold the performance of the algorithm decreased significantly.</p>
        <p>From the analysis of the results, we could deduce two main factors that influence the results of the algorithm: (1) the envelope width and (2) the RR-post processing. The number of samples in the envelope is important, since it can be regarded as a filter of the RR-intervals. Smaller envelope widths might result in the enhancement of more peaks than only the R-peaks. This might be beneficial in the case of small R-peaks, but might also enhance artefact peaks. Larger envelope widths might cause adjacent R-peaks to be merged in the flattened signal. In practice, this might result in the failure of detecting premature heartbeats, which appear shortly after the previous heartbeat. In summary, a larger envelope width results in less false positives and more false negatives and the opposite is true for a small envelope width. A similar effect can be observed when the RR-intervals are post-processed. This increases the certainty of detection of the algorithm and thus results in less false positives. The downside is that, in the presence of abnormal rhythms, it also results in more false negatives.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="software">
    <title>Software Description</title>
    <p>The algorithms have been implemented with MATLAB R2018a. We used GUIDE, MATLAB’s GUI development environment, to design the GUI of R-DECO. The current subsection describes the possible input data formats and the user interface.</p>
    <sec>
      <title>Input data formats</title>
      <p>The standard input of the toolbox is raw or filtered ECG data. This can be both single- or multichannel ECG. Since a plethora of open formats exist for storing the ECG, it would be impossible to write supporting software for all formats (<xref rid="ref-13" ref-type="bibr">Niskanen et al., 2004</xref>). Therefore, we focussed on the data formats that are most commonly used by our clinical partners in the cardiology department of the UZ Leuven, Belgium. The following file formats are supported:
<list list-type="bullet"><list-item><p>ISHNE-Holter files (*.ecg)</p></list-item><list-item><p>MATLAB files (*.mat)</p></list-item><list-item><p>European Data Format (*.edf)</p></list-item><list-item><p>Text files (*.txt)</p></list-item><list-item><p>Excel files (*.xls or *.csv)</p></list-item></list></p>
      <p>An ISHNE-Holter file is organized in a header record, followed by a data block that contains all digital ECG samples. This file format was developed to facilitate data exchange and research in the field of Holter (<xref rid="ref-2" ref-type="bibr">Badilini, 1998</xref>). The software automatically extracts all ECG channels and also the sampling frequency.</p>
      <p>A MATLAB formatted file can contain one variable, up to an entire workspace. Therefore, if the file contains more than one variable, the user is prompted to select the variable containing the ECG signal. In the specific case that the selected file is a structure, the software allows to search within the structure until the ECG signal is selected.</p>
      <p>A standard European Data Format, EDF, file consists of a header record and the data records (<xref rid="ref-9" ref-type="bibr">Kemp et al., 1992</xref>). It was originally intended for the digital storage and exchange of EEG and polysomnogram recordings, but currently it can store a variety of annotations and signals, such as EMG, ECG and many more (<xref rid="ref-8" ref-type="bibr">Kemp &amp; Olivan, 2003</xref>). Since not all EDF files have the same standard labels, the user is prompted to identify the ECG channel(s). Additionally, the software attempts to identify the sampling frequency of the selected signal by scanning the file.</p>
      <p>As an extra feature, the software allows the user to load a session. When the current session is interrupted, the session can be saved as a MATLAB file. It includes all the analysis parameters, the ECG signal and the RR-intervals, if computed. When a previous session is loaded, the software restores the entire user interface to the moment on which the session was saved. This allows the user to pause and continue, whenever wanted.</p>
    </sec>
    <sec>
      <title>User interface</title>
      <p>The strength of this toolbox is that everything is operated through a single GUI. As shown in <xref ref-type="fig" rid="fig-5">Fig. 5</xref>, it can be divided in five segments: Data, Filter, Analysis Period, R-peak Detection and R-peak Correction. All segments are described below.</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The graphical user interface of R-DECO.</title>
          <p>The user interface can be divided in five segments: (A) Data, (B) Filter, (C) Analysis Period, (D) R-peak Detection and (E) R-peak Correction. The ECG signal and the resulting tachogram are shown in respectively (F) and (G). The detected R-peaks are depicted as small blue circles.</p>
        </caption>
        <graphic xlink:href="peerj-cs-05-226-g005"/>
      </fig>
      <sec>
        <title>Data</title>
        <p>In the data panel, the user has the option to load data in two different ways: from a file or from the MATLAB workspace. Both can be accessed via the respective pushbuttons.</p>
        <p>When a file is selected, the software visualizes a small segment of the ECG signal. If the signal is inverted, the user can indicate this and the file will be inverted before further analysis. The software also scans the selected file for the sampling frequency. If this is not found, the software prompts the user to manually indicate the sampling frequency.</p>
        <p>Finally, the data panel also contains a reset button. This button allows the user to reset the entire GUI. It empties all plots, restores all default variables and deletes all results. If the user has not yet saved the current analysis, the user is prompted to confirm the reset action to prevent unwanted loss of information.</p>
      </sec>
      <sec>
        <title>Filter</title>
        <p>Since ECG signals can be contaminated with noise, filtering is often essential for further analysis. R-DECO provides three basic filters: high pass, low pass and a notch filter.</p>
        <p>The high pass filter consists of a zero phase, second order Butterworth filter. The low pass filter consists of a zero phase, fourth order Butterworth filter. Finally, a zero phase notch filter is also included. The latter could be used to remove the power-line interference. Important to note is that filtering actions are always executed on the original signal to ensure repeatability.</p>
        <p>In order to aid the user in the selection of appropriate frequency threshold(s), R-DECO is able to compute and display the power spectrum. An estimate of the power spectrum is computed using the Welch method (<xref rid="ref-21" ref-type="bibr">Welch, 1967</xref>). As a default, we used a window of 500 samples with 60% overlap.</p>
        <p>To visualize the effect of the filtering in the frequency domain, R-DECO displays both the filtered and the original power spectrum. Furthermore, the effect of the filtering in the time domain can also be investigated by checking the “Show Original” checkbox. This will overlay the original signal on top of the filtered signal (<xref ref-type="fig" rid="fig-6">Fig. 6</xref>).</p>
        <fig id="fig-6" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-6</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Example of a high pass filter.</title>
            <p>By clicking the “Show Original” checkbox, the original signal (light blue) is overlaid on the filtered signal (blue).</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g006"/>
        </fig>
      </sec>
      <sec>
        <title>Analysis period</title>
        <p>In the Analysis Period panel the user has the possibility to define an analysis window. After pushing the “Define analysis period” button, the user has to select a window by clicking, dragging and releasing the mouse. The window is shown as a transparent patch over the data and can be enlarged, shrinked or moved with the mouse. After the initial window is drawn, the user can further modify the analysis window by changing the start time and/or the duration of the window.</p>
        <p>When a window is selected, the user can accept the analysis window by pressing the “Apply changes” button. This prompts the <italic>x</italic>-limits of the graph to match the analysis window and disables the window modifications. From here on, all further analysis will be performed solely on the selected window.</p>
        <p>All the above is very useful when the to-be-selected time period is known in advance, but this is not always the case. Sometimes the selection of the analysis window is depending on certain patterns in the tachogram, hence the tachogram has to be constructed first. Therefore, if R-peaks have been detected already, the user is prompted to indicate whether he/she would like to keep the detected R-peaks.</p>
      </sec>
      <sec>
        <title>R-peak detection</title>
        <p>The execution of the R-peak detection algorithm, as described in the first section, is initiated when the “Detect Peaks” button is pushed. However, before the actual algorithm is executed, the user is able to adjust the default parameters of the algorithm.</p>
        <p>In <xref ref-type="fig" rid="fig-7">Fig. 7</xref>, an epoch of 10 s of the ECG signal and its respective enveloped signal is shown as an example of the flattening procedure. The user can adjust the envelope size to the desired value and enact the changes by pressing the “Apply” button. Additionally, an estimation of the average heart rate can be defined to compute the boundaries of normal-to-normal RR-intervals. Lastly, the user can select the automatic post-processing of the RR-intervals.</p>
        <fig id="fig-7" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-7</object-id>
          <label>Figure 7</label>
          <caption>
            <title>The R-peak parameter selection window.</title>
            <p>The user can adjust the envelope size, the average heart rate and indicate if RR post-processing is necessary. Pressing the Default button restores the default values.</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g007"/>
        </fig>
        <p>Since some devices have built-in QRS detection algorithms and some researchers have their own preferred QRS detection algorithm, the software allows to load R-peak locations. These will be displayed the same way the R-peaks of the algorithm are displayed.</p>
      </sec>
      <sec>
        <title>R-peak correction</title>
        <p>In case of HRV studies, only the normal-to-normal RR-intervals need to be taken into account. This can be achieved by selecting the ectopic removal option. This option corrects ectopic beats, without altering the normal RR-intervals.</p>
        <p>After finishing the detection process, either by detecting or loading the R-peaks, it is still possible that not all R-peaks are accurately detected. In R-DECO, the user can make manual and (semi-)automatic adjustments to the R-peak locations.</p>
        <p>The manual methods are: add, adjust and delete. These methods can be activated by selecting the specific radiobuttons or via a context menu, which is linked to each R-peak. These manual methods allow the user to correct wrong or missing annotations either in all or in individual leads.</p>
        <list list-type="bullet">
          <list-item>
            <p>Add: When this radiobutton is active, new R-peaks can be added by clicking in the ECG graph. The program selects the signal sample that is closest to the mouse position in a symmetric window of 300 ms around the mouse position. Upon mouse release, a new R-peak is added and the tachogram is adapted.</p>
          </list-item>
          <list-item>
            <p>Adjust: While hovering over the ECG graph, the R-peak closest to the mouse location is selected. After clicking on the desired R-peak, it can be moved by dragging the mouse. The movement of the selected R-peak is restricted by the previous and next R-peak. While adjusting the R-peak location, the tachogram is automatically updated. Upon mouse release, the new R-peak location is saved.</p>
          </list-item>
          <list-item>
            <p>Delete: While hovering over the ECG graph, the R-peak closest to the mouse location is selected. After clicking on the desired R-peak, more to-be-deleted R-peaks can be selected by dragging the mouse. Upon mouse release, the selected R-peaks are removed and the tachogram is adapted.</p>
          </list-item>
        </list>
        <p>The three (semi-)automatic R-peak correction methods are: cross-correlation, peak conversion and maximum search.</p>
        <list list-type="bullet">
          <list-item>
            <p>Cross correlation: For this method, a symmetrical window of 300 ms around each R-peak is selected. Then, all heartbeats are normalized by subtracting the mean and dividing it by the standard deviation. Then, a trimmed average QRS-complex is computed of all the positive and “negative” R-peaks. In this work a “negative” R-peak is understood as the absence of an R-peak or the presence of a very prominent S-wave, also described as RS-complex.</p>
          </list-item>
          <list-item>
            <p>The user is prompted to select either the positive or the “negative” average heartbeat. If necessary, the user can also adjust the location of the R-peak on the selected template. This is all graphically displayed as shown in <xref ref-type="fig" rid="fig-8">Fig. 8</xref>. Finally, the cross-correlation of every heartbeat is computed with the trimmed average and the R-peak is re-located, based on the highest correlation value.</p>
          </list-item>
          <list-item>
            <p>Peak conversion: The absolute amplitude of every R-peak annotation is compared with the previous and next sample’s absolute amplitude. If it is bigger than the previous and smaller than the next, the location of the R-peak will be shifted forward, until an extremum is obtained. If it is the other way around, the location of the R-peak will be shifted backwards.</p>
          </list-item>
          <list-item>
            <p>This functionality avoids the “jumping” of R-peaks from, for example, an actual R-peak to a pre-mature ventricular contraction, which might be the case when window search is applied. Furthermore, pressing the button more than once will not affect the relocation after one correction.</p>
          </list-item>
          <list-item>
            <p>Maximum search: Firstly, a symmetric window of 300 ms around each R-peak is selected. Secondly, the user is prompted to select either the maximum, minimum or absolute maximum. Based on this selection, the respective extremum within the window is selected as new R-peak location.</p>
          </list-item>
        </list>
        <fig id="fig-8" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-8</object-id>
          <label>Figure 8</label>
          <caption>
            <title>The template selection window.</title>
            <p>The user can select either the positive or “negative” R-peak template and can shift the location of the R-peak if necessary.</p>
          </caption>
          <graphic xlink:href="peerj-cs-05-226-g008"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Save and export results</title>
      <p>By default, the results are saved as a MATLAB file. This file includes the R-peak locations and the RR-intervals, which can further be used for HRV-, BVR- or any other analysis that requires R-peak detection. Additionally, the software can export the results in two different ways: (1) an Excel file and (2) a MATLAB file.</p>
      <list list-type="order">
        <list-item>
          <p>Excel file (*.xls): A new workbook is created with a general overview of the file on the first sheet: the number of channels, the sampling frequency, the duration of the signal and the duration of the analysis period. The number of additional sheets is defined by the number of channels, since for every channel, a separate sheet is created. This contains the R-peak locations, the RR-intervals and a number of basic metrics, such as the mean heart rate.</p>
        </list-item>
        <list-item>
          <p>MATLAB file (*.mat): This file contains a single structure named <italic>data</italic>. In accordance to the structure of the Excel file, a structure is created per channel. This contains the signal in the analysis window, the R-peak locations and the RR-intervals. This option is especially useful for further analysis in MATLAB.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>Data browser</title>
      <p>In order to graphically correct the R-peaks it is important to have a clear view of the segment to be investigated. Therefore, after the R-peaks are detected, the software immediately displays the ECG signal with the R-peak annotations and the respective tachogram, as can be seen in <xref ref-type="fig" rid="fig-9">Fig. 9</xref>.</p>
      <fig id="fig-9" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>The data browsing options of R-DECO.</title>
        </caption>
        <graphic xlink:href="peerj-cs-05-226-g009"/>
      </fig>
      <p>The window width of the <italic>x</italic>-axis can be adjusted in three different ways: (1) the range edit box, (2) the plus and minus buttons or (3) by using the zoom button. All three methods also adjust the width of the scroll bar.</p>
      <p>The scroll bar can be used to slide through the signal. Since both axes are linked, both slide at the same time. The limits of the <italic>y</italic>-axis in both axes are adjusted automatically according to the data within the selected range. However, if the “Fix <italic>y</italic>-limits” checkbox is selected, the range of the <italic>y</italic>-axis of the tachogram is fixed to the current limits. Since some users favor a tachogram that displays the RR-intervals, while others favor HR values, we made it possible to switch between the two.</p>
      <p>An ECG recording with multiple channels might result in axes that become unclear. Therefore, R-DECO enables the user to switch view between different channels. This way the user can select one, multiple or all channels. If the channel labels are not present in the signal file, R-DECO names and numbers the channels itself: Channel 1, Channel 2, etc. However, it also provides the possibility to change these names. When the user clicks twice on a channel name in the listbox, a dialog box pops up that allows the user to choose a new name. This will be adjusted in the listbox, and also in the output files.</p>
      <p>An extra feature is the possibility to take “pictures” of the axes. This saves both axes in a format of choice, without including any of the buttons or bars from the user interface. In order to design the axes to the user’s taste, R-DECO allows to change the line colors and the grid lines.</p>
    </sec>
    <sec>
      <title>Preferences</title>
      <p>The analysis settings of R-DECO can be adjusted via the Preferences menu. Note that the changes only apply for the current session and are not saved for the next session. This will be adjusted in a future release.</p>
      <p>The Preference menu can be divided in four segments: Power Spectrum, Filter, Detection and Correction
<list list-type="bullet"><list-item><p>Power Spectrum: All variables of the Welch method can be adjusted here.</p></list-item><list-item><p>Filter: The type and order of the filter can be defined here.</p></list-item><list-item><p>Detection: The default input parameters for the R-peak detection algorithm can be adjusted here. Whenever the default button is pressed in the parameter selection window, see <xref ref-type="fig" rid="fig-7">Fig. 7</xref>, all parameters are reset to the values defined in this segment.</p></list-item><list-item><p>Correction: For all correction methods, the user can define the window size in which the new R-peak is supposed to be located.</p></list-item></list></p>
    </sec>
  </sec>
  <sec sec-type="sample">
    <title>Sample Run</title>
    <p>As a sample run, we used a 24 h digital Holter signal that was recorded from a male subject with ischaemic heart disease. The idea was to investigate the temporal evolution in BVR before spontaneous non-sustained ventricular tachycardia (nsVT). Before analysis could be performed, the nsVT episodes needed to be identified and the R-peaks needed to be detected.</p>
    <p>Once the signal was loaded and the sampling frequency was defined, we first had a look at the power spectrum. According to the plot, no power line interference was present, since we could not observe a peak at 50 or 60 Hz. However, it was clear that most of the power was situated in the lower frequency bands. This could indicate the presence of baseline wander. Therefore, we high-pass filtered the signal with a cut-off frequency of 0.66 Hz. The result in the power spectrum can be observed in <xref ref-type="fig" rid="fig-10">Fig. 10</xref>.</p>
    <fig id="fig-10" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-10</object-id>
      <label>Figure 10</label>
      <caption>
        <title>Result of the high pass filtering in the power spectrum.</title>
      </caption>
      <graphic xlink:href="peerj-cs-05-226-g010"/>
    </fig>
    <p>Next, the nsVT episodes needed to be identified. However, the time stamps of the episodes were not known. Therefore, it was necessary to detect the R-peaks first. This way the nsVT episodes could be identified from the tachogram. An example of an nsVT episode, taken with the picture button, can be observed in <xref ref-type="fig" rid="fig-11">Fig. 11</xref>.</p>
    <fig id="fig-11" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-11</object-id>
      <label>Figure 11</label>
      <caption>
        <title>Example of an nsVT segment with correction (A); the resulting tachogram is shown in (B).</title>
      </caption>
      <graphic xlink:href="peerj-cs-05-226-g011"/>
    </fig>
    <p>Based on the example signal, we selected an envelope size of 300 ms, which provided the best results for this signal. This envelope size ensures the enhancement of the QRS-complexes, without skipping any beats. Additionally, we indicated that no post-processing of the RR-intervals is wanted, since we wanted to be able to detect nsVT segments as well.</p>
    <p>The nsVT episodes were identified based on the resulting RR-intervals. From the start of one of these episodes, we selected 30 consecutive heartbeats (<xref rid="ref-18" ref-type="bibr">Thomsen et al., 2004</xref>). Only normal-to-normal intervals should be taken into account for BVR-analysis. Hence, (ventricular) ectopic and post-extrasystolic beats were removed for further analysis, as can be observed in <xref ref-type="fig" rid="fig-12">Fig. 12</xref>.</p>
    <fig id="fig-12" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj-cs.226/fig-12</object-id>
      <label>Figure 12</label>
      <caption>
        <title>Example of an nsVT segment with correction (A); the resulting tachogram is shown in (B).</title>
      </caption>
      <graphic xlink:href="peerj-cs-05-226-g012"/>
    </fig>
    <p>After the RR-intervals in the wanted analysis window were selected, the analysis results were saved. This was done by selecting “Save Results” on the menu bar and entering a file name. The results are then saved as a MATLAB file and can be loaded for the following BVR-analysis. Note that the results can also be exported as an Excel file.</p>
  </sec>
  <sec sec-type="potential">
    <title>Potential of Future Growth</title>
    <p>R-DECO is the first step toward a complete ECG processing tool. At the moment, it focusses on accurate R-peak detection and intuitive correction options. Therefore, it is a complementary tool for existing HRV-analysis toolboxes, which tend to focus on the computation of HRV metrics from RR-intervals. Although some toolboxes already provide the possibility to detect R-peaks, their possibility to correct R-peak annotations is rather limited (<xref rid="ref-15" ref-type="bibr">Pichot et al., 2016</xref>; <xref rid="ref-16" ref-type="bibr">Rodenhauser et al., 2018</xref>; <xref rid="ref-20" ref-type="bibr">Vicente et al., 2013</xref>). Additionally, to the best of our knowledge, none of the existing toolboxes provide filtering, R-peak detection and correction all together.</p>
    <p>The main advantage of R-DECO is the easy-to-use, intuitive GUI. All actions are performed in one window, which simplifies the use and reduces the learning time.</p>
    <p>Several extra features are being developed and will be released in future versions. We intend to add support for other input file formats, such as hierarchical data format 5 files, general data format files, etc. However, most improvements will be in the number of analysis options. Some of the first extra analysis options will be automatic signal quality detection, EDR and HRV-analysis.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>R-DECO is a MATLAB based GUI for detecting and correcting R-peaks in ECG signals. The goal of R-DECO is to provide a complete workflow from the raw signal to the tachogram. It includes an accurate R-peak detection algorithm, the performance of which is comparable to the state-of-the-art, and allows the user to graphically correct wrong or missing detections. Additionally, R-DECO supports a variety of ECG input file formats, which allows the processing of recordings directly from the recording device. This makes it a tool that can be used both by engineers, and clinicians.</p>
    <p>We included some basic pre-processing options, such as three filters and the possibility to select an analysis window. The analysis results can be exported to the MATLAB workspace or Excel for later analysis.</p>
    <p>R-DECO is available free of charge and can be downloaded from <uri xlink:href="https://gitlab.esat.kuleuven.be/biomed-public/r-deco">https://gitlab.esat.kuleuven.be/biomed-public/r-deco</uri>.</p>
  </sec>
</body>
<back>
  <ack>
    <p>Matthew Amoni is a doctoral fellow of the Research Foundation-Flanders (FWO). Carolina Varon is a postdoctoral fellow of the Research Foundation-Flanders (FWO). Rik Willems is a Senior Clinical Investigator of the Research Foundation-Flanders (FWO).</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Jonathan Moeyersons</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, prepared figures and/or tables, performed the computation work, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Matthew Amoni</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, approved the final draft, provide inside in the wishes of cardiologists.</p>
      </fn>
      <fn fn-type="con" id="contribution-3">
        <p><xref ref-type="contrib" rid="author-3">Sabine Van Huffel</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-4">
        <p><xref ref-type="contrib" rid="author-4">Rik Willems</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, approved the final draft, provide inside in the wishes of cardiologists.</p>
      </fn>
      <fn fn-type="con" id="contribution-5">
        <p><xref ref-type="contrib" rid="author-5">Carolina Varon</xref> conceived and designed the experiments, prepared figures and/or tables, performed the computation work, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The codes are available at: Moeyersons J, Amoni M, Van Huffel S, Willems R, Varon C, R-DECO: An open-source MATLAB-based graphical user interface for the detection and correction of R-peaks, UNDER REVISION, 2019. <uri xlink:href="https://gitlab.esat.kuleuven.be/biomed-public/r-deco">https://gitlab.esat.kuleuven.be/biomed-public/r-deco</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Arzeno, Deng &amp; Poon (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arzeno</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Analysis of first-derivative based QRS detection algorithms</article-title>
        <source>IEEE Transaction on Biomedical Engineering</source>
        <year>2008</year>
        <volume>55</volume>
        <issue>2</issue>
        <fpage>478</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1109/tbme.2007.912658</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Badilini (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Badilini</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The ISHNE holter standard output file format</article-title>
        <source>Annals of Noninvasive Electrocardiology</source>
        <year>1998</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>263</fpage>
        <lpage>266</lpage>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Chen, Chen &amp; Chan (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S-W</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>H-L</given-names>
          </name>
        </person-group>
        <article-title>A real-time QRS detection method based on moving-averaging incorporating with wavelet denoising</article-title>
        <source>Computer Methods and Programs in Biomedicine</source>
        <year>2006</year>
        <volume>82</volume>
        <issue>3</issue>
        <fpage>187</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmpb.2005.11.012</pub-id>
        <pub-id pub-id-type="pmid">16716445</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>De Chazal et al. (2003)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Chazal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Heneghan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>O’Malley</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Automated processing of the single-lead electrocardiogram for the detection of obstructive sleep apnoea</article-title>
        <source>IEEE Transactions on Biomedical Engineering</source>
        <year>2003</year>
        <volume>50</volume>
        <issue>6</issue>
        <fpage>686</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1109/tbme.2003.812203</pub-id>
        <pub-id pub-id-type="pmid">12814235</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Dohare, Kumar &amp; Kumar (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohare</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An efficient new method for the detection of QRS in electrocardiogram</article-title>
        <source>Computers &amp; Electrical Engineering</source>
        <year>2014</year>
        <volume>40</volume>
        <issue>5</issue>
        <fpage>1717</fpage>
        <lpage>1730</lpage>
        <pub-id pub-id-type="doi">10.1016/j.compeleceng.2013.11.004</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Elgendi et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elgendi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eskofier</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dokos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abbott</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Revisiting QRS detection methodologies for portable, wearable, battery-operated, and wireless ECG systems</article-title>
        <source>PLOS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>1</issue>
        <elocation-id>e84018</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0084018</pub-id>
        <pub-id pub-id-type="pmid">24409290</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Fujii et al. (2013)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Fujii</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yamashita</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Konishi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Izumi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kawaguchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yoshimoto</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Noise-tolerant instantaneous heart rate and R-peak detection using short-term autocorrelation for wearable healthcare systems</article-title>
        <year>2013</year>
        <conf-name>35th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC)</conf-name>
        <conf-loc>Osaka</conf-loc>
        <fpage>7330</fpage>
        <lpage>7333</lpage>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Kemp &amp; Olivan (2003)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kemp</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Olivan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>European data format ‘plus’ (EDF+), an EDF alike standard format for the exchange of physiological data</article-title>
        <source>Clinical Neurophysiology</source>
        <year>2003</year>
        <volume>114</volume>
        <issue>9</issue>
        <fpage>1755</fpage>
        <lpage>1761</lpage>
        <pub-id pub-id-type="doi">10.1016/s1388-2457(03)00123-8</pub-id>
        <pub-id pub-id-type="pmid">12948806</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Kemp et al. (1992)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kemp</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Värri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Gade</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A simple format for exchange of digitized polygraphic recordings</article-title>
        <source>Electroencephalography and Clinical Neurophysiology</source>
        <year>1992</year>
        <volume>82</volume>
        <issue>5</issue>
        <fpage>391</fpage>
        <lpage>393</lpage>
        <pub-id pub-id-type="pmid">1374708</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Kohler, Hennig &amp; Orglmeister (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hennig</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Orglmeister</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The principles of software QRS detection</article-title>
        <source>IEEE Engineering in Medicine and Biology Magazine</source>
        <year>2002</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1109/51.993193</pub-id>
        <pub-id pub-id-type="pmid">11935987</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Moody &amp; Mark (2001)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moody</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>The impact of the MIT-BIH arrhythmia database</article-title>
        <source>IEEE Engineering in Medicine and Biology Magazine</source>
        <year>2001</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>45</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="pmid">11446209</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Moody, Muldrow &amp; Mark (1984)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moody</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Muldrow</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>A noise stress test for arrhythmia detectors</article-title>
        <source>Computers in Cardiology</source>
        <year>1984</year>
        <volume>1</volume>
        <fpage>381</fpage>
        <lpage>384</lpage>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Niskanen et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niskanen</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Tarvainen</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Ranta-Aho</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Karjalainen</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Software for advanced HRV analysis</article-title>
        <source>Computer Methods and Programs in Biomedicine</source>
        <year>2004</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>73</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmpb.2004.03.004</pub-id>
        <pub-id pub-id-type="pmid">15313543</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Pan &amp; Tompkins (1985)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tompkins</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>A real-time QRS detection algorithm</article-title>
        <source>IEEE Transactions on Biomedical Engineering</source>
        <year>1985</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>230</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1109/tbme.1985.325532</pub-id>
        <pub-id pub-id-type="pmid">3997178</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Pichot et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pichot</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Roche</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Celle</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barthélémy</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Chouchou</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>HRVanalysis: a free software for analyzing cardiac autonomic activity</article-title>
        <source>Frontiers in Physiology</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>557</fpage>
        <pub-id pub-id-type="doi">10.3389/fphys.2016.00557</pub-id>
        <pub-id pub-id-type="pmid">27920726</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Rodenhauser et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodenhauser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Zenger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tate</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aras</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>MacLeod</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>PFEIFER: preprocessing framework for electrograms intermittently fiducialized from experimental recordings</article-title>
        <source>Journal of Open Source Software</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>21</issue>
        <fpage>472</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.00472</pub-id>
        <pub-id pub-id-type="pmid">30259008</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Sharma &amp; Sunkaria (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Sunkaria</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>A robust QRS detection using novel pre-processing techniques and kurtosis based enhanced efficiency</article-title>
        <source>Measurement</source>
        <year>2016</year>
        <volume>87</volume>
        <fpage>194</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1016/j.measurement.2016.03.015</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Thomsen et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomsen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Verduyn</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Stengl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beekman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>De Pater</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Opstal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Volders</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Vos</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Increased short-term variability of repolarization predicts d-sotalol-induced torsades de pointes in dogs</article-title>
        <source>Circulation</source>
        <year>2004</year>
        <volume>110</volume>
        <issue>16</issue>
        <fpage>2453</fpage>
        <lpage>2459</lpage>
        <pub-id pub-id-type="doi">10.1161/01.cir.0000145162.64183.c8</pub-id>
        <pub-id pub-id-type="pmid">15477402</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Varon et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Caicedo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Testelmans</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Buyse</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Huffel</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>A novel algorithm for the automatic detection of sleep apnea from single-lead ECG</article-title>
        <source>IEEE Transactions on Biomedical Engineering</source>
        <year>2015</year>
        <volume>62</volume>
        <issue>9</issue>
        <fpage>2269</fpage>
        <lpage>2278</lpage>
        <pub-id pub-id-type="doi">10.1109/tbme.2015.2422378</pub-id>
        <pub-id pub-id-type="pmid">25879836</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Vicente et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vicente</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johannesen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galeotti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Strauss</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>ECGlab: user friendly ECG/VCG analysis tool for research environments</article-title>
        <source>Computing in Cardiology</source>
        <year>2013</year>
        <volume>2013</volume>
        <fpage>775</fpage>
        <lpage>778</lpage>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Welch (1967)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Welch</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The use of fast Fourier transform for the estimation of power spectra: a method based on time averaging over short, modified periodograms</article-title>
        <source>IEEE Transactions on Audio and Electroacoustics</source>
        <year>1967</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>70</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1109/tau.1967.1161901</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
