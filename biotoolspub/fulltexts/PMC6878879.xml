<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">J. Appl. Cryst.</journal-id>
    <journal-title-group>
      <journal-title>Journal of Applied Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0021-8898</issn>
    <issn pub-type="epub">1600-5767</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6878879</article-id>
    <article-id pub-id-type="publisher-id">vh5104</article-id>
    <article-id pub-id-type="doi">10.1107/S1600576719012159</article-id>
    <article-id pub-id-type="coden">JACGAR</article-id>
    <article-id pub-id-type="pii">S1600576719012159</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computer Programs</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>FXD-CSD-GUI</italic>: a graphical user interface for the X-ray-diffraction-based determination of crystallite size distributions</article-title>
      <alt-title>
        <italic>FXD-CSD-GUI</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9453-8298</contrib-id>
        <name>
          <surname>Neher</surname>
          <given-names>Sigmund H.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1543-4886</contrib-id>
        <name>
          <surname>Klein</surname>
          <given-names>Helmut</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3860-8807</contrib-id>
        <name>
          <surname>Kuhs</surname>
          <given-names>Werner F.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>GZG Crystallography, <institution>University of Göttingen</institution>, Goldschmidtstrasse 1, Göttingen, 37077, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>sneher@gwdg.de</email>, <email>wkuhs1@gwdg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>52</volume>
    <issue>Pt 6</issue>
    <issue-id pub-id-type="publisher-id">j190600</issue-id>
    <fpage>1437</fpage>
    <lpage>1439</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Sigmund H. Neher et al. 2019</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://creativecommons.org/licenses/by/4.0/</ali:license_ref>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S1600576719012159">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>A graphical interface to the Python module <italic>fxdcsd</italic>, which analyses crystallite size distributions via Bragg intensities measured with two-dimensional detectors, is described.</p>
    </abstract>
    <abstract>
      <p>Bragg intensities can be used to analyse crystal size distributions in a method called FXD-CSD, which is based on the fast measurement of many Bragg spots using two-dimensional detectors. This work presents the Python-based software and its graphical user interface <italic>FXD-CSD-GUI</italic>. The GUI enables user-friendly data handling and processing and provides both graphical and numerical crystal size distribution results.</p>
    </abstract>
    <kwd-group>
      <kwd>FXD-CSD</kwd>
      <kwd>X-ray diffraction</kwd>
      <kwd>Bragg intensities</kwd>
      <kwd>crystal size distribution</kwd>
      <kwd>two-dimensional detectors</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Deutsche Forschungsgemeinschaft</funding-source>
        <award-id>KU920/20-1</award-id>
        <principal-award-recipient>Werner F. Kuhs</principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>Bundesministerium für Bildung und Forschung</funding-source>
        <award-id>03G0856B</award-id>
      </award-group>
      <funding-statement>This work was funded by <funding-source>Deutsche Forschungsgemeinschaft</funding-source> grant <award-id>KU920/20-1</award-id> to Werner F. Kuhs. <funding-source>Bundesministerium für Bildung und Forschung</funding-source> grant <award-id>03G0856B</award-id>. </funding-statement>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>FXD-CSD method   </title>
    <p>Fast X-ray diffraction crystal size distribution analysis, FXD-CSD (Neher <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb7"> ▸</xref>), is a reference-material-based X-ray diffraction method to derive volume-based CSDs for polycrystalline materials and powders. FXD-CSD uses the ratio of the integrated diffraction intensity of a reference to its irradiated crystal volume as a scaling factor (S1); the sample and reference do not need to be composed of the same substance. With this scaling factor, the volume CSD of an unknown sample is deduced. To obtain the integrated intensities of the sample and reference, stepwise rotation diffraction measurements have to be carried out for both. These measurements are performed with a diffractometer equipped with an area detector. To carry out the subsequent FXD-CSD analysis, the crystallographic structures (the structure factors and unit-cell volume) of the sample and reference have to be known. For intensity scaling, the CSD information of the measured reference material should be available, <italic>e.g.</italic> as measured with scanning electron microscopy and extracted by image analysis. If no full CSD is available, the mean value can be used instead as a point of reference.</p>
    <p>Stepwise rotation measurements, as used in FXD-CSD, produce large data sets in a short time. These data are reduced by extracting the individual integrated intensities of the Bragg spots detected. All extracted intensities are corrected for geometric effects (<italic>i.e.</italic> Lorentz correction) and scaled with the scattering power of the corresponding <italic>hkl</italic> plane (<italic>i.e.</italic> the structure factor <italic>F</italic>
<sup>2</sup>
<sub><italic>hkl</italic></sub>). This data reduction and scaling process is quite time intensive and therefore can only be carried out routinely with custom-built software, the Python module <italic>fxdcsd</italic>. Its graphical user interface, <italic>FXD-CSD-GUI</italic>, is presented in the following.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Graphical user interface: <italic>FXD-CSD-GUI</italic>   </title>
    <p>To facilitate the use of the <italic>fxdcsd</italic> Python module for uninitiated users, a graphical user interface, <italic>FXD-CSD-GUI</italic>, is provided and made available as part of the <italic>fxdcsd</italic> Python module. <italic>FXD-CSD-GUI</italic> allows the user to perform all necessary steps for a complete FXD-CSD analysis. Here we summarize the tools and information needed before an FXD-CSD analysis can be undertaken; for more details, we refer to Neher <italic>et al.</italic> (2018<xref ref-type="bibr" rid="bb7"> ▸</xref>) and the user manual available at <ext-link ext-link-type="uri" xlink:href="https://owncloud.gwdg.de/index.php/s/JGluHlEp0pEUcAH">https://owncloud.gwdg.de/index.php/s/JGluHlEp0pEUcAH</ext-link> and as <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">supporting information</ext-link> for this article. The following items are needed to perform a CSD analysis:</p>
    <p>(i) A diffractometer with a two-dimensional detector and at least one sample rotation axis.</p>
    <p>(ii) A reference powder with known CSD in the lower µm range (∼0.5–100 µm). The CSD should ideally be available as an individual crystal volume information data set. At least the characteristic numerical values (<italic>e.g.</italic> mean value and distribution spread from a histogram fit) of the CSD histogram are needed.</p>
    <p>(iii) Stepwise rotation measurement data sets (consecutive frames, <italic>e.g.</italic> Bruker <monospace>.sfrm</monospace> or <monospace>.tif</monospace> files) from the reference and sample acquired under the same conditions.</p>
    <p>(iv) The crystal structure of the reference material and the sample material to be investigated. This information is needed to calculate the structure factors and the cell volumes, which are necessary for a correct intensity scaling. The structure factor and cell volume calculations are not carried out using <italic>FXD-CSD-GUI</italic>. For this purpose we suggest, for example, <italic> PowderCell</italic> (Kraus &amp; Nolze, 1996<xref ref-type="bibr" rid="bb3"> ▸</xref>) or <italic>Mercury</italic> (Macrae <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb5"> ▸</xref>).</p>
    <p>During the analysis with <italic>FXD-CSD-GUI</italic>, the following steps are performed; the flow diagram in Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref> illustrates these steps, and details of the software tasks are provided by Neher <italic>et al.</italic> (2018<xref ref-type="bibr" rid="bb7"> ▸</xref>):</p>
    <p>(i) Initiating the analysis by loading the detector frames and picking the <italic>hkl</italic> rings that are to be analysed (carried out for the reference material and sample). For this task, we recommend having a plotted and indexed powder pattern at hand. Reference and sample are abbreviated as REF and SAMP within the GUI.</p>
    <p>(ii) Providing the required structure factor and unit-cell size information for both the reference and the sample and for each ring.</p>
    <p>(iii) Testing and final application of the <italic>pickpeaks</italic> function. In this step, the program detects the diffraction peaks by an intensity threshold operation. The threshold defines the intensity value used to separate the background intensity from the diffraction spot intensity. The threshold intensity level is set by the user. During testing, each parameter can be tuned manually. Most important here is the already mentioned threshold and the <monospace>ring_width</monospace> parameter, which is the width of the ring-shaped area of interest. Running the <italic>pickpeaks</italic> function can take, depending on frame size and frame number as well as the computer power, up to several hours.</p>
    <p>(iv) Running the <italic>intextract</italic> function, which first allocates the diffraction spots detected in adjacent frames and then integrates the diffraction spot intensities.</p>
    <p>(v) Conditioning the REF and SAMP data. The integrated intensities are corrected for the Lorentz–polarization factor and are scaled with their structure factors with respect to one user-chosen <italic>hkl</italic> ring. The ratio between the structure factors, normalized to their unit-cell volumes, of the two chosen <italic>hkl</italic> rings (reference and sample) is called the S2 scaling factor [see Neher <italic>et al.</italic> (2018<xref ref-type="bibr" rid="bb7"> ▸</xref>), Section 3.1]. All parameters can be manipulated by the user and one can choose which <italic>hkl</italic> rings will be included in the final CSD analysis. The results are shown as intensity histograms.</p>
    <p>(vi) Determining the S1 scaling factor between the mean of the measured reference intensity histogram and the mean value of its volume distribution – measured independently [<italic>e.g.</italic> via light scattering or scanning electron microscopy; see Neher <italic>et al.</italic> (2018<xref ref-type="bibr" rid="bb7"> ▸</xref>), Section 4]. The used mean values are determined via automated distribution fitting. The user can choose between a lognormal, Gaussian or skewed-Gaussian model. In addition, it is possible to add a custom model (see the user manual). The volume distribution either can be loaded as a csv file with comma-separated single-crystallite volume (nm<sup>3</sup>) values or can be provided as numerical values (<italic>e.g.</italic> average crystallite size and distribution spread). In the case of numerical values, the input is used for plotting a log­normal distribution (see the user manual). In our experience, a lognormal distribution is the most likely distribution shape when the reference material is produced via mechanical crushing of larger single crystals and crystal size fractions are separated from it [see Neher <italic>et al.</italic> (2018<xref ref-type="bibr" rid="bb7"> ▸</xref>), Section 4 and Section S4 of the supporting information].</p>
    <p>During the analysis, all necessary numerical inputs are explained within the interface and highlighted according to their state of input, <italic>e.g.</italic> mandatory input parameters are highlighted red when missing and turn green when they are provided consistently. The results are provided numerically and are shown graphically. The graphics can be exported in various formats (<monospace>.png</monospace>, <monospace>.jpeg</monospace>, <monospace>.svg</monospace> or <monospace>.pdf</monospace>).</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Software and hardware implementation   </title>
    <p>The program has been tested on 64 bit Windows (7 and 10) and Ubuntu Linux (16.4) machines but should also run on macOS. It is written in Python 2.7 using the default <italic>Tkinter</italic> (Lundh, 2005<xref ref-type="bibr" rid="bb4"> ▸</xref>) module for GUI programming. The plotting and frame visualization are done with the <italic>Matplotlib</italic> (Hunter, 2007<xref ref-type="bibr" rid="bb1"> ▸</xref>) module. Reading the diffractometer frames is done with <italic>fabIO</italic> (Knudsen <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb2"> ▸</xref>), which is capable of reading most of the common detector file formats. For array processing, <italic>NumPy</italic> (Oliphant, 2006<xref ref-type="bibr" rid="bb9"> ▸</xref>; <ext-link ext-link-type="uri" xlink:href="https://www.numpy.org">https://www.numpy.org</ext-link>) is used. The fitting is performed using <italic>lmfit</italic> (Newville <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb8"> ▸</xref>).</p>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Documentation and availability   </title>
    <p>The program is released under the terms of the GNU General Public Licence, either version 3 of the licence or any later version, and is available at <ext-link ext-link-type="uri" xlink:href="https://owncloud.gwdg.de/index.php/s/JGluHlEp0pEUcAH">https://owncloud.gwdg.de/index.php/s/JGluHlEp0pEUcAH</ext-link>. We only request that, for any published use, reference is made to the present publication. A user manual and test data are also provided at this address.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <p>User manual. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1107/S1600576719012159/vh5104sup1.pdf">10.1107/S1600576719012159/vh5104sup1.pdf</ext-link>
</p>
      <media mimetype="application" mime-subtype="pdf" xlink:href="j-52-01437-sup1.pdf" orientation="portrait" id="d35e126" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr M. Chaouachi and Dr A. Falenty (GZG Crystallography, University of Göttingen) for fruitful discussions on the FXD-CSD method development and the software implementation. We also acknowledge Thien An Pham (University of Göttingen) for testing the software and providing helpful feedback. We thank Leonard Wentzky und Paul Rübsamen-von Döhren (both University of Göttingen) for assistance while debugging the GUI.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Hunter, J. D. (2007). <italic>Comput. Sci. Eng.</italic>
<bold>9</bold>, 99–104.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Knudsen, E. B., Sørensen, H. O., Wright, J. P., Goret, G. &amp; Kieffer, J. (2013). <italic>J. Appl. Cryst.</italic>
<bold>46</bold>, 537–539.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Kraus, W. &amp; Nolze, G. (1996). <italic>J. Appl. Cryst.</italic>
<bold>29</bold>, 301–303.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Lundh, F. (2005). <italic>An Introduction to Tkinter</italic>, http://effbot.org/tkinterbook/.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Macrae, C. F., Bruno, I. J., Chisholm, J. A., Edgington, P. R., McCabe, P., Pidcock, E., Rodriguez-Monge, L., Taylor, R., van de Streek, J. &amp; Wood, P. A. (2008). <italic>J. Appl. Cryst.</italic>
<bold>41</bold>, 466–470.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Neher, S. H., Klein, H. &amp; Kuhs, W. F. (2018). <italic>J. Appl. Cryst.</italic>
<bold>51</bold>, 1352–1371.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Newville, M., Stensitzki, T., Allen, D. B. &amp; Ingargiola, A. (2014). <italic>LMFIT: Non-Linear Least-Square Minimization and Curve-Fitting for Python</italic>, https://doi.org/doi:10.5281/zenodo.11813.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Oliphant, T. E. (2006). <italic>A Guide to NumPy.</italic> Trelgol Publishing.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p><italic>FXD-CSD-GUI</italic> flow chart.</p>
    </caption>
    <graphic xlink:href="j-52-01437-fig1"/>
  </fig>
</floats-group>
