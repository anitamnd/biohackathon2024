<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genes (Basel)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genes (Basel)</journal-id>
    <journal-id journal-id-type="publisher-id">genes</journal-id>
    <journal-title-group>
      <journal-title>Genes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2073-4425</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7397055</article-id>
    <article-id pub-id-type="doi">10.3390/genes11070756</article-id>
    <article-id pub-id-type="publisher-id">genes-11-00756</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ShadowCaster: Compositional Methods under the Shadow of Phylogenetic Models to Detect Horizontal Gene Transfers in Prokaryotes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sánchez-Soto</surname>
          <given-names>Daniela</given-names>
        </name>
        <xref ref-type="aff" rid="af1-genes-11-00756">1</xref>
        <xref ref-type="author-notes" rid="fn1-genes-11-00756">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-9908-2418</contrib-id>
        <name>
          <surname>Agüero-Chapin</surname>
          <given-names>Guillermin</given-names>
        </name>
        <xref ref-type="aff" rid="af2-genes-11-00756">2</xref>
        <xref ref-type="aff" rid="af3-genes-11-00756">3</xref>
        <xref ref-type="author-notes" rid="fn1-genes-11-00756">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-2965-2515</contrib-id>
        <name>
          <surname>Armijos-Jaramillo</surname>
          <given-names>Vinicio</given-names>
        </name>
        <xref ref-type="aff" rid="af4-genes-11-00756">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3710-0035</contrib-id>
        <name>
          <surname>Perez-Castillo</surname>
          <given-names>Yunierkis</given-names>
        </name>
        <xref ref-type="aff" rid="af5-genes-11-00756">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tejera</surname>
          <given-names>Eduardo</given-names>
        </name>
        <xref ref-type="aff" rid="af4-genes-11-00756">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1328-1732</contrib-id>
        <name>
          <surname>Antunes</surname>
          <given-names>Agostinho</given-names>
        </name>
        <xref ref-type="aff" rid="af2-genes-11-00756">2</xref>
        <xref ref-type="aff" rid="af3-genes-11-00756">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sánchez-Rodríguez</surname>
          <given-names>Aminael</given-names>
        </name>
        <xref ref-type="aff" rid="af1-genes-11-00756">1</xref>
        <xref rid="c1-genes-11-00756" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-genes-11-00756"><label>1</label>Departamento de Ciencias Biológicas, Universidad Técnica Particular de Loja, Loja 110108, Ecuador; <email>nela.sanchez96@gmail.com</email></aff>
    <aff id="af2-genes-11-00756"><label>2</label>CIIMAR/CIMAR, Interdisciplinary Centre of Marine and Environmental Research, University of Porto, Terminal de Cruzeiros do Porto de Leixões, Av. General Norton de Matos s/n, 4450-208 Porto, Portugal; <email>gchapin@ciimar.up.pt</email> (G.A.-C.); <email>aantunes@ciimar.up.pt</email> (A.A.)</aff>
    <aff id="af3-genes-11-00756"><label>3</label>Department of Biology, Faculty of Sciences, University of Porto, Rua do Campo Alegre, 4169-007 Porto, Portugal</aff>
    <aff id="af4-genes-11-00756"><label>4</label>Grupo de Bio-Quimioinformática &amp; Carrera de Ingeniería en Biotecnología, Facultad de Ingeniería y Ciencias Agropecuarias, Universidad de Las Américas, Quito EC170125, Ecuador; <email>vinicio.armijos@udla.edu.ec</email> (V.A.-J.); <email>eduardo.tejera@udla.edu.ec</email> (E.T.)</aff>
    <aff id="af5-genes-11-00756"><label>5</label>Grupo de Bio-Quimioinformática &amp; Escuela de Ciencias Físicas y Matemáticas, Universidad de Las Américas, Quito EC170125, Ecuador; <email>yunierkis.perez@udla.edu.ec</email></aff>
    <author-notes>
      <corresp id="c1-genes-11-00756"><label>*</label>Correspondence: <email>asanchez2@utpl.edu.ec</email>; Tel.: +593-07-370-1444</corresp>
      <fn id="fn1-genes-11-00756">
        <label>†</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>07</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <issue>7</issue>
    <elocation-id>756</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 by the authors.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Horizontal gene transfer (HGT) plays an important role for evolutionary innovations within prokaryotic communities and is a crucial event for their survival. Several computational approaches have arisen to identify HGT events in recipient genomes. However, this has been proven to be a complex task due to the generation of a great number of false positives and the prediction disagreement among the existing methods. Phylogenetic reconstruction methods turned out to be the most reliable ones, but they are not extensible to all genes/species and are computationally demanding when dealing with large datasets. In contrast, the so-called surrogate methods that use heuristic solutions either based on nucleotide composition patterns or phyletic distribution of BLAST hits can be applied easily to the genomic scale, but they fail in identifying common HGT events. Here, we present ShadowCaster, a hybrid approach that sequentially combines nucleotide composition-based predictions by support vector machines (SVMs) under the shadow of phylogenetic models independent of tree reconstruction, to improve the detection of HGT events in prokaryotes. ShadowCaster successfully predicted close and distant HGT events in both artificial and bacterial genomes. ShadowCaster detected HGT related to heavy metal resistance in the genome of <italic>Rhodanobacter denitrificans</italic> with higher accuracy than the most popular state-of-the-art computational approaches, encompassing most of the predicted cases made by other methods. ShadowCaster is released at the GitHub platform as an open-source software under the GPLv3 license.</p>
    </abstract>
    <kwd-group>
      <kwd>horizontal gene transfer</kwd>
      <kwd>parametric method</kwd>
      <kwd>implicit phylogenetic model</kwd>
      <kwd>hybrid approach</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-genes-11-00756">
    <title>1. Introduction</title>
    <p>Lateral or horizontal gene transfer (HGT) plays an important role in the genome evolution and ecological innovation of prokaryotic communities. Microbial communities can be considered as complex biological systems where its individuals exchange genes by HGT events. HGTs in bacteria and archaea communities occur more frequently between closely related species than in distant lineages [<xref rid="B1-genes-11-00756" ref-type="bibr">1</xref>]. Some lineage-specific genes, i.e., genes found in one particular taxonomic group and that arise from close HGT events, are usually lost quickly if they result in reduced fitness. By contrast, other lineage-specific genes are retained for longer periods of time if they provide selective advantages for survival in the recipient lineage, especially when environmental conditions do not change much [<xref rid="B2-genes-11-00756" ref-type="bibr">2</xref>]. Rates of HGT events involving genes critical for survival, growth, and reproduction are particularly high among members of microbial communities that need a quick adaptation to complex environments such as contaminated soil or water [<xref rid="B3-genes-11-00756" ref-type="bibr">3</xref>]. Detecting HGT has been a major focus of attention to better understand microbial evolution. However, it has proven to be a complex and challenging task.</p>
    <p>HGT detection tools can be divided into two main classes: parametric and phylogenetic methods. Parametric methods search for sections of a putative recipient genome that greatly differ from the mean nucleotide composition based on metrics such as oligonucleotide frequencies, guanine and cytosine (GC)content or codon usage. Genes exhibiting highly compositional fluctuations from the genomic mean are called atypical or alien genes and their origin is expected to be exogenous. Phylogenetic methods integrate information from multiple genomes and find evolutionary incongruencies while reconciling gene trees with the reference species tree [<xref rid="B4-genes-11-00756" ref-type="bibr">4</xref>]. Both parametric and phylogenetic methods are based on the hypothesis that acquired genes bring “perturbations” to the recipient genome, and that such perturbing signal stands out from the background noise (fluctuations in the recipient genome that arise from other scenarios rather than from HGT events), regardless the age of the event. </p>
    <p>To date, there is no unique method capable of detecting all the HGT events of different ages in a recipient genome because each of the methods have their own advantages and limitations. Phylogenetic methods are best at identifying ancient HGT events, providing a large number of orthologs and the generation of a reliable species tree [<xref rid="B5-genes-11-00756" ref-type="bibr">5</xref>,<xref rid="B6-genes-11-00756" ref-type="bibr">6</xref>]. Evolutionary processes other than HGT, i.e., gene duplication and differential gene loss, can also explain incongruences between genes and species trees, which hinder the performance of phylogenetic methods [<xref rid="B7-genes-11-00756" ref-type="bibr">7</xref>,<xref rid="B8-genes-11-00756" ref-type="bibr">8</xref>]. Parametric methods deal best with recent HGT events that result in noticeable perturbations to the recipient genome mean nucleotidic signature. Over time, however, gene amelioration dilutes the signal of HGT events due to the quick loss of nucleotide compositional differences which drastically reduces the detection power of parametric methods [<xref rid="B9-genes-11-00756" ref-type="bibr">9</xref>]. In the presence of gene amelioration, the parametric method′s predictions become inaccurate and should be validated by phylogenetic approaches to reduce both false positive and negative predictions [<xref rid="B10-genes-11-00756" ref-type="bibr">10</xref>,<xref rid="B11-genes-11-00756" ref-type="bibr">11</xref>]. Nevertheless, explicit phylogenetic methods (tree building-based) are not practical at the large scale, e.g., comprising entire gene repertoires, because they are computationally expensive and time consuming [<xref rid="B12-genes-11-00756" ref-type="bibr">12</xref>]. In this sense, several methods with rather implicit phylogenetic approaches have arisen. These methods are mainly based on phyletic distribution derived from BLAST searches in order to speed up atypical gene detection in multiple genomes/taxa since they bypass gene tree reconstruction, e.g., DarkHorse [<xref rid="B13-genes-11-00756" ref-type="bibr">13</xref>], HGTector [<xref rid="B14-genes-11-00756" ref-type="bibr">14</xref>] and HGT-Finder [<xref rid="B12-genes-11-00756" ref-type="bibr">12</xref>].</p>
    <p><xref rid="genes-11-00756-t001" ref-type="table">Table 1</xref> shows the state-of-the-art of HGT detection methods that rely on different information sources and when applied to the same dataset often generate partially overlapping predictions. Discrepancies among tools might be resolved by combining parametric and phylogenetic methods. It is still unclear what could be the best way to combine different methods without increasing the false discovery rate (FDR) [<xref rid="B4-genes-11-00756" ref-type="bibr">4</xref>,<xref rid="B15-genes-11-00756" ref-type="bibr">15</xref>]. </p>
    <p>Here, we developed an open-source software called ShadowCaster that consists of the sequential incorporation of parametric and phylogenetic information to improve the detection of HGT events in prokaryotes. ShadowCaster firstly employs a One-class support vector machine (SVM) classifier based on two compositional features to identify putative atypical genes within the genome of the recipient species. ShadowCaster then estimates a Bayesian likelihood, inferred from an implicit phylogenetic model built by aggregating the proteomes of closely and distantly related taxa to the recipient species to construct a phylogenetic shadow. ShadowCaster finally decides, based on the Bayesian likelihood, whether the predicted atypical genes in the recipient species were vertically or horizontally acquired. To carry this out, two inheritance models—vertical and horizontal inheritance—are interrogated to see which one best explains the acquisition of an atypical gene in the recipient genome. In a pure vertical inheritance model, the number of orthologs shared by the species in the phylogenetic shadow serves as a proxy of the phylogenetic distance among species. Closely related species are supposed to share more orthologs (with higher sequence similarity) than the distantly related ones. As a result, a shared orthology probability distribution can be drawn as a curve on top of the phylogenetic shadow. In plain words, ShadowCaster detects HGT events as violations to the pure vertical inheritance model. These are cases in which an atypically conserved gene is present in a pair of species with a shared low orthology probability that is not able to explain such high sequence conservation. </p>
    <p>We applied ShadowCaster to predict genome-wide close and distant HGT events in artificial and bacterial genomes. The hybrid nature of ShadowCaster allowed for the prediction of new HGT events in real-world data and demonstrated its improved performance compared to pure parametric methods and to those based on phyletic frameworks. In addition, ShadowCaster predictions showed the highest agreement with those obtained by other methods.</p>
  </sec>
  <sec id="sec2-genes-11-00756">
    <title>2. Design and Implementation</title>
    <p>ShadowCaster is an open-source software capable of detecting HGT events in prokaryotes by performing three major tasks: (i) atypical genes identification by One-class SVM, (ii) phylogenetic shadowing model construction, and (iii) per gene likelihood calculation expressing how likely an atypical gene has been vertically inherited. There are two main components in ShadowCaster to carry out these tasks: one parametric and one phylogenetic. The parametric component uses the genome of the query species to extract nucleotide compositional information during the task (i), while the phylogenetic component starts from the proteomes of the query and of other related species covering a diverse spectrum of phylogenetic distances, to perform tasks (ii) and (iii). </p>
    <sec id="sec2dot1-genes-11-00756">
      <title>2.1. Parametric Component</title>
      <p>For the identification of atypical genes, we implemented a parametric component that combines two features, each using a particular metric to assess the compositional difference between each gene and the entire genome. Features were implemented as suggested by Becq et al. [<xref rid="B6-genes-11-00756" ref-type="bibr">6</xref>]. The first feature corresponded to the gene length normalized tetranucleotide (4-mers) frequencies with Chi-square as metric and the second was the codon usage with Kullback–Leibler as metric. The per-gene values of each feature were compared to the corresponding value calculated from the entire coding sequence of the genome (i.e., a concatenation of all genes in the species). </p>
      <p>To classify each gene as atypical based on features values, the One-class support vector machine (SVM) was used, since this method is able to perform the outlier detection in an unsupervised fashion. The goal of the One-class SVM (<xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>B) was to separate the native genes (i.e., those with a composition that does not differ greatly from the one of the entire genomes) (gray dots in <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>B), from atypical genes (green and red dots in <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>B) by the estimation of a support distribution. This model requires the selection of a kernel function (radial basis function in our case), and the specification of the bounds of the fraction of support vectors and training errors to use as defined by the user via the “<italic>nu</italic> parameter” (see technical details in [<xref rid="B21-genes-11-00756" ref-type="bibr">21</xref>] and references therein). In our implementation, the <italic>nu</italic> parameter can be tuned by the user depending on the type of HGT events to detect, i.e., close, medium-far and far events (see below how the <italic>nu</italic> parameter affects the predictions made by ShadowCaster). Genes classified as outliers by the One-class SVM represent the group of atypical genes that constitute the output of the parametric component and one of the inputs of the phylogenetic component.</p>
    </sec>
    <sec id="sec2dot2-genes-11-00756">
      <title>2.2. Phylogenetic Component</title>
      <p>The list of atypical genes detected by the parametric component is still putative and might contain spurious results (e.g., native genes that did not arise from true HGT events). The aim of the phylogenetic component is then to create a filter capable of differentiating genes that truly arose from HGT events from those native genes that show an atypical composition but that were vertically inherited. The model behind ShadowCaster (<xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>A) builds on the previous knowledge that the amount of true orthologous genes shared between a given species pair decreases with the phylogenetic distance that separates them [<xref rid="B22-genes-11-00756" ref-type="bibr">22</xref>]. In such scenario, a vertically inherited gene in a recipient species, will show a decreasing sequence identity with its orthologs in increasingly distant species. If one sees the sequence identity between two proteins as a proxy of orthology, and constructs a probability function across a species phylogenetic tree will see a shadowing shape as represented in <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>A (green curve). A horizontally inherited gene will in contrast disrupt the shadowing shape of the orthology probability function creating a peak around the acceptor species (see the orange, light red and deep red curves in <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>A). </p>
      <p>We took advantage of the contrasting behavior of vertically versus horizontally inherited genes in terms of orthology probability distribution across the species tree. While events of vertical and horizontal inheritance are both consistent with the shared orthology probability <italic>P</italic><sub>0</sub> values and distributions (green and orange curves, <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>A) in close-related species pairs, this is different for medium far and far species pairs. When the phylogenetic distance increases between donor and acceptor species, the shared orthology probability decreases as well as the probability of finding orthologs with high sequence identity between them. In addition, the magnitude of the decrement in shared orthology probability (<italic>P</italic><sub>0</sub>) is different for medium and far HGT events (light red and red curves contrasted by the shadow of the green curve, <xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>A). With such considerations, we then applied a Bayesian inference to estimate how likely is that a given gene has been vertically inherited.</p>
      <p>When applied to our phylogenetic shadowing model, Bayes′ theorem for probability distributions can be expressed as follows (Equations (1) and (2)):<disp-formula id="FD1-genes-11-00756"><label>(1)</label><mml:math id="mm1"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>∝</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD2-genes-11-00756"><label>(2)</label><mml:math id="mm2"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>I</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm3"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> is a vector of protein sequence identities corresponding to the best hits of an atypical sequence in each of the proteomes included in the phylogenetic shadow, and <inline-formula><mml:math id="mm4"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> represents the vertical inheritance model derived from comparing the full proteomes included in the phylogenetic shadow in a pairwise fashion. The distribution <inline-formula><mml:math id="mm5"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the sampling density for <inline-formula><mml:math id="mm6"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>, describing the probability that an atypical sequence with an identity higher than 55% follows the vertical inheritance model; <inline-formula><mml:math id="mm7"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the prior phylogenetic distribution determined by the probability of orthologs (<italic>P</italic><sub>0</sub>) between the query species and the species in the phylogenetic shadow; finally, <inline-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the posterior distribution of <inline-formula><mml:math id="mm9"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. Log-likelihoods for all atypical sequences detected by the parametric component in a given recipient genome were derived from Equation (2). </p>
      <p>To determine the number of orthologs between the species, we used OrthoMCL-pipeline (<uri xlink:href="https://github.com/apetkau/orthomcl-pipeline">https://github.com/apetkau/orthomcl-pipeline</uri>). To derive the vertical inheritance model (<inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), the mean and standard deviation of all protein sequence identities resulted from the global alignments between each proteome pair were considered as well as the predicted atypical sequences longer than 70 amino acids. The log-likelihoods of all atypical sequences were classified in two classes with fuzzy clustering (<xref ref-type="fig" rid="genes-11-00756-f001">Figure 1</xref>C). The group with lower values of likelihood represented the genes predicted as HGT events and the other the vertically inherited genes with an unusual composition.</p>
      <p>As shown, our phylogenetic inference is based on a phylogenetic shadowing model instead of on explicitly deriving a phylogenetic tree. To construct this model, it is important to have enough species that are closely-related to the query sequence in order to detect orthology relationships, but also a correct number of species that explains sequence divergence gradually. Thus, the phylogenetic shadow is constructed by species from different phylogenetic distances based on the taxonomy of the query species. In order to best describe sequence divergence across species, our phylogenetic shadowing model is built with proteomes from species related with the query according to the following taxonomic weights: 40% of species from the same family, 20% of species from the same order, 20% of species from the same phylum, 12% of species from the same kingdom and 8% of species from another prokaryotic kingdom.</p>
      <p>Proteomes are retrieved from the NCBI ftp by using the helper script “get_proteomes.py”. In case that there are not enough sequences to complete the percentage assigned to any of the ranks, the difference will be added to the upper taxonomic rank in order to complete with the total number of sequences to construct the phylogenetic shadow. As an example, if we consider <italic>Escherichia coli</italic> as the query species, its phylogenetic shadow will be composed by 40% of proteomes from Enterobacteriaceae, 20% Enterobacterales, 20% Proteobacteria, 12% Bacteria, and 8% Archaea.</p>
      <p>ShadowCaster was mainly implemented in Python but shares functions of R and Perl too. There are minimal external dependencies (e.g., OrthoMCL [<xref rid="B23-genes-11-00756" ref-type="bibr">23</xref>], Blastp and EMBOSS package for running the phylogenetic component). A script to build the phylogenetic shadow is provided to help the user with the input requirements (more information is supplied in the documentation of ShadowCaster at <uri xlink:href="https://shadowcaster.readthedocs.io/en/latest/">https://shadowcaster.readthedocs.io/en/latest/</uri>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-genes-11-00756">
    <title>3. Results and Discussion</title>
    <sec id="sec3dot1-genes-11-00756">
      <title>3.1. Performance on Simulated Data</title>
      <p>To determine the robustness of ShadowCaster’s approach, we conducted experiments using simulated sets from artificial gene transfers of different origins. For this purpose, an artificial genome was modeled to be the recipient sequence based on <italic>Escherichia coli K-12 substr. MG1655</italic> genome. Native genes were extracted from the genome using k-mers and codon usage properties, this step ensures the removal of highly atypical genes. We created three datasets with transfers from different phylogenetic distance species like <italic>Methanocaldococcus jannaschii</italic> (far), <italic>Sinorhizobium meliloti</italic> (medium-far) and <italic>Salmonella enterica</italic> (close). These species are also placed at different taxonomic distances to <italic>E. coli</italic>. <italic>Methanocaldococcus jannaschii</italic> (far) belongs to Archaea, order: Methanococcales, family: Methanocaldococcaceae and genus: Methanocaldococcus. <italic>Sinorhizobium meliloti</italic> (medium-far) is a bacterium belonging to the order: Rhizobiales, family: Rhizobiaceae and genus: Sinorhizobium. <italic>Salmonella enterica</italic> is a closely related bacterium to <italic>E. coli,</italic> both belong to the same order and family. For each set, we randomly transferred ten genes that had no orthology with the recipient sequence from the donor species previously mentioned.</p>
      <p>We tested the effect of two parameters of ShadowCaster: <italic>nu</italic> parameter and the number of proteomes needed to construct the phylogenetic shadow. The <italic>nu</italic> parameter used in the parametric component was varied from 0.1 to 1.0 and the number of proteomes was changed from 10 to 30. The purpose of these tests is to find the optimal combination of these parameters to achieve the best performance of ShadowCaster depending on the origin of HGT events. <xref ref-type="fig" rid="genes-11-00756-f002">Figure 2</xref> shows the curves for True and False Positive Rates of the tested parameters.</p>
      <p>The influence of the <italic>nu</italic> parameter was only evaluated on the HGT detection within the group of atypical genes. The following conclusions can be made from these curves:<list list-type="order"><list-item><p>ShadowCaster identifies with the highest precision the HGT events from medium-far and far donors due to the differences in nucleotide composition content and orthologs. The recommended value of <italic>nu</italic> is 0.4.</p></list-item><list-item><p>At the end of the parametric component, close HGT events are complex to classify within the group of atypical genes due to the similarity they share with the recipient sequence. This issue can be solved by incrementing the <italic>nu</italic> value but it is important to emphasize that will also increase the false positive rate (FPR).</p></list-item><list-item><p>True and False Positive Rates did not change significantly with the increase of the number of proteomes/species in the phylogenetic shadow. The recommended starting number of proteomes is 15 since a small drop of the FPR was observed for the first time at this value. However, for extensive analyses in real datasets where the origin of the HGT is unknow, the number of proteomes could be increased up to 25. Considering that this parameter does not significantly affect the TPR and FPR, adding relevant information to the phylogenetic shadow tend to improve the quality of HGT detections. Please, see an example of ShadowCaster′s predictions belonging to its parametric and phylogenetic component on the real dataset used in the next section at <uri xlink:href="https://github.com/dani2s/ShadowCaster_testData">https://github.com/dani2s/ShadowCaster_testData</uri>.</p></list-item></list></p>
    </sec>
    <sec id="sec3dot2-genes-11-00756">
      <title>3.2. Performance on a Real Dataset. Comparison with the Most Popular State-Of-The-Art Computational Tools</title>
      <p>To show the purpose of using a hybrid approach in the detection of HGT events, we validate ShadowCaster with a real genome, <italic>Rhodanobacter denitrificans</italic> 2APBS1 (NC_020541.1), retrieved from Hemme et al. [<xref rid="B3-genes-11-00756" ref-type="bibr">3</xref>]. <italic>Rhodanobacter denitrificans</italic> sp. belong to the Gamma-proteobacteria (g-proteobacteria) class that is populated by several genera resistant to environmental harsh conditions, e.g., low pH, high temperatures and concentrations of sulfur, nitrate and metals. In particular, <italic>Rhodanobacter</italic> populations are frequently found within niches with low pH and high levels of nitrate and heavy metals [<xref rid="B3-genes-11-00756" ref-type="bibr">3</xref>]. Hemme et al. analyzed fifty-one genes related to heavy metal resistance in the metagenome of <italic>Rhodanobacter</italic> populations living in contaminated-groundwater. A total of 39 genes were identified as HGT genes by at least one bioinformatic tool. We compare our results to the two best performing tools applied on their work, DarkHorse and AlienHunter, and also to another of the state-of-the art methods based on blast searches, HGTector.</p>
      <p>As we ignore the origin of the HGT events, we took the best values obtained from the experiments with the three simulated datasets to run ShadowCaster, the <italic>nu</italic> parameter was set to 0.4 and the number of proteomes to build the phylogenetic shadow to 25. With the aim of comparison, DarkHorse and AlienHunter were run in the same way as mentioned in Hemme′s methods [<xref rid="B3-genes-11-00756" ref-type="bibr">3</xref>]. For more details about the parameter settings used to run the three tools, see <xref ref-type="app" rid="app1-genes-11-00756">Table S1 of Supplementary File S1</xref>. Furthermore, the elapsed time during the HGT detections in <italic>Rhodanobacter denitrificans</italic> was estimated for each software, considering as putative donors a non-redundant subset of genomes/taxa from the NCBI (<xref ref-type="app" rid="app1-genes-11-00756">File S2</xref>). Such genome-wide detections were performed by using a workstation (Intel(R) Xeon(R) CPU E5-2640 v2 @ 2.00GHz) that uses 16 threads with a RAM memory of 64 GB and Ubuntu 18.04.4 LTS as Operating System.</p>
      <p>HGT detections of ShadowCaster and of the other methods are summarized in <xref ref-type="fig" rid="genes-11-00756-f003">Figure 3</xref>. The running-time for each method is shown in the figure′s legend. The use of our hybrid approach allows identifying a consensus of genes that are separately identified by the other methods. ShadowCaster and AlienHunter were the two best tools to detect HGT genes associated with metal resistance.</p>
      <p>In prokaryotes, genes acquired horizontally typically tend to code enzymes that are responsible for the growth of metabolic networks [<xref rid="B24-genes-11-00756" ref-type="bibr">24</xref>]. Because this dataset represents a microbial population with extreme exposure to heavy metal contamination, we wanted to understand the contribution degree of the genes detected as HGT to the metabolic pathways for heavy metals. The analysis of Gene Ontology (GO) terms (<xref ref-type="fig" rid="genes-11-00756-f004">Figure 4</xref>) shows that the genes predicted by ShadowCaster enrich more for enzymatic activities/systems related to heavy metals metabolism (highlighted in blue) than those of AlienHunter, DarkHorse and HGTector. These results confirm the benefits of using a hybrid approach in the detection of HGT events. </p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4-genes-11-00756">
    <title>4. Conclusions</title>
    <p>We presented a new software called ShadowCaster, aimed to improve the detection quality of HGT events in prokaryotes by reducing the number of false positives and the frequently disagreements between the predictions made by parametric methods and by those with implicit phylogenetic models. ShadowCaster is a hybrid approach that sequentially combines a parametric method consisting in One-class SVM classifier trained with two types of compositional features (<italic>k-</italic>mers and codon usage) under the shadow of an implicit phylogenetic model built on the basis that the number of orthologs shared between two species is a proxy of the phylogenetic distance. Thus, it implements an evolutionary model to calculate a Bayesian likelihood for each predicted atypical gene with an unusual sequence composition according to the host genome background in order to detect “true” HGT events in prokaryotes. The software successfully predicted close and distant HGT events in both artificially modified and unaltered bacterial genomes. Its predictions showed the highest agreement with those obtained by state-of-the-art HGT predictive tools, solving, to some extent, the issue addressed by Dessimoz et al. [<xref rid="B4-genes-11-00756" ref-type="bibr">4</xref>] about how to combine different methods or analyzing their predictions without affecting false positive rates.</p>
    <p>ShadowCaster can be found at <uri xlink:href="https://github.com/dani2s/ShadowCaster">https://github.com/dani2s/ShadowCaster</uri> as an open-source software under the GPLv3 license. Source code is hosted at and documentation at <uri xlink:href="https://shadowcaster.readthedocs.io/en/latest/">https://shadowcaster.readthedocs.io/en/latest/</uri>.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="app1-genes-11-00756">
      <title>Supplementary Materials</title>
      <p>The following are available online at <uri xlink:href="https://www.mdpi.com/2073-4425/11/7/756/s1">https://www.mdpi.com/2073-4425/11/7/756/s1</uri>. File S1 contains Table S1: Settings used for running state-of-art methods and output processing during the detection of HGT events in <italic>R. denitrificans 2APBS1</italic>; File S2: List of genomes/taxa considered for HGT detections at multiple genome-scale.</p>
      <supplementary-material content-type="local-data" id="genes-11-00756-s001">
        <media xlink:href="genes-11-00756-s001.zip">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization of the methodology, A.S.-R.; software development, D.S.-S.; validation of the methodology/software, D.S.-S. and G.A.-C.; formal analyses and data curation, V.A.-J., Y.P.-C. and E.T.; writing—original draft preparation, D.S.-S., G.A.-C. and A.S.-R.; writing—review and editing, A.A., A.S.-R. and G.A.-C. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This work was partially supported by the Strategic Funding UID/Multi/04423/2019 through national funds provided by the Portuguese Foundation for Science and Technology (Fundação para a Ciência e a Tecnologia-FCT) and European Regional Development Fund (ERDF) in the framework of the programme PT2020. AA was partially supported by the FCT project PTDC/AAG-GLO/6887/2014 (POCI-01-0124-FEDER-016845) and PTDC/CTA-AMB/31774/2017 (POCI-01-0145-FEDER/031774/2017). V.A.-J and E.T was supported by the Universidad de Las Américas-Quito (Project: BIO.VAJ.18.03).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest. The funders had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, or in the decision to publish the results.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-genes-11-00756">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andam</surname>
            <given-names>C.P.</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>Biased gene transfer in microbial evolution</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>543</fpage>
        <lpage>555</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2593</pub-id>
        <?supplied-pmid 21666709?>
        <pub-id pub-id-type="pmid">21666709</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-genes-11-00756">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Golding</surname>
            <given-names>G.B.</given-names>
          </name>
        </person-group>
        <article-title>The fate of laterally transferred genes: Life in the fast lane to adaptation or death</article-title>
        <source>Genome Res.</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>636</fpage>
        <lpage>643</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.4746406</pub-id>
        <pub-id pub-id-type="pmid">16651664</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-genes-11-00756">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hemme</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Rishishwar</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Prakash</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Pettenato</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Deutschbauer</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Van Nostrand</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lateral Gene Transfer in a Heavy Metal-Contaminated-Groundwater Microbial Community</article-title>
        <source>MBio</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>e02234-15</fpage>
        <pub-id pub-id-type="doi">10.1128/mBio.02234-15</pub-id>
        <pub-id pub-id-type="pmid">27048805</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-genes-11-00756">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ravenhall</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Škunca</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lassalle</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Inferring horizontal gene transfer</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <elocation-id>e1004095</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004095</pub-id>
        <?supplied-pmid 26020646?>
        <pub-id pub-id-type="pmid">26020646</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-genes-11-00756">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adato</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Ninyo</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Gophna</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Snir</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Detecting Horizontal Gene Transfer between Closely Related Taxa</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <elocation-id>e1004408</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004408</pub-id>
        <?supplied-pmid 26439115?>
        <pub-id pub-id-type="pmid">26439115</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-genes-11-00756">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becq</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Churlaud</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Deschavanne</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of parametric methods for horizontal transfers detection</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <elocation-id>e9989</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009989</pub-id>
        <?supplied-pmid 20376325?>
        <pub-id pub-id-type="pmid">20376325</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-genes-11-00756">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poptsova</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>The power of phylogenetic approaches to detect horizontally transferred genes</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2007</year>
        <volume>7</volume>
        <elocation-id>45</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2148-7-45</pub-id>
        <pub-id pub-id-type="pmid">17376230</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-genes-11-00756">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaneveld</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Nemergut</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Are all horizontal gene transfers created equal? Prospects for mechanism-based studies of HGT patterns</article-title>
        <source>Microbiology</source>
        <year>2008</year>
        <volume>154</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1099/mic.0.2007/011833-0</pub-id>
        <pub-id pub-id-type="pmid">18174121</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-genes-11-00756">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragan</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Harlow</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Beiko</surname>
            <given-names>R.G.</given-names>
          </name>
        </person-group>
        <article-title>Do different surrogate methods detect lateral genetic transfer events of different relative ages?</article-title>
        <source>Trends Microbiol.</source>
        <year>2006</year>
        <volume>14</volume>
        <fpage>4</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tim.2005.11.004</pub-id>
        <pub-id pub-id-type="pmid">16356716</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-genes-11-00756">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koski</surname>
            <given-names>L.B.</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Golding</surname>
            <given-names>G.B.</given-names>
          </name>
        </person-group>
        <article-title>Codon bias and base composition are poor indicators of horizontally transferred genes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2001</year>
        <volume>18</volume>
        <fpage>404</fpage>
        <lpage>412</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003816</pub-id>
        <pub-id pub-id-type="pmid">11230541</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-genes-11-00756">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Limitations of compositional approach to identifying horizontally transferred genes</article-title>
        <source>J. Mol. Evol.</source>
        <year>2001</year>
        <volume>53</volume>
        <fpage>244</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.1007/s002390010214</pub-id>
        <?supplied-pmid 11523011?>
        <pub-id pub-id-type="pmid">11523011</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-genes-11-00756">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ekstrom</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>HGT-Finder: A New Tool for Horizontal Gene Transfer Finding and Application to Aspergillus genomes</article-title>
        <source>Toxins</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>4035</fpage>
        <lpage>4053</lpage>
        <pub-id pub-id-type="doi">10.3390/toxins7104035</pub-id>
        <?supplied-pmid 26473921?>
        <pub-id pub-id-type="pmid">26473921</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-genes-11-00756">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Podell</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gaasterland</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>DarkHorse: A method for genome-wide prediction of horizontal gene transfer</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R16</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-2-r16</pub-id>
        <?supplied-pmid 17274820?>
        <pub-id pub-id-type="pmid">17274820</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-genes-11-00756">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Kosoy</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Dittmar</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>HGTector: An automated method facilitating genome-wide discovery of putative horizontal gene transfers</article-title>
        <source>BMC Genom.</source>
        <year>2014</year>
        <volume>15</volume>
        <elocation-id>717</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-717</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-genes-11-00756">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragan</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Beiko</surname>
            <given-names>R.G.</given-names>
          </name>
        </person-group>
        <article-title>Lateral genetic transfer: Open issues</article-title>
        <source>Philos. Trans. R. Soc. Lond. B Biol. Sci.</source>
        <year>2009</year>
        <volume>364</volume>
        <fpage>2241</fpage>
        <lpage>2251</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2009.0031</pub-id>
        <pub-id pub-id-type="pmid">19571244</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-genes-11-00756">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vernikos</surname>
            <given-names>G.S.</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Interpolated variable order motifs for identification of horizontally acquired DNA: Revisiting the Salmonella pathogenicity islands</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2196</fpage>
        <lpage>2203</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl369</pub-id>
        <pub-id pub-id-type="pmid">16837528</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-genes-11-00756">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsirigos</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>A sensitive, support-vector-machine method for the detection of horizontal gene transfers in viral, archaeal and bacterial genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>3699</fpage>
        <lpage>3707</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki660</pub-id>
        <pub-id pub-id-type="pmid">16006619</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-genes-11-00756">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ménigaud</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mallet</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Picord</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Churlaud</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Borrel</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Deschavanne</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>GOHTAM: A website for “Genomic Origin of Horizontal Transfers, Alignment and Metagenomics”</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1270</fpage>
        <lpage>1271</lpage>
        <pub-id pub-id-type="pmid">22426345</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-genes-11-00756">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Towards a better detection of horizontally transferred genes by combining unusual properties effectively</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <elocation-id>e43126</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0043126</pub-id>
        <pub-id pub-id-type="pmid">22905214</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-genes-11-00756">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azad</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>J.G.</given-names>
          </name>
        </person-group>
        <article-title>Towards more robust methods of alien gene detection</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e56</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr059</pub-id>
        <pub-id pub-id-type="pmid">21297116</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-genes-11-00756">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schölkopf</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Platt</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Shawe-Taylor</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Smola</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <article-title>Estimating the support of a high-dimensional distribution</article-title>
        <source>Neural Comput.</source>
        <year>2001</year>
        <volume>13</volume>
        <fpage>1443</fpage>
        <lpage>1471</lpage>
        <pub-id pub-id-type="doi">10.1162/089976601750264965</pub-id>
        <pub-id pub-id-type="pmid">11440593</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-genes-11-00756">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabaldón</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>E.V.</given-names>
          </name>
        </person-group>
        <article-title>Functional and evolutionary implications of gene orthology</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>360</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3456</pub-id>
        <pub-id pub-id-type="pmid">23552219</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-genes-11-00756">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>OrthoMCL: Identification of Ortholog Groups for Eukaryotic <italic>Genomes</italic></article-title>
        <source>Genome Res.</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>2178</fpage>
        <lpage>2189</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1224503</pub-id>
        <pub-id pub-id-type="pmid">12952885</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-genes-11-00756">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pál</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Papp</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Lercher</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Adaptive evolution of bacterial metabolic networks by horizontal gene transfer</article-title>
        <source>Nat. Genet.</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>1372</fpage>
        <lpage>1375</lpage>
        <pub-id pub-id-type="pmid">16311593</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="genes-11-00756-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Graphical representation of the conceptual model behind ShadowCaster and of its main outputs. (<bold>A</bold>) Probability of true orthology between three gene pairs shared by a recipient species and three phylogenetically related donor species, respectively (species tree in the left-hand side). True orthology probability values (<italic>P</italic><sub>0</sub>) are sampled from probability distributions according to: vertical inheritance (phylogenetic shadowing model defined by the number of orthologs sharing recipient-donor species at different phylogenetic distances, green panel); and lateral inheritance (horizonal gene transfer (HGT)) model, gradient color curves from orange to deep red represent the <italic>P</italic><sub>0</sub> distribution in true HGT events occurring at different phylogenetic distance along the species tree). <italic>P</italic><sub>0</sub> decreases in both vertical and lateral inheritances with the increase of the phylogenetic distance, however <italic>P</italic><sub>0</sub> distribution (curves) is different between them, especially for medium and far distances. (<bold>B</bold>) The distribution/separation of typical (in grey color) and atypical (in red and green color) genes achieved by the parametric component of ShadowCaster (4-mer frequency and codon usage). (<bold>C</bold>) Log-likelihoods for all atypical genes detected by the parametric component in a given recipient genome. Log-likelihoods and <italic>P</italic><sub>0</sub> are related by Equation (2).</p>
    </caption>
    <graphic xlink:href="genes-11-00756-g001"/>
  </fig>
  <fig id="genes-11-00756-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>True positive (TP) and False positive (FP) rate curves for showing the performance of ShadowCaster according to the two user defined parameters: <italic>nu</italic> and number of proteomes. TP and FP rate curves corresponding to the <italic>nu</italic> parameter are shown in (<bold>A</bold>,<bold>B</bold>) while (<bold>C</bold>,<bold>D</bold>) display the same curves influenced by the number of proteomes.</p>
    </caption>
    <graphic xlink:href="genes-11-00756-g002"/>
  </fig>
  <fig id="genes-11-00756-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Venn diagram illustrating the HGT events detected by three of the state-of-the-art computational tools (AlienHunter, DarkHorse and HGTector), and by the presented methodology ShadowCaster in the genome of <italic>Rhodanobacter denitrificans</italic> 2APBS1. HGT predictions performed by each tool is framed inside a coloured ellipse. All HGT detections are shown for each tool (black numbers inside each ellipse): AlienHunter (571), DarkHorse (1007), HGTector (649) and ShadowCaster (940) while HGT events related to heavy metal resistance are labelled in bold numbers: AlienHunter (27), DarkHorse (21), HGTector (2) and ShadowCaster (29). Elapsed time during the HGT detections by AlienHunter (31 min 43 s), DarkHorse (93 min 57 s), HGTector (66 min 03 s) and ShadowCaster (103 min 02 s).</p>
    </caption>
    <graphic xlink:href="genes-11-00756-g003"/>
  </fig>
  <fig id="genes-11-00756-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Gene Ontology (GO) Enrichment Analysis. Distribution of GO-InterPro terms exhibiting statistical significance difference (Fisher Exact Test, filtering p-values for multiple testing using False Discovery Rate) for all HGT detections performed by ShadowCaster (<bold>A</bold>), AlienHunter (<bold>B</bold>), DarkHorse (<bold>C</bold>) and HGTector (<bold>D</bold>) in the genome of <italic>Rhodanobacter denitrificans</italic> 2APBS1. InterPro categories highlighted in blue are explicitly related to heavy-metal metabolism. The analysis was conducted using the Blast2GO PRO version.</p>
    </caption>
    <graphic xlink:href="genes-11-00756-g004"/>
  </fig>
  <table-wrap id="genes-11-00756-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">genes-11-00756-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>State-of-the-art computational approaches for horizontal gene transfer detection with emphasis in prokaryotic genomes.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Classification</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Implementation</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Methodological Highlights</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Application Domain</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="5" align="center" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Parametric methods</bold>
          </td>
        </tr>
        <tr>
          <td rowspan="5" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">
            <bold>Nucleotide composition</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Alien Hunter (<uri xlink:href="http://www.sanger.ac.uk/science/tools/alien-hunter">http://www.sanger.ac.uk/science/tools/alien-hunter</uri>)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Uses Interpolated Variable Order Motifs (IVOMs) coupled to a Hidden Markov Model (HMM) to detect alien (atypical genes).</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">bacterial genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B16-genes-11-00756" ref-type="bibr">16</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No implementation available</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Detects atypical genes based on <italic>k</italic>-mer (<italic>k</italic> = 8) frequencies using a one-class support vector machine (SVM).</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">viral, archaeal and bacterial genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B17-genes-11-00756" ref-type="bibr">17</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No implementation available</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Combines two compositional features using a Kullback–Leibler divergence metric to improve the detection of atypical genes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">artificial genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B6-genes-11-00756" ref-type="bibr">6</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">GOHTAM (<uri xlink:href="http://gohtam.rpbs.univ-paris-diderot.fr/">http://gohtam.rpbs.univ-paris-diderot.fr/</uri>)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Uses a Jensen-Shannon divergence metric from window or gene-based signature data to detect atypical genes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">prokaryotic and eukaryotic genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B18-genes-11-00756" ref-type="bibr">18</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No implementation available</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Detects atypical genes based on the selection of nine compositional features using a SVM.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">bacterial genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B19-genes-11-00756" ref-type="bibr">19</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>Nucleotide composition plus information from the genomic context</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No implementation available</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Implements a multiple-threshold approach to detect atypical genes from compositional features and genomic context information to reduce the chance of misclassification.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">artificial genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B20-genes-11-00756" ref-type="bibr">20</xref>]</td>
        </tr>
        <tr>
          <td colspan="5" align="center" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Implicit phylogenetic methods</bold>
          </td>
        </tr>
        <tr>
          <td rowspan="3" align="center" valign="middle" style="border-bottom:solid thin" colspan="1">
            <bold>Phyletic distributions based on BLAST searches</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">DarkHorse (<uri xlink:href="http://darkhorse.ucsd.edu/">http://darkhorse.ucsd.edu/</uri>)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Calculates a lineage probability index from BLAST searches to predict atypical genes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">prokaryotic and eukaryotic genomes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B13-genes-11-00756" ref-type="bibr">13</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">HGTFinder (<uri xlink:href="http://cys.bios.niu.edu/HGTFinder/HGTFinder.tar.gz">http://cys.bios.niu.edu/HGTFinder/HGTFinder.tar.gz</uri>)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Calculates a horizontal transfer index from BLAST searches to predict atypical genes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">prokaryotic and eukaryotic genomes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B12-genes-11-00756" ref-type="bibr">12</xref>]</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">HGTector (<uri xlink:href="https://github.com/DittmarLab/HGTector">https://github.com/DittmarLab/HGTector</uri>)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Establishes statistical thresholds to detect genes that do not adhere to a priori defined hierarchical evolutionary categories inferred from BLAST searches.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">artificial, prokaryotic and eukaryotic genomes.</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[<xref rid="B14-genes-11-00756" ref-type="bibr">14</xref>]</td>
        </tr>
        <tr>
          <td colspan="5" align="center" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Hybrid methods</bold>
          </td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>Nucleotide composition complemented with an implicit phylogenetic model</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">ShadowCaster</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">See further</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">prokaryotic genomes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">This work</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
